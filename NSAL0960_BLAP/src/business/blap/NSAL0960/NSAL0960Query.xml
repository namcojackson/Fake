<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAL0960Query">

    <statement id="getDsContrVldList" parameterClass="Map" resultClass="Map">
        SELECT
            A.GLBL_CMPY_CD
           ,A.DS_CONTR_VLD_LIST_PK
           ,A.DS_CONTR_VLD_LIST_NM
           ,A.DS_CONTR_VLD_LIST_DESC_TXT
           ,A.EFF_FROM_DT
           ,A.EFF_TO_DT
           ,A.EZUPTIME
           ,A.EZUPTIMEZONE
           ,A.DS_CONTR_VLD_PK
           ,A.VLD_ACT_CD
           ,A.VLD_SORT_NUM
           ,A.DS_CONTR_VLD_CATG_DESC_TXT
           ,A.DS_CONTR_VLD_NM
           ,A.DS_CONTR_VLD_DESC_TXT
           ,A.VLD_ACT_DESC_TXT
           ,A.RELN_EFF_FROM_DT
           ,A.RELN_EFF_TO_DT
           ,A.RELN_EZUPTIME
           ,A.RELN_EZUPTIMEZONE
           ,A.XX_EXST_FLG
           ,A.DS_CONTR_VLD_CATG_CD
           <!-- START 2016/11/30 K.Kojima [QC#14204, ADD] -->
           ,A.XX_REC_HIST_CRAT_TS
           ,A.XX_REC_HIST_CRAT_BY_NM
           ,A.XX_REC_HIST_UPD_TS
           ,A.XX_REC_HIST_UPD_BY_NM
           ,A.XX_REC_HIST_TBL_NM
           ,A.XX_REC_HIST_CRAT_TS_A
           ,A.XX_REC_HIST_CRAT_BY_NM_A
           ,A.XX_REC_HIST_UPD_TS_A
           ,A.XX_REC_HIST_UPD_BY_NM_A
           ,A.XX_REC_HIST_TBL_NM_A
           <!-- END 2016/11/30 K.Kojima [QC#14204, ADD] -->
        FROM(
            SELECT
                DCVL.GLBL_CMPY_CD
               ,DCVL.DS_CONTR_VLD_LIST_PK
               ,DCVL.DS_CONTR_VLD_LIST_NM
               ,DCVL.DS_CONTR_VLD_LIST_DESC_TXT
               ,DCVL.EFF_FROM_DT
               ,DCVL.EFF_TO_DT
               ,DCVL.EZUPTIME
               ,DCVL.EZUPTIMEZONE
               ,DCVR.DS_CONTR_VLD_PK
               ,DCVR.VLD_ACT_CD
               ,DCVR.VLD_SORT_NUM
               ,DCVC.DS_CONTR_VLD_CATG_DESC_TXT
               ,DCV.DS_CONTR_VLD_NM
               ,DCV.DS_CONTR_VLD_DESC_TXT
               ,VA.VLD_ACT_DESC_TXT
               ,DCVR.EFF_FROM_DT     RELN_EFF_FROM_DT
               ,DCVR.EFF_TO_DT       RELN_EFF_TO_DT
               ,DCVR.EZUPTIME        RELN_EZUPTIME
               ,DCVR.EZUPTIMEZONE    RELN_EZUPTIMEZONE
               ,'Y'                  XX_EXST_FLG
               ,DCV.DS_CONTR_VLD_CATG_CD
               <!-- START 2016/11/30 K.Kojima [QC#14204, ADD] -->
               ,DCVL.EZINTIME    AS XX_REC_HIST_CRAT_TS
               ,DCVL.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM
               ,DCVL.EZUPTIME    AS XX_REC_HIST_UPD_TS
               ,DCVL.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM
               ,DCVL.EZTABLEID   AS XX_REC_HIST_TBL_NM
               ,DCV.EZINTIME    AS XX_REC_HIST_CRAT_TS_A
               ,DCV.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM_A
               ,DCV.EZUPTIME    AS XX_REC_HIST_UPD_TS_A
               ,DCV.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM_A
               ,DCV.EZTABLEID   AS XX_REC_HIST_TBL_NM_A
               <!-- END 2016/11/30 K.Kojima [QC#14204, ADD] -->
            FROM
                DS_CONTR_VLD_LIST    DCVL
               ,DS_CONTR_VLD_RELN    DCVR
               ,DS_CONTR_VLD         DCV
               ,DS_CONTR_VLD_CATG    DCVC
               ,VLD_ACT              VA
            WHERE
                DCVL.GLBL_CMPY_CD                     = #glblCmpyCd#
                AND DCVL.DS_CONTR_VLD_LIST_PK         = #dsContrVldListPk#
                AND DCVL.EZCANCELFLAG                 = '0'
                AND DCVL.GLBL_CMPY_CD                 = DCVR.GLBL_CMPY_CD
                AND DCVL.DS_CONTR_VLD_LIST_PK         = DCVR.DS_CONTR_VLD_LIST_PK
                AND DCVR.EZCANCELFLAG                 = '0'
                AND DCVR.GLBL_CMPY_CD                 = DCV.GLBL_CMPY_CD
                AND DCVR.DS_CONTR_VLD_PK              = DCV.DS_CONTR_VLD_PK
                AND DCV.EZCANCELFLAG                  = '0'
                AND DCV.GLBL_CMPY_CD                  = DCVC.GLBL_CMPY_CD(+)
                AND DCV.DS_CONTR_VLD_CATG_CD          = DCVC.DS_CONTR_VLD_CATG_CD(+)
                AND DCVC.EZCANCELFLAG(+)              = '0'
                AND DCVR.GLBL_CMPY_CD                 = VA.GLBL_CMPY_CD(+)
                AND DCVR.VLD_ACT_CD                   = VA.VLD_ACT_CD(+)
                AND VA.EZCANCELFLAG(+)                = '0'
            ORDER BY
                DCVR.VLD_SORT_NUM
            ) A
        WHERE
            ROWNUM &lt;= #limitNum#
    </statement>

    <statement id="getVldActList" parameterClass="Map" resultClass="Map">
        SELECT
            VA.VLD_ACT_CD
           ,VA.VLD_ACT_DESC_TXT
        FROM
            VLD_ACT VA
        WHERE
            VA.GLBL_CMPY_CD                     = #glblCmpyCd#
            AND VA.EZCANCELFLAG                 = '0'
        ORDER BY
            VA.VLD_ACT_SORT_NUM
    </statement>

    <statement id="getDsContrVldListPeriod" parameterClass="Map" resultClass="Map">
        SELECT
            DCVL.DS_CONTR_VLD_LIST_PK
           ,DCVL.EFF_FROM_DT
           ,DCVL.EFF_TO_DT
        FROM
            DS_CONTR_VLD_LIST DCVL
        WHERE
            DCVL.GLBL_CMPY_CD                   = #glblCmpyCd#
            AND DCVL.EZCANCELFLAG               = '0'
        ORDER BY
            DCVL.EFF_FROM_DT
    </statement>
</sqlMap>
