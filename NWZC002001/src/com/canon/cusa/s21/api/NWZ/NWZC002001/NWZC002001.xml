<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWZC002001">

    <typeAlias alias="TRNSP_LTTMsg"            type="business.db.TRNSP_LTTMsg"/>
    <typeAlias alias="AREA_LEAD_TMTMsg"        type="business.db.AREA_LEAD_TMTMsg"/>

    <statement id="getLongestTrnspLT" parameterClass="Map" resultMap="result.getLongestTrnspLT">
        SELECT
              NVL(TRNSP_LT_AOT, 0)    AS    TRNSP_LT_AOT
          ,    SHPG_MODE_CD            AS    SHPG_MODE_CD
        
        FROM
            TRNSP_LT
            
        WHERE
                GLBL_CMPY_CD  = #glblCmpyCd#
            AND WH_CD         = (
                                    SELECT
                                        MAX(RTL_WH_CD) RTL_WH_CD
                                    FROM
                                        RTL_SWH RS
                                    WHERE
                                        RS.GLBL_CMPY_CD = #glblCmpyCd#
                                    AND RS.INVTY_LOC_CD = #invtyLocCd#
                                    AND RS.EZCANCELFLAG = '0'
                                )
            AND ST_CD         = #shipToStCd#
            AND EFF_FROM_DT <![CDATA[ <= ]]> #slsDt#
            AND (EFF_THRU_DT <![CDATA[ >= ]]> #slsDt#
             OR EFF_THRU_DT IS NULL)
            <isNotNull property="shipToPostCd">
                AND (FROM_ZIP_CD <![CDATA[ <= ]]> #shipToPostCd# AND TO_ZIP_CD <![CDATA[ >= ]]> #shipToPostCd#)
            </isNotNull>
            AND EZCANCELFLAG  = '0'

        ORDER BY
            NVL(TRNSP_LT_AOT, 0)    DESC
    </statement>

    <resultMap id="result.getLongestTrnspLT" class="TRNSP_LTTMsg">
        <result property="trnspLtAot"    column="TRNSP_LT_AOT"    javaType="EZDTBigDecimalItem"/>
        <result property="shpgModeCd"    column="SHPG_MODE_CD"    javaType="EZDTStringItem"/>
    </resultMap>

    <statement id="getLongestAreaLeadTM" parameterClass="Map" resultMap="result.getLongestAreaLeadTM">
        SELECT
              NVL(DELY_LEAD_AOT, 0)    AS    DELY_LEAD_AOT
          ,    SHPG_MODE_CD            AS    SHPG_MODE_CD
        
        FROM
            AREA_LEAD_TM
            
        WHERE
                GLBL_CMPY_CD  = #glblCmpyCd#
            AND WH_CD         = (
                                    SELECT
                                        MAX(RTL_WH_CD) RTL_WH_CD
                                    FROM
                                        RTL_SWH RS
                                    WHERE
                                        RS.GLBL_CMPY_CD = #glblCmpyCd#
                                    AND RS.INVTY_LOC_CD = #invtyLocCd#
                                    AND RS.EZCANCELFLAG = '0'
                                )
            AND ST_CD         = #shipToStCd#
            AND EFF_FROM_DT <![CDATA[ <= ]]> #slsDt#
            AND (EFF_THRU_DT <![CDATA[ >= ]]> #slsDt#
             OR EFF_THRU_DT IS NULL)
            AND EZCANCELFLAG  = '0'

        ORDER BY
            NVL(DELY_LEAD_AOT, 0) DESC
    </statement>

    <resultMap id="result.getLongestAreaLeadTM" class="AREA_LEAD_TMTMsg">
        <result property="delyLeadAot"    column="DELY_LEAD_AOT"    javaType="EZDTBigDecimalItem"/>
        <result property="shpgModeCd"    column="SHPG_MODE_CD"    javaType="EZDTStringItem"/>
    </resultMap>

    <statement id="getRtlWhCdByInvtyLocCd" parameterClass="Map" resultClass="String">
        SELECT
            MAX(RTL_WH_CD) RTL_WH_CD
        FROM
            RTL_SWH
        WHERE
            GLBL_CMPY_CD  = #glblCmpyCd#
        AND INVTY_LOC_CD  = #invtyLocCd#
        AND EZCANCELFLAG  = '0'
    </statement>
</sqlMap>
