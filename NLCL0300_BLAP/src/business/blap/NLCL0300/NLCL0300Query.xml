<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NLCL0300Query">

    <typeAlias alias="NLCL0300CMsg"      type="business.blap.NLCL0300.NLCL0300CMsg"/>
    <typeAlias alias="NLCL0300_ACMsg"    type="business.blap.NLCL0300.NLCL0300_ACMsg"/>

    <statement id="getConfigChangeOrder" parameterClass="Map" resultMap="result.getConfigChangeOrder">
        SELECT
                 IO.SVC_CONFIG_MSTR_PK              SVC_CONFIG_MSTR_PK_AH
                ,IO.MDL_ID                          MDL_ID_AH
                ,MN.T_MDL_NM                        MDL_DESC_TXT_AH
                ,IO.INVTY_LOC_CD                    RTL_WH_CD_AH
                ,RWH.RTL_WH_NM                      RTL_WH_NM_AH
                ,IO.FIRST_INVTY_ORD_CMNT_TXT        FIRST_INVTY_ORD_CMNT_TXT_AH
                ,IO.SCD_INVTY_ORD_CMNT_TXT          SCD_INVTY_ORD_CMNT_TXT_AH
                ,IO.THIRD_INVTY_ORD_CMNT_TXT        THIRD_INVTY_ORD_CMNT_TXT_AH
                ,STS.INVTY_ORD_STS_DESC_TXT         INVTY_ORD_STS_DESC_TXT_AH
                ,SO.SO_NUM                          SO_NUM_AH
                ,ID.STK_STS_CD                      STK_STS_CD_A
                ,ID.MDSE_CD                         MDSE_CD_A
                ,DMI.MDSE_DESC_SHORT_TXT            MDSE_DESC_SHORT_TXT_A
                ,ID.FROM_RTL_SWH_CD                 FROM_RTL_SWH_CD_A
                ,ID.ORD_QTY                         ORD_QTY_A
                ,IOS.SER_NUM                        SER_NUM_A
                ,IO.INVTY_ORD_NUM                   INVTY_ORD_NUM_A
                ,ID.INVTY_ORD_LINE_NUM              INVTY_ORD_LINE_NUM_A
                ,I.INVTY_AVAL_QTY                   INVTY_AVAL_QTY_A
                ,ID.RMV_CONFIG_FLG                  RMV_CONFIG_FLG_A
                ,ID.SVC_CONFIG_MSTR_PK              SVC_CONFIG_MSTR_PK_A

        FROM INVTY_ORD IO
            ,INVTY_ORD_DTL ID
            ,INVTY_ORD_STS STS
            ,RTL_WH RWH
            ,INVTY I
            ,MDSE DMI
            ,MDL_NM MN
            ,SHPG_ORD SO
            ,(SELECT
                     IOD.GLBL_CMPY_CD          GLBL_CMPY_CD
                    ,IOD.INVTY_ORD_NUM         INVTY_ORD_NUM
                    ,IOD.INVTY_ORD_LINE_NUM    INVTY_ORD_LINE_NUM
                    ,IOD.MDSE_CD               MDSE_CD
                    ,IOS.SER_NUM               SER_NUM
              FROM   INVTY_ORD_DTL IOD
                    ,INVTY_ORD_SER IOS
              WHERE  IOS.GLBL_CMPY_CD       = IOD.GLBL_CMPY_CD
              AND    IOS.INVTY_ORD_NUM      = IOD.INVTY_ORD_NUM
              AND    IOS.INVTY_ORD_LINE_NUM = IOD.INVTY_ORD_LINE_NUM
              AND    IOS.EZCANCELFLAG       = '0'
             ) IOS

        WHERE
                IO.GLBL_CMPY_CD                =    #glblCmpyCd#
        AND     IO.INVTY_ORD_NUM               =    #invtyOrdNum#
        AND     IO.EZCANCELFLAG                =    '0'

        AND     ID.GLBL_CMPY_CD                =    IO.GLBL_CMPY_CD
        AND     ID.INVTY_ORD_NUM               =    IO.INVTY_ORD_NUM
        AND     ID.EZCANCELFLAG                =   '0'

        AND     IO.GLBL_CMPY_CD                =    MN.T_GLBL_CMPY_CD (+)
        AND     IO.MDL_ID                      =    MN.T_MDL_ID (+)
        AND     MN.EZCANCELFLAG (+)            =   '0'

        AND     ID.GLBL_CMPY_CD                =    IOS.GLBL_CMPY_CD (+)
        AND     ID.INVTY_ORD_NUM               =    IOS.INVTY_ORD_NUM (+)
        AND     ID.INVTY_ORD_LINE_NUM          =    IOS.INVTY_ORD_LINE_NUM (+)

        AND     IO.GLBL_CMPY_CD                =    RWH.GLBL_CMPY_CD (+)
        AND     IO.INVTY_LOC_CD                =    RWH.RTL_WH_CD (+)
        AND     RWH.EZCANCELFLAG (+)           =    '0'

        AND     ID.GLBL_CMPY_CD                =    DMI.GLBL_CMPY_CD (+)
        AND     ID.MDSE_CD                     =    DMI.MDSE_CD
        AND     DMI.EZCANCELFLAG (+)           =    '0'

        AND     IO.GLBL_CMPY_CD                =    STS.GLBL_CMPY_CD (+)
        AND     IO.INVTY_ORD_STS_CD            =    STS.INVTY_ORD_STS_CD (+)
        AND     STS.EZCANCELFLAG (+)           =    '0'

        AND     IO.GLBL_CMPY_CD                =    SO.GLBL_CMPY_CD (+)
        AND     IO.INVTY_ORD_NUM               =    SO.TRX_HDR_NUM (+)
        AND     SO.EZCANCELFLAG (+)            =    '0'

        AND     I.GLBL_CMPY_CD                 =    ID.GLBL_CMPY_CD
        AND     I.MDSE_CD                      =    ID.MDSE_CD
        AND     I.INVTY_LOC_CD                 =    ID.INVTY_LOC_CD
        AND     I.LOC_STS_CD                   =    ID.LOC_STS_CD
        AND     I.STK_STS_CD                   =    ID.STK_STS_CD
        AND     I.EZCANCELFLAG                 =   '0'
<!-- START 2019/10/21 H.Umeda [QC#54030,Add] -->
        ORDER BY
                ID.INVTY_ORD_LINE_NUM
<!-- END   2019/10/21 H.Umeda [QC#54030,Add] -->
    </statement>

    <resultMap id="result.getConfigChangeOrder"         class="NLCL0300_ACMsg">
        <result property="soNum_AH"                     column="SO_NUM_AH"                     javaType="EZDSStringItem" />
        <result property="rtlWhCd_AH"                   column="RTL_WH_CD_AH"                  javaType="EZDSStringItem" />
        <result property="rtlWhNm_AH"                   column="RTL_WH_NM_AH"                  javaType="EZDSStringItem" />
        <result property="firstInvtyOrdCmntTxt_AH"      column="FIRST_INVTY_ORD_CMNT_TXT_AH"   javaType="EZDSStringItem" />
        <result property="scdInvtyOrdCmntTxt_AH"        column="SCD_INVTY_ORD_CMNT_TXT_AH"     javaType="EZDSStringItem" />
        <result property="thirdInvtyOrdCmntTxt_AH"      column="THIRD_INVTY_ORD_CMNT_TXT_AH"   javaType="EZDSStringItem" />
        <result property="invtyOrdStsDescTxt_AH"        column="INVTY_ORD_STS_DESC_TXT_AH"     javaType="EZDSStringItem" />
        <result property="mdlId_AH"                     column="MDL_ID_AH"                     javaType="EZDSBigDecimalItem" />
        <result property="mdlDescTxt_AH"                column="MDL_DESC_TXT_AH"               javaType="EZDSStringItem" />
        <result property="svcConfigMstrPk_AH"           column="SVC_CONFIG_MSTR_PK_AH"         javaType="EZDSBigDecimalItem" />
        <result property="svcConfigMstrPk_A"            column="SVC_CONFIG_MSTR_PK_A"          javaType="EZDSBigDecimalItem" />
        <result property="stkStsCd_A"                   column="STK_STS_CD_A"                  javaType="EZDSStringItem" />
        <result property="mdseCd_A"                     column="MDSE_CD_A"                     javaType="EZDSStringItem" />
        <result property="mdseDescShortTxt_A"           column="MDSE_DESC_SHORT_TXT_A"         javaType="EZDSStringItem" />
        <result property="rtlSwhCd_A"                   column="FROM_RTL_SWH_CD_A"             javaType="EZDSStringItem" />
        <result property="ordQty_A"                     column="ORD_QTY_A"                     javaType="EZDSBigDecimalItem" />
        <result property="serNum_A"                     column="SER_NUM_A"                     javaType="EZDSStringItem" />
        <result property="invtyOrdNum_A"                column="INVTY_ORD_NUM_A"               javaType="EZDSStringItem" />
        <result property="invtyOrdLineNum_A"            column="INVTY_ORD_LINE_NUM_A"          javaType="EZDSStringItem" />
        <result property="invtyAvalQty_A"               column="INVTY_AVAL_QTY_A"              javaType="EZDSBigDecimalItem" />
        <result property="rmvConfigFlg_A"               column="RMV_CONFIG_FLG_A"              javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getLocStsList" parameterClass="Map" resultClass="Map">
        SELECT 
            LS.LOC_STS_CD          LOC_STS_CD
           ,LS.LOC_STS_DESC_TXT    LOC_STS_DESC_TXT
           ,LS.LOC_STS_SORT_NUM    LOC_STS_SORT_NUM
        FROM 
            LOC_STS LS
        WHERE
                LS.GLBL_CMPY_CD          =     #glblCmpyCd#
            AND LS.EZCANCELFLAG          =     '0'
            AND EXISTS
                (SELECT 1
                 FROM  AVAL_INVTY_APP_ID A
                 WHERE A.GLBL_CMPY_CD = LS.GLBL_CMPY_CD
                 AND   A.BIZ_APP_ID   = #bizAppId#
                 AND   A.LOC_STS_CD   = LS.LOC_STS_CD
                 AND   A.EZCANCELFLAG = '0'
                )
        ORDER BY
                LOC_STS_SORT_NUM
    </statement>

    <statement id="getStkStsList" parameterClass="Map" resultClass="Map">
        SELECT 
            SS.STK_STS_CD          STK_STS_CD
           ,SS.STK_STS_DESC_TXT    STK_STS_DESC_TXT
           ,SS.STK_STS_SORT_NUM    STK_STS_SORT_NUM
        FROM 
            STK_STS SS
        WHERE
                SS.GLBL_CMPY_CD          =     #glblCmpyCd#
            AND SS.EZCANCELFLAG          =     '0'
            AND EXISTS
                (SELECT 1
                 FROM  AVAL_INVTY_APP_ID A
                 WHERE A.GLBL_CMPY_CD = SS.GLBL_CMPY_CD
                 AND   A.BIZ_APP_ID   = #bizAppId#
                 AND   A.STK_STS_CD   = SS.STK_STS_CD
                 AND   A.EZCANCELFLAG = '0'
                )
        ORDER BY
                STK_STS_SORT_NUM
    </statement>

    <statement id="getModelConfigList" parameterClass="Map" resultClass="Map">
        SELECT 
              DMC.MDL_ID                       MDL_ID
             ,MN.T_MDL_NM                      MDL_DESC_TXT
             ,NVL(CHILD_MDSE_CD, PRNT_MDSE_CD) MDSE_CD
             ,CASE WHEN CHILD_MDSE_CD IS NULL THEN 1
                   ELSE 2
              END                              SORT
        FROM  DS_MDL_CONFIG DMC
             ,MDL_NM MN
        WHERE 
              MN.T_GLBL_CMPY_CD     = #glblCmpyCd#
        AND   MN.T_MDL_NM           = #mdlDescTxt#
        AND   MN.EZCANCELFLAG       = '0'
        AND   DMC.GLBL_CMPY_CD      = MN.T_GLBL_CMPY_CD
        AND   DMC.MDL_ID            = MN.T_MDL_ID
        AND   (DMC.EFF_FROM_DT IS NULL OR DMC.EFF_FROM_DT &lt;= #slsDt#)
        AND   (DMC.EFF_THRU_DT IS NULL OR DMC.EFF_THRU_DT &gt;= #slsDt#)
        AND   DMC.EZCANCELFLAG    = '0'
        ORDER BY SORT
    </statement>

    <statement id="getConfigList" parameterClass="Map" resultClass="Map">
        SELECT
                SMM.SVC_CONFIG_MSTR_PK     SVC_CONFIG_MSTR_PK
               ,SMM.MDSE_CD                MDSE_CD
               ,SMM.SER_NUM                SER_NUM
               ,SMM.CUR_LOC_NUM            CUR_LOC_NUM
               ,SMM.STK_STS_CD             STK_STS_CD
               ,SMM.SVC_MACH_MSTR_STS_CD   SVC_MACH_MSTR_STS_CD
               ,RSW.INVTY_LOC_CD           INVTY_LOC_CD
               ,RSW.RTL_WH_CD              RTL_WH_CD
               ,RSW.RTL_SWH_CD             RTL_SWH_CD
               ,SCM.MDL_ID                 MDL_ID
               ,MN.T_MDL_NM                MDL_DESC_TXT
        FROM
              SVC_MACH_MSTR SMM
             ,RTL_SWH RSW
             ,SVC_CONFIG_MSTR SCM
             ,MDL_NM MN
        WHERE
              SMM.GLBL_CMPY_CD       = #glblCmpyCd#
        AND   SMM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
        AND   SMM.EZCANCELFLAG       = '0'
        AND   SCM.GLBL_CMPY_CD       = SMM.GLBL_CMPY_CD
        AND   SCM.SVC_CONFIG_MSTR_PK = SMM.SVC_CONFIG_MSTR_PK
        AND   SCM.EZCANCELFLAG       = '0'
        AND   SMM.GLBL_CMPY_CD       = RSW.GLBL_CMPY_CD (+)
        AND   SMM.CUR_LOC_NUM        = RSW.INVTY_LOC_CD (+)
        AND   RSW.EZCANCELFLAG (+)   = '0'
        AND   SCM.GLBL_CMPY_CD       = MN.T_GLBL_CMPY_CD (+)
        AND   SCM.MDL_ID             = MN.T_MDL_ID (+)
        AND   MN.EZCANCELFLAG (+)    = '0'
        ORDER BY
<!-- QC#53974 Add Start-->
              SVC_MACH_TP_CD
<!-- QC#53974 Add End -->
              ,SVC_MACH_SQ_NUM
    </statement>

    <statement id="getRtlSwhList" parameterClass="Map" resultClass="Map">
        SELECT 
            RSW.RTL_SWH_CD   RTL_SWH_CD
           ,CASE WHEN RSW.PRTY_LOC_FLG = 'Y' THEN 1
                 ELSE 2
            END              SORT
        FROM 
            RTL_SWH RSW
        WHERE
                RSW.GLBL_CMPY_CD                     =     #glblCmpyCd#
            AND RSW.RTL_WH_CD                        =     #rtlWhCd#
            AND RSW.RTL_SWH_DSBL_FLG                 =     'N'
            AND RSW.EFF_FROM_DT                  &lt;=     #slsDt#
            AND NVL(RSW.EFF_THRU_DT,'99991231')  &gt;=     #slsDt#
            AND RSW.EZCANCELFLAG                     =     '0'
        ORDER BY
                SORT
               ,RTL_SWH_CD
    </statement>

    <statement id="getRtlWhMap" parameterClass="Map" resultClass="Map">
        SELECT 
            RWH.RTL_WH_CD                                RTL_WH_CD
           ,RWH.RTL_WH_NM                                RTL_WH_NM
           ,RSW.RTL_SWH_CD                               RTL_SWH_CD
           ,NVL(RSW.INVTY_LOC_CD, RWH.RTL_WH_CD)         INVTY_LOC_CD
           ,RWH.RTL_WH_CATG_CD                           RTL_WH_CATG_CD
        FROM 
            RTL_WH RWH
           ,RTL_SWH RSW
        WHERE
                RWH.GLBL_CMPY_CD          =     #glblCmpyCd#
            AND RWH.EZCANCELFLAG          =     '0'
            <isNotNull property="rtlWhCd">
            AND RWH.RTL_WH_CD             =     #rtlWhCd#
            </isNotNull>
            <isNotNull property="rtlWhNm">
            AND RWH.RTL_WH_NM             =     #rtlWhNm#
            </isNotNull>
            AND RWH.GLBL_CMPY_CD          =     RSW.GLBL_CMPY_CD (+)
            AND RWH.RTL_WH_CD             =     RSW.RTL_WH_CD (+)
            AND RSW.PRTY_LOC_FLG (+)      =     'Y'
            AND RSW.EZCANCELFLAG (+)      =     '0'
            AND ROWNUM                    =     1
    </statement>

    <statement id="getAdjTrxTypeMap" parameterClass="Map" resultClass="Map">
        SELECT 
            ATT.ADJ_TRX_TP_CD          ADJ_TRX_TP_CD
           ,ATT.ADJ_TRX_TP_DESC_TXT    ADJ_TRX_TP_DESC_TXT
           ,ATT.ADJ_TRX_TP_SORT_NUM    ADJ_TRX_TP_SORT_NUM
        FROM 
            ADJ_TRX_TP ATT
        WHERE
                ATT.GLBL_CMPY_CD          =     #glblCmpyCd#
            AND ATT.SCR_ENT_AVAL_FLG      =     'Y'
            AND ATT.EZCANCELFLAG          =     '0'
        ORDER BY
                ADJ_TRX_TP_SORT_NUM
    </statement>

    <statement id="getMdseMap" parameterClass="Map" resultClass="Map">
    SELECT
            MDSE_CD
           ,SHPG_SER_TAKE_FLG
           ,MDSE_DESC_SHORT_TXT
           ,INSTL_BASE_CTRL_FLG
    FROM
        (
        SELECT 
            M.MDSE_CD                  MDSE_CD
           ,M.SHPG_SER_TAKE_FLG        SHPG_SER_TAKE_FLG
           ,M.MDSE_DESC_SHORT_TXT      MDSE_DESC_SHORT_TXT
           ,M.INSTL_BASE_CTRL_FLG      INSTL_BASE_CTRL_FLG
        FROM 
            MDSE M
        WHERE
                M.GLBL_CMPY_CD          =     #glblCmpyCd#
            AND M.MDSE_CD               =     #mdseCd#
            AND M.EZCANCELFLAG          =     '0'
        UNION ALL
        SELECT
            M.MDSE_CD                  MDSE_CD
           ,M.SHPG_SER_TAKE_FLG        SHPG_SER_TAKE_FLG
           ,M.MDSE_DESC_SHORT_TXT      MDSE_DESC_SHORT_TXT
           ,M.INSTL_BASE_CTRL_FLG      INSTL_BASE_CTRL_FLG
        FROM 
            ORD_TAKE_MDSE OTM
           ,MDSE M
        WHERE
                OTM.GLBL_CMPY_CD        =     #glblCmpyCd#
            AND OTM.ORD_TAKE_MDSE_CD    =     #mdseCd#
            AND OTM.EZCANCELFLAG        =     '0'
            AND M.GLBL_CMPY_CD          =     OTM.GLBL_CMPY_CD
            AND M.MDSE_CD               =     OTM.MDSE_CD
            AND M.EZCANCELFLAG          =     '0'
        )
    WHERE ROWNUM = 1
    </statement>

    <statement id="getIbMap" parameterClass="Map" resultClass="Map">
        SELECT  
            SVC_MACH_MSTR_PK            SVC_MACH_MSTR_PK
           ,SVC_MACH_MSTR_STS_CD        SVC_MACH_MSTR_STS_CD
           ,CUR_LOC_NUM                 CUR_LOC_NUM
           ,SVC_MACH_MAINT_AVAL_FLG     SVC_MACH_MAINT_AVAL_FLG
           ,SVC_CONFIG_MSTR_PK          SVC_CONFIG_MSTR_PK
           ,SVC_MACH_TP_DESC_TXT        SVC_MACH_TP_DESC_TXT
        FROM SVC_MACH_MSTR SMM
            ,SVC_MACH_TP SMT
        WHERE
            SMM.GLBL_CMPY_CD     =   #glblCmpyCd#
        AND SMM.SER_NUM          =   #serNum#
        AND SMM.MDSE_CD          =   #mdseCd#
        AND SMM.EZCANCELFLAG     =   '0'
        AND SMM.GLBL_CMPY_CD     =   SMT.GLBL_CMPY_CD (+)
        AND SMM.SVC_MACH_TP_CD   =   SMT.SVC_MACH_TP_CD (+)
        AND SMT.EZCANCELFLAG (+) =   '0'
    </statement>

    <statement id="getIbMapNonSerial" parameterClass="Map" resultClass="Map">
        SELECT  
            SVC_MACH_MSTR_PK            SVC_MACH_MSTR_PK
           ,SVC_MACH_MSTR_STS_CD        SVC_MACH_MSTR_STS_CD
           ,CUR_LOC_NUM                 CUR_LOC_NUM
           ,SVC_MACH_MAINT_AVAL_FLG     SVC_MACH_MAINT_AVAL_FLG
           ,SVC_CONFIG_MSTR_PK          SVC_CONFIG_MSTR_PK
           ,SVC_MACH_TP_DESC_TXT        SVC_MACH_TP_DESC_TXT
        FROM SVC_MACH_MSTR SMM
            ,SVC_MACH_TP SMT
        WHERE
            SMM.GLBL_CMPY_CD     =   #glblCmpyCd#
        AND SMM.MDSE_CD          =   #mdseCd#
        AND SMM.SER_NUM          IS NULL
        AND SMM.EZCANCELFLAG     =   '0'
        AND SMM.GLBL_CMPY_CD     =   SMT.GLBL_CMPY_CD (+)
        AND SMM.SVC_MACH_TP_CD   =   SMT.SVC_MACH_TP_CD (+)
        AND SMT.EZCANCELFLAG (+) =   '0'
        AND SMT.SVC_MACH_MSTR_STS_CD IN ('CRAT','RMV')
        AND SMT.ROWNUM           =   1
        ORDER BY 
            SVC_MACH_MSTR_PK
    </statement>

    <statement id="countSubWarehouseTransferControl" parameterClass="Map" resultClass="BigDecimal">
        SELECT COUNT(1) CNT
        FROM (
               SELECT 1
               FROM   SWH_TRNSF_CTRL STC
               WHERE  STC.GLBL_CMPY_CD = #glblCmpyCd#
               AND    STC.RTL_WH_CD    = #rtlWhCd#
               AND    STC.EZCANCELFLAG = '0'
               UNION
               SELECT 1
               FROM   RTL_WH RTW
                     ,SWH_TRNSF_CTRL STC
               WHERE  RTW.GLBL_CMPY_CD    = #glblCmpyCd#
               AND    RTW.RTL_WH_CD       = #rtlWhCd#
               AND    RTW.EZCANCELFLAG    = '0'
               AND    STC.GLBL_CMPY_CD    = RTW.GLBL_CMPY_CD
               AND    STC.RTL_WH_CATG_CD  = RTW.RTL_WH_CATG_CD
               AND    STC.WH_SYS_TP_CD    = RTW.WH_SYS_TP_CD
               AND    STC.EZCANCELFLAG    = '0'
              )
    </statement>

    <statement id="getLocStsCd" parameterClass="Map" resultClass="String">
        SELECT  
            LS.LOC_STS_CD            LOC_STS_CD
        FROM LOC_STS LS
        WHERE
            LS.GLBL_CMPY_CD         =   #glblCmpyCd#
        AND LS.LOC_STS_DESC_TXT     =   #locStsDescTxt#
        AND LS.EZCANCELFLAG         =   '0'
        AND ROWNUM = 1
    </statement>

    <statement id="getStkStsCd" parameterClass="Map" resultClass="String">
        SELECT  
             SS.STK_STS_CD            STK_STS_CD
        FROM STK_STS SS
        WHERE
            SS.GLBL_CMPY_CD         =   #glblCmpyCd#
        AND SS.STK_STS_DESC_TXT     =   #stkStsDescTxt#
        AND SS.EZCANCELFLAG         =   '0'
        AND ROWNUM = 1
    </statement>

    <statement id="getRwsSerApiParameterList" parameterClass="Map" resultClass="Map">
        SELECT
               RD.RWS_NUM                RWS_NUM
              ,RD.RWS_DTL_LINE_NUM       RWS_DTL_LINE_NUM
              ,SS.MDSE_CD                MDSE_CD
              ,SS.SER_NUM                SER_NUM
        FROM
               RWS_HDR RH
              ,RWS_DTL RD
              ,SO_SER SS
        WHERE
              RH.GLBL_CMPY_CD = #glblCmpyCd#
        AND   RH.RWS_NUM      = #rwsNum#
        AND   RH.EZCANCELFLAG = '0'
        AND   RD.GLBL_CMPY_CD = RH.GLBL_CMPY_CD
        AND   RD.RWS_NUM      = RH.RWS_NUM
        AND   RD.EZCANCELFLAG = '0'
        AND   SS.GLBL_CMPY_CD = RH.GLBL_CMPY_CD
        AND   SS.SO_NUM       = RH.TRX_ORD_NUM
        AND   SS.SO_SLP_NUM   = RD.TRX_LINE_NUM
        AND   SS.EZCANCELFLAG = '0'
    </statement>

<!-- START 2019/08/13 M.Naito [QC#52185,ADD] -->
    <statement id="getOrderBySvcConfigMstrPk" parameterClass="Map" resultClass="String">
        SELECT C.CPO_ORD_NUM
        FROM
            CPO     C
           ,CPO_DTL CD
        WHERE
            C.GLBL_CMPY_CD             = #glblCmpyCd#
        AND C.ORD_HDR_STS_CD           NOT IN (#ordHdrStsCancelled#, #ordHdrStsClosed#)
        AND C.EZCANCELFLAG             = '0'
        AND C.GLBL_CMPY_CD             = CD.GLBL_CMPY_CD
        AND C.CPO_ORD_NUM              = CD.CPO_ORD_NUM
        AND CD.PICK_SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
        AND CD.EZCANCELFLAG            = '0'
        UNION
        SELECT PR.PRCH_REQ_NUM
        FROM
            PRCH_REQ     PR
           ,PRCH_REQ_DTL PRD
           ,PRCH_REQ_STS PRS
        WHERE
            PR.GLBL_CMPY_CD             = #glblCmpyCd#
        AND PR.EZCANCELFLAG             = '0'
        AND PR.GLBL_CMPY_CD             = PRS.GLBL_CMPY_CD
        AND PR.PRCH_REQ_STS_CD          = PRS.PRCH_REQ_STS_CD
        AND PRS.OPEN_STS_FLG            = 'Y'
        AND PRS.EZCANCELFLAG            = '0'
        AND PR.GLBL_CMPY_CD             = PRD.GLBL_CMPY_CD
        AND PR.PRCH_REQ_NUM             = PRD.PRCH_REQ_NUM
        AND PRD.SVC_CONFIG_MSTR_PK      = #svcConfigMstrPk#
        AND PRD.EZCANCELFLAG            = '0'
        UNION
        SELECT IO.INVTY_ORD_NUM
        FROM
            INVTY_ORD     IO
           ,INVTY_ORD_DTL IOD
        WHERE
            IO.GLBL_CMPY_CD             = #glblCmpyCd#
        AND IO.EZCANCELFLAG             = '0'
        AND IO.INVTY_ORD_STS_CD         NOT IN (#invtyOrdStsCancelled#, #invtyOrdStsClosed#)
        AND IO.GLBL_CMPY_CD             = IOD.GLBL_CMPY_CD
        AND IO.INVTY_ORD_NUM            = IOD.INVTY_ORD_NUM
        AND IOD.SVC_CONFIG_MSTR_PK      = #svcConfigMstrPk#
        AND IOD.EZCANCELFLAG            = '0'
        UNION
        SELECT POD.PO_ORD_NUM
        FROM
            PO_DTL POD
           ,PO_STS POS
        WHERE
            POD.GLBL_CMPY_CD            = #glblCmpyCd#
        AND POD.EZCANCELFLAG            = '0'
        AND POD.SVC_CONFIG_MSTR_PK      = #svcConfigMstrPk#
        AND POD.GLBL_CMPY_CD            = POD.GLBL_CMPY_CD
        AND POD.PO_STS_CD               = POS.PO_STS_CD
        AND POS.OPEN_PO_FLG             = 'Y'
        AND POS.EZCANCELFLAG            = '0'
        UNION
        SELECT RO.RMNF_ORD_NUM
        FROM
            RMNF_ORD     RO
           ,RMNF_ORD_STS ROS
        WHERE
            RO.GLBL_CMPY_CD            = #glblCmpyCd#
        AND RO.EZCANCELFLAG            = '0'
        AND RO.SVC_CONFIG_MSTR_PK      = #svcConfigMstrPk#
        AND RO.GLBL_CMPY_CD            = ROS.GLBL_CMPY_CD
        AND RO.RMNF_ORD_STS_CD         = ROS.RMNF_ORD_STS_CD
        AND ROS.OPEN_STS_FLG           = 'Y'
        AND ROS.EZCANCELFLAG           = '0'
    </statement>
<!-- END 2019/08/13 M.Naito [QC#52185,ADD] -->

    <!-- START 2022/02/15 A.Marte [QC#59705,ADD] -->
    <statement id="countAvailNonSerialSingleItem" parameterClass="Map" resultClass="Integer">
        SELECT 
            COUNT(*)
        FROM
            SVC_MACH_MSTR SMM
        WHERE
            SMM.GLBL_CMPY_CD             = #glblCmpyCd#
        AND SMM.MDSE_CD                  = #mdseCd#
        AND SMM.CUR_LOC_NUM              = #invtyLocCd#
        AND SMM.SVC_CONFIG_MSTR_PK       is null
        AND SMM.EZCANCELFLAG             = '0'
    </statement>
    <!-- END 2022/02/15 A.Marte [QC#59705,ADD] -->
</sqlMap>
