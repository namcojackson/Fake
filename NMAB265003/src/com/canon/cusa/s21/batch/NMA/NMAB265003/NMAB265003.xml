<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NMAB265003">
 
 
<!-- QC#12571
    <statement id="getRoleNonExists" parameterClass="Map" resultClass="Map">

       SELECT
           ATRE.GLBL_CMPY_CD
         , ATRE.DS_ACCT_NUM
         , ATRE.DS_ACCT_NM
         , ATRE.LOC_NUM
 -->

<!-- QC#12063, 13277 Delete
     <statement id="deleteRoleNonExists" parameterClass="Map" resultClass="Map">
       DELETE
       FROM 
           ACCT_TRTY_RESRC_ASG ATRE

       WHERE
           NOT EXISTS(
               SELECT 'X'
                   FROM ACCT_TRTY_ROLE_ASG ATRO 
               WHERE
                       ATRE.GLBL_CMPY_CD = ATRO.GLBL_CMPY_CD
                   AND ATRO.EZCANCELFLAG = '0'
                   AND ATRE.DS_ACCT_NUM  = ATRO.DS_ACCT_NUM
                   AND ATRE.DS_ACCT_NM   = ATRO.DS_ACCT_NM
                   AND ATRE.LOC_NUM      = ATRO.LOC_NUM
           )
           AND NOT EXISTS(
               SELECT 'X'
                   FROM PROS_TRTY_ROLE_ASG PTRO 
               WHERE
                       ATRE.GLBL_CMPY_CD = PTRO.GLBL_CMPY_CD
                   AND PTRO.EZCANCELFLAG = '0'
                   AND ATRE.DS_ACCT_NUM  = PTRO.DS_ACCT_NUM
                   AND ATRE.DS_ACCT_NM   = PTRO.DS_ACCT_NM
                   AND ATRE.LOC_NUM      = PTRO.LOC_NUM
           )
           AND ATRE.DS_ACCT_TP_CD = #dsAcctTpCd#
           AND ATRE.GLBL_CMPY_CD  = #glblCmpyCd#
    </statement>
 -->
<!-- QC#12063, 13277 Add Start-->
<!-- Del RS#8275
     <statement id="deleteAcctTrtyResrcAsg" parameterClass="Map" resultClass="Map">
       DELETE
       FROM 
           ACCT_TRTY_RESRC_ASG ATRE
       WHERE
           ATRE.DS_ACCT_TP_CD = #dsAcctTpCd#
       AND ATRE.GLBL_CMPY_CD  = #glblCmpyCd#
    </statement>
-->
<!-- QC#12063, 13277 Add End-->

    <statement id="truncateTable" parameterClass="Map">

        TRUNCATE TABLE 
        <isNotNull property="tableNameATRAL">
            ACCT_TRTY_ROLE_ASG_LOG
        </isNotNull>
        <isNotNull property="tableNamePTRAL">
            PROS_TRTY_ROLE_ASG_LOG
        </isNotNull>
        <isNotNull property="tableNameATSA">
            ACCT_TRTY_RESRC_ASG
        </isNotNull>
        <isNotNull property="tableNamePTSA">
            PROS_TRTY_RESRC_ASG
        </isNotNull>
        <isNotNull property="tableNameATSAL">
            ACCT_TRTY_RESRC_LOG
        </isNotNull>
        <isNotNull property="tableNamePTSAL">
            PROS_TRTY_RESRC_LOG
        </isNotNull>
    </statement>

<!-- QC#12571
    <statement id="getDeleteATRLData" parameterClass="Map" resultClass="Map">

        SELECT
              ATRL.GLBL_CMPY_CD
            , ATRL.DS_ACCT_NUM
            , ATRL.DS_ACCT_NM
            , ATRL.LOC_NUM 
        FROM
              ACCT_TRTY_RESRC_LOG ATRL 
        WHERE
                ATRL.GLBL_CMPY_CD = #glblCmpyCd# 
            AND ATRL.DS_ACCT_TP_CD = #dsAcctTpCd#
    </statement>
-->
<!-- QC#12571
    <statement id="deleteATRLData" parameterClass="Map" resultClass="Map">
        DELETE FROM
              ACCT_TRTY_RESRC_LOG ATRL 
        WHERE
                ATRL.GLBL_CMPY_CD = #glblCmpyCd# 
            AND ATRL.DS_ACCT_TP_CD = #dsAcctTpCd#
    </statement>


    <statement id="getDeleteTableData" parameterClass="Map" resultClass="Map">

        SELECT
              TBL.GLBL_CMPY_CD
            , TBL.ACCT_TRTY_ROLE_ASG_PK 
        FROM
        <isNotNull property="tableNameATRA">
            ACCT_TRTY_ROLE_ASG TBL
        </isNotNull>
        <isNotNull property="tableNamePTRA">
            PROS_TRTY_ROLE_ASG TBL
        </isNotNull>
        WHERE
                TBL.GLBL_CMPY_CD = #glblCmpyCd# 
            AND TBL.MAN_ENTRY_FLG = #manEntryFlg#
    </statement>
-->

    <statement id="deleteTableData" parameterClass="Map" resultClass="Map">
        DELETE FROM
        <isNotNull property="tableNameATRA">
            ACCT_TRTY_ROLE_ASG TBL
        </isNotNull>
        <isNotNull property="tableNamePTRA">
            PROS_TRTY_ROLE_ASG TBL
        </isNotNull>
        WHERE
                TBL.GLBL_CMPY_CD = #glblCmpyCd# 
            AND TBL.MAN_ENTRY_FLG = #manEntryFlg#
    </statement>

    <statement id="searchInsertRsc" parameterClass="Map" resultClass="Map">
    INSERT INTO
    <isNotNull property="tableNameATRA">
      ACCT_TRTY_RESRC_LOG
    </isNotNull>
    <isNotNull property="tableNamePTRA">
      PROS_TRTY_RESRC_LOG
    </isNotNull>
    (
         EZTABLEID
        ,EZCANCELFLAG
        ,EZINTIME
        ,EZINTIMEZONE
        ,EZINCOMPANYCODE
        ,EZINUSERID
        ,EZINAPLID
        ,EZUPTIME
        ,EZUPTIMEZONE
        ,EZUPCOMPANYCODE
        ,EZUPUSERID
        ,EZUPAPLID
        ,GLBL_CMPY_CD
        ,DS_ACCT_NUM
        ,DS_ACCT_NM
        ,LOC_NUM
        ,DS_ACCT_TP_CD
        ,ACCT_TRTY_ORG_CD_01
        ,ACCT_TRTY_PSN_CD_01
        ,ACCT_TRTY_TOC_CD_01
        ,ACCT_TRTY_ORG_CD_02
        ,ACCT_TRTY_PSN_CD_02
        ,ACCT_TRTY_TOC_CD_02
        ,ACCT_TRTY_ORG_CD_03
        ,ACCT_TRTY_PSN_CD_03
        ,ACCT_TRTY_TOC_CD_03
        ,ACCT_TRTY_ORG_CD_04
        ,ACCT_TRTY_PSN_CD_04
        ,ACCT_TRTY_TOC_CD_04
        ,ACCT_TRTY_ORG_CD_05
        ,ACCT_TRTY_PSN_CD_05
        ,ACCT_TRTY_TOC_CD_05
        ,ACCT_TRTY_ORG_CD_06
        ,ACCT_TRTY_PSN_CD_06
        ,ACCT_TRTY_TOC_CD_06
        ,ACCT_TRTY_ORG_CD_07
        ,ACCT_TRTY_PSN_CD_07
        ,ACCT_TRTY_TOC_CD_07
        ,ACCT_TRTY_ORG_CD_08
        ,ACCT_TRTY_PSN_CD_08
        ,ACCT_TRTY_TOC_CD_08
        ,ACCT_TRTY_ORG_CD_09
        ,ACCT_TRTY_PSN_CD_09
        ,ACCT_TRTY_TOC_CD_09
        ,ACCT_TRTY_ORG_CD_10
        ,ACCT_TRTY_PSN_CD_10
        ,ACCT_TRTY_TOC_CD_10
        ,ACCT_TRTY_ORG_CD_11
        ,ACCT_TRTY_PSN_CD_11
        ,ACCT_TRTY_TOC_CD_11
        ,ACCT_TRTY_ORG_CD_12
        ,ACCT_TRTY_PSN_CD_12
        ,ACCT_TRTY_TOC_CD_12
        ,ACCT_TRTY_ORG_CD_13
        ,ACCT_TRTY_PSN_CD_13
        ,ACCT_TRTY_TOC_CD_13
        ,ACCT_TRTY_ORG_CD_14
        ,ACCT_TRTY_PSN_CD_14
        ,ACCT_TRTY_TOC_CD_14
        ,ACCT_TRTY_ORG_CD_15
        ,ACCT_TRTY_PSN_CD_15
        ,ACCT_TRTY_TOC_CD_15
        ,ACCT_TRTY_ORG_CD_16
        ,ACCT_TRTY_PSN_CD_16
        ,ACCT_TRTY_TOC_CD_16
        ,ACCT_TRTY_ORG_CD_17
        ,ACCT_TRTY_PSN_CD_17
        ,ACCT_TRTY_TOC_CD_17
        ,ACCT_TRTY_ORG_CD_18
        ,ACCT_TRTY_PSN_CD_18
        ,ACCT_TRTY_TOC_CD_18
        ,ACCT_TRTY_ORG_CD_19
        ,ACCT_TRTY_PSN_CD_19
        ,ACCT_TRTY_TOC_CD_19
        ,ACCT_TRTY_ORG_CD_20
        ,ACCT_TRTY_PSN_CD_20
        ,ACCT_TRTY_TOC_CD_20
        ,LINE_BIZ_ROLE_TP_CD_01
        ,LINE_BIZ_ROLE_TP_CD_02
        ,LINE_BIZ_ROLE_TP_CD_03
        ,LINE_BIZ_ROLE_TP_CD_04
        ,LINE_BIZ_ROLE_TP_CD_05
        ,LINE_BIZ_ROLE_TP_CD_06
        ,LINE_BIZ_ROLE_TP_CD_07
        ,LINE_BIZ_ROLE_TP_CD_08
        ,LINE_BIZ_ROLE_TP_CD_09
        ,LINE_BIZ_ROLE_TP_CD_10
        ,LINE_BIZ_ROLE_TP_CD_11
        ,LINE_BIZ_ROLE_TP_CD_12
        ,LINE_BIZ_ROLE_TP_CD_13
        ,LINE_BIZ_ROLE_TP_CD_14
        ,LINE_BIZ_ROLE_TP_CD_15
        ,LINE_BIZ_ROLE_TP_CD_16
        ,LINE_BIZ_ROLE_TP_CD_17
        ,LINE_BIZ_ROLE_TP_CD_18
        ,LINE_BIZ_ROLE_TP_CD_19
        ,LINE_BIZ_ROLE_TP_CD_20
        )
        SELECT
<!-- QC#12571
              TBL.EZTABLEID
            , TBL.EZCANCELFLAG
            , TBL.EZINTIME
            , TBL.EZINTIMEZONE
            , TBL.EZINCOMPANYCODE
            , TBL.EZINUSERID
            , TBL.EZINAPLID
            , TBL.EZUPTIME
            , TBL.EZUPTIMEZONE
            , TBL.EZUPCOMPANYCODE
            , TBL.EZUPUSERID
            , TBL.EZUPAPLID
            , TBL.GLBL_CMPY_CD
 -->
            <isNotNull property="tableNameATRA">
             'ACCT_TRTY_RESRC_LOG'  EZTABLEID
            </isNotNull>
            <isNotNull property="tableNamePTRA">
             'PROS_TRTY_RESRC_LOG'  EZTABLEID
            </isNotNull>
            , '0'                 EZCANCELFLAG
            , #ezintime#          EZINTIME
            , #ezintimezone#      EZINTIMEZONE
            , #ezincompanycode#   EZINCOMPANYCODE
            , #ezinuserid#        EZINUSERID
            , #ezinaplid#         EZINAPLID
            , #ezuptime#          EZUPTIME
            , #ezuptimezone#      EZUPTIMEZONE
            , #ezupcompanycode#   EZUPCOMPANYCODE
            , #ezupuserid#        EZUPUSERID
            , #ezupaplid#         EZUPAPLID
            , #glblCmpyCd#        GLBL_CMPY_CD
            , TBL.DS_ACCT_NUM
            , TBL.DS_ACCT_NM
            , TBL.LOC_NUM
            , TBL.DS_ACCT_TP_CD
            , TBL.ACCT_TRTY_ORG_CD_01
            , TBL.ACCT_TRTY_PSN_CD_01
            , TBL.ACCT_TRTY_TOC_CD_01
            , TBL.ACCT_TRTY_ORG_CD_02
            , TBL.ACCT_TRTY_PSN_CD_02
            , TBL.ACCT_TRTY_TOC_CD_02
            , TBL.ACCT_TRTY_ORG_CD_03
            , TBL.ACCT_TRTY_PSN_CD_03
            , TBL.ACCT_TRTY_TOC_CD_03
            , TBL.ACCT_TRTY_ORG_CD_04
            , TBL.ACCT_TRTY_PSN_CD_04
            , TBL.ACCT_TRTY_TOC_CD_04
            , TBL.ACCT_TRTY_ORG_CD_05
            , TBL.ACCT_TRTY_PSN_CD_05
            , TBL.ACCT_TRTY_TOC_CD_05
            , TBL.ACCT_TRTY_ORG_CD_06
            , TBL.ACCT_TRTY_PSN_CD_06
            , TBL.ACCT_TRTY_TOC_CD_06
            , TBL.ACCT_TRTY_ORG_CD_07
            , TBL.ACCT_TRTY_PSN_CD_07
            , TBL.ACCT_TRTY_TOC_CD_07
            , TBL.ACCT_TRTY_ORG_CD_08
            , TBL.ACCT_TRTY_PSN_CD_08
            , TBL.ACCT_TRTY_TOC_CD_08
            , TBL.ACCT_TRTY_ORG_CD_09
            , TBL.ACCT_TRTY_PSN_CD_09
            , TBL.ACCT_TRTY_TOC_CD_09
            , TBL.ACCT_TRTY_ORG_CD_10
            , TBL.ACCT_TRTY_PSN_CD_10
            , TBL.ACCT_TRTY_TOC_CD_10
            , TBL.ACCT_TRTY_ORG_CD_11
            , TBL.ACCT_TRTY_PSN_CD_11
            , TBL.ACCT_TRTY_TOC_CD_11
            , TBL.ACCT_TRTY_ORG_CD_12
            , TBL.ACCT_TRTY_PSN_CD_12
            , TBL.ACCT_TRTY_TOC_CD_12
            , TBL.ACCT_TRTY_ORG_CD_13
            , TBL.ACCT_TRTY_PSN_CD_13
            , TBL.ACCT_TRTY_TOC_CD_13
            , TBL.ACCT_TRTY_ORG_CD_14
            , TBL.ACCT_TRTY_PSN_CD_14
            , TBL.ACCT_TRTY_TOC_CD_14
            , TBL.ACCT_TRTY_ORG_CD_15
            , TBL.ACCT_TRTY_PSN_CD_15
            , TBL.ACCT_TRTY_TOC_CD_15
            , TBL.ACCT_TRTY_ORG_CD_16
            , TBL.ACCT_TRTY_PSN_CD_16
            , TBL.ACCT_TRTY_TOC_CD_16
            , TBL.ACCT_TRTY_ORG_CD_17
            , TBL.ACCT_TRTY_PSN_CD_17
            , TBL.ACCT_TRTY_TOC_CD_17
            , TBL.ACCT_TRTY_ORG_CD_18
            , TBL.ACCT_TRTY_PSN_CD_18
            , TBL.ACCT_TRTY_TOC_CD_18
            , TBL.ACCT_TRTY_ORG_CD_19
            , TBL.ACCT_TRTY_PSN_CD_19
            , TBL.ACCT_TRTY_TOC_CD_19
            , TBL.ACCT_TRTY_ORG_CD_20
            , TBL.ACCT_TRTY_PSN_CD_20
            , TBL.ACCT_TRTY_TOC_CD_20
            , TBL.LINE_BIZ_ROLE_TP_CD_01
            , TBL.LINE_BIZ_ROLE_TP_CD_02
            , TBL.LINE_BIZ_ROLE_TP_CD_03
            , TBL.LINE_BIZ_ROLE_TP_CD_04
            , TBL.LINE_BIZ_ROLE_TP_CD_05
            , TBL.LINE_BIZ_ROLE_TP_CD_06
            , TBL.LINE_BIZ_ROLE_TP_CD_07
            , TBL.LINE_BIZ_ROLE_TP_CD_08
            , TBL.LINE_BIZ_ROLE_TP_CD_09
            , TBL.LINE_BIZ_ROLE_TP_CD_10
            , TBL.LINE_BIZ_ROLE_TP_CD_11
            , TBL.LINE_BIZ_ROLE_TP_CD_12
            , TBL.LINE_BIZ_ROLE_TP_CD_13
            , TBL.LINE_BIZ_ROLE_TP_CD_14
            , TBL.LINE_BIZ_ROLE_TP_CD_15
            , TBL.LINE_BIZ_ROLE_TP_CD_16
            , TBL.LINE_BIZ_ROLE_TP_CD_17
            , TBL.LINE_BIZ_ROLE_TP_CD_18
            , TBL.LINE_BIZ_ROLE_TP_CD_19
            , TBL.LINE_BIZ_ROLE_TP_CD_20
            <!-- QC#12571
            , TBL.MAN_ENTRY_FLG
             --> 
        FROM
            <isNotNull property="tableNameATRA">
              ACCT_TRTY_RESRC_ASG TBL
            </isNotNull>
            <isNotNull property="tableNamePTRA">
              PROS_TRTY_RESRC_ASG TBL
            </isNotNull>
        WHERE
                TBL.GLBL_CMPY_CD = #glblCmpyCd# 
            AND TBL.EZCANCELFLAG = '0'
    </statement>

    <statement id="searchInsertTBL" parameterClass="Map" resultClass="Map">
<!-- QC#12571 -->
  <isNotNull property="tableNameATRA">
    INSERT INTO ACCT_TRTY_ROLE_ASG_LOG (
  </isNotNull>
  <isNotNull property="tableNamePTRA">
    INSERT INTO PROS_TRTY_ROLE_ASG_LOG ( 
  </isNotNull>
         EZTABLEID
        ,EZCANCELFLAG
        ,EZINTIME
        ,EZINTIMEZONE
        ,EZINCOMPANYCODE
        ,EZINUSERID
        ,EZINAPLID
        ,EZUPTIME
        ,EZUPTIMEZONE
        ,EZUPCOMPANYCODE
        ,EZUPUSERID
        ,EZUPAPLID
        ,GLBL_CMPY_CD
        ,ACCT_TRTY_ROLE_ASG_LOG_PK
        ,DS_ACCT_NUM
        ,LOC_NUM
        ,ORG_CD
        ,LINE_BIZ_ROLE_TP_CD
        ,DS_ACCT_NM
        ,BILL_TO_CUST_CD
        ,SHIP_TO_CUST_CD
        ,DS_ACCT_TP_CD
        ,DS_ACCT_CLS_CD
        ,FIRST_DS_ACCT_GRP_TP_CD
        ,SCD_DS_ACCT_GRP_TP_CD
        ,THIRD_DS_ACCT_GRP_TP_CD
        ,FRTH_DS_ACCT_GRP_TP_CD
        ,FIFTH_DS_ACCT_GRP_TP_CD
        ,INDY_TP_CD
        ,FIRST_LINE_ADDR
        ,SCD_LINE_ADDR
        ,THIRD_LINE_ADDR
        ,FRTH_LINE_ADDR
        ,CTY_ADDR
        ,ST_CD
        ,PROV_NM
        ,CNTY_NM
        ,POST_CD
        ,ORG_NM
        ,TRTY_GRP_TP_CD
        ,ORG_RANK_NUM
        ,TOC_CD
        ,PSN_CD
        ,MAN_ENTRY_FLG
        ,TRTY_TP_CD
        ,ASG_TRTY_ATTRB_CD
        ,NON_SLS_REP_FLG
        ,LINE_BIZ_TP_CD
        ,DS_CUST_SIC_CD 
    )
        SELECT
 <!-- QC#12571 
              TBL.EZTABLEID
            , TBL.EZCANCELFLAG
            , TBL.EZINTIME
            , TBL.EZINTIMEZONE
            , TBL.EZINCOMPANYCODE
            , TBL.EZINUSERID
            , TBL.EZINAPLID
            , TBL.EZUPTIME
            , TBL.EZUPTIMEZONE
            , TBL.EZUPCOMPANYCODE
            , TBL.EZUPUSERID
            , TBL.EZUPAPLID
            , TBL.GLBL_CMPY_CD
 -->
        <isNotNull property="tableNameATRA">
             'ACCT_TRTY_ROLE_ASG_LOG'  EZTABLEID
        </isNotNull>
        <isNotNull property="tableNamePTRA">
             'PROS_TRTY_ROLE_ASG_LOG'  EZTABLEID 
        </isNotNull>
            , '0'                 EZCANCELFLAG
            , #ezintime#          EZINTIME
            , #ezintimezone#      EZINTIMEZONE
            , #ezincompanycode#   EZINCOMPANYCODE
            , #ezinuserid#        EZINUSERID
            , #ezinaplid#         EZINAPLID
            , #ezuptime#          EZUPTIME
            , #ezuptimezone#      EZUPTIMEZONE
            , #ezupcompanycode#   EZUPCOMPANYCODE
            , #ezupuserid#        EZUPUSERID
            , #ezupaplid#         EZUPAPLID
            , #glblCmpyCd#        GLBL_CMPY_CD  
            , TBL.ACCT_TRTY_ROLE_ASG_PK
            , TBL.DS_ACCT_NUM
            , TBL.LOC_NUM
            , TBL.ORG_CD
            , TBL.LINE_BIZ_ROLE_TP_CD
            , TBL.DS_ACCT_NM
            , TBL.BILL_TO_CUST_CD
            , TBL.SHIP_TO_CUST_CD
            , TBL.DS_ACCT_TP_CD
            , TBL.DS_ACCT_CLS_CD
            , TBL.FIRST_DS_ACCT_GRP_TP_CD
            , TBL.SCD_DS_ACCT_GRP_TP_CD
            , TBL.THIRD_DS_ACCT_GRP_TP_CD
            , TBL.FRTH_DS_ACCT_GRP_TP_CD
            , TBL.FIFTH_DS_ACCT_GRP_TP_CD
            , TBL.INDY_TP_CD
            , TBL.FIRST_LINE_ADDR
            , TBL.SCD_LINE_ADDR
            , TBL.THIRD_LINE_ADDR
            , TBL.FRTH_LINE_ADDR
            , TBL.CTY_ADDR
            , TBL.ST_CD
            , TBL.PROV_NM
            , TBL.CNTY_NM
            , TBL.POST_CD
            , TBL.ORG_NM
            , TBL.TRTY_GRP_TP_CD
            , TBL.ORG_RANK_NUM
            , TBL.TOC_CD
            , TBL.PSN_CD
            , TBL.MAN_ENTRY_FLG
            , TBL.TRTY_TP_CD
            , TBL.ASG_TRTY_ATTRB_CD
            , TBL.NON_SLS_REP_FLG
            , TBL.LINE_BIZ_TP_CD
            , TBL.DS_CUST_SIC_CD 
        FROM
        <isNotNull property="tableNameATRA">
              ACCT_TRTY_ROLE_ASG TBL
        </isNotNull>
        <isNotNull property="tableNamePTRA">
              PROS_TRTY_ROLE_ASG TBL 
        </isNotNull>
        WHERE
                TBL.GLBL_CMPY_CD = #glblCmpyCd# 
            AND TBL.EZCANCELFLAG = '0'
    </statement>

</sqlMap>
    