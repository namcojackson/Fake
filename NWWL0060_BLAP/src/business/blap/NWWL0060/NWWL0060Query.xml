<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWWL0060Query">
<statement id="getNtfySbscr" resultClass="Map" parameterClass="Map">
        SELECT DISTINCT
            NS.NTFY_SBSCR_PK
            ,NS.NTFY_SBSCR_FLG
            ,NH.NTFY_HDR_ID
            ,NH.NTFY_HDR_PK
            ,NH.NTFY_HDR_NM
            ,NH.NTFY_HDR_DESC_TXT
            ,NBAT.NTFY_BIZ_AREA_TP_DESC_TXT
            ,NSAT.NTFY_SUB_AREA_TP_DESC_TXT
            ,NDL.NTFY_DIST_LIST_NM
            ,NS.EZUPTIME
            ,NS.EZUPTIMEZONE
        FROM
            $tblNm$ P
            ,NTFY_DIST_LIST_ASG NDLA
            ,NTFY_DIST_LIST NDL
            ,NTFY_DIST_RELN NDR
            ,NTFY_ACT_DTL NAD
            ,NTFY_HDR NH
            ,NTFY_BIZ_AREA_TP NBAT
            ,NTFY_SUB_AREA_TP NSAT
            ,NTFY_SBSCR NS
        WHERE
                P.GLBL_CMPY_CD = #glblCmpyCd#
            AND P.EZCANCELFLAG = '0'
            AND P.$psnColNm$       = #psnCd#
    
            AND P.GLBL_CMPY_CD = NDLA.GLBL_CMPY_CD
            AND P.EZCANCELFLAG = NDLA.EZCANCELFLAG
            AND NDLA.NTFY_DIST_LIST_ASG_ACTV_FLG = 'Y'
            AND 
                $sqlTxt$
            
            AND NDLA.GLBL_CMPY_CD = NDL.GLBL_CMPY_CD
            AND NDLA.EZCANCELFLAG = NDL.EZCANCELFLAG
            AND NDLA.NTFY_DIST_LIST_PK = NDL.NTFY_DIST_LIST_PK
            AND NDL.EFF_FROM_DT               &lt;= #slsDt#
            AND NVL(NDL.EFF_THRU_DT,#maxDt#)  &gt;= #slsDt#
            AND NDL.NTFY_DIST_LIST_ACTV_FLG       = 'Y'
        
            AND NDL.GLBL_CMPY_CD = NDR.GLBL_CMPY_CD
            AND NDL.EZCANCELFLAG = NDR.EZCANCELFLAG
            AND NDL.NTFY_DIST_LIST_PK = NDR.NTFY_DIST_LIST_PK
        
            AND NDR.GLBL_CMPY_CD = NAD.GLBL_CMPY_CD
            AND NDR.EZCANCELFLAG = NAD.EZCANCELFLAG
            AND NDR.NTFY_ACT_DTL_PK = NAD.NTFY_ACT_DTL_PK
        
            AND NAD.GLBL_CMPY_CD = NH.GLBL_CMPY_CD
            AND NAD.EZCANCELFLAG = NH.EZCANCELFLAG
            AND NAD.NTFY_HDR_PK  = NH.NTFY_HDR_PK
            AND NH.EFF_FROM_DT                &lt;= #slsDt#
            AND NVL(NH.EFF_THRU_DT,#maxDt#)   &gt;= #slsDt#
            AND NH.NTFY_HDR_ACTV_FLG          = 'Y'
    
            AND NH.GLBL_CMPY_CD        = NBAT.GLBL_CMPY_CD (+)
            AND NH.EZCANCELFLAG        = NBAT.EZCANCELFLAG (+)
            AND NH.NTFY_BIZ_AREA_TP_CD = NBAT.NTFY_BIZ_AREA_TP_CD (+)
        
            AND NH.GLBL_CMPY_CD        = NSAT.GLBL_CMPY_CD (+)
            AND NH.EZCANCELFLAG        = NSAT.EZCANCELFLAG (+)
            AND NH.NTFY_SUB_AREA_TP_CD = NSAT.NTFY_SUB_AREA_TP_CD (+)
            
            AND NH.GLBL_CMPY_CD      = NS.GLBL_CMPY_CD (+)
            AND NH.EZCANCELFLAG      = NS.EZCANCELFLAG (+)
            AND NH.NTFY_HDR_PK       = NS.NTFY_HDR_PK (+)
            AND NS.NTFY_SBSCR_PSN_CD (+) = #psnCd#

        ORDER BY
            NH.NTFY_HDR_ID
</statement>

</sqlMap>
