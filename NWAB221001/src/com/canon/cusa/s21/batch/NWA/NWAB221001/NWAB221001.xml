<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAB221001">

    <statement id="getImptHdr" parameterClass="Map">
        SELECT
            DIO.DS_IMPT_ORD_PK                           -- Direct Sales Import Order PK
            ,DIO.CPO_SRC_TP_CD                            -- CPO Source Type Code
            ,DIO.ORD_SRC_IMPT_TS                          -- Order Source Import Timestamp
            ,DIO.ORD_SRC_REF_NUM                          -- Order Source Reference Number
            ,DIO.IMPT_STS_CD                              -- Import Status Code
            ,DIO.SYS_SRC_CD                               -- System Source Code
            ,DIO.DS_ORD_CATG_CD                           -- Order Category Code
            ,DIO.DS_ORD_TP_CD                             -- Order Type Code
            ,DIO.DS_ORD_RSN_CD                            -- Direct Sales Order Reason Code
            ,DIO.CPO_ORD_TP_CD                            -- Customer Purchase Order Type Code
            ,DIO.CUST_ISS_PO_NUM                          -- Customer Issue PO Number
            ,DIO.CUST_ISS_PO_DT                           -- Customer Issue PO Date
            ,DIO.BILL_TO_CUST_ACCT_CD                     -- Bill To Customer Account Code
            ,DIO.BILL_TO_CUST_CD                          -- Bill To Customer Code
            ,DIO.SHIP_TO_CUST_ACCT_CD                     -- Ship To Customer Account Code
            ,DIO.SHIP_TO_CUST_CD                          -- Ship To Customer Code
            ,DIO.SELL_TO_CUST_CD                          -- Sell To Customer Code
            ,DIO.SOLD_TO_CUST_LOC_CD                      -- Sold To Customer Location Code
            ,DIO.DROP_SHIP_FLG                            -- Drop Ship Flag
            ,DIO.SHIP_TO_LOC_NM                           -- Ship To Location Name
            ,DIO.SHIP_TO_ADDL_LOC_NM                      -- Ship To Additional Location Name
            ,DIO.SHIP_TO_FIRST_LINE_ADDR                  -- Ship To First Line Address
            ,DIO.SHIP_TO_SCD_LINE_ADDR                    -- Ship To Second Line Address
            ,DIO.SHIP_TO_THIRD_LINE_ADDR                  -- Ship To Third Line One Address
            ,DIO.SHIP_TO_FRTH_LINE_ADDR                   -- Ship to Fourth Line One Address
            ,DIO.SHIP_TO_CTY_ADDR                         -- Ship To City Address
            ,DIO.SHIP_TO_ST_CD                            -- Ship To State Code
            ,DIO.SHIP_TO_PROV_NM                          -- Ship to Province Address
            ,DIO.SHIP_TO_CNTY_NM                          -- Ship To County Name
            ,DIO.SHIP_TO_POST_CD                          -- Ship To Postal Code
            ,DIO.SHIP_TO_CTRY_CD                          -- Ship To Country Code
            ,DIO.SHIP_TO_01_REF_CMNT_TXT                  -- Ship to 01 Reference Comment Text
            ,DIO.SHIP_TO_02_REF_CMNT_TXT                  -- Ship to 02 Reference Comment Text
            ,DIO.ADMIN_PSN_CD                             -- Admin Person Code
            ,DIO.RDD_DT                                   -- RDD Date
            ,DIO.FRT_COND_CD                              -- Freight Condition Code
            ,DIO.SPCL_HDLG_TP_CD                          -- Special Handling Type Code
            ,DIO.CARR_CD                                  -- Carrier Code
            ,DIO.CARR_SVC_LVL_CD                          -- Carrier Service Level
            ,DIO.SHPG_SVC_LVL_CD                          -- Shipping Service Level Code
            ,DIO.FRT_CHRG_TO_CD                           -- Freight Charge To Code
            ,DIO.FRT_CHRG_METH_CD                         -- Freight Charge Method Code
            ,DIO.CARR_ACCT_NUM                            -- Carrier Account Number
            ,DIO.ADD_PMT_TERM_CASH_DISC_CD                -- Payment Term Cash Discount Code
            ,DIO.DS_PMT_METH_CD                           -- WDS Payment Method Code
            ,DIO.PRE_PMT_CHK_NUM                          -- Pre Payment Check Number
            ,DIO.PRE_PMT_AMT                              -- Pre Payment Amount
            ,DIO.PRE_PMT_TP_CD                            -- Pre Payment Type Code
            ,DIO.PRC_BASE_DT                              -- Price Based Date
            ,DIO.NEGO_DEAL_AMT                            -- Negotiated Deal Amount
            ,DIO.PRC_CATG_CD                              -- Price Category Code
            ,DIO.FL_PRC_LIST_CD                           -- Floor Price List Code
            ,DIO.PRC_CONTR_NUM                            -- Price Contract Number
            ,DIO.CSMP_CONTR_NUM                           -- Marketing Program Number
            ,DIO.DLR_REF_NUM                              -- CSA Dealer Reference Number
            ,DIO.ORD_SGN_DT                               -- Order Signed Date
            ,DIO.AQU_NUM                                  -- Acquisition Number
            ,DIO.SLS_REP_TOC_CD                           -- Sales Rep Code
            ,DIO.LOAN_PER_DAYS_AOT                        -- Loan Period Days Amount of Time
            ,DIO.LEASE_CMPY_PO_NUM                        -- Lease Company PO Number
            ,DIO.LEASE_TERM_CD                            -- Lease Term Code
            ,DIO.LEASE_PRCH_OPT_CD                        -- Lease Purchase Optional Code
            ,DIO.LEASE_PMT_FREQ_CD                        -- Lease Payment Frequency Code
            ,DIO.ORD_LOG_TP_CD                            -- Order Log Type Code
            ,DIO.CR_REBIL_RSN_CATG_CD                     -- Credit Rebill Reason Category Code
            ,DIO.ORIG_ORD_NUM                             -- Original Order Number
            ,DIO.SEND_INV_FLG                             -- Send Invoice Flag
            ,DIO.RE_BILL_PAIR_CPO_ORD_NUM                 -- Re Bill Pair CPO Order Number
            ,DIO.ORD_HDR_EDTBL_FLG                        -- Order Header Editable Flag
            ,DCST.ORD_CRAT_MODE_CD                        -- Order Creation Mode Code
            ,DCST.AUTO_DOC_ATT_FLG
            ,DCST.PRC_FRZ_FLG
            ,DIO.DCLN_SVC_CD
            ,DIO.LEASE_TERM_MTH_AOT
        FROM
            DS_IMPT_ORD          DIO        -- Direct Sales Import Order
            ,IMPT_STS            IPS        -- Import Status
            ,CPO_SRC_TP          DCST       -- CPO Source Type
        WHERE
            DIO.EZCANCELFLAG       = '0'
            AND DIO.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIO.EZCANCELFLAG   = IPS.EZCANCELFLAG
            AND DIO.GLBL_CMPY_CD   = IPS.GLBL_CMPY_CD
            AND DIO.IMPT_STS_CD    = IPS.IMPT_STS_CD
            AND IPS.IMPT_BAT_TRGT_FLG = 'Y'
            AND DIO.EZCANCELFLAG   = DCST.EZCANCELFLAG
            AND DIO.GLBL_CMPY_CD   = DCST.GLBL_CMPY_CD
            AND DCST.CPO_SRC_TP_CD = DIO.CPO_SRC_TP_CD
    </statement>

    <statement id="getCpoDtlForEdiAck" parameterClass="Map" resultClass="Map">
        SELECT
             CD.ORD_SRC_REF_LINE_NUM                     -- Order Source Reference Line Number
            ,CD.ORD_SRC_REF_LINE_SUB_NUM                 -- Order Source Reference Sub Line Number
            ,CD.CPO_ORD_NUM                              -- CPO Order Number,Data Examples
            ,CD.CPO_DTL_LINE_NUM                         -- CPO Detail Line Number,Data Examples
            ,CD.CPO_DTL_LINE_SUB_NUM                     -- CPO Detail Line Sub Number,Data Examples
            ,CD.ORD_LINE_STS_CD                          -- Order Line Status Code,Not to be used
            ,CD.ORD_QTY                                  -- Order Quantity,Data Examples
            ,CD.ORD_CUST_UOM_QTY                         -- Ordered Customer UOM Quantity,Data examples
            ,CD.ENT_DEAL_NET_UNIT_PRC_AMT                -- Enter Deal Net Unit Price Amount,Data examples
            ,CD.ENT_CPO_DTL_DEAL_NET_AMT                 -- Enter CPO Detail Deal Net Amount,Data examples
            ,CD.ENT_CPO_DTL_DEAL_SLS_AMT                 -- Enter CPO Detail Deal Sales Amount,Data examples
            ,CD.UNIT_NET_WT                              -- Unit Net Weight
            ,CD.CCY_CD                                   -- Attribute definition, Data examples
            ,CD.RTL_WH_CD                                -- Retail Warehouse Code
            ,CD.RTL_SWH_CD                               -- Retail Sub Warehouse Code
            ,CD.CUST_UOM_CD                              -- Customer UOM Code,Data Examples
            ,CD.MDSE_CD                                  -- Attribute definition, Data examples
            ,CD.CUST_MDSE_CD                             -- Customer Merchandise Code,Data Examples
            ,CD.EXCH_RATE                                -- Attribute Definition,Example Data
        FROM
            CPO_DTL              CD          -- CPO Detail
        WHERE
            CD.EZCANCELFLAG       = '0'
            AND CD.GLBL_CMPY_CD   = #glblCmpyCd#
            AND CD.CPO_ORD_NUM    = #cpoOrdNum#
        ORDER BY
            CD.CPO_DTL_LINE_NUM, CD.CPO_DTL_LINE_SUB_NUM
    </statement>

    <statement id="getSpngPlnForEdiAck" parameterClass="Map" resultClass="Map">
        SELECT
             SP.SHPG_PLN_NUM                             -- Number which manages every Shipping Plan transaction, Data examples
            ,SP.TRX_HDR_NUM                              -- Transaction Header Number,Data examples
            ,SP.TRX_LINE_NUM                             -- Transaction Line Number,Data examples
            ,SP.TRX_LINE_SUB_NUM                         -- Transaction Line Sub Number,Data examples
            ,SP.SHPG_STS_CD                              -- Shipping Status Code,Not to be used
            ,SP.SP_DEAL_UNIT_PRC_AMT                     -- Shipping Plan Deal Unit Price Amount,Data examples
            ,SP.ORD_QTY                                  -- Order Quantity,Data examples
            ,SP.RDD_DT                                   -- RDD Date,Data Examples
            ,SP.PDD_DT                                   -- PDD Date,Data Examples
        FROM
            SHPG_PLN             SP         -- Shipping Plans based upon Distribution(OM)/Allocation(OM) and the Customer Order(OM) information.
        WHERE
            SP.EZCANCELFLAG       = '0'
            AND SP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND SP.TRX_HDR_NUM    = #trxHdrNum#
        ORDER BY
            SP.TRX_LINE_NUM, SP.TRX_LINE_SUB_NUM
    </statement>

    <statement id="getEdiPoAckHdrForEdiAck" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             EPAH.EDI_PO_ACK_HDR_PK                        -- EDI PO ACK Header Primary Key
        FROM
            EDI_PO_ACK_HDR       EPAH       -- EDI PO ACK Header
        WHERE
            EPAH.EZCANCELFLAG         = '0'
            AND EPAH.GLBL_CMPY_CD     = #glblCmpyCd#
            AND  EPAH.ORD_SRC_REF_NUM = #ordSrcRefNum#
    </statement>

    <statement id="getDelyAddlCmnt" parameterClass="Map" resultClass="String">
        SELECT
            DCDI.DELY_ADDL_CMNT_TXT
        FROM
            DS_CPO_DELY_INFO DCDI
        WHERE
                DCDI.EZCANCELFLAG = '0'
            AND DCDI.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCDI.CPO_ORD_NUM  = #cpoOrdNum#
            AND ROWNUM            = 1
    </statement>

</sqlMap>