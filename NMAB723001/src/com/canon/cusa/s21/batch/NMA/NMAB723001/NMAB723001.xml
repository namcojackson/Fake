<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB723001">

    <statement id="getCountWrkData" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*) AS WRK_COUNT
        FROM
            CSMP_CONTR_UPLD_WRK CCW
        WHERE
                CCW.GLBL_CMPY_CD     = #glblCmpyCd#
            AND CCW.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
            AND CCW.EZCANCELFLAG     = '0'
        ORDER BY
            CCW.UPLD_CSV_RQST_ROW_NUM
    </statement>
    
    <statement id="getWrkData" parameterClass="Map" resultClass="Map">
        SELECT
             CCW.UPLD_CSV_RQST_PK
            ,CCW.UPLD_CSV_RQST_ROW_NUM
            ,CCW.DS_ACCT_NUM
            ,CCW.CSMP_NUM
            ,CCW.DLR_REF_NUM
            ,CCW.PRC_CATG_NM
            ,CCW.ORIG_COA_BR_CD
            ,CCW.RTL_DLR_CD
            ,CCW.EFF_FROM_DT
            ,CCW.EFF_THRU_DT
            ,CCW.CUSA_REJ_DT
            ,CCW.ERL_TRMN_DT
            ,CCW.RNW_CSMP_NUM
            ,CCW.UPLFT_EQUIP_RATIO
            ,CCW.UPLFT_ASRY_RATIO
            ,CCW.CSMP_NUM_CMNT_TXT
            ,CCW.CSMP_CONTR_ACTV_FLG

        FROM
            CSMP_CONTR_UPLD_WRK CCW
        WHERE
                CCW.GLBL_CMPY_CD     = #glblCmpyCd#
            AND CCW.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
            AND CCW.EZCANCELFLAG     = '0'
        ORDER BY
            CCW.UPLD_CSV_RQST_ROW_NUM
    </statement>
    <statement id="getDsAcctCust" parameterClass="Map" resultClass="Map">
        SELECT 
            STC.SELL_TO_CUST_CD 
           ,STC.DS_ACCT_NM 
        FROM 
            SELL_TO_CUST STC
        WHERE 
            STC.EZCANCELFLAG = '0'
        AND STC.GLBL_CMPY_CD = #glblCmpyCd#
        AND STC.SELL_TO_CUST_CD = #dsAcctNum#
    </statement>
    <statement id="getPrcCatg" parameterClass="Map" resultClass="Map">
        SELECT 
            PC.PRC_CATG_CD 
           ,PC.PRC_CATG_NM
        FROM 
            PRC_CATG PC
           ,PRC_CTX_RELN PCR
        WHERE 
            PC.EZCANCELFLAG = '0'
        AND PC.GLBL_CMPY_CD = #glblCmpyCd#
        AND PC.PRC_CATG_NM = #prcCatgNm#
        AND PC.EZCANCELFLAG = PCR.EZCANCELFLAG
        AND PC.GLBL_CMPY_CD = PCR.GLBL_CMPY_CD
        AND PC.PRC_LIST_TP_CD = PCR.PRC_LIST_TP_CD
        AND PCR.PRC_CTX_TP_CD = '40'
    </statement>
    <statement id ="getPrcContract" parameterClass="Map"  resultClass="Map">
        SELECT 
            PC.PRC_CONTR_NUM 
           ,PC.PRC_CONTR_NM
        FROM 
            PRC_CONTR PC
        WHERE 
            PC.EZCANCELFLAG = '0'
        AND PC.GLBL_CMPY_CD = #glblCmpyCd#
        AND PC.PRC_CONTR_NUM = #prcContrNum#
    </statement>
    <statement id="getSwhInfo" parameterClass="Map" resultClass="Map">
        SELECT
            S.RTL_SWH_CD
        FROM
            SWH S
        WHERE
                S.GLBL_CMPY_CD = #glblCmpyCd#
            AND S.RTL_SWH_NM   = #rtlSwhNm#
            AND S.EZCANCELFLAG = '0'
        ORDER BY
            S.RTL_SWH_CD
    </statement>
    <statement id="getOrdLineSrcInfo" parameterClass="Map" resultClass="Map">
        SELECT
             OLS.ORD_LINE_SRC_CD
            ,OLS.ORD_LINE_SRC_CATG_CD
        FROM
            ORD_LINE_SRC OLS
        WHERE
                OLS.GLBL_CMPY_CD    = #glblCmpyCd#
            AND OLS.ORD_LINE_SRC_NM = #ordLineSrcNm#
            AND OLS.EZCANCELFLAG    = '0'
        ORDER BY
             OLS.ORD_LINE_SRC_CD
    </statement>
    <statement id ="getDuplicatedUploadWork" parameterClass="Map"  resultClass="Map">
        SELECT 
            CC.UPLD_CSV_RQST_PK
           ,CC.UPLD_CSV_RQST_ROW_NUM 
        FROM 
            CSMP_CONTR_UPLD_WRK CC
        WHERE 
            CC.EZCANCELFLAG = '0'
        AND CC.GLBL_CMPY_CD = #glblCmpyCd#
        AND UPLD_CSV_RQST_PK = #upldCsvRqstPk#
        AND CC.UPLD_CSV_RQST_ROW_NUM != #upldCsvRqstRowNum#
        AND CC.DS_ACCT_NUM = #dsAcctNum#
        AND CC.DLR_REF_NUM = #dlrRefNum#
        AND (CC.EFF_FROM_DT &lt;= #effFromDt#
        AND NVL(CC.EFF_THRU_DT, '99991231') &gt;= #effFromDt#)
    </statement>
    <statement id ="getDuplicated" parameterClass="Map"  resultClass="Map">
        SELECT 
            CC.CSMP_CONTR_PK 
        FROM 
            CSMP_CONTR CC
        WHERE 
            CC.EZCANCELFLAG = '0'
        AND CC.GLBL_CMPY_CD = #glblCmpyCd#
        AND CC.DS_ACCT_NUM = #dsAcctNum#
        AND CC.DLR_REF_NUM = #dlrRefNum#
        AND (CC.EFF_FROM_DT &lt; #effFromDt#
        AND NVL(CC.EFF_THRU_DT, '99991231') &gt;= #effFromDt#)
        AND CC.EFF_FROM_DT != (SELECT MAX(CC1.EFF_FROM_DT) FROM CSMP_CONTR CC1 
                               WHERE CC1.EZCANCELFLAG = '0' AND CC1.GLBL_CMPY_CD = #glblCmpyCd#
                               AND CC1.DS_ACCT_NUM = #dsAcctNum# AND CC1.DLR_REF_NUM = #dlrRefNum#) 
    </statement>
    <statement id ="getDevidedLine" parameterClass="Map"  resultClass="Map">
        SELECT 
            CC.CSMP_CONTR_PK 
        FROM 
            CSMP_CONTR CC
        WHERE 
            CC.EZCANCELFLAG = '0'
        AND CC.GLBL_CMPY_CD = #glblCmpyCd#
        AND CC.DS_ACCT_NUM = #dsAcctNum#
        AND CC.DLR_REF_NUM = #dlrRefNum#
        AND (CC.EFF_FROM_DT &lt; #effFromDt#
        AND NVL(CC.EFF_THRU_DT, '99991231') &gt;= #effFromDt#)
        AND CC.EFF_FROM_DT = (SELECT MAX(CC1.EFF_FROM_DT) FROM CSMP_CONTR CC1 
                               WHERE CC1.EZCANCELFLAG = '0' AND CC1.GLBL_CMPY_CD = #glblCmpyCd#
                               AND CC1.DS_ACCT_NUM = #dsAcctNum# AND CC1.DLR_REF_NUM = #dlrRefNum#) 
    </statement>
    <statement id ="getCsmpContr" parameterClass="Map"  resultClass="Map">
        SELECT 
            CC.CSMP_CONTR_PK 
        FROM 
            CSMP_CONTR CC
        WHERE 
            CC.EZCANCELFLAG = '0'
        AND CC.GLBL_CMPY_CD = #glblCmpyCd#
        AND CC.DS_ACCT_NUM = #dsAcctNum#
        AND CC.DLR_REF_NUM = #dlrRefNum#
        AND CC.EFF_FROM_DT = #effFromDt#
    </statement>
</sqlMap>
