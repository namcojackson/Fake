<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB121001">

    <statement id="getTrgtDtRec" parameterClass="Map" resultClass="BigDecimal">
        SELECT COUNT(1)
        FROM
            DMN_ACCT_TRTY            TRTY
        WHERE 
            TRTY.GLBL_CMPY_CD         = #glblCmpyCd#
        AND TRTY.DWH_TRGT_DT          = #trgtDt#
        AND TRTY.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getMainData" parameterClass="Map" resultClass="Map">
        SELECT
             ATRA.ACCT_TRTY_ROLE_ASG_PK     AS ACCT_TRTY_ROLE_ASG_PK
            ,ATRA.DS_ACCT_NUM               AS DS_ACCT_NUM
            ,ATRA.LOC_NUM                   AS LOC_NUM
            ,ATRA.ORG_CD                    AS ORG_CD
            ,ATRA.ORG_NM                    AS ORG_NM
            ,ATRA.LINE_BIZ_ROLE_TP_CD       AS LINE_BIZ_ROLE_TP_CD
            ,LBRT.LINE_BIZ_ROLE_TP_DESC_TXT AS LINE_BIZ_ROLE_TP_DESC_TXT
            ,ATRA.DS_ACCT_NM                AS DS_ACCT_NM
            ,ATRA.BILL_TO_CUST_CD           AS BILL_TO_CUST_CD
            ,ATRA.SHIP_TO_CUST_CD           AS SHIP_TO_CUST_CD
            ,ATRA.DS_ACCT_TP_CD             AS DS_ACCT_TP_CD
            ,DAT.DS_ACCT_TP_DESC_TXT        AS DS_ACCT_TP_DESC_TXT
            ,ATRA.DS_ACCT_CLS_CD            AS DS_ACCT_CLS_CD
            ,DAC.DS_ACCT_CLS_DESC_TXT       AS DS_ACCT_CLS_DESC_TXT
            ,ATRA.FIRST_DS_ACCT_GRP_TP_CD   AS FIRST_DS_ACCT_GRP_TP_CD
            ,DAG1.DS_ACCT_GRP_DESC_TXT      AS FIRST_DS_ACCT_GRP_DESC_TXT
            ,ATRA.SCD_DS_ACCT_GRP_TP_CD     AS SCD_DS_ACCT_GRP_TP_CD
            ,DAG2.DS_ACCT_GRP_DESC_TXT      AS SCD_DS_ACCT_GRP_DESC_TXT
            ,ATRA.THIRD_DS_ACCT_GRP_TP_CD   AS THIRD_DS_ACCT_GRP_TP_CD
            ,DAG3.DS_ACCT_GRP_DESC_TXT      AS THIRD_DS_ACCT_GRP_DESC_TXT
            ,ATRA.FRTH_DS_ACCT_GRP_TP_CD    AS FRTH_DS_ACCT_GRP_TP_CD
            ,DAG4.DS_ACCT_GRP_DESC_TXT      AS FRTH_DS_ACCT_GRP_DESC_TXT
            ,ATRA.FIFTH_DS_ACCT_GRP_TP_CD   AS FIFTH_DS_ACCT_GRP_TP_CD
            ,DAG5.DS_ACCT_GRP_DESC_TXT      AS FIFTH_DS_ACCT_GRP_DESC_TXT
            ,ATRA.FIRST_LINE_ADDR           AS FIRST_LINE_ADDR
            ,ATRA.SCD_LINE_ADDR             AS SCD_LINE_ADDR
            ,ATRA.THIRD_LINE_ADDR           AS THIRD_LINE_ADDR
            ,ATRA.FRTH_LINE_ADDR            AS FRTH_LINE_ADDR
            ,ATRA.CTY_ADDR                  AS CTY_ADDR
            ,ATRA.ST_CD                     AS ST_CD
            ,ATRA.PROV_NM                   AS PROV_NM
            ,ATRA.CNTY_NM                   AS CNTY_NM
            ,ATRA.POST_CD                   AS POST_CD
            ,ATRA.TRTY_GRP_TP_CD            AS TRTY_GRP_TP_CD
            ,ATRA.ORG_RANK_NUM              AS ORG_RANK_NUM
            ,ATRA.TOC_CD                    AS TOC_CD
            ,SO.TOC_NM                      AS TOC_NM
            ,SP.PSN_CD                      AS PSN_CD
            ,SP.PSN_NUM                     AS PSN_NUM
            ,SP.PSN_FIRST_NM                AS PSN_FIRST_NM
            ,SP.PSN_LAST_NM                 AS PSN_LAST_NM
            ,ATRA.MAN_ENTRY_FLG             AS MAN_ENTRY_FLG
            ,ATRA.TRTY_TP_CD                AS TRTY_TP_CD
            ,TT.TRTY_TP_DESC_TXT            AS TRTY_TP_DESC_TXT
            ,ATRA.ASG_TRTY_ATTRB_CD         AS ASG_TRTY_ATTRB_CD
            ,ATA.ASG_TRTY_ATTRB_DESC_TXT    AS ASG_TRTY_ATTRB_DESC_TXT
            ,ATRA.NON_SLS_REP_FLG           AS NON_SLS_REP_FLG
            ,ATRA.LINE_BIZ_TP_CD            AS LINE_BIZ_TP_CD
            ,ATRA.DS_CUST_SIC_CD            AS DS_CUST_SIC_CD
        FROM
             ACCT_TRTY_ROLE_ASG ATRA
            ,ASG_TRTY_ATTRB     ATA
            ,DS_ACCT_GRP        DAG1
            ,DS_ACCT_GRP        DAG2
            ,DS_ACCT_GRP        DAG3
            ,DS_ACCT_GRP        DAG4
            ,DS_ACCT_GRP        DAG5
            ,LINE_BIZ_ROLE_TP   LBRT
            ,TRTY_TP            TT
            ,S21_PSN            SP
            ,S21_ORG            SO
            ,DS_ACCT_TP         DAT
            ,DS_ACCT_CLS        DAC
       WHERE
               ATRA.GLBL_CMPY_CD            = #glblCmpyCd#
           AND ATRA.GLBL_CMPY_CD            = ATA.GLBL_CMPY_CD(+)
           AND ATRA.ASG_TRTY_ATTRB_CD       = ATA.ASG_TRTY_ATTRB_CD(+)
           AND ATRA.GLBL_CMPY_CD            = DAG1.GLBL_CMPY_CD(+)
           AND ATRA.FIRST_DS_ACCT_GRP_TP_CD = DAG1.DS_ACCT_GRP_CD(+)
           AND ATRA.GLBL_CMPY_CD            = DAG2.GLBL_CMPY_CD(+)
           AND ATRA.SCD_DS_ACCT_GRP_TP_CD   = DAG2.DS_ACCT_GRP_CD(+)
           AND ATRA.GLBL_CMPY_CD            = DAG3.GLBL_CMPY_CD(+)
           AND ATRA.THIRD_DS_ACCT_GRP_TP_CD = DAG3.DS_ACCT_GRP_CD(+)
           AND ATRA.GLBL_CMPY_CD            = DAG4.GLBL_CMPY_CD(+)
           AND ATRA.FRTH_DS_ACCT_GRP_TP_CD  = DAG4.DS_ACCT_GRP_CD(+)
           AND ATRA.GLBL_CMPY_CD            = DAG5.GLBL_CMPY_CD(+)
           AND ATRA.FIFTH_DS_ACCT_GRP_TP_CD = DAG5.DS_ACCT_GRP_CD(+)
           AND ATRA.GLBL_CMPY_CD            = LBRT.GLBL_CMPY_CD(+)
           AND ATRA.LINE_BIZ_TP_CD          = LBRT.LINE_BIZ_ROLE_TP_CD(+)
           AND ATRA.GLBL_CMPY_CD            = TT.GLBL_CMPY_CD(+)
           AND ATRA.TRTY_TP_CD              = TT.TRTY_TP_CD(+)
           AND ATRA.GLBL_CMPY_CD            = SP.GLBL_CMPY_CD(+)
           AND ATRA.PSN_CD                  = SP.PSN_CD(+)
           AND ATRA.GLBL_CMPY_CD            = SO.GLBL_CMPY_CD(+)
           AND ATRA.TOC_CD                  = SO.TOC_CD(+)
           AND ATRA.GLBL_CMPY_CD            = DAT.GLBL_CMPY_CD(+)
           AND ATRA.DS_ACCT_TP_CD           = DAT.DS_ACCT_TP_CD(+)
           AND ATRA.GLBL_CMPY_CD            = DAC.GLBL_CMPY_CD(+)
           AND ATRA.DS_ACCT_CLS_CD          = DAC.DS_ACCT_CLS_CD(+)
           AND ATRA.EZCANCELFLAG            = '0'
           AND ATA.EZCANCELFLAG(+)          = '0'
           AND DAG1.EZCANCELFLAG(+)         = '0'
           AND DAG2.EZCANCELFLAG(+)         = '0'
           AND DAG3.EZCANCELFLAG(+)         = '0'
           AND DAG4.EZCANCELFLAG(+)         = '0'
           AND DAG5.EZCANCELFLAG(+)         = '0'
           AND LBRT.EZCANCELFLAG(+)         = '0'
           AND TT.EZCANCELFLAG(+)           = '0'
           AND SP.EZCANCELFLAG(+)           = '0'
           AND SO.EZCANCELFLAG(+)           = '0'
           AND DAT.EZCANCELFLAG(+)          = '0'
           AND DAC.EZCANCELFLAG(+)          = '0'
    </statement>

</sqlMap>
