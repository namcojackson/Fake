<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWXC012001">
    <statement id="selectPromotionHeader" parameterClass="Map" resultClass="Map">
<!-- 2016/10/31 QC#11618 UPD START
        WITH PRC_GRP_V AS (
            SELECT A.GLBL_CMPY_CD
                  ,A.PRC_GRP_PK 
            FROM PRC_GRP A
            WHERE
                A.GLBL_CMPY_CD = #glblCmpyCd#
            AND A.EZCANCELFLAG = '0'
            AND A.PRC_GRP_TP_CD = #prcGrpTpCd#
            AND A.ACTV_FLG = #actvFlg#
            AND A.EFF_FROM_DT &lt;= #prcBaseDt#
            AND (A.EFF_THRU_DT &gt;= #prcBaseDt# OR A.EFF_THRU_DT IS NULL)
            AND (
                SELECT COUNT(DISTINCT PRC_GRP_TRGT_ATTRB_CD) FROM PRC_GRP_DTL B
                WHERE
                    A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
                AND A.EZCANCELFLAG = B.EZCANCELFLAG
                AND A.PRC_GRP_PK = B.PRC_GRP_PK
                AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
            ) = ( 
                SELECT COUNT(DISTINCT PRC_GRP_TRGT_ATTRB_CD) FROM PRC_GRP_DTL B
                WHERE
                    A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
                AND A.EZCANCELFLAG = B.EZCANCELFLAG
                AND A.PRC_GRP_PK = B.PRC_GRP_PK
                AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                AND
                (
                    CASE B.PRC_GRP_TRGT_ATTRB_CD
                    WHEN #PrcGrpTrgtAttrbCd_14#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                            <isNotNull property="dsAcctNum_BL">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_BL# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                            </isNotNull>
                            <isNotNull property="dsAcctNum_SH">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_SH# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                            </isNotNull>
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_15#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                            <isNotNull property="dsAcctNm_BL">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_BL# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                            </isNotNull>
                            <isNotNull property="dsAcctNm_SH">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_SH# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                            </isNotNull>
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_16#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            <isNotNull property="dsCustSicCd_BL">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            <isNotNull property="dsCustSicCd_SH">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_17#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            <isNotNull property="locNum_BL">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            <isNotNull property="locNum_SH">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_18#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            <isNotNull property="dsCustSicCd_BL">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            <isNotNull property="dsCustSicCd_SH">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_19#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            <isNotNull property="dsAcctTpCd_BL">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            <isNotNull property="dsAcctTpCd_SH">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_20#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            <isNotNull property="dsAcctDlrCd_BL">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            <isNotNull property="dsAcctDlrCd_SH">
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            </isNotNull>
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_21#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #csmpNum# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #csmpNum# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#csmpNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #csmpNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_22#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dlrRefNum# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dlrRefNum# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dlrRefNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dlrRefNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            ELSE 0
                        END
                    WHEN #PrcGrpTrgtAttrbCd_24#  THEN
                        CASE
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #prcContrNum# = B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #prcContrNum# != B.PRC_GRP_FROM_TXT  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#prcContrNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                            WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #prcContrNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                            ELSE 0
                        END
                    END
                ) = 1
            )
            AND EXISTS (
                SELECT 1 FROM PRC_GRP_DTL B
                WHERE
                    A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
                AND A.EZCANCELFLAG = B.EZCANCELFLAG
                AND A.PRC_GRP_PK = B.PRC_GRP_PK
                AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
            )
        )
-->
        WITH PRC_GRP_V AS (
            SELECT A.GLBL_CMPY_CD
                  ,A.PRC_GRP_PK 
            FROM PRC_GRP A,
            (
                SELECT
                     B.GLBL_CMPY_CD
                    ,B.PRC_GRP_PK
                    ,B.EZCANCELFLAG
                    ,COUNT(DISTINCT B.PRC_GRP_TRGT_ATTRB_CD) AS CNT1
                    ,COUNT(DISTINCT
                        CASE B.PRC_GRP_TRGT_ATTRB_CD
                            WHEN #PrcGrpTrgtAttrbCd_14#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum# LIKE B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    <isNotNull property="dsAcctNum_BL">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_BL# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_BL# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_BL# LIKE B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    <isNotNull property="dsAcctNum_SH">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_SH# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_SH# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_SH# LIKE B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_15#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm# LIKE B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    <isNotNull property="dsAcctNm_BL">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_BL# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_BL# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_BL# LIKE B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    <isNotNull property="dsAcctNm_SH">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_SH# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_SH# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_SH# LIKE B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_16#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    <isNotNull property="dsCustSicCd_BL">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_BL# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_BL# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    <isNotNull property="dsCustSicCd_SH">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                    </isNotNull>
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_17#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    <isNotNull property="locNum_BL">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_BL# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_BL# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_BL# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    <isNotNull property="locNum_SH">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_SH# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_SH# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_SH# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_18#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    <isNotNull property="dsCustSicCd_BL">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_BL# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_BL# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    <isNotNull property="dsCustSicCd_SH">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_SH# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_SH# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_19#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    <isNotNull property="dsAcctTpCd_BL">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_BL# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_BL# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    <isNotNull property="dsAcctTpCd_SH">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_SH# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_SH# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_20#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    <isNotNull property="dsAcctDlrCd_BL">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_BL# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_BL# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    <isNotNull property="dsAcctDlrCd_SH">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_SH# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_SH# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_21#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #csmpNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #csmpNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#csmpNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #csmpNum# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_22#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dlrRefNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dlrRefNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dlrRefNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dlrRefNum# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    ELSE NULL
                                END
                            WHEN #PrcGrpTrgtAttrbCd_24#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #prcContrNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #prcContrNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#prcContrNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #prcContrNum# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    ELSE NULL
                                END
                            <!-- S21_NA#18789 add start -->
                            WHEN #PrcGrpTrgtAttrbCd_28#  THEN
                                CASE
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd01# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd01# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd01# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd01# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    <isNotNull property="coaChCd_BL">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd_BL# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd_BL# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    <isNotNull property="coaChCd_SH">
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd_SH# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd_SH# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN B.PRC_GRP_TRGT_ATTRB_CD
                                    </isNotNull>
                                    ELSE NULL
                                END
                            <!-- S21_NA#18789 add end -->
                        END
                    ) AS CNT2
                FROM
                    PRC_GRP_DTL B
                WHERE
                    B.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                GROUP BY
                     B.GLBL_CMPY_CD
                    ,B.PRC_GRP_PK
                    ,B.EZCANCELFLAG
            ) B2
            WHERE
                A.GLBL_CMPY_CD = #glblCmpyCd#
            AND A.EZCANCELFLAG = '0'
            AND A.PRC_GRP_TP_CD = #prcGrpTpCd#
            AND A.ACTV_FLG = #actvFlg#
            AND A.EFF_FROM_DT &lt;= #prcBaseDt#
            AND (A.EFF_THRU_DT &gt;= #prcBaseDt# OR A.EFF_THRU_DT IS NULL)
            AND B2.GLBL_CMPY_CD  = A.GLBL_CMPY_CD
            AND B2.PRC_GRP_PK    = A.PRC_GRP_PK
            AND B2.EZCANCELFLAG  = A.EZCANCELFLAG
            AND B2.CNT1          = B2.CNT2
        )
<!-- 2016/10/31 QC#11618 UPD E N D -->
<!-- PRTY = 1 -->
        SELECT 
            '1'                 AS PRTY_NUM
           ,PMP.PRC_MKT_PRMO_PK AS PRC_MKT_PRMO_PK
        FROM
            PRC_MKT_PRMO PMP
           ,PRC_MKT_PRMO_TP PMPT
           ,PRC_MKT_PRMO_AUDC_CTRL PMPAC
        WHERE
            PMP.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMP.EZCANCELFLAG = '0'
        AND PMP.ACTV_FLG = #actvFlg#  -- Y
        AND PMP.DEL_FLG = #delFlg# -- N
        AND PMP.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMP.EFF_THRU_DT &gt;= #prcBaseDt# OR PMP.EFF_THRU_DT IS NULL)
        AND PMP.GLBL_CMPY_CD = PMPT.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPT.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_TP_CD = PMPT.PRC_MKT_PRMO_TP_CD
        AND PMP.GLBL_CMPY_CD = PMPAC.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPAC.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_PK = PMPAC.PRC_MKT_PRMO_PK 
        AND PMPAC.PUB_FLG_01 = #pubFlg_N#  --N
        AND (PMPAC.CSMP_NUM_01 IS NOT NULL OR PMPAC.CSMP_NUM_02 IS NOT NULL OR PMPAC.CSMP_NUM_03 IS NOT NULL)
        AND (PMPAC.CSMP_NUM_01 = #csmpNum# OR PMPAC.CSMP_NUM_01 IS NULL )
        AND (PMPAC.PRC_GRP_PK_01 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_01 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.CSMP_NUM_02 = #csmpNum# OR PMPAC.CSMP_NUM_02 IS NULL )
        AND (PMPAC.PRC_GRP_PK_02 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_02 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.CSMP_NUM_03 = #csmpNum# OR PMPAC.CSMP_NUM_03 IS NULL )
        AND (PMPAC.PRC_GRP_PK_03 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_03 = WPG.PRC_GRP_PK
            ))
        AND PMPAC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMPAC.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPAC.EFF_THRU_DT IS NULL)
        UNION ALL
<!-- PRTY = 2 Sold to Account Number + Line Business Type Code -->
        SELECT 
            '2'                 AS PRTY_NUM
           ,PMP.PRC_MKT_PRMO_PK AS PRC_MKT_PRMO_PK
        FROM
            PRC_MKT_PRMO PMP
           ,PRC_MKT_PRMO_TP PMPT
           ,PRC_MKT_PRMO_AUDC_CTRL PMPAC
        WHERE
            PMP.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMP.EZCANCELFLAG = '0'
        AND PMP.ACTV_FLG = #actvFlg#  -- Y
        AND PMP.DEL_FLG = #delFlg# -- N
        AND PMP.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMP.EFF_THRU_DT &gt;= #prcBaseDt# OR PMP.EFF_THRU_DT IS NULL)
        AND PMP.GLBL_CMPY_CD = PMPT.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPT.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_TP_CD = PMPT.PRC_MKT_PRMO_TP_CD
        AND PMP.GLBL_CMPY_CD = PMPAC.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPAC.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_PK = PMPAC.PRC_MKT_PRMO_PK 
        AND PMPAC.PUB_FLG_01 = #pubFlg_N#  --N
        <isNotNull property="lineBizTpCdAll">
        AND (PMPAC.LINE_BIZ_TP_CD_01 IS NOT NULL)
        </isNotNull>
        <isNull property="lineBizTpCdAll">
        AND (PMPAC.LINE_BIZ_TP_CD_01 = #lineBizTpCd#)
        </isNull>
        AND (PMPAC.DS_ACCT_NUM_01 IS NOT NULL OR PMPAC.DS_ACCT_NUM_02 IS NOT NULL OR PMPAC.DS_ACCT_NUM_03 IS NOT NULL)
        AND (PMPAC.DS_ACCT_NUM_01 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_01 IS NULL)
        AND (PMPAC.PRC_GRP_PK_01 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_01 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.DS_ACCT_NUM_02 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_02 IS NULL)
        AND (PMPAC.PRC_GRP_PK_02 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_02 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.DS_ACCT_NUM_03 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_03 IS NULL)
        AND (PMPAC.PRC_GRP_PK_03 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_03 = WPG.PRC_GRP_PK
            ))
        AND PMPAC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMPAC.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPAC.EFF_THRU_DT IS NULL)
        UNION ALL
<!-- PRTY = 3 Sold to Account Number -->
        SELECT
            '3'                 AS PRTY_NUM
           ,PMP.PRC_MKT_PRMO_PK AS PRC_MKT_PRMO_PK
        FROM
            PRC_MKT_PRMO PMP
           ,PRC_MKT_PRMO_TP PMPT
           ,PRC_MKT_PRMO_AUDC_CTRL PMPAC
        WHERE
            PMP.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMP.EZCANCELFLAG = '0'
        AND PMP.ACTV_FLG = #actvFlg#  -- Y
        AND PMP.DEL_FLG = #delFlg# -- N
        AND PMP.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMP.EFF_THRU_DT &gt;= #prcBaseDt# OR PMP.EFF_THRU_DT IS NULL)
        AND PMP.GLBL_CMPY_CD = PMPT.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPT.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_TP_CD = PMPT.PRC_MKT_PRMO_TP_CD
        AND PMP.GLBL_CMPY_CD = PMPAC.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPAC.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_PK = PMPAC.PRC_MKT_PRMO_PK 
        AND PMPAC.PUB_FLG_01 = #pubFlg_N#  --N
        AND (PMPAC.DS_ACCT_NUM_01 IS NOT NULL OR PMPAC.DS_ACCT_NUM_02 IS NOT NULL OR PMPAC.DS_ACCT_NUM_03 IS NOT NULL)
        AND (PMPAC.DS_ACCT_NUM_01 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_01 IS NULL)
        AND (PMPAC.PRC_GRP_PK_01 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_01 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.DS_ACCT_NUM_02 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_02 IS NULL)
        AND (PMPAC.PRC_GRP_PK_02 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_02 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.DS_ACCT_NUM_03 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_03 IS NULL)
        AND (PMPAC.PRC_GRP_PK_03 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_03 = WPG.PRC_GRP_PK
            ))
        AND PMPAC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMPAC.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPAC.EFF_THRU_DT IS NULL)
        UNION ALL
<!-- PRTY = 4 Customer Pricing Group -->
        SELECT
            '4'                 AS PRTY_NUM
           ,PMP.PRC_MKT_PRMO_PK AS PRC_MKT_PRMO_PK
        FROM
            PRC_MKT_PRMO PMP
           ,PRC_MKT_PRMO_TP PMPT
           ,PRC_MKT_PRMO_AUDC_CTRL PMPAC
        WHERE
            PMP.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMP.EZCANCELFLAG = '0'
        AND PMP.ACTV_FLG = #actvFlg#  -- Y
        AND PMP.DEL_FLG = #delFlg# -- N
        AND PMP.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMP.EFF_THRU_DT &gt;= #prcBaseDt# OR PMP.EFF_THRU_DT IS NULL)
        AND PMP.GLBL_CMPY_CD = PMPT.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPT.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_TP_CD = PMPT.PRC_MKT_PRMO_TP_CD
        AND PMP.GLBL_CMPY_CD = PMPAC.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPAC.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_PK = PMPAC.PRC_MKT_PRMO_PK 
        AND PMPAC.PUB_FLG_01 = #pubFlg_N#  --N
        AND (PMPAC.PRC_GRP_PK_01 IS NOT NULL OR PMPAC.PRC_GRP_PK_02 IS NOT NULL OR PMPAC.PRC_GRP_PK_03 IS NOT NULL)
        AND (PMPAC.PRC_GRP_PK_01 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_01 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.PRC_GRP_PK_02 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_02 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.PRC_GRP_PK_03 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_03 = WPG.PRC_GRP_PK
            ))
        AND PMPAC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMPAC.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPAC.EFF_THRU_DT IS NULL)
        UNION ALL
<!-- PRTY = 5  Sold to Account Coa Channel Code -->
        SELECT
            '5'                 AS PRTY_NUM
           ,PMP.PRC_MKT_PRMO_PK AS PRC_MKT_PRMO_PK
        FROM
            PRC_MKT_PRMO PMP
           ,PRC_MKT_PRMO_TP PMPT
           ,PRC_MKT_PRMO_AUDC_CTRL PMPAC
        WHERE
            PMP.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMP.EZCANCELFLAG = '0'
        AND PMP.ACTV_FLG = #actvFlg#  -- Y
        AND PMP.DEL_FLG = #delFlg# -- N
        AND PMP.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMP.EFF_THRU_DT &gt;= #prcBaseDt# OR PMP.EFF_THRU_DT IS NULL)
        AND PMP.GLBL_CMPY_CD = PMPT.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPT.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_TP_CD = PMPT.PRC_MKT_PRMO_TP_CD
        AND PMP.GLBL_CMPY_CD = PMPAC.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPAC.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_PK = PMPAC.PRC_MKT_PRMO_PK 
        AND PMPAC.PUB_FLG_01 = #pubFlg_N#  --N
        AND (PMPAC.COA_CH_CD_01 = #coaChCd01#)
        AND PMPAC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMPAC.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPAC.EFF_THRU_DT IS NULL)
        UNION ALL
<!-- PRTY = 6  ALL -->
        SELECT 
            '6'                 AS PRTY_NUM
           ,PMP.PRC_MKT_PRMO_PK AS PRC_MKT_PRMO_PK
        FROM
            PRC_MKT_PRMO PMP
           ,PRC_MKT_PRMO_TP PMPT
           ,PRC_MKT_PRMO_AUDC_CTRL PMPAC
        WHERE
            PMP.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMP.EZCANCELFLAG = '0'
        AND PMP.ACTV_FLG = #actvFlg#  -- Y
        AND PMP.DEL_FLG = #delFlg# -- N
        AND PMP.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMP.EFF_THRU_DT &gt;= #prcBaseDt# OR PMP.EFF_THRU_DT IS NULL)
        AND PMP.GLBL_CMPY_CD = PMPT.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPT.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_TP_CD = PMPT.PRC_MKT_PRMO_TP_CD
        AND PMP.GLBL_CMPY_CD = PMPAC.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPAC.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_PK = PMPAC.PRC_MKT_PRMO_PK 
        AND PMPAC.PUB_FLG_01 = #pubFlg_N#  --N
        <isNull property="lineBizTpCdAll">
        AND (PMPAC.LINE_BIZ_TP_CD_01 = #lineBizTpCd# OR PMPAC.LINE_BIZ_TP_CD_01 IS NULL)
        </isNull>
        AND (PMPAC.DS_ACCT_NUM_01 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_01 IS NULL)
        AND (PMPAC.COA_CH_CD_01 = #coaChCd01#  OR PMPAC.COA_CH_CD_01 IS NULL)
        AND (PMPAC.DS_ACCT_GRP_CD_01 = #dsAcctGrpCd#  OR PMPAC.DS_ACCT_GRP_CD_01 IS NULL)
        AND (PMPAC.COA_BR_CD_01 = #coaBrCd#  OR PMPAC.COA_BR_CD_01 IS NULL)
        AND (PMPAC.CSMP_NUM_01 = #csmpNum# OR PMPAC.CSMP_NUM_01 IS NULL )
        AND (PMPAC.PRC_GRP_PK_01 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_01 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.DS_ACCT_NUM_02 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_02 IS NULL)
        AND (PMPAC.DS_ACCT_GRP_CD_02 = #dsAcctGrpCd#  OR PMPAC.DS_ACCT_GRP_CD_02 IS NULL)
        AND (PMPAC.COA_BR_CD_02 = #coaBrCd#  OR PMPAC.COA_BR_CD_02 IS NULL)
        AND (PMPAC.CSMP_NUM_02 = #csmpNum# OR PMPAC.CSMP_NUM_02 IS NULL )
        AND (PMPAC.PRC_GRP_PK_02 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_02 = WPG.PRC_GRP_PK
            ))
        AND (PMPAC.DS_ACCT_NUM_03 = #dsAcctNum# OR PMPAC.DS_ACCT_NUM_03 IS NULL)
        AND (PMPAC.DS_ACCT_GRP_CD_03 = #dsAcctGrpCd#  OR PMPAC.DS_ACCT_GRP_CD_03 IS NULL)
        AND (PMPAC.COA_BR_CD_03 = #coaBrCd#  OR PMPAC.COA_BR_CD_03 IS NULL)
        AND (PMPAC.CSMP_NUM_03 = #csmpNum# OR PMPAC.CSMP_NUM_03 IS NULL )
        AND (PMPAC.PRC_GRP_PK_03 IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE PMPAC.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   PMPAC.PRC_GRP_PK_03 = WPG.PRC_GRP_PK
            ))
        AND PMPAC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMPAC.LINE_BIZ_TP_CD_01 IS NOT NULL
          OR PMPAC.DS_ACCT_NUM_01 IS NOT NULL
          OR PMPAC.COA_CH_CD_01 IS NOT NULL
          OR PMPAC.DS_ACCT_GRP_CD_01 IS NOT NULL 
          OR PMPAC.COA_BR_CD_01 IS NOT NULL
          OR PMPAC.CSMP_NUM_01 IS NOT NULL
          OR PMPAC.PRC_GRP_PK_01 IS NOT NULL)
        UNION ALL
<!-- PRTY = 7  Public -->
        SELECT 
            '7'                 AS PRTY_NUM
           ,PMP.PRC_MKT_PRMO_PK AS PRC_MKT_PRMO_PK
        FROM
            PRC_MKT_PRMO PMP
           ,PRC_MKT_PRMO_TP PMPT
           ,PRC_MKT_PRMO_AUDC_CTRL PMPAC
        WHERE
            PMP.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMP.EZCANCELFLAG = '0'
        AND PMP.ACTV_FLG = #actvFlg#  -- Y
        AND PMP.DEL_FLG = #delFlg# -- N
        AND PMP.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMP.EFF_THRU_DT &gt;= #prcBaseDt# OR PMP.EFF_THRU_DT IS NULL)
        AND PMP.GLBL_CMPY_CD = PMPT.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPT.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_TP_CD = PMPT.PRC_MKT_PRMO_TP_CD
        AND PMP.GLBL_CMPY_CD = PMPAC.GLBL_CMPY_CD
        AND PMP.EZCANCELFLAG = PMPAC.EZCANCELFLAG
        AND PMP.PRC_MKT_PRMO_PK = PMPAC.PRC_MKT_PRMO_PK 
        AND PMPAC.PUB_FLG_01 = #pubFlg_Y#  --Y
        ORDER BY
            PRTY_NUM
           ,PRC_MKT_PRMO_PK
    </statement>

    <statement id="selectPromotionDetail" parameterClass="Map" resultClass="Map">
        SELECT
            PMPD.PRC_QLFY_TP_CD
           ,PMPD.PRC_QLFY_VAL_TXT
           ,PMPD.MDSE_CD
           ,PMPD.PRMO_AMT
        FROM PRC_MKT_PRMO_DTL PMPD
        WHERE 
            PMPD.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMPD.EZCANCELFLAG = '0'
        AND PMPD.PRC_MKT_PRMO_PK = #prcMktPromPk#
        AND PMPD.DEL_FLG = #delFlg# --N
        AND PMPD.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMPD.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPD.EFF_THRU_DT IS NULL)
<!--
        AND (CASE 
              <isNotNull property="mdlId">
              WHEN PRC_QLFY_TP_CD = #prcQlfyTp_02# AND PMPD.PRC_QLFY_VAL_TXT = #mdlId# THEN 1
              </isNotNull>
              WHEN PRC_QLFY_TP_CD = #prcQlfyTp_01# AND PMPD.PRC_QLFY_VAL_TXT IN (#mdseCd# , #ordTakeMdseCd#) THEN 1
              ELSE 0
             END) = 1
-->
        AND PMPD.MDSE_CD IN (#mdseCd# , #ordTakeMdseCd#)
        AND PMPD.PRC_QLFY_TP_CD &lt;&gt; #prcPrmoQlfyTp_03#
        AND NOT EXISTS (
            SELECT * FROM PRC_MKT_PRMO_EXCL PMPE
            WHERE  
                PMPE.GLBL_CMPY_CD = PMPD.GLBL_CMPY_CD
            AND PMPE.EZCANCELFLAG = PMPD.EZCANCELFLAG
            AND PMPE.PRC_MKT_PRMO_PK = PMPD.PRC_MKT_PRMO_PK
            AND PMPE.PRC_CATG_CD = #prcCatgCd#
            AND PMPE.EFF_FROM_DT &lt;= #prcBaseDt#
            AND (PMPE.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPE.EFF_THRU_DT IS NULL)
        )
    </statement>

    <statement id="selectPromotionBundle" parameterClass="Map" resultClass="Map">
       SELECT 
            PRC_QLFY_VAL_TXT
           ,MDSE_CD
           ,PRMO_AMT
        FROM PRC_MKT_PRMO_DTL PMPD
        WHERE 
            PMPD.GLBL_CMPY_CD = #glblCmpyCd#
        AND PMPD.EZCANCELFLAG = '0'
        AND PMPD.PRC_MKT_PRMO_PK = #prcMktPromPk#
        AND PMPD.DEL_FLG = #delFlg# --N
        AND PMPD.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PMPD.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPD.EFF_THRU_DT IS NULL)
        AND PMPD.MDSE_CD = #mdseCd#
        AND PMPD.PRC_QLFY_TP_CD = #prcPrmoQlfyTp_03#
        AND NOT EXISTS (
            SELECT * FROM PRC_MKT_PRMO_EXCL PMPE
            WHERE  
                PMPE.GLBL_CMPY_CD = PMPD.GLBL_CMPY_CD
            AND PMPE.EZCANCELFLAG = PMPD.EZCANCELFLAG
            AND PMPE.PRC_MKT_PRMO_PK = PMPD.PRC_MKT_PRMO_PK
            AND PMPE.PRC_CATG_CD = #prcCatgCd#
            AND PMPE.EFF_FROM_DT &lt;= #prcBaseDt#
            AND (PMPE.EFF_THRU_DT &gt;= #prcBaseDt# OR PMPE.EFF_THRU_DT IS NULL)
        )
    </statement>
</sqlMap>
    