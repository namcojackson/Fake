<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NLGL0020Query">

    <typeAlias alias="NLGL0020SMsg"      type="business.blap.NLGL0020.NLGL0020SMsg"/>
    <typeAlias alias="NLGL0020CMsg"      type="business.blap.NLGL0020.NLGL0020CMsg"/>
    <typeAlias alias="NLGL0020_ASMsg"    type="business.blap.NLGL0020.NLGL0020_ASMsg"/>
    <typeAlias alias="NLGL0020_BSMsg"    type="business.blap.NLGL0020.NLGL0020_BSMsg"/>
    <typeAlias alias="NLGL0020_CSMsg"    type="business.blap.NLGL0020.NLGL0020_CSMsg"/>
    <typeAlias alias="NLGL0020_DSMsg"    type="business.blap.NLGL0020.NLGL0020_DSMsg"/>
    <typeAlias alias="NLGL0020_GSMsg"    type="business.blap.NLGL0020.NLGL0020_GSMsg"/>
    <typeAlias alias="NLGL0020_HSMsg"    type="business.blap.NLGL0020.NLGL0020_HSMsg"/>
    <typeAlias alias="NLGL0020_ISMsg"    type="business.blap.NLGL0020.NLGL0020_ISMsg"/>
    <typeAlias alias="WMS_INBD_PO_HDRTMsg" type="business.db.WMS_INBD_PO_HDRTMsg"/>

    <statement id="getWHPullDownList" parameterClass="Map" resultClass="Map">
    SELECT
           WH.WH_CD                 WH_CD
          ,WH.WMS_DESC_NM           WMS_DESC_NM
      FROM
           WMS_WH WH
     WHERE
           WH.GLBL_CMPY_CD          =  #glblCmpyCd#
       AND WH.MW_REPL_TRGT_GRP_CD   IS NOT NULL
       AND WH.EZCANCELFLAG          =  '0'
     ORDER BY
           WH.WH_CD
    </statement>

    <statement id="getAdditionalWHPullDownList" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            TL.WH_OWNR_CD
           ,WO.WH_OWNR_DESC_TXT
        FROM
            TPL_LOC TL
           ,WH_OWNR WO
        WHERE
            TL.GLBL_CMPY_CD = #glblCmpyCd#
        AND TL.EZCANCELFLAG = '0'
        AND TL.GLBL_CMPY_CD = WO.GLBL_CMPY_CD
        AND TL.WH_OWNR_CD   = WO.WH_OWNR_CD
        AND WO.EZCANCELFLAG = '0'
        AND NOT EXISTS (
                SELECT
                    1
                FROM
                    RTL_WH RW
                   ,WMS_WH WW
                WHERE
                    RW.GLBL_CMPY_CD = TL.GLBL_CMPY_CD
                AND RW.RTL_WH_CD    = TL.TPL_LOC_CD
                AND RW.EZCANCELFLAG = '0'
                AND RW.GLBL_CMPY_CD = WW.GLBL_CMPY_CD
                AND RW.WMS_WH_CD    = WW.WH_CD
                AND WW.EZCANCELFLAG = '0'
        )
        ORDER BY
            TL.WH_OWNR_CD ASC
    </statement>

    <statement id="getRtlWhPullDownList" parameterClass="Map" resultClass="Map">
    SELECT
           RW.RTL_WH_CD                 RTL_WH_CD
          ,RW.RTL_WH_NM                 RTL_WH_NM
      FROM
           RTL_WH RW
          ,WMS_WH WH
     WHERE
           RW.GLBL_CMPY_CD          =  #glblCmpyCd#
       AND RW.WMS_WH_CD IS NOT NULL
       AND RW.EZCANCELFLAG          =  '0'
       AND WH.GLBL_CMPY_CD          =  RW.GLBL_CMPY_CD
       AND WH.WH_CD                 =  RW.WMS_WH_CD
       AND WH.MW_REPL_TRGT_GRP_CD   IS NOT NULL
       AND WH.EZCANCELFLAG          =  '0'
     ORDER BY
           RTL_WH_CD
    </statement>

    <statement id="getOrderTypePulldownList" parameterClass="Map" resultClass="Map">
    SELECT
           SOT.SCE_ORD_TP_CD
          ,SOT.SCE_ORD_TP_NM
      FROM
           SCE_ORD_TP SOT
     WHERE
           SOT.GLBL_CMPY_CD         =  #glblCmpyCd#
       AND SOT.EZCANCELFLAG         =  '0'
       AND SOT.INBD_OTBD_CD         =  '1'
     ORDER BY
           SCE_ORD_TP_SORT_NUM ASC
    </statement>

    <statement id="getPackCdPullDownList" parameterClass="Map" resultClass="Map">
    SELECT DISTINCT
           <isNotEqual property="wmsPackCdSetOwnerCdFlg" compareValue="Y">
               RSW.RTL_WH_CD || RSW.RTL_SWH_CD    PACK_CD_TXT
           </isNotEqual>
           <isEqual property="wmsPackCdSetOwnerCdFlg" compareValue="Y">
               RTW.INVTY_OWNR_CD || RSW.RTL_SWH_CD PACK_CD_TXT
           </isEqual>
      FROM
           RTL_WH       RTW
          ,RTL_SWH      RSW
          ,WMS_WH       WH
     WHERE
           RTW.GLBL_CMPY_CD         =  #glblCmpyCd#
       <isNotNull property="rtlWhCd">
       AND RTW.RTL_WH_CD            = #rtlWhCd#
       </isNotNull>
       AND RTW.WMS_WH_CD IS NOT NULL
       AND RTW.EZCANCELFLAG         =  '0'
       AND WH.GLBL_CMPY_CD          =  RTW.GLBL_CMPY_CD
       AND WH.WH_CD                 =  RTW.WMS_WH_CD
       AND WH.MW_REPL_TRGT_GRP_CD   IS NOT NULL
       AND WH.EZCANCELFLAG          =  '0'
       AND RSW.GLBL_CMPY_CD         =  RTW.GLBL_CMPY_CD
       AND RSW.RTL_WH_CD            =  RTW.RTL_WH_CD
       AND RSW.EZCANCELFLAG         =  '0'
     ORDER BY
           PACK_CD_TXT
    </statement>

    <statement id="getPoList" parameterClass="Map" resultMap="result.NLGL0020_ASMsg">
    SELECT
           LIST.WMS_PO_ID
          ,LIST.WMS_SQ_NUM
          ,LIST.VND_CD
          ,LIST.SCE_ORD_TP_CD
          ,LIST.WMS_TRX_CD
          ,LIST.XX_INTFC_LINE_NUM
          ,LIST.PO_FROM_DT_TM_TS
          ,LIST.XX_QUERY_FLTR_TXT
          ,LIST.INBD_PO_MSG_TXT_01
          ,LIST.INBD_PO_MSG_TXT_02
          ,LIST.INBD_PO_MSG_TXT_03
          ,LIST.INBD_PO_MSG_TXT_04
          ,LIST.WMS_RESRC_TXT
          ,LIST.WMS_CLO_DT_TM_TS
          ,LIST.WH_CD
          ,LIST.EZINTIME
          ,LIST.RTL_WH_CD
          ,LIST.INVTY_OWNR_CD
          ,LIST.SVC_CONFIG_MSTR_PK
      FROM
           (SELECT
                   WPH.WMS_PO_ID                 WMS_PO_ID
                  ,WPH.WMS_SQ_NUM                WMS_SQ_NUM
                  ,WPH.VND_CD                    VND_CD
                  ,RH.SCE_ORD_TP_CD              SCE_ORD_TP_CD
                  ,WPH.WMS_TRX_CD                WMS_TRX_CD
                  ,COUNT(*)                      XX_INTFC_LINE_NUM
                  ,WPH.PO_FROM_DT_TM_TS          PO_FROM_DT_TM_TS
                  ,TRIM(WPH.INBD_PO_MSG_TXT_01
                     || ','
                     || WPH.INBD_PO_MSG_TXT_02
                     || ','
                     || WPH.INBD_PO_MSG_TXT_03
                     || ','
                     || WPH.INBD_PO_MSG_TXT_04)  XX_QUERY_FLTR_TXT
                  ,TRIM(WPH.INBD_PO_MSG_TXT_01)       INBD_PO_MSG_TXT_01
                  ,TRIM(WPH.INBD_PO_MSG_TXT_02)       INBD_PO_MSG_TXT_02
                  ,TRIM(WPH.INBD_PO_MSG_TXT_03)       INBD_PO_MSG_TXT_03
                  ,TRIM(WPH.INBD_PO_MSG_TXT_04)       INBD_PO_MSG_TXT_04
                  ,WPH.WMS_RESRC_TXT             WMS_RESRC_TXT
                  ,WPH.WMS_CLO_DT_TM_TS          WMS_CLO_DT_TM_TS
                  ,WPH.WH_CD                     WH_CD
                  ,WPH.EZINTIME                  EZINTIME
                  ,WPH.RTL_WH_CD                 RTL_WH_CD
                  ,RTW.INVTY_OWNR_CD             INVTY_OWNR_CD
                  ,WPH.SVC_CONFIG_MSTR_PK        SVC_CONFIG_MSTR_PK
              FROM
                   WMS_INBD_PO_HDR  WPH
                  ,WMS_INBD_PO_DTL  WPD
                  ,RTL_WH           RTW
                  ,RWS_HDR          RH
             WHERE
                   WPH.GLBL_CMPY_CD       = #glblCmpyCd#
               AND WPH.GLBL_CMPY_CD       = WPD.GLBL_CMPY_CD
               AND WPH.WMS_SQ_NUM         = WPD.WMS_SQ_NUM
               <isNotNull property="whCd">
               AND (WPH.WH_CD             = #whCd#
                    OR WPH.WH_CD          IN (
                        SELECT
                            TL.TPL_LOC_CD
                        FROM
                            TPL_LOC TL
                        WHERE
                            TL.GLBL_CMPY_CD = #glblCmpyCd#
                        AND TL.WH_OWNR_CD   = #whCd#
                        AND TL.EZCANCELFLAG = '0'
                        )
                    )
               </isNotNull>
               <isNotNull property="rtlWhCd">
               AND WPH.RTL_WH_CD              = #rtlWhCd#
               </isNotNull>
               <isNotNull property="invtyOwnrCd">
               AND RTW.INVTY_OWNR_CD      = #invtyOwnrCd#
               </isNotNull>
               AND WPH.EZCANCELFLAG       = '0'
               AND WPD.EZCANCELFLAG       = '0'
               <isNotNull property="poId">
               AND WPH.WMS_PO_ID          = #poId#
               </isNotNull>
               <!-- When Date Type Code is "1"(Download Date) -->
               <isEqual property="dateList" compareValue="1">
               AND ( SUBSTR(WPH.EZINTIME,1,8)          BETWEEN #dateStart# AND #dateEnd# )
               </isEqual>
               <!-- When Date Type Code is "2"(From Date) -->
               <isEqual property="dateList" compareValue="2">
               AND ( SUBSTR(WPH.PO_FROM_DT_TM_TS,1,8)  BETWEEN #dateStart# AND #dateEnd# )
               </isEqual>
               <isNotNull property="prchTpCd">
               AND RH.SCE_ORD_TP_CD       = #prchTpCd#
               </isNotNull>
               <isNotNull property="wmsMDSECd">
               AND WPD.WMS_MDSE_CD        = #wmsMDSECd#
               </isNotNull>
               <isNotNull property="wmsTrxCd">
               AND WPH.WMS_TRX_CD         = #wmsTrxCd#
               </isNotNull>
               <isEqual property="chk" compareValue="Y">
               AND WPH.WMS_CLO_DT_TM_TS   IS NOT NULL
               </isEqual>
               <isNotEqual property="chk" compareValue="Y">
               AND WPH.WMS_CLO_DT_TM_TS   IS NULL
               </isNotEqual>
               AND RTW.GLBL_CMPY_CD       = WPH.GLBL_CMPY_CD
               AND RTW.RTL_WH_CD          = WPH.RTL_WH_CD
               AND RTW.EZCANCELFLAG       = '0'
               AND WPH.GLBL_CMPY_CD       = RH.GLBL_CMPY_CD
               AND WPH.RWS_NUM            = RH.RWS_NUM
               AND RH.EZCANCELFLAG        = '0'
             GROUP BY
                   WPH.WMS_PO_ID
                  ,WPH.WMS_SQ_NUM
                  ,WPH.VND_CD
                  ,RH.SCE_ORD_TP_CD
                  ,WPH.WMS_TRX_CD
                  ,WPH.PO_FROM_DT_TM_TS
                  ,TRIM(WPH.INBD_PO_MSG_TXT_01
                     || ','
                     || WPH.INBD_PO_MSG_TXT_02
                     || ','
                     || WPH.INBD_PO_MSG_TXT_03
                     || ','
                     || WPH.INBD_PO_MSG_TXT_04)
                  ,TRIM(WPH.INBD_PO_MSG_TXT_01)
                  ,TRIM(WPH.INBD_PO_MSG_TXT_02)
                  ,TRIM(WPH.INBD_PO_MSG_TXT_03)
                  ,TRIM(WPH.INBD_PO_MSG_TXT_04)
                  ,WPH.WMS_RESRC_TXT
                  ,WPH.WMS_CLO_DT_TM_TS
                  ,WPH.WH_CD
                  ,WPH.EZINTIME
                  ,WPH.RTL_WH_CD
                  ,RTW.INVTY_OWNR_CD
                  ,WPH.SVC_CONFIG_MSTR_PK
             ORDER BY
                   WPH.WMS_PO_ID
                  ,RH.SCE_ORD_TP_CD
           ) LIST
     WHERE
           ROWNUM &lt;= #rownum#
    </statement>

    <resultMap id="result.NLGL0020_ASMsg" class="NLGL0020_ASMsg">
        <result property="wmsPoId_A1"         column="WMS_PO_ID"            javaType="EZDSStringItem"/>
        <result property="wmsSqNum_A1"        column="WMS_SQ_NUM"           javaType="EZDSBigDecimalItem"/>
        <result property="vndCd_A1"           column="VND_CD"               javaType="EZDSStringItem"/>
        <result property="sceOrdTpCd_A1"      column="SCE_ORD_TP_CD"        javaType="EZDSStringItem"/>
        <result property="wmsTrxCd_A1"        column="WMS_TRX_CD"           javaType="EZDSStringItem"/>
        <result property="poFromDtTmTs_A1"    column="PO_FROM_DT_TM_TS"     javaType="EZDSStringItem"/>
        <result property="xxIntfcLineNum_A1"  column="XX_INTFC_LINE_NUM"    javaType="EZDSBigDecimalItem"/>
        <result property="xxMsgTxt_A1"        column="XX_QUERY_FLTR_TXT"    javaType="EZDSStringItem"/>
        <result property="inbdPoMsgTxt_A1"    column="INBD_PO_MSG_TXT_01"   javaType="EZDSStringItem"/>
        <result property="inbdPoMsgTxt_A2"    column="INBD_PO_MSG_TXT_02"   javaType="EZDSStringItem"/>
        <result property="inbdPoMsgTxt_A3"    column="INBD_PO_MSG_TXT_03"   javaType="EZDSStringItem"/>
        <result property="inbdPoMsgTxt_A4"    column="INBD_PO_MSG_TXT_04"   javaType="EZDSStringItem"/>
        <result property="wmsResrcTxt_A1"     column="WMS_RESRC_TXT"        javaType="EZDSStringItem"/>
        <result property="wmsCloDtTmTs_A1"    column="WMS_CLO_DT_TM_TS"     javaType="EZDSStringItem"/>
        <result property="whCd_A1"            column="WH_CD"                javaType="EZDSStringItem"/>
        <result property="ezInTime_A1"        column="EZINTIME"             javaType="EZDSStringItem"/>
        <result property="rtlWhCd_A1"         column="RTL_WH_CD"            javaType="EZDSStringItem"/>
        <result property="invtyOwnrCd_A1"     column="INVTY_OWNR_CD"        javaType="EZDSStringItem"/>
        <result property="svcConfigMstrPk_A1" column="SVC_CONFIG_MSTR_PK"   javaType="EZDSBigDecimalItem"/>
    </resultMap>

    <statement id="getTranslateStatus" parameterClass="Map" resultClass="Map">
    SELECT
           MAX(WIT.INTFC_PROC_STS_CD) INTFC_PROC_STS_CD
          ,MAX(WIT.PROC_STS_CD)       PROC_STS_CD
      FROM
           WMS_INBD_TRX     WIT
     WHERE
           WIT.GLBL_CMPY_CD       = #glblCmpyCd#
       AND WIT.WH_CD              = #whCd#
       AND WIT.INBD_ORD_NUM       = #poId#
       AND WIT.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getOrderHeader" parameterClass="Map" resultMap="result.NLGL0020_BSMsg">
    SELECT
           WPH.WMS_PO_ID                 WMS_PO_ID
          ,WPH.WMS_SQ_NUM                WMS_SQ_NUM
          ,RH.SCE_ORD_TP_CD              SCE_ORD_TP_CD
          ,WPH.VND_CD                    VND_CD
          ,WPH.WMS_VESL_NM               WMS_VESL_NM
          ,WPH.WMS_BOL_NUM               WMS_BOL_NUM
          ,WPH.WMS_SER_NUM               WMS_SER_NUM
          ,WPH.WMS_TRX_CD                WMS_TRX_CD
          ,WPH.EZINTIME                  EZINTIME
          ,TRIM(WPH.INBD_PO_MSG_TXT_01
             || ','
             || WPH.INBD_PO_MSG_TXT_02
             || ','
             || WPH.INBD_PO_MSG_TXT_03
             || ','
             || WPH.INBD_PO_MSG_TXT_04)  XX_QUERY_FLTR_TXT
          ,TRIM(WPH.INBD_PO_MSG_TXT_01)  INBD_PO_MSG_TXT_01
          ,TRIM(WPH.INBD_PO_MSG_TXT_02)  INBD_PO_MSG_TXT_02
          ,TRIM(WPH.INBD_PO_MSG_TXT_03)  INBD_PO_MSG_TXT_03
          ,TRIM(WPH.INBD_PO_MSG_TXT_04)  INBD_PO_MSG_TXT_04
          ,WPH.WMS_RESRC_TXT             WMS_RESRC_TXT
          ,WPH.WMS_CLO_DT_TM_TS          WMS_CLO_DT_TM_TS
          ,WPT.WMS_PRCH_TP_NM            WMS_PRCH_TP_NM
          ,DECODE(WPH.WMS_CLO_DT_TM_TS, null, DECODE(
           (SELECT
                   COUNT(*)
              FROM
                   WMS_INBD_PO_HDR WPH
                  ,WMS_INBD_TRX WIT
             WHERE
                   WPH.GLBL_CMPY_CD      = #glblCmpyCd#
               AND WPH.GLBL_CMPY_CD      = WIT.GLBL_CMPY_CD (+)
               AND WPH.WH_CD             = WIT.WH_CD (+)
               AND WPH.WMS_PO_ID         = WIT.INBD_ORD_NUM (+)
               AND WIT.WMS_TASK_CD       = #taskCd#
               AND WPH.EZCANCELFLAG      = '0'
               AND WIT.EZCANCELFLAG      = '0'
               AND TO_DATE(SUBSTR(WIT.EZINTIME,1,8), 'YYYYMMDD')
                                   BETWEEN TO_DATE(SUBSTR(WPH.EZINTIME,1,8),'YYYYMMDD')
                                       AND NVL(TO_DATE(SUBSTR(WPH.WMS_CLO_DT_TM_TS,1,8), 'YYYYMMDD') + 1, SYSDATE)
            ), 0, #open#, #partial#), #closed#) 
                                         WIT_COUNT
           ,(SELECT
                    COUNT(*)
               FROM
                    WMS_INBD_PO_HDR WPH2
              WHERE
                    WPH.GLBL_CMPY_CD  = WPH2.GLBL_CMPY_CD
                AND WPH.WH_CD         = WPH2.WH_CD
                AND WPH.WMS_PO_ID     = WPH2.WMS_PO_ID
                AND WPH2.EZCANCELFLAG = '0'
            )                            NUM_PO
          ,WPH.RTL_WH_CD                 RTL_WH_CD
          ,WPH.SVC_CONFIG_MSTR_PK        SVC_CONFIG_MSTR_PK
          ,RTW.INVTY_OWNR_CD             INVTY_OWNR_CD
      FROM
           WMS_INBD_PO_HDR WPH
          ,WMS_PRCH_TP     WPT
          ,RTL_WH          RTW
          ,RWS_HDR         RH
     WHERE
           WPH.GLBL_CMPY_CD              = #glblCmpyCd#
       AND WPH.WH_CD                     = #whCd#
       AND WPH.WMS_PO_ID                 = #poId#
       AND WPH.WMS_SQ_NUM                = #sqNum#
       AND WPH.RTL_WH_CD                 = #rtlWhCd#
       AND WPH.EZCANCELFLAG              = '0'
       AND WPH.GLBL_CMPY_CD              = WPT.GLBL_CMPY_CD (+)
       AND WPH.WMS_PRCH_TP_CD            = WPT.WMS_PRCH_TP_CD (+)
       AND WPT.EZCANCELFLAG (+)          = '0'
       AND RTW.GLBL_CMPY_CD              = WPH.GLBL_CMPY_CD
       AND RTW.RTL_WH_CD                 = WPH.RTL_WH_CD
       AND RTW.INVTY_OWNR_CD             = #invtyOwnrCd#
       AND RTW.EZCANCELFLAG              = '0'
       AND WPH.GLBL_CMPY_CD              = RH.GLBL_CMPY_CD
       AND WPH.RWS_NUM                   = RH.RWS_NUM
       AND RH.EZCANCELFLAG               = '0'
    </statement>

    <resultMap id="result.NLGL0020_BSMsg" class="NLGL0020_BSMsg">
        <result property="wmsPoId_B2"                column="WMS_PO_ID"            javaType="EZDSStringItem"/>
        <result property="wmsSqNum_B2"               column="WMS_SQ_NUM"           javaType="EZDSBigDecimalItem"/>
        <result property="sceOrdTpCd_B1"             column="SCE_ORD_TP_CD"        javaType="EZDSStringItem"/>
        <result property="vndCd_B1"                  column="VND_CD"               javaType="EZDSStringItem"/>
        <result property="wmsVeslNm_B1"              column="WMS_VESL_NM"          javaType="EZDSStringItem"/>
        <result property="wmsBolNum_B1"              column="WMS_BOL_NUM"          javaType="EZDSStringItem"/>
        <result property="wmsSerNum_B1"              column="WMS_SER_NUM"          javaType="EZDSStringItem"/>
        <result property="wmsTrxCd_B1"               column="WMS_TRX_CD"           javaType="EZDSStringItem"/>
        <result property="ezInTime_B1"               column="EZINTIME"             javaType="EZDSStringItem"/>
        <result property="xxMsgTxt_B1"               column="XX_QUERY_FLTR_TXT"    javaType="EZDSStringItem"/>
        <result property="inbdPoMsgTxt_B1"           column="INBD_PO_MSG_TXT_01"   javaType="EZDSStringItem"/>
        <result property="inbdPoMsgTxt_B2"           column="INBD_PO_MSG_TXT_02"   javaType="EZDSStringItem"/>
        <result property="inbdPoMsgTxt_B3"           column="INBD_PO_MSG_TXT_03"   javaType="EZDSStringItem"/>
        <result property="inbdPoMsgTxt_B4"           column="INBD_PO_MSG_TXT_04"   javaType="EZDSStringItem"/>
        <result property="wmsResrcTxt_B1"            column="WMS_RESRC_TXT"        javaType="EZDSStringItem"/>
        <result property="wmsCloDtTmTs_B1"           column="WMS_CLO_DT_TM_TS"     javaType="EZDSStringItem"/>
        <result property="xxIntfcItemStsDescTxt_B1"  column="WIT_COUNT"            javaType="EZDSStringItem"/>
        <result property="fill2Txt_B1"               column="NUM_PO"               javaType="EZDSStringItem"/>
        <result property="rtlWhCd_B1"                column="RTL_WH_CD"            javaType="EZDSStringItem"/>
        <result property="invtyOwnrCd_B1"            column="INVTY_OWNR_CD"        javaType="EZDSStringItem"/>
        <result property="svcConfigMstrPk_B1"        column="SVC_CONFIG_MSTR_PK"   javaType="EZDSBigDecimalItem"/>
    </resultMap>

    <statement id="getOrderDetail" parameterClass="Map" resultMap="result.NLGL0020_CSMsg">
    SELECT
           WPD.WMS_LINE_NUM       WMS_LINE_NUM
          ,WPD.WMS_MDSE_CD        WMS_MDSE_CD
          ,WPD.S80_STK_STS_CD     S80_STK_STS_CD
          ,WPD.WMS_INV_ID         WMS_INV_ID
          ,WPD.WMS_DO_ID          WMS_DO_ID
          ,WPD.WMS_COLLO_NUM      WMS_COLLO_NUM
          ,WPD.WMS_OPEN_QTY       WMS_OPEN_QTY
          ,(SELECT
                     NVL(SUM(WIT.WMS_ORD_QTY),0)
              FROM
                     WMS_INBD_TRX WIT
             WHERE
                    WIT.GLBL_CMPY_CD        = WPH.GLBL_CMPY_CD
                AND WIT.INBD_ORD_NUM        = WPH.WMS_PO_ID
                AND WIT.WH_CD               = WPH.WH_CD
                AND WIT.INBD_ORD_LINE_NUM   = WPD.WMS_LINE_NUM
                AND WIT.WMS_MDSE_CD         = WPD.WMS_MDSE_CD
                AND WIT.WMS_TASK_CD         = 'RCVD'
                AND WIT.EZCANCELFLAG        = '0'
                AND TO_DATE(SUBSTR(WIT.EZINTIME,1,8), 'YYYYMMDD')
                                      BETWEEN TO_DATE(SUBSTR(WPH.EZINTIME,1,8),'YYYYMMDD')
                                          AND NVL(TO_DATE(SUBSTR(WPH.WMS_CLO_DT_TM_TS,1,8), 'YYYYMMDD') + 1, SYSDATE)
                                ) XX_QTY_RECV
           <isEqual property="wmsPackCdSetOwnerCdFlg" value="Y">
               ,WPD.RTL_WH_CD    || WPD.RTL_SWH_CD   PACK_CD_TXT
           </isEqual>
           <isNotEqual property="wmsPackCdSetOwnerCdFlg" value="Y">
               ,RTW.INVTY_OWNR_CD || WPD.RTL_SWH_CD PACK_CD_TXT
           </isNotEqual>
          ,WPD.SER_APVL_REQ_FLG   SER_APVL_REQ_FLG
          ,WPD.USR_CD_REF_TXT     USR_CD_REF_TXT
          ,RTW.INVTY_OWNR_CD      INVTY_OWNR_CD
          ,(SELECT MIN(S.SER_NUM)
            FROM   RWS_SER     S
            WHERE  S.GLBL_CMPY_CD = WPD.GLBL_CMPY_CD
            AND    S.RWS_NUM      = WPH.RWS_NUM
            AND    S.RWS_LINE_NUM = LPAD(TO_CHAR(WPD.WMS_LINE_NUM), 3, '0')
            AND    S.EZCANCELFLAG = '0'
           )                      SER_NUM
      FROM
           WMS_INBD_PO_HDR WPH
          ,WMS_INBD_PO_DTL WPD
          ,RTL_WH          RTW
     WHERE
           WPH.GLBL_CMPY_CD       = #glblCmpyCd#
       AND WPH.WH_CD              = #whCd#
       AND WPH.WMS_PO_ID          = #poId#
       AND WPH.WMS_SQ_NUM         = #sqNum#
       AND WPH.EZCANCELFLAG       = '0'
       AND WPH.GLBL_CMPY_CD       = WPD.GLBL_CMPY_CD
       AND WPH.WH_CD              = WPD.WH_CD
       AND WPH.WMS_PO_ID          = WPD.WMS_PO_ID
       AND WPH.WMS_SQ_NUM         = WPD.WMS_SQ_NUM
       AND WPD.EZCANCELFLAG       = '0'
       AND RTW.GLBL_CMPY_CD       = WPD.GLBL_CMPY_CD
       AND RTW.RTL_WH_CD          = WPD.RTL_WH_CD
       AND RTW.EZCANCELFLAG       = '0'
     ORDER BY
           WPD.WMS_LINE_NUM
          ,WPD.WMS_MDSE_CD
    </statement>

    <resultMap id="result.NLGL0020_CSMsg" class="NLGL0020_CSMsg">
        <result property="wmsLineNum_C1"    column="WMS_LINE_NUM"      javaType="EZDSBigDecimalItem"/>
        <result property="wmsMdseCd_C1"     column="WMS_MDSE_CD"       javaType="EZDSStringItem"/>
        <result property="s80StkStsCd_C1"   column="S80_STK_STS_CD"    javaType="EZDSStringItem"/>
        <result property="wmsInvId_C1"      column="WMS_INV_ID"        javaType="EZDSStringItem"/>
        <result property="wmsDoId_C1"       column="WMS_DO_ID"         javaType="EZDSStringItem"/>
        <result property="wmsOpenQty_C1"    column="WMS_OPEN_QTY"      javaType="EZDSBigDecimalItem"/>
        <result property="xxIntfcOrdQty_C1" column="XX_QTY_RECV"       javaType="EZDSBigDecimalItem"/>
        <result property="fill40Txt_C1"     column="PACK_CD_TXT"       javaType="EZDSStringItem"/>
        <result property="serApvlReqFlg_C1" column="SER_APVL_REQ_FLG"  javaType="EZDSStringItem"/>
        <result property="usrCdRefTxt_C1"   column="USR_CD_REF_TXT"    javaType="EZDSStringItem"/>
        <result property="invtyOwnrCd_C1"   column="INVTY_OWNR_CD"     javaType="EZDSStringItem"/>
        <result property="serNum_C1"        column="SER_NUM"           javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getSTSUPDTransaction" parameterClass="Map" resultMap="result.NLGL0020_DSMsg">
    SELECT
           WIT.WMS_INBD_TRX_PK    WMS_INBD_TRX_PK
          ,WIT.WMS_REC_ID         WMS_REC_ID
          ,WIT.WH_CD              WH_CD
          ,WIT.WMS_TASK_CD        WMS_TASK_CD
          ,WIT.INBD_ORD_LINE_NUM  INBD_ORD_LINE_NUM
          ,WIT.WMS_MDSE_CD        WMS_MDSE_CD
          ,WIT.WMS_STK_STS_CD     WMS_STK_STS_CD
          ,WIT.WMS_ORD_QTY        WMS_ORD_QTY
          ,WIT.WMS_TRX_DT_TM_TS   WMS_TRX_DT_TM_TS
          ,RH.SCE_ORD_TP_CD       SCE_ORD_TP_CD
          ,WIT.WMS_ORD_STS_CD     WMS_ORD_STS_CD
          ,WIT.WMS_LOT_NUM        WMS_LOT_NUM
          ,WIT.WMS_RCPT_ID        WMS_RCPT_ID
          ,WIT.WMS_OP_ID          WMS_OP_ID
          ,WIT.EZINTIME           EZINTIME
      FROM
           WMS_INBD_TRX    WIT
          ,WMS_INBD_PO_HDR WIH
          ,RWS_HDR         RH
     WHERE
           WIT.GLBL_CMPY_CD       = #glblCmpyCd#
       AND WIT.WH_CD              = #whCd#
       AND WIT.INBD_ORD_NUM       = #poId#
       AND TO_DATE(SUBSTR(WIT.EZINTIME,1,8), 'YYYYMMDD')
                            BETWEEN TO_DATE(SUBSTR(#ezIntime#,1,8),'YYYYMMDD')
                                AND NVL(TO_DATE(SUBSTR(#ezIntime#,1,8), 'YYYYMMDD') + 7, SYSDATE)
       AND WIT.GLBL_CMPY_CD       = WIH.GLBL_CMPY_CD
       AND WIT.WH_CD              = WIH.WH_CD
       AND WIT.INBD_ORD_NUM       = WIH.WMS_PO_ID
       AND WIH.WMS_SQ_NUM         = #sqNum#
       AND WIH.GLBL_CMPY_CD       = RH.GLBL_CMPY_CD
       AND WIH.RWS_NUM            = RH.RWS_NUM
       AND WIT.EZCANCELFLAG       = '0'
       AND WIH.EZCANCELFLAG       = '0'
       AND RH.EZCANCELFLAG        = '0'
     ORDER BY
           WIT.WMS_REC_ID
          ,WIT.WMS_TASK_CD
    </statement>

    <resultMap id="result.NLGL0020_DSMsg" class="NLGL0020_DSMsg">
        <result property="wmsRecId_D1"       column="WMS_REC_ID"        javaType="EZDSStringItem"/>
        <result property="wmsTaskCd_D1"      column="WMS_TASK_CD"       javaType="EZDSStringItem"/>
        <result property="inbdOrdLineNum_D1" column="INBD_ORD_LINE_NUM" javaType="EZDSBigDecimalItem"/>
        <result property="wmsMdseCd_D1"      column="WMS_MDSE_CD"       javaType="EZDSStringItem"/>
        <result property="wmsStkStsCd_D1"    column="WMS_STK_STS_CD"    javaType="EZDSStringItem"/>
        <result property="wmsOrdQty_D1"      column="WMS_ORD_QTY"       javaType="EZDSBigDecimalItem"/>
        <result property="wmsTrxDtTmTs_D1"   column="WMS_TRX_DT_TM_TS"  javaType="EZDSStringItem"/>
        <result property="sceOrdTpCd_D1"     column="SCE_ORD_TP_CD"     javaType="EZDSStringItem"/>
        <result property="wmsOrdStsCd_D1"    column="WMS_ORD_STS_CD"    javaType="EZDSStringItem"/>
        <result property="wmsLotNum_D1"      column="WMS_LOT_NUM"       javaType="EZDSStringItem"/>
        <result property="wmsRcptId_D1"      column="WMS_RCPT_ID"       javaType="EZDSStringItem"/>
        <result property="wmsOpId_D1"        column="WMS_OP_ID"         javaType="EZDSStringItem"/>
        <result property="ezInTime_D1"       column="EZINTIME"          javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getUPDDetail" parameterClass="Map" resultMap="result.NLGL0020_ISMsg">
    SELECT
           WIT.WMS_REC_ID           WMS_REC_ID
          ,WIT.PROC_STS_CD          PROC_STS_CD
          ,WIT.WMS_TASK_CD          WMS_TASK_CD
          ,WIT.WMS_STK_STS_CD       WMS_STK_STS_CD
          ,WIT.WMS_MDSE_CD          WMS_MDSE_CD
          ,WIT.WMS_ORD_QTY          WMS_ORD_QTY
          ,WIT.WMS_TRX_DT_TM_TS     WMS_TRX_DT_TM_TS
          ,WIT.INBD_ORD_NUM         INBD_ORD_NUM
          ,RH.SCE_ORD_TP_CD         SCE_ORD_TP_CD
          ,WIT.INBD_ORD_LINE_NUM    INBD_ORD_LINE_NUM
          ,WIT.EZINTIME             EZINTIME
          ,WIT.WMS_INBD_TRX_PK      WMS_INBD_TRX_PK
          ,WIT.EZCANCELFLAG         EZCANCELFLAG
          ,WIT.WMS_UPD_HIST_NUM     WMS_UPD_HIST_NUM
          ,WIT.WMS_PKG_CD           PACK_CD_TXT
          ,WIT.SER_NUM              SER_NUM
      FROM
           WMS_INBD_TRX          WIT
          ,WMS_INBD_PO_HDR       WPH
          ,RWS_HDR               RH
     WHERE
           WIT.GLBL_CMPY_CD        = #glblCmpyCd#
       AND WIT.WH_CD               = #whCd#
       AND WIT.INBD_ORD_NUM        = #poId#
       <isNotEqual property="wmsEzCancelFlag" compareValue="">
       AND WIT.EZCANCELFLAG        = #wmsEzCancelFlag#
       </isNotEqual>
       AND WIT.GLBL_CMPY_CD        = WPH.GLBL_CMPY_CD
       AND WIT.WH_CD               = WPH.WH_CD
       AND WIT.INBD_ORD_NUM        = WPH.WMS_PO_ID
       AND WPH.WMS_SQ_NUM          =
           (
              SELECT
                     MAX(WPH.WMS_SQ_NUM) WMS_SQ_NUM
                FROM WMS_INBD_PO_HDR WPH
               WHERE WPH.GLBL_CMPY_CD = #glblCmpyCd#
                 AND WPH.WH_CD        = #whCd#
                 AND WPH.WMS_PO_ID    = #poId#
                 AND WPH.EZCANCELFLAG = '0'
           )
       AND WPH.EZCANCELFLAG        = '0'
       <isNotEqual property="wmsTaskCd" compareValue="-">
       AND WIT.WMS_TASK_CD         = #wmsTaskCd#
       </isNotEqual>
       AND WPH.GLBL_CMPY_CD        = RH.GLBL_CMPY_CD
       AND WPH.RWS_NUM             = RH.RWS_NUM
       AND RH.EZCANCELFLAG        = '0'
     ORDER BY
           WIT.EZCANCELFLAG ASC
          ,WIT.WMS_TASK_CD  ASC
          ,WIT.WMS_TASK_CD  ASC
    </statement>

    <resultMap id="result.NLGL0020_ISMsg" class="NLGL0020_ISMsg">
        <result property="wmsRecId_I1"       column="WMS_REC_ID"        javaType="EZDSStringItem"/>
        <result property="procStsCd_I1"      column="PROC_STS_CD"       javaType="EZDSStringItem"/>
        <result property="inbdOrdLineNum_I1" column="INBD_ORD_LINE_NUM" javaType="EZDSBigDecimalItem"/>
        <result property="wmsTaskCd_I3"      column="WMS_TASK_CD"       javaType="EZDSStringItem"/>
        <result property="wmsStkStsCd_I3"    column="WMS_STK_STS_CD"    javaType="EZDSStringItem"/>
        <result property="wmsMdseCd_I1"      column="WMS_MDSE_CD"       javaType="EZDSStringItem"/>
        <result property="wmsOrdQty_I1"      column="WMS_ORD_QTY"       javaType="EZDSBigDecimalItem"/>
        <result property="wmsTrxDtTmTs_I1"   column="WMS_TRX_DT_TM_TS"  javaType="EZDSStringItem"/>
        <result property="sceOrdTpCd_I2"     column="SCE_ORD_TP_CD"     javaType="EZDSStringItem"/>
        <result property="ezInTime_I1"       column="EZINTIME"          javaType="EZDSStringItem"/>
        <result property="wmsInbdTrxPk_I1"   column="WMS_INBD_TRX_PK"   javaType="EZDTBigDecimalItem"/>
        <result property="ezCancelFlag_I1"   column="EZCANCELFLAG"      javaType="EZDSStringItem"/>
        <result property="wmsUpdHistNum_I1"  column="WMS_UPD_HIST_NUM"  javaType="EZDTBigDecimalItem"/>
        <result property="packCdTxt_I1"      column="PACK_CD_TXT"       javaType="EZDSStringItem"/>
        <result property="serNum_I1"         column="SER_NUM"           javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getPoHeaderData" parameterClass="Map" resultClass="Map">
    SELECT
           RH.GLBL_CMPY_CD
           ,RH.RWS_NUM
      FROM
           WMS_INBD_PO_HDR WPH
          ,RWS_HDR         RH
     WHERE
           WPH.GLBL_CMPY_CD = #glblCmpyCd#
       AND WPH.WH_CD        = #whCd#
       AND WPH.WMS_SQ_NUM   =
           (
              SELECT
                     MAX(WPH.WMS_SQ_NUM) WMS_SQ_NUM
                FROM WMS_INBD_PO_HDR WPH
               WHERE WPH.GLBL_CMPY_CD = #glblCmpyCd#
                 AND WPH.WH_CD        = #whCd#
                 AND WPH.WMS_PO_ID    = #poId#
                 AND WPH.EZCANCELFLAG = '0'
           )
        AND WPH.GLBL_CMPY_CD = RH.GLBL_CMPY_CD
        AND WPH.RWS_NUM      = RH.RWS_NUM
        AND WPH.EZCANCELFLAG = '0'
        AND RH.EZCANCELFLAG  = '0'

    </statement>


    <statement id="getOrderDetailData" parameterClass="Map" resultClass="Map">
    SELECT
           WPD.WH_CD              WH_CD
          ,WPD.WMS_PO_ID          WMS_PO_ID
          ,WPD.WMS_LINE_NUM       WMS_LINE_NUM
          ,WPD.WMS_MDSE_CD        WMS_MDSE_CD
          ,WPD.S80_STK_STS_CD     S80_STK_STS_CD
          ,WPD.WMS_LINE_STS_CD    WMS_LINE_STS_CD
          ,WPD.WMS_INV_IND        WMS_INV_IND
          ,WPD.WMS_OPEN_QTY       WMS_OPEN_QTY
          ,WPD.WMS_EST_DT_TM_TS   WMS_EST_DT_TM_TS
          ,WPD.WMS_INV_ID         WMS_INV_ID
          ,WPD.WMS_DO_ID          WMS_DO_ID
          ,WPD.CSE_TO_NUM         CSE_TO_NUM
          ,WPD.CSE_FROM_NUM       CSE_FROM_NUM
          ,WPD.WMS_COLLO_NUM      WMS_COLLO_NUM
          ,WPD.WMS_SQ_NUM         WMS_SQ_NUM
          ,WPD.RTL_WH_CD          RTL_WH_CD
          ,WPD.RTL_SWH_CD         RTL_SWH_CD
      FROM
          WMS_INBD_PO_DTL WPD
     WHERE
           WPD.GLBL_CMPY_CD       = #glblCmpyCd#
       AND WPD.WH_CD              = #whCd#
       AND WPD.WMS_SQ_NUM         = #sqNum#
       AND WPD.EZCANCELFLAG       = '0'
     ORDER BY
           WPD.WMS_LINE_NUM
          ,WPD.WMS_MDSE_CD
    </statement>
<!--
    <statement id="getOrderDetailData" parameterClass="Map" resultClass="Map">
    SELECT
           WPD.WH_CD              WH_CD
          ,WPD.WMS_PO_ID          WMS_PO_ID
          ,WPD.WMS_LINE_NUM       WMS_LINE_NUM
          ,WPD.WMS_MDSE_CD        WMS_MDSE_CD
          ,WPD.S80_STK_STS_CD     S80_STK_STS_CD
          ,WPD.WMS_LINE_STS_CD    WMS_LINE_STS_CD
          ,WPD.WMS_INV_IND        WMS_INV_IND
          ,WPD.WMS_OPEN_QTY       WMS_OPEN_QTY
          ,WPD.WMS_EST_DT_TM_TS   WMS_EST_DT_TM_TS
          ,WPD.WMS_INV_ID         WMS_INV_ID
          ,WPD.WMS_DO_ID          WMS_DO_ID
          ,WPD.CSE_TO_NUM         CSE_TO_NUM
          ,WPD.CSE_FROM_NUM       CSE_FROM_NUM
          ,WPD.WMS_COLLO_NUM      WMS_COLLO_NUM
          ,WPD.WMS_SQ_NUM         WMS_SQ_NUM
          ,WPD.RTL_WH_CD          RTL_WH_CD
          ,WPD.RTL_SWH_CD         RTL_SWH_CD
          ,WPD.SER_APVL_REQ_FLG   SER_APVL_REQ_FLG
          ,WPD.USR_CD_REF_TXT     USR_CD_REF_TXT
          ,RWH.INVTY_OWNR_CD      INVTY_OWNR_CD
          ,(SELECT MIN(S.SER_NUM)
            FROM   RWS_SER     S
            WHERE  S.GLBL_CMPY_CD = WPD.GLBL_CMPY_CD
            AND    S.RWS_NUM      = WPH.RWS_NUM
            AND    S.RWS_LINE_NUM = WPD.RWS_LINE_NUM
            AND    S.EZCANCELFLAG = '0'
           )                      SER_NUM
      FROM
          WMS_INBD_PO_HDR WPH
         ,WMS_INBD_PO_DTL WPD
         ,RTL_WH          RWH
     WHERE
           WPH.GLBL_CMPY_CD       = #glblCmpyCd#
       AND WPH.WH_CD              = #whCd#
       AND WPH.WMS_SQ_NUM         = #sqNum#
       AND WPH.EZCANCELFLAG       = '0'
       AND WPD.GLBL_CMPY_CD       = WPH.GLBL_CMPY_CD
       AND WPD.WH_CD              = WPH.WH_CD
       AND WPD.WMS_SQ_NUM         = WPH.WMS_SQ_NUM
       AND WPD.EZCANCELFLAG       = '0'
       AND RWH.GLBL_CMPY_CD       = WPD.GLBL_CMPY_CD
       AND RWH.RTL_WH_CD          = WPD.RTL_WH_CD
       AND RWH.EZCANCELFLAG       = '0'
     ORDER BY
           WPD.WMS_LINE_NUM
          ,WPD.WMS_MDSE_CD
    </statement>
-->
    <statement id="getMDSECount" parameterClass="Map" resultClass="Map">
    SELECT
           MDSE_CD
      FROM
           MDSE
     WHERE
           GLBL_CMPY_CD        = #glblCmpyCd#
       AND MDSE_CD             = #wmsMDSECd#
       AND EZCANCELFLAG        = '0'
    </statement>

    <statement id="getMDSEData" parameterClass="Map" resultClass="Map">
    SELECT
           WMS_BASE_UOM_QTY    WMS_BASE_UOM_QTY
     FROM
           WMS_INBD_MDSE_UPC
     WHERE
           GLBL_CMPY_CD        = #glblCmpyCd#
       AND WH_CD               = #whCd#
       AND WMS_MDSE_CD         = #wmsMDSECd#
       AND WMS_UOM_CD          = #UOM#
       AND EZCANCELFLAG        = '0'
     GROUP BY
           WMS_BASE_UOM_QTY
    </statement>

    <statement id="getVenderData" parameterClass="Map" resultClass="Map">
    SELECT
           IPV.WH_CD                WH_CD
          ,IPV.WMS_CMPY_CD          WMS_CMPY_CD
          ,IPV.VND_CD               VND_CD
          ,IPV.WMS_VND_NM_01        WMS_VND_NM_01
          ,IPV.WMS_VND_NM_02        WMS_VND_NM_02
          ,IPV.FIRST_LINE_ADDR      FIRST_LINE_ADDR
          ,IPV.SCD_LINE_ADDR        SCD_LINE_ADDR
          ,IPV.THIRD_LINE_ADDR      THIRD_LINE_ADDR
          ,IPV.FRTH_LINE_ADDR       FRTH_LINE_ADDR
          ,IPV.CTY_ADDR             CTY_ADDR
          ,IPV.ST_CD                ST_CD
          ,IPV.POST_CD              POST_CD
          ,IPV.CTRY_CD              CTRY_CD
          ,IPV.VND_TO_CTAC_NM       VND_TO_CTAC_NM
          ,IPV.VND_TO_CTAC_NUM      VND_TO_CTAC_NUM
          ,IPV.WMS_PO_ID            WMS_PO_ID
          ,IPV.WMS_SQ_NUM           WMS_SQ_NUM
      FROM
           WMS_INBD_PO_VND   IPV
     WHERE
           IPV.GLBL_CMPY_CD         = #glblCmpyCd#
       AND IPV.WH_CD                = #whCd#
       AND IPV.WMS_SQ_NUM           = #sqNum#
       AND IPV.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getWmsInbdPoHdr" parameterClass="Map" resultMap="result.getWmsInbdPoHdr">
    SELECT
           WPH.GLBL_CMPY_CD
          ,WPH.WH_CD
          ,WPH.WMS_SQ_NUM
          ,WPH.WMS_CLO_DT_TM_TS
      FROM
           WMS_INBD_PO_HDR WPH
     WHERE
           WPH.GLBL_CMPY_CD = #glblCmpyCd#
       AND WPH.WH_CD        = #whCd#
       AND WPH.WMS_PO_ID    = #poId#
       AND WPH.EZCANCELFLAG = '0'
     ORDER BY WPH.WMS_SQ_NUM DESC
     FOR UPDATE
    </statement>
    <resultMap id="result.getWmsInbdPoHdr" class="WMS_INBD_PO_HDRTMsg">
        <result property="glblCmpyCd"      column="GLBL_CMPY_CD"       javaType="EZDTStringItem"/>
        <result property="whCd"            column="WH_CD"              javaType="EZDTStringItem"/>
        <result property="wmsSqNum"        column="WMS_SQ_NUM"         javaType="EZDTBigDecimalItem"/>
        <result property="wmsCloDtTmTs"    column="WMS_CLO_DT_TM_TS"   javaType="EZDTStringItem"/>
    </resultMap>
    <statement id="getRtlWhNm" parameterClass="Map" resultMap="String">
     SELECT
           R.RTL_WH_DESC_TXT
     FROM
           RTL_WH            R
     WHERE
           R.GLBL_CMPY_CD = #glblCmpyCd#
       AND R.RTL_WH_CD    = #whCd#
       AND R.EZCANCELFLAG = '0'
       AND EXISTS 
       (
       SELECT
           RW.RTL_WH_CD
       FROM
           WMS_WH  WW
          ,RTL_WH  RW
          ,WH_OWNR WO
       WHERE
           WW.GLBL_CMPY_CD = #glblCmpyCd#
       AND WW.EZCANCELFLAG = '0'
       AND WW.GLBL_CMPY_CD = RW.GLBL_CMPY_CD
       AND WW.WH_CD        = RW.WMS_WH_CD
       AND RW.EZCANCELFLAG = '0'
       AND RW.GLBL_CMPY_CD = WO.GLBL_CMPY_CD
       AND RW.WH_OWNR_CD   = WO.WH_OWNR_CD
       AND WO.EZCANCELFLAG = '0'
       UNION
       SELECT 
           DISTINCT
           RW.RTL_WH_CD
       FROM
           TPL_LOC TL
          ,WH_OWNR WO
          ,RTL_WH  RW
       WHERE
           TL.GLBL_CMPY_CD = #glblCmpyCd#
       AND TL.EZCANCELFLAG = '0'
       AND TL.GLBL_CMPY_CD = WO.GLBL_CMPY_CD
       AND TL.WH_OWNR_CD   = WO.WH_OWNR_CD
       AND WO.EZCANCELFLAG = '0'
       AND TL.GLBL_CMPY_CD = RW.GLBL_CMPY_CD
       AND TL.TPL_LOC_CD   = RW.RTL_WH_CD
       AND RW.EZCANCELFLAG = '0'
       AND NOT EXISTS (SELECT
                           1
                       FROM
                           RTL_WH RL
                          ,WMS_WH WW
                       WHERE
                           RL.GLBL_CMPY_CD = TL.GLBL_CMPY_CD
                       AND RL.RTL_WH_CD    = TL.TPL_LOC_CD
                       AND RL.EZCANCELFLAG = '0'
                       AND RL.GLBL_CMPY_CD = WW.GLBL_CMPY_CD
                       AND RL.WMS_WH_CD    = WW.WH_CD
                       AND WW.EZCANCELFLAG = '0'
                      )
       )
    </statement>
    <statement id="getRelatedRtlWhPullDownList" parameterClass="Map" resultClass="Map">
     SELECT
         RW.RTL_WH_CD
        ,RW.RTL_WH_NM
     FROM
         WMS_WH  WW
        ,RTL_WH  RW
     WHERE
         WW.GLBL_CMPY_CD = #glblCmpyCd#
     AND WW.WH_CD        = #whCd#
     AND WW.EZCANCELFLAG = '0'
     AND WW.GLBL_CMPY_CD = RW.GLBL_CMPY_CD
     AND WW.WH_CD        = RW.WMS_WH_CD
     AND RW.EZCANCELFLAG = '0'
     UNION
     SELECT DISTINCT
         RW.RTL_WH_CD
        ,RW.RTL_WH_NM
     FROM
         TPL_LOC TL
        ,RTL_WH  RW
     WHERE
         TL.GLBL_CMPY_CD = #glblCmpyCd#
     AND TL.WH_OWNR_CD   = #whCd#
     AND TL.EZCANCELFLAG = '0'
     AND TL.GLBL_CMPY_CD = RW.GLBL_CMPY_CD
     AND TL.TPL_LOC_CD   = RW.RTL_WH_CD
     AND TL.WH_OWNR_CD   = RW.WH_OWNR_CD
     AND RW.EZCANCELFLAG = '0'
     AND NOT EXISTS (SELECT
                         1
                     FROM
                         WMS_WH WW
                     WHERE
                         WW.GLBL_CMPY_CD = RW.GLBL_CMPY_CD
                     AND WW.WH_CD        = RW.WMS_WH_CD
                     AND WW.EZCANCELFLAG = '0'
                    )
     
     </statement>
     <statement id="getRelatedInvtyOwnerCd" parameterClass="Map" resultClass="String">
         SELECT
             RW.INVTY_OWNR_CD
         FROM
             RTL_WH RW
         WHERE 
             RW.RTL_WH_CD =#rtlWhCd#
         AND RW.GLBL_CMPY_CD=#glblCmpyCd#
         AND RW.EZCANCELFLAG='0'
     </statement>
     <statement id = "getRwsHdrKey" parameterClass="Map" resultClass="Map">
         SELECT
              RH.RWS_NUM
             ,RH.GLBL_CMPY_CD
         FROM
             WMS_INBD_PO_HDR WIH
            ,RWS_HDR         RH
         WHERE
             WIH.GLBL_CMPY_CD = #glblCmpyCd#
         AND WIH.WH_CD        = #whCd#
         AND WIH.WMS_PO_ID    = #poId#
         AND WIH.WMS_SQ_NUM   = #sqNum#
         AND WIH.EZCANCELFLAG = '0'
         AND WIH.GLBL_CMPY_CD = RH.GLBL_CMPY_CD
         AND WIH.RWS_NUM      = RH.RWS_NUM
         AND RH.EZCANCELFLAG = '0'

     </statement>
</sqlMap>
