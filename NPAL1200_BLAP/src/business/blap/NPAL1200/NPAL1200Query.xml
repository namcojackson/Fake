<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NPAL1200Query">
    <statement id="getSearchOptionPulldownList" parameterClass="Map"
        resultClass="Map">
        SELECT
            SSO.SRCH_OPT_PK
            ,SSO.SRCH_OPT_NM
        FROM
            SAVE_SRCH_OPT SSO
        WHERE
                SSO.GLBL_CMPY_CD = #glblCmpyCd#
            AND SSO.SRCH_OPT_APL_ID = #srchOptAplId#
            AND SSO.SRCH_OPT_USR_ID = #srchOptUsrId#
            AND SSO.EZCANCELFLAG = '0'
        ORDER BY
            SSO.SRCH_OPT_NM ASC
    </statement>

    <statement id="getZoneList" parameterClass="Map"
        resultClass="Map">
        SELECT
            SRC_ZN_CD
        FROM
            SRC_ZN
        WHERE
                GLBL_CMPY_CD = #glblCmpyCd#
            AND EZCANCELFLAG = '0'
        ORDER BY
            SRC_ZN_SORT_NUM ASC
    </statement>
    
    <statement id="getItemClassList" parameterClass="Map"
        resultClass="Map">
        SELECT
            MDSE_ITEM_CLS_TP_CD
            ,MDSE_ITEM_CLS_TP_NM
        FROM
            MDSE_ITEM_CLS_TP
        WHERE
                GLBL_CMPY_CD = #glblCmpyCd#
            AND EZCANCELFLAG = '0'
        ORDER BY
            MDSE_ITEM_CLS_TP_SORT_NUM ASC
    </statement>
    <!--Search-->
    <statement id="search" parameterClass="Map" resultClass="Map">
        SELECT
            IZP.FROM_SRC_ZN_CD
            ,IZP.FROM_RTL_WH_CD
            ,RW1.RTL_WH_NM AS RTL_WH_NM_FROM
            ,IZP.TO_SRC_ZN_CD
            ,IZP.TO_RTL_WH_CD
            ,RW2.RTL_WH_NM AS RTL_WH_NM_TO
            ,MICT.MDSE_ITEM_CLS_TP_CD
            ,IZP.INSRC_ITEM_PRC_THRHD_AMT
            ,IZP.INSRC_RNK_SORT_NUM
            ,IZP.INSRC_ENBL_FLG
            ,IZP.EZUPTIME
            ,IZP.EZUPTIMEZONE
            ,IZP.INSRC_ZN_PLN_PK
            <!-- QC#61128 Add Start -->
            ,IZP.PRCH_REQ_TP_CD
            ,RW1.WH_OWNR_CD WH_OWNR_CD_FROM
            ,RW2.WH_OWNR_CD WH_OWNR_CD_TO
            <!-- QC#61128 Add End -->
        FROM
            INSRC_ZN_PLN IZP
            ,RTL_WH RW1
            ,RTL_WH RW2
            ,MDSE_ITEM_CLS_TP MICT
        WHERE
                IZP.GLBL_CMPY_CD = #glblCmpyCd#
            AND IZP.EZCANCELFLAG = '0'
            AND IZP.GLBL_CMPY_CD = RW1.GLBL_CMPY_CD(+)
            AND IZP.FROM_RTL_WH_CD = RW1.RTL_WH_CD(+)
            AND RW1.EZCANCELFLAG(+) = '0'
            AND IZP.GLBL_CMPY_CD = RW2.GLBL_CMPY_CD(+)
            AND IZP.TO_RTL_WH_CD = RW2.RTL_WH_CD(+)
            AND RW2.EZCANCELFLAG(+) = '0'
            AND IZP.GLBL_CMPY_CD = MICT.GLBL_CMPY_CD(+)
            AND IZP.MDSE_ITEM_CLS_TP_CD = MICT.MDSE_ITEM_CLS_TP_CD(+)
            AND MICT.EZCANCELFLAG(+) = '0'
                <isNotNull property="srcZnCd_SF">
                    AND IZP.FROM_SRC_ZN_CD = #srcZnCd_SF#
                </isNotNull>
                <isNotNull property="srcZnCd_ST">
                    AND IZP.TO_SRC_ZN_CD = #srcZnCd_ST#
                </isNotNull>
                <isNotNull property="rtlWhCd_HF">
                    AND IZP.FROM_RTL_WH_CD = #rtlWhCd_HF#
                </isNotNull>
                <isNotNull property="rtlWhCd_HT">
                    AND IZP.TO_RTL_WH_CD = #rtlWhCd_HT#
                </isNotNull>
                <isNotNull property="mdseItemClsTpCd_SH">
                    AND IZP.MDSE_ITEM_CLS_TP_CD = #mdseItemClsTpCd_SH#
                </isNotNull>
                <isNotNull property="xxChkBox_H1">
                    AND IZP.INSRC_ENBL_FLG = #xxChkBox_H1#
                </isNotNull>
                <!-- QC#61128 Add Start -->
                <isNotNull property="prchReqTpCd_SF">
                    AND IZP.PRCH_REQ_TP_CD = #prchReqTpCd_SF#
                </isNotNull>
                <isEqual property="planTypeS21WhFlg" compareValue="Y">
                   AND IZP.PRCH_REQ_TP_CD is not null
                </isEqual>
                <isEqual property="planTypeS21MnxFlg" compareValue="Y">
                    AND RW1.WH_OWNR_CD = #whMnxCd#
                </isEqual>
                <!-- QC#61128 Add End -->
        ORDER BY
            IZP.INSRC_RNK_SORT_NUM
            ,IZP.INSRC_ZN_PLN_PK
    </statement>
    
    <statement id="getRtlWh" parameterClass="Map"
        resultClass="Map">
        SELECT
            RTL_WH_NM
            ,SRC_ZN_CD
            ,RTL_WH_CATG_CD
            <!-- QC#61128 Add Start -->
            ,WH_OWNR_CD
            <!-- QC#61128 Add End -->
        FROM
            RTL_WH
        WHERE
                GLBL_CMPY_CD = #glblCmpyCd#
            AND EZCANCELFLAG = '0'
            AND RTL_WH_CD = #rtlWhCd#
            AND EFF_FROM_DT &lt;= #effFromDt#
            AND NVL(EFF_THRU_DT, '99991231') &gt;= #effThruDt#
    </statement>
    
    <statement id="checkZone" parameterClass="Map"
        resultClass="Map">
        SELECT
            FROM_SRC_ZN_CD
        FROM
            INSRC_ZN_PLN
        WHERE
                GLBL_CMPY_CD = #glblCmpyCd#
            AND EZCANCELFLAG = '0'
            AND FROM_RTL_WH_CD = #rtlWhCd_HF#
            AND TO_RTL_WH_CD = #rtlWhCd_HT#
                <isNotNull property="mdseItemClsTpCd_SH">
                    AND
                    (
                            MDSE_ITEM_CLS_TP_CD = #mdseItemClsTpCd_SH#
                        OR  MDSE_ITEM_CLS_TP_CD IS NULL
                    )
                </isNotNull>
    </statement>
    
    <!-- QC#61128 Add Start -->
    <statement id="getTechRequestList" parameterClass="Map"
        resultClass="Map">
        SELECT
            PRCH_REQ_TP_CD
            ,PRCH_REQ_TP_DESC_TXT
        FROM
            PRCH_REQ_TP
        WHERE
                GLBL_CMPY_CD = #glblCmpyCd#
            AND EZCANCELFLAG = '0'
            AND PRCH_REQ_REC_TP_CD = #prchReqRecTpCd#
        ORDER BY
            PRCH_REQ_TP_SORT_NUM ASC
    </statement>
    
    <statement id="checkZoneForPrchReqTp" parameterClass="Map"
        resultClass="Map">
        SELECT
            FROM_SRC_ZN_CD
        FROM
            INSRC_ZN_PLN
        WHERE
                GLBL_CMPY_CD = #glblCmpyCd#
            AND EZCANCELFLAG = '0'
            AND FROM_RTL_WH_CD = #rtlWhCd_HF#
            AND TO_RTL_WH_CD = #rtlWhCd_HT#
            <isNotNull property="prchReqTpCd_SF">
                AND PRCH_REQ_TP_CD = #prchReqTpCd_SF#
            </isNotNull>
            <isNull property="prchReqTpCd_SF">
                AND PRCH_REQ_TP_CD is null
            </isNull>
            <isNull property="mdseItemClsTpCd_SH">
               AND MDSE_ITEM_CLS_TP_CD is null
            </isNull>
            <isNotNull property="mdseItemClsTpCd_SH">
               AND MDSE_ITEM_CLS_TP_CD = #mdseItemClsTpCd_SH#
            </isNotNull>
    </statement>
    <!-- QC#61128 Add end -->
</sqlMap>
