<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAB248001">
    <typeAlias alias="SCHD_AGMT_PLNTMsg"        type="business.db.SCHD_AGMT_PLNTMsg" />

    <statement id="getSchdAgmtAdjTgt" parameterClass="Map" resultClass="Map">
        SELECT
             SCHD_AGMT_ADJ_CONTR_PK
        FROM
            SCHD_AGMT_ADJ_CONTR SAAC
        WHERE
                SAAC.GLBL_CMPY_CD           = #glblCmpyCd#
            AND SAAC.EZCANCELFLAG           = '0'
            AND SAAC.SCHD_AGMT_ADJ_STS_CD   = #stsUnprocessed#
        ORDER BY
            SCHD_AGMT_ADJ_CONTR_PK
    </statement>

    <statement id="getSchdAgmtPln" parameterClass="Map" resultMap="result.getSchdAgmtPln">
        SELECT
             GLBL_CMPY_CD
            ,SCHD_AGMT_NUM
            ,SCHD_AGMT_LINE_NUM
            ,SCHD_AGMT_SCHD_LINE_NUM
            ,RDD_DT
            ,ORD_QTY
            ,CPO_ORD_NUM
            ,CPO_DTL_LINE_NUM
            ,CPO_DTL_LINE_SUB_NUM
            ,DS_ORD_POSN_NUM
            ,ORD_CRAT_TS
            ,SCHD_AGMT_PLN_CANC_FLG
            ,ORD_MDSE_CD
        FROM
            SCHD_AGMT_PLN
        WHERE
                GLBL_CMPY_CD        = #glblCmpyCd#
            AND EZCANCELFLAG        = '0'
            AND SCHD_AGMT_NUM       = #schdAgmtNum#
            <isNotNull property="schdAgmtLineNum">
            AND SCHD_AGMT_LINE_NUM  = #schdAgmtLineNum#
            </isNotNull>
        ORDER BY
             SCHD_AGMT_LINE_NUM
            ,SCHD_AGMT_SCHD_LINE_NUM
    </statement>

    <resultMap id="result.getSchdAgmtPln" class="SCHD_AGMT_PLNTMsg">
        <result property="glblCmpyCd"           column="GLBL_CMPY_CD"               javaType="EZDSStringItem"/>
        <result property="schdAgmtNum"          column="SCHD_AGMT_NUM"              javaType="EZDSStringItem"/>
        <result property="schdAgmtLineNum"      column="SCHD_AGMT_LINE_NUM"         javaType="EZDTBigDecimalItem"/>
        <result property="schdAgmtSchdLineNum"  column="SCHD_AGMT_SCHD_LINE_NUM"    javaType="EZDTBigDecimalItem"/>
        <result property="rddDt"                column="RDD_DT"                     javaType="EZDTDateItem"/>
        <result property="ordQty"               column="ORD_QTY"                    javaType="EZDTBigDecimalItem"/>
        <result property="cpoOrdNum"            column="CPO_ORD_NUM"                javaType="EZDSStringItem"/>
        <result property="cpoDtlLineNum"        column="CPO_DTL_LINE_NUM"           javaType="EZDSStringItem"/>
        <result property="cpoDtlLineSubNum"     column="CPO_DTL_LINE_SUB_NUM"       javaType="EZDSStringItem"/>
        <result property="dsOrdPosnNum"         column="DS_ORD_POSN_NUM"            javaType="EZDSStringItem"/>
        <result property="ordCratTs"            column="ORD_CRAT_TS"                javaType="EZDSStringItem"/>
        <result property="schdAgmtPlnCancFlg"   column="SCHD_AGMT_PLN_CANC_FLG"     javaType="EZDSStringItem"/>
        <result property="ordMdseCd"            column="ORD_MDSE_CD"                javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getBillToCustInfoList" parameterClass="Map" resultClass="Map">
        SELECT
             BTC.BILL_TO_CUST_CD AS BILL_TO_CUST_CD
            ,DAC.SELL_TO_CUST_CD AS SELL_TO_CUST_CD
            ,DAC.DS_ACCT_NM     AS DS_ACCT_NM
            ,BTC.LOC_NUM        AS BILL_TO_LOC_NUM
        FROM
            BILL_TO_CUST    BTC
           ,SELL_TO_CUST    DAC
           ,ACCT_LOC     AC
           ,PTY_LOC_WRK  PLW
        WHERE
            BTC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND BTC.BILL_TO_CUST_CD LIKE #custCd#
            AND BTC.RGTN_STS_CD     = #rgtnStsCd#
            AND BTC.EZCANCELFLAG    = '0'
            AND PLW.GLBL_CMPY_CD    = BTC.GLBL_CMPY_CD
            AND PLW.PTY_LOC_PK      = BTC.PTY_LOC_PK
            AND PLW.RGTN_STS_CD     = #rgtnStsCd#
            AND PLW.EZCANCELFLAG    = '0'
            AND AC.GLBL_CMPY_CD     = PLW.GLBL_CMPY_CD
            AND AC.LOC_NUM          = PLW.LOC_NUM
            AND AC.RGTN_STS_CD      = #rgtnStsCd#
            AND AC.EZCANCELFLAG     = '0'
            AND AC.GLBL_CMPY_CD     = DAC.GLBL_CMPY_CD
            AND AC.DS_ACCT_NUM      = DAC.SELL_TO_CUST_CD
            AND DAC.RGTN_STS_CD     = #rgtnStsCd#
            AND DAC.EZCANCELFLAG    = '0'
            AND ROWNUM          &lt;= 2
    </statement>

    <statement id="getShipToCustInfoList" parameterClass="Map" resultClass="Map">
        SELECT
             STC.SHIP_TO_CUST_CD     AS SHIP_TO_CUST_CD
            ,STC.LOC_NM             AS LOC_NM
            ,STC.LOC_NUM            AS LOC_NUM
            ,STC.ADDL_LOC_NM        AS ADDL_LOC_NM
            ,STC.FIRST_LINE_ADDR    AS FIRST_LINE_ADDR
            ,STC.SCD_LINE_ADDR      AS SCD_LINE_ADDR
            ,STC.THIRD_LINE_ADDR    AS THIRD_LINE_ADDR
            ,STC.FRTH_LINE_ADDR     AS FRTH_LINE_ADDR
            ,STC.FIRST_REF_CMNT_TXT AS FIRST_REF_CMNT_TXT
            ,STC.SCD_REF_CMNT_TXT   AS SCD_REF_CMNT_TXT
            ,STC.CTY_ADDR           AS CTY_ADDR
            ,STC.ST_CD              AS ST_CD
            ,STC.POST_CD            AS POST_CD
            ,STC.PROV_NM            AS PROV_NM
            ,STC.CTRY_CD            AS CTRY_CD
            ,DAC.SELL_TO_CUST_CD    AS SELL_TO_CUST_CD
            ,DAC.DS_ACCT_NM         AS DS_ACCT_NM
            ,CNTY.CNTY_NM           AS CNTY_NM
        FROM
            SHIP_TO_CUST STC
           ,SELL_TO_CUST DAC
           ,CNTY         CNTY
           ,ACCT_LOC     AC
           ,PTY_LOC_WRK  PLW
        WHERE
            STC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD LIKE #shipToCustCd#
            AND STC.RGTN_STS_CD     = #rgtnStsCd#
            AND STC.EZCANCELFLAG    = '0'
            AND PLW.GLBL_CMPY_CD    = STC.GLBL_CMPY_CD
            AND PLW.PTY_LOC_PK      = STC.PTY_LOC_PK
            AND PLW.RGTN_STS_CD     = #rgtnStsCd#
            AND PLW.EZCANCELFLAG    = '0'
            AND AC.GLBL_CMPY_CD     = PLW.GLBL_CMPY_CD
            AND AC.LOC_NUM          = PLW.LOC_NUM
            AND AC.RGTN_STS_CD      = #rgtnStsCd#
            AND AC.EZCANCELFLAG     = '0'
            AND AC.GLBL_CMPY_CD     = DAC.GLBL_CMPY_CD
            AND AC.DS_ACCT_NUM      = DAC.SELL_TO_CUST_CD
            AND DAC.RGTN_STS_CD     = #rgtnStsCd#
            AND DAC.EZCANCELFLAG    = '0'
            AND STC.GLBL_CMPY_CD      = CNTY.GLBL_CMPY_CD (+)
            AND STC.CNTY_PK           = CNTY.CNTY_PK (+)
            AND CNTY.EZCANCELFLAG (+) = '0'
            AND ROWNUM            &lt;= 2
    </statement>

    <statement id="getSlsRepInfo" parameterClass="Map" resultClass="Map">
        SELECT
            TOC.TOC_NM           AS TOC_NM
           ,CB.COA_BR_CD         AS COA_BR_CD
           ,CB.COA_BR_DESC_TXT   AS COA_BR_DESC_TXT
           ,CE.COA_EXTN_CD       AS COA_EXTN_CD
           ,CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT
           ,(CASE
                 WHEN CB.COA_BR_CD IS NOT NULL
                 THEN CB.COA_BR_CD || ':' || CB.COA_BR_DESC_TXT
             END) AS COA_BR_ITEM
           ,(CASE
                 WHEN CE.COA_EXTN_CD IS NOT NULL
                 THEN CE.COA_EXTN_CD || ':' || CE.COA_EXTN_DESC_TXT
             END) AS COA_EXTN_ITEM
            ,SP.PSN_NUM         AS PSN_NUM
        FROM
            TOC      TOC
           ,COA_BR   CB
           ,COA_EXTN CE
           ,ORG_FUNC_ASG OFA
           ,S21_PSN  SP
           ,S21_ORG SO
        WHERE
            TOC.GLBL_CMPY_CD     = #glblCmpyCd#
            AND TOC.TOC_CD       = #slsRepTocCd#
            AND TOC.EZCANCELFLAG = '0'

            AND TOC.GLBL_CMPY_CD    = SO.GLBL_CMPY_CD
            AND TOC.TOC_CD          = SO.TOC_CD
            AND SO.EZCANCELFLAG     = '0'

            AND TOC.GLBL_CMPY_CD    = CB.GLBL_CMPY_CD (+)
            AND TOC.COA_BR_CD       = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+) = '0'

            AND TOC.GLBL_CMPY_CD    = CE.GLBL_CMPY_CD (+)
            AND TOC.COA_EXTN_CD     = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+) = '0'

            AND TOC.GLBL_CMPY_CD    = OFA.GLBL_CMPY_CD (+)
            AND TOC.TOC_CD          = OFA.TOC_CD (+)
            AND OFA.EZCANCELFLAG (+) = '0'

            AND OFA.GLBL_CMPY_CD    = SP.GLBL_CMPY_CD (+)
            AND OFA.PSN_CD          = SP.PSN_CD (+)
            AND SP.EZCANCELFLAG (+) = '0'
    </statement>

    <statement id="getCustAddlInfo" parameterClass="Map" resultClass="Map">
        SELECT
            PD.DEF_BILL_TO_CUST_ACCT_CD AS DEF_BILL_TO_CUST_ACCT_CD
           ,PD.DEF_BILL_TO_CUST_CD      AS DEF_BILL_TO_CUST_CD
           ,PD.LINE_BIZ_TP_CD           AS LINE_BIZ_TP_CD
           ,PD.DEF_SHPG_SVC_LVL_CD      AS DEF_SHPG_SVC_LVL_CD
           ,PD.DROP_SHIP_AVAL_FLG       AS DROP_SHIP_AVAL_FLG
           ,DAC.DS_ACCT_NM              AS DS_ACCT_NM
           ,FC.FRT_COND_CD              AS FRT_COND_CD
           ,FC.FRT_COND_DESC_TXT        AS FRT_COND_DESC_TXT
           ,PC.PRC_CATG_CD              AS PRC_CATG_CD
           ,PC.PRC_CATG_NM              AS PRC_CATG_NM
           ,CSL.CARR_SVC_LVL_DESC_TXT   AS CARR_SVC_LVL_DESC_TXT
        FROM
            DS_ORD_TP_PROC_DFN PD
           ,SELL_TO_CUST       DAC
           ,BILL_TO_CUST       BTC
           ,FRT_COND           FC
           ,PRC_CATG           PC
           ,CARR_SVC_LVL       CSL
        WHERE
            PD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND PD.ACTV_FLG     = 'Y'
            AND PD.EFF_FROM_DT  &lt;= #effDt#
            AND NVL(PD.EFF_THRU_DT, '99991231') &gt;= #effDt#
            AND PD.EZCANCELFLAG = '0'

            AND PD.GLBL_CMPY_CD             = DAC.GLBL_CMPY_CD (+)
            AND PD.DEF_BILL_TO_CUST_ACCT_CD = DAC.SELL_TO_CUST_CD (+)
            AND DAC.EZCANCELFLAG (+)        = '0'

            AND PD.GLBL_CMPY_CD        = BTC.GLBL_CMPY_CD (+)
            AND PD.DEF_BILL_TO_CUST_CD = BTC.BILL_TO_CUST_CD (+)
            AND BTC.RGTN_STS_CD (+)    = #rgtnSts#
            AND BTC.EZCANCELFLAG (+)   = '0'

            AND PD.GLBL_CMPY_CD     = FC.GLBL_CMPY_CD (+)
            AND PD.FRT_COND_CD      = FC.FRT_COND_CD (+)
            AND FC.EZCANCELFLAG (+) = '0'

            AND PD.GLBL_CMPY_CD     = PC.GLBL_CMPY_CD (+)
            AND PD.DEF_PRC_CATG_CD  = PC.PRC_CATG_CD (+)
            AND PC.EZCANCELFLAG (+) = '0'

            AND PD.GLBL_CMPY_CD        = CSL.GLBL_CMPY_CD (+)
            AND PD.DEF_CARR_SVC_LVL_CD = CSL.CARR_SVC_LVL_CD (+)
            AND CSL.EZCANCELFLAG (+)   = '0'
    </statement>

    <statement id="getDsLineCatgCd" parameterClass="Map" resultClass="String">
        SELECT
            DOLC.DS_ORD_LINE_CATG_CD AS DS_ORD_LINE_CATG_CD
        FROM
             DS_ORD_LINE_PROC_DFN DOLPD
            ,DS_ORD_LINE_CATG     DOLC
        WHERE
                DOLPD.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND DOLPD.DS_ORD_TP_CD                 = #dsOrdTpCd#
            AND DOLPD.ACTV_FLG                     = 'Y'
            AND DOLPD.PRIM_LINE_CATG_FLG           = 'Y'
            AND DOLPD.EFF_FROM_DT                 &lt;= #slsDt#
            AND NVL(DOLPD.EFF_THRU_DT,'99991231') &gt;= #slsDt#
            AND DOLPD.EZCANCELFLAG                 = '0'
            AND DOLPD.GLBL_CMPY_CD                 = DOLC.GLBL_CMPY_CD
            AND DOLPD.DS_ORD_LINE_CATG_CD          = DOLC.DS_ORD_LINE_CATG_CD
            AND DOLC.DS_ORD_LINE_DRCTN_CD          = #dsOrdLineDrctnCd#
            AND DOLC.EZCANCELFLAG                  = '0'
    </statement>

    <statement id="getBillToLocationNumber" parameterClass="Map" resultClass="String"> 
        SELECT
           BT.LOC_NUM
        FROM
            BILL_TO_CUST    BT
        WHERE
                BT.GLBL_CMPY_CD    = #glblCmpyCd#
            AND BT.BILL_TO_CUST_CD = #custCd#
            AND BT.EZCANCELFLAG    = '0'
            AND ROWNUM            = #rowNum#
    </statement>

    <statement id="getShipToLocationNumber" parameterClass="Map" resultClass="String"> 
        SELECT
           ST.LOC_NUM
        FROM
            SHIP_TO_CUST    ST
        WHERE
                ST.GLBL_CMPY_CD    = #glblCmpyCd#
            AND ST.SHIP_TO_CUST_CD = #custCd#
            AND ST.EZCANCELFLAG    = '0'
            AND ROWNUM            = #rowNum#
    </statement>
    
    <statement id="getSvcLineBizCd" parameterClass="Map" resultClass="String">
        SELECT
            A.SVC_BY_LINE_BIZ_TP_CD AS SVC_LINE_BIZ_CD
        FROM
             SVC_MACH_MSTR A
            ,DS_CONTR B
            ,DS_CONTR_DTL C
        WHERE
                A.GLBL_CMPY_CD          = #glblCmpyCd#
            AND A.EZCANCELFLAG          = '0'
            AND A.GLBL_CMPY_CD          = C.GLBL_CMPY_CD
            AND C.EZCANCELFLAG          = '0'
            AND C.GLBL_CMPY_CD          = B.GLBL_CMPY_CD
            AND B.EZCANCELFLAG          = '0'
            AND C.SVC_CONFIG_MSTR_PK    = #svcConfigMstrPk#
            AND A.SVC_CONFIG_MSTR_PK    = C.SVC_CONFIG_MSTR_PK
            AND C.DS_CONTR_PK           = B.DS_CONTR_PK
            AND A.SVC_MACH_TP_CD        = #machTpCd#
            AND ROWNUM = 1
    </statement>
</sqlMap>
