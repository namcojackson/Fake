<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB264001">
    <statement id="getTargetResource" parameterClass="Map" resultClass="BigDecimal">
        SELECT MORH.MOVE_ORG_RQST_HDR_PK
          FROM MOVE_ORG_RQST_HDR MORH
         WHERE MORH.GLBL_CMPY_CD = #glblCmpyCd#
           AND MORH.EZCANCELFLAG = '0'
           AND MORH.RQST_CRAT_SYS_TP_CD = #rqstCratSysTpCd#
           AND MORH.RQST_RSLT_TP_CD = #rqstRsltTpCd#
         ORDER BY MORH.MOVE_ORG_RQST_HDR_PK
    </statement>

    <statement id="getRequestInfo" parameterClass="Map" resultClass="Map">
        SELECT MORH.MOVE_ORG_RQST_HDR_PK
             , MORH.RQST_USR_ID
             , MORH.RQST_CRAT_TS
             , MORH.RQST_CRAT_SYS_TP_CD
             , MORH.RQST_RSLT_TP_CD
             , MORH.RQST_RSLT_CMNT_TXT
             , MORD.MOVE_ORG_RQST_DTL_PK
             , MORD.CUR_TOC_CD
             , MORD.CUR_ORG_CD
             , MORD.CUR_PSN_NUM
             , MORD.MOVE_PSN_NUM
             , MORD.MOVE_EFF_FROM_DT_TXT
             , MORD.MOVE_EFF_THRU_DT_TXT
             , MORD.MASS_UPD_RSN_CMNT_TXT
             , MORD.RQST_DTL_RSLT_TP_CD
             , MORD.RQST_DTL_RSLT_CMNT_TXT
             , MORH.EZUPTIME    RQST_UPTIME
             , CNT.ORG_REC_CNT
             , PSN1.PSN_NUM      CUR_PSN_NUM_MSTR
             , PSN2.PSN_NUM      MOVE_PSN_NUM_MSTR
             , DOU.ORG_CD        CUR_ORG_CD_MSTR
          FROM MOVE_ORG_RQST_HDR MORH
             , MOVE_ORG_RQST_DTL MORD
             , (SELECT MORD2.CUR_ORG_CD
                     , COUNT(1)  ORG_REC_CNT
                  FROM MOVE_ORG_RQST_DTL MORD2
                 WHERE MORD2.GLBL_CMPY_CD = #glblCmpyCd#
                   AND MORD2.EZCANCELFLAG = '0'
                   AND MORD2.MOVE_ORG_RQST_HDR_PK = #moveOrgRqstHdrPk#
                 GROUP BY MORD2.CUR_ORG_CD
               ) CNT
             , S21_PSN PSN1
             , S21_PSN PSN2
             , DS_ORG_UNIT DOU
         WHERE MORH.GLBL_CMPY_CD = #glblCmpyCd#
           AND MORH.EZCANCELFLAG = '0'
           AND MORH.GLBL_CMPY_CD = MORD.GLBL_CMPY_CD
           AND MORH.EZCANCELFLAG = MORD.EZCANCELFLAG
           AND MORH.MOVE_ORG_RQST_HDR_PK = MORD.MOVE_ORG_RQST_HDR_PK
           AND MORH.MOVE_ORG_RQST_HDR_PK = #moveOrgRqstHdrPk#
           AND MORD.CUR_ORG_CD = CNT.CUR_ORG_CD
           AND MORD.GLBL_CMPY_CD  = PSN1.GLBL_CMPY_CD(+)
           AND MORD.EZCANCELFLAG  = PSN1.EZCANCELFLAG(+)
           AND MORD.CUR_PSN_NUM   = PSN1.PSN_NUM(+)
           AND MORD.GLBL_CMPY_CD  = PSN2.GLBL_CMPY_CD(+)
           AND MORD.EZCANCELFLAG  = PSN2.EZCANCELFLAG(+)
           AND MORD.MOVE_PSN_NUM  = PSN2.PSN_NUM(+)
           AND MORD.GLBL_CMPY_CD  = DOU.GLBL_CMPY_CD(+)
           AND MORD.EZCANCELFLAG  = DOU.EZCANCELFLAG(+)
           AND MORD.CUR_ORG_CD    = DOU.ORG_CD(+)
    </statement>

    <statement id="getWrkInfo" parameterClass="Map" resultClass="Map">
        SELECT MOUW.UPLD_CSV_RQST_PK
             , MOUW.UPLD_CSV_RQST_ROW_NUM
             , MOUW.CUR_ORG_NM
             , MOUW.CUR_PSN_NUM
             , MOUW.MOVE_PSN_NUM
             , MOUW.MOVE_EFF_FROM_DT_TXT
             , MOUW.MOVE_EFF_THRU_DT_TXT
             , MOUW.MASS_UPD_RSN_CMNT_TXT
             , MOUW.UPLD_CSV_RQST_CMNT_TXT
             , MOUW.EZINUSERID   RQST_USR_ID
             , MOUW.EZUPTIME     RQST_UPTIME
             , CNT.ORG_REC_CNT
             , PSN1.PSN_NUM      CUR_PSN_NUM_MSTR
             , PSN2.PSN_NUM      MOVE_PSN_NUM_MSTR
             , DOU.ORG_CD        CUR_ORG_CD_MSTR
          FROM MOVE_ORG_UPD_WRK MOUW
             , (SELECT MOUW2.CUR_ORG_NM
                     , COUNT(1)  ORG_REC_CNT
                  FROM MOVE_ORG_UPD_WRK MOUW2
                 WHERE MOUW2.GLBL_CMPY_CD = #glblCmpyCd#
                   AND MOUW2.EZCANCELFLAG = '0'
                   AND MOUW2.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
                 GROUP BY MOUW2.CUR_ORG_NM
               ) CNT
             , S21_PSN     PSN1
             , S21_PSN     PSN2
             , DS_ORG_UNIT DOU
         WHERE MOUW.GLBL_CMPY_CD = #glblCmpyCd#
           AND MOUW.EZCANCELFLAG = '0'
           AND MOUW.CUR_ORG_NM = CNT.CUR_ORG_NM
           AND MOUW.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
           AND MOUW.CUR_ORG_NM = CNT.CUR_ORG_NM
           AND MOUW.GLBL_CMPY_CD  = PSN1.GLBL_CMPY_CD(+)
           AND MOUW.EZCANCELFLAG  = PSN1.EZCANCELFLAG(+)
           AND MOUW.CUR_PSN_NUM   = PSN1.PSN_NUM(+)
           AND MOUW.GLBL_CMPY_CD  = PSN2.GLBL_CMPY_CD(+)
           AND MOUW.EZCANCELFLAG  = PSN2.EZCANCELFLAG(+)
           AND MOUW.MOVE_PSN_NUM  = PSN2.PSN_NUM(+)
           AND MOUW.GLBL_CMPY_CD  = DOU.GLBL_CMPY_CD(+)
           AND MOUW.EZCANCELFLAG  = DOU.EZCANCELFLAG(+)
           AND MOUW.CUR_ORG_NM    = DOU.ORG_NM(+)
         ORDER BY MOUW.UPLD_CSV_RQST_PK
    </statement>

    <statement id="getCurResrcInfo" parameterClass="Map" resultClass="Map">
        SELECT TOSR.EZUPTIME EZUPTIME_TOC
             , OTCR.EZUPTIME EZUPTIME_REQ
             , PSN.PSN_CD
             , PSN.PSN_NUM
             , PSN.CTRY_CD
             , PSN.POST_CD
             , PSN.ST_CD
             , PSN.CTY_ADDR
             , PSN.LINE_BIZ_TP_CD
             , PSN.PSN_FIRST_NM
             , PSN.PSN_LAST_NM
             , PSN.JOB_TTL_CD
             , OST.ORG_STRU_TP_CD
             , BAO.BIZ_AREA_ORG_CD
             , TOSR.TOC_CD
             , TOSR.ORG_CD
             , OFA.EFF_FROM_DT EFF_FROM_DT_OFA
             , OTCR.ORG_FUNC_ROLE_TP_CD
             , OTCR.ORG_LAYER_NUM
             , OTCR.ASG_CUST_FROM_NM
             , OTCR.ASG_CUST_TO_NM
             , OTCR.ORG_FUNC_ROLE_TP_CD
             , DORR.COA_BR_CD
             , OTCR.COA_CH_CD
             , OTCR.COA_PROD_CD
             , DORR.COA_EXTN_CD
             , DORR.COA_CC_CD
             , DORR.COA_CMPY_CD
             , DOU.EFF_FROM_DT EFF_FROM_DT_DOU
             , NVL(DOU.EFF_THRU_DT, '99991231') EFF_THRU_DT_DOU
             , PSN.EFF_FROM_DT EFF_FROM_DT_PSN
             , NVL(PSN.EFF_THRU_DT, '99991231') EFF_THRU_DT_PSN
             , TOSR.EFF_FROM_DT EFF_FROM_DT_TOSR
             , NVL(TOSR.EFF_THRU_DT, '99991231') EFF_THRU_DT_TOSR
          FROM DS_ORG_UNIT       DOU
             , ORG_STRU_TP       OST
             , BIZ_AREA_ORG      BAO
             , TOC_ORG_STRU_RELN TOSR
             , ORG_TOC_CHNG_RQST OTCR
             , ORG_FUNC_ROLE_TP  OFRT
             , ORG_FUNC_ASG      OFA
             , S21_PSN           PSN
             , DS_ORG_RESRC_REV  DORR
             , REV_ACCT_TP       RAT
         WHERE DOU.GLBL_CMPY_CD = #glblCmpyCd#
           AND DOU.EZCANCELFLAG = '0'
           AND DOU.GLBL_CMPY_CD = OST.GLBL_CMPY_CD
           AND DOU.EZCANCELFLAG = OST.EZCANCELFLAG
           AND DOU.ORG_STRU_TP_CD = OST.ORG_STRU_TP_CD
           AND OST.TRTY_STRU_FLG = #flgN#
           AND DOU.GLBL_CMPY_CD = BAO.GLBL_CMPY_CD
           AND DOU.EZCANCELFLAG = BAO.EZCANCELFLAG
           AND DOU.FIRST_ORG_CD = BAO.BIZ_AREA_ORG_CD
           AND DOU.ORG_STRU_TP_CD = BAO.ORG_STRU_TP_CD
           AND DOU.GLBL_CMPY_CD = TOSR.GLBL_CMPY_CD
           AND DOU.EZCANCELFLAG = TOSR.EZCANCELFLAG
           AND DOU.ORG_STRU_TP_CD = TOSR.ORG_STRU_TP_CD
           AND DOU.ORG_CD        = TOSR.ORG_CD
           AND TOSR.GLBL_CMPY_CD = OTCR.GLBL_CMPY_CD
           AND TOSR.EZCANCELFLAG = OTCR.EZCANCELFLAG
           AND TOSR.TOC_CD       = OTCR.TOC_CD
           AND TOSR.ORG_CD       = OTCR.ORG_CD
           AND OTCR.TOC_CD       = #tocCd#
           AND OTCR.GLBL_CMPY_CD = OFRT.GLBL_CMPY_CD
           AND OTCR.EZCANCELFLAG = OFRT.EZCANCELFLAG
           AND OTCR.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD
           AND OFRT.ACTV_FLG = #flgY#
           AND OTCR.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD
           AND OTCR.EZCANCELFLAG = OFA.EZCANCELFLAG
           AND OTCR.TOC_CD       = OFA.TOC_CD
           AND OFA.GNRN_TP_CD    IN (#gnrnTpCur#, #gnrnTpFut#)
           AND OFA.GLBL_CMPY_CD = PSN.GLBL_CMPY_CD
           AND OFA.EZCANCELFLAG = PSN.EZCANCELFLAG
           AND OFA.PSN_CD       = PSN.PSN_CD
           AND PSN.PSN_NUM = #psnNum#
           AND PSN.GLBL_CMPY_CD = DORR.GLBL_CMPY_CD(+)
           AND PSN.EZCANCELFLAG = DORR.EZCANCELFLAG(+)
           AND PSN.PSN_CD       = DORR.PSN_CD(+)
           AND DORR.EFF_FROM_DT(+)  &lt;= #slsDt#
           AND (DORR.EFF_THRU_DT(+) &gt;= #slsDt# OR DORR.EFF_THRU_DT(+) IS NULL)
           AND DORR.GLBL_CMPY_CD = RAT.GLBL_CMPY_CD(+)
           AND DORR.EZCANCELFLAG = RAT.EZCANCELFLAG(+)
           AND DORR.REV_ACCT_TP_CD = RAT.REV_ACCT_TP_CD(+)
           AND RAT.REV_COA_FLG(+)  = #flgY#

    </statement>

    <statement id="getMoveResrcInfo" parameterClass="Map" resultClass="Map">
        SELECT TOSR.EZUPTIME EZUPTIME_TOC
             , OTCR.EZUPTIME EZUPTIME_REQ
             , PSN.PSN_CD
             , PSN.PSN_NUM
             , PSN.CTRY_CD
             , PSN.POST_CD
             , PSN.ST_CD
             , PSN.CTY_ADDR
             , PSN.LINE_BIZ_TP_CD
             , PSN.PSN_FIRST_NM
             , PSN.PSN_LAST_NM
             , PSN.JOB_TTL_CD
             , OST.ORG_STRU_TP_CD
             , BAO.BIZ_AREA_ORG_CD
             , TOSR.TOC_CD
             , TOSR.ORG_CD
             , OFA.EFF_FROM_DT EFF_FROM_DT_OFA
             , OTCR.ORG_FUNC_ROLE_TP_CD
             , OTCR.ORG_LAYER_NUM
             , OTCR.ASG_CUST_FROM_NM
             , OTCR.ASG_CUST_TO_NM
             , OTCR.ORG_FUNC_ROLE_TP_CD
             , DORR.COA_BR_CD
             , OTCR.COA_CH_CD
             , OTCR.COA_PROD_CD
             , DORR.COA_EXTN_CD
             , DORR.COA_CC_CD
             , DORR.COA_CMPY_CD
             , DOU.EFF_FROM_DT EFF_FROM_DT_DOU
             , NVL(DOU.EFF_THRU_DT, '99991231') EFF_THRU_DT_DOU
             , PSN.EFF_FROM_DT EFF_FROM_DT_PSN
             , NVL(PSN.EFF_THRU_DT, '99991231') EFF_THRU_DT_PSN
             , TOSR.EFF_FROM_DT EFF_FROM_DT_TOSR
             , NVL(TOSR.EFF_THRU_DT, '99991231') EFF_THRU_DT_TOSR
          FROM S21_PSN           PSN
             , DS_ORG_RESRC_REV  DORR
             , REV_ACCT_TP       RAT
             , DS_ORG_UNIT       DOU
             , ORG_STRU_TP       OST
             , BIZ_AREA_ORG      BAO
             , TOC_ORG_STRU_RELN TOSR
             , ORG_TOC_CHNG_RQST OTCR
             , ORG_FUNC_ROLE_TP  OFRT
             , ORG_FUNC_ASG      OFA
         WHERE PSN.GLBL_CMPY_CD = #glblCmpyCd#
           AND PSN.EZCANCELFLAG = '0'
           AND PSN.PSN_NUM      = #psnNum#
           AND PSN.GLBL_CMPY_CD = DORR.GLBL_CMPY_CD(+)
           AND PSN.EZCANCELFLAG = DORR.EZCANCELFLAG(+)
           AND PSN.PSN_CD       = DORR.PSN_CD(+)
           AND DORR.EFF_FROM_DT(+) &lt;= #slsDt#
           AND (DORR.EFF_THRU_DT(+) &gt;= #slsDt# OR DORR.EFF_THRU_DT(+) IS NULL)
           AND DORR.GLBL_CMPY_CD = RAT.GLBL_CMPY_CD(+)
           AND DORR.EZCANCELFLAG = RAT.EZCANCELFLAG(+)
           AND DORR.REV_ACCT_TP_CD = RAT.REV_ACCT_TP_CD(+)
           AND RAT.REV_COA_FLG(+)  = #flgY#

           AND PSN.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD(+)
           AND PSN.EZCANCELFLAG = OFA.EZCANCELFLAG(+)
           AND PSN.PSN_CD       = OFA.PSN_CD(+)
           AND OFA.GNRN_TP_CD(+) IN (#gnrnTpCur#, #gnrnTpFut#)
           AND OFA.GLBL_CMPY_CD = OTCR.GLBL_CMPY_CD(+)
           AND OFA.EZCANCELFLAG = OTCR.EZCANCELFLAG(+)
           AND OFA.TOC_CD       = OTCR.TOC_CD(+)
           AND OFA.EFF_FROM_DT(+) &lt;= #moveEffFromDt#
           AND (OFA.EFF_THRU_DT(+) &gt;= #moveEffFromDt# OR OFA.EFF_THRU_DT(+) IS NULL)
           AND OTCR.GLBL_CMPY_CD = OFRT.GLBL_CMPY_CD(+)
           AND OTCR.EZCANCELFLAG = OFRT.EZCANCELFLAG(+)
           AND OTCR.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD(+)
           AND OFRT.ACTV_FLG(+)  = #flgY#
           AND OTCR.GLBL_CMPY_CD = TOSR.GLBL_CMPY_CD(+)
           AND OTCR.EZCANCELFLAG = TOSR.EZCANCELFLAG(+)
           AND OTCR.TOC_CD       = TOSR.TOC_CD(+)
           AND OTCR.ORG_CD       = TOSR.ORG_CD(+)
           AND TOSR.GLBL_CMPY_CD = DOU.GLBL_CMPY_CD(+)
           AND TOSR.EZCANCELFLAG = DOU.EZCANCELFLAG(+)
           AND TOSR.ORG_STRU_TP_CD = DOU.ORG_STRU_TP_CD(+)
           AND TOSR.ORG_CD      = DOU.ORG_CD(+)
           AND DOU.GLBL_CMPY_CD = OST.GLBL_CMPY_CD(+)
           AND DOU.EZCANCELFLAG = OST.EZCANCELFLAG(+)
           AND DOU.ORG_STRU_TP_CD = OST.ORG_STRU_TP_CD(+)
           AND OST.TRTY_STRU_FLG(+) = #flgN#
           AND DOU.GLBL_CMPY_CD = BAO.GLBL_CMPY_CD(+)
           AND DOU.EZCANCELFLAG = BAO.EZCANCELFLAG(+)
           AND DOU.FIRST_ORG_CD = BAO.BIZ_AREA_ORG_CD(+)
           AND DOU.ORG_STRU_TP_CD = BAO.ORG_STRU_TP_CD(+)
         ORDER BY EZUPTIME_TOC

    </statement>

    <statement id="getSameResrc" parameterClass="Map" resultClass="Map">
        SELECT '1'
          FROM DS_ORG_UNIT       DOU
             , ORG_STRU_TP       OST
             , BIZ_AREA_ORG      BAO
             , TOC_ORG_STRU_RELN TOSR
             , ORG_TOC_CHNG_RQST OTCR
             , ORG_FUNC_ROLE_TP  OFRT
             , ORG_FUNC_ASG      OFA
             , S21_PSN           PSN
         WHERE DOU.GLBL_CMPY_CD = #glblCmpyCd#
           AND DOU.EZCANCELFLAG = '0'
           AND DOU.ORG_CD = #orgCd#
           AND DOU.GLBL_CMPY_CD = OST.GLBL_CMPY_CD
           AND DOU.EZCANCELFLAG = OST.EZCANCELFLAG
           AND DOU.ORG_STRU_TP_CD = OST.ORG_STRU_TP_CD
           AND OST.TRTY_STRU_FLG = #flgN#
           AND DOU.GLBL_CMPY_CD = BAO.GLBL_CMPY_CD
           AND DOU.EZCANCELFLAG = BAO.EZCANCELFLAG
           AND DOU.FIRST_ORG_CD = BAO.BIZ_AREA_ORG_CD
           AND DOU.ORG_STRU_TP_CD = BAO.ORG_STRU_TP_CD
           AND BAO.BIZ_AREA_ORG_CD = #bizAreaOrgCd#
           AND DOU.GLBL_CMPY_CD = TOSR.GLBL_CMPY_CD
           AND DOU.EZCANCELFLAG = TOSR.EZCANCELFLAG
           AND DOU.ORG_STRU_TP_CD = TOSR.ORG_STRU_TP_CD
           AND DOU.ORG_CD        = TOSR.ORG_CD
           AND TOSR.GLBL_CMPY_CD = OTCR.GLBL_CMPY_CD
           AND TOSR.EZCANCELFLAG = OTCR.EZCANCELFLAG
           AND TOSR.TOC_CD       = OTCR.TOC_CD
           AND TOSR.ORG_CD       = OTCR.ORG_CD
           AND OTCR.GLBL_CMPY_CD = OFRT.GLBL_CMPY_CD
           AND OTCR.EZCANCELFLAG = OFRT.EZCANCELFLAG
           AND OTCR.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD
           AND OTCR.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
           AND OTCR.TOC_CD &lt;&gt; #tocCd#
           AND OFRT.ACTV_FLG = #flgY#
           AND OTCR.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD
           AND OTCR.EZCANCELFLAG = OFA.EZCANCELFLAG
           AND OTCR.TOC_CD       = OFA.TOC_CD
           AND OFA.EFF_FROM_DT  &lt;= #effFromDt#
           AND (OFA.EFF_THRU_DT &gt;= #effThruDt# OR OFA.EFF_THRU_DT IS NULL)
           AND OFA.GNRN_TP_CD    IN (#gnrnTpCdCur#, #gnrnTpCdFut#)
           AND OFA.GLBL_CMPY_CD = PSN.GLBL_CMPY_CD
           AND OFA.EZCANCELFLAG = PSN.EZCANCELFLAG
           AND OFA.PSN_CD       = PSN.PSN_CD
           AND PSN.PSN_NUM = #psnNum#
    </statement>
</sqlMap>
    