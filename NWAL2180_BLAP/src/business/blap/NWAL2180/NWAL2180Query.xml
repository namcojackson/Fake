<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL2180Query">

    <statement id="getTierdByCatg" parameterClass="Map" resultClass="Map">
        SELECT
             PTSO.PRC_TIER_SVC_OFFER_CD
            ,PTSO.PRC_TIER_SVC_OFFER_NM
        FROM 
            PRC_TIER_SVC_OFFER          PTSO
            ,PRC_SVC_TIER_CONTR_ATTRB   PSTC
        WHERE
                PSTC.GLBL_CMPY_CD = #glblCmpyCd#
            AND PSTC.PRC_CATG_CD  = #prcCatgCd#
            AND PSTC.EZCANCELFLAG = '0'
            AND PSTC.GLBL_CMPY_CD = PTSO.GLBL_CMPY_CD
            AND PSTC.PRC_TIER_SVC_OFFER_CD  = PTSO.PRC_TIER_SVC_OFFER_CD
            AND PTSO.EZCANCELFLAG = '0'
        ORDER BY 
           PTSO.PRC_TIER_SVC_OFFER_SORT_NUM
    </statement>
    
    <statement id="getContrRsnNm" parameterClass="Map" resultClass="Map">
        SELECT 
            MCOR.MAN_CONTR_OVRD_RSN_NM     MAN_CONTR_OVRD_RSN_NM
        FROM 
            MAN_CONTR_OVRD_RSN MCOR
        WHERE
                MCOR.GLBL_CMPY_CD           = #glblCmpyCd#
            AND MCOR.MAN_CONTR_OVRD_RSN_CD  = #rsnCd#
            AND MCOR.EZCANCELFLAG           = '0'
    </statement>
        
    <statement id="getDsContrNum" parameterClass="Map" resultClass="Map">
        SELECT
            DC.DS_CONTR_NUM
        FROM 
            DS_CONTR      DC
        WHERE
                DC.DS_CONTR_PK      = #dsContrPk#
            AND DC.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DC.EZCANCELFLAG     = '0'
    </statement>
    
    <statement id="getSvcPricingPkList" parameterClass="Map" resultClass="Map">
        SELECT 
            PMP.PRC_MTR_PKG_NM
            ,PMP.PRC_MTR_PKG_PK
        FROM 
            PRC_MTR_PKG            PMP
        WHERE
                PMP.GLBL_CMPY_CD    = #glblCmpyCd#
            AND PMP.PRC_MTR_PKG_PK  = #pkgPk#
            AND PMP.EZCANCELFLAG    = '0'
    </statement>
           
    <statement id="getbllgCycle" parameterClass="Map" resultClass="BigDecimal">
        SELECT 
            BC.BLLG_CYCLE_MTH_AOT
        FROM
            BLLG_CYCLE  BC
        WHERE
                BC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND BC.BLLG_CYCLE_CD        = #bllgCycleCd#
            AND BC.BLLG_CYCLE_ACTV_FLG  = 'Y'
            AND BC.EFF_FROM_DT      &lt;= #effFromDt#
            AND ( BC.EFF_THRU_DT        &gt;= #effFromDt#
                OR BC.EFF_THRU_DT     IS NULL )
            AND BC.EZCANCELFLAG         = '0'
    </statement>
       
                  
    <statement id="getMdlNm" parameterClass="Map" resultClass="Map">
        SELECT
            MN.T_MDL_NM
        FROM 
            MDL_NM      MN
        WHERE
                MN.T_MDL_ID         = #mdlId#
            AND MN.T_GLBL_CMPY_CD   = #glblCmpyCd#
            AND MN.EZCANCELFLAG     = '0'
    </statement>
       
           
    <statement id="getMdseNm" parameterClass="Map" resultClass="String">
        SELECT
            MD.MDSE_DESC_SHORT_TXT
        FROM 
            ALL_MDSE_V      MD
        WHERE
                MD.MDSE_CD          = #mdseCd#
            AND MD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND MD.EZCANCELFLAG     = '0'
    </statement>
       
           
    <statement id="getPrcCatgNm" parameterClass="Map" resultClass="Map">
        SELECT
            PC.PRC_CATG_NM
        FROM 
            PRC_CATG      PC
        WHERE
                PC.PRC_CATG_CD      = #prcCatgCd#
            AND PC.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PC.EZCANCELFLAG     = '0'
    </statement>
           
    <statement id="getPrcListTp" parameterClass="Map" resultClass="Map">
        SELECT
            PLT.PRC_LIST_TP_CD
        FROM
             PRC_CATG                PC
            ,PRC_LIST_TP             PLT
        WHERE
                PC.GLBL_CMPY_CD      = #glblCmpyCd#
            AND PC.PRC_CATG_CD       = #prcCatgCd#
            AND PC.GLBL_CMPY_CD      = PLT.GLBL_CMPY_CD
            AND PC.PRC_LIST_TP_CD    = PLT.PRC_LIST_TP_CD
            AND PC.EZCANCELFLAG      = '0'
            AND PLT.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getSvcPkg21" parameterClass="Map" resultClass="Map">
        SELECT
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        FROM 
             PRC_LIST_SPLY_PGM       PL
            ,PRC_MTR_PKG             PM
            ,PRC_MTR_PKG_MTR_STRU_V  V
        WHERE
            PL.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PL.PRC_CATG_CD          = #prcCatgCd#
            AND PL.MDL_ID               = #modelId#
            AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTp#
            AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTp#
            --
            AND PL.DEL_FLG              = 'N'
            AND PL.EFF_FROM_DT         &lt;= #slsDt#
            AND ( 
                PL.EFF_THRU_DT         IS NULL 
                OR PL.EFF_THRU_DT      &gt;= #slsDt#
            )
            --
            AND PL.GLBL_CMPY_CD         = PM.GLBL_CMPY_CD 
            AND PL.PRC_MTR_PKG_PK       = PM.PRC_MTR_PKG_PK
            --
            AND PM.GLBL_CMPY_CD                 = V.GLBL_CMPY_CD
            AND PM.PRC_MTR_PKG_PK               = V.PRC_MTR_PKG_PK
            AND V.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MDL_MTR_EFF_THRU_DT          IS NULL
                OR V.MDL_MTR_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
            AND (
                V.BLLG_MTR_MAP_EFF_THRU_DT     IS NULL
                OR V.BLLG_MTR_MAP_EFF_THRU_DT  &gt;= #slsDt#
                )
            AND V.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MTR_PKG_EFF_THRU_DT          IS NULL
                OR V.MTR_PKG_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
            AND (
                V.MTR_PKG_MDL_EFF_THRU_DT      IS NULL
                OR V.MTR_PKG_MDL_EFF_THRU_DT   &gt;= #slsDt#
                )
            AND V.EZCANCELFLAG          = '0'
            --
            AND PL.EZCANCELFLAG         = '0'
            AND PM.EZCANCELFLAG         = '0'
        GROUP BY
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        ORDER BY
            PM.PRC_MTR_PKG_NM
    </statement>

    <statement id="getSvcPkg21FL" parameterClass="Map" resultClass="Map">
        SELECT
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        FROM 
             PRC_LIST_SPLY_PGM       PL
            ,PRC_MTR_PKG             PM
            ,PRC_MTR_PKG_MTR_STRU_V  V
        WHERE
            PL.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PL.PRC_CATG_CD          = #prcCatgCd#
            AND PL.MDL_ID               IN
            <iterate property="modelId" var="modelId[]" open="(" close=")" conjunction=",">#modelId[]#</iterate>
            AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTp#
            AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTp#
            --
            AND PL.DEL_FLG              = 'N'
            AND PL.EFF_FROM_DT         &lt;= #slsDt#
            AND ( 
                PL.EFF_THRU_DT         IS NULL 
                OR PL.EFF_THRU_DT      &gt;= #slsDt#
            )
            --
            AND PL.GLBL_CMPY_CD         = PM.GLBL_CMPY_CD
            AND PL.PRC_MTR_PKG_PK       = PM.PRC_MTR_PKG_PK
            --
            AND PM.GLBL_CMPY_CD                 = V.GLBL_CMPY_CD
            AND PM.PRC_MTR_PKG_PK               = V.PRC_MTR_PKG_PK
            AND V.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MDL_MTR_EFF_THRU_DT          IS NULL
                OR V.MDL_MTR_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
            AND (
                V.BLLG_MTR_MAP_EFF_THRU_DT     IS NULL
                OR V.BLLG_MTR_MAP_EFF_THRU_DT  &gt;= #slsDt#
                )
            AND V.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MTR_PKG_EFF_THRU_DT          IS NULL
                OR V.MTR_PKG_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
            AND (
                V.MTR_PKG_MDL_EFF_THRU_DT      IS NULL
                OR V.MTR_PKG_MDL_EFF_THRU_DT   &gt;= #slsDt#
                )
            AND V.EZCANCELFLAG          = '0'
            --
            AND PL.EZCANCELFLAG         = '0'
            AND PM.EZCANCELFLAG         = '0'
        GROUP BY
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        ORDER BY
            PM.PRC_MTR_PKG_NM
    </statement>

    <statement id="getSvcPkg07" parameterClass="Map" resultClass="Map">
        SELECT
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        FROM 
             PRC_LIST_SVC_TIER       PL
            ,PRC_MTR_PKG             PM
            ,PRC_MTR_PKG_MTR_STRU_V  V
        WHERE
            PL.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PL.PRC_CATG_CD          = #prcCatgCd#
            AND PL.MDL_ID               = #modelId#
            AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTp#
            AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTp#
            --
            AND PL.DEL_FLG              = 'N'
            AND PL.EFF_FROM_DT         &lt;= #slsDt#
            AND ( 
                PL.EFF_THRU_DT         IS NULL 
                OR PL.EFF_THRU_DT      &gt;= #slsDt#
            )
            --
            AND PL.GLBL_CMPY_CD         = PM.GLBL_CMPY_CD
            AND PL.PRC_MTR_PKG_PK       = PM.PRC_MTR_PKG_PK
            --
            AND PM.GLBL_CMPY_CD                 = V.GLBL_CMPY_CD
            AND PM.PRC_MTR_PKG_PK               = V.PRC_MTR_PKG_PK
            AND V.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MDL_MTR_EFF_THRU_DT          IS NULL
                OR V.MDL_MTR_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
            AND (
                V.BLLG_MTR_MAP_EFF_THRU_DT     IS NULL
                OR V.BLLG_MTR_MAP_EFF_THRU_DT  &gt;= #slsDt#
                )
            AND V.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MTR_PKG_EFF_THRU_DT          IS NULL
                OR V.MTR_PKG_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
            AND (
                V.MTR_PKG_MDL_EFF_THRU_DT      IS NULL
                OR V.MTR_PKG_MDL_EFF_THRU_DT   &gt;= #slsDt#
                )
            AND V.EZCANCELFLAG          = '0'
            --
            AND PL.EZCANCELFLAG         = '0'
            AND PM.EZCANCELFLAG         = '0'
        GROUP BY
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        ORDER BY
            PM.PRC_MTR_PKG_NM
    </statement>

    <statement id="getSvcPkg07FL" parameterClass="Map" resultClass="Map">
        SELECT
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        FROM 
             PRC_LIST_SVC_TIER       PL
            ,PRC_MTR_PKG             PM
            ,PRC_MTR_PKG_MTR_STRU_V  V
        WHERE
            PL.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PL.PRC_CATG_CD          = #prcCatgCd#
            AND PL.MDL_ID               IN
            <iterate property="modelId" var="modelId[]" open="(" close=")" conjunction=",">#modelId[]#</iterate>
            AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTp#
            AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTp#
            --
            AND PL.DEL_FLG              = 'N'
            AND PL.EFF_FROM_DT         &lt;= #slsDt#
            AND ( 
                PL.EFF_THRU_DT         IS NULL 
                OR PL.EFF_THRU_DT      &gt;= #slsDt#
            )
            --
            AND PL.GLBL_CMPY_CD         = PM.GLBL_CMPY_CD
            AND PL.PRC_MTR_PKG_PK       = PM.PRC_MTR_PKG_PK
            --
            AND PM.GLBL_CMPY_CD                 = V.GLBL_CMPY_CD
            AND PM.PRC_MTR_PKG_PK               = V.PRC_MTR_PKG_PK
            AND V.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MDL_MTR_EFF_THRU_DT          IS NULL
                OR V.MDL_MTR_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
            AND (
                V.BLLG_MTR_MAP_EFF_THRU_DT     IS NULL
                OR V.BLLG_MTR_MAP_EFF_THRU_DT  &gt;= #slsDt#
                )
            AND V.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MTR_PKG_EFF_THRU_DT          IS NULL
                OR V.MTR_PKG_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
            AND (
                V.MTR_PKG_MDL_EFF_THRU_DT      IS NULL
                OR V.MTR_PKG_MDL_EFF_THRU_DT   &gt;= #slsDt#
                )
            AND V.EZCANCELFLAG          = '0'
            --
            AND PL.EZCANCELFLAG         = '0'
            AND PM.EZCANCELFLAG         = '0'
        GROUP BY
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        ORDER BY
            PM.PRC_MTR_PKG_NM
    </statement>

    <statement id="getSvcPkg" parameterClass="Map" resultClass="Map">
        SELECT
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        FROM 
             PRC_LIST_SVC           PL
            ,PRC_MTR_PKG            PM
            ,PRC_MTR_PKG_MTR_STRU_V V
        WHERE
            PL.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PL.PRC_CATG_CD          = #prcCatgCd#
            AND PL.MDL_ID               = #modelId#
            AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTp#
            AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTp#
            --
            AND PL.DEL_FLG              = 'N'
            AND PL.EFF_FROM_DT         &lt;= #slsDt#
            AND ( 
                PL.EFF_THRU_DT         IS NULL 
                OR PL.EFF_THRU_DT      &gt;= #slsDt#
            )
            --
            AND PL.GLBL_CMPY_CD         = PM.GLBL_CMPY_CD
            AND PL.PRC_MTR_PKG_PK       = PM.PRC_MTR_PKG_PK
            --
            AND PM.GLBL_CMPY_CD                 = V.GLBL_CMPY_CD
            AND PM.PRC_MTR_PKG_PK               = V.PRC_MTR_PKG_PK
            AND V.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MDL_MTR_EFF_THRU_DT          IS NULL
                OR V.MDL_MTR_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
            AND (
                V.BLLG_MTR_MAP_EFF_THRU_DT     IS NULL
                OR V.BLLG_MTR_MAP_EFF_THRU_DT  &gt;= #slsDt#
                )
            AND V.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MTR_PKG_EFF_THRU_DT          IS NULL
                OR V.MTR_PKG_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
            AND (
                V.MTR_PKG_MDL_EFF_THRU_DT      IS NULL
                OR V.MTR_PKG_MDL_EFF_THRU_DT   &gt;= #slsDt#
                )
            AND V.EZCANCELFLAG          = '0'
            --
            AND PL.EZCANCELFLAG         = '0'
            AND PM.EZCANCELFLAG         = '0'
        GROUP BY
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        ORDER BY
            PM.PRC_MTR_PKG_NM
    </statement>

    <statement id="getSvcPkgFL" parameterClass="Map" resultClass="Map">
        SELECT
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        FROM 
             PRC_LIST_SVC           PL
            ,PRC_MTR_PKG            PM
            ,PRC_MTR_PKG_MTR_STRU_V V
        WHERE
            PL.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PL.PRC_CATG_CD          = #prcCatgCd#
            AND PL.MDL_ID               IN
            <iterate property="modelId" var="modelId[]" open="(" close=")" conjunction=",">#modelId[]#</iterate>
            AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTp#
            AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTp#
            --
            AND PL.DEL_FLG              = 'N'
            AND PL.EFF_FROM_DT         &lt;= #slsDt#
            AND ( 
                PL.EFF_THRU_DT         IS NULL 
                OR PL.EFF_THRU_DT      &gt;= #slsDt#
            )
            --
            AND PL.GLBL_CMPY_CD         = PM.GLBL_CMPY_CD
            AND PL.PRC_MTR_PKG_PK       = PM.PRC_MTR_PKG_PK
            --
            AND PM.GLBL_CMPY_CD                 = V.GLBL_CMPY_CD
            AND PM.PRC_MTR_PKG_PK               = V.PRC_MTR_PKG_PK
            AND V.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MDL_MTR_EFF_THRU_DT          IS NULL
                OR V.MDL_MTR_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
            AND (
                V.BLLG_MTR_MAP_EFF_THRU_DT     IS NULL
                OR V.BLLG_MTR_MAP_EFF_THRU_DT  &gt;= #slsDt#
                )
            AND V.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
            AND (
                V.MTR_PKG_EFF_THRU_DT          IS NULL
                OR V.MTR_PKG_EFF_THRU_DT       &gt;= #slsDt#
                )
            AND V.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
            AND (
                V.MTR_PKG_MDL_EFF_THRU_DT      IS NULL
                OR V.MTR_PKG_MDL_EFF_THRU_DT   &gt;= #slsDt#
                )
            AND V.EZCANCELFLAG          = '0'
            --
            AND PL.EZCANCELFLAG         = '0'
            AND PM.EZCANCELFLAG         = '0'
        GROUP BY
            PM.PRC_MTR_PKG_PK
            ,PM.PRC_MTR_PKG_NM
        ORDER BY
            PM.PRC_MTR_PKG_NM
    </statement>

    <statement id="getPrcListStru" parameterClass="Map" resultClass="Map">
        SELECT 
            PLS.PRC_LIST_STRU_TP_CD
        FROM 
             PRC_CATG           DPC
            ,PRC_LIST_TP        PLT
            ,PRC_LIST_STRU_TP   PLS
        WHERE
                DPC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND DPC.PRC_CATG_CD         = #prcCatgCd#
            AND DPC.GLBL_CMPY_CD        = PLT.GLBL_CMPY_CD
            AND DPC.PRC_LIST_TP_CD      = PLT.PRC_LIST_TP_CD
            AND PLT.GLBL_CMPY_CD        = PLS.GLBL_CMPY_CD
            AND PLT.PRC_LIST_STRU_TP_CD = PLS.PRC_LIST_STRU_TP_CD
            AND DPC.EZCANCELFLAG        = '0'
            AND PLT.EZCANCELFLAG        = '0'
            AND PLS.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getTierInfo_BandSearch" parameterClass="Map" resultClass="Map">
        SELECT 
             PSTT.PRC_SVC_TIER_TP_CD
            ,PSTT.PRC_SVC_TIER_TP_DESC_TXT
            ,PLST.MIN_COPY_VOL_CNT
            ,PLST.MAX_COPY_VOL_CNT
            ,PLST.CPC_AMT_RATE
            ,PLST.BASE_AMT
            ,PLST.PRC_LIST_BAND_CD
        FROM
            PRC_LIST_SVC_TIER   PLST
            , PRC_SVC_TIER_TP   PSTT
            , PRC_LIST_BAND     PLB
        WHERE
                PLST.GLBL_CMPY_CD           = #glblCmpyCd#
            AND PLST.PRC_CATG_CD            = #prcCatgCd#
            AND PLST.MDL_ID                 = $modelId$
            AND PLST.PRC_MTR_PKG_PK         = $prcMtrPkgPk$
            AND PLST.PRC_SVC_PLN_TP_CD      = #prcSvcPlnTpCd#
            AND PLST.PRC_SVC_CONTR_TP_CD    = #prcSvcContrTp#
            AND PLST.BLLG_MTR_LB_CD         = #bllgMtrBLbCd#
            AND PLST.DEL_FLG                = #delFlg#
            AND PLST.EFF_FROM_DT         &lt;= #prcBaseDt#
            AND (
                PLST.EFF_THRU_DT         &gt;= #prcBaseDt#
              OR
                PLST.EFF_THRU_DT         IS NULL
                )
            AND PLST.EZCANCELFLAG           = '0'
            --
            AND PLST.GLBL_CMPY_CD           = PSTT.GLBL_CMPY_CD
            AND PLST.PRC_SVC_TIER_TP_CD     = PSTT.PRC_SVC_TIER_TP_CD
            AND PSTT.EZCANCELFLAG           = '0'
            --
            AND PLST.GLBL_CMPY_CD           = PLB.GLBL_CMPY_CD
            AND PLST.PRC_LIST_BAND_CD       = PLB.PRC_LIST_BAND_CD
            AND PLB.PRC_LIST_BAND_DESC_TXT  = #prcListBandDescTxt#
            AND PLB.EZCANCELFLAG            = '0'
        ORDER BY
            PSTT.PRC_SVC_TIER_TP_SORT_NUM
    </statement>

    <statement id="getCalcSvcPriceInfo" parameterClass="Map" resultClass="Map">
        SELECT
             PLSP.TOT_BASE_AMT          TOT_BASE_AMT
            ,PLSP.CPC_AMT_RATE          CPC_AMT_RATE
            ,PLSP.MIN_CPC_AMT_RATE      MIN_CPC_AMT_RATE
            ,PLSP.MAX_CPC_AMT_RATE      MAX_CPC_AMT_RATE
            ,PLSP.MTR_MULT_RATE         MTR_MULT_RATE
        FROM
            PRC_CATG            DPC
            ,PRC_MTR_PKG        PMP
            ,MTR_LB             ML
            ,PRC_LIST_SPLY_PGM  PLSP
        WHERE
                PLSP.GLBL_CMPY_CD       = #glblCmpyCd#
            AND PLSP.PRC_CATG_CD        = #prcCatgCd#
            AND PLSP.MDL_ID             = #modelId#
            AND PLSP.PRC_MTR_PKG_PK     = #prcMtrPkgPk#
            AND PLSP.PRC_SVC_PLN_TP_CD  = #prcSvcPlnTpCd#
            AND PLSP.PRC_SVC_CONTR_TP_CD    = #prcSvc_ContrTpCd#
            AND PLSP.BLLG_MTR_LB_CD     = #bllgMtrLbCd#
            AND PLSP.EZCANCELFLAG       = '0'
            AND PLSP.GLBL_CMPY_CD       = DPC.GLBL_CMPY_CD
            AND PLSP.PRC_CATG_CD        = DPC.PRC_CATG_CD
            AND PLSP.EZCANCELFLAG       = '0'    
            AND PLSP.GLBL_CMPY_CD       = PMP.GLBL_CMPY_CD
            AND PLSP.PRC_MTR_PKG_PK     = PMP.PRC_MTR_PKG_PK
            AND PLSP.EZCANCELFLAG       = '0'    
            AND PLSP.GLBL_CMPY_CD       = ML.GLBL_CMPY_CD
            AND PLSP.BLLG_MTR_LB_CD     = ML.MTR_LB_CD
            AND PLSP.EZCANCELFLAG       = '0'
        
        UNION
        
        SELECT
             PLS.BASE_AMT              TOT_BASE_AMT
            ,PLS.CPC_AMT_RATE          CPC_AMT_RATE
            ,PLS.MIN_CPC_AMT_RATE      MIN_CPC_AMT_RATE
            ,PLS.MAX_CPC_AMT_RATE      MAX_CPC_AMT_RATE
            ,PLS.MTR_MULT_RATE         MTR_MULT_RATE
        FROM
            PRC_CATG            DPC
            ,PRC_MTR_PKG        PMP
            ,MTR_LB             ML
            ,PRC_LIST_SVC       PLS
        WHERE
                PLS.GLBL_CMPY_CD       = #glblCmpyCd#
            AND PLS.PRC_CATG_CD        = #prcCatgCd#
            AND PLS.MDL_ID             = #modelId#
            AND PLS.PRC_MTR_PKG_PK     = #prcMtrPkgPk#
            AND PLS.PRC_SVC_PLN_TP_CD  = #prcSvcPlnTpCd#
            AND PLS.PRC_SVC_CONTR_TP_CD    = #prcSvc_ContrTpCd#
            AND PLS.BLLG_MTR_LB_CD     = #bllgMtrLbCd#
            AND PLS.EZCANCELFLAG       = '0'
            AND PLS.GLBL_CMPY_CD       = DPC.GLBL_CMPY_CD
            AND PLS.PRC_CATG_CD        = DPC.PRC_CATG_CD
            AND PLS.EZCANCELFLAG       = '0'    
            AND PLS.GLBL_CMPY_CD       = PMP.GLBL_CMPY_CD
            AND PLS.PRC_MTR_PKG_PK     = PMP.PRC_MTR_PKG_PK
            AND PLS.EZCANCELFLAG       = '0'    
            AND PLS.GLBL_CMPY_CD       = ML.GLBL_CMPY_CD
            AND PLS.BLLG_MTR_LB_CD     = ML.MTR_LB_CD
            AND PLS.EZCANCELFLAG       = '0'
        
        UNION
        
        SELECT
             PLST.BASE_AMT              TOT_BASE_AMT
            ,PLST.CPC_AMT_RATE          CPC_AMT_RATE
            ,PLST.MIN_CPC_AMT_RATE      MIN_CPC_AMT_RATE
            ,PLST.MAX_CPC_AMT_RATE      MAX_CPC_AMT_RATE
            ,PLST.MTR_MULT_RATE         MTR_MULT_RATE
        FROM
            PRC_CATG            DPC
            ,PRC_MTR_PKG        PMP
            ,MTR_LB             ML
            ,PRC_LIST_SVC_TIER  PLST
            ,PRC_SVC_TIER_TP    PSTT
        WHERE
                PLST.GLBL_CMPY_CD       = #glblCmpyCd#
            AND PLST.PRC_CATG_CD        = #prcCatgCd#
            AND PLST.MDL_ID             = #modelId#
            AND PLST.PRC_MTR_PKG_PK     = #prcMtrPkgPk#
            AND PLST.PRC_SVC_PLN_TP_CD  = #prcSvcPlnTpCd#
            AND PLST.PRC_SVC_CONTR_TP_CD    = #prcSvc_ContrTpCd#
            AND PLST.BLLG_MTR_LB_CD     = #bllgMtrLbCd#
            AND PLST.EZCANCELFLAG       = '0'
        
            AND PLST.GLBL_CMPY_CD       = PSTT.GLBL_CMPY_CD
            AND PLST.PRC_SVC_TIER_TP_CD = PSTT.PRC_SVC_TIER_TP_CD
            AND PSTT.EZCANCELFLAG       = '0'
        
            AND PLST.GLBL_CMPY_CD       = DPC.GLBL_CMPY_CD
            AND PLST.PRC_CATG_CD        = DPC.PRC_CATG_CD
            AND PLST.EZCANCELFLAG       = '0'    
            AND PLST.GLBL_CMPY_CD       = PMP.GLBL_CMPY_CD
            AND PLST.PRC_MTR_PKG_PK     = PMP.PRC_MTR_PKG_PK
            AND PLST.EZCANCELFLAG       = '0'    
            AND PLST.GLBL_CMPY_CD       = ML.GLBL_CMPY_CD
            AND PLST.BLLG_MTR_LB_CD     = ML.MTR_LB_CD
            AND PLST.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getTierInfo" parameterClass="Map" resultClass="Map">
        SELECT
              PS.PRC_SVC_TIER_TP_CD
            , PL.MIN_COPY_VOL_CNT
            , PL.MAX_COPY_VOL_CNT
            , PL.CPC_AMT_RATE
            , PL.BASE_AMT
            , PL.PRC_LIST_BAND_CD
        FROM
              PRC_LIST_SVC_TIER      PL
            , PRC_SVC_TIER_TP        PS
        WHERE
                PL.GLBL_CMPY_CD         = #glblCmpyCd#
            AND PL.PRC_CATG_CD          = #priceList#
            AND PL.MDL_ID               = #modelId#
            AND PL.PRC_MTR_PKG_PK       = $prcMtrPkgPk$
            AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTpCd#
            AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTpCd#
            AND PL.BLLG_MTR_LB_CD       = #bllgMtrLbCd#
            AND PL.EFF_FROM_DT         &lt;= #prcBaseDt#
            AND (
                PL.EFF_THRU_DT         &gt;= #prcBaseDt#
              OR
                PL.EFF_THRU_DT         IS NULL
                )
            AND PL.EZCANCELFLAG         = '0'
            AND PL.DEL_FLG              = 'N'
            --
            AND PL.GLBL_CMPY_CD         = PS.GLBL_CMPY_CD
            AND PL.PRC_SVC_TIER_TP_CD   = PS.PRC_SVC_TIER_TP_CD
            AND PS.EZCANCELFLAG         = '0'
        ORDER BY
            PL.PRC_LIST_BAND_CD
            , PS.PRC_SVC_TIER_TP_SORT_NUM
    </statement>

    <statement id="getTierInfoForFleet" parameterClass="Map" resultClass="Map">
        SELECT
              PS.PRC_SVC_TIER_TP_CD
            , PL.MIN_COPY_VOL_CNT
            , PL.MAX_COPY_VOL_CNT
            , PL.CPC_AMT_RATE
            , PL.BASE_AMT
            , PL.PRC_LIST_BAND_CD
        FROM
              PRC_LIST_SVC_TIER      PL
            , PRC_SVC_TIER_TP        PS
        WHERE
                PL.GLBL_CMPY_CD         = #glblCmpyCd#
            AND PL.PRC_CATG_CD          = #priceList#
            AND PL.MDL_ID              IN
            <iterate property="mdlId" var="mdlId[]" open="(" close=")" conjunction=",">
            #mdlId[]#
            </iterate>
            AND PL.PRC_MTR_PKG_PK       = $prcMtrPkgPk$
            AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTpCd#
            AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTpCd#
            AND PL.BLLG_MTR_LB_CD       = #bllgMtrLbCd#
            AND PL.EFF_FROM_DT         &lt;= #prcBaseDt#
            AND (
                PL.EFF_THRU_DT         &gt;= #prcBaseDt#
              OR
                PL.EFF_THRU_DT         IS NULL
                )
            AND PL.EZCANCELFLAG         = '0'
            AND PL.DEL_FLG              = 'N'
            --
            AND PL.GLBL_CMPY_CD         = PS.GLBL_CMPY_CD
            AND PL.PRC_SVC_TIER_TP_CD   = PS.PRC_SVC_TIER_TP_CD
            AND PS.EZCANCELFLAG         = '0'
        ORDER BY
            PL.PRC_LIST_BAND_CD
            , PS.PRC_SVC_TIER_TP_SORT_NUM
    </statement>

    <statement id="getPrcConfName" parameterClass="Map" resultClass="Map">
        SELECT
            PLE.PRC_LIST_EQUIP_CONFIG_NUM
            ,PLE.PRC_LIST_EQUIP_CONFIG_NM
        FROM
            PRC_LIST_EQUIP  PLE
        WHERE
                PLE.GLBL_CMPY_CD        = #glblCmpyCd#
            AND PLE.PRC_QLFY_VAL_TXT    = #coveredItem#
            AND PLE.PRC_CATG_CD         = #prcList#
            AND PLE.PRC_QLFY_TP_CD      = #itemCd#
            AND PLE.EFF_FROM_DT        &lt;= #slsDt#
            AND (
                PLE.EFF_THRU_DT        &gt;= #slsDt#
                OR
                PLE.EFF_THRU_DT        IS NULL
                )
            AND PLE.DEL_FLG             = 'N'
            AND PLE.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getMtrLb" parameterClass="Map" resultClass="Map">
        WITH MTR_PKG_V AS ( 
            SELECT DISTINCT
                      MS.BLLG_MTR_LB_CD         AS BILLING_COUNTER_CD
                    , MS.BLLG_MTR_LB_NM         AS BILLING_COUNTER_NM
                    , MS.INTG_MDSE_CD           AS USAGE_ITEM_CD
                    , MS.INTG_MDSE_NM           AS USAGE_ITEM_NM
                    , MS.REG_MTR_LB_CD          AS HARD_COUNTER_CD
                    , MS.REG_MTR_LB_NM          AS HARD_COUNTER_NM
                    , MS.MTR_MULT_RATE          AS MTR_MULT_RATE
                    , MS.BLLG_MTR_LB_SORT_NUM
                    , MS.REG_MTR_LB_SORT_NUM
                FROM
                    PRC_MTR_PKG_MTR_STRU_V MS
                WHERE
                    MS.GLBL_CMPY_CD                     = #glblCmpyCd#
                    AND MS.MDL_ID                       = $mdlId$
                    AND MS.PRC_MTR_PKG_PK               = $prcMtrPkgPk$
                    AND MS.ACTV_FLG                     = 'Y'
                    AND MS.BLLBL_FLG                    = 'Y'
                    AND MS.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
                    AND ( 
                        MS.MDL_MTR_EFF_THRU_DT          &gt;= #slsDt#
                        OR MS.MDL_MTR_EFF_THRU_DT       IS NULL
                    ) 
                    AND MS.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
                    AND ( 
                        MS.BLLG_MTR_MAP_EFF_THRU_DT     &gt;= #slsDt#
                        OR MS.BLLG_MTR_MAP_EFF_THRU_DT  IS NULL
                    ) 
                    AND MS.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
                    AND ( 
                        MS.MTR_PKG_EFF_THRU_DT          &gt;= #slsDt#
                        OR MS.MTR_PKG_EFF_THRU_DT       IS NULL
                    ) 
                    AND MS.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
                    AND ( 
                        MS.MTR_PKG_MDL_EFF_THRU_DT      &gt;= #slsDt#
                        OR MS.MTR_PKG_MDL_EFF_THRU_DT   IS NULL
                    )
        ) 
        SELECT
                  V.BILLING_COUNTER_CD
                -- , V.BILLING_COUNTER_NM
                , MB.MTR_LB_DESC_TXT    BILLING_COUNTER_NM
                , V.USAGE_ITEM_CD
                , V.USAGE_ITEM_NM
                , V.HARD_COUNTER_CD
                -- , V.HARD_COUNTER_NM
                , MH.MTR_LB_DESC_TXT    HARD_COUNTER_NM
                , V.MTR_MULT_RATE
            FROM
                MTR_PKG_V       V
                , MTR_LB        MB
                , MTR_LB        MH
            WHERE
                MB.GLBL_CMPY_CD     = #glblCmpyCd#
                AND MB.MTR_LB_CD    = V.BILLING_COUNTER_CD
                AND MB.EZCANCELFLAG = '0'
                AND MH.GLBL_CMPY_CD = #glblCmpyCd#
                AND MH.MTR_LB_CD    = V.HARD_COUNTER_CD
                AND MH.EZCANCELFLAG = '0'
            ORDER BY
                V.BLLG_MTR_LB_SORT_NUM
                , V.REG_MTR_LB_SORT_NUM
    </statement>

    <statement id="isInMtrDB" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
                  MS.MDL_ID
            FROM
                PRC_MTR_PKG_MTR_STRU_V MS
            WHERE
                MS.GLBL_CMPY_CD                     = #glblCmpyCd#
                AND MS.MDL_ID                      IN
                <iterate property="mdlId" var="mdlId[]" open="(" close=")" conjunction=",">
                #mdlId[]#
                </iterate>
                AND MS.PRC_MTR_PKG_PK               = $prcMtrPkgPk$
                AND MS.ACTV_FLG                     = 'Y'
                AND MS.BLLBL_FLG                    = 'Y'
                AND MS.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
                AND ( 
                    MS.MDL_MTR_EFF_THRU_DT          &gt;= #slsDt#
                    OR MS.MDL_MTR_EFF_THRU_DT       IS NULL
                ) 
                AND MS.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
                AND ( 
                    MS.BLLG_MTR_MAP_EFF_THRU_DT     &gt;= #slsDt#
                    OR MS.BLLG_MTR_MAP_EFF_THRU_DT  IS NULL
                ) 
                AND MS.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
                AND ( 
                    MS.MTR_PKG_EFF_THRU_DT          &gt;= #slsDt#
                    OR MS.MTR_PKG_EFF_THRU_DT       IS NULL
                ) 
                AND MS.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
                AND ( 
                    MS.MTR_PKG_MDL_EFF_THRU_DT      &gt;= #slsDt#
                    OR MS.MTR_PKG_MDL_EFF_THRU_DT   IS NULL
                )
    </statement>

    <statement id="getMtrLbFL" parameterClass="Map" resultClass="Map">
        WITH MTR_PKG_V AS ( 
            SELECT DISTINCT
                      MS.BLLG_MTR_LB_CD         AS BILLING_COUNTER_CD
                    , MS.BLLG_MTR_LB_NM         AS BILLING_COUNTER_NM
                    , MS.INTG_MDSE_CD           AS USAGE_ITEM_CD
                    , MS.INTG_MDSE_NM           AS USAGE_ITEM_NM
                    , MS.REG_MTR_LB_CD          AS HARD_COUNTER_CD
                    , MS.REG_MTR_LB_NM          AS HARD_COUNTER_NM
                    , MS.MTR_MULT_RATE          AS MTR_MULT_RATE
                    , MS.BLLG_MTR_LB_SORT_NUM
                    , MS.REG_MTR_LB_SORT_NUM
                FROM
                    PRC_MTR_PKG_MTR_STRU_V MS
                WHERE
                    MS.GLBL_CMPY_CD                     = #glblCmpyCd#
                    AND MS.MDL_ID                      IN
                    <iterate property="mdlId" var="mdlId[]" open="(" close=")" conjunction=",">
                    #mdlId[]#
                    </iterate>
                    AND MS.PRC_MTR_PKG_PK               = $prcMtrPkgPk$
                    AND MS.ACTV_FLG                     = 'Y'
                    AND MS.BLLBL_FLG                    = 'Y'
                    AND MS.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
                    AND ( 
                        MS.MDL_MTR_EFF_THRU_DT          &gt;= #slsDt#
                        OR MS.MDL_MTR_EFF_THRU_DT       IS NULL
                    ) 
                    AND MS.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
                    AND ( 
                        MS.BLLG_MTR_MAP_EFF_THRU_DT     &gt;= #slsDt#
                        OR MS.BLLG_MTR_MAP_EFF_THRU_DT  IS NULL
                    ) 
                    AND MS.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
                    AND ( 
                        MS.MTR_PKG_EFF_THRU_DT          &gt;= #slsDt#
                        OR MS.MTR_PKG_EFF_THRU_DT       IS NULL
                    ) 
                    AND MS.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
                    AND ( 
                        MS.MTR_PKG_MDL_EFF_THRU_DT      &gt;= #slsDt#
                        OR MS.MTR_PKG_MDL_EFF_THRU_DT   IS NULL
                    )
        ) 
        SELECT
                  V.BILLING_COUNTER_CD
                , V.BILLING_COUNTER_NM
                , V.USAGE_ITEM_CD
                , V.USAGE_ITEM_NM
                , V.HARD_COUNTER_CD
                , V.HARD_COUNTER_NM
                , V.MTR_MULT_RATE
            FROM
                MTR_PKG_V V
            ORDER BY
                V.BLLG_MTR_LB_SORT_NUM
                , V.REG_MTR_LB_SORT_NUM
    </statement>

    <statement id="getMtrNm" parameterClass="Map" resultClass="String">
        SELECT      
            <!-- ML.MTR_LB_NM -->
                 ML.MTR_LB_DESC_TXT
        FROM        MTR_LB ML
        WHERE
                ML.MTR_LB_CD     = #mtrLbCd#
            AND ML.GLBL_CMPY_CD  = #glblCmpyCd#
            AND ML.EZCANCELFLAG = '0'
    </statement>

    <statement id="cntImptRentalOrder" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(DIO.GLBL_CMPY_CD)    CNT
            FROM
                ORD_CATG_BIZ_CTX    BC
                , DS_IMPT_ORD       DIO
            WHERE
                BC.GLBL_CMPY_CD             = #glblCmpyCd#
                AND BC.ORD_CATG_CTX_TP_CD   = #ordCatgCtxTpCd# -- 'RENTAL_ORDER'
                AND BC.EZCANCELFLAG         = '0'
                AND BC.GLBL_CMPY_CD         = DIO.GLBL_CMPY_CD
                AND BC.DS_ORD_CATG_CD       = DIO.DS_ORD_CATG_CD
                AND (
                    BC.DS_ORD_TP_CD         = DIO.DS_ORD_TP_CD
                    OR BC.DS_ORD_TP_CD     IS NULL
                ) 
                AND (
                    BC.DS_ORD_RSN_CD        = DIO.DS_ORD_RSN_CD
                    OR BC.DS_ORD_RSN_CD    IS NULL
                ) 
                AND DIO.ORD_SRC_REF_NUM     = #xxScrItem50Txt#
                AND DIO.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getAnnualPrc" parameterClass="Map" resultClass="Map">
        SELECT
                  PLS.BASE_AMT
            FROM
                PRC_LIST_SVC    PLS
            WHERE
                PLS.GLBL_CMPY_CD              = #glblCmpyCd#
                AND PLS.PRC_RATE_TP_CD        = #annual#
                AND PLS.PRC_CATG_CD           = #prcCatgCd#
                AND PLS.MDL_ID                = $mdlId$
                AND PLS.PRC_MTR_PKG_PK        = #prcMtrPkgPk#
                AND PLS.PRC_SVC_PLN_TP_CD     = #prcSvcPlnTpCd#
                AND PLS.PRC_SVC_CONTR_TP_CD   = #prcSvcContrTpCd#
                AND PLS.EFF_FROM_DT          &lt;= #slsDt#
                AND (
                    PLS.EFF_THRU_DT          &gt;= #slsDt#
                    OR PLS.EFF_THRU_DT       IS NULL
                )
                AND PLS.DEL_FLG               = 'N'
                --
                AND PLS.TERM_FROM_MTH_AOT  &lt;=  #termMthNum#
                AND
                  (
                   PLS.TERM_THRU_MTH_AOT   &gt;=  #termMthNum#
                 OR
                   PLS.TERM_THRU_MTH_AOT   IS NULL
                  )
                --
                AND PLS.EZCANCELFLAG = '0'
            ORDER BY
                PLS.PRC_LIST_SVC_PK
    </statement>

    <statement id="getBllgCycleList" parameterClass="Map" resultClass="Map">
        SELECT
                  BC.BLLG_CYCLE_CD
                , BC.BLLG_CYCLE_DESC_TXT
                , BLLG_CYCLE_MTH_AOT 
            FROM
                BLLG_CYCLE BC
            WHERE
                BC.GLBL_CMPY_CD             = #glblCmpyCd#
                AND BC.BLLG_CYCLE_ACTV_FLG  = 'Y'
                AND BC.EFF_FROM_DT         &lt;= #slsDt#
                AND ( 
                    BC.EFF_THRU_DT         &gt;= #slsDt#
                    OR BC.EFF_THRU_DT       IS NULL
                )
                AND BC.OM_CYCLE_FLG = 'Y'
                AND BC.EZCANCELFLAG = '0'
            ORDER BY
                BC.BLLG_CYCLE_SORT_NUM
    </statement>

    <statement id="getContractIndicatorList" parameterClass="Map" resultClass="Map">
        SELECT
                  C.DS_CONTR_CATG_CD
                , C.DS_CONTR_CATG_DESC_TXT
            FROM
                DS_CONTR_CATG   C
            WHERE
                C.GLBL_CMPY_CD      = #glblCmpyCd#
                AND C.OM_CATG_FLG   = 'Y'
                AND C.EZCANCELFLAG  = '0'
            ORDER BY
                C.DS_CONTR_CATG_SORT_NUM
    </statement>

    <statement id="getDefaultMdlSvcPrc" parameterClass="Map" resultClass="Map">
        SELECT
                  PD.DEF_MAINT_PRC_CATG_CD
                  , PC.PRC_CATG_NM
                  , PC.PRC_LIST_TP_CD
            FROM
                DS_ORD_TP_PROC_DFN  PD
                , PRC_CATG          PC
            WHERE
                PD.GLBL_CMPY_CD              = #glblCmpyCd#
                AND PD.DS_ORD_TP_CD          = #dsOrdTpCd#
                AND PD.ACTV_FLG              = 'Y'
                AND PD.EFF_FROM_DT          &lt;= #slsDt#
                AND (
                    PD.EFF_THRU_DT          &gt;= #slsDt#
                    OR PD.EFF_THRU_DT       IS NULL
                )
                AND PD.EZCANCELFLAG          = '0'
                --
                AND PD.GLBL_CMPY_CD          = PC.GLBL_CMPY_CD
                AND PD.DEF_MAINT_PRC_CATG_CD = PC.PRC_CATG_CD
                --
                AND PC.EFF_FROM_DT         &lt;= #slsDt#
                AND (
                    PC.EFF_THRU_DT         &gt;= #slsDt#
                    OR PC.EFF_THRU_DT      IS NULL
                )
                AND PC.ACTV_FLG             = 'Y'
                AND PC.DEL_FLG              = 'N'
                AND PC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getDefaultMdlSvcPrcByQlfy" parameterClass="Map" resultClass="Map">
        SELECT
                  PL.PRC_LIST_STRU_TP_CD
                , PL.PRC_CATG_CD
                , PC.PRC_CATG_NM
                , PC.PRC_LIST_TP_CD
            FROM
                PRC_CATG        PC
                , ( 
                    SELECT
                              PRC_LIST_STRU_TP_CD
                            , PRC_CATG_CD
                        FROM
                            ( 
                                SELECT
                                          --'PRC_LIST_SVC' TBL_NM
                                        #prcListStruTpService#  PRC_LIST_STRU_TP_CD -- '02' PRC_LIST_STRU_TP.SERVICE
                                        , PLS.PRC_CATG_CD
                                    FROM
                                        PRC_LIST_SVC    PLS
                                    WHERE
                                        PLS.GLBL_CMPY_CD             = #glblCmpyCd#
                                        AND PLS.MDL_ID               = #mdlId#
                                        AND PLS.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTp#
                                        AND PLS.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTp#
                                        AND PLS.EFF_FROM_DT         &lt;= #slsDt#
                                        AND ( 
                                            PLS.EFF_THRU_DT         IS NULL
                                            OR PLS.EFF_THRU_DT      &gt;= #slsDt#
                                        ) 
                                        AND PLS.DEL_FLG              = 'N'
                                        AND PLS.TERM_FROM_MTH_AOT   &lt;= #termMth#
                                        AND ( 
                                            PLS.TERM_THRU_MTH_AOT   &gt;= #termMth#
                                            OR PLS.TERM_THRU_MTH_AOT IS NULL
                                        ) 
                                        AND PLS.EZCANCELFLAG         = '0'
                                UNION ALL
                                SELECT
                                          --  'PRC_LIST_SVC_TIER'
                                        #prcListStruTpServiceTiers#  -- '03' PRC_LIST_STRU_TP.SERVICE TIERS
                                        , PLST.PRC_CATG_CD 
                                    FROM
                                        PRC_LIST_SVC_TIER   PLST
                                    WHERE
                                        PLST.GLBL_CMPY_CD            = #glblCmpyCd#
                                        AND PLST.MDL_ID              = #mdlId#
                                        AND PLST.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTp#
                                        AND PLST.PRC_SVC_CONTR_TP_CD = #prcSvcContrTp#
                                        AND PLST.EFF_FROM_DT        &lt;= #slsDt#
                                        AND (
                                            PLST.EFF_THRU_DT        IS NULL
                                            OR PLST.EFF_THRU_DT     &gt;= #slsDt#
                                        ) 
                                        AND PLST.DEL_FLG             = 'N'
                                        AND PLST.TERM_FROM_MTH_AOT  &lt;= #termMth#
                                        AND ( 
                                            PLST.TERM_THRU_MTH_AOT  &gt;= #termMth#
                                            OR PLST.TERM_THRU_MTH_AOT IS NULL
                                        ) 
                                        AND PLST.EZCANCELFLAG        = '0'
                                UNION ALL
                                SELECT
                                          --  'PRC_LIST_SPLY_PGM'
                                        #prcListStruTpSupplyProgram#  --'05' PRC_LIST_STRU_TP.SUPPLY PROGRAM
                                        , PLSP.PRC_CATG_CD
                                    FROM
                                        PRC_LIST_SPLY_PGM   PLSP
                                    WHERE
                                        PLSP.GLBL_CMPY_CD            = #glblCmpyCd#
                                        AND PLSP.MDL_ID              = #mdlId#
                                        AND PLSP.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTp#
                                        AND PLSP.PRC_SVC_CONTR_TP_CD = #prcSvcContrTp#
                                        AND PLSP.EFF_FROM_DT        &lt;= #slsDt#
                                        AND (
                                            PLSP.EFF_THRU_DT        IS NULL
                                            OR PLSP.EFF_THRU_DT     &gt;= #slsDt#
                                        ) 
                                        AND PLSP.DEL_FLG             = 'N'
                                        AND PLSP.TERM_FROM_MTH_AOT  &lt;= #termMth#
                                        AND ( 
                                            PLSP.TERM_THRU_MTH_AOT  &gt;= #termMth#
                                            OR PLSP.TERM_THRU_MTH_AOT IS NULL
                                        )
                                        AND PLSP.EZCANCELFLAG        = '0'
                            ) 
                        GROUP BY
                            PRC_LIST_STRU_TP_CD
                            , PRC_CATG_CD
                )   PL
            WHERE
                PC.GLBL_CMPY_CD          = #glblCmpyCd#
                AND PC.PRC_CATG_CD       = PL.PRC_CATG_CD
                --
                AND PC.EFF_FROM_DT     &lt;= #slsDt#
                AND (PC.EFF_THRU_DT    IS NULL
                OR PC.EFF_THRU_DT      &gt;= #slsDt#
                )
                AND PC.ACTV_FLG         = 'Y'
                AND PC.EZCANCELFLAG     = '0'
                AND PC.PRC_LIST_TP_CD  IN (
                    SELECT
                              PLT.PRC_LIST_TP_CD
                        FROM
                            PRC_LIST_TP                 PLT
                            , DS_ORD_TP_PRC_LIST_RELN   PLR
                            , PRC_CTX_RELN              PCR
                        WHERE
                            PLT.GLBL_CMPY_CD        = #glblCmpyCd#
                            AND PLT.EZCANCELFLAG    = '0'
                            --
                            AND PLT.GLBL_CMPY_CD    = PLR.GLBL_CMPY_CD
                            AND PLT.PRC_LIST_TP_CD  = PLR.PRC_LIST_TP_CD
                            AND PLR.DS_ORD_TP_CD    = #dsOrdTpCd#
                            AND PLR.EZCANCELFLAG    = '0'
                            -- 
                            AND PLT.GLBL_CMPY_CD    = PCR.GLBL_CMPY_CD 
                            AND PLT.PRC_LIST_TP_CD  = PCR.PRC_LIST_TP_CD 
                            AND PCR.PRC_CTX_TP_CD   = #prcCtxTpServicePricing#
                            AND PCR.EZCANCELFLAG    = '0'
                ) 
    </statement>

    <statement id="getPrcRateTpCd" parameterClass="Map" resultClass="String">
        SELECT
                PLS.PRC_RATE_TP_CD
                , PLS.MDL_ID
                , PLS.PRC_MTR_PKG_PK
                , PLS.BASE_AMT
            FROM
                PRC_CATG         DPC
                , PRC_LIST_SVC   PLS
            WHERE
                DPC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND DPC.EZCANCELFLAG        = '0'
            AND DPC.PRC_CATG_CD         = #prcCatgCd#
            AND DPC.ACTV_FLG            = #activFlg#
            ANd DPC.DEL_FLG             = #delFlg#
            AND DPC.EFF_FROM_DT        &lt;= #prcBaseDt#
            AND (
                DPC.EFF_THRU_DT        &gt;= #prcBaseDt#
             OR DPC.EFF_THRU_DT        IS NULL )
            AND DPC.GLBL_CMPY_CD        = PLS.GLBL_CMPY_CD
            AND DPC.EZCANCELFLAG        = PLS.EZCANCELFLAG
            AND DPC.PRC_CATG_CD         = PLS.PRC_CATG_CD
            AND PLS.MDL_ID              = #mdlId#
        <isNotNull property="prcMtrPkgPk">
            AND PLS.PRC_MTR_PKG_PK      = #prcMtrPkgPk#
        </isNotNull>
            AND PLS.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTpCd#
            AND PLS.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
            --
                AND PLS.TERM_FROM_MTH_AOT  &lt;=  #termMthNum#
                AND
                  (
                   PLS.TERM_THRU_MTH_AOT   &gt;=  #termMthNum#
                 OR
                   PLS.TERM_THRU_MTH_AOT   IS NULL
                  )
            --
            AND PLS.EFF_FROM_DT        &lt;= #prcBaseDt#
            AND (
                PLS.EFF_THRU_DT        &gt;= #prcBaseDt#
             OR PLS.EFF_THRU_DT        IS NULL )
            AND PLS.DEL_FLG             = #delFlg#
            AND ROWNUM                  = #rownum1#
    </statement>

    <statement id="getBandBasePrc" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                  CASE 
                    WHEN PLT.PRC_LIST_STRU_TP_CD = #prcListStruTpService#
                    THEN ( 
                        SELECT
                                  PLS.BASE_AMT
                            FROM
                                PRC_LIST_SVC        PLS
                                , PRC_LIST_BAND     PLB
                            WHERE
                                PLS.GLBL_CMPY_CD                = DPC.GLBL_CMPY_CD
                                AND PLS.PRC_CATG_CD             = DPC.PRC_CATG_CD
                                --
                                AND PLS.MDL_ID                  = #mdlId#
                                AND PLS.PRC_MTR_PKG_PK          = #prcMtrPkgPk#
                                AND PLS.PRC_SVC_PLN_TP_CD       = #prcSvcPlnTpCd#
                                AND PLS.PRC_SVC_CONTR_TP_CD     = #prcSvcContrTpCd#
                                AND PLS.BLLG_MTR_LB_CD          = #bllgMtrLbCd#
                                AND PLS.EFF_FROM_DT             &lt;= #slsDt#
                                AND ( 
                                    PLS.EFF_THRU_DT             IS NULL
                                    OR PLS.EFF_THRU_DT          &gt;= #slsDt#
                                ) 
                                AND PLS.DEL_FLG                  = 'N'
                                --
                                AND PLS.TERM_FROM_MTH_AOT       &lt;= #termMth#
                                AND (
                                    PLS.TERM_THRU_MTH_AOT       &gt;= #termMth#
                                    OR PLS.TERM_THRU_MTH_AOT    IS NULL
                                )
                                AND PLS.EZCANCELFLAG             = '0'
                                -- 
                                AND PLS.PRC_LIST_BAND_CD         = PLB.PRC_LIST_BAND_CD
                                AND PLS.GLBL_CMPY_CD             = PLB.GLBL_CMPY_CD
                                AND PLB.PRC_LIST_BAND_DESC_TXT   = #prcListBandDescTxt#
                                AND PLB.EZCANCELFLAG             = '0'
                                AND ROWNUM = 1
                    ) 
                    WHEN PLT.PRC_LIST_STRU_TP_CD = #prcListStruTpServiceTiers#
                    THEN ( 
                        SELECT
                                  PLST.BASE_AMT
                            FROM
                                PRC_LIST_SVC_TIER   PLST
                                , PRC_LIST_BAND     PLB
                            WHERE
                                PLST.GLBL_CMPY_CD                = DPC.GLBL_CMPY_CD
                                AND PLST.PRC_CATG_CD             = DPC.PRC_CATG_CD 
                                --
                                AND PLST.MDL_ID                  = #mdlId#
                                AND PLST.PRC_MTR_PKG_PK          = #prcMtrPkgPk#
                                AND PLST.PRC_SVC_PLN_TP_CD       = #prcSvcPlnTpCd#
                                AND PLST.PRC_SVC_CONTR_TP_CD     = #prcSvcContrTpCd#
                                AND PLST.BLLG_MTR_LB_CD          = #bllgMtrLbCd#
                                AND PLST.EFF_FROM_DT            &lt;= #slsDt#
                                AND ( 
                                    PLST.EFF_THRU_DT            IS NULL
                                    OR PLST.EFF_THRU_DT         &gt;= #slsDt#
                                ) 
                                AND PLST.DEL_FLG                = 'N'
                                --
                                AND PLST.TERM_FROM_MTH_AOT      &lt;= #termMth#
                                AND ( 
                                    PLST.TERM_THRU_MTH_AOT      &gt;= #termMth#
                                    OR PLST.TERM_THRU_MTH_AOT   IS NULL
                                )
                                AND PLST.EZCANCELFLAG = '0'
                                -- 
                                AND PLST.GLBL_CMPY_CD            = PLB.GLBL_CMPY_CD
                                AND PLST.PRC_LIST_BAND_CD        = PLB.PRC_LIST_BAND_CD
                                AND PLB.PRC_LIST_BAND_DESC_TXT   = #prcListBandDescTxt#
                                AND PLB.EZCANCELFLAG             = '0'
                                AND ROWNUM = 1
                    ) 
                    WHEN PLT.PRC_LIST_STRU_TP_CD = #prcListStruTpSupplyProgram#
                    THEN ( 
                        SELECT
                                  PLSP.TOT_BASE_AMT
                            FROM
                                PRC_LIST_SPLY_PGM   PLSP
                                , PRC_LIST_BAND     PLB
                            WHERE
                                PLSP.GLBL_CMPY_CD                = DPC.GLBL_CMPY_CD
                                AND PLSP.PRC_CATG_CD             = DPC.PRC_CATG_CD
                                --
                                AND PLSP.MDL_ID                  = #mdlId#
                                AND PLSP.PRC_MTR_PKG_PK          = #prcMtrPkgPk#
                                AND PLSP.PRC_SVC_PLN_TP_CD       = #prcSvcPlnTpCd#
                                AND PLSP.PRC_SVC_CONTR_TP_CD     = #prcSvcContrTpCd#
                                AND PLSP.BLLG_MTR_LB_CD          = #bllgMtrLbCd#
                                AND PLSP.EFF_FROM_DT            &lt;= #slsDt#
                                AND ( 
                                    PLSP.EFF_THRU_DT            IS NULL 
                                    OR PLSP.EFF_THRU_DT         &gt;= #slsDt#
                                ) 
                                AND PLSP.DEL_FLG                = 'N'
                                --
                                AND PLSP.TERM_FROM_MTH_AOT      &lt;= #termMth#
                                AND ( 
                                    PLSP.TERM_THRU_MTH_AOT      &gt;= #termMth#
                                    OR PLSP.TERM_THRU_MTH_AOT   IS NULL
                                )
                                AND PLSP.EZCANCELFLAG            = '0'
                                -- 
                                AND PLSP.GLBL_CMPY_CD            = PLB.GLBL_CMPY_CD
                                AND PLSP.PRC_LIST_BAND_CD        = PLB.PRC_LIST_BAND_CD
                                AND PLB.PRC_LIST_BAND_DESC_TXT   = #prcListBandDescTxt#
                                AND PLB.EZCANCELFLAG             = '0'
                                AND ROWNUM = 1
                    ) 
                    END BASE_AMT
            FROM
                PRC_CATG        DPC
                , PRC_LIST_TP   PLT
            WHERE
                DPC.GLBL_CMPY_CD         = #glblCmpyCd#
                AND DPC.PRC_CATG_CD      = #prcCatgCd#
                AND DPC.EFF_FROM_DT     &lt;= #slsDt#
                AND (
                    DPC.EFF_THRU_DT     IS NULL
                    OR DPC.EFF_THRU_DT  &gt;= #slsDt#
                )
                AND DPC.ACTV_FLG         = 'Y'
                AND DPC.EZCANCELFLAG     = '0'
                --
                AND DPC.GLBL_CMPY_CD     = PLT.GLBL_CMPY_CD
                AND DPC.PRC_LIST_TP_CD   = PLT.PRC_LIST_TP_CD
                AND PLT.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getPrcListStruTp" parameterClass="Map" resultClass="String">
        SELECT
                  PLT.PRC_LIST_STRU_TP_CD
            FROM
                PRC_CATG        DPC
                , PRC_LIST_TP   PLT
            WHERE
                DPC.GLBL_CMPY_CD        = #glblCmpyCd#
                AND DPC.PRC_CATG_CD     = #prcCatgCd#
                AND DPC.EZCANCELFLAG    = '0'
                --
                AND DPC.GLBL_CMPY_CD    = PLT.GLBL_CMPY_CD
                AND DPC.PRC_LIST_TP_CD  = PLT.PRC_LIST_TP_CD
                AND PLT.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getDefaultBandForService" parameterClass="Map" resultClass="Map">
        SELECT
                  PLS.MIN_COPY_VOL_CNT          AS MIN_COPY_VOL_CNT
                , PLS.MAX_COPY_VOL_CNT          AS MAX_COPY_VOL_CNT
                , PLS.PRC_LIST_BAND_CD          AS PRC_LIST_BAND_CD
                , PLB.PRC_LIST_BAND_DESC_TXT    AS PRC_LIST_BAND_DESC_TXT
                , PLS.BASE_AMT                  AS BASE_AMT
                , PLS.CPC_AMT_RATE              AS CPC_AMT_RATE
                , PLS.MDSE_CD                   AS MDSE_CD
            FROM
                PRC_LIST_SVC    PLS
                , PRC_LIST_BAND PLB
            WHERE
                PLS.GLBL_CMPY_CD             = #glblCmpyCd#
                AND PLS.PRC_CATG_CD          = #prcCatgCd#
                AND PLS.MDL_ID               = #mdlId#
                AND PLS.PRC_MTR_PKG_PK       = #prcMtrPkgPk#
                AND PLS.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTpCd#
                AND PLS.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTpCd#
                AND PLS.BLLG_MTR_LB_CD       = #bllgMtrLbCd#
                AND PLS.PRC_RATE_TP_CD      IN (#cpc#, #annual#)
                AND PLS.EFF_FROM_DT         &lt;= #slsDt#
                AND (
                    PLS.EFF_THRU_DT         IS NULL
                    OR PLS.EFF_THRU_DT      &gt;= #slsDt#
                ) 
                AND PLS.DEL_FLG              = 'N'
                AND PLS.TERM_FROM_MTH_AOT   &lt;= #termMth#
                AND ( 
                    PLS.TERM_THRU_MTH_AOT   &gt;= #termMth#
                    OR PLS.TERM_THRU_MTH_AOT IS NULL
                )
                AND PLS.EZCANCELFLAG         = '0'
                --
                AND PLS.GLBL_CMPY_CD         = PLB.GLBL_CMPY_CD
                AND PLS.PRC_LIST_BAND_CD     = PLB.PRC_LIST_BAND_CD
              <isNotNull property="prcListBandDescTxt">
                AND PLB.PRC_LIST_BAND_DESC_TXT  = #prcListBandDescTxt#
              </isNotNull>
                AND PLB.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getDefaultBandForServiceTiers" parameterClass="Map" resultClass="Map">
        SELECT
                --  PLST.MIN_COPY_VOL_CNT      AS MIN_COPY_VOL_CNT
                --, PLST.MAX_COPY_VOL_CNT      AS MAX_COPY_VOL_CNT
                PLST.PRC_LIST_BAND_CD      AS PRC_LIST_BAND_CD
                , PLB.PRC_LIST_BAND_DESC_TXT AS PRC_LIST_BAND_DESC_TXT
                --, PLST.BASE_AMT              AS BASE_AMT
                --, PLST.CPC_AMT_RATE          AS CPC_AMT_RATE
                , PLST.MDSE_CD               AS MDSE_CD
                --, PLST.PRC_SVC_TIER_TP_CD    AS PRC_SVC_TIER_TP_CD
            FROM
                PRC_LIST_SVC_TIER   PLST
                , PRC_LIST_BAND     PLB
            WHERE
                PLST.GLBL_CMPY_CD            = #glblCmpyCd#
                AND PLST.PRC_CATG_CD         = #prcCatgCd#
                AND PLST.MDL_ID              = #mdlId#
                AND PLST.PRC_MTR_PKG_PK      = #prcMtrPkgPk#
                AND PLST.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTpCd#
                AND PLST.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
                AND PLST.BLLG_MTR_LB_CD      = #bllgMtrLbCd#
                AND PLST.EFF_FROM_DT        &lt;= #slsDt#
                AND ( 
                    PLST.EFF_THRU_DT        IS NULL 
                    OR PLST.EFF_THRU_DT     &gt;= #slsDt#
                ) 
                AND PLST.DEL_FLG             = 'N' 
                AND PLST.TERM_FROM_MTH_AOT  &lt;= #termMth#
                AND ( 
                    PLST.TERM_THRU_MTH_AOT  &gt;= #termMth#
                    OR PLST.TERM_THRU_MTH_AOT IS NULL
                ) 
                AND PLST.EZCANCELFLAG        = '0'
                               --
                AND PLST.GLBL_CMPY_CD        = PLB.GLBL_CMPY_CD
                AND PLST.PRC_LIST_BAND_CD    = PLB.PRC_LIST_BAND_CD
              <isNotNull property="prcListBandDescTxt">
                AND PLB.PRC_LIST_BAND_DESC_TXT  = #prcListBandDescTxt#
              </isNotNull>
                AND PLB.EZCANCELFLAG         = '0'
            GROUP BY
                PLST.PRC_LIST_BAND_CD
                , PLB.PRC_LIST_BAND_DESC_TXT
                , PLST.MDSE_CD
    </statement>

    <statement id="getDefaultBandForSupplyProgram" parameterClass="Map" resultClass="Map">
        SELECT
                  PLSP.MIN_COPY_VOL_CNT      AS MIN_COPY_VOL_CNT
                , PLSP.MAX_COPY_VOL_CNT      AS MAX_COPY_VOL_CNT
                , PLSP.PRC_LIST_BAND_CD      AS PRC_LIST_BAND_CD
                , PLB.PRC_LIST_BAND_DESC_TXT AS PRC_LIST_BAND_DESC_TXT
                , PLSP.TOT_BASE_AMT          AS BASE_AMT
                , PLSP.CPC_AMT_RATE          AS CPC_AMT_RATE
                , PLSP.MDSE_CD               AS MDSE_CD
                , PLSP.PRC_CATG_CD
            FROM
                PRC_LIST_SPLY_PGM   PLSP
                , PRC_LIST_BAND     PLB
            WHERE
                PLSP.GLBL_CMPY_CD            = #glblCmpyCd#
                AND PLSP.PRC_CATG_CD         = #prcCatgCd#
                AND PLSP.MDL_ID              = #mdlId#
                AND PLSP.PRC_MTR_PKG_PK      = #prcMtrPkgPk#
                AND PLSP.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTpCd#
                AND PLSP.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
                AND PLSP.BLLG_MTR_LB_CD      = #bllgMtrLbCd#
                AND PLSP.EFF_FROM_DT        &lt;= #slsDt#
                AND (
                    PLSP.EFF_THRU_DT        IS NULL
                    OR PLSP.EFF_THRU_DT     &gt;= #slsDt#
                ) 
                AND PLSP.DEL_FLG             = 'N'
                AND PLSP.TERM_FROM_MTH_AOT  &lt;= #termMth#
                AND ( 
                    PLSP.TERM_THRU_MTH_AOT  &gt;= #termMth#
                    OR PLSP.TERM_THRU_MTH_AOT IS NULL
                ) 
                AND PLSP.EZCANCELFLAG        = '0'
                --
                AND (
                    PLSP.SPLY_AGMT_PLN_PK  IS NULL
                    OR EXISTS (
                        SELECT
                                  1
                            FROM
                                SPLY_AGMT_PLN   SAP
                            WHERE
                                SAP.GLBL_CMPY_CD            = PLSP.GLBL_CMPY_CD
                                AND SAP.SPLY_AGMT_PLN_PK    = PLSP.SPLY_AGMT_PLN_PK
                                AND SAP.ACTV_FLG            = 'Y'
                                AND SAP.EFF_FROM_DT        &lt;= #slsDt#
                                AND (
                                    SAP.EFF_THRU_DT        IS NULL
                                    OR SAP.EFF_THRU_DT     &gt;= #slsDt#
                                )
                                AND SAP.DEL_FLG             = 'N'
                                AND SAP.EZCANCELFLAG        = '0'
                    )
                )
                --
                AND PLSP.GLBL_CMPY_CD        = PLB.GLBL_CMPY_CD
                AND PLSP.PRC_LIST_BAND_CD    = PLB.PRC_LIST_BAND_CD
              <isNotNull property="prcListBandDescTxt">
                AND PLB.PRC_LIST_BAND_DESC_TXT  = #prcListBandDescTxt#
              </isNotNull>
                AND PLB.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getCountPrcListBandFromDescTxt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(PLB.GLBL_CMPY_CD)   CNT
            FROM
                PRC_LIST_BAND PLB 
            WHERE
                PLB.GLBL_CMPY_CD                = #glblCmpyCd#
                AND PLB.PRC_LIST_BAND_DESC_TXT  = #prcListBandDescTxt#
                AND PLB.EZCANCELFLAG            = '0'
    </statement>

    <statement id="getSplyAgmtPlnNm" parameterClass="Map" resultClass="Map">
        SELECT
                  SAP.SPLY_AGMT_PLN_PK || ':' || SAP.SPLY_AGMT_PLN_DESC_TXT     EDIT_SPLY_AGMT_PLN_NM
                  ,(
                    SELECT
                              'Y'
                        FROM
                            SPLY_AGMT_PLN   SAP
                        WHERE
                            SAP.GLBL_CMPY_CD            = PLSP.GLBL_CMPY_CD
                            AND SAP.SPLY_AGMT_PLN_PK    = PLSP.SPLY_AGMT_PLN_PK
                            AND SAP.EFF_FROM_DT        &lt;= #slsDt#
                            AND (
                                SAP.EFF_THRU_DT IS NULL
                                OR SAP.EFF_THRU_DT     &gt;= #slsDt#
                            ) 
                            AND SAP.ACTV_FLG             = 'Y'
                            AND SAP.DEL_FLG              = 'N'
                            AND SAP.EZCANCELFLAG         = '0'
                )   EXISTS_FLG
            FROM
                PRC_LIST_SPLY_PGM   PLSP
                , PRC_LIST_BAND     PLB
                , SPLY_AGMT_PLN     SAP
            WHERE
                PLSP.GLBL_CMPY_CD               = #glblCmpyCd#
                AND PLSP.MDL_ID                 = #mdlId#
                AND PLSP.PRC_MTR_PKG_PK         = #prcMtrPkgPk#
                AND PLSP.PRC_SVC_PLN_TP_CD      = #prcSvcPlnTpCd#
                AND PLSP.PRC_SVC_CONTR_TP_CD    = #prcSvcContrTpCd#
                AND PLSP.BLLG_MTR_LB_CD         = #bllgMtrLbCd#
                AND PLSP.PRC_CATG_CD            = #prcCatgCd#
                AND PLSP.EFF_FROM_DT           &lt;= #slsDt#
                AND ( 
                    PLSP.EFF_THRU_DT           IS NULL 
                    OR PLSP.EFF_THRU_DT        &gt;= #slsDt#
                ) 
                AND PLSP.TERM_FROM_MTH_AOT     &lt;= #termMth#
                AND ( 
                    PLSP.TERM_THRU_MTH_AOT     IS NULL 
                    OR PLSP.TERM_THRU_MTH_AOT  &gt;= #termMth#
                ) 
                AND PLSP.EZCANCELFLAG           = '0'
                --
                AND PLSP.GLBL_CMPY_CD           = PLB.GLBL_CMPY_CD
                AND PLSP.PRC_LIST_BAND_CD       = PLB.PRC_LIST_BAND_CD
                AND PLB.PRC_LIST_BAND_DESC_TXT    = #prcListBandDescTxt#
                AND PLB.EZCANCELFLAG            = '0'
                AND PLSP.GLBL_CMPY_CD           = SAP.GLBL_CMPY_CD
                AND PLSP.SPLY_AGMT_PLN_PK       = SAP.SPLY_AGMT_PLN_PK
                AND SAP.EZCANCELFLAG            = '0'
    </statement>

    <statement id="getImptCpoSvcDtl" parameterClass="Map" resultClass="Map">
        SELECT
             DIO.ORD_SRC_REF_NUM            REF_CPO_ORD_NUM
            ,DISD.DS_IMPT_SVC_LINE_NUM      CPO_SVC_LINE_NUM
            ,DISD.DS_IMPT_SVC_MDSE_CD       CPO_SVC_MDSE_CD
            ,M.MDSE_DESC_SHORT_TXT          MDSE_DESC_SHORT_TXT
            ,DISD.PRC_SVC_CONTR_TP_CD       PRC_SVC_CONTR_TP_CD
            ,DISD.PRC_SVC_PLN_TP_CD         PRC_SVC_PLN_TP_CD
            ,DISD.DS_CONTR_CATG_CD          DS_CONTR_CATG_CD
            ,DISD.BASE_BLLG_CYCLE_CD        BASE_BLLG_CYCLE_CD
            ,DISD.USG_BLLG_CYCLE_CD         USG_BLLG_CYCLE_CD
            ,DISD.FROM_PER_MTH_NUM          FROM_PER_MTH_NUM
            ,DISD.TO_PER_MTH_NUM            TO_PER_MTH_NUM
            ,NVL(DISD.TERM_MTH_AOT
                , DISD.TO_PER_MTH_NUM - DISD.FROM_PER_MTH_NUM + 1
             )                              TERM_MTH_NUM
            ,DISD.FIX_TERM_IN_MTH_AOT       FIX_TERM_IN_MTH_AOT
            ,DISD.MAX_UPLFT_PCT             MAX_UPLFT_PCT
            ,DISD.CPO_SVC_LINE_ACT_CD       CPO_SVC_LINE_ACT_CD
            ,DISD.BILL_WITH_EQUIP_FLG       BILL_WITH_EQUIP_FLG
            ,DISD.BILL_BY_TP_CD             BILL_BY_TP_CD
            ,DISD.SOLD_TO_CUST_LOC_CD       SOLD_TO_CUST_LOC_CD
            ,DISD.SELL_TO_CUST_CD           SELL_TO_CUST_CD
            ,DISD.MAN_CONTR_OVRD_FLG        MAN_CONTR_OVRD_FLG
            ,DISD.MAN_CONTR_OVRD_RSN_CD     MAN_CONTR_OVRD_RSN_CD
            ,DISD.MAN_CONTR_OVRD_CMNT_TXT   MAN_CONTR_OVRD_CMNT_TXT
            ,DISD.DS_CONTR_PK               DS_CONTR_PK
            ,DISD.DS_IMPT_SVC_DTL_PK        CPO_SVC_DTL_PK
            ,DISD.TOT_BASE_PRC_DEAL_AMT     TOT_BASE_PRC_DEAL_AMT
            ,DISD.TOT_BASE_PRC_FUNC_AMT     TOT_BASE_PRC_FUNC_AMT
            ,DAC.DS_ACCT_NM                 DS_ACCT_NM
            ,( 
                RPAD( 
                     BTC.FIRST_LINE_ADDR
                    ,LENGTH(BTC.FIRST_LINE_ADDR) + 1
                ) || RPAD( 
                     BTC.SCD_LINE_ADDR
                    ,LENGTH(BTC.SCD_LINE_ADDR) + 1
                ) || RPAD( 
                     BTC.THIRD_LINE_ADDR
                    ,LENGTH(BTC.THIRD_LINE_ADDR) + 1
                ) || RPAD( 
                     BTC.FRTH_LINE_ADDR
                    ,LENGTH(BTC.FRTH_LINE_ADDR) + 1
                ) || CONCAT(BTC.CTY_ADDR, ',') 
                || RPAD(BTC.ST_CD, LENGTH(BTC.ST_CD) + 1) 
                || RPAD(BTC.POST_CD, LENGTH(BTC.POST_CD) + 1)
            ) AS                            BILL_TO_SRCH_TXT
            ,DIO.DS_ORD_TP_CD               DS_ORD_TP_CD
            ,DIO.DS_ORD_CATG_CD             DS_ORD_CATG_CD
        FROM
             DS_IMPT_SVC_DTL   DISD
            ,ALL_MDSE_V        M
            ,SELL_TO_CUST      DAC
            ,BILL_TO_CUST      BTC
            ,DS_IMPT_ORD       DIO
        WHERE
                DISD.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DISD.DS_IMPT_SVC_DTL_PK     = #dsImptSvcDtlPk#
            AND DISD.EZCANCELFLAG           = '0'
            --
            AND DISD.GLBL_CMPY_CD           = M.GLBL_CMPY_CD(+)
            AND DISD.DS_IMPT_SVC_MDSE_CD    = M.MDSE_CD(+)
            AND M.EZCANCELFLAG(+)           = '0'
            --
            AND DISD.GLBL_CMPY_CD           = DAC.GLBL_CMPY_CD(+)
            AND DISD.SELL_TO_CUST_CD        = DAC.SELL_TO_CUST_CD(+)
            AND DAC.EZCANCELFLAG(+)         = '0'
            --
            AND DISD.GLBL_CMPY_CD           = BTC.GLBL_CMPY_CD(+)
            AND DISD.SOLD_TO_CUST_LOC_CD    = BTC.BILL_TO_CUST_CD(+)
            AND BTC.EZCANCELFLAG(+)         = '0'
            --
            AND DISD.GLBL_CMPY_CD           = DIO.GLBL_CMPY_CD
            AND DISD.DS_IMPT_ORD_PK         = DIO.DS_IMPT_ORD_PK
            AND DIO.EZCANCELFLAG            = '0'
    </statement>

    <statement id="getImptSvcUsgPrc" parameterClass="Map" resultClass="Map">
        SELECT
             DISD.DS_IMPT_SVC_LINE_NUM      CPO_SVC_LINE_NUM
            ,DISP.MDL_ID                    MDL_ID
            ,DISP.MAINT_PRC_CATG_CD         MAINT_PRC_CATG_CD
<!--            ,DISUP.PRC_LIST_BAND_CD-->
            ,PLB.PRC_LIST_BAND_DESC_TXT     PRC_LIST_BAND_DESC_TXT
            ,DISUP.PRC_BOOK_MDSE_CD         PRC_BOOK_MDSE_CD
            ,DISUP.BLLG_MTR_LB_CD           BLLG_MTR_LB_CD
            ,DISUP.USG_MDSE_CD              USG_MDSE_CD
            ,DISUP.REG_MTR_LB_CD            REG_MTR_LB_CD
            ,DISUP.MLY_COPY_INCL_PRC_QTY    COPY_INCL_PRC_QTY
            ,DISUP.XS_MTR_AMT_RATE          XS_MTR_AMT_RATE
            ,DISUP.CONTR_MTR_MULT_RATE      CONTR_MTR_MULT_RATE
            ,DISUP.PRC_SVC_TIER_TP_CD       PRC_SVC_TIER_TP_CD
            ,TT.PRC_SVC_TIER_TP_DESC_TXT    PRC_SVC_TIER_TP_DESC_TXT
            ,DISUP.MIN_COPY_VOL_CNT         MIN_COPY_VOL_CNT
            ,DISUP.MAX_COPY_VOL_CNT         MAX_COPY_VOL_CNT
            ,DISUP.DS_IMPT_SVC_USG_PRC_PK   CPO_SVC_USG_PRC_PK
            ,DISD.DS_IMPT_SVC_DTL_PK        CPO_SVC_DTL_PK
            ,DISP.DS_IMPT_SVC_PRC_PK        CPO_SVC_PRC_PK
            ,DISUP.REG_MTR_LB_CD            REG_MTR_LB_CD
            ,DISP.DS_IMPT_SVC_CONFIG_REF_PK CPO_SVC_CONFIG_REF_PK
            ,DIOD.DS_ORD_POSN_NUM           DS_ORD_POSN_NUM
            ,DISUP.BILL_TO_LOC_NUM          BILL_TO_LOC_NUM
            ,DISUP.BILL_TO_CUST_CD          BILL_TO_CUST_CD
            , ( 
                RPAD( 
                    BTC.FIRST_LINE_ADDR
                    , LENGTH(BTC.FIRST_LINE_ADDR) + 1
                ) || RPAD( 
                   BTC.SCD_LINE_ADDR
                    , LENGTH(BTC.SCD_LINE_ADDR) + 1
                ) || RPAD( 
                    BTC.THIRD_LINE_ADDR
                    , LENGTH(BTC.THIRD_LINE_ADDR) + 1
                ) || RPAD( 
                    BTC.FRTH_LINE_ADDR
                    , LENGTH(BTC.FRTH_LINE_ADDR) + 1
                ) || CONCAT(BTC.CTY_ADDR, ',') || RPAD(BTC.ST_CD, LENGTH(BTC.ST_CD) + 1) || RPAD(BTC.POST_CD, LENGTH(BTC.POST_CD) + 1)
            )                               BILL_TO_SRCH_TXT
            , DAC.DS_ACCT_NM                DS_ACCT_NM
            , 'Y'                           ACTV_FLG
            , DISUP.BLLG_FREE_COPY_CNT      BLLG_FREE_COPY_CNT
            , DISUP.BLLG_MIN_CNT            BLLG_MIN_CNT
            , DISUP.BLLG_MIN_AMT_RATE       BLLG_MIN_AMT_RATE
            , DISUP.BLLG_ROLL_OVER_RATIO    BLLG_ROLL_OVER_RATIO
        FROM
             DS_IMPT_SVC_DTL            DISD
            ,DS_IMPT_SVC_PRC            DISP
            ,DS_IMPT_SVC_USG_PRC        DISUP
            ,MTR_LB                     ML
            ,PRC_SVC_TIER_TP            TT
            ,PRC_LIST_BAND              PLB
            ,BILL_TO_CUST               BTC
            ,SELL_TO_CUST               DAC
            ,DS_IMPT_SVC_CONFIG_REF     DISC
            ,DS_IMPT_ORD_DTL            DIOD
        WHERE
                DISD.GLBL_CMPY_CD        = #glblCmpyCd#
            AND DISD.DS_IMPT_SVC_DTL_PK  = #dsImptSvcDtlPk#
            AND DISD.EZCANCELFLAG        = '0'
            --
            AND DISD.GLBL_CMPY_CD        = DISP.GLBL_CMPY_CD
            AND DISD.DS_IMPT_SVC_DTL_PK  = DISP.DS_IMPT_SVC_DTL_PK
            AND DISP.EZCANCELFLAG        = '0'
            --
            AND DISP.GLBL_CMPY_CD        = DISUP.GLBL_CMPY_CD
            AND DISP.DS_IMPT_SVC_PRC_PK  = DISUP.DS_IMPT_SVC_PRC_PK
            AND DISUP.EZCANCELFLAG       = '0'
            --
            AND DISUP.GLBL_CMPY_CD       = ML.GLBL_CMPY_CD(+)
            AND DISUP.REG_MTR_LB_CD      = ML.MTR_LB_CD(+)
            AND ML.EZCANCELFLAG(+)       = '0'
            --
            AND DISUP.GLBL_CMPY_CD       = TT.GLBL_CMPY_CD(+)
            AND DISUP.PRC_SVC_TIER_TP_CD = TT.PRC_SVC_TIER_TP_CD(+)
            AND ML.EZCANCELFLAG(+)       = '0'
            --
            AND DISUP.GLBL_CMPY_CD       = PLB.GLBL_CMPY_CD(+)
            AND DISUP.PRC_LIST_BAND_CD   = PLB.PRC_LIST_BAND_CD(+)
            AND PLB.EZCANCELFLAG(+)      = '0'
                --  
                AND DISUP.GLBL_CMPY_CD        = BTC.GLBL_CMPY_CD(+)
                AND DISUP.BILL_TO_LOC_NUM     = BTC.BILL_TO_CUST_CD(+)
                AND BTC.EZCANCELFLAG(+)     = '0'
                --  
                AND DISUP.GLBL_CMPY_CD        = DAC.GLBL_CMPY_CD(+)
                AND DISUP.BILL_TO_CUST_CD     = DAC.SELL_TO_CUST_CD(+)
                AND DAC.EZCANCELFLAG(+)     = '0'
                --
                AND DISP.GLBL_CMPY_CD               = DISC.GLBL_CMPY_CD(+)
                AND DISP.DS_IMPT_SVC_CONFIG_REF_PK  = DISC.DS_IMPT_SVC_CONFIG_REF_PK(+)
                AND DISC.EZCANCELFLAG(+)            = '0'
                --
                AND DISC.GLBL_CMPY_CD               = DIOD.GLBL_CMPY_CD(+)
                AND DISC.DS_IMPT_ORD_DTL_PK         = DIOD.DS_IMPT_ORD_DTL_PK(+)
                AND DIOD.EZCANCELFLAG(+)            = '0'
        ORDER BY
             DISD.DS_IMPT_SVC_LINE_NUM
            ,DISP.MDL_ID
            ,DISP.DS_IMPT_SVC_CONFIG_REF_PK
            ,DISUP.BLLG_MTR_LB_CD
            ,DISUP.USG_MDSE_CD NULLS LAST
            ,DISUP.MIN_COPY_VOL_CNT NULLS LAST
            ,DISUP.REG_MTR_LB_CD NULLS FIRST
            ,ML.MTR_LB_SORT_NUM NULLS FIRST
            ,TT.PRC_SVC_TIER_TP_SORT_NUM
    </statement>

    <statement id="getImptInitDataFromDsImpt" parameterClass="Map" resultClass="Map">
        SELECT
                  0                                 CPO_SVC_PK
                , CS.ORD_SRC_REF_NUM                REF_CPO_ORD_NUM
                , CSCR.DS_IMPT_SVC_CONFIG_REF_PK    CPO_SVC_CONFIG_REF_PK
                , CSCR.CUST_ISS_PO_NUM
                , CSCR.CUST_ISS_PO_DT
                , CSCR.MTR_READ_METH_CD
                , 'N'                               CONTR_CRAT_FLG
                , DCD.DS_ORD_POSN_NUM
                , DCD.DS_IMPT_ORD_CONFIG_PK
                , DCD.MDSE_CD
                , DCD.ORD_SRC_REF_LINE_NUM          CPO_DTL_LINE_NUM
                , DCD.ORD_SRC_REF_LINE_SUB_NUM      CPO_DTL_LINE_SUB_NUM
                --
                , DCC.MDL_ID
                , MN.T_MDL_NM
                , DCC.CONFIG_TP_CD <!-- 2018/12/07 S21_NA#29484 Add -->
            FROM
                DS_IMPT_ORD                 CS
                , DS_IMPT_SVC_DTL           CSD
                , DS_IMPT_SVC_CONFIG_REF    CSCR
                , DS_IMPT_ORD_DTL           DCD
                , DS_IMPT_ORD_CONFIG        DCC
                , MDL_NM                    MN
            WHERE
                CS.GLBL_CMPY_CD                 = #glblCmpyCd#
                AND CS.ORD_SRC_REF_NUM          = #ordSrcRefNum#
                AND CS.EZCANCELFLAG             = '0'
                                 --
                AND CS.GLBL_CMPY_CD             = CSD.GLBL_CMPY_CD
                AND CS.DS_IMPT_ORD_PK           = CSD.DS_IMPT_ORD_PK
                AND CSD.DS_IMPT_SVC_LINE_NUM    = #dsImptSvcLineNum#
                AND CSD.EZCANCELFLAG            = '0'
                                --
                AND CSD.GLBL_CMPY_CD            = CSCR.GLBL_CMPY_CD(+) 
                AND CSD.DS_IMPT_SVC_DTL_PK      = CSCR.DS_IMPT_SVC_DTL_PK(+) 
                AND CSCR.EZCANCELFLAG(+)        = '0'
                            --
                AND CSCR.GLBL_CMPY_CD           = DCD.GLBL_CMPY_CD(+) 
                AND CSCR.DS_IMPT_ORD_DTL_PK     = DCD.DS_IMPT_ORD_DTL_PK(+) 
                AND DCD.EZCANCELFLAG(+)         = '0'
                --
                AND DCD.GLBL_CMPY_CD            = DCC.GLBL_CMPY_CD(+) 
                AND DCD.DS_IMPT_ORD_CONFIG_PK   = DCC.DS_IMPT_ORD_CONFIG_PK(+) 
                AND DCC.EZCANCELFLAG(+)         = '0'
                --
                AND DCC.GLBL_CMPY_CD            = MN.T_GLBL_CMPY_CD(+) 
                AND DCC.MDL_ID                  = MN.T_MDL_ID(+) 
                AND MN.EZCANCELFLAG(+)          = '0' 
            ORDER BY
                CS.ORD_SRC_REF_NUM
                , CSD.DS_IMPT_SVC_LINE_NUM
                , DCC.MDL_ID
                , TO_NUMBER(DCD.DS_ORD_POSN_NUM)
                , DCD.ORD_SRC_REF_LINE_NUM
                , DCD.ORD_SRC_REF_LINE_SUB_NUM
    </statement>

    <statement id="getImptSvcPrcHdrByConfig" parameterClass="Map" resultClass="Map">
        SELECT
                  WK_V.CPO_SVC_LINE_NUM
                , WK_V.CPO_SVC_PRC_PK
                , WK_V.TERM_MTH_NUM
                , WK_V.PRC_CATG_NM
                , WK_V.PRC_LIST_TP_CD
                , WK_V.MAINT_PRC_CATG_CD
                , WK_V.MAINT_FL_PRC_CATG_CD
                , WK_V.PRC_MTR_PKG_PK
                , WK_V.PRC_TIER_SVC_OFFER_CD
                , WK_V.BASE_PRC_DEAL_AMT
                , WK_V.BASE_PRC_FUNC_AMT
                , WK_V.DEAL_PRC_LIST_PRC_AMT
                , WK_V.FUNC_PRC_LIST_PRC_AMT
                              --
                , WK_V.MDL_ID
                , WK_V.T_MDL_NM
                , WK_V.CPO_SVC_CONFIG_REF_PK
                , WK_V.DS_ORD_POSN_NUM
                --
                , WK_V.CONTR_CRAT_FLG
                , 'N'                            SCR_ENT_AVAL_FLG
                            --
                , WK_V.BILL_TO_LOC_NUM
                , WK_V.BILL_TO_CUST_CD
                , WK_V.BILL_TO_SRCH_TXT
                , WK_V.DS_ACCT_NM
            FROM
                ( 
                    SELECT
                              CSD.DS_IMPT_SVC_LINE_NUM      CPO_SVC_LINE_NUM
                            , CSP.DS_IMPT_SVC_PRC_PK        CPO_SVC_PRC_PK
                            , 'N'                           CONTR_CRAT_FLG
                            ,NVL(CSD.TERM_MTH_AOT
                                , CSD.TO_PER_MTH_NUM - CSD.FROM_PER_MTH_NUM + 1
                             )                              TERM_MTH_NUM
                            , PC.PRC_CATG_NM
                            , PC.PRC_LIST_TP_CD
                            , CSP.MAINT_PRC_CATG_CD
                            , CSP.MAINT_FL_PRC_CATG_CD
                            , CSP.PRC_MTR_PKG_PK
                            , CSP.PRC_TIER_SVC_OFFER_CD
                            , CSP.BASE_PRC_DEAL_AMT
                            , CSP.BASE_PRC_FUNC_AMT
                            , CSP.DEAL_PRC_LIST_PRC_AMT
                            , CSP.FUNC_PRC_LIST_PRC_AMT
                               --
                            , DCC.MDL_ID
                            , MN.T_MDL_NM
                            , '00'                              ORD_LINE_STS_CD
                            , CCR.DS_IMPT_SVC_CONFIG_REF_PK     CPO_SVC_CONFIG_REF_PK
                            , DCC.DS_ORD_POSN_NUM
                            --
                            , CSP.BILL_TO_LOC_NUM
                            , CSP.BILL_TO_CUST_CD
                            , (
                                RPAD( 
                                    BTC.FIRST_LINE_ADDR
                                    , LENGTH(BTC.FIRST_LINE_ADDR) + 1
                                ) || RPAD( 
                                    BTC.SCD_LINE_ADDR
                                    , LENGTH(BTC.SCD_LINE_ADDR) + 1
                                ) || RPAD( 
                                    BTC.THIRD_LINE_ADDR
                                    , LENGTH(BTC.THIRD_LINE_ADDR) + 1
                                ) || RPAD( 
                                    BTC.FRTH_LINE_ADDR
                                    , LENGTH(BTC.FRTH_LINE_ADDR) + 1
                                ) || CONCAT(BTC.CTY_ADDR, ',') || RPAD(BTC.ST_CD, LENGTH(BTC.ST_CD) + 1) || RPAD(BTC.POST_CD, LENGTH(BTC.POST_CD) + 1)
                            )                                   BILL_TO_SRCH_TXT
                            , DAC.DS_ACCT_NM
                        FROM
                            DS_IMPT_SVC_CONFIG_REF  CCR
                            , DS_IMPT_SVC_DTL       CSD
                            , DS_IMPT_SVC_PRC       CSP
                            , DS_IMPT_ORD_DTL       DCD
                            , DS_IMPT_ORD_CONFIG    DCC
                            , PRC_CATG          PC
                            , MDL_NM            MN
                            , BILL_TO_CUST      BTC
                            , SELL_TO_CUST      DAC
                        WHERE
                            CCR.GLBL_CMPY_CD                = #glblCmpyCd#
                            AND CCR.DS_IMPT_SVC_DTL_PK      = #cpoSvcDtlPk#
                            AND CCR.EZCANCELFLAG            = '0'
                                --
                            AND CCR.GLBL_CMPY_CD            = CSD.GLBL_CMPY_CD(+)
                            AND CCR.DS_IMPT_SVC_DTL_PK      = CSD.DS_IMPT_SVC_DTL_PK(+)
                            AND CSD.EZCANCELFLAG(+)         = '0'
                             --
                            AND CCR.GLBL_CMPY_CD            = CSP.GLBL_CMPY_CD(+)
                            AND CCR.DS_IMPT_SVC_DTL_PK      = CSP.DS_IMPT_SVC_DTL_PK(+)
                            AND CCR.DS_IMPT_SVC_PRC_PK      = CSP.DS_IMPT_SVC_PRC_PK(+)
                            AND CSP.EZCANCELFLAG(+)         = '0'
                             --
                            AND CCR.GLBL_CMPY_CD            = DCD.GLBL_CMPY_CD
                            AND CCR.DS_IMPT_ORD_DTL_PK      = DCD.DS_IMPT_ORD_DTL_PK
                            AND DCD.EZCANCELFLAG            = '0'
                                --
                            AND DCD.GLBL_CMPY_CD            = DCC.GLBL_CMPY_CD
                            AND DCD.DS_IMPT_ORD_CONFIG_PK   = DCC.DS_IMPT_ORD_CONFIG_PK
                            AND DCC.CONFIG_CATG_CD          = #configCatgOutBound#
                            AND DCC.CONFIG_TP_CD           != #configTpCd# <!-- 2018/12/07 S21_NA#29484 Add -->
                            AND DCC.EZCANCELFLAG            = '0'
                                --
                            AND CSP.GLBL_CMPY_CD            = PC.GLBL_CMPY_CD(+)
                            AND CSP.MAINT_PRC_CATG_CD       = PC.PRC_CATG_CD(+)
                            AND PC.EZCANCELFLAG(+)          = '0'
                              --
                            AND DCC.GLBL_CMPY_CD            = MN.T_GLBL_CMPY_CD(+)
                            AND DCC.MDL_ID                  = MN.T_MDL_ID(+)
                            AND MN.EZCANCELFLAG(+)          = '0'
                            --
                            AND CSP.GLBL_CMPY_CD            = BTC.GLBL_CMPY_CD(+)
                            AND CSP.BILL_TO_LOC_NUM         = BTC.BILL_TO_CUST_CD(+)
                            AND BTC.EZCANCELFLAG(+)         = '0'
                            --
                            AND CSP.GLBL_CMPY_CD            = DAC.GLBL_CMPY_CD(+)
                            AND CSP.BILL_TO_CUST_CD         = DAC.SELL_TO_CUST_CD(+)
                            AND DAC.EZCANCELFLAG(+)         = '0'
                        ORDER BY
                            CSD.DS_IMPT_SVC_LINE_NUM
                            , DCC.MDL_ID
                            , TO_NUMBER(DCC.DS_ORD_POSN_NUM)
                            , CCR.DS_IMPT_SVC_CONFIG_REF_PK
                ) WK_V
    </statement>

    <statement id="getImptSvcAddlBasePrc" parameterClass="Map" resultClass="Map">
        SELECT
                  CSD.DS_IMPT_SVC_LINE_NUM          CPO_SVC_LINE_NUM
                , DCD.ORD_SRC_REF_LINE_NUM          CPO_DTL_LINE_NUM
                , DCD.ORD_SRC_REF_LINE_SUB_NUM      CPO_DTL_LINE_SUB_NUM
                , SAP.ADDL_BASE_PRC_CATG_CD
                , SAP.ADDL_BASE_PRC_DEAL_AMT
                , SAP.ADDL_BASE_PRC_FUNC_AMT
                , SAP.DEAL_PRC_LIST_PRC_AMT
                , SAP.FUNC_PRC_LIST_PRC_AMT
                , SAP.DS_IMPT_SVC_ADDL_BASE_PK      CPO_SVC_ADDL_BASE_PRC_PK
                , SAP.DS_IMPT_SVC_DTL_PK            CPO_SVC_DTL_PK
                --, SAP.CPO_ORD_NUM
                , SAP.PRC_LIST_EQUIP_CONFIG_NUM
--                 , SAP.ADDL_EQUIP_PRC_DEAL_AMT
--                 , SAP.ADDL_EQUIP_PRC_FUNC_AMT
--                 , SAP.ADDL_SVC_PRC_DEAL_AMT
--                 , SAP.ADDL_SVC_PRC_FUNC_AMT
                , NVL(SAP.SVC_PRC_CATG_CD, #svcPrcCatgAubc#)    SVC_PRC_CATG_CD
                --, SAP.BILL_WITH_EQUIP_INVD_FLG
                --, SAP.CR_REBIL_CD
                --
                , DCD.ORD_SRC_REF_LINE_NUM || '.' || DCD.ORD_SRC_REF_LINE_SUB_NUM   DPLY_LINE_NUM
                , DCD.MDSE_NM
                --
                , 'N' SCR_ENT_AVAL_FLG
            FROM
                DS_IMPT_SVC_DTL             CSD
                , DS_IMPT_SVC_ADDL_BASE SAP
                , DS_IMPT_ORD_DTL          DCD
            WHERE
                CSD.GLBL_CMPY_CD                = #glblCmpyCd#
                AND CSD.DS_IMPT_SVC_DTL_PK      = #cpoSvcDtlPk#
                AND CSD.EZCANCELFLAG            = '0'
                --
                AND CSD.GLBL_CMPY_CD            = SAP.GLBL_CMPY_CD
                AND CSD.DS_IMPT_SVC_DTL_PK      = SAP.DS_IMPT_SVC_DTL_PK
                AND SAP.EZCANCELFLAG            = '0'
                --
                AND SAP.GLBL_CMPY_CD            = DCD.GLBL_CMPY_CD
                AND SAP.DS_IMPT_ORD_PK          = DCD.DS_IMPT_ORD_PK
                AND SAP.DS_IMPT_ORD_DTL_PK      = DCD.DS_IMPT_ORD_DTL_PK
                AND DCD.EZCANCELFLAG            = '0'
            ORDER BY
                CSD.DS_IMPT_SVC_LINE_NUM
                , SAP.DS_IMPT_SVC_ADDL_BASE_PK
    </statement>

    <statement id="getImptAcsry" parameterClass="Map" resultClass="Map">
        SELECT
                  DP.PRC_LIST_DPLY_NM
                , CSA.ADDL_BASE_PRC_CATG_CD
                , CSA.ADDL_BASE_PRC_DEAL_AMT
                , DCDV.MDSE_CD
                , DCDV.MDSE_NM
                , DCDV.DS_ORD_POSN_NUM || '.' || DCDV.ORD_SRC_REF_LINE_NUM      DPLY_LINE_NUM
                , DCDV.PRC_LIST_EQUIP_CONFIG_NUM
                , ( 
                    SELECT
                              PLE.PRC_LIST_EQUIP_CONFIG_NM 
                        FROM
                            PRC_LIST_EQUIP PLE 
                        WHERE
                            DCDV.PRC_LIST_EQUIP_CONFIG_NUM              = PLE.PRC_LIST_EQUIP_CONFIG_NUM
                            AND DCDV.PRC_CATG_CD                        = PLE.PRC_CATG_CD
                            AND PLE.PRC_QLFY_TP_CD                      = #prcQlfyTpItemCode#   -- '01'
                            AND SUBSTR(DCDV.MDSE_CD, 1, 8)              = PLE.PRC_QLFY_VAL_TXT
                            AND DCDV.CUST_UOM_CD                        = PLE.PKG_UOM_CD
                            AND PLE.EZCANCELFLAG                        = '0'
                            AND PLE.DEL_FLG                             = 'N'
                            AND PLE.EFF_FROM_DT                     &lt;= DIO.ORD_SRC_IMPT_TS
                            AND NVL(PLE.EFF_THRU_DT, '99991231')    &gt;= DIO.ORD_SRC_IMPT_TS
                ) PRC_LIST_EQUIP_CONFIG_NM
                , M.MDSE_DESC_SHORT_TXT
            FROM
                DS_IMPT_ORD_DTL             DCDV
                , DS_IMPT_ORD               DIO
                , DS_IMPT_SVC_ADDL_BASE     CSA
                , PRC_CATG                  DP
                , ALL_MDSE_V                M 
            WHERE
                CSA.GLBL_CMPY_CD                    = #glblCmpyCd#
                AND CSA.DS_IMPT_SVC_ADDL_BASE_PK    = #dsImptSvcAddlBasePk#
                --
                AND DCDV.GLBL_CMPY_CD               = CSA.GLBL_CMPY_CD(+)
                AND DCDV.DS_IMPT_ORD_DTL_PK         = CSA.DS_IMPT_ORD_DTL_PK(+)
                --
                AND CSA.GLBL_CMPY_CD                = DP.GLBL_CMPY_CD(+)
                AND CSA.ADDL_BASE_PRC_CATG_CD       = DP.PRC_CATG_CD(+)
                --
                AND DCDV.GLBL_CMPY_CD               = M.GLBL_CMPY_CD(+)
                AND DCDV.MDSE_CD                    = M.MDSE_CD(+)
                --
                AND CSA.EZCANCELFLAG                = '0'
                AND DCDV.EZCANCELFLAG(+)            = '0'
                AND DP.EZCANCELFLAG(+)              = '0'
                AND M.EZCANCELFLAG(+)               = '0'
                --
                AND DCDV.GLBL_CMPY_CD               = DIO.GLBL_CMPY_CD
                AND DCDV.DS_IMPT_ORD_PK             = DIO.DS_IMPT_ORD_PK
                AND DIO.EZCANCELFLAG                = '0'
    </statement>

    <statement id="getImptSvcAddlChrgPrc" parameterClass="Map" resultClass="Map">
        SELECT
                  CSD.DS_IMPT_SVC_LINE_NUM
                , SAP.ADDL_CHRG_PRC_CATG_CD
                , PC.PRC_CATG_NM
                , DCD.MDSE_CD
                , SAP.ADDL_CHRG_MDSE_CD
                , SAP.ADDL_CHRG_PRC_DEAL_AMT
                , SAP.ADDL_CHRG_PRC_FUNC_AMT
                , SAP.DEAL_PRC_LIST_PRC_AMT
                , SAP.FUNC_PRC_LIST_PRC_AMT
                , SAP.DS_IMPT_SVC_ADDL_CHRG_PK  CPO_SVC_ADDL_CHRG_PRC_PK
                , SAP.DS_IMPT_SVC_DTL_PK        CPO_SVC_DTL_PK
                , DCD.ORD_SRC_REF_LINE_NUM      CPO_DTL_LINE_NUM
                , SAP.ADDL_CHRG_PRC_CATG_CD
                , SAP.ADDL_CHRG_MDSE_CD
                , SAP.ADDL_CHRG_PRC_DEAL_AMT
                , SAP.ADDL_CHRG_PRC_FUNC_AMT
                , SAP.DEAL_PRC_LIST_PRC_AMT
                , SAP.FUNC_PRC_LIST_PRC_AMT
                , SAP.SVC_PRC_CATG_CD
                --
                , DCD.DS_ORD_POSN_NUM || '.' || DCD.ORD_SRC_REF_LINE_NUM      DPLY_LINE_NUM
                , DCD.MDSE_NM
                , M.MDSE_DESC_SHORT_TXT         ADDL_CHRG_MDSE_NM
                --
                , 'N' SCR_ENT_AVAL_FLG
            FROM
                DS_IMPT_SVC_DTL             CSD
                , DS_IMPT_SVC_ADDL_CHRG     SAP
                , DS_IMPT_ORD_DTL           DCD
                , ALL_MDSE_V                M
                , PRC_CATG                  PC
            WHERE
                CSD.GLBL_CMPY_CD                = #glblCmpyCd#
                AND CSD.DS_IMPT_SVC_DTL_PK      = #cpoSvcDtlPk#
                AND CSD.EZCANCELFLAG            = '0'
                --
                AND CSD.GLBL_CMPY_CD            = SAP.GLBL_CMPY_CD
                AND CSD.DS_IMPT_SVC_DTL_PK      = SAP.DS_IMPT_SVC_DTL_PK
                AND SAP.EZCANCELFLAG            = '0'
                --
                AND SAP.GLBL_CMPY_CD            = DCD.GLBL_CMPY_CD
                AND SAP.DS_IMPT_ORD_DTL_PK      = DCD.DS_IMPT_ORD_DTL_PK
                AND DCD.EZCANCELFLAG            = '0'
                --
                AND SAP.GLBL_CMPY_CD            = M.GLBL_CMPY_CD(+)
                AND SAP.ADDL_CHRG_MDSE_CD       = M.MDSE_CD(+)
                AND M.EZCANCELFLAG(+)           = '0'
                --
                AND SAP.GLBL_CMPY_CD            = PC.GLBL_CMPY_CD(+)
                AND SAP.ADDL_CHRG_PRC_CATG_CD   = PC.PRC_CATG_CD(+)
                AND PC.EZCANCELFLAG(+)          = '0'
            ORDER BY
                CSD.DS_IMPT_SVC_LINE_NUM
                , SAP.DS_IMPT_SVC_ADDL_CHRG_PK
    </statement>

    <statement id="getImptAddChrg" parameterClass="Map" resultClass="Map">
        SELECT
                  DP.PRC_LIST_DPLY_NM
                , CSA.ADDL_CHRG_PRC_CATG_CD
                , CD.MDSE_CD
                , CD.DS_ORD_POSN_NUM || '.' || CD.ORD_SRC_REF_LINE_NUM      DPLY_LINE_NUM
                , M.MDSE_DESC_SHORT_TXT                                     UNIT_MDSE
                , CSA.ADDL_CHRG_PRC_DEAL_AMT
                , CSA.PRINT_DTL_FLG
            FROM
                DS_IMPT_ORD_DTL             CD
                , DS_IMPT_SVC_ADDL_CHRG     CSA
                , PRC_CATG                  DP
                , ALL_MDSE_V                M
            WHERE
                CSA.GLBL_CMPY_CD                    = #glblCmpyCd#
                AND CSA.DS_IMPT_SVC_ADDL_CHRG_PK    = #dsImptSvcAddlChrgPk#
                --
                AND CSA.GLBL_CMPY_CD                = CD.GLBL_CMPY_CD(+)
                AND CSA.DS_IMPT_ORD_DTL_PK          = CD.DS_IMPT_ORD_DTL_PK(+)
                --
                AND CSA.GLBL_CMPY_CD                = DP.GLBL_CMPY_CD(+)
                AND CSA.ADDL_CHRG_PRC_CATG_CD       = DP.PRC_CATG_CD(+)
                --
                AND CD.GLBL_CMPY_CD                 = M.GLBL_CMPY_CD(+)
                AND CD.MDSE_CD                      = M.MDSE_CD(+)
                --
                AND CSA.EZCANCELFLAG                = '0'
                AND CD.EZCANCELFLAG(+)              = '0'
                AND DP.EZCANCELFLAG(+)              = '0'
                AND M.EZCANCELFLAG(+)               = '0'
    </statement>

    <statement id="getImptSvcPrcHdrForFleet" parameterClass="Map" resultClass="Map">
        SELECT
                  WK_V.CPO_SVC_LINE_NUM
                , WK_V.CPO_SVC_PRC_PK
                , WK_V.TERM_MTH_NUM
                , WK_V.PRC_CATG_NM
                , WK_V.MAINT_PRC_CATG_CD
                , WK_V.MAINT_FL_PRC_CATG_CD
                , WK_V.PRC_MTR_PKG_PK
                , WK_V.PRC_TIER_SVC_OFFER_CD
                , WK_V.BASE_PRC_DEAL_AMT
                , WK_V.BASE_PRC_FUNC_AMT
                , WK_V.DEAL_PRC_LIST_PRC_AMT
                , WK_V.FUNC_PRC_LIST_PRC_AMT
                --
                , WK_V.MDL_ID
                , WK_V.T_MDL_NM
                , WK_V.CNT
                --
                , WK_V.CONTR_CRAT_FLG
                , 'N'   SCR_ENT_AVAL_FLG
            FROM
                ( 
                    SELECT
                              CSD.DS_IMPT_SVC_LINE_NUM  CPO_SVC_LINE_NUM
                            , 'N'                       CONTR_CRAT_FLG
                            , NULL                      DS_ORD_POSN_NUM
                            , NULL                      CPO_DTL_LINE_NUM
                            , NULL                      CPO_DTL_LINE_SUB_NUM
                            , NULL                      MTR_READ_METH_CD
                            , CSP.DS_IMPT_SVC_PRC_PK    CPO_SVC_PRC_PK
                            , CSD.DS_IMPT_SVC_DTL_PK    CPO_SVC_DTL_PK
                            , NVL( 
                                CSD.TERM_MTH_AOT
                                , CSD.TO_PER_MTH_NUM - CSD.FROM_PER_MTH_NUM + 1
                            )                           TERM_MTH_NUM
                            , PC.PRC_CATG_NM
                            , CSP.MAINT_PRC_CATG_CD
                            , CSP.MAINT_FL_PRC_CATG_CD
                            , CSP.PRC_MTR_PKG_PK
                            , CSP.PRC_TIER_SVC_OFFER_CD
                            , CSP.BASE_PRC_DEAL_AMT
                            , CSP.BASE_PRC_FUNC_AMT
                            , CSP.DEAL_PRC_LIST_PRC_AMT
                            , CSP.FUNC_PRC_LIST_PRC_AMT
                               --
                            , NULL                      MDL_ID
                            , NULL                      T_MDL_NM
                            , ( 
                                SELECT
                                          COUNT(DSC.GLBL_CMPY_CD)
                                    FROM
                                        DS_IMPT_SVC_CONFIG_REF  DSC
                                    WHERE
                                        DSC.GLBL_CMPY_CD            = CSD.GLBL_CMPY_CD
                                        AND DSC.DS_IMPT_SVC_DTL_PK  = CSD.DS_IMPT_SVC_DTL_PK
                                        AND DSC.EZCANCELFLAG        = '0'
                            )                           CNT
                        FROM
                            DS_IMPT_SVC_DTL     CSD
                            , DS_IMPT_SVC_PRC   CSP
                            , PRC_CATG          PC 
                        WHERE
                            CSD.GLBL_CMPY_CD                = #glblCmpyCd#
                            AND CSD.DS_IMPT_SVC_DTL_PK      = #cpoSvcDtlPk#
                            AND CSD.EZCANCELFLAG            = '0'
                                --
                            AND CSD.GLBL_CMPY_CD            = CSP.GLBL_CMPY_CD(+) 
                            AND CSD.DS_IMPT_SVC_DTL_PK      = CSP.DS_IMPT_SVC_DTL_PK(+)
                            AND CSP.EZCANCELFLAG(+)         = '0'
                             --
                            AND CSP.GLBL_CMPY_CD            = PC.GLBL_CMPY_CD(+) 
                            AND CSP.MAINT_PRC_CATG_CD       = PC.PRC_CATG_CD(+) 
                            AND PC.EZCANCELFLAG(+)          = '0'
                ) WK_V
    </statement>

</sqlMap>
