<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NFAB120001">
    <statement id="getAjeInvAcctDistList" parameterClass="Map" resultClass="Map">
        SELECT
            AID.DS_INV_SLS_CR_PK
           ,AID.AJE_INV_ACCT_DIST_PK
           ,AID.AJE_INV_ACCT_CLS_CD
           ,AID.DR_CR_TP_CD
        FROM
            AJE_INV_ACCT_DIST   AID
        WHERE
                AID.GLBL_CMPY_CD        = #glblCmpyCd#
            AND AID.INV_NUM             = #invNum#
            AND AID.EZCANCELFLAG        = '0'
        ORDER BY
            AID.DS_INV_SLS_CR_PK
           ,AID.DR_CR_TP_CD
           ,AID.AJE_INV_ACCT_CLS_CD
    </statement>

    <statement id="getBsPlTp" parameterClass="Map" resultClass="String">
        SELECT
             BS_PL_TP_CD
        FROM
             COA_ACCT       CA
            ,TRIAL_BAL_TP   TBT
        WHERE
                CA.GLBL_CMPY_CD     = #glblCmpyCd#
            AND CA.COA_ACCT_CD      = #coaAcctCd#
            AND CA.EZCANCELFLAG     = '0'
            AND CA.GLBL_CMPY_CD     = TBT.GLBL_CMPY_CD
            AND CA.TRIAL_BAL_TP_CD  = TBT.TRIAL_BAL_TP_CD
            AND TBT.EZCANCELFLAG    = '0'
    </statement>
    <!-- QC#23166 add Start -->
    <statement id="getSvcInvChrgTp" parameterClass="Map" resultClass="Map">
        SELECT
             IL.SVC_INV_CHRG_TP_CD      AS INV_SVC_INV_CHRG_TP_CD
            ,SIL2.SVC_INV_CHRG_TP_CD    AS SVC_INV_CHRG_TP_CD
            ,DISC.DS_INV_SLS_CR_PK
        FROM
             DS_INV_SLS_CR  DISR
            ,INV_LINE       IL
            ,SVC_INV_LINE   SIL1
            ,SVC_INV_LINE   SIL2
            ,DS_INV_SLS_CR  DISC
            ,INV            IV
        WHERE
                DISR.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DISR.EZCANCELFLAG         = '0'
            AND DISR.TRX_CD               = #trxCd#
            <iterate property="trxRsnCdList" var="trxRsnCd[]" open="AND DISR.TRX_RSN_CD          IN (" close=")" conjunction=",">
            #trxRsnCd[]#
            </iterate>
            AND DISR.GLBL_CMPY_CD         = IL.GLBL_CMPY_CD 
            AND DISR.INV_NUM              = IL.INV_NUM
            AND DISR.INV_BOL_LINE_NUM     = IL.INV_BOL_LINE_NUM
            AND DISR.INV_LINE_NUM         = IL.INV_LINE_NUM
            AND DISR.INV_LINE_SUB_NUM     = IL.INV_LINE_SUB_NUM
            AND IL.EZCANCELFLAG           = '0'
            AND DISR.GLBL_CMPY_CD         = IV.GLBL_CMPY_CD 
            AND DISR.INV_NUM              = IV.INV_NUM
            AND IV.FNLZ_INV_FLG           = #flgN#
            AND IV.SYS_SRC_CD             &lt;&gt; #nfc#
            AND IV.ACCT_DT                like  #procYrMth#
            AND MOD(TO_NUMBER(IV.SELL_TO_CUST_CD), #multiCalcCnt#) = #divideNum#
            AND IV.INV_TP_CD              &lt;&gt; #creditMemo#
            AND IV.EZCANCELFLAG           = '0'
            AND IL.GLBL_CMPY_CD           = SIL1.GLBL_CMPY_CD
            AND IL.SVC_INV_LINE_PK        = SIL1.SVC_INV_LINE_PK
            AND SIL1.EZCANCELFLAG         = '0'
            AND SIL1.GLBL_CMPY_CD         = SIL2.GLBL_CMPY_CD(+)
            AND SIL1.PRNT_SVC_INV_LINE_PK = SIL2.SVC_INV_LINE_PK(+)
            AND SIL2.EZCANCELFLAG(+)      = '0'
            AND IL.GLBL_CMPY_CD           = DISC.GLBL_CMPY_CD
            AND IL.INV_NUM                = DISC.INV_NUM
            AND IL.INV_BOL_LINE_NUM       = DISC.INV_BOL_LINE_NUM
            AND IL.INV_LINE_NUM           = DISC.INV_LINE_NUM
            AND IL.INV_LINE_SUB_NUM       = DISC.INV_LINE_SUB_NUM
    </statement>
    <!-- QC#23166 add End -->
</sqlMap>