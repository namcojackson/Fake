<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NLCB024001">

    <statement id="getDelSnapshotDly" parameterClass="Map">
        SELECT
              ISS.GLBL_CMPY_CD
            , ISS.INVTY_DTL_SNAP_SHOT_PK
        FROM
            INVTY_DTL_SNAP_SHOT ISS
        WHERE
            ISS.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="locTpCd">
                AND ISS.LOC_TP_CD = #locTpCd#
            </isNotNull>
            AND ((ISS.MLY_CLO_YR_MTH IS NULL
                 <![CDATA[
                    AND ISS.INVTY_DTL_SNAP_SHOT_DT <= #delDtDly#)
                 ]]>
                OR ISS.INVTY_DTL_SNAP_SHOT_DT = #batProcDt#)
    </statement>

    <statement id="getDelSnapshotMly" parameterClass="Map">
        SELECT
        	ISS.GLBL_CMPY_CD
            , ISS.INVTY_DTL_SNAP_SHOT_PK
        FROM
            INVTY_DTL_SNAP_SHOT ISS
        WHERE
            ISS.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="locTpCd">
                AND ISS.LOC_TP_CD = #locTpCd#
            </isNotNull>
            AND (ISS.MLY_CLO_YR_MTH IS NOT NULL
                <![CDATA[
                    AND ISS.MLY_CLO_YR_MTH <= #delDtMly#)
                ]]>
    </statement>

    <statement id="getDelSnapshotDlyMly" parameterClass="Map">
        SELECT
              ISS.GLBL_CMPY_CD
            , ISS.INVTY_DTL_SNAP_SHOT_PK
        FROM
            INVTY_DTL_SNAP_SHOT ISS
        WHERE
            ISS.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="locTpCd">
                AND ISS.LOC_TP_CD = #locTpCd#
            </isNotNull>
            AND ((ISS.MLY_CLO_YR_MTH IS NULL
                <![CDATA[
                    AND ISS.INVTY_DTL_SNAP_SHOT_DT <= #delDtDly#)
                OR (ISS.MLY_CLO_YR_MTH IS NOT NULL
                    AND ISS.MLY_CLO_YR_MTH <= #delDtMly#)
                OR ISS.INVTY_DTL_SNAP_SHOT_DT = #batProcDt#)
                ]]>
    </statement>

    <statement id="getCopyInvty" parameterClass="Map">
        SELECT
              IVT.GLBL_CMPY_CD
            , IVT.MDSE_CD
            , IVT.SER_NUM		    
            , IVT.INVTY_LOC_CD
            , IVT.LOC_STS_CD
            , IVT.STK_STS_CD
            , IVT.LOC_TP_CD
            , IVT.STK_IN_DT
            , IVT.INVTY_QTY
            , INVTY_DTL_SNAP_SHOT_SQ.NEXTVAL AS INVTY_DTL_SNAP_SHOT_PK
        FROM
              INVTY_DTL_DLY IVT
        WHERE
            IVT.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="locTpCd">
                AND IVT.LOC_TP_CD = #locTpCd#
            </isNotNull>
            AND IVT.EZCANCELFLAG = '0'
    </statement>

    <statement id="getClSnapshot" parameterClass="Map">
        SELECT
              ISS.EZTABLEID
            , ISS.EZCANCELFLAG
            , ISS.EZINTIME
            , ISS.EZINTIMEZONE
            , ISS.EZINCOMPANYCODE
            , ISS.EZINUSERID
            , ISS.EZINAPLID
            , ISS.EZUPTIME
            , ISS.EZUPTIMEZONE
            , ISS.EZUPCOMPANYCODE
            , ISS.EZUPUSERID
            , ISS.EZUPAPLID
            , ISS.GLBL_CMPY_CD
            , ISS.INVTY_DTL_SNAP_SHOT_PK
            , ISS.INVTY_DTL_SNAP_SHOT_DT
            , ISS.MDSE_CD
            , ISS.SER_NUM
            , ISS.INVTY_LOC_CD
            , ISS.LOC_STS_CD
            , ISS.STK_STS_CD
            , ISS.MLY_CLO_YR_MTH
            , ISS.LOC_TP_CD
            , ISS.STK_IN_DT
            , ISS.INVTY_QTY
        FROM
            INVTY_DTL_SNAP_SHOT ISS
        WHERE
            ISS.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="locTpCd">
                AND ISS.LOC_TP_CD = #locTpCd#
            </isNotNull>
            AND ISS.MLY_CLO_YR_MTH = #mlyCloDt#
            <![CDATA[
                AND ISS.INVTY_DTL_SNAP_SHOT_DT <> #snapShotDt#
            ]]>
            AND ISS.EZCANCELFLAG = '0'
    </statement>

    <statement id="getUpdSnapshot" parameterClass="Map">
        SELECT
              ISS.EZTABLEID
            , ISS.EZCANCELFLAG
            , ISS.EZINTIME
            , ISS.EZINTIMEZONE
            , ISS.EZINCOMPANYCODE
            , ISS.EZINUSERID
            , ISS.EZINAPLID
            , ISS.EZUPTIME
            , ISS.EZUPTIMEZONE
            , ISS.EZUPCOMPANYCODE
            , ISS.EZUPUSERID
            , ISS.EZUPAPLID
            , ISS.GLBL_CMPY_CD
            , ISS.INVTY_DTL_SNAP_SHOT_PK
            , ISS.INVTY_DTL_SNAP_SHOT_DT
            , ISS.MDSE_CD
            , ISS.SER_NUM
            , ISS.INVTY_LOC_CD
            , ISS.LOC_STS_CD
            , ISS.STK_STS_CD
            , ISS.MLY_CLO_YR_MTH
            , ISS.LOC_TP_CD
            , ISS.STK_IN_DT
            , ISS.INVTY_QTY
        FROM
            INVTY_DTL_SNAP_SHOT ISS
        WHERE
            ISS.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="locTpCd">
                AND ISS.LOC_TP_CD = #locTpCd#
            </isNotNull>
            AND ISS.INVTY_DTL_SNAP_SHOT_DT = #snapShotDt#
            AND ISS.EZCANCELFLAG = '0'
    </statement>
</sqlMap>