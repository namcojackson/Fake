<template>

<!-- Version: 1.0.0 $Date::                           $ -->

<!-- 0.Data Check -->
  <variable name="sql00" type="sql" value="
	select  count(*) item_count
	from EIP_RPT_INP_PRM
	where
	    EIP_RPT_RQST_PK=${_VA_EIP_RPT_RQST_PK}
	    and RPT_RQST_SUB_ID=${_VA_RPT_RQST_SUB_ID}
	    and (RPT_PRM_NM = 'GLBL_CMPY_CD'
            or RPT_PRM_NM = 'BIZ_APP_ID'
            or RPT_PRM_NM = 'OTPT_OP_CD'
            or RPT_PRM_NM = 'RPT_RQST_HDR_PK'
            or RPT_PRM_NM = 'INTL_LANG_VAL_COL_NM')
"/>

<!-- 1.Get 2 Parameters for inv_num -->
  <variable name="sql0" type="sql" value="
	select  RPT_PRM_NM,RPT_PRM_VAL_TXT
	from EIP_RPT_INP_PRM
	where
	    EIP_RPT_RQST_PK=${_VA_EIP_RPT_RQST_PK}
	    and RPT_RQST_SUB_ID=${_VA_RPT_RQST_SUB_ID}
	    and (RPT_PRM_NM = 'GLBL_CMPY_CD'
            or RPT_PRM_NM = 'BIZ_APP_ID'
            or RPT_PRM_NM = 'OTPT_OP_CD'
            or RPT_PRM_NM = 'RPT_RQST_HDR_PK'
            or RPT_PRM_NM = 'INTL_LANG_VAL_COL_NM')
"/>

	<variable name="VA_GLBL_CMPY_CD" type="string" value=""/>
	<variable name="VA_BIZ_APP_ID" type="string" value=""/>
	<variable name="VA_OTPT_OP_CD" type="string" value=""/>
	<variable name="VA_RPT_RQST_HDR_PK" type="string" value=""/>
	<variable name="VA_INTL_LANG_VAL_COL_NM" type="string" value=""/>

	<variable name="C23019" type="string" value=""/>
	<variable name="C1359" type="string" value=""/>
	<variable name="Cm" type="string" value=""/>
	<variable name="Cp" type="string" value=""/>
	<variable name="C6821" type="string" value=""/>
	<variable name="C2141" type="string" value=""/>
	<variable name="C23020" type="string" value=""/>
	<variable name="C23021" type="string" value=""/>
	<variable name="C23022" type="string" value=""/>
	<variable name="C23048" type="string" value=""/>
	<variable name="C502" type="string" value=""/>
	<variable name="C4258" type="string" value=""/>
	<variable name="C1565" type="string" value=""/>
	<variable name="C23023" type="string" value=""/>
	<variable name="C685" type="string" value=""/>
	<variable name="C23024" type="string" value=""/>
	<variable name="C23025" type="string" value=""/>
	<variable name="C1883" type="string" value=""/>
	<variable name="C3050" type="string" value=""/>
	<variable name="C23026" type="string" value=""/>
	<variable name="C502_2" type="string" value=""/>
	<variable name="C23027" type="string" value=""/>
	<variable name="C21354" type="string" value=""/>
	<variable name="C2739" type="string" value=""/>
	<variable name="C23028" type="string" value=""/>
	<variable name="C23029" type="string" value=""/>
	<variable name="C23030" type="string" value=""/>
	<variable name="C23031" type="string" value=""/>
	<variable name="C23032" type="string" value=""/>
	<variable name="C4415" type="string" value=""/>
	<variable name="C23033" type="string" value=""/>
	<variable name="C4300" type="string" value=""/>
	<variable name="C21354_2" type="string" value=""/>
	<variable name="C23034" type="string" value=""/>
	<variable name="C23035" type="string" value=""/>
	<variable name="C23036" type="string" value=""/>
	<variable name="C23037" type="string" value=""/>
	<variable name="C23038" type="string" value=""/>
	<variable name="C23039" type="string" value=""/>
	<variable name="C23040" type="string" value=""/>
	<variable name="C23041" type="string" value=""/>
	<variable name="C23042" type="string" value=""/>
	<variable name="C23043" type="string" value=""/>
	<variable name="C23044" type="string" value=""/>
	<variable name="C23045" type="string" value=""/>
	<variable name="C23046" type="string" value=""/>
	<variable name="C2702" type="string" value=""/>
	<variable name="C23047" type="string" value=""/>

	<variable name="i" type="int" value="0" />  <!-- Total Counter -->
	<variable name="j" type="int" value="0" />  <!-- Line2 Counter -->
	<variable name="k" type="int" value="0" />  <!-- Line3 Counter -->
	<variable name="l" type="int" value="0" />  <!-- Line2 Serial Counter -->
	<variable name="PRE_ORD_SRC_REF_NUM" type="string" value="" />  <!-- Previous Key -->
	<variable name="PRE_LINE2_KEY" type="string" value="" />  <!-- Line2 Key -->


 <variable name="sql01" type="sql" value="
SELECT count(*) item_count
FROM 
    INTL_LANG_VAL
WHERE
LANG_KEY_CD in ('23019','1359','m','p','6821','2141','23020','23021','23022','23048','502','4258','1565','23023','685','23024','23025','1883','3050','23026','23027','21354','2739','23028','23029','23030','23031','23032','4415','23033','4300','23034','23035','23036','23037','23038','23039','23040','23041','23042','23043','23044','23045','23046','2702','23047')
"/>

 <variable name="sql1" type="sql" value="
SELECT LANG_KEY_CD, ${INTL_LANG_VAL_COL_NM} LANGUAGE_LABEL
FROM 
    INTL_LANG_VAL
WHERE
LANG_KEY_CD in ('23019','1359','m','p','6821','2141','23020','23021','23022','23048','502','4258','1565','23023','685','23024','23025','1883','3050','23026','23027','21354','2739','23028','23029','23030','23031','23032','4415','23033','4300','23034','23035','23036','23037','23038','23039','23040','23041','23042','23043','23044','23045','23046','2702','23047')
"
nonescaped="${INTL_LANG_VAL_COL_NM}"/>

 <variable name="sql02" type="sql" value="
SELECT count(*) item_count
FROM ORD_IMPT_RPT_WRK A
WHERE
A.GLBL_CMPY_CD = ${VA_GLBL_CMPY_CD}
AND A.BIZ_APP_ID = ${VA_BIZ_APP_ID}
AND A.OTPT_OP_CD = ${VA_OTPT_OP_CD}
AND A.RPT_RQST_HDR_PK = ${VA_RPT_RQST_HDR_PK}
"/>


<variable name="sql2" type="sql" value="
SELECT
  TO_CHAR(TO_DATE(PROC_DT_TXT, 'YYYY/MM/DD'), 'DD-MON-YYYY') PROC_DT_TXT
, ORD_SRC_REF_NUM
, CPO_ORD_NUM
, regexp_replace(	
    ISTL_FIRST_CUST_NM || CHR (13) || CHR (10) || 
    CASE WHEN ISTL_SCD_CUST_NM IS NOT NULL THEN ISTL_SCD_CUST_NM || CHR (13) || CHR (10) ELSE NULL END || 
    ISTL_FIRST_LINE_ADDR || CHR (13) || CHR (10) || 
    ISTL_CTY_ADDR || '     ' || ISTL_ST_CD || '          ' || ISTL_POST_CD || CHR (13) || CHR (10) || 
    ISTL_TEL_NUM || '     ' || ISTL_FAX_NUM
, '('|| CHR (13) || CHR (10) || ')+$', '') 	ISTL_LOC_ADDR
, ISTL_ATTN_TO_NM
, INSTL_CD
, ISTL_SUB_LOC_CD
, TO_CHAR(TO_DATE(CPO_ORD_DT_TXT, 'YYYY/MM/DD'), 'DD-MON-YYYY') CPO_ORD_DT_TXT
, NULL
, SVC_DLR_CD
, regexp_replace(	
    SVC_DLR_FIRST_CUST_NM || CHR (13) || CHR (10) || 
    CASE WHEN SVC_DLR_SCD_CUST_NM IS NOT NULL THEN SVC_DLR_SCD_CUST_NM || CHR (13) || CHR (10) ELSE NULL END || 
    SVC_DLR_FIRST_LINE_ADDR || CHR (13) || CHR (10) || 
    SVC_DLR_CTY_ADDR || '     ' || SVC_DLR_ST_CD || '          ' || SVC_DLR_POST_CD || CHR (13) || CHR (10) || 
    SVC_DLR_TEL_NUM || '     ' || SVC_DLR_FAX_NUM
, '('|| CHR (13) || CHR (10) || ')+$', '') 	SVC_DLR_ADDR
, RTL_DIV_CD
, ORD_COORD_NM
, ROSS_ORD_TP_MSG_TXT
, CUST_ISS_PO_NUM
, TO_CHAR(TO_DATE(CUST_ISS_PO_DT_TXT, 'YYYY/MM/DD'), 'DD-MON-YYYY') CUST_ISS_PO_DT_TXT
, FNDG_DLR_CD || ORIG_DLR_CD || SHIP_TO_LOC_NUM LINE_1_KEY
, FNDG_DLR_CD
, regexp_replace(	
    FNDG_DLR_FIRST_CUST_NM || CHR (13) || CHR (10) || 
    FNDG_DLR_SCD_CUST_NM || CHR (13) || CHR (10) || 
    FNDG_DLR_FIRST_LINE_ADDR || CHR (13) || CHR (10) || 
    FNDG_DLR_CTY_ADDR || '     ' || FNDG_DLR_ST_CD || '          ' || FNDG_DLR_POST_CD || CHR (13) || CHR (10) || 
    FNDG_DLR_TEL_NUM || '     ' || FNDG_DLR_FAX_NUM
, '('|| CHR (13) || CHR (10) || ')+$', '') 	FNDG_DLR_ADDR
, ORIG_DLR_CD
, regexp_replace(	
    ORIG_DLR_FIRST_CUST_NM || CHR (13) || CHR (10) || 
    ORIG_DLR_SCD_CUST_NM || CHR (13) || CHR (10) || 
    ORIG_DLR_FIRST_LINE_ADDR || CHR (13) || CHR (10) || 
    ORIG_DLR_CTY_ADDR || '     ' || ORIG_DLR_ST_CD || '          ' || ORIG_DLR_POST_CD || CHR (13) || CHR (10) || 
    ORIG_DLR_TEL_NUM || '     ' || ORIG_DLR_FAX_NUM
, '('|| CHR (13) || CHR (10) || ')+$', '') 	ORIG_DLR_ADDR
, regexp_replace(	
    SHIP_TO_FIRST_CUST_NM || CHR (13) || CHR (10) || 
    SHIP_TO_SCD_CUST_NM || CHR (13) || CHR (10) || 
    SHIP_TO_FIRST_LINE_ADDR || CHR (13) || CHR (10) || 
    SHIP_TO_CTY_ADDR || '     ' || SHIP_TO_ST_CD || '          ' || SHIP_TO_POST_CD || CHR (13) || CHR (10) || 
    SHIP_TO_TEL_NUM || '     ' || SHIP_TO_FAX_NUM
, '('|| CHR (13) || CHR (10) || ')+$', '') 	SHIP_TO_LOC_ADDR
, SHIP_TO_ATTN_TXT
, SHIP_TO_LOC_NUM
, ORD_SRC_REF_NUM || MDSE_CD_01 || MDL_NM_01 || QTY_ORD_TXT || QTY_SHIP_TXT || QTY_BO_TXT || SO_NUM LINE2_KEY
, MDSE_CD_01
, MDL_NM_01
, QTY_ORD_TXT
, QTY_SHIP_TXT
, QTY_BO_TXT
, SER_NUM
, PRNT_SER_NUM
, SO_NUM
, WH_NM
, ACTL_SHIP_DT_TXT
, MDSE_CD_02
, MDL_NM_02
, AMT_ISTL_COMP_TXT
, AMT_SVC_DLR_COMP_TXT
, AMT_EXT_WTY_COMP_TXT
, AMT_FNDG_DLR_COMP_TXT
, AMT_ORIG_DLR_COMP_TXT
, AMT_ORD_TAKE_DLR_COMP_TXT
, AMT_RMV_COMP_TXT
, AMT_MLY_BASE_COMP_TXT
, AMT_MLY_ADMIN_COMP_TXT
, QTY_MLY_COPY_INCL_COMP_TXT
, QTY_XS_MTR_COMP_COPY_TXT
, AMT_RATE_XS_MTR_COMP_TXT
, ORD_IMPT_RPT_MSG_TXT
, ORD_IMPT_RPT_FTR_MSG_TXT_01 || ORD_IMPT_RPT_FTR_MSG_TXT_02 || ORD_IMPT_RPT_FTR_MSG_TXT_03 || ORD_IMPT_RPT_FTR_MSG_TXT_04 || ORD_IMPT_RPT_FTR_MSG_TXT_05 || ORD_IMPT_RPT_FTR_MSG_TXT_06 NOTE_KEY
, ORD_IMPT_RPT_FTR_MSG_TXT_01
, ORD_IMPT_RPT_FTR_MSG_TXT_02
, ORD_IMPT_RPT_FTR_MSG_TXT_03
, ORD_IMPT_RPT_FTR_MSG_TXT_04
, ORD_IMPT_RPT_FTR_MSG_TXT_05
, ORD_IMPT_RPT_FTR_MSG_TXT_06
, ORD_IMPT_RPT_FTR_MSG_TXT_07
FROM ORD_IMPT_RPT_WRK A
WHERE
A.GLBL_CMPY_CD = ${VA_GLBL_CMPY_CD}
AND A.BIZ_APP_ID = ${VA_BIZ_APP_ID}
AND A.OTPT_OP_CD = ${VA_OTPT_OP_CD}
AND A.RPT_RQST_HDR_PK = ${VA_RPT_RQST_HDR_PK}
ORDER BY A.ORD_IMPT_RPT_WRK_PK
"/>


<doc encoding="UTF-8">
<condition test="${sql00.item_count}" value="0" operator="equal">
 <error message="no data in Parameter DB"/>
</condition>

<for variable="sql0">
	<condition test="${sql0.RPT_PRM_NM}" value="GLBL_CMPY_CD" operator="equal">
		<assign variable="VA_GLBL_CMPY_CD" value="${sql0.RPT_PRM_VAL_TXT}"/>
	</condition>
	<condition test="${sql0.RPT_PRM_NM}" value="BIZ_APP_ID" operator="equal">
		<assign variable="VA_BIZ_APP_ID" value="${sql0.RPT_PRM_VAL_TXT}"/>
	</condition>
	<condition test="${sql0.RPT_PRM_NM}" value="OTPT_OP_CD" operator="equal">
		<assign variable="VA_OTPT_OP_CD" value="${sql0.RPT_PRM_VAL_TXT}"/>
	</condition>
	<condition test="${sql0.RPT_PRM_NM}" value="RPT_RQST_HDR_PK" operator="equal">
		<assign variable="VA_RPT_RQST_HDR_PK" value="${sql0.RPT_PRM_VAL_TXT}"/>
	</condition>
	<condition test="${sql0.RPT_PRM_NM}" value="INTL_LANG_VAL_COL_NM" operator="equal">
		<assign variable="INTL_LANG_VAL_COL_NM" value="${sql0.RPT_PRM_VAL_TXT}"/>
	</condition>
</for>

<condition test="${sql01.item_count}" value="0" operator="equal">
  <error message="no data in Language DB"/>
</condition>

<for variable="sql1">
	<condition test="${sql1.LANG_KEY_CD}" value="23019" operator="equal"><assign variable="C23019" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Canon : TPC01 Order Import Success/Failure Report-->
	<condition test="${sql1.LANG_KEY_CD}" value="1359" operator="equal"><assign variable="C1359" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Date-->
	<condition test="${sql1.LANG_KEY_CD}" value="m" operator="equal"><assign variable="Cm" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Page-->
	<condition test="${sql1.LANG_KEY_CD}" value="p" operator="equal"><assign variable="Cp" value="${sql1.LANGUAGE_LABEL}"/></condition><!--of-->
	<condition test="${sql1.LANG_KEY_CD}" value="6821" operator="equal"><assign variable="C6821" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Order Number-->
	<condition test="${sql1.LANG_KEY_CD}" value="2141" operator="equal"><assign variable="C2141" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Install Location-->
	<condition test="${sql1.LANG_KEY_CD}" value="23020" operator="equal"><assign variable="C23020" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Loc Id-->
	<condition test="${sql1.LANG_KEY_CD}" value="23021" operator="equal"><assign variable="C23021" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Loc Sub ID-->
	<condition test="${sql1.LANG_KEY_CD}" value="23022" operator="equal"><assign variable="C23022" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Order Creation Date-->
	<condition test="${sql1.LANG_KEY_CD}" value="23048" operator="equal"><assign variable="C23048" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Canon USA Office-->
	<condition test="${sql1.LANG_KEY_CD}" value="502" operator="equal"><assign variable="C502" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Attn-->
	<condition test="${sql1.LANG_KEY_CD}" value="4258" operator="equal"><assign variable="C4258" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Service Dealer-->
	<condition test="${sql1.LANG_KEY_CD}" value="1565" operator="equal"><assign variable="C1565" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Division-->
	<condition test="${sql1.LANG_KEY_CD}" value="23023" operator="equal"><assign variable="C23023" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Order Coordinator-->
	<condition test="${sql1.LANG_KEY_CD}" value="685" operator="equal"><assign variable="C685" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Business Type-->
	<condition test="${sql1.LANG_KEY_CD}" value="23024" operator="equal"><assign variable="C23024" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--PO Order Number-->
	<condition test="${sql1.LANG_KEY_CD}" value="23025" operator="equal"><assign variable="C23025" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--PO Order Date-->
	<condition test="${sql1.LANG_KEY_CD}" value="1883" operator="equal"><assign variable="C1883" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Finding Dealer-->
	<condition test="${sql1.LANG_KEY_CD}" value="3050" operator="equal"><assign variable="C3050" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Original Dealer-->
	<condition test="${sql1.LANG_KEY_CD}" value="23026" operator="equal"><assign variable="C23026" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Ship To Location-->
	<condition test="${sql1.LANG_KEY_CD}" value="502" operator="equal"><assign variable="C502_2" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Attn-->
	<condition test="${sql1.LANG_KEY_CD}" value="23027" operator="equal"><assign variable="C23027" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Location Number-->
	<condition test="${sql1.LANG_KEY_CD}" value="21354" operator="equal"><assign variable="C21354" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Item Code-->
	<condition test="${sql1.LANG_KEY_CD}" value="2739" operator="equal"><assign variable="C2739" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Model Name-->
	<condition test="${sql1.LANG_KEY_CD}" value="23028" operator="equal"><assign variable="C23028" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Order Q'ty-->
	<condition test="${sql1.LANG_KEY_CD}" value="23029" operator="equal"><assign variable="C23029" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Ship Q'ty-->
	<condition test="${sql1.LANG_KEY_CD}" value="23030" operator="equal"><assign variable="C23030" value="${sql1.LANGUAGE_LABEL}"/></condition><!--B/O Q'ty-->
	<condition test="${sql1.LANG_KEY_CD}" value="23031" operator="equal"><assign variable="C23031" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Serial No-->
	<condition test="${sql1.LANG_KEY_CD}" value="23032" operator="equal"><assign variable="C23032" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Parent Sr No-->
	<condition test="${sql1.LANG_KEY_CD}" value="4415" operator="equal"><assign variable="C4415" value="${sql1.LANGUAGE_LABEL}"/></condition><!--So No.-->
	<condition test="${sql1.LANG_KEY_CD}" value="23033" operator="equal"><assign variable="C23033" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Ship From W/H-->
	<condition test="${sql1.LANG_KEY_CD}" value="4300" operator="equal"><assign variable="C4300" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Ship Date-->
	<condition test="${sql1.LANG_KEY_CD}" value="21354" operator="equal"><assign variable="C21354_2" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Item Code-->
	<condition test="${sql1.LANG_KEY_CD}" value="23034" operator="equal"><assign variable="C23034" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Model<br>Name-->
	<condition test="${sql1.LANG_KEY_CD}" value="23035" operator="equal"><assign variable="C23035" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Install<br>Comp-->
	<condition test="${sql1.LANG_KEY_CD}" value="23036" operator="equal"><assign variable="C23036" value="${sql1.LANGUAGE_LABEL}"/></condition><!--SVC Comp-->
	<condition test="${sql1.LANG_KEY_CD}" value="23037" operator="equal"><assign variable="C23037" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Ext Wnty-->
	<condition test="${sql1.LANG_KEY_CD}" value="23038" operator="equal"><assign variable="C23038" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Find Dlr<br>Comp-->
	<condition test="${sql1.LANG_KEY_CD}" value="23039" operator="equal"><assign variable="C23039" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Orig Dlr<br>Comp-->
	<condition test="${sql1.LANG_KEY_CD}" value="23040" operator="equal"><assign variable="C23040" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Take Dlr<br>Comp-->
	<condition test="${sql1.LANG_KEY_CD}" value="23041" operator="equal"><assign variable="C23041" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Removal<br>Comp-->
	<condition test="${sql1.LANG_KEY_CD}" value="23042" operator="equal"><assign variable="C23042" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Monthly<br>Comp-->
	<condition test="${sql1.LANG_KEY_CD}" value="23043" operator="equal"><assign variable="C23043" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Monthly<br>Admin Comp-->
	<condition test="${sql1.LANG_KEY_CD}" value="23044" operator="equal"><assign variable="C23044" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Copies<br>Included-->
	<condition test="${sql1.LANG_KEY_CD}" value="23045" operator="equal"><assign variable="C23045" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Excess<br>Copy-->
	<condition test="${sql1.LANG_KEY_CD}" value="23046" operator="equal"><assign variable="C23046" value="${sql1.LANGUAGE_LABEL}"/></condition><!--Excess Amt-->
	<condition test="${sql1.LANG_KEY_CD}" value="2702" operator="equal"><assign variable="C2702" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Message-->
	<condition test="${sql1.LANG_KEY_CD}" value="23047" operator="equal"><assign variable="C23047" value="${sql1.LANGUAGE_LABEL}:"/></condition><!--Installation Notes-->
</for>

<condition test="${sql02.item_count}" value="0" operator="equal">
  <error message="no data in DB"/>
</condition>

 <section name="Control Section">
  <textln>VERSION=8.1</textln>
 </section>
 <section name="Form Section">
  <textln>FORM=..\..\forms\NWAF0090.fcp</textln>
 </section>

 <section name="Table Data Section">
    <assign variable="i" value="0"/>
    <assign variable="j" value="0"/>
    <assign variable="k" value="0"/>
    <assign variable="l" value="0"/>
    <assign variable="m" value="0"/>
    <assign variable="PRE_ORD_SRC_REF_NUM" value=""/>
    <assign variable="PRE_LINE2_KEY" value=""/>
    <for variable="sql2">
    <condition test="${PRE_ORD_SRC_REF_NUM}" operator="not equal" value="${sql2.ORD_SRC_REF_NUM}">
      <assign variable="i" value="0"/>
      <assign variable="j" value="0"/>
      <assign variable="k" value="0"/>
      <assign variable="l" value="0"/>
      <assign variable="m" value="0"/>
      <assign variable="PRE_LINE2_KEY" value=""/>
    </condition>
    <!-- Header -->
	  <text>"${C23019}",</text>
	  <text>"${C1359}",</text>
	  <text>"${Cm}",</text>
	  <text>"${Cp}",</text>
	  <text>"${sql2.ORD_SRC_REF_NUM}",</text>
	  <text>"${sql2.PROC_DT_TXT}",</text>
	  <text>"${C6821}",</text>
	  <text>"${sql2.CPO_ORD_NUM}",</text>
	  <text>"${C2141}",</text>
	  <text>"${sql2.ISTL_LOC_ADDR}",</text>
	  <text>"${sql2.ISTL_ATTN_TO_NM}",</text>
	  <text>"${C23020}",</text>
	  <text>"${sql2.INSTL_CD}",</text>
	  <text>"${C23021}",</text>
	  <text>"${sql2.ISTL_SUB_LOC_CD}",</text>
	  <text>"${C23022}",</text>
	  <text>"${sql2.CPO_ORD_DT_TXT}",</text>
	  <text>"${C23048}",</text>
	  <text>"${C502}",</text>
	  <text>"${C4258}",</text>
	  <text>"${sql2.SVC_DLR_CD}",</text>
	  <text>"${sql2.SVC_DLR_ADDR}",</text>
	  <text>"${C1565}",</text>
	  <text>"${sql2.RTL_DIV_CD}",</text>
	  <text>"${C23023}",</text>
	  <text>"${sql2.ORD_COORD_NM}",</text>
	  <text>"${C685}",</text>
	  <text>"${sql2.ROSS_ORD_TP_MSG_TXT}",</text>
	  <text>"${C23024}",</text>
	  <text>"${sql2.CUST_ISS_PO_NUM}",</text>
	  <text>"${C23025}",</text>
	  <text>"${sql2.CUST_ISS_PO_DT_TXT}",</text>
    <!-- Line1 -->
      <condition test="${sql2.LINE_1_KEY}" operator="not equal" value="">
	    <text>"${C1883}",</text>
	    <text>"${sql2.FNDG_DLR_CD}",</text>
	    <text>"${sql2.FNDG_DLR_ADDR}",</text>
	    <text>"${C3050}",</text>
	    <text>"${sql2.ORIG_DLR_CD}",</text>
	    <text>"${sql2.ORIG_DLR_ADDR}",</text>
	    <text>"${C23026}",</text>
	    <text>"${sql2.SHIP_TO_LOC_ADDR}",</text>
	    <text>"${sql2.SHIP_TO_ATTN_TXT}",</text>
	    <text>"${C23027}",</text>
	    <text>"${sql2.SHIP_TO_LOC_NUM}",</text>
	    <text>"${C502_2}",</text>
      </condition>
      <condition test="${sql2.LINE_1_KEY}" operator="equal" value="">
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
      </condition>
    <!-- Line2 -->
      <condition test="${sql2.MDSE_CD_01}" operator="not equal" value="">
        <condition test="${j}" operator="equal" value="0">
	      <text>" ",</text>
	      <text>"${C21354}",</text>
	      <text>"---------------",</text>
	      <text>"${sql2.MDSE_CD_01}",</text>
	      <text>"${C2739}",</text>
	      <text>"------------------",</text>
	      <text>"${sql2.MDL_NM_01}",</text>
	      <text>"${C23028}",</text>
	      <text>"---------------",</text>
	      <text>"${sql2.QTY_ORD_TXT}",</text>
	      <text>"${C23029}",</text>
	      <text>"-------------",</text>
	      <text>"${sql2.QTY_SHIP_TXT}",</text>
	      <text>"${C23030}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.QTY_BO_TXT}",</text>
	      <text>"${C23031}",</text>
	      <text>"-------------",</text>
	      <text>"${sql2.SER_NUM}",</text>
	      <text>"${C23032}",</text>
	      <text>"------------------",</text>
	      <text>"${sql2.PRNT_SER_NUM}",</text>
	      <text>"${C4415}",</text>
	      <text>"---------------",</text>
	      <text>"${sql2.SO_NUM}",</text>
	      <text>"${C23033}",</text>
	      <text>"--------------------------",</text>
	      <text>"${sql2.WH_NM}",</text>
	      <text>"${C4300}",</text>
	      <text>"---------------",</text>
	      <text>"${sql2.ACTL_SHIP_DT_TXT}",</text>
        </condition>
        <condition test="${j}" operator="not equal" value="0">
          <condition test="${PRE_LINE2_KEY}" operator="not equal" value="${sql2.LINE2_KEY}">
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.MDSE_CD_01}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.MDL_NM_01}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.QTY_ORD_TXT}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.QTY_SHIP_TXT}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.QTY_BO_TXT}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.SER_NUM}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.PRNT_SER_NUM}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.SO_NUM}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.WH_NM}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.ACTL_SHIP_DT_TXT}",</text>
          </condition>
          <condition test="${PRE_LINE2_KEY}" operator="equal" value="${sql2.LINE2_KEY}">
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.SER_NUM}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${sql2.PRNT_SER_NUM}",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
          </condition>
        </condition>
        <assign variable="j" value="${j} + 1"/>
      </condition>
      <condition test="${sql2.MDSE_CD_01}" operator="equal" value="">
        <assign variable="j" value="0"/>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
      </condition>
    <!-- Line3 -->
      <condition test="${sql2.MDSE_CD_02}" operator="not equal" value="">
        <condition test="${k}" operator="equal" value="0">
	      <text>" ",</text>
	      <text>"${C21354_2}",</text>
	      <text>"---------------",</text>
	      <text>"${sql2.MDSE_CD_02}",</text>
	      <text>"${C23034}",</text>
	      <text>"------------------",</text>
	      <text>"${sql2.MDL_NM_02}",</text>
	      <text>"${C23035}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.AMT_ISTL_COMP_TXT}",</text>
	      <text>"${C23036}",</text>
	      <text>"--------------",</text>
	      <text>"${sql2.AMT_SVC_DLR_COMP_TXT}",</text>
	      <text>"${C23037}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.AMT_EXT_WTY_COMP_TXT}",</text>
	      <text>"${C23038}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.AMT_FNDG_DLR_COMP_TXT}",</text>
	      <text>"${C23039}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.AMT_ORIG_DLR_COMP_TXT}",</text>
	      <text>"${C23040}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.AMT_ORD_TAKE_DLR_COMP_TXT}",</text>
	      <text>"${C23041}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.AMT_RMV_COMP_TXT}",</text>
	      <text>"${C23042}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.AMT_MLY_BASE_COMP_TXT}",</text>
	      <text>"${C23043}",</text>
	      <text>"------------------",</text>
	      <text>"${sql2.AMT_MLY_ADMIN_COMP_TXT}",</text>
	      <text>"${C23044}",</text>
	      <text>"------------",</text>
	      <text>"${sql2.QTY_MLY_COPY_INCL_COMP_TXT}",</text>
	      <text>"${C23045}",</text>
	      <text>"-----------",</text>
	      <text>"${sql2.QTY_XS_MTR_COMP_COPY_TXT}",</text>
	      <text>"${C23046}",</text>
	      <text>"-----------------",</text>
	      <text>"${sql2.AMT_RATE_XS_MTR_COMP_TXT}",</text>
        </condition>
        <condition test="${k}" operator="not equal" value="0">
	      <text>"",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.MDSE_CD_02}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.MDL_NM_02}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_ISTL_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_SVC_DLR_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_EXT_WTY_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_FNDG_DLR_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_ORIG_DLR_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_ORD_TAKE_DLR_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_RMV_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_MLY_BASE_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_MLY_ADMIN_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.QTY_MLY_COPY_INCL_COMP_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.QTY_XS_MTR_COMP_COPY_TXT}",</text>
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.AMT_RATE_XS_MTR_COMP_TXT}",</text>
        </condition>
        <assign variable="k" value="${k} + 1"/>
      </condition>
      <condition test="${sql2.MDSE_CD_02}" operator="equal" value="">
        <assign variable="k" value="0"/>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
      </condition>
    <!-- Message -->
      <condition test="${sql2.ORD_IMPT_RPT_MSG_TXT}" operator="not equal" value="">
        <condition test="${m}" operator="equal" value="0">
	      <text>" ",</text>
	      <text>"${C2702}",</text>
	      <text>"${sql2.ORD_IMPT_RPT_MSG_TXT}",</text>
        </condition>
        <condition test="${m}" operator="not equal" value="0">
	      <text>"",</text>
	      <text>"",</text>
	      <text>"${sql2.ORD_IMPT_RPT_MSG_TXT}",</text>
        </condition>
        <assign variable="m" value="${m} + 1"/>
      </condition>
      <condition test="${sql2.ORD_IMPT_RPT_MSG_TXT}" operator="equal" value="">
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
      </condition>
    <!-- Notice -->
      <condition test="${sql2.NOTE_KEY}" operator="not equal" value="">
	    <text>" ",</text>
	    <text>"${C23047}",</text>
	    <text>"${sql2.ORD_IMPT_RPT_FTR_MSG_TXT_01}",</text>
	    <text>"${sql2.ORD_IMPT_RPT_FTR_MSG_TXT_02}",</text>
	    <text>"${sql2.ORD_IMPT_RPT_FTR_MSG_TXT_03}",</text>
	    <text>"${sql2.ORD_IMPT_RPT_FTR_MSG_TXT_04}",</text>
	    <text>"${sql2.ORD_IMPT_RPT_FTR_MSG_TXT_05}",</text>
	    <text>"${sql2.ORD_IMPT_RPT_FTR_MSG_TXT_06}",</text>
	    <textln>"${sql2.ORD_IMPT_RPT_FTR_MSG_TXT_07}"</textln>
      </condition>
      <condition test="${sql2.NOTE_KEY}" operator="equal" value="">
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <text>"",</text>
	    <textln>""</textln>
      </condition>

      <assign variable="i" value="${i} + 1"/>
      <assign variable="PRE_LINE2_KEY" value="${sql2.LINE2_KEY}" />
      <assign variable="PRE_ORD_SRC_REF_NUM" value="${sql2.ORD_SRC_REF_NUM}" />


    </for>
 </section>

</doc>
<mdatas>
  <mdata key="xcCommonExAttrText1" value="version1.0"/>
</mdatas>
</template>