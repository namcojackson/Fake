<template>

<!-- Version: 1.0.0 $Date::                           $ -->

<!-- 0.Data Check -->
  <variable name="sql00" type="sql" value="
    select  count(*) item_count
    from EIP_RPT_INP_PRM
    where
        EIP_RPT_RQST_PK=${_VA_EIP_RPT_RQST_PK}
        and RPT_RQST_SUB_ID=${_VA_RPT_RQST_SUB_ID}
        and (RPT_PRM_NM = 'GLBL_CMPY_CD'
            OR RPT_PRM_NM = 'BIZ_APP_ID'
            OR RPT_PRM_NM = 'OTPT_OP_CD'
            OR RPT_PRM_NM = 'TRX_HDR_NUM'
            OR RPT_PRM_NM = 'INTL_LANG_VAL_COL_NM')
"/>

<!-- 1.Get 2 Parameters for inv_num -->
  <variable name="sql0" type="sql" value="
    select  RPT_PRM_NM,RPT_PRM_VAL_TXT
    from EIP_RPT_INP_PRM
    where
        EIP_RPT_RQST_PK=${_VA_EIP_RPT_RQST_PK}
        and RPT_RQST_SUB_ID=${_VA_RPT_RQST_SUB_ID}
        and (RPT_PRM_NM = 'GLBL_CMPY_CD'
            OR RPT_PRM_NM = 'BIZ_APP_ID'
            OR RPT_PRM_NM = 'OTPT_OP_CD'
            OR RPT_PRM_NM = 'TRX_HDR_NUM'
            OR RPT_PRM_NM = 'INTL_LANG_VAL_COL_NM')
"/>

<variable name="GLBL_CMPY_CD" type="string" value=""/>
<variable name="BIZ_APP_ID" type="string" value=""/>
<variable name="OTPT_OP_CD" type="string" value=""/>
<variable name="TRX_HDR_NUM" type="string" value=""/>
<variable name="TRX_DT_TXT" type="string" value=""/>
<variable name="INTL_LANG_VAL_COL_NM" type="string" value=""/>

<variable name="Cm" type="string" value=""/>
<variable name="Cp" type="string" value=""/>
<variable name="C22924" type="string" value=""/>
<variable name="C23376" type="string" value=""/>
<variable name="23140" type="string" value=""/>
<variable name="C22563" type="string" value=""/>
<variable name="C22925" type="string" value=""/>
<variable name="C22567" type="string" value=""/>
<variable name="C1808" type="string" value=""/>
<variable name="C22568" type="string" value=""/>
<variable name="C22913" type="string" value=""/>
<variable name="C22912" type="string" value=""/>
<variable name="C989" type="string" value=""/>
<variable name="C4693" type="string" value=""/>
<variable name="C22915" type="string" value=""/>
<variable name="C934" type="string" value=""/>
<variable name="C2265" type="string" value=""/>
<variable name="C22978" type="string" value=""/>
<variable name="C23377" type="string" value=""/>
<variable name="C1496" type="string" value=""/>
<variable name="C4928" type="string" value=""/>
<variable name="C3567" type="string" value=""/>
<variable name="C23378" type="string" value=""/>
<variable name="SPACE" type="string" value=" "/>

 <variable name="sql01" type="sql" value="
SELECT count(*) item_count
FROM 
    INTL_LANG_VAL
WHERE
LANG_KEY_CD in ('m','p','22924','23376','23140','22563','22925','22567','1808','22568','22913','22912','989','4693','22915','934','2265','22978','23377','1496','4928','3567','23378')
"/>

 <variable name="sql1" type="sql" value="
SELECT LANG_KEY_CD, ${INTL_LANG_VAL_COL_NM} LANGUAGE_LABEL
FROM 
    INTL_LANG_VAL
WHERE
LANG_KEY_CD in ('m','p','22924','23376','23140','22563','22925','22567','1808','22568','22913','22912','989','4693','22915','934','2265','22978','23377','1496','4928','3567','23378')
"
nonescaped="${INTL_LANG_VAL_COL_NM}"/>

 <variable name="sql02" type="sql" value="
SELECT count(*) item_count
FROM
RTRN_AUTH_RPT_WRK A
WHERE
A.GLBL_CMPY_CD = ${GLBL_CMPY_CD}
AND A.BIZ_APP_ID = ${BIZ_APP_ID}
AND A.OTPT_OP_CD = ${OTPT_OP_CD}
AND A.TRX_HDR_NUM = ${TRX_HDR_NUM}
"/>

 <variable name="sql2" type="sql" value="
SELECT
A.GLBL_CMPY_NM,
A.GLBL_FULL_CMPY_ADDR,
A.RPT_TTL_TXT,
A.TRX_HDR_NUM,
A.TRX_DT_TXT,
A.CUST_ISS_PO_NUM,
A.RTRN_AUTH_CTAC_TEL_NUM,
A.RTRN_EXPR_DT_TXT,
A.RTRN_AUTH_RPT_NOTE_TXT_01,
A.RTRN_AUTH_RPT_NOTE_TXT_02,
A.RTRN_AUTH_RPT_NOTE_TXT_03,
A.RTRN_AUTH_RPT_NOTE_TXT_04,
A.RTRN_AUTH_RPT_NOTE_TXT_05,
A.RTRN_AUTH_RPT_NOTE_TXT_06,
A.RTRN_AUTH_RPT_NOTE_TXT_07,
A.RTRN_AUTH_RPT_NOTE_TXT_08,
A.RTRN_AUTH_RPT_NOTE_TXT_09,
A.RTRN_AUTH_RPT_NOTE_TXT_10,
A.SELL_TO_CUST_CD,
A.SELL_TO_LOC_NM,
A.SELL_TO_ADDR_01,
A.SELL_TO_ADDR_02,
A.FULL_CTAC_PSN_NM,
A.DS_CTAC_PNT_VAL_TXT,
A.SHIP_TO_CUST_CD,
A.SHIP_TO_LOC_NM,
A.SHIP_TO_ADDR_01,
A.SHIP_TO_ADDR_02,
DECODE(SHIP_TO_LOC_NM, NULL, '', SHIP_TO_LOC_NM || CHR(13) || CHR(10))
  || DECODE(SHIP_TO_ADDR_01, NULL, '', SHIP_TO_ADDR_01 || CHR(13) || CHR(10))
  || DECODE(SHIP_TO_ADDR_02, NULL, '', SHIP_TO_ADDR_02 || CHR(13) || CHR(10)) SHIP_TO_LOC_NM_ALL,
A.RTRN_AUTH_CMNT_TXT_01,
A.MDSE_CD,
A.MNF_ITEM_CD,
A.MDSE_DESC_SHORT_TXT,
A.PKG_UOM_CD,
A.ORD_QTY_TXT,
CASE WHEN RMA_RPT_TP_CD = '1' THEN '1' 
     WHEN RMA_RPT_TP_CD = '2' THEN '2' 
     ELSE  '0' 
END AS RMA_RPT_TP_CD,
CASE WHEN RTRN_AUTH_RPT_NOTE_TXT_03 IS NULL AND RTRN_AUTH_RPT_NOTE_TXT_04 IS NULL AND RTRN_AUTH_RPT_NOTE_TXT_05 IS NULL AND RTRN_AUTH_RPT_NOTE_TXT_06 is null 
           and RTRN_AUTH_RPT_NOTE_TXT_07 IS NULL AND RTRN_AUTH_RPT_NOTE_TXT_08 IS NULL AND RTRN_AUTH_RPT_NOTE_TXT_09 IS NULL THEN '0' 
     ELSE  '1' 
END AS COMMENT_FLG,
A.RTRN_TO_LOC_NM,
A.RTRN_TO_ADDR_01,
A.RTRN_TO_ADDR_02
FROM
RTRN_AUTH_RPT_WRK A
WHERE
A.GLBL_CMPY_CD = ${GLBL_CMPY_CD}
AND A.BIZ_APP_ID = ${BIZ_APP_ID}
AND A.OTPT_OP_CD = ${OTPT_OP_CD}
AND A.TRX_HDR_NUM = ${TRX_HDR_NUM}
ORDER BY CASE WHEN INSTR(CPO_WRK_LINE_NUM,'.',1,1) = 0 AND INSTR(CPO_WRK_LINE_NUM,'-',1) = 0 THEN 
                     LPAD(CPO_WRK_LINE_NUM, 5, '0')
                  || LPAD('0'          , 5, '0')
                  || LPAD('0'          , 5, '0')
                 WHEN INSTR(CPO_WRK_LINE_NUM,'.',1,2) > 0 THEN
                     LPAD(
                          SUBSTR(CPO_WRK_LINE_NUM, 1, INSTR(CPO_WRK_LINE_NUM,'.',1,1) - 1) 
                         , 5, '0')
                  || LPAD(
                          SUBSTR(CPO_WRK_LINE_NUM
                                ,INSTR(CPO_WRK_LINE_NUM,'.',1,1)  + 1 
                                ,INSTR(CPO_WRK_LINE_NUM,'.',1,2)  - INSTR(CPO_WRK_LINE_NUM,'.',1,1) -1
                                 )
                         ,5,'0')
                  || LPAD(
                          SUBSTR(CPO_WRK_LINE_NUM, INSTR(CPO_WRK_LINE_NUM,'.',1,2)  + 1) 
                         ,5,'0')
                 WHEN INSTR(CPO_WRK_LINE_NUM,'.',1,1) > 0 THEN
                     LPAD(SUBSTR(CPO_WRK_LINE_NUM, 1                              ,INSTR(CPO_WRK_LINE_NUM,'.',1,1) - 1), 5, '0')
                  || LPAD(SUBSTR(CPO_WRK_LINE_NUM, INSTR(CPO_WRK_LINE_NUM,'.') + 1)  ,5,                                    '0')
                  || LPAD('0'          , 5, '0')
                 ELSE CPO_WRK_LINE_NUM
            END"/>

<doc encoding="UTF-8">
<condition test="${sql00.item_count}" value="0" operator="equal">
    <error message="no data in Parameter DB"/>
</condition>

<for variable="sql0">
    <condition test="${sql0.RPT_PRM_NM}" value="GLBL_CMPY_CD" operator="equal">
        <assign variable="GLBL_CMPY_CD" value="${sql0.RPT_PRM_VAL_TXT}"/>
    </condition>
    <condition test="${sql0.RPT_PRM_NM}" value="BIZ_APP_ID" operator="equal">
        <assign variable="BIZ_APP_ID" value="${sql0.RPT_PRM_VAL_TXT}"/>
    </condition>
    <condition test="${sql0.RPT_PRM_NM}" value="OTPT_OP_CD" operator="equal">
        <assign variable="OTPT_OP_CD" value="${sql0.RPT_PRM_VAL_TXT}"/>
    </condition>
    <condition test="${sql0.RPT_PRM_NM}" value="TRX_HDR_NUM" operator="equal">
        <assign variable="TRX_HDR_NUM" value="${sql0.RPT_PRM_VAL_TXT}"/>
    </condition>
    <condition test="${sql0.RPT_PRM_NM}" value="INTL_LANG_VAL_COL_NM" operator="equal">
        <assign variable="INTL_LANG_VAL_COL_NM" value="${sql0.RPT_PRM_VAL_TXT}"/>
    </condition>
</for>

<!-- <condition test="${sql01.item_count}" value="0" operator="equal">  -->
<!--  <error message="no data in Language DB"/>  -->
<!-- </condition>  -->

<for variable="sql1">
    <condition test="${sql1.LANG_KEY_CD}" value="m" operator="equal"><assign variable="Cm" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="p" operator="equal"><assign variable="Cp" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22924" operator="equal"><assign variable="C22924" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="23376" operator="equal"><assign variable="C23376" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="23140" operator="equal"><assign variable="C23140" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22563" operator="equal"><assign variable="C22563" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22925" operator="equal"><assign variable="C22925" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22567" operator="equal"><assign variable="C22567" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="1808" operator="equal"><assign variable="C1808" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22568" operator="equal"><assign variable="C22568" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22913" operator="equal"><assign variable="C22913" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22912" operator="equal"><assign variable="C22912" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="989" operator="equal"><assign variable="C989" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="4693" operator="equal"><assign variable="C4693" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22915" operator="equal"><assign variable="C22915" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="934" operator="equal"><assign variable="C934" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="2265" operator="equal"><assign variable="C2265" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="22978" operator="equal"><assign variable="C22978" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="23377" operator="equal"><assign variable="C23377" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="1496" operator="equal"><assign variable="C1496" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="4928" operator="equal"><assign variable="C4928" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="3567" operator="equal"><assign variable="C3567" value="${sql1.LANGUAGE_LABEL}"/></condition>
    <condition test="${sql1.LANG_KEY_CD}" value="23378" operator="equal"><assign variable="C23378" value="${sql1.LANGUAGE_LABEL}"/></condition>
</for>

<condition test="${sql02.item_count}" value="0" operator="equal">
    <error message="no data in Transaction DB(sql02)"/>
</condition>

<section name="Control Section">
    <textln>VERSION=8.1</textln>
</section>
<section name="Form Section">
    <textln>FORM=..\..\forms\NWAF0095.fcp</textln>
</section>

<!-- [Table Data Section] output to dat file -->
<section name="Table Data Section">
    <for variable="sql2">
        <text>"${sql2.GLBL_CMPY_NM}",</text>
        <text>"${sql2.GLBL_FULL_CMPY_ADDR}",</text>
        <text>"${sql2.RPT_TTL_TXT}",</text>
        <text>"${Cm}",</text>
        <text>"${Cp}",</text>
        <text>"${C22924}",</text>
        <text>"${C23376}${C23140}",</text>
        <text>"${sql2.TRX_HDR_NUM}",</text>
        <text>"${C22563}${C23140}",</text>
        <text>"${sql2.TRX_DT_TXT}",</text>
        <text>"${C22925}${C23140}",</text>
        <text>"${sql2.CUST_ISS_PO_NUM}",</text>
        <text>"${C22567}${C23140}",</text>
        <text>"${sql2.RTRN_AUTH_CTAC_TEL_NUM}",</text>
        <text>"${C1808}",</text>
        <text>"${C22568}${C23140}",</text>
        <text>"${sql2.RTRN_EXPR_DT_TXT}",</text>
        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_01}",</text>
        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_02}",</text>
        <text>"${C22913}",</text>
        <text>"${C22912}${C23140}",</text>
        <text>"${sql2.SELL_TO_CUST_CD}",</text>
        <text>"${sql2.SELL_TO_LOC_NM}",</text>
        <text>"${sql2.SELL_TO_ADDR_01}",</text>
        <text>"${sql2.SELL_TO_ADDR_02}",</text>
        <text>"${C989}${C23140}",</text>
        <text>"${C4693}${C23140}",</text>
        <text>"${sql2.FULL_CTAC_PSN_NM}",</text>
        <text>"${sql2.DS_CTAC_PNT_VAL_TXT}",</text>
        <text>"${C22915}",</text>
        <text>"${C22912}${C23140}",</text>
        <text>"${sql2.SHIP_TO_CUST_CD}",</text>
        <text>"${sql2.SHIP_TO_LOC_NM_ALL}",</text>
        <text>"${sql2.SHIP_TO_ADDR_01}",</text>
        <text>"${sql2.SHIP_TO_ADDR_02}",</text>
        <condition test="${sql2.COMMENT_FLG}" value="1" operator="equal">
	        <text>"${C934}${C23140}",</text>
	        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_03}",</text>
	        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_04}",</text>
	        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_05}",</text>
	        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_06}",</text>
	        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_07}",</text>
	        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_08}",</text>
	        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_09}",</text>
            <text>"${SPACE}",</text>
            <text>"",</text>
	        <text>"${sql2.RTRN_AUTH_CMNT_TXT_01}",</text>
        </condition>
        <condition test="${sql2.COMMENT_FLG}" value="0" operator="equal">
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"",</text>
	        <text>"${C934}${C23140}",</text>
	        <text>"${sql2.RTRN_AUTH_CMNT_TXT_01}",</text>
	    </condition>
        <text>"${SPACE}",</text>
        <text>"${C2265}${C22978}${C23377}${C22978}${C1496}",</text>
        <text>"${sql2.MDSE_CD}${C22978}${sql2.MNF_ITEM_CD}",</text>
        <text>"${sql2.MDSE_DESC_SHORT_TXT}",</text>
        <text>"${C4928}",</text>
        <text>"${sql2.PKG_UOM_CD}",</text>
        <text>"${C3567}",</text>
        <text>"${sql2.ORD_QTY_TXT}",</text>
        <condition test="${sql2.RMA_RPT_TP_CD}" operator="equal" value="1">
	        <text>"${C23378}${C23140}",</text>
	        <text>"${sql2.RTRN_TO_LOC_NM}",</text>
	        <text>"${sql2.RTRN_TO_ADDR_01}",</text>
	        <text>"${sql2.RTRN_TO_ADDR_02}",</text>
            <text>"",</text>
        </condition>
        <condition test="${sql2.RMA_RPT_TP_CD}" operator="equal" value="2">
            <text>"",</text>
            <text>"",</text>
            <text>"",</text>
            <text>"",</text>
	        <text>"${sql2.RTRN_AUTH_RPT_NOTE_TXT_10}",</text>
        </condition>
        <condition test="${sql2.RMA_RPT_TP_CD}" operator="equal" value="0">
            <text>"",</text>
            <text>"",</text>
            <text>"",</text>
            <text>"",</text>
            <text>"",</text>
        </condition>
        <textln>"${SPACE}"</textln>
    </for>
</section>
</doc>
<mdatas>
    <mdata key="xcCommonExAttrText1" value="version1.0"/>
</mdatas>
</template>
