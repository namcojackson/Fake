<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWXC021001">

    <statement id="getLocationContactPersonByBillTo"  parameterClass="Map" resultClass="Map">
       WITH A AS
        (
            SELECT
                  B.CTAC_PSN_PK
                , B.DS_CTAC_PNT_TP_CD
                , B.DS_CTAC_PNT_PK
                , P2.DS_CTAC_PNT_VAL_TXT
                , P2.DS_CTAC_PSN_EXTN_NUM
            FROM 
                DS_CTAC_PNT P2,
                (
                    SELECT
                          P.CTAC_PSN_PK
                        , TP.DS_CTAC_PNT_TP_CD
                        , MAX(P.DS_CTAC_PNT_PK) AS DS_CTAC_PNT_PK
                     FROM 
                          DS_CTAC_PNT P
                        , DS_CTAC_PNT_TP TP
                    WHERE
                            P.GLBL_CMPY_CD         = #glblCmpyCd#
                        AND P.DS_CTAC_PNT_TP_CD    = TP.DS_CTAC_PNT_TP_CD
                        AND P.DS_CTAC_PNT_ACTV_FLG = #flgOnY#
                        AND P.EZCANCELFLAG         = '0'
                        AND P.GLBL_CMPY_CD         = TP.GLBL_CMPY_CD
                        AND TP.DS_CTAC_PNT_TP_CD   IN (#ctacPntTpCd_P#, #ctacPntTpCd_E#, #ctacPntTpCd_F#)
                        AND TP.EZCANCELFLAG        = '0'
                    GROUP BY
                          P.CTAC_PSN_PK
                        , TP.DS_CTAC_PNT_TP_CD
                ) B
            WHERE 
                P2.DS_CTAC_PNT_PK = B.DS_CTAC_PNT_PK
        )

        SELECT 
            *
        FROM 
            (
                SELECT
                      CP.CTAC_PSN_PK
                    , CP.CTAC_PSN_FIRST_NM
                    , CP.CTAC_PSN_LAST_NM
                    , DCPR.CTAC_TP_CD
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_P#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS PHONE
                    , ( SELECT 
                          A.DS_CTAC_PSN_EXTN_NUM 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_P#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS EXT
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_E#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS EMAIL
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_F#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS FAX
                FROM
                      BILL_TO_CUST     BTC
                    , DS_CTAC_PSN_RELN DCPR
                    , CTAC_PSN         CP
                WHERE
                        BTC.GLBL_CMPY_CD    = #glblCmpyCd#
                    AND BTC.BILL_TO_CUST_CD = #billToCustCd#
                    AND BTC.EZCANCELFLAG    = '0'
                    AND BTC.GLBL_CMPY_CD    = DCPR.GLBL_CMPY_CD
                    AND BTC.LOC_NUM         = DCPR.LOC_NUM
                    AND DCPR.EZCANCELFLAG   = '0'
                    AND DCPR.GLBL_CMPY_CD   = CP.GLBL_CMPY_CD
                    AND DCPR.CTAC_PSN_PK    = CP.CTAC_PSN_PK
                    AND CP.EZCANCELFLAG     = '0'
                ORDER BY
                    CP.CTAC_PSN_PK
            )
        WHERE
            ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="getAccountContactPersonByBillTo" resultClass="Map" parameterClass="Map">
       WITH A AS
        (
            SELECT
                  B.CTAC_PSN_PK
                , B.DS_CTAC_PNT_TP_CD
                , B.DS_CTAC_PNT_PK
                , P2.DS_CTAC_PNT_VAL_TXT
                , P2.DS_CTAC_PSN_EXTN_NUM
            FROM 
                DS_CTAC_PNT P2,
                (
                    SELECT
                          P.CTAC_PSN_PK
                        , TP.DS_CTAC_PNT_TP_CD
                        , MAX(P.DS_CTAC_PNT_PK) AS DS_CTAC_PNT_PK
                     FROM 
                          DS_CTAC_PNT P
                        , DS_CTAC_PNT_TP TP
                    WHERE
                            P.GLBL_CMPY_CD         = #glblCmpyCd#
                        AND P.DS_CTAC_PNT_TP_CD    = TP.DS_CTAC_PNT_TP_CD
                        AND P.DS_CTAC_PNT_ACTV_FLG = #flgOnY#
                        AND P.EZCANCELFLAG         = '0'
                        AND P.GLBL_CMPY_CD         = TP.GLBL_CMPY_CD
                        AND TP.DS_CTAC_PNT_TP_CD   IN (#ctacPntTpCd_P#, #ctacPntTpCd_E#, #ctacPntTpCd_F#)
                        AND TP.EZCANCELFLAG        = '0'
                    GROUP BY
                          P.CTAC_PSN_PK
                        , TP.DS_CTAC_PNT_TP_CD
                ) B
            WHERE 
                P2.DS_CTAC_PNT_PK = B.DS_CTAC_PNT_PK
        )

        SELECT 
            *
        FROM 
            (
                SELECT
                      CP.CTAC_PSN_PK
                    , CP.CTAC_PSN_FIRST_NM
                    , CP.CTAC_PSN_LAST_NM
                    , DCPR.CTAC_TP_CD
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_P#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS PHONE
                    , ( SELECT 
                          A.DS_CTAC_PSN_EXTN_NUM 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_P#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS EXT
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_E#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS EMAIL
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_F#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS FAX
                FROM
                      BILL_TO_CUST     BTC
                    , DS_CTAC_PSN_RELN DCPR
                    , CTAC_PSN         CP
                WHERE
                        BTC.GLBL_CMPY_CD     = #glblCmpyCd#
                    AND BTC.BILL_TO_CUST_CD  = #billToCustCd#
                    AND BTC.EZCANCELFLAG     = '0'
                    AND BTC.GLBL_CMPY_CD     = DCPR.GLBL_CMPY_CD
                    AND BTC.SELL_TO_CUST_CD  = DCPR.DS_ACCT_NUM
                    AND DCPR.EZCANCELFLAG    = '0'
                    AND DCPR.GLBL_CMPY_CD    = CP.GLBL_CMPY_CD
                    AND DCPR.CTAC_PSN_PK     = CP.CTAC_PSN_PK
                    AND CP.EZCANCELFLAG      = '0'
                ORDER BY
                    CP.CTAC_PSN_PK
            )
        WHERE
            ROWNUM &lt;= #rowNum#
    </statement>
    <statement id="getLocationContactPersonByShipTo" resultClass="Map" parameterClass="Map">
       WITH A AS
        (
            SELECT
                  B.CTAC_PSN_PK
                , B.DS_CTAC_PNT_TP_CD
                , B.DS_CTAC_PNT_PK
                , P2.DS_CTAC_PNT_VAL_TXT
                , P2.DS_CTAC_PSN_EXTN_NUM
            FROM 
                DS_CTAC_PNT P2,
                (
                    SELECT
                          P.CTAC_PSN_PK
                        , TP.DS_CTAC_PNT_TP_CD
                        , MAX(P.DS_CTAC_PNT_PK) AS DS_CTAC_PNT_PK
                     FROM 
                          DS_CTAC_PNT P
                        , DS_CTAC_PNT_TP TP
                    WHERE
                            P.GLBL_CMPY_CD         = #glblCmpyCd#
                        AND P.DS_CTAC_PNT_TP_CD    = TP.DS_CTAC_PNT_TP_CD
                        AND P.DS_CTAC_PNT_ACTV_FLG = #flgOnY#
                        AND P.EZCANCELFLAG         = '0'
                        AND P.GLBL_CMPY_CD         = TP.GLBL_CMPY_CD
                        AND TP.DS_CTAC_PNT_TP_CD   IN (#ctacPntTpCd_P#, #ctacPntTpCd_E#, #ctacPntTpCd_F#)
                        AND TP.EZCANCELFLAG        = '0'
                    GROUP BY
                          P.CTAC_PSN_PK
                        , TP.DS_CTAC_PNT_TP_CD
                ) B
            WHERE 
                P2.DS_CTAC_PNT_PK = B.DS_CTAC_PNT_PK
        )

        SELECT 
            *
        FROM 
            (
                SELECT
                      CP.CTAC_PSN_PK
                    , CP.CTAC_PSN_FIRST_NM
                    , CP.CTAC_PSN_LAST_NM
                    , DCPR.CTAC_TP_CD
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_P#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS PHONE
                    , ( SELECT 
                          A.DS_CTAC_PSN_EXTN_NUM 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_P#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS EXT
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_E#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS EMAIL
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_F#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS FAX
                FROM
                      SHIP_TO_CUST     STC
                    , DS_CTAC_PSN_RELN DCPR
                    , CTAC_PSN         CP
                WHERE
                        STC.GLBL_CMPY_CD    = #glblCmpyCd#
                    AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
                    AND STC.EZCANCELFLAG    = '0'
                    AND STC.GLBL_CMPY_CD    = DCPR.GLBL_CMPY_CD
                    AND STC.LOC_NUM         = DCPR.LOC_NUM
                    AND DCPR.EZCANCELFLAG   = '0'
                    AND DCPR.GLBL_CMPY_CD   = CP.GLBL_CMPY_CD
                    AND DCPR.CTAC_PSN_PK    = CP.CTAC_PSN_PK
                    AND CP.EZCANCELFLAG     = '0'
                ORDER BY
                    CP.CTAC_PSN_PK
            )
        WHERE
            ROWNUM &lt;= #rowNum#
    </statement>
    <statement id="getAccountContactPersonByShipTo" resultClass="Map" parameterClass="Map">
       WITH A AS
        (
            SELECT
                  B.CTAC_PSN_PK
                , B.DS_CTAC_PNT_TP_CD
                , B.DS_CTAC_PNT_PK
                , P2.DS_CTAC_PNT_VAL_TXT
                , P2.DS_CTAC_PSN_EXTN_NUM
            FROM 
                DS_CTAC_PNT P2,
                (
                    SELECT
                          P.CTAC_PSN_PK
                        , TP.DS_CTAC_PNT_TP_CD
                        , MAX(P.DS_CTAC_PNT_PK) AS DS_CTAC_PNT_PK
                     FROM 
                          DS_CTAC_PNT P
                        , DS_CTAC_PNT_TP TP
                    WHERE
                            P.GLBL_CMPY_CD         = #glblCmpyCd#
                        AND P.DS_CTAC_PNT_TP_CD    = TP.DS_CTAC_PNT_TP_CD
                        AND P.DS_CTAC_PNT_ACTV_FLG = #flgOnY#
                        AND P.EZCANCELFLAG         = '0'
                        AND P.GLBL_CMPY_CD         = TP.GLBL_CMPY_CD
                        AND TP.DS_CTAC_PNT_TP_CD   IN (#ctacPntTpCd_P#, #ctacPntTpCd_E#, #ctacPntTpCd_F#)
                        AND TP.EZCANCELFLAG        = '0'
                    GROUP BY
                          P.CTAC_PSN_PK
                        , TP.DS_CTAC_PNT_TP_CD
                ) B
            WHERE 
                P2.DS_CTAC_PNT_PK = B.DS_CTAC_PNT_PK
        )

        SELECT 
            *
        FROM 
            (
                SELECT
                      CP.CTAC_PSN_PK
                    , CP.CTAC_PSN_FIRST_NM
                    , CP.CTAC_PSN_LAST_NM
                    , DCPR.CTAC_TP_CD
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_P#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS PHONE
                    , ( SELECT 
                          A.DS_CTAC_PSN_EXTN_NUM 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_P#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS EXT
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_E#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS EMAIL
                    , ( SELECT 
                          A.DS_CTAC_PNT_VAL_TXT 
                      FROM A 
                      WHERE 
                          A.DS_CTAC_PNT_TP_CD = #ctacPntTpCd_F#
                      AND A.CTAC_PSN_PK = CP.CTAC_PSN_PK
                    ) AS FAX
                FROM
                      SHIP_TO_CUST     STC
                    , DS_CTAC_PSN_RELN DCPR
                    , CTAC_PSN         CP
                WHERE
                        STC.GLBL_CMPY_CD    = #glblCmpyCd#
                    AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
                    AND STC.EZCANCELFLAG    = '0'
                    AND STC.GLBL_CMPY_CD    = DCPR.GLBL_CMPY_CD
                    AND STC.SELL_TO_CUST_CD = DCPR.DS_ACCT_NUM
                    AND DCPR.EZCANCELFLAG   = '0'
                    AND DCPR.GLBL_CMPY_CD   = CP.GLBL_CMPY_CD
                    AND DCPR.CTAC_PSN_PK    = CP.CTAC_PSN_PK
                    AND CP.EZCANCELFLAG     = '0'
                ORDER BY
                    CP.CTAC_PSN_PK
            )
        WHERE
            ROWNUM &lt;= #rowNum#
    </statement>
</sqlMap>
