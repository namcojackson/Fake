<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NWAL1770Query">

    <statement id="getDsOrdCatgList" parameterClass="Map" resultClass="Map">
        <!-- 2018/10/26 QC#28870 Mod Start -->
        SELECT * FROM (
            SELECT
                OC.DS_ORD_CATG_CD       AS DS_ORD_CATG_CD
               ,OC.DS_ORD_CATG_DESC_TXT AS DS_ORD_CATG_DESC_TXT
            FROM
                DS_ORD_CATG           OC
               ,DS_ORD_TP             OT
               ,AVAL_DS_ORD_TP_APP_ID AI
               ,DS_ORD_TP_PROC_DFN    OTPD
            WHERE
                OC.GLBL_CMPY_CD             = #glblCmpyCd#
                AND OC.DS_ORD_CATG_DESC_TXT LIKE #dsOrdCatgDescTxt#
                AND OC.EZCANCELFLAG         = '0'

                AND OC.GLBL_CMPY_CD   = OT.GLBL_CMPY_CD
                AND OC.DS_ORD_CATG_CD = OT.DS_ORD_CATG_CD
                AND OT.EZCANCELFLAG   = '0'

                AND OT.GLBL_CMPY_CD = AI.GLBL_CMPY_CD
                AND OT.DS_ORD_TP_CD = AI.DS_ORD_TP_CD
                AND AI.BIZ_APP_ID   = #bizId#
                AND AI.EZCANCELFLAG = '0'

                AND OT.GLBL_CMPY_CD   = OTPD.GLBL_CMPY_CD
                AND OT.DS_ORD_TP_CD   = OTPD.DS_ORD_TP_CD
                AND OTPD.ACTV_FLG     = 'Y'
                AND OTPD.EZCANCELFLAG = '0'
            GROUP BY
                OC.DS_ORD_CATG_CD
               ,OC.DS_ORD_CATG_DESC_TXT )
        WHERE
            ROWNUM          &lt;= 2
        <!-- 2018/10/26 QC#28870 Mod End -->
    </statement>

    <statement id="getDsOrdTpList" parameterClass="Map" resultClass="Map">
        SELECT
             DOT.DS_ORD_TP_CD       AS DS_ORD_TP_CD
            ,DOT.DS_ORD_TP_DESC_TXT AS DS_ORD_TP_DESC_TXT
        FROM
             DS_ORD_TP              DOT
            ,DS_ORD_TP_PROC_DFN     DOTPD
            ,AVAL_DS_ORD_TP_APP_ID  AD
        WHERE
                DOT.GLBL_CMPY_CD    = #glblCmpyCd#
            AND DOT.DS_ORD_CATG_CD  = #dsOrdCatgCd#
            AND DOT.EZCANCELFLAG    = '0'

            AND DOT.GLBL_CMPY_CD    = DOTPD.GLBL_CMPY_CD
            AND DOT.DS_ORD_TP_CD    = DOTPD.DS_ORD_TP_CD
            AND DOTPD.ACTV_FLG      = 'Y'
            AND DOTPD.EZCANCELFLAG  = '0'

            AND DOT.GLBL_CMPY_CD    = AD.GLBL_CMPY_CD
            AND DOT.DS_ORD_TP_CD    = AD.DS_ORD_TP_CD
            AND AD.BIZ_APP_ID       = #bizId#
            AND AD.EZCANCELFLAG     = '0'
        ORDER BY
            DOT.DS_ORD_TP_SORT_NUM
    </statement>

    <statement id="getShpgSvcLvlList" parameterClass="Map" resultClass="Map">
        SELECT
            SSL.SHPG_SVC_LVL_CD       AS SHPG_SVC_LVL_CD
           ,SSL.SHPG_SVC_LVL_DESC_TXT AS SHPG_SVC_LVL_DESC_TXT
           ,SSL.SHPG_SVC_LVL_SORT_NUM AS SHPG_SVC_LVL_SORT_NUM
        FROM
            SHPG_SVC_LVL          SSL
           ,FRT_COND_SVC_LVL_RELN FCSLR
        WHERE
            SSL.GLBL_CMPY_CD       = #glblCmpyCd#
            AND SSL.EZCANCELFLAG   = '0'

            AND SSL.GLBL_CMPY_CD      = FCSLR.GLBL_CMPY_CD
            AND SSL.SHPG_SVC_LVL_CD   = FCSLR.SHPG_SVC_LVL_CD
            AND FCSLR.LINE_BIZ_TP_CD  = #lineBizTpCd#
            <isNotNull property="frtCondCd">
                AND FCSLR.FRT_COND_CD = #frtCondCd#
            </isNotNull>
            AND FCSLR.EZCANCELFLAG    = '0'
        GROUP BY
            SSL.SHPG_SVC_LVL_CD
           ,SSL.SHPG_SVC_LVL_DESC_TXT
           ,SSL.SHPG_SVC_LVL_SORT_NUM
        ORDER BY
            SSL.SHPG_SVC_LVL_SORT_NUM
    </statement>

    <statement id="getDsOrdLineCatgList" parameterClass="Map" resultClass="Map">
        SELECT
            PD.PRIM_LINE_CATG_FLG       AS PRIM_LINE_CATG_FLG
           ,C.DS_ORD_LINE_CATG_CD       AS DS_ORD_LINE_CATG_CD
           ,C.DS_ORD_LINE_CATG_DESC_TXT AS DS_ORD_LINE_CATG_DESC_TXT
        FROM
            DS_ORD_LINE_PROC_DFN PD
           ,DS_ORD_LINE_CATG C
        WHERE
            PD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND PD.ACTV_FLG     = 'Y'
            AND PD.EFF_FROM_DT  &lt;= #effDt#
            AND NVL(PD.EFF_THRU_DT, '99991231') &gt;= #effDt#
            AND PD.EZCANCELFLAG = '0'

            AND PD.GLBL_CMPY_CD        = C.GLBL_CMPY_CD
            AND PD.DS_ORD_LINE_CATG_CD = C.DS_ORD_LINE_CATG_CD
            AND C.DS_ORD_LINE_DRCTN_CD = #dsOrdLineDrctnCd#
            AND C.EZCANCELFLAG         = '0'
        ORDER BY
            C.DS_ORD_LINE_CATG_SORT_NUM
    </statement>

    <statement id ="getCtacPsnTpList" parameterClass="Map"  resultClass="Map">
        SELECT
             CT.CTAC_TP_CD
            ,CT.CTAC_TP_DESC_TXT
            ,CT.CTAC_CUST_REF_TP_CD
        FROM
            CTAC_TP              CT
        WHERE
            CT.EZCANCELFLAG       = '0'
            AND CT.GLBL_CMPY_CD   = #glblCmpyCd#
            AND CT.ACTV_FLG       = #actvFlg#
    </statement>

    <statement id="getOrdLineSrcList" parameterClass="Map" resultClass="Map">
        SELECT
            OLS.ORD_LINE_SRC_CD
           ,OLS.ORD_LINE_SRC_NM
        FROM
            ORD_LINE_SRC OLS
        WHERE
            OLS.GLBL_CMPY_CD     = #glblCmpyCd#
            AND OLS.EZCANCELFLAG = '0'
        ORDER BY
            OLS.ORD_LINE_SRC_SORT_NUM
    </statement>

    <statement id="getCustAddlInfo" parameterClass="Map" resultClass="Map">
        SELECT
            PD.DEF_BILL_TO_CUST_CD      AS DEF_BILL_TO_CUST_CD
           ,PD.LINE_BIZ_TP_CD           AS LINE_BIZ_TP_CD
           ,PD.DEF_SHPG_SVC_LVL_CD      AS DEF_SHPG_SVC_LVL_CD
           ,PD.DROP_SHIP_AVAL_FLG       AS DROP_SHIP_AVAL_FLG
           ,PD.FRT_COND_CD              AS FRT_COND_CD
           ,FC.FRT_COND_DESC_TXT        AS FRT_COND_DESC_TXT
           ,PC.PRC_CATG_CD              AS PRC_CATG_CD
           ,PC.PRC_CATG_NM              AS PRC_CATG_NM
           ,CSL.CARR_SVC_LVL_DESC_TXT   AS CARR_SVC_LVL_DESC_TXT
        FROM
            DS_ORD_TP_PROC_DFN PD
           ,FRT_COND           FC
           ,PRC_CATG           PC
           ,CARR_SVC_LVL       CSL
        WHERE
            PD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND PD.ACTV_FLG     = 'Y'
            AND PD.EFF_FROM_DT  &lt;= #slsDt#
            AND NVL(PD.EFF_THRU_DT, '99991231') &gt;= #slsDt#
            AND PD.EZCANCELFLAG = '0'

            AND PD.GLBL_CMPY_CD     = FC.GLBL_CMPY_CD (+)
            AND PD.FRT_COND_CD      = FC.FRT_COND_CD (+)
            AND FC.EZCANCELFLAG (+) = '0'

            AND PD.GLBL_CMPY_CD     = PC.GLBL_CMPY_CD (+)
            AND PD.DEF_PRC_CATG_CD  = PC.PRC_CATG_CD (+)
            AND PC.EZCANCELFLAG (+) = '0'

            AND PD.GLBL_CMPY_CD        = CSL.GLBL_CMPY_CD (+)
            AND PD.DEF_CARR_SVC_LVL_CD = CSL.CARR_SVC_LVL_CD (+)
            AND CSL.EZCANCELFLAG (+)   = '0'
    </statement>

    <statement id="getPmtTermCashDiscCd" parameterClass="Map" resultClass="String">
        SELECT
            PMT_TERM_CASH_DISC_CD
        FROM
            (
             SELECT
                 PTCD.PMT_TERM_CASH_DISC_CD
             FROM
                 PMT_TERM_CASH_DISC PTCD
             WHERE
                 PTCD.GLBL_CMPY_CD                    = #glblCmpyCd#
                 AND PTCD.PMT_TERM_CASH_DISC_DESC_TXT = #pmtTermCashDiscDescTxt#
                 AND PTCD.EZCANCELFLAG                = '0'
             ORDER BY
                 PTCD.PMT_TERM_CASH_DISC_SORT_NUM
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getPmtTermCashDiscCdForBillToCust" parameterClass="Map" resultClass="String">
        SELECT
            PMT_TERM_CASH_DISC_CD
        FROM
            (
             SELECT
                 CCP.PMT_TERM_CASH_DISC_CD
             FROM
                 CUST_CR_PRFL CCP
             WHERE
                 CCP.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND CCP.BILL_TO_CUST_CD = #billToCustCd#
                 AND CCP.EZCANCELFLAG    = '0'

             ORDER BY
                 CCP.BILL_TO_CUST_PK DESC
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getCarrSvcLvlCd" parameterClass="Map" resultClass="String">
        SELECT
            CARR_SVC_LVL_CD
        FROM
            (
             SELECT 
                 CSL.CARR_SVC_LVL_CD
             FROM
                 CARR_SVC_LVL CSL
             WHERE
                 CSL.GLBL_CMPY_CD                     = #glblCmpyCd#
                 AND UPPER(CSL.CARR_SVC_LVL_DESC_TXT) = UPPER(#carrSvcLvlDescTxt#)
                 AND CSL.EZCANCELFLAG                 = '0'
             ORDER BY
                 CSL.CARR_SVC_LVL_SORT_NUM
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getCarrSvcLvlTxt" parameterClass="Map" resultClass="String">
        SELECT
            CARR_SVC_LVL_DESC_TXT
        FROM
            (
             SELECT 
                 CSL.CARR_SVC_LVL_DESC_TXT
             FROM
                 SHPG_SVC_LVL_CARR_RELN SSLCR
                ,CARR_SVC_LVL           CSL
             WHERE
                 SSLCR.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND SSLCR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                 AND SSLCR.CARR_CD         = #carrCd#
                 AND SSLCR.EZCANCELFLAG    = '0'

                 AND SSLCR.GLBL_CMPY_CD    = CSL.GLBL_CMPY_CD
                 AND SSLCR.CARR_SVC_LVL_CD = CSL.CARR_SVC_LVL_CD
                 AND CSL.EZCANCELFLAG      = '0'
             ORDER BY
                 SSLCR.CARR_SVC_LVL_CD DESC
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getPkgUomInfoList" parameterClass="Map" resultClass="Map">
        SELECT
            PU1.PKG_UOM_CD AS PKG_UOM_CD
           ,DECODE(PU2.PKG_UOM_DESC_TXT, null, PU1.PKG_UOM_DESC_TXT, PU2.PKG_UOM_DESC_TXT) AS PKG_UOM_DESC_TXT
        FROM
            MDSE_STORE_PKG MSP
           ,PKG_UOM PU1
           ,PKG_UOM PU2
        WHERE
            MSP.GLBL_CMPY_CD     = #glblCmpyCd#
            AND MSP.MDSE_CD      = #mdseCd#
            AND MSP.EZCANCELFLAG = '0'

            AND MSP.GLBL_CMPY_CD = PU1.GLBL_CMPY_CD
            AND MSP.PKG_UOM_CD   = PU1.PKG_UOM_CD
            AND PU1.EZCANCELFLAG  = '0'

            AND MSP.GLBL_CMPY_CD    = PU2.GLBL_CMPY_CD (+)
            AND MSP.BASE_PKG_UOM_CD = PU2.PKG_UOM_CD (+)
            AND PU2.EZCANCELFLAG (+) = '0'
        ORDER BY
            PU1.PKG_UOM_SORT_NUM
    </statement>

    <statement id="getFrtCondCd" parameterClass="Map" resultClass="String">
        SELECT
            FRT_COND_CD
        FROM
            (
             SELECT 
                 FC.FRT_COND_CD
             FROM
                 FRT_COND FC
             WHERE
                 FC.GLBL_CMPY_CD          = #glblCmpyCd#
                 AND FC.FRT_COND_DESC_TXT = #frtCondDescTxt#
                 AND FC.EZCANCELFLAG      = '0'
             ORDER BY
                 FC.FRT_COND_SORT_NUM
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getRtlWhCd" parameterClass="Map" resultClass="String">
        SELECT
            RTL_WH_CD
        FROM
            (
             SELECT 
                 RW.RTL_WH_CD
             FROM
                 RTL_WH RW
             WHERE
                 RW.GLBL_CMPY_CD     = #glblCmpyCd#
                 AND RW.RTL_WH_NM    = #rtlWhNm#
                 AND RW.EZCANCELFLAG = '0'
             ORDER BY
                 RW.RTL_WH_CD
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getRtlSubWhCd" parameterClass="Map" resultClass="String">
        SELECT
            RTL_SWH_CD
        FROM
            (
             SELECT 
                 RSW.RTL_SWH_CD
             FROM
                 RTL_SWH RSW
             WHERE
                 RSW.GLBL_CMPY_CD     = #glblCmpyCd#
                 AND RSW.RTL_WH_CD    = #rtlWhCd#
                 AND RSW.RTL_SWH_NM   = #rtlSwhNm#
                 AND RSW.EZCANCELFLAG = '0'
             ORDER BY
                 RSW.RTL_SWH_CD
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getReportOutputLogList" parameterClass="Map" resultClass="Map">
        SELECT
            ROL.SPLY_QUOTE_RPT_OTPT_LOG_PK         AS SPLY_QUOTE_RPT_OTPT_LOG_PK
           ,TO_CHAR(TO_TIMESTAMP(ROL.SPLY_QUOTE_RPT_OTPT_TS, 'YYYYMMDDHH24MISSFF3')
                        , 'MM/DD/YYYY HH24:MI:SS') AS SPLY_QUOTE_RPT_OTPT_TS
           ,RT.SPLY_QUOTE_RPT_TP_DESC_TXT          AS SPLY_QUOTE_RPT_TP_DESC_TXT
        FROM
            SPLY_QUOTE_RPT_OTPT_LOG ROL
           ,SPLY_QUOTE_RPT_TP       RT
        WHERE
            ROL.GLBL_CMPY_CD       = #glblCmpyCd#
            AND ROL.SPLY_QUOTE_NUM = #splyQuoteNum#
            AND ROL.EZCANCELFLAG   = '0'

            AND ROL.GLBL_CMPY_CD         = RT.GLBL_CMPY_CD
            AND ROL.SPLY_QUOTE_RPT_TP_CD = RT.SPLY_QUOTE_RPT_TP_CD
            AND RT.EZCANCELFLAG          = '0'
        ORDER BY
            ROL.SPLY_QUOTE_RPT_OTPT_LOG_PK DESC
    </statement>

    <statement id="getShpgSvcLvlDataList" parameterClass="Map" resultClass="Map">
        SELECT 
            SSL.SHPG_SVC_LVL_CD
            ,SSL.SHPG_SVC_LVL_DESC_TXT
            ,SSL.SHPG_SVC_LVL_SORT_NUM
        FROM 
            SHPG_SVC_LVL            SSL
            ,FRT_COND_SVC_LVL_RELN  FCSLR
        WHERE
                SSL.GLBL_CMPY_CD        = #glblCmpyCd#
            AND SSL.GLBL_CMPY_CD        = FCSLR.GLBL_CMPY_CD
            AND SSL.SHPG_SVC_LVL_CD     = FCSLR.SHPG_SVC_LVL_CD
            AND FCSLR.LINE_BIZ_TP_CD    = #lineBizTpCd#
            <isNotNull property="frtCondCd">
                AND FCSLR.FRT_COND_CD   = #frtCondCd#
            </isNotNull>
            AND SSL.EZCANCELFLAG        = '0'
            AND FCSLR.EZCANCELFLAG      = '0'
        GROUP BY
            SSL.SHPG_SVC_LVL_CD
            ,SSL.SHPG_SVC_LVL_DESC_TXT
            ,SSL.SHPG_SVC_LVL_SORT_NUM
        ORDER BY
            SSL.SHPG_SVC_LVL_SORT_NUM
    </statement>

    <statement id="getPmtTermList" parameterClass="Map" resultClass="Map">
         SELECT
             PTCD.PMT_TERM_CASH_DISC_CD
            ,PTCD.PMT_TERM_CASH_DISC_DESC_TXT
            ,PTCD.PMT_CC_FLG
         FROM
             PMT_TERM_CASH_DISC PTCD
         WHERE
                 PTCD.GLBL_CMPY_CD                = #glblCmpyCd#
             AND PTCD.PMT_TERM_CASH_DISC_DESC_TXT LIKE #pmtTermCashDiscDescTxt#
             AND PTCD.EZCANCELFLAG                = '0'
             AND ROWNUM                       &lt;= 2  <!-- 2018/10/26 QC#28870 Add -->
    </statement>
    
    <statement id="getPmtTerm" parameterClass="Map" resultClass="Map">
        SELECT
            PMT_TERM_CASH_DISC_CD
           ,PMT_CC_FLG
        FROM
            (
             SELECT
                 PTCD.PMT_TERM_CASH_DISC_CD
                ,PTCD.PMT_CC_FLG
             FROM
                 PMT_TERM_CASH_DISC PTCD
             WHERE
                 PTCD.GLBL_CMPY_CD                    = #glblCmpyCd#
                 AND PTCD.PMT_TERM_CASH_DISC_DESC_TXT = #pmtTermCashDiscDescTxt#
                 AND PTCD.EZCANCELFLAG                = '0'
             ORDER BY
                 PTCD.PMT_TERM_CASH_DISC_SORT_NUM
            )
        WHERE
            ROWNUM = 1
    </statement>

    <!-- START 2017/10/31 H.Sugawara [QC#18787(Sol#232),ADD] -->
    <statement id="getDefaultDaysValid" parameterClass="Map" resultClass="Map">
        SELECT
                OCBC.FIRST_BIZ_CTX_ATTRB_TXT
        FROM
                ORD_CATG_BIZ_CTX OCBC
        WHERE
                OCBC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND OCBC.EZCANCELFLAG             = '0'
            AND OCBC.ORD_CATG_CTX_TP_CD       = #ordCatgCtxTpCd#
            AND
            (
               (    OCBC.DS_ORD_CATG_CD       = #dsOrdCatgCd#
                AND OCBC.DS_ORD_TP_CD         IS NULL
                AND OCBC.DS_ORD_RSN_CD        IS NULL)
              OR
               (    OCBC.DS_ORD_CATG_CD       = #dsOrdCatgCd#
                AND OCBC.DS_ORD_TP_CD         = #dsOrdTpCd#
                AND OCBC.DS_ORD_RSN_CD        IS NULL)
            )
    </statement>
    <!-- END 2017/10/31 H.Sugawara [QC#18787(Sol#232),ADD] -->
    <!-- QC#16452 add End -->
    <!-- QC#22965 Add Start -->
    <statement id="getInPondWt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                  IN_POUND_WT
        FROM (
            SELECT
                      P.IN_POUND_WT 
                FROM
                      ALL_MDSE_V M
                    , MDSE_STORE_PKG P 
                WHERE
                    M.GLBL_CMPY_CD     = #glblCmpyCd#
                    AND M.MDSE_CD      = #mdseCd#
                    AND M.EZCANCELFLAG = '0' 
                    AND M.GLBL_CMPY_CD = P.GLBL_CMPY_CD 
                    AND M.MDSE_CD      = P.MDSE_CD 
                    AND P.EZCANCELFLAG = '0'
            UNION ALL
            SELECT
                      P.IN_POUND_WT 
                FROM
                      ALL_MDSE_V M
                    , ORD_TAKE_MDSE O
                    , MDSE_STORE_PKG P 
                WHERE
                    M.GLBL_CMPY_CD     = #glblCmpyCd#
                    AND M.MDSE_CD      = #mdseCd#
                    AND M.EZCANCELFLAG = '0' 
                    AND M.GLBL_CMPY_CD = O.GLBL_CMPY_CD 
                    AND M.MDSE_CD      = O.ORD_TAKE_MDSE_CD 
                    AND O.EZCANCELFLAG = '0'
                    AND O.GLBL_CMPY_CD = P.GLBL_CMPY_CD 
                    AND O.MDSE_CD      = P.MDSE_CD 
                    AND P.EZCANCELFLAG = '0'
        )
        WHERE ROWNUM = 1
    </statement>
    <!-- QC#22965 Add End -->
    <!-- QC#30287 Add Start -->
    <!-- Get the maximum value including the logically deleted record -->
    <statement id="getMaxLineNum" parameterClass="Map" resultClass="String">
        SELECT
                 MAX(SQD.SPLY_QUOTE_DTL_LINE_NUM)
        FROM
                 SPLY_QUOTE_DTL SQD
        WHERE
                 SQD.GLBL_CMPY_CD   = #glblCmpyCd#
             AND SQD.SPLY_QUOTE_NUM = #splyQuoteNum#
        GROUP BY
                 SQD.SPLY_QUOTE_NUM
    </statement>
    <!-- QC#30287 Add End -->

    <!-- START 2023/07/20 T.Fukuta [CSA-QC#61467,ADD] -->
    <statement id="getOrderContractByShipToCust" parameterClass="Map" resultClass="Map">
        SELECT
            DCD.DS_CONTR_DTL_PK
           ,DCD.SVC_PGM_MDSE_CD
           ,DCD.SVC_MACH_MSTR_PK
           ,SMM.SER_NUM
           ,DC.DS_CONTR_NUM
        FROM
            DS_CONTR_DTL DCD
           ,DS_CONTR DC
           ,SVC_MACH_MSTR SMM
        WHERE
                DCD.GLBL_CMPY_CD      = #glblCmpyCd#
            AND DCD.EZCANCELFLAG      = '0'
            AND EXISTS(
                SELECT
                    1
                FROM
                    SVC_MACH_MSTR SMM
                WHERE
                        SMM.GLBL_CMPY_CD     = #glblCmpyCd#
                    AND SMM.EZCANCELFLAG     = '0'
                    AND SMM.CUR_LOC_NUM      = #shipToCustCd#
                    AND SMM.SVC_MACH_TP_CD   = #svcMachTpCd#
                    AND DCD.GLBL_CMPY_CD     = SMM.GLBL_CMPY_CD
                    AND DCD.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK
            )
            AND DCD.GLBL_CMPY_CD = DC.GLBL_CMPY_CD
            AND DC.EZCANCELFLAG = '0'
            AND DCD.DS_CONTR_PK = DC.DS_CONTR_PK
            AND DCD.GLBL_CMPY_CD = SMM.GLBL_CMPY_CD
            AND SMM.EZCANCELFLAG = '0'
            AND DCD.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK
            AND DCD.CONTR_EFF_FROM_DT &lt;= #slsDt#
            AND NVL(DCD.CONTR_CLO_DT, DCD.CONTR_EFF_THRU_DT) &gt;= #slsDt#
            <!-- START 2024/04/01 T.Fukuta [QC#63548,ADD] -->
            AND (DCD.MAN_TRMN_TP_CD IS NULL OR DCD.MAN_TRMN_TP_CD &lt;&gt; #manTrmnTpCd#)
            <!-- END 2024/04/01 T.Fukuta [QC#63548,ADD] -->
    </statement>

    <statement id="getMdseCdBySvcMachMstrPk" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            DMSR.MDSE_CD
           ,DMSR.ORD_TAKE_MDSE_CD
        FROM
            DS_MDL_SPLY_RELN DMSR
        WHERE
                DMSR.GLBL_CMPY_CD = #glblCmpyCd#
            AND DMSR.EZCANCELFLAG = '0'
            AND DMSR.MDL_ID IN (
                SELECT
                    SCM.MDL_ID
                FROM
                    SVC_MACH_MSTR      SMM
                   ,SVC_CONFIG_MSTR    SCM
                WHERE
                        SMM.GLBL_CMPY_CD       = #glblCmpyCd#
                    AND SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD
                    AND SMM.EZCANCELFLAG       = '0'
                    AND SCM.EZCANCELFLAG       = '0'
                    AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK
                    AND SMM.SVC_MACH_MSTR_PK   = #svcMachMstrPk#
            )
	</statement>
    <!-- END 2023/07/20 T.Fukuta [CSA-QC#61467,ADD] -->
</sqlMap>
