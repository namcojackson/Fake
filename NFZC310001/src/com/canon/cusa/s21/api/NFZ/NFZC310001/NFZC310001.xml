<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NFZC310001">

    <statement id="getArBatRcptInfo" parameterClass="Map" resultClass="Map">
        SELECT
              ABR.AR_BAT_RCPT_NM
            , ABR.AR_BAT_RCPT_STS_CD
            , ABR.AR_BAT_RCPT_AMT
            , ABR.AR_BAT_RCPT_CNT
            <!-- START 2019/07/16 [QC#51515, MOD] -->
<!--        , SUM(AR.DEAL_NET_RCPT_AMT) AS TOT_DEAL_NET_RCPT_AMT -->
            , NVL(SUM(AR.DEAL_NET_RCPT_AMT), 0) AS TOT_DEAL_NET_RCPT_AMT
            <!-- START 2019/07/16 [QC#51515, MOD] -->
            , COUNT(AR.AR_BAT_RCPT_NM) AS RCPT_CNT
            , SUM(CASE WHEN AR.AR_CASH_APPLY_STS_CD IN (#arCashApplyStsUnapplied#, #arCashApplyStsUnidentified#, #arCashApplyStsPartial#) THEN 1 ELSE 0 END) AS UN_APPPLY_RCPT_CNT
        FROM
              AR_BAT_RCPT ABR
            , AR_RCPT     AR
        WHERE
              ABR.GLBL_CMPY_CD     = #glblCmpyCd#
          AND ABR.AR_BAT_RCPT_NM   = #arBatRcptNm#
          AND ABR.EZCANCELFLAG     = '0'
          <!-- START 2019/07/16 [QC#51515, MOD] -->
<!--          
          AND ABR.GLBL_CMPY_CD     = AR.GLBL_CMPY_CD
          AND ABR.AR_BAT_RCPT_NM   = AR.AR_BAT_RCPT_NM
          AND AR.EZCANCELFLAG      = '0'
 -->
          AND ABR.GLBL_CMPY_CD            = AR.GLBL_CMPY_CD(+)
          AND ABR.AR_BAT_RCPT_NM          = AR.AR_BAT_RCPT_NM(+)
          AND AR.AR_CASH_APPLY_STS_CD(+) != #arCashApplyStsVoid#
          AND AR.EZCANCELFLAG(+)          = '0'
          <!-- END 2019/07/16 [QC#51515, MOD] -->
        GROUP BY
              ABR.AR_BAT_RCPT_NM
            , ABR.AR_BAT_RCPT_STS_CD
            , ABR.AR_BAT_RCPT_AMT
            , ABR.AR_BAT_RCPT_CNT
    </statement>

</sqlMap>
