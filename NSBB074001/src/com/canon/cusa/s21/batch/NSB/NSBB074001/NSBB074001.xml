<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSBB074001">
    <statement id="getInputData" parameterClass="Map" resultClass="Map">
        SELECT
             C.T_MDL_NM                 AS T_MDL_NM
            ,(CASE WHEN A.CHILD_MDSE_CD  IS NULL
                   THEN A.PRNT_MDSE_CD
                   ELSE A.CHILD_MDSE_CD
              END)                      AS CHILD_MDSE_CD
            ,B.MDL_DESC_TXT             AS MDL_DESC_TXT
            ,(CASE WHEN A.CHILD_MDSE_CD  IS NULL
                   THEN D.MDSE_DESC_SHORT_TXT
                   ELSE E.MDSE_DESC_SHORT_TXT
              END)                      AS MDSE_DESC_SHORT_TXT
            ,(CASE WHEN A.CHILD_MDSE_CD  IS NULL
                   THEN D.LINE_BIZ_TP_CD
                   ELSE E.LINE_BIZ_TP_CD
              END)                      AS LINE_BIZ_TP_CD
            ,F.MDL_GRP_NM               AS MDL_GRP_NM
            ,F.MDL_GRP_DESC_TXT         AS MDL_GRP_DESC_TXT
            ,'00'                       AS FILL_2_TXT
            ,B.MTR_REQ_MDL_FLG          AS MTR_REQ_MDL_FLG
            ,(CASE WHEN (SELECT 
                             COUNT (*) 
                         FROM 
                              DS_MDL_MTR  DMM2
                             ,MTR_LB      ML
                         WHERE 
                                 B.GLBL_CMPY_CD      = DMM2.GLBL_CMPY_CD
                             AND B.MTR_GRP_PK        = DMM2.DS_MDL_MTR_PK
                             AND DMM2.GLBL_CMPY_CD   = ML.GLBL_CMPY_CD
                             AND DMM2.MDL_MTR_LB_CD  = ML.MTR_LB_CD
                             AND ML.TOT_MTR_FLG      = 'Y'
                             AND DMM2.EZCANCELFLAG   = '0'
                             AND ML.EZCANCELFLAG     = '0' )           &gt; 0
                   THEN 'Y'
                   ELSE 'N'
              END)                      AS TOT_MTR_FLG
        FROM
             DS_MDL_CONFIG              A
            ,DS_MDL                     B
            ,MDL_NM                     C
            ,ALL_MDSE_V                 D
            ,ALL_MDSE_V                 E
            ,DS_MDL_GRP                 F
        WHERE
                A.GLBL_CMPY_CD          = #glblCmpyCd#
            AND A.GLBL_CMPY_CD          = B.GLBL_CMPY_CD
            AND A.MDL_ID                = B.MDL_ID
            AND B.GLBL_CMPY_CD          = C.T_GLBL_CMPY_CD
            AND B.MDL_ID                = C.T_MDL_ID
            AND A.GLBL_CMPY_CD          = D.GLBL_CMPY_CD(+)
            AND A.PRNT_MDSE_CD          = D.MDSE_CD(+)
            AND A.GLBL_CMPY_CD          = E.GLBL_CMPY_CD(+)
            AND A.CHILD_MDSE_CD         = E.MDSE_CD(+)
            AND B.GLBL_CMPY_CD          = F.GLBL_CMPY_CD
            AND B.MDL_GRP_ID            = F.MDL_GRP_ID
            AND A.EZCANCELFLAG          = '0'
            AND B.EZCANCELFLAG          = '0'
            AND C.EZCANCELFLAG          = '0'
            AND D.EZCANCELFLAG(+)       = '0'
            AND E.EZCANCELFLAG(+)       = '0'
            AND F.EZCANCELFLAG          = '0'
        ORDER BY
            C.T_MDL_NM
    </statement>
</sqlMap>
