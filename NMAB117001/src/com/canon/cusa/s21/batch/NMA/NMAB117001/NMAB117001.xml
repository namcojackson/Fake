<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB117001">

    <statement id="getTrgtDtRec" parameterClass="Map" resultClass="BigDecimal">
        SELECT COUNT(1)
        FROM
            DMN_ACCT_LOC             LOC
        WHERE 
            LOC.GLBL_CMPY_CD         = #glblCmpyCd#
        AND LOC.DWH_TRGT_DT          = #trgtDt#
        AND LOC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getMainData" parameterClass="Map" resultClass="Map">
        SELECT
             DA.LOC_NUM
            ,SUBSTR(DA.EZINTIME, 0, #substrDtLngth#) AS ACCT_CRAT_DT
            ,DA.EZINUSERID                           AS ACCT_CRAT_USR_ID
            ,SPA.PSN_FIRST_NM || SPA.PSN_LAST_NM     AS ACCT_CRAT_USR_NM
            ,SPA.LINE_BIZ_TP_CD                      AS ACCT_CRAT_LINE_BIZ_TP_CD
            ,DA.DS_ACCT_NUM
            ,DA.DS_ACCT_NM
            ,DA.DS_ACCT_TP_CD
            ,DAT.DS_ACCT_TP_DESC_TXT                 AS DS_ACCT_TP_DESC_TXT
            ,NVL(DA.DS_ACCT_ITRL_FLG,'N')            AS DS_ACCT_ITRL_FLG
            ,DA.DS_ACCT_CLS_CD
            ,DAC.DS_ACCT_CLS_DESC_TXT                AS DS_ACCT_CLS_DESC_TXT
            ,DA.COA_CH_CD                            AS ACCT_COA_CH_CD
            ,CCA.COA_CH_DESC_TXT                     AS ACCT_COA_CH_DESC_TXT
            ,DA.COA_AFFL_CD                          AS ACCT_COA_AFFL_CD
            ,CAA.COA_AFFL_DESC_TXT                   AS ACCT_COA_AFFL_DESC_TXT
            ,DA.DS_ACCT_DLR_CD
            ,DAD.DS_ACCT_DLR_DESC_TXT                AS DS_ACCT_DLR_DESC_TXT
            ,DA.DS_ACCT_LEGAL_NM
            ,DA.DBA_NM
            ,DA.DS_ACCT_ALT_NM
            ,DA.RGTN_STS_CD
            ,RS.RGTN_STS_DESC_TXT                    AS RGTN_STS_DESC_TXT
            ,DA.DS_ACCT_URL
            ,DA.DS_ACCT_DUNS_NUM
            ,DA.DS_ULT_DUNS_NUM
            ,DA.DS_ACCT_DUNS_NM
            ,DA.DS_LAST_UPD_DUNS_DT
            ,DA.DS_LOC_EMP_NUM
            ,NVL(DA.DS_LOC_REV_AMT, 0)               AS DS_LOC_REV_AMT
            ,DA.DS_CUST_SIC_CD
            ,DA.DS_XTRNL_REF_TXT
            ,DA.DS_DATA_SRC_TXT
            ,DA.DS_CUST_SIC_DESC_TXT
            ,DACP.CCY_CD                             AS ACCT_CCY_CD
            ,DACP.CUST_CR_RTG_CD                     AS ACCT_CUST_CR_RTG_CD
            ,CCRA.CUST_CR_RTG_DESC_TXT               AS ACCT_CUST_CR_RTG_DESC_TXT
            ,DACP.CR_LIMIT_AMT                       AS ACCT_CR_LIMIT_AMT
            ,DACP.CR_CHK_REQ_TP_CD                   AS ACCT_CR_CHK_REQ_TP_CD
            ,CCRTA.CR_CHK_REQ_TP_DESC_TXT            AS ACCT_CR_CHK_REQ_DESC_TXT
            ,DACP.CR_RISK_CLS_CD                     AS ACCT_CR_RISK_CLS_CD
            ,CRCA.CR_RISK_CLS_DESC_TXT               AS ACCT_CR_RISK_CLS_DESC_TXT
            ,CRCA.GRACE_PER_DAYS_AOT                 AS ACCT_GRACE_PER_DAYS_AOT
            ,DACP.PMT_TERM_CASH_DISC_CD              AS ACCT_PMT_TERM_CASH_DISC_CD
            ,NVL(DACP.OVRD_PMT_TERM_FLG, 'N')        AS ACCT_OVRD_PMT_TERM_FLG
            ,NVL(DACP.CASH_OR_CC_REQ_FLG, 'N')       AS ACCT_CASH_OR_CC_REQ_FLG
            ,NVL(DACP.CUST_HARD_HLD_FLG, 'N')        AS ACCT_CUST_HARD_HLD_FLG
            ,NVL(DA.AR_STMT_FLG, 'N')                AS ACCT_STMT_FLG
            ,DA.AR_STMT_ISS_DAY
            ,DA.CLT_CUST_TP_CD
            ,CP.CLT_PTFO_PK
            ,CP.CLT_PTFO_CD
            ,CP.CLT_PTFO_NM
            ,CP.CLT_PTFO_DESC_TXT
            ,CP.CLT_PTFO_COR_NM
            ,CP.CLT_PSN_CD
            ,CP.CLT_PSN_NM
            ,CP.CLT_STMT_PHO_NUM
            ,CP.CLT_STMT_FAX_NUM
            ,CP.AR_ADJ_TP_CD
            ,AAT.AR_ADJ_TP_DESC_TXT
            ,NVL(CP.WRITE_OFF_APVL_LIMIT_AMT, 0)     AS WRITE_OFF_APVL_LIMIT_AMT
            ,CP.CLT_CR_ANLST_EQUIP_PSN_CD
            ,CP.CLT_CR_ANLST_EQUIP_PSN_NM
            ,CP.CLT_CR_ANLST_SVC_PSN_CD
            ,CP.CLT_CR_ANLST_SVC_PSN_NM
            ,CP.CLT_CR_ANLST_SPLY_PSN_CD
            ,CP.CLT_CR_ANLST_SPLY_PSN_NM
            ,CP.REL_CLT_PTFO_PK
            ,NVL(CP.CLT_PTFO_STS_FLG, 'N')           AS CLT_PTFO_STS_FLG
            ,DA.DS_CLT_ACCT_STS_CD
            ,DCAS.DS_CLT_ACCT_STS_DESC_TXT
            ,NVL(DA.LATE_FEE_FLG, 'N')               AS LATE_FEE_FLG
            ,NVL(DA.LATE_FEE_AMT, 0)                 AS LATE_FEE_AMT
            ,DA.DS_CUST_TAX_CD                       AS ACCT_DS_CUST_TAX_CD
            ,DA.DS_CUST_TAX_CALC_CD                  AS ACCT_DS_CUST_TAX_CALC_CD
            ,DCTC.DS_CUST_TAX_CALC_DESC_TXT          AS ACCT_DS_TAX_CALC_DESC_TXT
            ,NVL(DA.DS_TAX_EXEM_FLG,'N')             AS ACCT_DS_TAX_EXEM_FLG
            ,DA.DS_TAX_GRP_EXEM_CD                   AS ACCT_DS_TAX_GRP_EXEM_CD
            ,DTGEA.DS_TAX_GRP_EXEM_DESC_TXT          AS ACCT_TAX_GRP_EXEM_DESC_TXT
            ,DA.DS_EXEM_EXPR_DT                      AS ACCT_DS_EXEM_EXPR_DT
            ,DA.DS_TAX_PRNT_TP_CD                    AS ACCT_DS_TAX_PRNT_TP_CD
            ,CASE
               WHEN DA.PRIN_CUST_PK IS NOT NULL
               THEN 'Y'
               ELSE 'N'
               END                                          AS PRIN_CUST_FLG
            ,SUBSTR(DA.LOC_CRAT_DT, 0, #substrDtLngth#)     AS LOC_CRAT_DT
            ,DA.LOC_CRAT_USR_ID                             AS LOC_CRAT_USR_ID
            ,SPL.LINE_BIZ_TP_CD                             AS LOC_CRAT_LINE_BIZ_TP_CD
            ,SUBSTR(DA.LOC_LAST_UPD_DT, 0, #substrDtLngth#) AS LOC_LAST_UPD_DT
            ,DA.LOC_LAST_UPD_USR_ID                         AS LOC_LAST_UPD_USR_ID
            ,DA.LOC_EFF_FROM_DT                             AS LOC_EFF_FROM_DT
            ,DA.LOC_EFF_THRU_DT                             AS LOC_EFF_THRU_DT
            ,CASE
               WHEN DA.LOC_ACTV_FLG = #rgtnStsCd#
               THEN 'Y'
               ELSE 'N'
               END                                   AS LOC_ACTV_FLG
            ,DA.FIRST_LINE_ADDR
            ,DA.SCD_LINE_ADDR
            ,DA.THIRD_LINE_ADDR
            ,DA.FRTH_LINE_ADDR
            ,DA.CTY_ADDR
            ,CN.CNTY_NM
            ,DA.CNTY_PK
            ,DA.PROV_NM
            ,DA.ST_CD
            ,DA.POST_CD
            ,DA.CTRY_CD
            ,DA.DS_LOC_NM                           AS DS_LOC_NM
            ,DA.ADDL_LOC_NM
            ,DA.GLN_NUM
            ,DA.TEL_NUM
            ,DA.FAX_NUM
            ,DA.LINE_BIZ_TP_CD
            ,DA.LOC_GEO_CD
            ,NVL(DA.LOC_DS_INSD_CTY_LIMIT_FLG, 'N') AS LOC_DS_INSD_CTY_LIMIT_FLG
            ,DA.LOC_DUNS_NUM
            ,DA.LOC_HQ_DUNS_NUM
            ,DA.LOC_DS_ULT_DUNS_NUM
            ,DA.LOC_DS_PRNT_DUNS_NUM
            ,DA.LOC_DS_LOC_EMP_NUM
            ,NVL(DA.LOC_DS_LOC_REV_AMT, 0)          AS LOC_DS_LOC_REV_AMT
            ,DA.LOC_DS_LAST_UPD_DUNS_DT
            ,DA.LOC_DS_CUST_SIC_CD
            ,DA.LOC_DS_CUST_SIC_DESC_TXT
            ,DA.LOC_DUNS_TRADE_STYLE_NM
            ,DA.LOC_DUNS_ACTV_CD
            ,DA.LOC_DUNS_LINE_ADDR
            ,DA.LOC_DUNS_BIZ_NM
            ,DA.LOC_DS_LAST_RCV_DUNS_TXT
            ,DA.LOC_DS_LAST_RCV_DUNS_DT
            ,DA.LOC_DUNS_SEND_CNT
            ,BTC.BILL_TO_CUST_CD
            ,BTC.EFF_FROM_DT                         AS BILL_EFF_FROM_DT
            ,BTC.EFF_THRU_DT                         AS BILL_EFF_THRU_DT
            ,NVL(BTC.PRIM_USG_FLG, 'N')              AS BILL_PRIM_USG_FLG
            ,BTC.COA_CH_CD                           AS BILL_COA_CH_CD
            ,CCB.COA_CH_DESC_TXT                     AS BILL_COA_CH_DESC_TXT
            ,BTC.COA_AFFL_CD                         AS BILL_COA_AFFL_CD
            ,CAB.COA_AFFL_DESC_TXT                   AS BILL_COA_AFFL_DESC_TXT
            ,BTC.REM_ID                              AS BILL_REM_ID
            ,CCP.CCY_CD                              AS BILL_CCY_CD
            ,CCP.CUST_CR_RTG_CD                      AS BILL_CUST_CR_RTG_CD
            ,CCRB.CUST_CR_RTG_DESC_TXT               AS BILL_CUST_CR_RTG_DESC_TXT
            ,CCP.CR_LIMIT_AMT                        AS BILL_CR_LIMIT_AMT
            ,CCP.CR_CHK_REQ_TP_CD                    AS BILL_CR_CHK_REQ_TP_CD
            ,CCRTB.CR_CHK_REQ_TP_DESC_TXT            AS BILL_CR_CHK_REQ_DESC_TXT
            ,CCP.CR_RISK_CLS_CD                      AS BILL_CR_RISK_CLS_CD
            ,CRC.CR_RISK_CLS_DESC_TXT                AS BILL_CR_RISK_CLS_DESC_TXT
            ,CRC.GRACE_PER_DAYS_AOT                  AS BILL_GRACE_PER_DAYS_AOT
            ,CCP.PMT_TERM_CASH_DISC_CD               AS BILL_PMT_TERM_CASH_DISC_CD
            ,PTCDB.PMT_TERM_CASH_DISC_DESC_TXT       AS BILL_CASH_DISC_DESC_TXT
            ,NVL(CCP.OVRD_PMT_TERM_FLG, 'N')         AS BILL_OVRD_PMT_TERM_FLG
            ,NVL(CCP.CASH_OR_CC_REQ_FLG, 'N')        AS BILL_CASH_OR_CC_REQ_FLG
            ,NVL(CCP.CUST_HARD_HLD_FLG, 'N')         AS BILL_CUST_HARD_HLD_FLG
            ,NVL(BTC.AR_STMT_FLG, 'N')               AS BILL_AR_STMT_FLG
            ,BTC.AR_STMT_ISS_DAY                     AS BILL_AR_STMT_ISS_DAY
            ,BTC.CLT_CUST_TP_CD                      AS BILL_CLT_CUST_TP_CD
            ,CCTB.CLT_CUST_TP_DESC_TXT               AS BILL_CLT_CUST_TP_DESC_TXT
            ,BTC.CLT_PTFO_PK                         AS BILL_CLT_PTFO_PK
            ,BTC.DS_CLT_ACCT_STS_CD                  AS BILL_DS_CLT_ACCT_STS_CD
            ,NVL(BTC.LATE_FEE_FLG, 'N')              AS BILL_LATE_FEE_FLG
            ,NVL(BTC.LATE_FEE_AMT, 0)                AS BILL_LATE_FEE_AMT
            ,BTC.DS_CUST_TAX_CD                      AS BILL_DS_CUST_TAX_CD
            ,BTC.DS_CUST_TAX_CALC_CD                 AS BILL_DS_CUST_TAX_CALC_CD
            ,DCTCB.DS_CUST_TAX_CALC_DESC_TXT         AS BILL_TO_TAX_CALC_DESC_TXT
            ,NVL(BTC.DS_TAX_EXEM_FLG, 'N')           AS BILL_DS_TAX_EXEM_FLG
            ,BTC.DS_EXEM_EXPR_DT                     AS BILL_DS_EXEM_EXPR_DT
            ,BTC.DS_TAX_GRP_EXEM_CD                  AS BILL_DS_TAX_GRP_EXEM_CD
            ,DTGEB.DS_TAX_GRP_EXEM_DESC_TXT          AS BILL_TAX_GRP_EXEM_DESC_TXT
            ,BTC.DS_TAX_PRNT_TP_CD                   AS BILL_DS_TAX_PRNT_TP_CD
            ,DTRTB.DS_TAX_PRNT_TP_DESC_TXT           AS BILL_TAX_PRINT_TP_DESC_TXT
            ,STC.SHIP_TO_CUST_CD
            ,STC.EFF_FROM_DT                         AS SHIP_EFF_FROM_DT
            ,STC.EFF_THRU_DT                         AS SHIP_EFF_THRU_DT
            ,STC.RELN_BILL_TO_CUST_CD                AS SHIP_RELN_BILL_TO_CUST_CD
            ,NVL(STC.PRIM_USG_FLG, 'N')              AS SHIP_PRIM_USG_FLG
            ,STC.BIG_DEAL_NUM
            ,STC.COA_CH_CD                           AS SHIP_COA_CH_CD
            ,CCS.COA_CH_DESC_TXT                     AS SHIP_COA_CH_DESC_TXT
            ,STC.COA_AFFL_CD                         AS SHIP_COA_AFFL_CD
            ,CAS.COA_AFFL_DESC_TXT                   AS SHIP_COA_AFFL_DESC_TXT
            ,STC.DS_CUST_TAX_CD                      AS SHIP_DS_CUST_TAX_CD
            ,STC.DS_CUST_TAX_CALC_CD                 AS SHIP_DS_CUST_TAX_CALC_CD
            ,DCTCS.DS_CUST_TAX_CALC_DESC_TXT         AS SHIP_TAX_CALC_DESC_TXT
            ,NVL(STC.DS_TAX_EXEM_FLG, 'N')           AS SHIP_DS_TAX_EXEM_FLG
            ,STC.DS_EXEM_EXPR_DT                     AS SHIP_DS_EXEM_EXPR_DT
            ,STC.DS_TAX_GRP_EXEM_CD                  AS SHIP_DS_TAX_GRP_EXEM_CD
            ,DTGES.DS_TAX_GRP_EXEM_DESC_TXT          AS SHIP_TAX_GRP_EXEM_DESC_TXT
            ,STC.DS_TAX_PRNT_TP_CD                   AS SHIP_DS_TAX_PRNT_TP_CD
            ,DTPTS.DS_TAX_PRNT_TP_DESC_TXT           AS SHIP_TAX_PRINT_TP_DESC_TXT
        FROM
             S21_PSN            SPL
            ,(
            SELECT
                 STC.EZINTIME
                ,STC.EZINUSERID
                ,STC.SELL_TO_CUST_CD AS DS_ACCT_NUM
                ,STC.DS_ACCT_NM
                ,STC.DS_ACCT_TP_CD
                ,STC.DS_ACCT_ITRL_FLG
                ,STC.DS_ACCT_CLS_CD
                ,STC.COA_CH_CD
                ,STC.COA_AFFL_CD
                ,STC.DS_ACCT_DLR_CD
                ,STC.DS_ACCT_LEGAL_NM
                ,STC.DBA_NM
                ,STC.DS_ACCT_ALT_NM
                ,STC.RGTN_STS_CD
                ,STC.DS_ACCT_URL
                ,STC.DS_ACCT_DUNS_NUM
                ,STC.DS_ULT_DUNS_NUM
                ,STC.DS_ACCT_DUNS_NM
                ,STC.DS_LAST_UPD_DUNS_DT
                ,STC.DS_LOC_EMP_NUM
                ,STC.DS_LOC_REV_AMT
                ,STC.DS_CUST_SIC_CD
                ,STC.DS_XTRNL_REF_TXT
                ,STC.DS_DATA_SRC_TXT
                ,STC.DS_CUST_SIC_DESC_TXT
                ,STC.AR_STMT_FLG
                ,STC.AR_STMT_ISS_DAY
                ,STC.CLT_CUST_TP_CD
                ,STC.DS_CLT_ACCT_STS_CD
                ,STC.LATE_FEE_FLG
                ,STC.LATE_FEE_AMT
                ,STC.DS_CUST_TAX_CD
                ,STC.DS_CUST_TAX_CALC_CD
                ,STC.DS_TAX_EXEM_FLG
                ,STC.DS_TAX_GRP_EXEM_CD
                ,STC.DS_EXEM_EXPR_DT
                ,STC.DS_TAX_PRNT_TP_CD
                ,STC.GLBL_CMPY_CD
                ,STC.CLT_PTFO_PK
                ,STC.EZCANCELFLAG
                ,PLW.PTY_LOC_PK
                ,PLW.CNTY_PK
                ,PLW.FIRST_LINE_ADDR
                ,PLW.SCD_LINE_ADDR
                ,PLW.THIRD_LINE_ADDR
                ,PLW.FRTH_LINE_ADDR
                ,PLW.CTY_ADDR
                ,PLW.PROV_NM
                ,PLW.ST_CD
                ,PLW.POST_CD
                ,PLW.CTRY_CD
                ,PLW.DS_LOC_NM                           AS DS_LOC_NM
                ,PLW.ADDL_LOC_NM
                ,PLW.GLN_NUM
                ,PLW.TEL_NUM
                ,PLW.FAX_NUM
                ,PLW.LINE_BIZ_TP_CD
                ,PLW.GEO_CD                              AS LOC_GEO_CD
                ,PLW.DS_INSD_CTY_LIMIT_FLG               AS LOC_DS_INSD_CTY_LIMIT_FLG
                ,PLW.DUNS_NUM                            AS LOC_DUNS_NUM
                ,PLW.HQ_DUNS_NUM                         AS LOC_HQ_DUNS_NUM
                ,PLW.DS_ULT_DUNS_NUM                     AS LOC_DS_ULT_DUNS_NUM
                ,PLW.DS_PRNT_DUNS_NUM                    AS LOC_DS_PRNT_DUNS_NUM
                ,PLW.DS_LOC_EMP_NUM                      AS LOC_DS_LOC_EMP_NUM
                ,PLW.DS_LOC_REV_AMT                      AS LOC_DS_LOC_REV_AMT
                ,PLW.DS_LAST_UPD_DUNS_DT                 AS LOC_DS_LAST_UPD_DUNS_DT
                ,PLW.DS_CUST_SIC_CD                      AS LOC_DS_CUST_SIC_CD
                ,PLW.DS_CUST_SIC_DESC_TXT                AS LOC_DS_CUST_SIC_DESC_TXT
                ,PLW.DUNS_TRADE_STYLE_NM                 AS LOC_DUNS_TRADE_STYLE_NM
                ,PLW.DUNS_ACTV_CD                        AS LOC_DUNS_ACTV_CD
                ,PLW.DUNS_LINE_ADDR                      AS LOC_DUNS_LINE_ADDR
                ,PLW.DUNS_BIZ_NM                         AS LOC_DUNS_BIZ_NM
                ,PLW.DS_LAST_RCV_DUNS_TXT                AS LOC_DS_LAST_RCV_DUNS_TXT
                ,PLW.DS_LAST_RCV_DUNS_DT                 AS LOC_DS_LAST_RCV_DUNS_DT
                ,PLW.DUNS_SEND_CNT                       AS LOC_DUNS_SEND_CNT
                ,PC.PRIN_CUST_PK
                ,AL.LOC_NUM
                ,AL.EZINTIME                             AS LOC_CRAT_DT
                ,AL.EZINUSERID                           AS LOC_CRAT_USR_ID
                ,AL.EZUPTIME                             AS LOC_LAST_UPD_DT
                ,AL.EZUPUSERID                           AS LOC_LAST_UPD_USR_ID
                ,AL.EFF_FROM_DT                          AS LOC_EFF_FROM_DT
                ,AL.EFF_THRU_DT                          AS LOC_EFF_THRU_DT
                ,AL.RGTN_STS_CD                          AS LOC_ACTV_FLG
            FROM
                  SELL_TO_CUST STC
                , ACCT_LOC           AL
                , PTY_LOC_WRK        PLW
                , PRIN_CUST          PC
            WHERE
            	AL.GLBL_CMPY_CD            = #glblCmpyCd#
            AND AL.EFF_FROM_DT         &lt;= #trgtDt#
            AND (AL.EFF_THRU_DT        &gt;= #trgtDt#
                OR AL.EFF_THRU_DT            IS NULL)
            AND AL.EZCANCELFLAG = '0'
            
            AND AL.GLBL_CMPY_CD = STC.GLBL_CMPY_CD(+) 
            AND AL.DS_ACCT_NUM  = STC.SELL_TO_CUST_CD(+) 
            AND STC.RGTN_STS_CD(+)  IN (#dacRgtnStsCd1#, #dacRgtnStsCd2#)
            AND STC.EZCANCELFLAG(+) = '0'
            
            AND AL.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD(+)
            AND AL.PTY_LOC_PK              = PLW.PTY_LOC_PK(+)
            AND AL.EZCANCELFLAG(+)            = '0'
            
            AND PLW.GLBL_CMPY_CD            = PC.GLBL_CMPY_CD(+)
            AND PLW.PTY_LOC_PK              = PC.PTY_LOC_PK(+)
            AND PC.EZCANCELFLAG(+)            = '0'
        
            UNION ALL
            SELECT
                 DAP.EZINTIME
                ,DAP.EZINUSERID
                ,DAP.DS_ACCT_NUM
                ,DAP.DS_ACCT_NM
                ,DAP.DS_ACCT_TP_CD
                ,DAP.DS_ACCT_ITRL_FLG
                ,DAP.DS_ACCT_CLS_CD
                ,DAP.COA_CH_CD
                ,DAP.COA_AFFL_CD
                ,DAP.DS_ACCT_DLR_CD
                ,DAP.DS_ACCT_LEGAL_NM
                ,DAP.DBA_NM
                ,DAP.DS_ACCT_ALT_NM
                ,DAP.RGTN_STS_CD
                ,DAP.DS_ACCT_URL
                ,DAP.DS_ACCT_DUNS_NUM
                ,DAP.DS_ULT_DUNS_NUM
                ,DAP.DS_ACCT_DUNS_NM
                ,DAP.DS_LAST_UPD_DUNS_DT
                ,DAP.DS_LOC_EMP_NUM
                ,DAP.DS_LOC_REV_AMT
                ,DAP.DS_CUST_SIC_CD
                ,DAP.DS_XTRNL_REF_TXT
                ,DAP.DS_DATA_SRC_TXT
                ,DAP.DS_CUST_SIC_DESC_TXT
                ,DAP.AR_STMT_FLG
                ,DAP.AR_STMT_ISS_DAY
                ,DAP.CLT_CUST_TP_CD
                ,DAP.DS_CLT_ACCT_STS_CD
                ,DAP.LATE_FEE_FLG
                ,DAP.LATE_FEE_AMT
                ,DAP.DS_CUST_TAX_CD
                ,DAP.DS_CUST_TAX_CALC_CD
                ,DAP.DS_TAX_EXEM_FLG
                ,DAP.DS_TAX_GRP_EXEM_CD
                ,DAP.DS_EXEM_EXPR_DT
                ,DAP.DS_TAX_PRNT_TP_CD
                ,DAP.GLBL_CMPY_CD
                ,DAP.CLT_PTFO_PK
                ,DAP.EZCANCELFLAG
                ,PLW.PTY_LOC_PK
                ,PLW.CNTY_PK
                ,PLW.FIRST_LINE_ADDR
                ,PLW.SCD_LINE_ADDR
                ,PLW.THIRD_LINE_ADDR
                ,PLW.FRTH_LINE_ADDR
                ,PLW.CTY_ADDR
                ,PLW.PROV_NM
                ,PLW.ST_CD
                ,PLW.POST_CD
                ,PLW.CTRY_CD
                ,PLW.DS_LOC_NM                           AS DS_LOC_NM
                ,PLW.ADDL_LOC_NM
                ,PLW.GLN_NUM
                ,PLW.TEL_NUM
                ,PLW.FAX_NUM
                ,PLW.LINE_BIZ_TP_CD
                ,PLW.GEO_CD                              AS LOC_GEO_CD
                ,PLW.DS_INSD_CTY_LIMIT_FLG               AS LOC_DS_INSD_CTY_LIMIT_FLG
                ,PLW.DUNS_NUM                            AS LOC_DUNS_NUM
                ,PLW.HQ_DUNS_NUM                         AS LOC_HQ_DUNS_NUM
                ,PLW.DS_ULT_DUNS_NUM                     AS LOC_DS_ULT_DUNS_NUM
                ,PLW.DS_PRNT_DUNS_NUM                    AS LOC_DS_PRNT_DUNS_NUM
                ,PLW.DS_LOC_EMP_NUM                      AS LOC_DS_LOC_EMP_NUM
                ,PLW.DS_LOC_REV_AMT                      AS LOC_DS_LOC_REV_AMT
                ,PLW.DS_LAST_UPD_DUNS_DT                 AS LOC_DS_LAST_UPD_DUNS_DT
                ,PLW.DS_CUST_SIC_CD                      AS LOC_DS_CUST_SIC_CD
                ,PLW.DS_CUST_SIC_DESC_TXT                AS LOC_DS_CUST_SIC_DESC_TXT
                ,PLW.DUNS_TRADE_STYLE_NM                 AS LOC_DUNS_TRADE_STYLE_NM
                ,PLW.DUNS_ACTV_CD                        AS LOC_DUNS_ACTV_CD
                ,PLW.DUNS_LINE_ADDR                      AS LOC_DUNS_LINE_ADDR
                ,PLW.DUNS_BIZ_NM                         AS LOC_DUNS_BIZ_NM
                ,PLW.DS_LAST_RCV_DUNS_TXT                AS LOC_DS_LAST_RCV_DUNS_TXT
                ,PLW.DS_LAST_RCV_DUNS_DT                 AS LOC_DS_LAST_RCV_DUNS_DT
                ,PLW.DUNS_SEND_CNT                       AS LOC_DUNS_SEND_CNT
                ,NULL                                    AS PRIN_CUST_PK
                ,PLW.LOC_NUM
                ,PLW.EZINTIME                            AS LOC_CRAT_DT
                ,PLW.EZINUSERID                          AS LOC_CRAT_USR_ID
                ,PLW.EZUPTIME                            AS LOC_LAST_UPD_DT
                ,PLW.EZUPUSERID                          AS LOC_LAST_UPD_USR_ID
                ,PLW.EFF_FROM_DT                         AS LOC_EFF_FROM_DT
                ,PLW.EFF_THRU_DT                         AS LOC_EFF_THRU_DT
                ,PLW.RGTN_STS_CD                         AS LOC_ACTV_FLG
            FROM
                  PROS_PTY_LOC_WRK PLW
                , DS_ACCT_PROS DAP
            WHERE
                PLW.GLBL_CMPY_CD            = #glblCmpyCd#
            AND PLW.EFF_FROM_DT        &lt;= #trgtDt#
            AND (PLW.EFF_THRU_DT       &gt;= #trgtDt#
                OR PLW.EFF_THRU_DT            IS NULL)
            AND PLW.EZCANCELFLAG = '0'
                
            AND PLW.GLBL_CMPY_CD  = DAP.GLBL_CMPY_CD(+)
            AND PLW.PTY_LOC_PK =  DAP.PTY_LOC_PK(+)
            AND DAP.RGTN_STS_CD(+)  IN (#dapRgtnStsCd1#, #dapRgtnStsCd2#)
            AND DAP.EZCANCELFLAG(+) = '0'
            ) DA
            ,DS_ACCT_TP         DAT
            ,DS_ACCT_CLS        DAC
            ,DS_ACCT_CR_PRFL    DACP
            ,S21_PSN            SPA
            ,COA_CH             CCA
            ,COA_AFFL           CAA
            ,DS_ACCT_DLR        DAD
            ,RGTN_STS           RS
            ,DS_CLT_ACCT_STS    DCAS
            ,DS_CUST_TAX_CALC   DCTC
            ,DS_TAX_GRP_EXEM    DTGEA
            ,CLT_PTFO           CP
            ,CR_CHK_REQ_TP      CCRTA
            ,AR_ADJ_TP          AAT
            ,CUST_CR_RTG        CCRA
            ,CR_RISK_CLS        CRCA
            ,CNTY               CN
            ,BILL_TO_CUST       BTC
            ,CLT_CUST_TP        CCTB
            ,DS_CUST_TAX_CALC   DCTCB
            ,DS_TAX_GRP_EXEM    DTGEB
            ,DS_TAX_PRNT_TP     DTRTB
            ,COA_CH             CCB
            ,COA_AFFL           CAB
            ,CUST_CR_RTG        CCRB
            ,PMT_TERM_CASH_DISC PTCDB
            ,CUST_CR_PRFL       CCP
            ,CR_RISK_CLS        CRC
            ,CR_CHK_REQ_TP      CCRTB
            ,SHIP_TO_CUST       STC
            ,COA_CH             CCS
            ,COA_AFFL           CAS
            ,DS_CUST_TAX_CALC   DCTCS
            ,DS_TAX_GRP_EXEM    DTGES
            ,DS_TAX_PRNT_TP     DTPTS
        WHERE
            DA.GLBL_CMPY_CD            = SPL.GLBL_CMPY_CD(+)
        AND DA.EZINUSERID              = SPL.PSN_CD(+)
        AND DA.GLBL_CMPY_CD            = DAT.GLBL_CMPY_CD(+)
        AND DA.DS_ACCT_TP_CD           = DAT.DS_ACCT_TP_CD(+)
        AND DA.GLBL_CMPY_CD            = DAC.GLBL_CMPY_CD(+)
        AND DA.DS_ACCT_CLS_CD          = DAC.DS_ACCT_CLS_CD(+)
        AND DA.DS_ACCT_NUM             = DACP.DS_ACCT_NUM(+)
        AND DA.GLBL_CMPY_CD            = DACP.GLBL_CMPY_CD(+)
        AND DA.GLBL_CMPY_CD            = SPA.GLBL_CMPY_CD(+)
        AND DA.EZINUSERID              = SPA.PSN_CD(+)
        AND DA.GLBL_CMPY_CD            = CCA.GLBL_CMPY_CD(+)
        AND DA.COA_CH_CD               = CCA.COA_CH_CD(+)
        AND DA.GLBL_CMPY_CD            = CAA.GLBL_CMPY_CD(+)
        AND DA.COA_AFFL_CD             = CAA.COA_AFFL_CD(+)
        AND DA.GLBL_CMPY_CD            = DAD.GLBL_CMPY_CD(+)
        AND DA.DS_ACCT_DLR_CD          = DAD.DS_ACCT_DLR_CD(+)
        AND DA.GLBL_CMPY_CD            = RS.GLBL_CMPY_CD(+)
        AND DA.RGTN_STS_CD             = RS.RGTN_STS_CD(+)
        AND DA.GLBL_CMPY_CD            = DCAS.GLBL_CMPY_CD(+)
        AND DA.DS_CLT_ACCT_STS_CD      = DCAS.DS_CLT_ACCT_STS_CD(+)
        AND DA.GLBL_CMPY_CD            = DCTC.GLBL_CMPY_CD(+)
        AND DA.DS_CUST_TAX_CALC_CD     = DCTC.DS_CUST_TAX_CALC_CD(+)
        AND DA.GLBL_CMPY_CD            = DTGEA.GLBL_CMPY_CD(+)
        AND DA.DS_TAX_GRP_EXEM_CD      = DTGEA.DS_TAX_GRP_EXEM_CD(+)
        AND DA.GLBL_CMPY_CD            = CP.GLBL_CMPY_CD(+)
        AND DA.CLT_PTFO_PK             = CP.CLT_PTFO_PK(+)
        AND CP.GLBL_CMPY_CD            = AAT.GLBL_CMPY_CD(+)
        AND CP.AR_ADJ_TP_CD            = AAT.AR_ADJ_TP_CD(+)
        AND DA.GLBL_CMPY_CD            = DACP.GLBL_CMPY_CD(+)
        AND DA.DS_ACCT_NUM             = DACP.DS_ACCT_NUM(+)
        AND DACP.GLBL_CMPY_CD          = CCRA.GLBL_CMPY_CD(+)
        AND DACP.CUST_CR_RTG_CD        = CCRA.CUST_CR_RTG_CD(+)
        AND DACP.GLBL_CMPY_CD          = CCRTA.GLBL_CMPY_CD(+)
        AND DACP.CR_CHK_REQ_TP_CD      = CCRTA.CR_CHK_REQ_TP_CD(+)
        AND DACP.GLBL_CMPY_CD          = CRCA.GLBL_CMPY_CD(+)
        AND DACP.CR_RISK_CLS_CD        = CRCA.CR_RISK_CLS_CD(+)
        AND DA.CNTY_PK                 = CN.CNTY_PK(+)
        AND DA.GLBL_CMPY_CD            = CN.GLBL_CMPY_CD(+)
        AND DA.PTY_LOC_PK              = BTC.PTY_LOC_PK(+)
        AND DA.GLBL_CMPY_CD            = BTC.GLBL_CMPY_CD(+)
        AND BTC.GLBL_CMPY_CD           = CCTB.GLBL_CMPY_CD(+)
        AND BTC.CLT_CUST_TP_CD         = CCTB.CLT_CUST_TP_CD(+)
        AND BTC.GLBL_CMPY_CD           = DCTCB.GLBL_CMPY_CD(+)
        AND BTC.DS_CUST_TAX_CALC_CD    = DCTCB.DS_CUST_TAX_CALC_CD(+)
        AND BTC.GLBL_CMPY_CD           = DTGEB.GLBL_CMPY_CD(+)
        AND BTC.DS_TAX_GRP_EXEM_CD     = DTGEB.DS_TAX_GRP_EXEM_CD(+)
        AND BTC.GLBL_CMPY_CD           = DTRTB.GLBL_CMPY_CD(+)
        AND BTC.DS_TAX_PRNT_TP_CD      = DTRTB.DS_TAX_PRNT_TP_CD(+)
        AND BTC.GLBL_CMPY_CD           = CCB.GLBL_CMPY_CD(+)
        AND BTC.COA_CH_CD              = CCB.COA_CH_CD(+)
        AND BTC.GLBL_CMPY_CD           = CAB.GLBL_CMPY_CD(+)
        AND BTC.COA_AFFL_CD            = CAB.COA_AFFL_CD(+)
        AND BTC.GLBL_CMPY_CD           = CCP.GLBL_CMPY_CD(+)
        AND BTC.BILL_TO_CUST_PK        = CCP.BILL_TO_CUST_PK(+)
        AND CCP.GLBL_CMPY_CD           = CCRB.GLBL_CMPY_CD(+)
        AND CCP.CUST_CR_RTG_CD         = CCRB.CUST_CR_RTG_CD(+)
        AND CCP.GLBL_CMPY_CD           = PTCDB.GLBL_CMPY_CD(+)
        AND CCP.PMT_TERM_CASH_DISC_CD  = PTCDB.PMT_TERM_CASH_DISC_CD(+)
        AND BTC.GLBL_CMPY_CD           = CCP.GLBL_CMPY_CD(+)
        AND BTC.BILL_TO_CUST_PK        = CCP.BILL_TO_CUST_PK(+)
        AND CCP.GLBL_CMPY_CD           = CRC.GLBL_CMPY_CD(+)
        AND CCP.CR_RISK_CLS_CD         = CRC.CR_RISK_CLS_CD(+)
        AND CCP.GLBL_CMPY_CD           = CCRTB.GLBL_CMPY_CD(+)
        AND CCP.CR_CHK_REQ_TP_CD       = CCRTB.CR_CHK_REQ_TP_CD(+)
        AND DA.PTY_LOC_PK              = STC.PTY_LOC_PK(+)
        AND DA.GLBL_CMPY_CD            = STC.GLBL_CMPY_CD(+)
        AND STC.GLBL_CMPY_CD           = CCS.GLBL_CMPY_CD(+)
        AND STC.COA_CH_CD              = CCS.COA_CH_CD(+)
        AND STC.GLBL_CMPY_CD           = CAS.GLBL_CMPY_CD(+)
        AND STC.COA_AFFL_CD            = CAS.COA_AFFL_CD(+)
        AND STC.GLBL_CMPY_CD           = DCTCS.GLBL_CMPY_CD(+)
        AND STC.DS_CUST_TAX_CALC_CD    = DCTCS.DS_CUST_TAX_CALC_CD(+)
        AND STC.GLBL_CMPY_CD           = DTGES.GLBL_CMPY_CD(+)
        AND STC.DS_TAX_GRP_EXEM_CD     = DTGES.DS_TAX_GRP_EXEM_CD(+)
        AND STC.GLBL_CMPY_CD           = DTPTS.GLBL_CMPY_CD(+)
        AND STC.DS_TAX_PRNT_TP_CD      = DTPTS.DS_TAX_PRNT_TP_CD(+)
        AND SPL.EZCANCELFLAG(+)        = '0'
        AND DAT.EZCANCELFLAG(+)        = '0'
        AND DAC.EZCANCELFLAG(+)        = '0'
        AND DACP.EZCANCELFLAG(+)       = '0'
        AND SPA.EZCANCELFLAG(+)        = '0'
        AND CCA.EZCANCELFLAG(+)        = '0'
        AND CAA.EZCANCELFLAG(+)        = '0'
        AND DAD.EZCANCELFLAG(+)        = '0'
        AND RS.EZCANCELFLAG(+)         = '0'
        AND DCAS.EZCANCELFLAG(+)       = '0'
        AND DCTC.EZCANCELFLAG(+)       = '0'
        AND DTGEA.EZCANCELFLAG(+)      = '0'
        AND CP.EZCANCELFLAG(+)         = '0'
        AND AAT.EZCANCELFLAG(+)        = '0'
        AND DACP.EZCANCELFLAG(+)       = '0'
        AND CCRA.EZCANCELFLAG(+)       = '0'
        AND CCRTA.EZCANCELFLAG(+)      = '0'
        AND CRCA.EZCANCELFLAG(+)       = '0'
        AND CN.EZCANCELFLAG(+)         = '0'
        AND BTC.EZCANCELFLAG(+)        = '0'
        AND CCTB.EZCANCELFLAG(+)       = '0'
        AND DCTCB.EZCANCELFLAG(+)      = '0'
        AND DTGEB.EZCANCELFLAG(+)      = '0'
        AND DTRTB.EZCANCELFLAG(+)      = '0'
        AND CCB.EZCANCELFLAG(+)        = '0'
        AND CAB.EZCANCELFLAG(+)        = '0'
        AND CCRB.EZCANCELFLAG(+)       = '0'
        AND PTCDB.EZCANCELFLAG(+)      = '0'
        AND CCP.EZCANCELFLAG(+)        = '0'
        AND CRC.EZCANCELFLAG(+)        = '0'
        AND CCRTB.EZCANCELFLAG(+)      = '0'
        AND STC.EZCANCELFLAG(+)        = '0'
        AND CCS.EZCANCELFLAG(+)        = '0'
        AND CAS.EZCANCELFLAG(+)        = '0'
        AND DCTCS.EZCANCELFLAG(+)      = '0'
        AND DTGES.EZCANCELFLAG(+)      = '0'
        AND DTPTS.EZCANCELFLAG(+)      = '0'
    </statement>
</sqlMap>
