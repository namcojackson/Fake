<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSBB052001">
    <statement id="getTargetFsrInfo" parameterClass="Map" resultClass="Map">
        SELECT
             FS.SER_NUM
            ,MD.MDSE_DESC_SHORT_TXT
            ,ST.LOC_NUM
            ,SM.MDSE_CD
        FROM
             FSR                    FS
            ,SVC_MACH_MSTR          SM
            ,MDSE                   MD
            ,SHIP_TO_CUST           ST
            ,S21_PSN                PS
        WHERE
                FS.GLBL_CMPY_CD     = #glblCmpyCd#
            AND FS.FSR_STS_CD       = #fsrStsCd#

            <isNotNull property="cloDt">
            AND FS.FSR_CLO_DT   &gt; #cloDt#
            </isNotNull>
            AND FS.EZCANCELFLAG     = '0'

            AND FS.GLBL_CMPY_CD     = SM.GLBL_CMPY_CD
            AND FS.SVC_MACH_MSTR_PK = SM.SVC_MACH_MSTR_PK
            AND SM.EZCANCELFLAG     = '0'

            AND SM.GLBL_CMPY_CD     = MD.GLBL_CMPY_CD(+)
            AND SM.MDSE_CD          = MD.MDSE_CD(+)
            AND MD.EZCANCELFLAG(+)  = '0'

            AND SM.GLBL_CMPY_CD     = ST.GLBL_CMPY_CD(+)
            AND SM.CUR_LOC_NUM      = ST.SHIP_TO_CUST_CD(+)
            AND ST.EZCANCELFLAG(+)  = '0'

            AND FS.GLBL_CMPY_CD     = PS.GLBL_CMPY_CD
            AND FS.TECH_CD          = PS.PSN_CD
            <isNotNull property="psnTpCdList">
            <iterate property       ="psnTpCdList" var="psnTpCd[]" open=" AND PS.PSN_TP_CD IN  (" close=")" conjunction=",">
            #psnTpCd[]#
            </iterate>
            </isNotNull>
            AND PS.EZCANCELFLAG     = '0'
        ORDER BY 
                FS.SER_NUM
    </statement>
</sqlMap>