<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NPZC134001">

<statement id="sendPoInfo" parameterClass="Map" resultClass="Map">
SELECT  
     PO.PO_ORD_NUM
    ,PO.PO_APVL_DT
    ,PO.VND_CD
    ,PO.VND_ISS_ORD_NUM
    ,PO.VND_DROP_SHIP_FLG
    ,PO.CARR_ACCT_NUM
    ,PO.DS_PO_TP_CD
    ,PO.PO_QLFY_CD
    ,PO.RTRN_SHIP_TO_RTL_WH_CD
    ,PO.VND_PMT_TERM_DESC_TXT
    ,PO.DEST_RTL_WH_CD
    ,PO.PO_ORD_SRC_CD
    ,PO.PRCH_GRP_CD
    ,DPT.EDI_SEND_FLG
    ,DPT.DS_PO_TP_NM
    ,RAV.VND_SYS_TP_CD
    ,RAV.PO_SEND_FLG
    ,RAV.EDI_SEND_ID
    ,RAV.EDI_RCV_ID
    ,PM.PO_MSG_TXT
    ,TM.TECH_NM
    ,PD.CARR_CD
    ,PD.PO_ORD_DTL_LINE_NUM
    ,PD.CUST_ISS_PO_NUM
    ,PD.PO_STS_CD
    ,PD.ETA_DT
    ,PD.MDSE_CD
    ,PD.PO_QTY
    ,PD.SHIP_TO_LOC_NM
    ,PD.SHIP_TO_ADDL_LOC_NM
    ,PD.SHIP_TO_FIRST_LINE_ADDR
    ,PD.SHIP_TO_SCD_LINE_ADDR
    ,PD.SHIP_TO_THIRD_LINE_ADDR
    ,PD.SHIP_TO_FRTH_LINE_ADDR
    ,PD.SHIP_TO_CTY_ADDR
    ,PD.SHIP_TO_ST_CD
    ,PD.SHIP_TO_POST_CD
    ,PD.SHPG_SVC_LVL_CD
    ,PD.SHIP_TO_CUST_CD
    ,PD.SHIP_TO_CTRY_CD
    ,PD.SHIP_TO_CNTY_NM
    ,PD.ASL_MDSE_CD
    ,PD.CTAC_PSN_NM
    ,PD.FRT_COND_CD
    ,PD.ENT_DEAL_NET_UNIT_PRC_AMT
    ,PD.SET_PO_ORD_DTL_LINE_NUM
    ,PD.PO_MDSE_CMPSN_TP_CD
    ,PD.VND_INVTY_LOC_CD
    ,PD.INVTY_LOC_CD
    ,PD.RQST_RCV_DT
    ,CPO.CPO_ORD_NUM
    ,CD.CUST_MDSE_CD
    ,PD.SHIP_TO_ACCT_NM
    <!-- 2019/02/13 QC#30232 Add Start -->
    ,PD.TRX_REF_NUM
    <!-- 2019/02/13 QC#30232 Add End -->
    <!-- START 2023/02/17 TZ.Win [QC#60966, ADD] -->
    ,PD.RQST_SHIP_DT
    <!-- END 2023/02/17 TZ.Win [QC#60966, ADD] -->
FROM 
     PO           PO 
    ,DS_PO_TP     DPT
    ,TECH_MSTR    TM 
    ,RCV_ASN_VND  RAV
    ,PO_MSG       PM
    ,PO_DTL       PD
    ,CPO          CPO 
    ,CPO_DTL      CD
WHERE 1=1 
    AND PO.EZCANCELFLAG         = '0'
    AND PO.GLBL_CMPY_CD         = #glblCmpyCd#
    AND PO.PO_ORD_NUM           = #poOrdNum#
    AND PD.EZCANCELFLAG         = '0'
    AND PO.GLBL_CMPY_CD         = PD.GLBL_CMPY_CD
    AND PO.PO_ORD_NUM           = PD.PO_ORD_NUM
    AND PD.PO_STS_CD IN (
    <iterate property="poStsCdList" var="poStsCd[]" open="" close="" conjunction=",">
                #poStsCd[]#
    </iterate>
    )
    AND PD.PO_SEND_TS          IS NULL    
    AND DPT.EZCANCELFLAG(+)     = '0'
    AND PO.GLBL_CMPY_CD         = DPT.GLBL_CMPY_CD(+)
    AND PO.DS_PO_TP_CD          = DPT.DS_PO_TP_CD(+)
    AND TM.EZCANCELFLAG(+)      = '0'
    AND PO.GLBL_CMPY_CD         = TM.GLBL_CMPY_CD(+)
    AND PO.RQST_TECH_TOC_CD     = TM.TECH_TOC_CD(+)
    AND CPO.EZCANCELFLAG(+)     = '0'
    AND PD.GLBL_CMPY_CD         = CPO.GLBL_CMPY_CD(+)
    AND PD.CPO_ORD_NUM          = CPO.CPO_ORD_NUM(+)
    AND CD.EZCANCELFLAG(+)      = '0'
    AND PD.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD(+)
    AND PD.CPO_ORD_NUM          = CD.CPO_ORD_NUM(+)
    AND PD.CPO_DTL_LINE_NUM     = CD.CPO_DTL_LINE_NUM(+)
    AND PD.CPO_DTL_LINE_SUB_NUM = CD.CPO_DTL_LINE_SUB_NUM(+)
    AND PM.EZCANCELFLAG(+)      = '0'
    AND PO.GLBL_CMPY_CD         = PM.GLBL_CMPY_CD(+)
    AND PO.PO_ORD_NUM           = PM.PO_ORD_NUM(+)
    AND PM.PO_MSG_TP_CD(+)      = #poMsgTpCd#
    AND PM.PO_MSG_SEG_ID(+)     = #poMsgSegId#
    AND RAV.EZCANCELFLAG(+)     = '0'
    AND PO.GLBL_CMPY_CD         = RAV.GLBL_CMPY_CD(+)
    AND PO.VND_CD               = RAV.RCV_ASN_VND_CD(+)
    AND NOT EXISTS 
                (
                    SELECT
                        'X'
                    FROM 
                        PO_DTL    PD2
                       ,PO_DTL    PD3 
                    WHERE 1=1 
                    AND PD2.EZCANCELFLAG         = '0'
                    AND PD2.GLBL_CMPY_CD         = #glblCmpyCd#
                    AND PD2.PO_STS_CD            = #poStsCdExist#
                    AND PD3.EZCANCELFLAG         = '0'
                    AND PD2.GLBL_CMPY_CD         = PD3.GLBL_CMPY_CD
                    AND PD2.PO_MDSE_CMPSN_TP_CD = #poMdseCmpsnTpCd#
                    AND PD2.PO_ORD_NUM           = PD3.PO_ORD_NUM
                    AND PD2.PO_ORD_DTL_LINE_NUM  = PD2.SET_PO_ORD_DTL_LINE_NUM
                    AND PD2.PO_STS_CD           != #poStsCdExist#
                 )
    ORDER BY 
        NVL(PD.SET_PO_ORD_DTL_LINE_NUM, PD.PO_ORD_DTL_LINE_NUM)
       ,DECODE(PD.PO_MDSE_CMPSN_TP_CD, '2' , 2, 1)
       ,PD.PO_ORD_DTL_LINE_NUM
</statement>

<statement id="getPoStsCd" parameterClass="Map" resultClass="Map">
SELECT  
     distinct PD.PO_STS_CD AS PO_STS_CD
FROM 
     PO           PO 
    ,DS_PO_TP     DPT
    ,TECH_MSTR    TM 
    ,RCV_ASN_VND  RAV
    ,PO_MSG       PM
    ,PO_DTL       PD
    ,CPO          CPO 
    ,CPO_DTL      CD
WHERE 1=1 
    AND PO.EZCANCELFLAG         = '0'
    AND DPT.EZCANCELFLAG(+)     = '0'
    AND TM.EZCANCELFLAG(+)      = '0'
    AND RAV.EZCANCELFLAG(+)     = '0'
    AND PM.EZCANCELFLAG(+)      = '0'
    AND PD.EZCANCELFLAG(+)      = '0'
    AND CPO.EZCANCELFLAG(+)     = '0'
    AND CD.EZCANCELFLAG(+)      = '0'
    AND PO.GLBL_CMPY_CD         = #glblCmpyCd#
    AND PO.PO_ORD_NUM           = #poOrdNum#
    AND PO.GLBL_CMPY_CD         = DPT.GLBL_CMPY_CD(+)
    AND PO.GLBL_CMPY_CD         = TM.GLBL_CMPY_CD(+)
    AND PO.GLBL_CMPY_CD         = RAV.GLBL_CMPY_CD(+)
    AND PO.GLBL_CMPY_CD         = PM.GLBL_CMPY_CD(+)
    AND PO.GLBL_CMPY_CD         = PD.GLBL_CMPY_CD
    AND PD.GLBL_CMPY_CD         = CPO.GLBL_CMPY_CD(+)
    AND PD.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD(+)
    AND PO.PO_ORD_NUM           = PO.PO_ORD_NUM
    AND PO.DS_PO_TP_CD          = DPT.DS_PO_TP_CD(+)
    AND PO.RQST_TECH_TOC_CD     = TM.TECH_TOC_CD(+)
    AND PO.VND_CD               = RAV.RCV_ASN_VND_CD(+)
    AND PO.PO_ORD_NUM           = PD.PO_ORD_NUM
    AND PD.PO_STS_CD IN (
    <iterate property="poStsCdList" var="poStsCd[]" open="" close="" conjunction=",">
                #poStsCd[]#
    </iterate>
    )
    AND PD.PO_SEND_TS IS NULL
    AND PD.CPO_ORD_NUM          = CPO.CPO_ORD_NUM(+)
    AND PD.CPO_ORD_NUM          = CD.CPO_ORD_NUM(+)
    AND PD.CPO_DTL_LINE_NUM     = CD.CPO_DTL_LINE_NUM(+)
    AND PD.CPO_DTL_LINE_SUB_NUM = CD.CPO_DTL_LINE_SUB_NUM(+)
    AND PO.PO_ORD_NUM           = PM.PO_ORD_NUM(+)
    AND PM.PO_MSG_TP_CD(+)      = #poMsgTpCd#
    AND PM.PO_MSG_SEG_ID(+)     = #poMsgSegId#
    AND NOT EXISTS 
     (SELECT
             1
      FROM 
          PO_DTL PD2
         ,PO_DTL PD3 
      WHERE 1=1 
       AND PD2.EZCANCELFLAG         = '0'
       AND PD3.EZCANCELFLAG         = '0'
       AND PD2.GLBL_CMPY_CD         = #glblCmpyCd#
       AND PD2.GLBL_CMPY_CD         = PD3.GLBL_CMPY_CD
       AND PD2.PO_STS_CD            = #poStsCdExist#
       AND PD2.PO_MDSE_CMPSN_TP_CD = #poMdseCmpsnTpCd#
       AND PD2.PO_ORD_NUM           = PD3.PO_ORD_NUM
       AND PD2.PO_ORD_DTL_LINE_NUM  = PD2.SET_PO_ORD_DTL_LINE_NUM
       AND PD2.PO_STS_CD           != #poStsCdExist#
       )

</statement>

    <statement id="getTrdPtnrShpgXRefInfo" parameterClass="Map" resultClass="Map">
    SELECT
         TRD_PTNR_CARR_CD
        ,TRD_PTNR_SHPG_SVC_LVL_CD
        ,TRD_PTNR_FRT_CHRG_METH_CD
        ,TRD_PTNR_SHIP_VIA_CD
        ,CARR_TP_CD
    FROM 
         TRD_PTNR_SHPG_X_REF
    WHERE 
        1=1 
    AND GLBL_CMPY_CD    = #glblCmpyCd#
    AND EZCANCELFLAG    = '0'
    AND VND_CD          = #vndCd#
    AND CARR_CD         = #carrCd#
    AND SHPG_SVC_LCL_CD = #shpgSvcLvlCd#
    AND FRT_COND_CD     = #frtCondCd#
    AND ROWNUM          = 1
    </statement>

    <statement id="getPoAckStatusInfo" parameterClass="Map" resultClass="Map">
    SELECT
        PO_ACK_LINE_STS_CD
       ,VND_PO_ACK_STS_DESC_TXT 
    FROM
        VND_PO_ACK_STS
    WHERE 1=1
        AND EZCANCELFLAG      = '0'
        AND GLBL_CMPY_CD      = #glblCmpyCd#
        AND VND_PO_ACK_STS_CD = #vndPoAckStsCd#
    </statement>
    
    <statement id="getPoAckNumberInfo" parameterClass="Map" resultClass="String">
    SELECT
        NVL(MAX(PO_ACK_NUM) + 1, 0) AS PO_ACK_NUM
    FROM
        PO_ACK_HDR
    WHERE 1=1
        AND EZCANCELFLAG  = '0'
        AND GLBL_CMPY_CD  = #glblCmpyCd#
        AND PO_ORD_NUM    = #poOrdNum#
    </statement>
    
    <statement id="getCusaCpoDtlNumInfo" parameterClass="Map" resultClass="Map">
    SELECT
        MAX (CPO_DTL_LINE_NUM) AS CPO_DTL_LINE_NUM
    FROM
        CSA_CPO_DTL_V
    WHERE 1=1
        AND EZCANCELFLAG  = '0'
        AND GLBL_CMPY_CD  = #glblCmpyCd#
        AND CPO_ORD_NUM   = #cpoOrdNum#
    </statement>
    
    <statement id="getCusaCpoDtlNumInfo2" parameterClass="Map" resultClass="Map">
    SELECT
        VND_CPO_DTL_LINE_NUM
       ,VND_CPO_DTL_LINE_SUB_NUM
    FROM
        CSA_CPO_DTL_V
    WHERE 1=1
        AND EZCANCELFLAG  = '0'
        AND GLBL_CMPY_CD  = #glblCmpyCd#
        AND CPO_ORD_NUM   = #cpoOrdNum#\
        AND EDI_NUM       = #ediNum#
        AND MDSE_CD       = #mdseCd#
    </statement>
    
   <statement id="getTrdPtnrShpgCondCdInfo" parameterClass="Map" resultClass="Map">
    SELECT
         TRD_PTNR_SHPG_COND_CD
    FROM 
         TRD_PTNR_SHPG_COND_XREF
    WHERE 
        1=1 
    AND GLBL_CMPY_CD = #glblCmpyCd#
    <isNotNull property="shpgSvcLclCd">
    AND SHPG_SVC_LVL_CD = #shpgSvcLclCd#
    </isNotNull>
    <isNull property="shpgSvcLclCd">
    AND SHPG_SVC_LVL_CD = '*'
    </isNull>
    <isNotNull property="dsPoTpCd">
    AND DS_PO_TP_CD = #dsPoTpCd#
    </isNotNull>
    <isNull property="dsPoTpCd">
     AND DS_PO_TP_CD = '*'
    </isNull>
    AND EZCANCELFLAG = '0'
    AND ROWNUM = 1
    </statement>

    <statement id="cusaValidationPoNumber" parameterClass="Map" resultClass="String">
    SELECT 
        1
    FROM 
        CSA_CPO_V CCV
       ,CSA_SELL_TO_CUST_V CSTCV
       ,CSA_SHIP_TO_CUST_V CSHTCV
    WHERE 1=1
        AND CCV.EZCANCELFLAG       = '0'
        AND CSTCV.EZCANCELFLAG     = '0'
        AND CSHTCV.EZCANCELFLAG    = '0'
        AND CCV.GLBL_CMPY_CD       = #glblCmpyCd#
        AND CCV.GLBL_CMPY_CD       = CSTCV.GLBL_CMPY_CD
        AND CSTCV.GLBL_CMPY_CD     = CSHTCV.GLBL_CMPY_CD
        <isNotNull property="custIssPoNum">
        AND CCV.CUST_ISS_PO_NUM    = #custIssPoNum#
        </isNotNull>
        <isNotNull property="custIssPoDt">
        AND CCV.CUST_ISS_PO_DT     = #custIssPoDt#
        </isNotNull>
        <isNotNull property="shipToCustCd">
        AND CSHTCV.SHIP_TO_CUST_CD = #shipToCustCd#
        </isNotNull>
        AND CCV.SELL_TO_CUST_CD    = CSTCV.SELL_TO_CUST_CD
        AND CSTCV.SELL_TO_CUST_CD  = CSHTCV.SELL_TO_CUST_CD
        AND ROWNUM = 1
    </statement>

    <statement id="cusaMdseType" parameterClass="Map" resultClass="String">
    SELECT
        MDSE_TP_CD 
    FROM CSA_ALL_MDSE_V 
    WHERE 1=1 
        AND EZCANCELFLAG = '0'
        AND GLBL_CMPY_CD = #glblCmpyCd#
        AND MDSE_CD      = #mdseCd#
    </statement>
    
    <statement id="cusaSetItem" parameterClass="Map" resultClass="Map">
    SELECT
       NVL(CHILD_MDSE_CD, CHILD_ORD_TAKE_MDSE_CD) AS MDSE_CD
      ,CHILD_MDSE_QTY
      ,CASE WHEN CHILD_ORD_TAKE_MDSE_CD IS NULL THEN 'N' ELSE 'Y' END  IS_ORD_TAKE
    FROM
        CSA_CMPSN_V
    WHERE 1=1
        AND EZCANCELFLAG = '0'
        AND GLBL_CMPY_CD = #glblCmpyCd#
        AND PRNT_MDSE_CD = #prntMdseCd#
    </statement>
    
    <statement id="cusaDropShipItem" parameterClass="Map" resultClass="String">
    SELECT
        'X'
    FROM 
        CSA_SHIP_TO_CUST_V      CSTCV
       ,CSA_ALL_MDSE_V          CMV 
       ,CSA_EDI_DROP_SHIP_VLD_V CEPDSVV
    WHERE 1=1
        AND CSTCV.EZCANCELFLAG       = '0'
        AND CSTCV.GLBL_CMPY_CD       = #glblCmpyCd#
        AND CSTCV.GLBL_CMPY_CD       = CMV.GLBL_CMPY_CD
        AND CSTCV.SHIP_TO_CUST_CD    = #shipToCustCd#
        AND CMV.EZCANCELFLAG         = '0'
        AND CMV.MDSE_CD              = #mdseCd#
        AND CEPDSVV.EZCANCELFLAG     = '0'
        AND CEPDSVV.GLBL_CMPY_CD     = #glblCmpyCd#
        AND ( (CEPDSVV.EDI_CUST_TP_CD = #ediCustTpCd1# AND CEPDSVV.CUSA_CUST_CD = CSTCV.BILL_TO_CUST_CD)
            OR
              (CEPDSVV.EDI_CUST_TP_CD = #ediCustTpCd2# AND CEPDSVV.CUSA_CUST_CD = CSTCV.SELL_TO_CUST_CD)
            )
        AND (CMV.MDSE_CD             = CEPDSVV.CUSA_MDSE_CD       OR CEPDSVV.CUSA_MDSE_CD        IS NULL)
        AND (CMV.FIFTH_PROD_CTRL_CD  = CEPDSVV.FIFTH_PROD_CTRL_CD OR CEPDSVV.FIFTH_PROD_CTRL_CD  IS NULL)
        AND (CMV.FRTH_PROD_CTRL_CD   = CEPDSVV.FRTH_PROD_CTRL_CD  OR CEPDSVV.FRTH_PROD_CTRL_CD   IS NULL)
        AND (CMV.THIRD_PROD_CTRL_CD  = CEPDSVV.THIRD_PROD_CTRL_CD OR CEPDSVV.THIRD_PROD_CTRL_CD  IS NULL)
        AND (CMV.SCD_PROD_CTRL_CD    = CEPDSVV.SCD_PROD_CTRL_CD   OR CEPDSVV.SCD_PROD_CTRL_CD    IS NULL)
        AND (CMV.FIRST_PROD_CTRL_CD  = CEPDSVV.FIRST_PROD_CTRL_CD OR CEPDSVV.FIRST_PROD_CTRL_CD  IS NULL)
        AND ROWNUM = 1
    </statement>
    
    <statement id="searchVndShipToXrefInv" parameterClass="Map" resultClass="String">
    SELECT
        VND_LOC_CD
    FROM
        VND_SHIP_TO_XREF
    WHERE 1=1
     AND EZCANCELFLAG    = '0'
     AND GLBL_CMPY_CD    = #glblCmpyCd#
     AND VND_XREF_TP_CD  = #vndXrefTpCd#
     AND TO_DATE(NVL(EFF_FROM_DT , #eftFromDt#), 'YYYY/MM/DD')  &lt; = TO_DATE(#slsDate# , 'YYYY/MM/DD' )
     AND TO_DATE(NVL(EFF_THRU_DT , #eftThruDt#), 'YYYY/MM/DD')  &gt; = TO_DATE(#slsDate# , 'YYYY/MM/DD' )
    <isNotNull property="prchGrpCd">
     AND PRCH_GRP_CD     = #prchGrpCd#
    </isNotNull>
    <isNotNull property="invtyLocCd">
     AND INVTY_LOC_CD    = #invtyLocCd#
    </isNotNull>
     AND ROWNUM = 1
    </statement>
    
    <statement id="searchVndShipToXrefRtl" parameterClass="Map" resultClass="String">
    SELECT
        VND_LOC_CD
    FROM
        VND_SHIP_TO_XREF
    WHERE 1=1
     AND EZCANCELFLAG    = '0'
     AND GLBL_CMPY_CD    = #glblCmpyCd#
     AND VND_XREF_TP_CD  = #vndXrefTpCd#
     AND TO_DATE(NVL(EFF_FROM_DT , #eftFromDt#), 'YYYY/MM/DD')  &lt; = TO_DATE(#slsDate# , 'YYYY/MM/DD' )
     AND TO_DATE(NVL(EFF_THRU_DT , #eftThruDt#), 'YYYY/MM/DD')  &gt; = TO_DATE(#slsDate# , 'YYYY/MM/DD' )
    <isNotNull property="prchGrpCd">
     AND PRCH_GRP_CD     = #prchGrpCd#
    </isNotNull>
    <isNotNull property="rtlWhCd">
     AND RTL_WH_CD     = #rtlWhCd#
    </isNotNull>
     AND ROWNUM = 1
    </statement>

    <statement id="getCusaShipToCustCd" parameterClass="Map" resultClass="String">
    SELECT 
        SELL_TO_SHIP_TO_CUST_CD
    FROM (
        SELECT
            SELL_TO_SHIP_TO_CUST_CD
        FROM
            CSA_TRD_PTNR_LOC_X_REF_V
        WHERE 1=1
        AND EZCANCELFLAG           = '0'
        AND GLBL_CMPY_CD           = #glblCmpyCd# 
        AND UPPER(TRD_PTNR_LOC_CD) = UPPER(#trdPtnrLocCd#)
        AND EDI_TRD_PTNR_CD IN (
        <iterate property="trdPtnrList" var="ediTrdPtnrCd[]" open="" close="" conjunction=",">
                    #ediTrdPtnrCd[]#
        </iterate>
        ) 
        AND (CRS_REF_ACTV_FLG IS NULL OR CRS_REF_ACTV_FLG = #crsRefActvFlg#)
        AND (EFF_FROM_DT IS NULL OR TO_DATE(EFF_FROM_DT,'YYYY/MM/DD')  &lt; = TO_DATE(#slsDate# , 'YYYY/MM/DD' ))
        AND (EFF_THRU_DT IS NULL OR TO_DATE(EFF_THRU_DT,'YYYY/MM/DD')  &lt; = TO_DATE(#slsDate# , 'YYYY/MM/DD' ))
        ORDER BY 
            EDI_CUST_TP_CD          DESC 
           ,SELL_TO_SHIP_TO_CUST_CD ASC
        )
    WHERE ROWNUM = 1
    </statement>

    <statement id="getPoAckHdrPkList" parameterClass="Map" resultClass="Map">
    SELECT
        PO_ACK_HDR_PK
    FROM
        PO_ACK_HDR
    WHERE 1=1
    AND EZCANCELFLAG    = '0'
    AND GLBL_CMPY_CD    = #glblCmpyCd#
    AND PO_ORD_NUM      = #poOrdNum#
    AND PO_ACK_HDR_PK  != #poAckHdrPk#
    </statement>
    
    <statement id="getUpdateTargetPoAckDtlPk" parameterClass="Map" resultClass="Map">
    SELECT
        PO_ACK_DTL_PK
    FROM
        PO_ACK_DTL
    WHERE 1=1
    AND EZCANCELFLAG        = '0'
    AND GLBL_CMPY_CD        = #glblCmpyCd#
    AND PO_ORD_NUM          = #poOrdNum#
    AND PO_ORD_DTL_LINE_NUM = #poOrdDtlLineNum#
    AND PO_ACK_DTL_PK NOT IN (
     <iterate property="poAckDtlPkList" var="poAckDtlPk[]" open="" close="" conjunction=",">
      #poAckDtlPk[]#
     </iterate>
    )
    </statement>

    <statement id="getCusaCpoList" parameterClass="Map" resultClass="Map">
    SELECT 
        CCV.CPO_ORD_NUM
    FROM 
        CSA_CPO_V     CCV
       ,CSA_CPO_DTL_V CCDV
    WHERE 1 = 1
    AND CCV.GLBL_CMPY_CD    = #glblCmpyCd#
    AND CCV.CUST_ISS_PO_NUM = #poOrdNum#
    AND CCV.GLBL_CMPY_CD    = CCDV.GLBL_CMPY_CD
    AND CCV.CPO_ORD_NUM     = CCDV.CPO_ORD_NUM
    AND CCDV.EZCANCELFLAG   = '0'
    AND CCV.EZCANCELFLAG    = '0'
    </statement>
    <!-- 08/08/2017 CITS S.Endo Mod Sol#035(QC#18108) START -->
    <statement id="getMsgs" parameterClass="Map" resultClass="Map">
    SELECT
         PM.PO_MSG_TXT
        ,PM.PO_MSG_TP_CD
        ,PM.PO_MSG_SEG_ID
    FROM
        PO_MSG PM
    WHERE
        PM.GLBL_CMPY_CD = #glblCmpyCd#
    AND PM.PO_ORD_NUM   = #poOrdNum#
    AND PM.PO_MSG_TP_CD IN (#poMsgTpCdSi#,#poMsgTpCdSn#)
    AND PM.EZCANCELFLAG = '0'
    ORDER BY PO_MSG_TP_CD DESC, PO_MSG_SEG_ID ASC
    </statement>
    <!-- 08/08/2017 CITS S.Endo Mod Sol#035(QC#18108) END -->
    <statement id="countCsaOrdTakeMdseV" parameterClass="Map" resultClass="BigDecimal">
    SELECT
        COUNT(*) AS CNT
    FROM CSA_ORD_TAKE_MDSE_V 
    WHERE 1=1 
        AND EZCANCELFLAG          = '0'
        AND GLBL_CMPY_CD          = #glblCmpyCd#
        AND ORD_TAKE_MDSE_CD      = #ordTakeMdseCd#
    </statement>
    
        <!-- QC#23356 START -->
    <statement id="getcarrTpCd" parameterClass="Map" resultClass="String">
    SELECT
         VND.CARR_TP_CD
    FROM
        VND VND
    WHERE
        VND.GLBL_CMPY_CD = #glblCmpyCd#
    AND VND.VND_CD       = #carrCd#
    AND VND.EZCANCELFLAG = '0'
    AND ROWNUM = 1
    </statement>

    <statement id="getCpoInfo" parameterClass="Map" resultClass="Map">
    SELECT
         CPO.DS_ORD_CATG_CD
        <!-- QC#58769 Start -->
        ,CPO.DS_ORD_TP_CD
        <!-- QC#58769 End -->
    FROM
        CPO CPO
    WHERE
        CPO.GLBL_CMPY_CD = #glblCmpyCd#
    AND CPO.CPO_ORD_NUM  = #cpoOrdNum#
    AND CPO.EZCANCELFLAG = '0'
    AND ROWNUM = 1
    </statement>
    
    <statement id="getCarrAcctNum" parameterClass="Map" resultClass="Map">
    SELECT
         CAX.CARR_ACCT_NUM
        ,CAX.CARR_CD
    FROM
        CARR_ACCT_XREF CAX
    WHERE
        CAX.GLBL_CMPY_CD = #glblCmpyCd#
    AND CAX.CARR_TP_CD  = #carrTpCd#
    <isNotNull property="dsOrdCatgCd">
     AND CAX.DS_ORD_CATG_CD     = #dsOrdCatgCd#
    </isNotNull>
    <isNotNull property="dsOrdTpCd">
     <!-- QC#58769 Start -->
     AND CAX.DS_ORD_TP_CD    = #dsOrdTpCd#
     <!-- QC#58769 End -->
    </isNotNull>
    <isNotNull property="prchGrpCd">
     AND CAX.PRCH_GRP_CD     = #prchGrpCd#
    </isNotNull>
    <isNotNull property="poOrdSrcCd">
     AND CAX.PO_ORD_SRC_CD     = #poOrdSrcCd#
    </isNotNull>
    AND CAX.EZCANCELFLAG = '0'
    AND ROWNUM = 1
    </statement>
    <!-- QC#23356 END -->

    <statement id="getCarrSvcLvlCd" parameterClass="Map" resultClass="Map">
        SELECT
            SSLC.CARR_SVC_LVL_CD
        FROM
            SHPG_SVC_LVL_CARR_RELN SSLC
        WHERE
            SSLC.GLBL_CMPY_CD             = #glblCmpyCd#
        AND SSLC.SHPG_SVC_LVL_CD          = #shpgSvcLvlCd#
        AND SSLC.CARR_CD                  = #carrCd#
        AND SSLC.EZCANCELFLAG             = '0'
    </statement>

</sqlMap>