<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL1910Query">

	<typeAlias alias="NWAL1910SMsg"    type="business.blap.NWAL1910.NWAL1910SMsg"/>
	<typeAlias alias="NWAL1910_ASMsg"  type="business.blap.NWAL1910.NWAL1910_ASMsg"/>

    <statement id="getFromOrderEntry" parameterClass="Map" resultMap="result.getFromOrderEntry">
        SELECT DISTINCT
                REC.MDSE_CD
               ,REC.MDSE_DESC_SHORT_TXT
               ,REC.DS_ORD_POSN_NUM
               ,REC.DS_CPO_LINE_NUM
               ,REC.EZINUSERID
               ,REC.EZINTIME
               ,REC.UNIT_PRC_AMT
               ,PDG.PRC_DTL_GRP_DESC_TXT
               ,PDG.PRC_DTL_GRP_SORT_NUM 
        FROM (
              SELECT
                      CD.GLBL_CMPY_CD
                     ,CD.MDSE_CD
                     ,AMV.MDSE_DESC_SHORT_TXT
                     ,CD.DS_ORD_POSN_NUM
                     ,CD.DS_CPO_LINE_NUM
                     ,OPCBR.EZINUSERID
                     ,OPCBR.EZINTIME
                     ,OPCBR.UNIT_PRC_AMT
                     ,OPCBR.PRC_DTL_GRP_CD
              FROM
                      CPO_DTL CD
                     ,ORD_PRC_CALC_BASE_REC OPCBR
                     ,DS_CPO_CONFIG DCC
                     ,ALL_MDSE_V AMV
              WHERE
                      CD.CPO_ORD_NUM              = #cpoOrdNum#
                <isNotNull property="dsOrdPosnNum">
                  AND CD.DS_ORD_POSN_NUM          = #dsOrdPosnNum#
                </isNotNull>

                <isNotNull property="dsCpoLineNum">
                  AND CD.DS_CPO_LINE_NUM          = #dsCpoLineNum# 
                </isNotNull>

                  AND CD.GLBL_CMPY_CD             = #glblCmpyCd#
                  AND CD.EZCANCELFLAG             = '0'

                  AND CD.GLBL_CMPY_CD             = DCC.GLBL_CMPY_CD
                  AND CD.EZCANCELFLAG             = DCC.EZCANCELFLAG
                  AND CD.CPO_ORD_NUM              = DCC.CPO_ORD_NUM
                  AND CD.DS_ORD_POSN_NUM          = DCC.DS_ORD_POSN_NUM
                  AND DCC.CONFIG_CATG_CD          = #configCatgCd#

                  AND CD.CPO_ORD_NUM              = OPCBR.CPO_ORD_NUM
                  AND CD.DS_CPO_LINE_NUM          = OPCBR.CPO_DTL_LINE_NUM
                  AND CD.CPO_DTL_LINE_SUB_NUM     = OPCBR.CPO_DTL_LINE_SUB_NUM
                  AND OPCBR.PRC_DTL_GRP_CD NOT LIKE #rndFctr#
                  AND OPCBR.PRC_DTL_GRP_CD       != #tax#
                  AND CD.GLBL_CMPY_CD             = OPCBR.GLBL_CMPY_CD
                  AND OPCBR.EZCANCELFLAG          = '0'
                  
                  AND CD.MDSE_CD                  = AMV.MDSE_CD
                  AND CD.GLBL_CMPY_CD             = AMV.GLBL_CMPY_CD
                  AND AMV.EZCANCELFLAG            = '0'
                  <isEqual property="configCatgCd" compareValue="I">
                  AND 1 = 0
                  </isEqual>
                  
              UNION ALL
              SELECT
                      CD.GLBL_CMPY_CD
                     ,CD.MDSE_CD
                     ,AMV.MDSE_DESC_SHORT_TXT
                     ,CD.DS_ORD_POSN_NUM
                     ,CD.DS_CPO_LINE_NUM
                     ,OPCBR.EZINUSERID
                     ,OPCBR.EZINTIME
                     ,OPCBR.UNIT_PRC_AMT
                     ,OPCBR.PRC_DTL_GRP_CD
              FROM
                      DS_CPO_RTRN_DTL  CD
                     ,CPO_RTRN_CALC_BASE_REC  OPCBR
                     ,DS_CPO_CONFIG DCC
                     ,ALL_MDSE_V AMV
              WHERE
                      CD.CPO_ORD_NUM              = #cpoOrdNum#
                <isNotNull property="dsOrdPosnNum">
                  AND CD.DS_ORD_POSN_NUM          = #dsOrdPosnNum#
                </isNotNull>

                <isNotNull property="dsCpoLineNum">
                  AND CD.DS_CPO_LINE_NUM          = #dsCpoLineNum# 
                </isNotNull>

                  AND CD.GLBL_CMPY_CD             = #glblCmpyCd#
                  AND CD.EZCANCELFLAG             = '0'

                  AND CD.GLBL_CMPY_CD             = DCC.GLBL_CMPY_CD
                  AND CD.EZCANCELFLAG             = DCC.EZCANCELFLAG
                  AND CD.CPO_ORD_NUM              = DCC.CPO_ORD_NUM
                  AND CD.DS_ORD_POSN_NUM          = DCC.DS_ORD_POSN_NUM
                  AND DCC.CONFIG_CATG_CD          = #configCatgCd#

                  AND CD.CPO_ORD_NUM              = OPCBR.CPO_ORD_NUM
                  AND CD.DS_CPO_RTRN_LINE_NUM     = OPCBR.DS_CPO_RTRN_LINE_NUM
                  AND CD.DS_CPO_RTRN_LINE_SUB_NUM = OPCBR.DS_CPO_RTRN_LINE_SUB_NUM
                  AND OPCBR.PRC_DTL_GRP_CD NOT LIKE #rndFctr#
                  AND OPCBR.PRC_DTL_GRP_CD       != #tax#
                  AND CD.GLBL_CMPY_CD             = OPCBR.GLBL_CMPY_CD
                  AND OPCBR.EZCANCELFLAG          = '0'
                  
                  AND CD.MDSE_CD                  = AMV.MDSE_CD
                  AND CD.GLBL_CMPY_CD             = AMV.GLBL_CMPY_CD
                  AND AMV.EZCANCELFLAG            = '0'
                  <isEqual property="configCatgCd" compareValue="O">
                  AND 1 = 0
                  </isEqual>
        )   REC
           ,PRC_DTL_GRP PDG
        WHERE
                REC.PRC_DTL_GRP_CD = PDG.PRC_DTL_GRP_CD
            AND REC.GLBL_CMPY_CD   = PDG.GLBL_CMPY_CD
            AND PDG.EZCANCELFLAG   = '0'
        ORDER BY
                REC.EZINTIME DESC, REC.DS_ORD_POSN_NUM, REC.DS_CPO_LINE_NUM, PDG.PRC_DTL_GRP_SORT_NUM

    </statement>
    <resultMap id="result.getFromOrderEntry"   class="NWAL1910_ASMsg">
        <result property="mdseCd_A"              column="MDSE_CD"                 javaType="EZDSStringItem"/>
        <result property="mdseDescShortTxt_A"    column="MDSE_DESC_SHORT_TXT"     javaType="EZDSStringItem"/>
        <result property="dsOrdPosnNum_A"        column="DS_ORD_POSN_NUM"         javaType="EZDSStringItem"/>
        <result property="xxLineNum_A"           column="DS_CPO_LINE_NUM"         javaType="EZDSStringItem"/>
        <result property="xxSrUsrId_A"           column="EZINUSERID"              javaType="EZDSStringItem"/>
        <result property="xxDtTm_A"              column="EZINTIME"                javaType="EZDSStringItem"/>
        <result property="unitPrcAmt_A"          column="UNIT_PRC_AMT"            javaType="EZDSStringItem"/>
        <result property="prcDtlGrpDescTxt_A"    column="PRC_DTL_GRP_DESC_TXT"    javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getFromSupplyQuote" parameterClass="Map" resultMap="result.getFromSupplyQuote">
        SELECT DISTINCT
                REC.MDSE_CD
               ,REC.MDSE_DESC_SHORT_TXT
               ,REC.DPLY_QUOTE_LINE_NUM
               ,REC.EZINUSERID
               ,REC.EZINTIME
               ,REC.UNIT_PRC_AMT
               ,PDG.PRC_DTL_GRP_DESC_TXT
               ,PDG.PRC_DTL_GRP_SORT_NUM 
        FROM (
              SELECT
                      SQD.GLBL_CMPY_CD
                     ,SQD.MDSE_CD
                     ,AMV.MDSE_DESC_SHORT_TXT
                     ,SQD.DPLY_QUOTE_LINE_NUM
                     ,SQCBR.ORD_PRC_CALC_BASE_PK AS BASE_PK
                     ,SQCBR.EZINUSERID
                     ,SQCBR.EZINTIME
                     ,SQCBR.UNIT_PRC_AMT
                     ,SQCBR.PRC_DTL_GRP_CD
              FROM
                      SPLY_QUOTE_DTL SQD
                     ,SPLY_QUOTE_CALC_BASE_REC SQCBR
                     ,ALL_MDSE_V AMV
              WHERE
                      SQD.SPLY_QUOTE_NUM             = #splyQuoteNum#
                <isNotNull property="dplyQuoteLineNum">
                  AND SQD.DPLY_QUOTE_LINE_NUM        = #dplyQuoteLineNum#
                </isNotNull>
                  AND SQD.GLBL_CMPY_CD               = #glblCmpyCd#
                  AND SQD.EZCANCELFLAG               = '0'

                 AND SQD.SPLY_QUOTE_NUM              = SQCBR.SPLY_QUOTE_NUM
                 AND SQD.SPLY_QUOTE_DTL_LINE_NUM     = SQCBR.SPLY_QUOTE_DTL_LINE_NUM
                 AND SQD.SPLY_QUOTE_DTL_LINE_SUB_NUM = SQCBR.SPLY_QUOTE_DTL_LINE_SUB_NUM
                 AND SQCBR.PRC_DTL_GRP_CD NOT LIKE     #rndFctr#
                 AND SQCBR.PRC_DTL_GRP_CD           != #tax#
                 AND SQD.GLBL_CMPY_CD                = SQCBR.GLBL_CMPY_CD
                 AND SQCBR.EZCANCELFLAG              = '0'
                 
                 AND SQD.MDSE_CD                     = AMV.MDSE_CD
                 AND SQD.GLBL_CMPY_CD                = AMV.GLBL_CMPY_CD
                 AND AMV.EZCANCELFLAG                = '0'
        )   REC
           ,PRC_DTL_GRP PDG
        WHERE
                REC.PRC_DTL_GRP_CD = PDG.PRC_DTL_GRP_CD
            AND REC.GLBL_CMPY_CD   = PDG.GLBL_CMPY_CD
            AND PDG.EZCANCELFLAG   = '0'
        ORDER BY
                REC.EZINTIME DESC, REC.DPLY_QUOTE_LINE_NUM, PDG.PRC_DTL_GRP_SORT_NUM


    </statement>
    <resultMap id="result.getFromSupplyQuote"   class="NWAL1910_ASMsg">
        <result property="mdseCd_A"              column="MDSE_CD"                 javaType="EZDSStringItem"/>
        <result property="mdseDescShortTxt_A"    column="MDSE_DESC_SHORT_TXT"     javaType="EZDSStringItem"/>
        <result property="xxLineNum_A"           column="DPLY_QUOTE_LINE_NUM"     javaType="EZDSStringItem"/>
        <result property="xxSrUsrId_A"           column="EZINUSERID"              javaType="EZDSStringItem"/>
        <result property="xxDtTm_A"              column="EZINTIME"                javaType="EZDSStringItem"/>
        <result property="unitPrcAmt_A"          column="UNIT_PRC_AMT"            javaType="EZDSStringItem"/>
        <result property="prcDtlGrpDescTxt_A"    column="PRC_DTL_GRP_DESC_TXT"    javaType="EZDSStringItem"/>
    </resultMap>
    
    <statement id="getFromScheduleAgreement" parameterClass="Map" resultMap="result.getFromScheduleAgreement">
        SELECT DISTINCT
                REC.MDSE_CD
               ,REC.MDSE_DESC_SHORT_TXT
               ,REC.SCHD_AGMT_LINE_NUM
               ,REC.EZINUSERID
               ,REC.EZINTIME
               ,REC.UNIT_PRC_AMT
               ,PDG.PRC_DTL_GRP_DESC_TXT
               ,PDG.PRC_DTL_GRP_SORT_NUM
        FROM (
              SELECT
                      SAL.GLBL_CMPY_CD
                     ,SAL.MDSE_CD
                     ,AMV.MDSE_DESC_SHORT_TXT
                     ,SAL.SCHD_AGMT_LINE_NUM
                     ,SACBR.SCHD_AGMT_PRC_CALC_BASE_PK AS BASE_PK
                     ,SACBR.EZINUSERID
                     ,SACBR.EZINTIME
                     ,SACBR.UNIT_PRC_AMT
                     ,SACBR.PRC_DTL_GRP_CD
              FROM
                      SCHD_AGMT_LINE SAL
                     ,SCHD_AGMT_CALC_BASE_REC SACBR
                     ,ALL_MDSE_V AMV
              WHERE
                      SAL.SCHD_AGMT_NUM           = #schdAgmtNum#
                <isNotNull property="schdAgmtLineNum">
                  AND SAL.SCHD_AGMT_LINE_NUM      = #schdAgmtLineNum#
                </isNotNull>
                  AND SAL.GLBL_CMPY_CD            = #glblCmpyCd#
                  AND SAL.EZCANCELFLAG            = '0'

                  AND SAL.SCHD_AGMT_NUM           = SACBR.SCHD_AGMT_NUM
                  AND SAL.SCHD_AGMT_LINE_NUM      = SACBR.SCHD_AGMT_LINE_NUM
                  AND SACBR.PRC_DTL_GRP_CD NOT LIKE #rndFctr#
                  AND SACBR.PRC_DTL_GRP_CD       != #tax#
                  AND SAL.GLBL_CMPY_CD            = SACBR.GLBL_CMPY_CD
                  AND SACBR.EZCANCELFLAG          = '0'

                  AND SAL.MDSE_CD                 = AMV.MDSE_CD
                  AND SAL.GLBL_CMPY_CD            = AMV.GLBL_CMPY_CD
                  AND AMV.EZCANCELFLAG            = '0'
        )   REC
           ,PRC_DTL_GRP PDG
        WHERE
                REC.PRC_DTL_GRP_CD = PDG.PRC_DTL_GRP_CD
            AND REC.GLBL_CMPY_CD   = PDG.GLBL_CMPY_CD
            AND PDG.EZCANCELFLAG   = '0'
        ORDER BY
                REC.EZINTIME DESC, REC.SCHD_AGMT_LINE_NUM, PDG.PRC_DTL_GRP_SORT_NUM
                
    </statement>
    <resultMap id="result.getFromScheduleAgreement"   class="NWAL1910_ASMsg">
        <result property="mdseCd_A"              column="MDSE_CD"                 javaType="EZDSStringItem"/>
        <result property="mdseDescShortTxt_A"    column="MDSE_DESC_SHORT_TXT"     javaType="EZDSStringItem"/>
        <result property="xxLineNum_A"           column="SCHD_AGMT_LINE_NUM"      javaType="EZDSStringItem"/>
        <result property="xxSrUsrId_A"           column="EZINUSERID"              javaType="EZDSStringItem"/>
        <result property="xxDtTm_A"              column="EZINTIME"                javaType="EZDSStringItem"/>
        <result property="unitPrcAmt_A"          column="UNIT_PRC_AMT"            javaType="EZDSStringItem"/>
        <result property="prcDtlGrpDescTxt_A"    column="PRC_DTL_GRP_DESC_TXT"    javaType="EZDSStringItem"/>
    </resultMap>
</sqlMap>