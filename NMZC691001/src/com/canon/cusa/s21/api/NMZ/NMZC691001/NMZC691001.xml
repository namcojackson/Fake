<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NMZC691001">

    <statement id="countSellToCustomer" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(STC.GLBL_CMPY_CD)
    FROM
        SELL_TO_CUST STC
    WHERE
        STC.GLBL_CMPY_CD = #glblCmpyCd#
    AND STC.EZCANCELFLAG  = '0'
    AND STC.SELL_TO_CUST_CD = #sellToCustCd#
    AND STC.RGTN_STS_CD = #rgtnStsCd#
    </statement>

    <statement id="getDsAcctRelnList" parameterClass="Map" resultClass="Map">
    SELECT
        DAR.DS_ACCT_RELN_PK
    FROM
        DS_ACCT_RELN DAR
    WHERE
        DAR.GLBL_CMPY_CD = #glblCmpyCd#
    AND DAR.EZCANCELFLAG  = '0'
    AND DAR.DS_ACCT_NUM = #relatedAccountFrom#
    AND DAR.RELN_DS_ACCT_NUM = #relatedAccountTo#
    AND DAR.DS_ACCT_RELN_TP_CD = #relationType#
    AND (
        DAR.RGTN_STS_CD = #rgtnStsCd01#
        OR
        DAR.RGTN_STS_CD = #rgtnStsCd02#
        )
    ORDER BY EFF_FROM_DT
    </statement>

</sqlMap>
