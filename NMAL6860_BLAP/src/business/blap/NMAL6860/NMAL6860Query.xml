<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NMAL6860Query">

    <!-- Alias Definition -->
    <typeAlias alias="NMAL6860SMsg"        type="business.blap.NMAL6860.NMAL6860SMsg"/>
    <typeAlias alias="NMAL6860_ASMsg"      type="business.blap.NMAL6860.NMAL6860_ASMsg"/>
    <typeAlias alias="NMAL6860_BSMsg"      type="business.blap.NMAL6860.NMAL6860_BSMsg"/>

    <statement id="searchSupplier" parameterClass="Map" resultMap="result.Supplier">
        SELECT
                PV.PRNT_VND_CD          AS  PRNT_VND_CD
              , PV.PRNT_VND_NM          AS  PRNT_VND_NM
              , PV.PRNT_VND_TP_CD       AS  PRNT_VND_TP_CD
              , PVT.PRNT_VND_TP_DESC_TXT AS  PRNT_VND_TP_DESC_TXT <!-- 2020/02/28 QC#55971 Add -->
              , PVT.VND_TP_CD           AS  VND_TP_CD
              , PV.TAX_PAYER_ID         AS  TAX_PAYER_ID
              , PV.INAC_DT              AS  INAC_DT
              , PV.TAX_PAYER_RG_NUM     AS  TAX_PAYER_RG_NUM
              , PV.ARCS_SPLY_NUM        AS  ARCS_SPLY_NUM
              , PV.ARCS_SPLY_ID         AS  ARCS_SPLY_ID
              , PV.DS_ACCT_NUM          AS  DS_ACCT_NUM
              , PV.COA_AFFL_CD          AS  COA_AFFL_CD
              , PV.INDY_TP_CD           AS  INDY_TP_CD
              , PV.MNRTY_OWND_TP_CD     AS  MNRTY_OWND_TP_CD
              , PV.SPLY_ORG_TP_CD       AS  SPLY_ORG_TP_CD
              , PV.SPLY_ONE_TM_FLG      AS  SPLY_ONE_TM_FLG
              , PV.SM_BIZ_FLG           AS  SM_BIZ_FLG
              , PV.WOMEN_OWND_FLG       AS  WOMEN_OWND_FLG
              , PV.PAY_ALONE_FLG        AS  PAY_ALONE_FLG
              , PV.DISC_TAKE_FLG        AS  DISC_TAKE_FLG
              , PV.PO_PMT_HLD_FLG       AS  PO_PMT_HLD_FLG
              , PV.VND_PMT_TERM_CD      AS  VND_PMT_TERM_CD
              , PV.VND_PMT_TERM_DESC_TXT AS  VND_PMT_TERM_DESC_TXT
              , PV.VND_PMT_METH_CD      AS  VND_PMT_METH_CD
              , PV.PAY_GRP_CD           AS  PAY_GRP_CD
              , PV.FD_RPT_FLG           AS  FD_RPT_FLG
              , PV.INC_TAX_TP_CD        AS  INC_TAX_TP_CD
              , PV.ST_TAX_FLG           AS  ST_TAX_FLG
              , PV.SPLY_RPT_NM          AS  SPLY_RPT_NM
              , PV.SPLY_HUB_ZN_CD       AS  SPLY_HUB_ZN_CD
          FROM
                PRNT_VND          PV
              , PRNT_VND_TP       PVT
         WHERE
            <!-- query condition. -->
                PV.GLBL_CMPY_CD         =       #glblCmpyCd#
            AND PV.PRNT_VND_PK          =       #prntVndPk#
            AND PV.GLBL_CMPY_CD         =       PVT.GLBL_CMPY_CD
            AND PV.PRNT_VND_TP_CD       =       PVT.PRNT_VND_TP_CD
            AND PV.EZCANCELFLAG         =       '0'
            AND PVT.EZCANCELFLAG        =       '0'
    </statement>

    <resultMap id="result.Supplier" class="NMAL6860SMsg">
        <result property="prntVndCd"         column="PRNT_VND_CD"       javaType="EZDSStringItem"/>
        <result property="prntVndNm"         column="PRNT_VND_NM"       javaType="EZDSStringItem"/>
        <result property="prntVndTpCd"       column="PRNT_VND_TP_CD"    javaType="EZDSStringItem"/>
        <result property="prntVndTpDescTxt"  column="PRNT_VND_TP_DESC_TXT"    javaType="EZDSStringItem"/> <!-- 2020/02/28 QC#55971 Add -->
        <result property="vndTpCd"           column="VND_TP_CD"         javaType="EZDSStringItem"/>
        <result property="taxPayerId_H1"     column="TAX_PAYER_ID"      javaType="EZDSStringItem"/>
        <result property="inacDt_H1"         column="INAC_DT"           javaType="EZDSStringItem"/>
        <result property="inacDt_G1"         column="INAC_DT"           javaType="EZDSStringItem"/>
        <result property="taxPayerRgNum_H1"  column="TAX_PAYER_RG_NUM"  javaType="EZDSStringItem"/>
        <result property="arcsSplyNum_H1"    column="ARCS_SPLY_NUM"     javaType="EZDSStringItem"/>
        <result property="arcsSplyId_H1"     column="ARCS_SPLY_ID"      javaType="EZDSStringItem"/>
        <result property="dsAcctNum_H1"      column="DS_ACCT_NUM"       javaType="EZDSStringItem"/>
        <result property="coaAfflCd_H1"      column="COA_AFFL_CD"       javaType="EZDSStringItem"/>
        <result property="indyTpCd_H1"       column="INDY_TP_CD"        javaType="EZDSStringItem"/>
        <result property="mnrtyOwndTpCd_H1"  column="MNRTY_OWND_TP_CD"  javaType="EZDSStringItem"/>
        <result property="splyOrgTpCd_H1"    column="SPLY_ORG_TP_CD"    javaType="EZDSStringItem"/>
        <result property="splyOneTmFlg_H1"   column="SPLY_ONE_TM_FLG"   javaType="EZDSStringItem"/>
        <result property="smBizFlg_H1"       column="SM_BIZ_FLG"        javaType="EZDSStringItem"/>
        <result property="womenOwndFlg_H1"   column="WOMEN_OWND_FLG"    javaType="EZDSStringItem"/>
        <result property="payAloneFlg_H1"    column="PAY_ALONE_FLG"     javaType="EZDSStringItem"/>
        <result property="discTakeFlg_H1"    column="DISC_TAKE_FLG"     javaType="EZDSStringItem"/>
        <result property="poPmtHldFlg_H1"    column="PO_PMT_HLD_FLG"    javaType="EZDSStringItem"/>
        <result property="vndPmtTermCd_H1"   column="VND_PMT_TERM_CD"   javaType="EZDSStringItem"/>
        <result property="vndPmtTermDescTxt_H1" column="VND_PMT_TERM_DESC_TXT"   javaType="EZDSStringItem"/>
        <result property="vndPmtMethCd_H1"   column="VND_PMT_METH_CD"   javaType="EZDSStringItem"/>
        <result property="payGrpCd_H1"       column="PAY_GRP_CD"        javaType="EZDSStringItem"/>
        <result property="fdRptFlg_H1"       column="FD_RPT_FLG"        javaType="EZDSStringItem"/>
        <result property="incTaxTpCd_H1"     column="INC_TAX_TP_CD"     javaType="EZDSStringItem"/>
        <result property="stTaxFlg_H1"       column="ST_TAX_FLG"        javaType="EZDSStringItem"/>
        <result property="splyRptNm_H1"      column="SPLY_RPT_NM"       javaType="EZDSStringItem"/>
        <result property="splyHubZnCd_H1"    column="SPLY_HUB_ZN_CD"    javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="searchSupplierSites" parameterClass="Map" resultMap="result.SupplierSites">
        SELECT
                VD.VND_PK                                  AS  VND_PK
              , VD.VND_CD                                  AS  VND_CD
              , VD.LOC_NM                                  AS  LOC_NM
              , VD.PTY_LOC_PK                              AS  PTY_LOC_PK
              , VD.CTRY_CD                                 AS  CTRY_CD
              , VD.FIRST_LINE_ADDR || VD.SCD_LINE_ADDR     AS  FIRST_LINE_ADDR
              , VD.THIRD_LINE_ADDR || VD.FRTH_LINE_ADDR    AS  SCD_LINE_ADDR
              , VD.CTY_ADDR                                AS  CTY_ADDR
              , VD.POST_CD                                 AS  POST_CD
              , VD.ST_CD                                   AS  ST_CD
              , VD.EFF_FROM_DT                             AS  EFF_FROM_DT
              , VD.TRSMT_METH_TP_CD                        AS  TRSMT_METH_TP_CD
              , CT.CNTY_NM                                 AS  CNTY_NM
              , VD.SPLY_PMT_FLG                            AS  SPLY_PMT_FLG
              , CASE WHEN PVT.VND_TP_CD = #vndTpCd#
                    THEN 'Y'
                    ELSE VD.SPLY_PO_FLG
                END                                        AS  SPLY_PO_FLG
              , CASE WHEN VD.SPLY_COA_ACCT_CD IS NULL
                    THEN NULL
                    ELSE VD.SPLY_COA_CMPY_CD  || '.' ||
                         VD.SPLY_COA_BR_CD    || '.' ||
                         VD.SPLY_COA_CC_CD    || '.' ||
                         VD.SPLY_COA_ACCT_CD  || '.' ||
                         VD.SPLY_COA_PROD_CD  || '.' ||
                         VD.SPLY_COA_CH_CD    || '.' ||
                         VD.SPLY_COA_AFFL_CD  || '.' ||
                         VD.SPLY_COA_PROJ_CD  || '.' ||
                         VD.SPLY_COA_EXTN_CD
                END                                        AS  SPLY_COA
              , VD.INV_MATCH_TP_CD                         AS  INV_MATCH_TP_CD
              , VD.INV_TOL_RATE                            AS  INV_TOL_RATE
              , VD.RCV_TOL_RATE                            AS  RCV_TOL_RATE
              , VD.VND_PMT_TERM_CD                         AS  VND_PMT_TERM_CD
              , VD.VND_PMT_TERM_DESC_TXT                   AS  VND_PMT_TERM_DESC_TXT
              , VD.VND_PMT_METH_CD                         AS  VND_PMT_METH_CD
              , VD.PAY_GRP_CD                              AS  PAY_GRP_CD
              , VD.SPLY_EDI_LOC_CD                         AS  SPLY_EDI_LOC_CD
              , VD.SPLY_EDI_NUM                            AS  SPLY_EDI_NUM
              , VD.INAC_DT                                 AS  INAC_DT
              , VD.SPLY_SITE_DEAL_CD                       AS  SPLY_SITE_DEAL_CD
              , CASE WHEN VD.PRE_PMT_COA_ACCT_CD IS NULL
                    THEN NULL
                    ELSE VD.PRE_PMT_COA_CMPY_CD  || '.' ||
                         VD.PRE_PMT_COA_BR_CD    || '.' ||
                         VD.PRE_PMT_COA_CC_CD    || '.' ||
                         VD.PRE_PMT_COA_ACCT_CD  || '.' ||
                         VD.PRE_PMT_COA_PROD_CD  || '.' ||
                         VD.PRE_PMT_COA_CH_CD    || '.' ||
                         VD.PRE_PMT_COA_AFFL_CD  || '.' ||
                         VD.PRE_PMT_COA_PROJ_CD  || '.' ||
                         VD.PRE_PMT_COA_EXTN_CD
                END                                        AS  PRE_PMT_COA
              , CASE WHEN VD.VND_RTRN_COA_ACCT_CD IS NULL
                    THEN NULL
                    ELSE VD.VND_RTRN_COA_CMPY_CD  || '.' ||
                         VD.VND_RTRN_COA_BR_CD    || '.' ||
                         VD.VND_RTRN_COA_CC_CD    || '.' ||
                         VD.VND_RTRN_COA_ACCT_CD  || '.' ||
                         VD.VND_RTRN_COA_PROD_CD  || '.' ||
                         VD.VND_RTRN_COA_CH_CD    || '.' ||
                         VD.VND_RTRN_COA_AFFL_CD  || '.' ||
                         VD.VND_RTRN_COA_PROJ_CD  || '.' ||
                         VD.VND_RTRN_COA_EXTN_CD
                END                                        AS  VND_RTRN_COA
              , VD.XTRNL_REF_NUM                           AS  XTRNL_REF_NUM
              , VD.END_CUST_NUM                            AS  END_CUST_NUM
              , VD.ARCS_SPLY_SITE_CD                       AS  ARCS_SPLY_SITE_CD
              , VD.ARCS_SPLY_SITE_ID                       AS  ARCS_SPLY_SITE_ID
              , VD.BILL_TO_CUST_CD                         AS  BILL_TO_CUST_CD
              , VD.LOC_NUM                                 AS  VND_LOC_NUM
              , BT.LOC_NUM                                 AS  BILL_TO_LOC_NUM
              , VD.SEND_ARCS_FLG                           AS  SEND_ARCS_FLG
          FROM
                VND               VD
              , PRNT_VND          PV
              , PRNT_VND_TP       PVT
              , CNTY              CT
              , BILL_TO_CUST      BT
         WHERE
            <!-- join condition. -->
                VD.GLBL_CMPY_CD         =       PV.GLBL_CMPY_CD
            AND VD.PRNT_VND_PK          =       PV.PRNT_VND_PK
            AND PV.GLBL_CMPY_CD         =       PVT.GLBL_CMPY_CD
            AND PV.PRNT_VND_TP_CD       =       PVT.PRNT_VND_TP_CD
            AND VD.GLBL_CMPY_CD         =       CT.GLBL_CMPY_CD(+)
            AND VD.CNTY_PK              =       CT.CNTY_PK(+)
            AND VD.GLBL_CMPY_CD         =       BT.GLBL_CMPY_CD(+)
            AND VD.BILL_TO_CUST_CD      =       BT.BILL_TO_CUST_CD(+)
            <!-- query condition. -->
            AND VD.GLBL_CMPY_CD         =       #glblCmpyCd#
            AND VD.PRNT_VND_PK          =       #prntVndPk#
            AND VD.EZCANCELFLAG         =       '0'
            AND PV.EZCANCELFLAG         =       '0'
            AND PVT.EZCANCELFLAG        =       '0'
            AND CT.EZCANCELFLAG(+)      =       '0'
            AND BT.EZCANCELFLAG(+)      =       '0'
       ORDER BY
                VD.VND_CD
    </statement>

    <resultMap id="result.SupplierSites" class="NMAL6860_ASMsg">
        <result property="vndPk_A"                 column="VND_PK"                  javaType="EZDSBigDecimalItem"/>
        <result property="vndCd_A"                 column="VND_CD"                  javaType="EZDSStringItem"/>
        <result property="locNm_A"                 column="LOC_NM"                  javaType="EZDSStringItem"/>
        <result property="ptyLocPk_A"              column="PTY_LOC_PK"              javaType="EZDSBigDecimalItem"/>
        <result property="ctryCd_A"                column="CTRY_CD"                 javaType="EZDSStringItem"/>
        <result property="xxComnScrFirstValTxt_A"  column="FIRST_LINE_ADDR"         javaType="EZDSStringItem"/>
        <result property="xxComnScrScdValTxt_A"    column="SCD_LINE_ADDR"           javaType="EZDSStringItem"/>
        <result property="ctyAddr_A"               column="CTY_ADDR"                javaType="EZDSStringItem"/>
        <result property="postCd_A"                column="POST_CD"                 javaType="EZDSStringItem"/>
        <result property="stCd_A"                  column="ST_CD"                   javaType="EZDSStringItem"/>
        <result property="effFromDt_A"             column="EFF_FROM_DT"             javaType="EZDSStringItem"/>
        <result property="trsmtMethTpCd_A"         column="TRSMT_METH_TP_CD"        javaType="EZDSStringItem"/>
        <result property="cntyNm_A"                column="CNTY_NM"                 javaType="EZDSStringItem"/>
        <result property="splyPmtFlg_A"            column="SPLY_PMT_FLG"            javaType="EZDSStringItem"/>
        <result property="splyPoFlg_A"             column="SPLY_PO_FLG"             javaType="EZDSStringItem"/>
        <result property="xxComnScrFirstValTxt_AL" column="SPLY_COA"                javaType="EZDSStringItem"/>
        <result property="invMatchTpCd_A"          column="INV_MATCH_TP_CD"         javaType="EZDSStringItem"/>
        <result property="invTolRate_A"            column="INV_TOL_RATE"            javaType="EZDSBigDecimalItem"/>
        <result property="rcvTolRate_A"            column="RCV_TOL_RATE"            javaType="EZDSBigDecimalItem"/>
        <result property="vndPmtTermCd_A"          column="VND_PMT_TERM_CD"         javaType="EZDSStringItem"/>
        <result property="vndPmtTermDescTxt_A"     column="VND_PMT_TERM_DESC_TXT"   javaType="EZDSStringItem"/>
        <result property="vndPmtMethCd_A"          column="VND_PMT_METH_CD"         javaType="EZDSStringItem"/>
        <result property="payGrpCd_A"              column="PAY_GRP_CD"              javaType="EZDSStringItem"/>
        <result property="splyEdiLocCd_A"          column="SPLY_EDI_LOC_CD"         javaType="EZDSStringItem"/>
        <result property="splyEdiNum_A"            column="SPLY_EDI_NUM"            javaType="EZDSStringItem"/>
        <result property="inacDt_A"                column="INAC_DT"                 javaType="EZDSStringItem"/>
        <result property="splySiteDealCd_A"        column="SPLY_SITE_DEAL_CD"       javaType="EZDSStringItem"/>
        <result property="xxComnScrFirstValTxt_AP" column="PRE_PMT_COA"             javaType="EZDSStringItem"/>
        <result property="xxComnScrFirstValTxt_AV" column="VND_RTRN_COA"            javaType="EZDSStringItem"/>
        <result property="xtrnlRefNum_A"           column="XTRNL_REF_NUM"           javaType="EZDSStringItem"/>
        <result property="endCustNum_A"            column="END_CUST_NUM"            javaType="EZDSStringItem"/>
        <result property="arcsSplySiteCd_A"        column="ARCS_SPLY_SITE_CD"       javaType="EZDSStringItem"/>
        <result property="arcsSplySiteId_A"        column="ARCS_SPLY_SITE_ID"       javaType="EZDSStringItem"/>
        <result property="billToCustCd_A"          column="BILL_TO_CUST_CD"         javaType="EZDSStringItem"/>
        <!-- QC#16594-1 Mod Start. -->
        <result property="locNum_A1"               column="VND_LOC_NUM"             javaType="EZDSStringItem"/>
        <result property="locNum_A2"               column="BILL_TO_LOC_NUM"         javaType="EZDSStringItem"/>
        <!-- QC#16594-1 Mod End. -->
        <result property="sendArcsFlg_A"           column="SEND_ARCS_FLG"           javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="searchContactInfo" parameterClass="Map" resultMap="result.ContactInfo">
        SELECT
                VD.VND_CD                     AS  VND_CD
              , CP.CTAC_PSN_PK                AS  CTAC_PSN_PK
              , CP.CTAC_PSN_LAST_NM           AS  CTAC_PSN_LAST_NM
              , CP.CTAC_PSN_FIRST_NM          AS  CTAC_PSN_FIRST_NM
              , DCR.CTAC_TP_CD                AS  CTAC_TP_CD
              , DECODE(DCR.EFF_THRU_DT
                          , NULL, NULL
                          , #defThruDt#, DCR.EFF_THRU_DT
                          , TO_CHAR(TO_DATE(DCR.EFF_THRU_DT, 'yyyymmdd') + 1, 'yyyymmdd'))
                                              AS INAC_DT
              , CP.DS_CTAC_PSN_DEPT_CD        AS  DS_CTAC_PSN_DEPT_CD
              , CP.DS_CTAC_PSN_TTL_CD         AS  DS_CTAC_PSN_TTL_CD
              , P_T.DS_CTAC_PNT_PK            AS  DS_CTAC_PNT_PK_TEL
              , P_T.DS_CTAC_PNT_VAL_TXT       AS  CTAC_PSN_TEL
              , P_F.DS_CTAC_PNT_PK            AS  DS_CTAC_PNT_PK_FAX
              , P_F.DS_CTAC_PNT_VAL_TXT       AS  CTAC_PSN_FAX
              , P_E.DS_CTAC_PNT_PK            AS  DS_CTAC_PNT_PK_EML
              , P_E.DS_CTAC_PNT_VAL_TXT       AS  CTAC_PSN_EML
              , DCR.LOC_NUM                   AS  LOC_NUM
          FROM
                VND               VD
              , DS_CTAC_PSN_RELN  DCR
              , CTAC_PSN          CP
              , DS_CTAC_PNT       P_T
              , DS_CTAC_PNT       P_F
              , DS_CTAC_PNT       P_E
         WHERE
            <!-- join condition. -->
                VD.GLBL_CMPY_CD             =       DCR.GLBL_CMPY_CD
            AND VD.LOC_NUM                  =       DCR.LOC_NUM
            AND DCR.GLBL_CMPY_CD            =       CP.GLBL_CMPY_CD
            AND DCR.CTAC_PSN_PK             =       CP.CTAC_PSN_PK
            AND DCR.CTAC_TP_CD             !=       #ctacTpCdDI#
            AND CP.GLBL_CMPY_CD             =       P_T.GLBL_CMPY_CD(+)
            AND CP.CTAC_PSN_PK              =       P_T.CTAC_PSN_PK(+)
            AND CP.GLBL_CMPY_CD             =       P_F.GLBL_CMPY_CD(+)
            AND CP.CTAC_PSN_PK              =       P_F.CTAC_PSN_PK(+)
            AND CP.GLBL_CMPY_CD             =       P_E.GLBL_CMPY_CD(+)
            AND CP.CTAC_PSN_PK              =       P_E.CTAC_PSN_PK(+)
            <!-- query condition. -->
            AND VD.GLBL_CMPY_CD             =       #glblCmpyCd#
            AND VD.PRNT_VND_PK              =       #prntVndPk#
            AND CP.CTAC_PSN_ACTV_FLG        =       #ctacPsnActvFlg#
            AND P_T.DS_CTAC_PNT_TP_CD(+)    =       #dsCtacPntTpCd_T#
            AND P_F.DS_CTAC_PNT_TP_CD(+)    =       #dsCtacPntTpCd_F#
            AND P_E.DS_CTAC_PNT_TP_CD(+)    =       #dsCtacPntTpCd_E#
            AND VD.EZCANCELFLAG             =       '0'
            AND DCR.EZCANCELFLAG            =       '0'
            AND CP.EZCANCELFLAG             =       '0'
            AND P_T.EZCANCELFLAG(+)         =       '0'
            AND P_F.EZCANCELFLAG(+)         =       '0'
            AND P_E.EZCANCELFLAG(+)         =       '0'
       ORDER BY
                VD.VND_CD
              , CP.CTAC_PSN_LAST_NM
              , CP.CTAC_PSN_FIRST_NM
    </statement>

    <resultMap id="result.ContactInfo" class="NMAL6860_BSMsg">
        <result property="vndCd_B"             column="VND_CD"                javaType="EZDSStringItem"/>
        <result property="ctacPsnPk_B"         column="CTAC_PSN_PK"           javaType="EZDSBigDecimalItem"/>
        <result property="ctacPsnLastNm_B"     column="CTAC_PSN_LAST_NM"      javaType="EZDSStringItem"/>
        <result property="ctacPsnFirstNm_B"    column="CTAC_PSN_FIRST_NM"     javaType="EZDSStringItem"/>
        <result property="ctacTpCd_B"          column="CTAC_TP_CD"            javaType="EZDSStringItem"/>
        <result property="dsCtacPsnDeptCd_B"   column="DS_CTAC_PSN_DEPT_CD"   javaType="EZDSStringItem"/>
        <result property="dsCtacPsnTtlCd_B"    column="DS_CTAC_PSN_TTL_CD"    javaType="EZDSStringItem"/>
        <result property="inacDt_B"            column="INAC_DT"               javaType="EZDSStringItem"/>
        <result property="dsCtacPntPk_BT"      column="DS_CTAC_PNT_PK_TEL"    javaType="EZDSBigDecimalItem"/>
        <result property="dsCtacPntValTxt_BT"  column="CTAC_PSN_TEL"          javaType="EZDSStringItem"/>
        <result property="dsCtacPntPk_BF"      column="DS_CTAC_PNT_PK_FAX"    javaType="EZDSBigDecimalItem"/>
        <result property="dsCtacPntValTxt_BF"  column="CTAC_PSN_FAX"          javaType="EZDSStringItem"/>
        <result property="dsCtacPntPk_BE"      column="DS_CTAC_PNT_PK_EML"    javaType="EZDSBigDecimalItem"/>
        <result property="dsCtacPntValTxt_BE"  column="CTAC_PSN_EML"          javaType="EZDSStringItem"/>
        <result property="locNum_B"            column="LOC_NUM"               javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="searchAccountCustomer" parameterClass="Map" resultClass="Map">
        SELECT
                DAC.SELL_TO_CUST_CD      AS  DS_ACCT_NUM
              , DAC.DS_ACCT_NM           AS  DS_ACCT_NM
              , BLT.BILL_TO_CUST_CD      AS  BILL_TO_CUST_CD
              , BLT.LOC_NM               AS  LOC_NM
              , BLT.CTRY_CD              AS  CTRY_CD
              , BLT.FIRST_LINE_ADDR || BLT.SCD_LINE_ADDR     AS  FIRST_LINE_ADDR
              , BLT.THIRD_LINE_ADDR || BLT.FRTH_LINE_ADDR    AS  SCD_LINE_ADDR
              , BLT.CTY_ADDR             AS  CTY_ADDR
              , BLT.POST_CD              AS  POST_CD
              , BLT.ST_CD                AS  ST_CD
              , CNT.CNTY_NM              AS  CNTY_NM
          FROM
                BILL_TO_CUST          BLT
              , SELL_TO_CUST          DAC
              , CNTY                  CNT
         WHERE
            <!-- join condition. -->
                BLT.GLBL_CMPY_CD      =      DAC.GLBL_CMPY_CD
            AND BLT.SELL_TO_CUST_CD   =      DAC.SELL_TO_CUST_CD
            AND BLT.GLBL_CMPY_CD      =      CNT.GLBL_CMPY_CD(+)
            AND BLT.CNTY_PK           =      CNT.CNTY_PK(+)
            <!-- query condition. -->
            AND BLT.GLBL_CMPY_CD      =      #glblCmpyCd#
            AND BLT.BILL_TO_CUST_CD   =      #billToCustCd#
            AND BLT.EZCANCELFLAG      =      '0'
            AND DAC.EZCANCELFLAG      =      '0'
            AND CNT.EZCANCELFLAG(+)   =      '0'
    </statement>

    <statement id="searchDefaultVendorInfo" parameterClass="Map" resultClass="Map">
        SELECT
                PRNT_VND_TP_CD
              , TAX_PAYER_ID
              , SPLY_ONE_TM_FLG
              , SM_BIZ_FLG
              , WOMEN_OWND_FLG
              , PAY_ALONE_FLG
              , DISC_TAKE_FLG
              , PO_PMT_HLD_FLG
              , PRNT_VND_PMT_TERM_DESC_TXT
              , PRNT_VND_PMT_METH_CD
              , PRNT_VND_PAY_GRP_CD
              , SPLY_PMT_FLG
              , SPLY_PO_FLG
              , INV_MATCH_TP_CD
              , VND_PMT_TERM_DESC_TXT
              , VND_PMT_METH_CD
              , VND_PAY_GRP_CD
              , SPLY_COA_CMPY_CD  || '.' ||
                SPLY_COA_BR_CD    || '.' ||
                SPLY_COA_CC_CD    || '.' ||
                SPLY_COA_ACCT_CD  || '.' ||
                SPLY_COA_PROD_CD  || '.' ||
                SPLY_COA_CH_CD    || '.' ||
                SPLY_COA_AFFL_CD  || '.' ||
                SPLY_COA_PROJ_CD  || '.' ||
                SPLY_COA_EXTN_CD                    AS  SPLY_COA
              , PRE_PMT_COA_CMPY_CD  || '.' ||
                PRE_PMT_COA_BR_CD    || '.' ||
                PRE_PMT_COA_CC_CD    || '.' ||
                PRE_PMT_COA_ACCT_CD  || '.' ||
                PRE_PMT_COA_PROD_CD  || '.' ||
                PRE_PMT_COA_CH_CD    || '.' ||
                PRE_PMT_COA_AFFL_CD  || '.' ||
                PRE_PMT_COA_PROJ_CD  || '.' ||
                PRE_PMT_COA_EXTN_CD                 AS  PRE_PMT_COA
          FROM
                DEF_VND_INFO
          WHERE
                GLBL_CMPY_CD      =      #glblCmpyCd#
            AND PRNT_VND_TP_CD    =      #prntVndTpCd#
            AND EZCANCELFLAG      =      '0'
    </statement>

    <statement id="checkDirectSalesVendor" parameterClass="Map" resultClass="Map">
        SELECT
                PVD.PRNT_VND_PK                            AS  PRNT_VND_PK
              , DVD.VND_PK                                 AS  VND_PK
          FROM
                PRNT_VND           PVD
              , VND                DVD
         WHERE
            <!-- join condition. -->
                PVD.GLBL_CMPY_CD        =       DVD.GLBL_CMPY_CD
            AND PVD.PRNT_VND_PK         =       DVD.PRNT_VND_PK
            <!-- query condition. -->
            AND PVD.GLBL_CMPY_CD        =       #glblCmpyCd#
            AND PVD.DS_ACCT_NUM         =       #dsAcctNum#
            AND PVD.PRNT_VND_TP_CD      =       #prntVndTpCd#
            AND PVD.EZCANCELFLAG        =       '0'
            AND DVD.EZCANCELFLAG        =       '0'
    </statement>

    <statement id="checkAccountCustomer" parameterClass="Map" resultClass="Map">
        SELECT
                DAC.SELL_TO_CUST_PK                        AS  DS_ACCT_CUST_PK
          FROM
                SELL_TO_CUST          DAC
         WHERE
                DAC.GLBL_CMPY_CD        =       #glblCmpyCd#
            AND DAC.SELL_TO_CUST_CD     =       #dsAcctNum#
            AND DAC.EZCANCELFLAG        =       '0'
    </statement>

    <statement id="checkBillToCustomer" parameterClass="Map" resultClass="Map">
        SELECT
                BLT.BILL_TO_CUST_CD      AS  BILL_TO_CUST_CD
          FROM
                BILL_TO_CUST          BLT
         WHERE
                BLT.GLBL_CMPY_CD      =      #glblCmpyCd#
            AND BLT.BILL_TO_CUST_CD   =      #billToCustCd#
            AND BLT.EZCANCELFLAG      =      '0'
    </statement>

    <statement id="checkCustomerLocationAndNumber" parameterClass="Map" resultClass="Map">
        SELECT
                BLT.BILL_TO_CUST_PK      AS  BILL_TO_CUST_PK
          FROM
                BILL_TO_CUST          BLT
         WHERE
            <!-- query condition. -->
                BLT.GLBL_CMPY_CD      =      #glblCmpyCd#
            AND BLT.BILL_TO_CUST_CD   =      #billToCustCd#
            AND BLT.SELL_TO_CUST_CD   =      #sellToCustCd#
            AND BLT.EZCANCELFLAG      =      '0'
    </statement>

    <statement id="getPrntVndPk" parameterClass="Map"  resultClass="BigDecimal">
        SELECT
                PV.PRNT_VND_PK          AS  PRNT_VND_PK
          FROM
                PRNT_VND          PV
         WHERE
            <!-- query condition. -->
                PV.GLBL_CMPY_CD       =      #glblCmpyCd#
            AND PV.PRNT_VND_CD        =      #prntVndCd#
            AND PV.INAC_DT            =      #inacDt#
            AND PV.EZCANCELFLAG       =      '0'
    </statement>

    <statement id="getCreatedLocNum" parameterClass="Map"  resultClass="String">
        SELECT
            LOC_NUM
        FROM
            VND V
        WHERE 1=1
            AND V.GLBL_CMPY_CD       =      #glblCmpyCd#
            AND V.VND_CD             =      #vndCd#
            AND V.EZCANCELFLAG       =      '0'
            AND ROWNUM               =       1
    </statement>

    <statement id="getAddrByPost" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
               P.CTY_ADDR
             , P.ST_CD
             , P.POST_CD
             , C.CNTY_NM
             , C.CNTY_PK
          FROM 
               POST P
             , CNTY_POST_RELN R
             , CNTY C
         WHERE 
               P.EZCANCELFLAG = '0'
           AND P.GLBL_CMPY_CD = #glblCmpyCd#
           AND P.POST_CD = #postCd#
           AND R.EZCANCELFLAG(+) = '0'
           AND R.GLBL_CMPY_CD(+) = P.GLBL_CMPY_CD
           AND R.POST_PK(+) = P.POST_PK
           AND C.EZCANCELFLAG(+) = '0'
           AND C.GLBL_CMPY_CD(+) = R.GLBL_CMPY_CD
           AND C.CNTY_PK(+) = R.CNTY_PK 
         ORDER BY
               P.CTY_ADDR
             , P.ST_CD
             , P.POST_CD
             , C.CNTY_NM
    </statement>

    <statement id="getCtacTpList" parameterClass="Map" resultClass="Map">
        SELECT
             CT.CTAC_TP_CD
            ,CT.CTAC_TP_DESC_TXT
        FROM
            CTAC_TP CT
        WHERE
            CT.GLBL_CMPY_CD    = #glblCmpyCd#
        AND CT.SPLY_IND_FLG    = 'Y'
        AND CT.ACTV_FLG        = 'Y'
        AND CT.EZCANCELFLAG    = '0'
        ORDER BY 
            CT.CTAC_TP_SORT_NUM
    </statement>

    <statement id="getPrntVndTpList" parameterClass="Map" resultClass="Map">
        SELECT
             PVT.PRNT_VND_TP_CD
            ,PVT.PRNT_VND_TP_DESC_TXT
            ,PVT.VND_TP_CD
        FROM
            PRNT_VND_TP PVT
        WHERE
            PVT.GLBL_CMPY_CD    = #glblCmpyCd#
        AND PVT.EZCANCELFLAG    = '0'
        ORDER BY 
            PVT.PRNT_VND_TP_SORT_NUM
    </statement>

    <statement id="getVndPmtTermCd" parameterClass="Map"  resultClass="String">
        SELECT
            VND_PMT_TERM_CD
        FROM
            VND_PMT_TERM VPT
        WHERE
            VPT.GLBL_CMPY_CD            = #glblCmpyCd#
        AND VPT.EZCANCELFLAG            = '0'
        AND VPT.VND_PMT_TERM_DESC_TXT   = #vndPmtTermDescTxt#
    </statement>
    <statement id="getPrntVndPkforNm" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            PV.PRNT_VND_PK
        FROM
            PRNT_VND PV
        WHERE
            PV.GLBL_CMPY_CD   = #glblCmpyCd#
        AND PV.PRNT_VND_NM    = #prntVndNm#
        AND PV.PRNT_VND_TP_CD = #prntVndTpCd#
        <isNotNull property="prntVndPk">
        AND PV.PRNT_VND_PK   != #prntVndPk#
        </isNotNull>
        AND PV.EZCANCELFLAG   = '0'
    </statement>
    <!-- START 2020/08/31 R.Kurahashi [QC#57546,ADD] -->
    <statement id="getCustInfoForPrimBill" parameterClass="Map" resultMap="String">
        SELECT
            BILL.BILL_TO_CUST_CD AS BILL_TO_CUST_CD
        FROM
            BILL_TO_CUST BILL
          , ACCT_LOC     AC
          , PTY_LOC_WRK  PLW
          , SELL_TO_CUST STC
        WHERE 
            BILL.GLBL_CMPY_CD       = #glblCmpyCd#
        AND BILL.EZCANCELFLAG       = '0'
        <!-- AND BILL.RGTN_STS_CD        = #rgtnStsCd# -->
        AND BILL.SELL_TO_CUST_CD    = #acctNum#
        AND BILL.PRIM_USG_FLG       = 'Y'
        AND PLW.GLBL_CMPY_CD        = BILL.GLBL_CMPY_CD
        AND PLW.PTY_LOC_PK          = BILL.PTY_LOC_PK
        AND PLW.RGTN_STS_CD         = #rgtnStsCd#
        AND PLW.EZCANCELFLAG        = '0'
        AND AC.GLBL_CMPY_CD         = PLW.GLBL_CMPY_CD
        AND AC.LOC_NUM              = PLW.LOC_NUM
        AND AC.RGTN_STS_CD          = #rgtnStsCd#
        AND AC.EZCANCELFLAG         = '0'
        AND AC.GLBL_CMPY_CD         = STC.GLBL_CMPY_CD
        AND AC.DS_ACCT_NUM          = STC.SELL_TO_CUST_CD
        AND STC.RGTN_STS_CD         = #rgtnStsCd#
        AND STC.EZCANCELFLAG        = '0'
    </statement>
    <statement id="getCustInfoForPrimShip" parameterClass="Map" resultMap="String">
        SELECT 
            SHIP.SHIP_TO_CUST_CD AS SHIP_TO_CUST_CD
        FROM
            SHIP_TO_CUST SHIP
          , ACCT_LOC     AC
          , PTY_LOC_WRK  PLW
          , SELL_TO_CUST STC
        WHERE 
            SHIP.GLBL_CMPY_CD       = #glblCmpyCd#
        AND SHIP.EZCANCELFLAG       = '0'
        AND SHIP.RGTN_STS_CD        = #rgtnStsCd#
        AND SHIP.SELL_TO_CUST_CD    = #acctNum#
        AND SHIP.PRIM_USG_FLG       = 'Y'
        AND PLW.GLBL_CMPY_CD        = SHIP.GLBL_CMPY_CD
        AND PLW.PTY_LOC_PK          = SHIP.PTY_LOC_PK
        AND PLW.RGTN_STS_CD         = #rgtnStsCd#
        AND PLW.EZCANCELFLAG        = '0'
        AND AC.GLBL_CMPY_CD         = PLW.GLBL_CMPY_CD
        AND AC.LOC_NUM              = PLW.LOC_NUM
        AND AC.RGTN_STS_CD          = #rgtnStsCd#
        AND AC.EZCANCELFLAG         = '0'
        AND AC.GLBL_CMPY_CD         = STC.GLBL_CMPY_CD
        AND AC.DS_ACCT_NUM          = STC.SELL_TO_CUST_CD
        AND STC.RGTN_STS_CD         = #rgtnStsCd#
        AND STC.EZCANCELFLAG        = '0'
    </statement>
    <statement id = "getBillToShipToFromPrimLoc" parameterClass="Map" resultClass="Map">
        SELECT
            WRK.BILL_TO_CUST_CD         BILL_TO_CUST_CD
            , WRK.SHIP_TO_CUST_CD      SHIP_TO_CUST_CD
            , WRK.PRIN_CUST_PK           PRIN_CUST_PK
        FROM
            (
            SELECT
                BTC.BILL_TO_CUST_CD         BILL_TO_CUST_CD
                , SHTC.SHIP_TO_CUST_CD      SHIP_TO_CUST_CD
                , PC.PRIN_CUST_PK           PRIN_CUST_PK
            FROM
                SELL_TO_CUST STC
                , ACCT_LOC AC
                , PTY_LOC_WRK PLW
                , PRIN_CUST PC
                , BILL_TO_CUST BTC
                , SHIP_TO_CUST SHTC
            WHERE
                STC.GLBL_CMPY_CD            = #glblCmpyCd#
                AND STC.SELL_TO_CUST_CD     = #acctNum#
                AND STC.EZCANCELFLAG        = '0'

                AND STC.GLBL_CMPY_CD        = AC.GLBL_CMPY_CD
                AND STC.SELL_TO_CUST_CD     = AC.DS_ACCT_NUM
                AND AC.RGTN_STS_CD          = #rgtnStsCd#
                AND AC.EZCANCELFLAG         = '0'

                AND AC.GLBL_CMPY_CD         = PLW.GLBL_CMPY_CD
                AND AC.LOC_NUM              = PLW.LOC_NUM
                AND PLW.RGTN_STS_CD         = #rgtnStsCd#
                AND PLW.EZCANCELFLAG        = '0'

                AND PLW.GLBL_CMPY_CD        = PC.GLBL_CMPY_CD(+)
                AND PLW.LOC_NUM             = PC.LOC_NUM(+)
                AND PC.EZCANCELFLAG(+)      = '0'

                AND PLW.GLBL_CMPY_CD        = BTC.GLBL_CMPY_CD(+)
                AND PLW.PTY_LOC_PK          = BTC.PTY_LOC_PK(+)
                AND BTC.RGTN_STS_CD(+)      = #rgtnStsCd#
                AND BTC.EZCANCELFLAG(+)     = '0'

                AND PLW.GLBL_CMPY_CD        = SHTC.GLBL_CMPY_CD(+)
                AND PLW.PTY_LOC_PK          = SHTC.PTY_LOC_PK(+)
                AND SHTC.RGTN_STS_CD(+)     = #rgtnStsCd#
                AND SHTC.EZCANCELFLAG(+)    = '0'
            ORDER BY
                PC.PRIN_CUST_PK NULLS LAST) WRK
        WHERE
             ROWNUM &lt;= #rownum#
    </statement>
    <!-- END 2020/08/31 R.Kurahashi [QC#57546,ADD] -->
    <!-- START 2020/10/28 R.Kurahashi [QC#57732,ADD] -->
    <statement id = "getPrntVndNm" parameterClass="Map" resultClass="String">
        SELECT
             PV.PRNT_VND_NM AS PRNT_VND_NM
        FROM
             PRNT_VND_TP    PVT
            ,PRNT_VND       PV
        WHERE
            PVT.GLBL_CMPY_CD          = #glblCmpyCd#
        AND PVT.SEND_ARCS_FLG         = 'Y'
        AND PVT.ARCS_VND_TP_LKUP_TXT  IS NOT NULL
        AND PVT.GLBL_CMPY_CD          = PV.GLBL_CMPY_CD
        AND PVT.PRNT_VND_TP_CD        = PV.PRNT_VND_TP_CD
        AND PVT.EZCANCELFLAG          = '0'
        AND PV.EZCANCELFLAG           = '0'
        AND PRNT_VND_NM               = #prntVndNm#
        <isNotNull property="prntVndPk">
        AND PRNT_VND_PK               &lt;&gt; #prntVndPk#
        </isNotNull>
    </statement>
    <statement id = "getPrntVndNmForPrntVndTpCd" parameterClass="Map" resultClass="String">
        SELECT
             PV.PRNT_VND_NM AS PRNT_VND_NM
        FROM
             PRNT_VND       PV
        WHERE
            PV.GLBL_CMPY_CD           = #glblCmpyCd#
        AND PV.EZCANCELFLAG           = '0'
        AND PV.PRNT_VND_TP_CD         = #prntVndTpCd#
        AND PRNT_VND_NM               = #prntVndNm#
        <isNotNull property="prntVndPk">
        AND PRNT_VND_PK               &lt;&gt; #prntVndPk#
        </isNotNull>
    </statement>
    <!-- END 2020/10/28 R.Kurahashi [QC#57732,ADD] -->
    <!-- START 2021/03/01 G.Delgado [QC#56057,ADD] -->
    <statement id="checkSupplierOpenPo" parameterClass="Map" resultClass="Map">
        SELECT
            P.PO_ORD_NUM
        FROM
             PO             P
            ,PO_STS         PS
            ,PRNT_VND       PV
            ,VND            V
        WHERE 1=1
            AND P.GLBL_CMPY_CD            = #glblCmpyCd#
            AND PV.PRNT_VND_CD            = #prntVndCd#
            <isNotNull property="vndCd">
            AND V.VND_CD                  = #vndCd#
            </isNotNull>
            AND PS.GLBL_CMPY_CD           = P.GLBL_CMPY_CD
            AND PV.GLBL_CMPY_CD           = P.GLBL_CMPY_CD
            AND V.GLBL_CMPY_CD            = P.GLBL_CMPY_CD
            AND P.PO_STS_CD               = PS.PO_STS_CD
            AND P.VND_CD                  = V.VND_CD
            AND PV.PRNT_VND_PK            = V.PRNT_VND_PK
            AND PS.OPEN_PO_FLG            = 'Y'
            AND P.EZCANCELFLAG            = '0'
            AND PS.EZCANCELFLAG           = '0'
            AND PV.EZCANCELFLAG           = '0'
            AND V.EZCANCELFLAG            = '0'
    </statement>
    <statement id="checkSupplierOpenAp" parameterClass="Map" resultClass="Map">
        SELECT
            CAIH.AP_VND_INV_NUM
        FROM
             CM_AP_INV_HDR  CAIH
            ,PRNT_VND       PV
            ,VND            V
        WHERE 1=1
            AND CAIH.GLBL_CMPY_CD         = #glblCmpyCd#
            AND PV.PRNT_VND_CD            = #prntVndCd#
            <isNotNull property="vndCd">
            AND V.VND_CD                  = #vndCd#
            </isNotNull>
            <iterate property="openAcctInvStsCds" var="acctInvStsCd[]" open="AND CAIH.ACCT_INV_STS_CD     IN (" close=")" conjunction=",">
            #acctInvStsCd[]#
            </iterate>
            AND PV.GLBL_CMPY_CD           = CAIH.GLBL_CMPY_CD
            AND V.GLBL_CMPY_CD            = CAIH.GLBL_CMPY_CD
            AND CAIH.AP_VND_CD            = V.VND_CD
            AND PV.PRNT_VND_PK            = V.PRNT_VND_PK
            AND CAIH.EZCANCELFLAG         = '0'
            AND PV.EZCANCELFLAG           = '0'
            AND V.EZCANCELFLAG            = '0'
    </statement>
    <statement id="getPrntVndTpCdforDescTxt" parameterClass="Map" resultClass="String">
        SELECT
            PVT.PRNT_VND_TP_CD
        FROM
            PRNT_VND_TP PVT
        WHERE
            PVT.GLBL_CMPY_CD              = #glblCmpyCd#
        AND PVT.PRNT_VND_TP_DESC_TXT      = #prntVndTpDescTxt#
        AND PVT.EZCANCELFLAG              = '0'
    </statement>
    <!-- END 2021/03/01 G.Delgado [QC#56057,ADD] -->
</sqlMap>