<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAL2830Query">

    <typeAlias alias="NMAL2830SMsg"    type="business.blap.NMAL2830.NMAL2830SMsg"/>
    <typeAlias alias="NMAL2830_BSMsg"  type="business.blap.NMAL2830.NMAL2830_BSMsg"/>
    <typeAlias alias="NMAL2830_CSMsg"  type="business.blap.NMAL2830.NMAL2830_CSMsg"/>

    <statement id="getSavedSearchOptionList" parameterClass="Map" resultClass="Map">
        SELECT
               SSO.SRCH_OPT_PK
             , SSO.SRCH_OPT_NM
         FROM
             SAVE_SRCH_OPT SSO 
         WHERE
             SSO.GLBL_CMPY_CD        = #glblCmpyCd#
             AND SSO.SRCH_OPT_APL_ID = #srchOptAplId#
             AND SSO.SRCH_OPT_USR_ID = #srchOptUsrId#
             AND SSO.EZCANCELFLAG    = '0'
         ORDER BY
               SSO.SRCH_OPT_NM
    </statement>

    <statement id="getProspectList" parameterClass="Map" resultMap="result.getProspectList">
       <isNotNull property="dispTrtyFlg">
        WITH
            TRTY_W AS (
                SELECT
                     SP.PSN_CD                                   AS PSN_CD
                    ,DOU.ORG_CD                                  AS ORG_CD
                    ,OFA.TOC_CD                                  AS TOC_CD
                    ,(SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM)  AS PSN_NM
                FROM
                     DS_ORG_UNIT         DOU
                    ,ORG_STRU_TP         OST
                    ,BIZ_AREA_ORG        BAO
                    ,DS_ORG_RESRC_RELN   DORR
                    ,S21_PSN             SP
                    ,ORG_FUNC_ASG        OFA
                    ,TOC                 TOC
                    ,ORG_FUNC_ROLE_TP    OFRT
                    ,S21_ORG             SO
                WHERE
                        DOU.GLBL_CMPY_CD        = #glblCmpyCd#
                    AND DOU.EZCANCELFLAG        = '0'
                    AND DOU.ORG_CD              = DORR.ORG_CD
                    <isNotNull property="orgNm_TN">
                        AND DOU.ORG_NM           LIKE #orgNm_TN#
                    </isNotNull>
                    AND DOU.ORG_STRU_TP_CD      = DORR.ORG_STRU_TP_CD
                    
                    AND DOU.GLBL_CMPY_CD        = OST.GLBL_CMPY_CD
                    AND OST.EZCANCELFLAG        = '0'
                    AND DOU.ORG_STRU_TP_CD      = OST.ORG_STRU_TP_CD
                    AND OST.TRTY_STRU_FLG       = 'Y'
                    
                    AND DOU.GLBL_CMPY_CD        = BAO.GLBL_CMPY_CD
                    AND BAO.EZCANCELFLAG        = '0'
                    AND DOU.FIRST_ORG_CD        = BAO.BIZ_AREA_ORG_CD
                    AND DOU.ORG_STRU_TP_CD      = BAO.ORG_STRU_TP_CD
                    
                    AND DOU.GLBL_CMPY_CD        = DORR.GLBL_CMPY_CD
                    AND DORR.EZCANCELFLAG       = '0'
                    AND DOU.ORG_CD              = DORR.ORG_CD
                    AND DORR.EFF_FROM_DT       &lt;= #salesDate#
                    AND NVL(DORR.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                    AND DORR.ACCT_TEAM_ROLE_TP_CD  IS NULL
                    AND DORR.GNRN_TP_CD         = #gnrnTpCd_2#
                    
                    AND DORR.GLBL_CMPY_CD       = SP.GLBL_CMPY_CD
                    AND SP.EZCANCELFLAG         = '0'
                    AND DORR.PSN_CD             = SP.PSN_CD
                    <isNotNull property="psnCd">
                        AND SP.PSN_CD            LIKE #psnCd#
                    </isNotNull>
                    <isNotNull property="fill65Txt_RN">
                        AND (SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM) LIKE #fill65Txt_RN#
                    </isNotNull>
                    
                    AND SP.GLBL_CMPY_CD          = OFA.GLBL_CMPY_CD(+)
                    AND OFA.EZCANCELFLAG(+)      = '0'
                    AND SP.PSN_CD                = OFA.PSN_CD(+)
                    AND OFA.EFF_FROM_DT(+)      &lt;= #salesDate#
                    AND NVL(OFA.EFF_THRU_DT(+), #max_date#)       &gt;= #salesDate#
                    AND OFA.GNRN_TP_CD(+)        = #gnrnTpCd_2#
                    
                    AND OFA.GLBL_CMPY_CD         = TOC.GLBL_CMPY_CD(+)
                    AND TOC.EZCANCELFLAG(+)      = '0'
                    AND OFA.TOC_CD               = TOC.TOC_CD(+)
                    
                    AND TOC.GLBL_CMPY_CD         = OFRT.GLBL_CMPY_CD(+)
                    AND OFRT.EZCANCELFLAG(+)     = '0'
                    AND TOC.ORG_FUNC_ROLE_TP_CD  = OFRT.ORG_FUNC_ROLE_TP_CD(+)
                    AND OFRT.ACTV_FLG(+)         = 'Y'
                    AND OFRT.SLS_REP_FLG(+)      = 'Y'
                    
                    AND TOC.GLBL_CMPY_CD         = SO.GLBL_CMPY_CD(+)
                    AND SO.EZCANCELFLAG(+)       = '0'
                    AND TOC.TOC_CD               = SO.TOC_CD(+)
                    AND SO.RGTN_STS_CD(+)        = #rgtnStsCd_P20#
                    <isNotNull property="orgNm_ON">
                        AND (SO.FRTH_ORG_NM(+)      LIKE #orgNm_ON#
                             OR SO.FIFTH_ORG_NM(+)  LIKE #orgNm_ON#
                             OR SO.SIXTH_ORG_NM(+)  LIKE #orgNm_ON#
                             OR SO.SVNTH_ORG_NM(+)  LIKE #orgNm_ON#
                             OR SO.EIGHTH_ORG_NM(+) LIKE #orgNm_ON#
                             OR SO.NINTH_ORG_NM(+)  LIKE #orgNm_ON#
                             OR SO.TENTH_ORG_NM(+)  LIKE #orgNm_ON#
                             OR SO.ELVTH_ORG_NM(+)  LIKE #orgNm_ON#
                            )
                    </isNotNull>
                    )
       </isNotNull>
                    SELECT
                         A.DS_ACCT_NUM
                        ,A.DS_ACCT_TP_CD
                        ,A.DS_ACCT_TP_DESC_TXT
                        ,A.LOC_NUM
                        ,A.FIRST_LINE_ADDR
                        ,A.SCD_LINE_ADDR
                        ,A.THIRD_LINE_ADDR
                        ,A.FRTH_LINE_ADDR
                        ,A.CTY_ADDR
                        ,A.POST_CD
                        ,A.ST_CD
                        ,A.DS_ACCT_NM
                       <isNotNull property="dispTrtyFlg">
                        ,A.ORG_CD_01
                        ,A.LOB_ROLE_NM_01
                        ,A.PSN_NM_01
                        ,A.ORG_CD_02
                        ,A.LOB_ROLE_NM_02
                        ,A.PSN_NM_02
                        ,A.ORG_CD_03
                        ,A.LOB_ROLE_NM_03
                        ,A.PSN_NM_03
                        ,A.ORG_CD_04
                        ,A.LOB_ROLE_NM_04
                        ,A.PSN_NM_04
                        ,A.ORG_CD_05
                        ,A.LOB_ROLE_NM_05
                        ,A.PSN_NM_05
                        ,A.ORG_CD_06
                        ,A.LOB_ROLE_NM_06
                        ,A.PSN_NM_06
                        ,A.ORG_CD_07
                        ,A.LOB_ROLE_NM_07
                        ,A.PSN_NM_07
                        ,A.ORG_CD_08
                        ,A.LOB_ROLE_NM_08
                        ,A.PSN_NM_08
                        ,A.ORG_CD_09
                        ,A.LOB_ROLE_NM_09
                        ,A.PSN_NM_09
                        ,A.ORG_CD_10
                        ,A.LOB_ROLE_NM_10
                        ,A.PSN_NM_10
                        ,A.ORG_CD_11
                        ,A.LOB_ROLE_NM_11
                        ,A.PSN_NM_11
                        ,A.ORG_CD_12
                        ,A.LOB_ROLE_NM_12
                        ,A.PSN_NM_12
                        ,A.ORG_CD_13
                        ,A.LOB_ROLE_NM_13
                        ,A.PSN_NM_13
                        ,A.ORG_CD_14
                        ,A.LOB_ROLE_NM_14
                        ,A.PSN_NM_14
                        ,A.ORG_CD_15
                        ,A.LOB_ROLE_NM_15
                        ,A.PSN_NM_15
                        ,A.ORG_CD_16
                        ,A.LOB_ROLE_NM_16
                        ,A.PSN_NM_16
                        ,A.ORG_CD_17
                        ,A.LOB_ROLE_NM_17
                        ,A.PSN_NM_17
                        ,A.ORG_CD_18
                        ,A.LOB_ROLE_NM_18
                        ,A.PSN_NM_18
                        ,A.ORG_CD_19
                        ,A.LOB_ROLE_NM_19
                        ,A.PSN_NM_19
                        ,A.ORG_CD_20
                        ,A.LOB_ROLE_NM_20
                        ,A.PSN_NM_20
                       </isNotNull>
                        ,A.SFDC_DS_XREF_ACCT_CD
                        ,A.OASIS_DS_XREF_ACCT_CD
                        ,A.DUNS_NUM
                        ,A.DS_LOC_NM
                    FROM
                    (
                        SELECT DISTINCT
                             DAP.DS_ACCT_NUM          AS DS_ACCT_NUM
                            ,DAP.DS_ACCT_TP_CD        AS DS_ACCT_TP_CD
                            ,DAT.DS_ACCT_TP_DESC_TXT  AS DS_ACCT_TP_DESC_TXT
                            ,DAP.LOC_NUM              AS LOC_NUM
                            ,PLW.FIRST_LINE_ADDR      AS FIRST_LINE_ADDR
                            ,PLW.SCD_LINE_ADDR        AS SCD_LINE_ADDR
                            ,PLW.THIRD_LINE_ADDR      AS THIRD_LINE_ADDR
                            ,PLW.FRTH_LINE_ADDR       AS FRTH_LINE_ADDR
                            ,PLW.CTY_ADDR             AS CTY_ADDR
                            ,PLW.POST_CD              AS POST_CD
                            ,PLW.ST_CD                AS ST_CD
                            ,PLW.DS_ACCT_NM          AS DS_ACCT_NM
                           <isNotNull property="dispTrtyFlg">
                            -- 01
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_01 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_01 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_01
                             ELSE NULL END AS ORG_CD_01
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_01) 
                             ELSE NULL END AS LOB_ROLE_NM_01
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_01 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_01) 
                             ELSE NULL END AS PSN_NM_01
                            -- 02
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_02 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_02 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_02
                             ELSE NULL END AS ORG_CD_02
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_02) 
                             ELSE NULL END AS LOB_ROLE_NM_02
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_02 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_02) 
                             ELSE NULL END AS PSN_NM_02
                            -- 03
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_03 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_03 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_03
                             ELSE NULL END AS ORG_CD_03
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_03) 
                             ELSE NULL END AS LOB_ROLE_NM_03
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_03 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_03) 
                             ELSE NULL END AS PSN_NM_03
                            -- 04
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_04 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_04 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_04
                             ELSE NULL END AS ORG_CD_04
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_04) 
                             ELSE NULL END AS LOB_ROLE_NM_04
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_04 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_04) 
                             ELSE NULL END AS PSN_NM_04
                            -- 05
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_05 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_05 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_05
                             ELSE NULL END AS ORG_CD_05
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_05) 
                             ELSE NULL END AS LOB_ROLE_NM_05
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_05 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_05) 
                             ELSE NULL END AS PSN_NM_05
                            -- 06
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_06 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_06 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_06
                             ELSE NULL END AS ORG_CD_06
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_06) 
                             ELSE NULL END AS LOB_ROLE_NM_06
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_06 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_06) 
                             ELSE NULL END AS PSN_NM_06
                            -- 07
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_07 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_07 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_07
                             ELSE NULL END AS ORG_CD_07
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_07) 
                             ELSE NULL END AS LOB_ROLE_NM_07
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_07 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_07) 
                             ELSE NULL END AS PSN_NM_07
                            -- 08
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_08 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_08 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_08
                             ELSE NULL END AS ORG_CD_08
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_08) 
                             ELSE NULL END AS LOB_ROLE_NM_08
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_08 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_08) 
                             ELSE NULL END AS PSN_NM_08
                            -- 09
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_09 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_09 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_09
                             ELSE NULL END AS ORG_CD_09
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_09) 
                             ELSE NULL END AS LOB_ROLE_NM_09
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_09 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_09) 
                             ELSE NULL END AS PSN_NM_09
                            -- 10
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_10 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_10 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_10
                             ELSE NULL END AS ORG_CD_10
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_10) 
                             ELSE NULL END AS LOB_ROLE_NM_10
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_10 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_10) 
                             ELSE NULL END AS PSN_NM_10
                            -- 11
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_11 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_11 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_11
                             ELSE NULL END AS ORG_CD_11
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_11) 
                             ELSE NULL END AS LOB_ROLE_NM_11
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_11 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_11) 
                             ELSE NULL END AS PSN_NM_11
                            -- 12
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_12 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_12 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_12
                             ELSE NULL END AS ORG_CD_12
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_12) 
                             ELSE NULL END AS LOB_ROLE_NM_12
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_12 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_12) 
                             ELSE NULL END AS PSN_NM_12
                            -- 13
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_13 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_13 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_13
                             ELSE NULL END AS ORG_CD_13
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_13) 
                             ELSE NULL END AS LOB_ROLE_NM_13
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_13 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_13) 
                             ELSE NULL END AS PSN_NM_13
                            -- 14
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_14 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_14 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_14
                             ELSE NULL END AS ORG_CD_14
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_14) 
                             ELSE NULL END AS LOB_ROLE_NM_14
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_14 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_14) 
                             ELSE NULL END AS PSN_NM_14
                            -- 15
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_15 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_15 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_15
                             ELSE NULL END AS ORG_CD_15
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_15) 
                             ELSE NULL END AS LOB_ROLE_NM_15
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_15 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_15) 
                             ELSE NULL END AS PSN_NM_15
                            -- 16
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_16 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_16 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_16
                             ELSE NULL END AS ORG_CD_16
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_16) 
                             ELSE NULL END AS LOB_ROLE_NM_16
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_16 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_16) 
                             ELSE NULL END AS PSN_NM_16
                            -- 17
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_17 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_17 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_17
                             ELSE NULL END AS ORG_CD_17
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_17) 
                             ELSE NULL END AS LOB_ROLE_NM_17
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_17 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_17) 
                             ELSE NULL END AS PSN_NM_17
                            -- 18
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_18 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_18 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_18
                             ELSE NULL END AS ORG_CD_18
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_18) 
                             ELSE NULL END AS LOB_ROLE_NM_18
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_18 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_18) 
                             ELSE NULL END AS PSN_NM_18
                            -- 19
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_19 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_19 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_19
                             ELSE NULL END AS ORG_CD_19
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_19) 
                             ELSE NULL END AS LOB_ROLE_NM_19
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_19 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_19) 
                             ELSE NULL END AS PSN_NM_19
                            -- 20
                            ,CASE WHEN ATRA.ACCT_TRTY_ORG_CD_20 IS NOT NULL AND ATRA.ACCT_TRTY_ORG_CD_20 = TW.ORG_CD
                             THEN ATRA.ACCT_TRTY_ORG_CD_20
                             ELSE NULL END AS ORG_CD_20
                            ,CASE WHEN ATRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = 'ADB' AND LBRT.LINE_BIZ_ROLE_TP_CD = ATRA.LINE_BIZ_ROLE_TP_CD_20) 
                             ELSE NULL END AS LOB_ROLE_NM_20
                            ,CASE WHEN ATRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = 'ADB' AND SP.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_20 AND TW.PSN_CD = ATRA.ACCT_TRTY_PSN_CD_20) 
                             ELSE NULL END AS PSN_NM_20
                           </isNotNull>
                            ,DXA_S.DS_XREF_ACCT_CD  AS SFDC_DS_XREF_ACCT_CD
                            ,DXA_O.DS_XREF_ACCT_CD  AS OASIS_DS_XREF_ACCT_CD
                            ,PLW.DUNS_NUM           AS DUNS_NUM
                            ,PLW.DS_LOC_NM         AS DS_LOC_NM
                        FROM
                             DS_ACCT_PROS         DAP
                            ,DS_ACCT_TP           DAT
                            ,PROS_PTY_LOC_WRK     PLW
                            ,DS_XREF_ACCT         DXA_S
                            ,DS_XREF_ACCT         DXA_O
                           <isNotNull property="dispTrtyFlg">
                            ,PROS_TRTY_RESRC_ASG  ATRA
                            ,TRTY_W               TW
                           </isNotNull>
                        WHERE
                                DAP.GLBL_CMPY_CD          = #glblCmpyCd#
                            AND DAP.EZCANCELFLAG          = '0'
                            <isNotNull property="dsAcctNm">
                                AND DAP.DS_ACCT_NM       LIKE #dsAcctNm#
                            </isNotNull>
                            AND DAP.RGTN_STS_CD           = #rgtnStsCd_P01#
                            <isNotNull property="dsAcctNum">
                                AND DAP.DS_ACCT_NUM      LIKE #dsAcctNum#
                            </isNotNull>
                            AND DAP.DS_ACCT_ACTV_CUST_FLG = 'Y'
                            
                            AND DAP.GLBL_CMPY_CD          = DAT.GLBL_CMPY_CD(+)
                            AND DAT.EZCANCELFLAG(+)       = '0'
                            AND DAP.DS_ACCT_TP_CD         = DAT.DS_ACCT_TP_CD(+)
                            
                            <isNotNull property="locNum">
                                AND DAP.LOC_NUM           LIKE #locNum#
                            </isNotNull>
                            
                            AND DAP.GLBL_CMPY_CD           = PLW.GLBL_CMPY_CD
                            AND PLW.EZCANCELFLAG          = '0'
                            AND DAP.LOC_NUM                = PLW.LOC_NUM
                            <isNotNull property="xxFromDt">
                                AND SUBSTR(PLW.EZINTIME,1,8) &gt;= #xxFromDt#
                            </isNotNull>
                            <isNotNull property="xxToDt">
                                AND SUBSTR(PLW.EZINTIME,1,8) &lt;= #xxToDt#
                            </isNotNull>
                            <isNotNull property="xxAllLineAddr">
                                AND (PLW.FIRST_LINE_ADDR ||' '||
                                     PLW.SCD_LINE_ADDR   ||' '||
                                     PLW.THIRD_LINE_ADDR ||' '||
                                     PLW.FRTH_LINE_ADDR) LIKE #xxAllLineAddr#
                            </isNotNull>
                            <isNotNull property="ctyAddr">
                                AND PLW.CTY_ADDR         LIKE #ctyAddr#
                            </isNotNull>
                            <isNotNull property="postCd">
                                AND PLW.POST_CD          LIKE #postCd#
                            </isNotNull>
                            <isNotNull property="stCd">
                                AND PLW.ST_CD            = #stCd#
                            </isNotNull>
                            
                            AND PLW.GLBL_CMPY_CD         = DXA_S.GLBL_CMPY_CD(+)
                            AND DXA_S.EZCANCELFLAG(+)       = '0'
                            AND DXA_S.DS_XREF_ACCT_TP_CD(+) = #dsXrefAcctTpCd_sfdc#
                            AND PLW.LOC_NUM              = DXA_S.LOC_NUM(+)
                            <isNotNull property="dsXrefAcctCd">
                                AND DXA_S.DS_XREF_ACCT_CD(+) LIKE #dsXrefAcctCd#
                            </isNotNull>
                            
                            AND PLW.GLBL_CMPY_CD         = DXA_O.GLBL_CMPY_CD(+)
                            AND DXA_O.EZCANCELFLAG(+)       = '0'
                            AND DXA_O.DS_XREF_ACCT_TP_CD(+) = #dsXrefAcctTpCd_oasis#
                            AND PLW.LOC_NUM              = DXA_O.LOC_NUM(+)
                            <isNotNull property="dsXrefAcctCd">
                                AND DXA_O.DS_XREF_ACCT_CD(+) LIKE #dsXrefAcctCd#
                            </isNotNull>
                            
                            <isNotNull property="dispTrtyFlg">
                                AND DAP.GLBL_CMPY_CD      = ATRA.GLBL_CMPY_CD(+)
                                AND ATRA.EZCANCELFLAG(+) = '0'
                                AND DAP.DS_ACCT_NUM       = ATRA.DS_ACCT_NUM(+)
                                AND DAP.LOC_NUM           = ATRA.LOC_NUM(+)
                            </isNotNull>
                            ORDER BY
                                 DAP.DS_ACCT_NUM ASC
                                ,DAP.LOC_NUM ASC
                        ) A
                        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <resultMap id="result.getProspectList" class="NMAL2830_BSMsg">
        <result property="dsAcctNum_B"             column="DS_ACCT_NUM"               javaType="EZDSStringItem"/>
        <result property="dsAcctTpCd_B"            column="DS_ACCT_TP_CD"             javaType="EZDSStringItem"/>
        <result property="dsAcctTpNm_B"            column="DS_ACCT_TP_DESC_TXT"       javaType="EZDSStringItem"/>
        <result property="locNum_B"                column="LOC_NUM"                   javaType="EZDSStringItem"/>
        <result property="firstLineAddr_B"         column="FIRST_LINE_ADDR"           javaType="EZDSStringItem"/>
        <result property="scdLineAddr_B"           column="SCD_LINE_ADDR"             javaType="EZDSStringItem"/>
        <result property="thirdLineAddr_B"         column="THIRD_LINE_ADDR"           javaType="EZDSStringItem"/>
        <result property="frthLineAddr_B"          column="FRTH_LINE_ADDR"            javaType="EZDSStringItem"/>
        <result property="ctyAddr_B"               column="CTY_ADDR"                  javaType="EZDSStringItem"/>
        <result property="postCd_B"                column="POST_CD"                   javaType="EZDSStringItem"/>
        <result property="stCd_B"                  column="ST_CD"                     javaType="EZDSStringItem"/>
        <result property="dsAcctNm_B"              column="DS_ACCT_NM"                javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_1"  column="LOB_ROLE_NM_01"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_1"         column="ORG_CD_01"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_1"             column="PSN_NM_01"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_2"  column="LOB_ROLE_NM_02"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_2"         column="ORG_CD_02"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_2"             column="PSN_NM_02"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_3"  column="LOB_ROLE_NM_03"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_3"         column="ORG_CD_03"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_3"             column="PSN_NM_03"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_4"  column="LOB_ROLE_NM_04"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_4"         column="ORG_CD_04"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_4"             column="PSN_NM_04"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_5"  column="LOB_ROLE_NM_05"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_5"         column="ORG_CD_05"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_5"             column="PSN_NM_05"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_6"  column="LOB_ROLE_NM_06"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_6"         column="ORG_CD_06"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_6"             column="PSN_NM_06"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_7"  column="LOB_ROLE_NM_07"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_7"         column="ORG_CD_07"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_7"             column="PSN_NM_07"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_8"  column="LOB_ROLE_NM_08"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_8"         column="ORG_CD_08"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_8"             column="PSN_NM_08"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_9"  column="LOB_ROLE_NM_09"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_9"         column="ORG_CD_09"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_9"             column="PSN_NM_09"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_10" column="LOB_ROLE_NM_10"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_10"        column="ORG_CD_10"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_10"            column="PSN_NM_10"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_11" column="LOB_ROLE_NM_11"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_11"        column="ORG_CD_11"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_11"            column="PSN_NM_11"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_12" column="LOB_ROLE_NM_12"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_12"        column="ORG_CD_12"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_12"            column="PSN_NM_12"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_13" column="LOB_ROLE_NM_13"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_13"        column="ORG_CD_13"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_13"            column="PSN_NM_13"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_14" column="LOB_ROLE_NM_14"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_14"        column="ORG_CD_14"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_14"            column="PSN_NM_14"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_15" column="LOB_ROLE_NM_15"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_15"        column="ORG_CD_15"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_15"            column="PSN_NM_15"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_16" column="LOB_ROLE_NM_16"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_16"        column="ORG_CD_16"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_16"            column="PSN_NM_16"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_17" column="LOB_ROLE_NM_17"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_17"        column="ORG_CD_17"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_17"            column="PSN_NM_17"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_18" column="LOB_ROLE_NM_18"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_18"        column="ORG_CD_18"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_18"            column="PSN_NM_18"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_19" column="LOB_ROLE_NM_19"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_19"        column="ORG_CD_19"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_19"            column="PSN_NM_19"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_20" column="LOB_ROLE_NM_20"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_20"        column="ORG_CD_20"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_20"            column="PSN_NM_20"                 javaType="EZDSStringItem"/>

        <result property="dsXrefAcctCd_BS"         column="SFDC_DS_XREF_ACCT_CD"      javaType="EZDSStringItem"/>
        <result property="dsXrefAcctCd_BO"         column="OASIS_DS_XREF_ACCT_CD"     javaType="EZDSStringItem"/>
        <result property="dunsNum_B"               column="DUNS_NUM"                  javaType="EZDSStringItem"/>
        <result property="dsLocNm_B"               column="DS_LOC_NM"                 javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getDuplicateList_realTime" parameterClass="Map" resultMap="result.getDuplicateList_realTime">
        WITH
            SELL_TO_CUST_A AS (
                SELECT
                     X.GLBL_CMPY_CD
                    ,X.SELL_TO_CUST_CD AS DS_ACCT_NUM
                    ,X.DS_ACCT_NM
                    ,X.DS_ACCT_NM_NOT_SPS
                    ,X.DS_ACCT_TP_CD
                FROM
                    (
                        SELECT
                             DAC.GLBL_CMPY_CD
                            ,DAC.SELL_TO_CUST_CD
                            ,DAC.DS_ACCT_NM
                            ,REGEXP_REPLACE(DAC.DS_ACCT_NM, '[^A-Za-z0-9]+') AS DS_ACCT_NM_NOT_SPS
                            ,DAC.DS_ACCT_TP_CD
                        FROM
                             SELL_TO_CUST   DAC
                        WHERE
                                DAC.GLBL_CMPY_CD            = #glblCmpyCd#
                            AND DAC.EZCANCELFLAG            = '0'
                            AND DAC.RGTN_STS_CD             = #rgtnStsCd_P20#
                            AND DAC.DS_ACCT_ACTV_CUST_FLG   = 'Y'
                    ) X
            ),
            DS_ACCT_PROS_B AS (
                SELECT
                     X.GLBL_CMPY_CD
                    ,X.DS_ACCT_NUM AS DS_ACCT_NUM
                    ,X.DS_ACCT_NM
                    ,X.DS_ACCT_NM_NOT_SPS
                    ,X.DS_ACCT_TP_CD
                    ,X.PTY_LOC_PK
                    ,X.LOC_NUM
                    ,X.EFF_FROM_DT
                    ,X.EFF_THRU_DT
                    ,X.RGTN_STS_CD
                FROM
                    (
                        SELECT
                             DAP.GLBL_CMPY_CD
                            ,DAP.DS_ACCT_NUM
                            ,DAP.DS_ACCT_NM
                            ,REGEXP_REPLACE(DAP.DS_ACCT_NM, '[^A-Za-z0-9]+') AS DS_ACCT_NM_NOT_SPS
                            ,DAP.DS_ACCT_TP_CD
                            ,DAP.PTY_LOC_PK
                            ,DAP.LOC_NUM
                            ,DAP.EFF_FROM_DT
                            ,DAP.EFF_THRU_DT
                            ,DAP.RGTN_STS_CD
                        FROM
                             DS_ACCT_PROS   DAP
                        WHERE
                                DAP.GLBL_CMPY_CD            = #glblCmpyCd#
                            AND DAP.EZCANCELFLAG            = '0'
                            AND DAP.RGTN_STS_CD             = #rgtnStsCd_P01#
                            AND DAP.DS_ACCT_ACTV_CUST_FLG   = 'Y'
                    ) X
            ),
            PTY_LOC_WRK_A AS (
                    SELECT
                         PLW.GLBL_CMPY_CD
                        ,PLW.PTY_LOC_PK
                        ,PLW.LOC_NUM
                        ,PLW.FIRST_LINE_ADDR
                        ,PLW.SCD_LINE_ADDR
                        ,PLW.THIRD_LINE_ADDR
                        ,PLW.FRTH_LINE_ADDR
                        ,PLW.CTY_ADDR
                        ,PLW.ST_CD
                        ,PLW.POST_CD
                        ,REGEXP_REPLACE(PLW.FIRST_LINE_ADDR || PLW.SCD_LINE_ADDR || PLW.THIRD_LINE_ADDR || PLW.FRTH_LINE_ADDR, '[^A-Za-z0-9]+') AS ADDR_NOT_SPS
                        ,PLW.DUNS_NUM
                        ,PLW.DS_LOC_NM
                    FROM
                        PTY_LOC_WRK     PLW
                    WHERE
                            PLW.GLBL_CMPY_CD        = #glblCmpyCd#
                        AND PLW.EZCANCELFLAG        = '0'
            ),
            PROS_PTY_LOC_WRK_B AS (
                    SELECT
                         PLW.GLBL_CMPY_CD
                        ,PLW.PTY_LOC_PK
                        ,PLW.LOC_NUM
                        ,PLW.FIRST_LINE_ADDR
                        ,PLW.SCD_LINE_ADDR
                        ,PLW.THIRD_LINE_ADDR
                        ,PLW.FRTH_LINE_ADDR
                        ,PLW.CTY_ADDR
                        ,PLW.ST_CD
                        ,PLW.POST_CD
                        ,REGEXP_REPLACE(PLW.FIRST_LINE_ADDR || PLW.SCD_LINE_ADDR || PLW.THIRD_LINE_ADDR || PLW.FRTH_LINE_ADDR, '[^A-Za-z0-9]+') AS ADDR_NOT_SPS
                        ,PLW.DUNS_NUM
                        ,PLW.DS_LOC_NM
                    FROM
                        PROS_PTY_LOC_WRK     PLW
                    WHERE
                            PLW.GLBL_CMPY_CD        = #glblCmpyCd#
                        AND PLW.EZCANCELFLAG        = '0'
            )
            SELECT
                 A.COND
                ,A.DS_ACCT_NUM
                ,A.DS_ACCT_NM
                ,A.DS_ACCT_TP_CD
                ,A.DS_ACCT_TP_DESC_TXT
                ,A.FIRST_LINE_ADDR
                ,A.SCD_LINE_ADDR
                ,A.THIRD_LINE_ADDR
                ,A.FRTH_LINE_ADDR
                ,A.LOC_NUM
                ,A.CTY_ADDR
                ,A.ST_CD
                ,A.POST_CD
               <isNotNull property="dispTrtyFlg">
                ,A.ORG_CD_01
                ,A.ORG_CD_02
                ,A.ORG_CD_03
                ,A.ORG_CD_04
                ,A.ORG_CD_05
                ,A.ORG_CD_06
                ,A.ORG_CD_07
                ,A.ORG_CD_08
                ,A.ORG_CD_09
                ,A.ORG_CD_10
                ,A.ORG_CD_11
                ,A.ORG_CD_12
                ,A.ORG_CD_13
                ,A.ORG_CD_14
                ,A.ORG_CD_15
                ,A.ORG_CD_16
                ,A.ORG_CD_17
                ,A.ORG_CD_18
                ,A.ORG_CD_19
                ,A.ORG_CD_20
                ,A.LOB_ROLE_NM_01
                ,A.LOB_ROLE_NM_02
                ,A.LOB_ROLE_NM_03
                ,A.LOB_ROLE_NM_04
                ,A.LOB_ROLE_NM_05
                ,A.LOB_ROLE_NM_06
                ,A.LOB_ROLE_NM_07
                ,A.LOB_ROLE_NM_08
                ,A.LOB_ROLE_NM_09
                ,A.LOB_ROLE_NM_10
                ,A.LOB_ROLE_NM_11
                ,A.LOB_ROLE_NM_12
                ,A.LOB_ROLE_NM_13
                ,A.LOB_ROLE_NM_14
                ,A.LOB_ROLE_NM_15
                ,A.LOB_ROLE_NM_16
                ,A.LOB_ROLE_NM_17
                ,A.LOB_ROLE_NM_18
                ,A.LOB_ROLE_NM_19
                ,A.LOB_ROLE_NM_20
                ,A.PSN_NM_01
                ,A.PSN_NM_02
                ,A.PSN_NM_03
                ,A.PSN_NM_04
                ,A.PSN_NM_05
                ,A.PSN_NM_06
                ,A.PSN_NM_07
                ,A.PSN_NM_08
                ,A.PSN_NM_09
                ,A.PSN_NM_10
                ,A.PSN_NM_11
                ,A.PSN_NM_12
                ,A.PSN_NM_13
                ,A.PSN_NM_14
                ,A.PSN_NM_15
                ,A.PSN_NM_16
                ,A.PSN_NM_17
                ,A.PSN_NM_18
                ,A.PSN_NM_19
                ,A.PSN_NM_20
               </isNotNull>
                ,A.SFDC_DS_XREF_ACCT_CD
                ,A.OASIS_DS_XREF_ACCT_CD
            FROM
            (
                SELECT
                     RT.COND                       AS COND
                    ,RT.DS_ACCT_NUM                AS DS_ACCT_NUM
                    ,RT.DS_ACCT_NM                 AS DS_ACCT_NM
                    ,RT.DS_ACCT_TP_CD              AS DS_ACCT_TP_CD
                    ,RT.DS_ACCT_TP_DESC_TXT        AS DS_ACCT_TP_DESC_TXT
                    ,RT.FIRST_LINE_ADDR            AS FIRST_LINE_ADDR
                    ,RT.SCD_LINE_ADDR              AS SCD_LINE_ADDR
                    ,RT.THIRD_LINE_ADDR            AS THIRD_LINE_ADDR
                    ,RT.FRTH_LINE_ADDR             AS FRTH_LINE_ADDR
                    ,RT.LOC_NUM                    AS LOC_NUM
                    ,RT.CTY_ADDR                   AS CTY_ADDR
                    ,RT.ST_CD                      AS ST_CD
                    ,RT.POST_CD                    AS POST_CD
                   <isNotNull property="dispTrtyFlg">
                    ,RT.ORG_CD_01                  AS ORG_CD_01
                    ,RT.ORG_CD_02                  AS ORG_CD_02
                    ,RT.ORG_CD_03                  AS ORG_CD_03
                    ,RT.ORG_CD_04                  AS ORG_CD_04
                    ,RT.ORG_CD_05                  AS ORG_CD_05
                    ,RT.ORG_CD_06                  AS ORG_CD_06
                    ,RT.ORG_CD_07                  AS ORG_CD_07
                    ,RT.ORG_CD_08                  AS ORG_CD_08
                    ,RT.ORG_CD_09                  AS ORG_CD_09
                    ,RT.ORG_CD_10                  AS ORG_CD_10
                    ,RT.ORG_CD_11                  AS ORG_CD_11
                    ,RT.ORG_CD_12                  AS ORG_CD_12
                    ,RT.ORG_CD_13                  AS ORG_CD_13
                    ,RT.ORG_CD_14                  AS ORG_CD_14
                    ,RT.ORG_CD_15                  AS ORG_CD_15
                    ,RT.ORG_CD_16                  AS ORG_CD_16
                    ,RT.ORG_CD_17                  AS ORG_CD_17
                    ,RT.ORG_CD_18                  AS ORG_CD_18
                    ,RT.ORG_CD_19                  AS ORG_CD_19
                    ,RT.ORG_CD_20                  AS ORG_CD_20
                    ,RT.LOB_ROLE_NM_01             AS LOB_ROLE_NM_01
                    ,RT.LOB_ROLE_NM_02             AS LOB_ROLE_NM_02
                    ,RT.LOB_ROLE_NM_03             AS LOB_ROLE_NM_03
                    ,RT.LOB_ROLE_NM_04             AS LOB_ROLE_NM_04
                    ,RT.LOB_ROLE_NM_05             AS LOB_ROLE_NM_05
                    ,RT.LOB_ROLE_NM_06             AS LOB_ROLE_NM_06
                    ,RT.LOB_ROLE_NM_07             AS LOB_ROLE_NM_07
                    ,RT.LOB_ROLE_NM_08             AS LOB_ROLE_NM_08
                    ,RT.LOB_ROLE_NM_09             AS LOB_ROLE_NM_09
                    ,RT.LOB_ROLE_NM_10             AS LOB_ROLE_NM_10
                    ,RT.LOB_ROLE_NM_11             AS LOB_ROLE_NM_11
                    ,RT.LOB_ROLE_NM_12             AS LOB_ROLE_NM_12
                    ,RT.LOB_ROLE_NM_13             AS LOB_ROLE_NM_13
                    ,RT.LOB_ROLE_NM_14             AS LOB_ROLE_NM_14
                    ,RT.LOB_ROLE_NM_15             AS LOB_ROLE_NM_15
                    ,RT.LOB_ROLE_NM_16             AS LOB_ROLE_NM_16
                    ,RT.LOB_ROLE_NM_17             AS LOB_ROLE_NM_17
                    ,RT.LOB_ROLE_NM_18             AS LOB_ROLE_NM_18
                    ,RT.LOB_ROLE_NM_19             AS LOB_ROLE_NM_19
                    ,RT.LOB_ROLE_NM_20             AS LOB_ROLE_NM_20
                    ,RT.PSN_NM_01                  AS PSN_NM_01
                    ,RT.PSN_NM_02                  AS PSN_NM_02
                    ,RT.PSN_NM_03                  AS PSN_NM_03
                    ,RT.PSN_NM_04                  AS PSN_NM_04
                    ,RT.PSN_NM_05                  AS PSN_NM_05
                    ,RT.PSN_NM_06                  AS PSN_NM_06
                    ,RT.PSN_NM_07                  AS PSN_NM_07
                    ,RT.PSN_NM_08                  AS PSN_NM_08
                    ,RT.PSN_NM_09                  AS PSN_NM_09
                    ,RT.PSN_NM_10                  AS PSN_NM_10
                    ,RT.PSN_NM_11                  AS PSN_NM_11
                    ,RT.PSN_NM_12                  AS PSN_NM_12
                    ,RT.PSN_NM_13                  AS PSN_NM_13
                    ,RT.PSN_NM_14                  AS PSN_NM_14
                    ,RT.PSN_NM_15                  AS PSN_NM_15
                    ,RT.PSN_NM_16                  AS PSN_NM_16
                    ,RT.PSN_NM_17                  AS PSN_NM_17
                    ,RT.PSN_NM_18                  AS PSN_NM_18
                    ,RT.PSN_NM_19                  AS PSN_NM_19
                    ,RT.PSN_NM_20                  AS PSN_NM_20
                   </isNotNull>
                    ,RT.SFDC_DS_XREF_ACCT_CD       AS SFDC_DS_XREF_ACCT_CD
                    ,RT.OASIS_DS_XREF_ACCT_CD      AS OASIS_DS_XREF_ACCT_CD
                FROM
                    (
            --Condition 1
                        (SELECT
                             '1' AS COND
                            ,ACP.DS_ACCT_NUM
                            ,ACP.DS_ACCT_NM
                            ,ACP.DS_ACCT_TP_CD
                            ,DAT.DS_ACCT_TP_DESC_TXT
                            ,PLW.FIRST_LINE_ADDR
                            ,PLW.SCD_LINE_ADDR
                            ,PLW.THIRD_LINE_ADDR
                            ,PLW.FRTH_LINE_ADDR
                            ,PLW.LOC_NUM
                            ,PLW.CTY_ADDR
                            ,PLW.ST_CD
                            ,PLW.POST_CD
                           <isNotNull property="dispTrtyFlg">
                            -- 01
                            ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                             ELSE NULL END AS LOB_ROLE_NM_01
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                             ELSE NULL END AS PSN_NM_01
                            -- 02
                            ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                             ELSE NULL END AS LOB_ROLE_NM_02
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                             ELSE NULL END AS PSN_NM_02
                            -- 03
                            ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                             ELSE NULL END AS LOB_ROLE_NM_03
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                             ELSE NULL END AS PSN_NM_03
                            -- 04
                            ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                             ELSE NULL END AS LOB_ROLE_NM_04
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                             ELSE NULL END AS PSN_NM_04
                            -- 05
                            ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                             ELSE NULL END AS LOB_ROLE_NM_05
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                             ELSE NULL END AS PSN_NM_05
                            -- 06
                            ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                             ELSE NULL END AS LOB_ROLE_NM_06
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                             ELSE NULL END AS PSN_NM_06
                            -- 07
                            ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                             ELSE NULL END AS LOB_ROLE_NM_07
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                             ELSE NULL END AS PSN_NM_07
                            -- 08
                            ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                             ELSE NULL END AS LOB_ROLE_NM_08
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                             ELSE NULL END AS PSN_NM_08
                            -- 09
                            ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                             ELSE NULL END AS LOB_ROLE_NM_09
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                             ELSE NULL END AS PSN_NM_09
                            -- 10
                            ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                             ELSE NULL END AS LOB_ROLE_NM_10
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                             ELSE NULL END AS PSN_NM_10
                            -- 11
                            ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                             ELSE NULL END AS LOB_ROLE_NM_11
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                             ELSE NULL END AS PSN_NM_11
                            -- 12
                            ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                             ELSE NULL END AS LOB_ROLE_NM_12
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                             ELSE NULL END AS PSN_NM_12
                            -- 13
                            ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                             ELSE NULL END AS LOB_ROLE_NM_13
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                             ELSE NULL END AS PSN_NM_13
                            -- 14
                            ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                             ELSE NULL END AS LOB_ROLE_NM_14
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                             ELSE NULL END AS PSN_NM_14
                            -- 15
                            ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                             ELSE NULL END AS LOB_ROLE_NM_15
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                             ELSE NULL END AS PSN_NM_15
                            -- 16
                            ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                             ELSE NULL END AS LOB_ROLE_NM_16
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                             ELSE NULL END AS PSN_NM_16
                            -- 17
                            ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                             ELSE NULL END AS LOB_ROLE_NM_17
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                             ELSE NULL END AS PSN_NM_17
                            -- 18
                            ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                             ELSE NULL END AS LOB_ROLE_NM_18
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                             ELSE NULL END AS PSN_NM_18
                            -- 19
                            ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                             ELSE NULL END AS LOB_ROLE_NM_19
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                             ELSE NULL END AS PSN_NM_19
                            -- 20
                            ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                             ELSE NULL END AS LOB_ROLE_NM_20
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                             ELSE NULL END AS PSN_NM_20
                           </isNotNull>
                            ,SFD.DS_XREF_ACCT_CD AS SFDC_DS_XREF_ACCT_CD
                            ,OAS.DS_XREF_ACCT_CD AS OASIS_DS_XREF_ACCT_CD
                        FROM
                             SELL_TO_CUST_A         ACP
                            ,DS_ACCT_TP             DAT
                            ,ACCT_LOC               ALC
                            ,PTY_LOC_WRK_A          PLW
                            ,DS_XREF_ACCT           SFD
                            ,DS_XREF_ACCT           OAS
                           <isNotNull property="dispTrtyFlg">
                            ,ACCT_TRTY_RESRC_ASG    TRA
                           </isNotNull>
                        WHERE
                                ACP.GLBL_CMPY_CD            = DAT.GLBL_CMPY_CD (+)
                            AND DAT.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_TP_CD           = DAT.DS_ACCT_TP_CD (+)
                            
                            AND ACP.GLBL_CMPY_CD            = ALC.GLBL_CMPY_CD
                            AND ALC.EZCANCELFLAG            = '0'
                            AND ACP.DS_ACCT_NUM             = ALC.DS_ACCT_NUM
                            AND ALC.EFF_FROM_DT            &lt;= #salesDate#
                            AND NVL(ALC.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                            AND ALC.RGTN_STS_CD             = #rgtnStsCd_P20#
                           <isNotNull property="locNum_B">
                            AND ALC.LOC_NUM                &lt;&gt; #locNum_B#
                           </isNotNull>
                           
                            AND ALC.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                            AND ALC.PTY_LOC_PK              = PLW.PTY_LOC_PK
                            
                            AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                            AND SFD.EZCANCELFLAG (+)        = '0'
                            AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                            AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = OAS.GLBL_CMPY_CD (+)
                            AND OAS.EZCANCELFLAG (+)        = '0'
                            AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                            AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                            
                           <isNotNull property="dispTrtyFlg">
                            AND ACP.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND TRA.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_NUM             = TRA.DS_ACCT_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND PLW.LOC_NUM                 = TRA.LOC_NUM (+)
                           </isNotNull>
                           <isNotNull property="dsAcctNm_B">
                            AND ACP.DS_ACCT_NM              = #dsAcctNm_B#
                           </isNotNull>
                           <isNotNull property="dsLocNm_B">
                            AND PLW.DS_LOC_NM               = #dsLocNm_B#
                           </isNotNull>
                           <isNotNull property="firstLineAddr_B">
                            AND PLW.FIRST_LINE_ADDR         = #firstLineAddr_B#
                           </isNotNull>
                           <isNotNull property="scdLineAddr_B">
                            AND PLW.SCD_LINE_ADDR           = #scdLineAddr_B#
                           </isNotNull>
                           <isNotNull property="thirdLineAddr_B">
                            AND PLW.THIRD_LINE_ADDR         = #thirdLineAddr_B#
                           </isNotNull>
                           <isNotNull property="frthLineAddr_B">
                            AND PLW.FRTH_LINE_ADDR          = #frthLineAddr_B#
                           </isNotNull>
                           <isNotNull property="ctyAddr_B">
                            AND PLW.CTY_ADDR                = #ctyAddr_B#
                           </isNotNull>
                           <isNotNull property="stCd_B">
                            AND PLW.ST_CD                   = #stCd_B#
                           </isNotNull>
                           <isNotNull property="postCd_B">
                            AND PLW.POST_CD                 = #postCd_B#
                           </isNotNull>
                           UNION ALL
                           SELECT
                             '1' AS COND
                            ,ACP.DS_ACCT_NUM
                            ,ACP.DS_ACCT_NM
                            ,ACP.DS_ACCT_TP_CD
                            ,DAT.DS_ACCT_TP_DESC_TXT
                            ,PLW.FIRST_LINE_ADDR
                            ,PLW.SCD_LINE_ADDR
                            ,PLW.THIRD_LINE_ADDR
                            ,PLW.FRTH_LINE_ADDR
                            ,PLW.LOC_NUM
                            ,PLW.CTY_ADDR
                            ,PLW.ST_CD
                            ,PLW.POST_CD
                           <isNotNull property="dispTrtyFlg">
                            -- 01
                            ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                             ELSE NULL END AS LOB_ROLE_NM_01
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                             ELSE NULL END AS PSN_NM_01
                            -- 02
                            ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                             ELSE NULL END AS LOB_ROLE_NM_02
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                             ELSE NULL END AS PSN_NM_02
                            -- 03
                            ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                             ELSE NULL END AS LOB_ROLE_NM_03
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                             ELSE NULL END AS PSN_NM_03
                            -- 04
                            ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                             ELSE NULL END AS LOB_ROLE_NM_04
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                             ELSE NULL END AS PSN_NM_04
                            -- 05
                            ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                             ELSE NULL END AS LOB_ROLE_NM_05
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                             ELSE NULL END AS PSN_NM_05
                            -- 06
                            ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                             ELSE NULL END AS LOB_ROLE_NM_06
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                             ELSE NULL END AS PSN_NM_06
                            -- 07
                            ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                             ELSE NULL END AS LOB_ROLE_NM_07
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                             ELSE NULL END AS PSN_NM_07
                            -- 08
                            ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                             ELSE NULL END AS LOB_ROLE_NM_08
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                             ELSE NULL END AS PSN_NM_08
                            -- 09
                            ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                             ELSE NULL END AS LOB_ROLE_NM_09
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                             ELSE NULL END AS PSN_NM_09
                            -- 10
                            ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                             ELSE NULL END AS LOB_ROLE_NM_10
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                             ELSE NULL END AS PSN_NM_10
                            -- 11
                            ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                             ELSE NULL END AS LOB_ROLE_NM_11
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                             ELSE NULL END AS PSN_NM_11
                            -- 12
                            ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                             ELSE NULL END AS LOB_ROLE_NM_12
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                             ELSE NULL END AS PSN_NM_12
                            -- 13
                            ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                             ELSE NULL END AS LOB_ROLE_NM_13
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                             ELSE NULL END AS PSN_NM_13
                            -- 14
                            ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                             ELSE NULL END AS LOB_ROLE_NM_14
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                             ELSE NULL END AS PSN_NM_14
                            -- 15
                            ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                             ELSE NULL END AS LOB_ROLE_NM_15
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                             ELSE NULL END AS PSN_NM_15
                            -- 16
                            ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                             ELSE NULL END AS LOB_ROLE_NM_16
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                             ELSE NULL END AS PSN_NM_16
                            -- 17
                            ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                             ELSE NULL END AS LOB_ROLE_NM_17
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                             ELSE NULL END AS PSN_NM_17
                            -- 18
                            ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                             ELSE NULL END AS LOB_ROLE_NM_18
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                             ELSE NULL END AS PSN_NM_18
                            -- 19
                            ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                             ELSE NULL END AS LOB_ROLE_NM_19
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                             ELSE NULL END AS PSN_NM_19
                            -- 20
                            ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                             ELSE NULL END AS LOB_ROLE_NM_20
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                             ELSE NULL END AS PSN_NM_20
                           </isNotNull>
                            ,SFD.DS_XREF_ACCT_CD AS SFDC_DS_XREF_ACCT_CD
                            ,OAS.DS_XREF_ACCT_CD AS OASIS_DS_XREF_ACCT_CD
                        FROM
                             DS_ACCT_PROS_B         ACP
                            ,DS_ACCT_TP             DAT
                            ,PROS_PTY_LOC_WRK_B     PLW
                            ,DS_XREF_ACCT           SFD
                            ,DS_XREF_ACCT           OAS
                           <isNotNull property="dispTrtyFlg">
                            ,PROS_TRTY_RESRC_ASG    TRA
                           </isNotNull>
                        WHERE
                                ACP.GLBL_CMPY_CD            = DAT.GLBL_CMPY_CD (+)
                            AND DAT.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_TP_CD           = DAT.DS_ACCT_TP_CD (+)
                            AND ACP.EFF_FROM_DT            &lt;= #salesDate#
                            AND NVL(ACP.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                            AND ACP.RGTN_STS_CD             = #rgtnStsCd_P01#
                           <isNotNull property="locNum_B">
                            AND ACP.LOC_NUM                &lt;&gt; #locNum_B#
                           </isNotNull>
                           
                            AND ACP.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                            AND ACP.PTY_LOC_PK              = PLW.PTY_LOC_PK
                            
                            AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                            AND SFD.EZCANCELFLAG (+)        = '0'
                            AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                            AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = OAS.GLBL_CMPY_CD (+)
                            AND OAS.EZCANCELFLAG (+)        = '0'
                            AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                            AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                            
                           <isNotNull property="dispTrtyFlg">
                            AND ACP.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND TRA.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_NUM             = TRA.DS_ACCT_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND PLW.LOC_NUM                 = TRA.LOC_NUM (+)
                           </isNotNull>
                           <isNotNull property="dsAcctNm_B">
                            AND ACP.DS_ACCT_NM              = #dsAcctNm_B#
                           </isNotNull>
                           <isNotNull property="dsLocNm_B">
                            AND PLW.DS_LOC_NM               = #dsLocNm_B#
                           </isNotNull>
                           <isNotNull property="firstLineAddr_B">
                            AND PLW.FIRST_LINE_ADDR         = #firstLineAddr_B#
                           </isNotNull>
                           <isNotNull property="scdLineAddr_B">
                            AND PLW.SCD_LINE_ADDR           = #scdLineAddr_B#
                           </isNotNull>
                           <isNotNull property="thirdLineAddr_B">
                            AND PLW.THIRD_LINE_ADDR         = #thirdLineAddr_B#
                           </isNotNull>
                           <isNotNull property="frthLineAddr_B">
                            AND PLW.FRTH_LINE_ADDR          = #frthLineAddr_B#
                           </isNotNull>
                           <isNotNull property="ctyAddr_B">
                            AND PLW.CTY_ADDR                = #ctyAddr_B#
                           </isNotNull>
                           <isNotNull property="stCd_B">
                            AND PLW.ST_CD                   = #stCd_B#
                           </isNotNull>
                           <isNotNull property="postCd_B">
                            AND PLW.POST_CD                 = #postCd_B#
                           </isNotNull>
                        )
            --Condition 2
                        UNION
                        (SELECT
                            '2' AS COND
                            ,ACP.DS_ACCT_NUM
                            ,ACP.DS_ACCT_NM
                            ,ACP.DS_ACCT_TP_CD
                            ,DAT.DS_ACCT_TP_DESC_TXT
                            ,PLW.FIRST_LINE_ADDR
                            ,PLW.SCD_LINE_ADDR
                            ,PLW.THIRD_LINE_ADDR
                            ,PLW.FRTH_LINE_ADDR
                            ,PLW.LOC_NUM
                            ,PLW.CTY_ADDR
                            ,PLW.ST_CD
                            ,PLW.POST_CD
                           <isNotNull property="dispTrtyFlg">
                            -- 01
                            ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                             ELSE NULL END AS LOB_ROLE_NM_01
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                             ELSE NULL END AS PSN_NM_01
                            -- 02
                            ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                             ELSE NULL END AS LOB_ROLE_NM_02
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                             ELSE NULL END AS PSN_NM_02
                            -- 03
                            ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                             ELSE NULL END AS LOB_ROLE_NM_03
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                             ELSE NULL END AS PSN_NM_03
                            -- 04
                            ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                             ELSE NULL END AS LOB_ROLE_NM_04
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                             ELSE NULL END AS PSN_NM_04
                            -- 05
                            ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                             ELSE NULL END AS LOB_ROLE_NM_05
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                             ELSE NULL END AS PSN_NM_05
                            -- 06
                            ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                             ELSE NULL END AS LOB_ROLE_NM_06
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                             ELSE NULL END AS PSN_NM_06
                            -- 07
                            ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                             ELSE NULL END AS LOB_ROLE_NM_07
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                             ELSE NULL END AS PSN_NM_07
                            -- 08
                            ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                             ELSE NULL END AS LOB_ROLE_NM_08
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                             ELSE NULL END AS PSN_NM_08
                            -- 09
                            ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                             ELSE NULL END AS LOB_ROLE_NM_09
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                             ELSE NULL END AS PSN_NM_09
                            -- 10
                            ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                             ELSE NULL END AS LOB_ROLE_NM_10
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                             ELSE NULL END AS PSN_NM_10
                            -- 11
                            ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                             ELSE NULL END AS LOB_ROLE_NM_11
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                             ELSE NULL END AS PSN_NM_11
                            -- 12
                            ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                             ELSE NULL END AS LOB_ROLE_NM_12
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                             ELSE NULL END AS PSN_NM_12
                            -- 13
                            ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                             ELSE NULL END AS LOB_ROLE_NM_13
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                             ELSE NULL END AS PSN_NM_13
                            -- 14
                            ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                             ELSE NULL END AS LOB_ROLE_NM_14
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                             ELSE NULL END AS PSN_NM_14
                            -- 15
                            ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                             ELSE NULL END AS LOB_ROLE_NM_15
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                             ELSE NULL END AS PSN_NM_15
                            -- 16
                            ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                             ELSE NULL END AS LOB_ROLE_NM_16
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                             ELSE NULL END AS PSN_NM_16
                            -- 17
                            ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                             ELSE NULL END AS LOB_ROLE_NM_17
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                             ELSE NULL END AS PSN_NM_17
                            -- 18
                            ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                             ELSE NULL END AS LOB_ROLE_NM_18
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                             ELSE NULL END AS PSN_NM_18
                            -- 19
                            ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                             ELSE NULL END AS LOB_ROLE_NM_19
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                             ELSE NULL END AS PSN_NM_19
                            -- 20
                            ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                             ELSE NULL END AS LOB_ROLE_NM_20
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                             ELSE NULL END AS PSN_NM_20
                           </isNotNull>
                            ,SFD.DS_XREF_ACCT_CD AS SFDC_DS_XREF_ACCT_CD
                            ,OAS.DS_XREF_ACCT_CD AS OASIS_DS_XREF_ACCT_CD
                        FROM
                             SELL_TO_CUST_A         ACP
                            ,DS_ACCT_TP             DAT
                            ,ACCT_LOC               ALC
                            ,PTY_LOC_WRK_A          PLW
                            ,DS_XREF_ACCT           SFD
                            ,DS_XREF_ACCT           OAS
                           <isNotNull property="dispTrtyFlg">
                            ,ACCT_TRTY_RESRC_ASG    TRA
                           </isNotNull>
                        WHERE
                                ACP.GLBL_CMPY_CD            = DAT.GLBL_CMPY_CD (+)
                            AND DAT.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_TP_CD           = DAT.DS_ACCT_TP_CD (+)
                            
                            AND ACP.GLBL_CMPY_CD            = ALC.GLBL_CMPY_CD
                            AND ALC.EZCANCELFLAG            = '0'
                            AND ACP.DS_ACCT_NUM             = ALC.DS_ACCT_NUM
                            AND ALC.EFF_FROM_DT            &lt;= #salesDate#
                            AND NVL(ALC.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                            AND ALC.RGTN_STS_CD             = #rgtnStsCd_P20#
                           <isNotNull property="locNum_B">
                            AND ALC.LOC_NUM                &lt;&gt; #locNum_B#
                           </isNotNull>
                           
                            AND ALC.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                            AND ALC.PTY_LOC_PK              = PLW.PTY_LOC_PK
                            
                            AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                            AND SFD.EZCANCELFLAG (+)        = '0'
                            AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                            AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = OAS.GLBL_CMPY_CD (+)
                            AND OAS.EZCANCELFLAG (+)        = '0'
                            AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                            AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                            
                           <isNotNull property="dispTrtyFlg">
                            AND ACP.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND TRA.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_NUM             = TRA.DS_ACCT_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND PLW.LOC_NUM                 = TRA.LOC_NUM (+)
                           </isNotNull>
                           <isNotNull property="dsAcctNm_B_not_sps">
                            AND ACP.DS_ACCT_NM_NOT_SPS      LIKE SUBSTR(#dsAcctNm_B_not_sps#, 1, 6) || '%'
                           </isNotNull>
                           <isNotNull property="dsLocNm_B_not_sps">
                            AND REGEXP_REPLACE(PLW.DS_LOC_NM, '[^A-Za-z0-9]+') LIKE SUBSTR(#dsLocNm_B_not_sps#, 1, 6) || '%'
                           </isNotNull>
                           <isNotNull property="address_not_sps">
                            AND PLW.ADDR_NOT_SPS            LIKE SUBSTR(#address_not_sps#, 1, 8) || '%'
                           </isNotNull>
                           <isNotNull property="ctyAddr_B">
                            AND PLW.CTY_ADDR                = #ctyAddr_B#
                           </isNotNull>
                           <isNotNull property="stCd_B">
                            AND PLW.ST_CD                   = #stCd_B#
                           </isNotNull>
                           <isNotNull property="postCd_B">
                            AND PLW.POST_CD                 = #postCd_B#
                           </isNotNull>
                           UNION ALL
                           SELECT
                            '2' AS COND
                            ,ACP.DS_ACCT_NUM
                            ,ACP.DS_ACCT_NM
                            ,ACP.DS_ACCT_TP_CD
                            ,DAT.DS_ACCT_TP_DESC_TXT
                            ,PLW.FIRST_LINE_ADDR
                            ,PLW.SCD_LINE_ADDR
                            ,PLW.THIRD_LINE_ADDR
                            ,PLW.FRTH_LINE_ADDR
                            ,PLW.LOC_NUM
                            ,PLW.CTY_ADDR
                            ,PLW.ST_CD
                            ,PLW.POST_CD
                           <isNotNull property="dispTrtyFlg">
                            -- 01
                            ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                             ELSE NULL END AS LOB_ROLE_NM_01
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                             ELSE NULL END AS PSN_NM_01
                            -- 02
                            ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                             ELSE NULL END AS LOB_ROLE_NM_02
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                             ELSE NULL END AS PSN_NM_02
                            -- 03
                            ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                             ELSE NULL END AS LOB_ROLE_NM_03
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                             ELSE NULL END AS PSN_NM_03
                            -- 04
                            ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                             ELSE NULL END AS LOB_ROLE_NM_04
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                             ELSE NULL END AS PSN_NM_04
                            -- 05
                            ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                             ELSE NULL END AS LOB_ROLE_NM_05
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                             ELSE NULL END AS PSN_NM_05
                            -- 06
                            ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                             ELSE NULL END AS LOB_ROLE_NM_06
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                             ELSE NULL END AS PSN_NM_06
                            -- 07
                            ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                             ELSE NULL END AS LOB_ROLE_NM_07
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                             ELSE NULL END AS PSN_NM_07
                            -- 08
                            ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                             ELSE NULL END AS LOB_ROLE_NM_08
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                             ELSE NULL END AS PSN_NM_08
                            -- 09
                            ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                             ELSE NULL END AS LOB_ROLE_NM_09
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                             ELSE NULL END AS PSN_NM_09
                            -- 10
                            ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                             ELSE NULL END AS LOB_ROLE_NM_10
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                             ELSE NULL END AS PSN_NM_10
                            -- 11
                            ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                             ELSE NULL END AS LOB_ROLE_NM_11
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                             ELSE NULL END AS PSN_NM_11
                            -- 12
                            ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                             ELSE NULL END AS LOB_ROLE_NM_12
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                             ELSE NULL END AS PSN_NM_12
                            -- 13
                            ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                             ELSE NULL END AS LOB_ROLE_NM_13
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                             ELSE NULL END AS PSN_NM_13
                            -- 14
                            ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                             ELSE NULL END AS LOB_ROLE_NM_14
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                             ELSE NULL END AS PSN_NM_14
                            -- 15
                            ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                             ELSE NULL END AS LOB_ROLE_NM_15
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                             ELSE NULL END AS PSN_NM_15
                            -- 16
                            ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                             ELSE NULL END AS LOB_ROLE_NM_16
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                             ELSE NULL END AS PSN_NM_16
                            -- 17
                            ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                             ELSE NULL END AS LOB_ROLE_NM_17
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                             ELSE NULL END AS PSN_NM_17
                            -- 18
                            ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                             ELSE NULL END AS LOB_ROLE_NM_18
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                             ELSE NULL END AS PSN_NM_18
                            -- 19
                            ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                             ELSE NULL END AS LOB_ROLE_NM_19
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                             ELSE NULL END AS PSN_NM_19
                            -- 20
                            ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                             ELSE NULL END AS LOB_ROLE_NM_20
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                             ELSE NULL END AS PSN_NM_20
                           </isNotNull>
                            ,SFD.DS_XREF_ACCT_CD AS SFDC_DS_XREF_ACCT_CD
                            ,OAS.DS_XREF_ACCT_CD AS OASIS_DS_XREF_ACCT_CD
                        FROM
                             DS_ACCT_PROS_B         ACP
                            ,DS_ACCT_TP             DAT
                            ,PROS_PTY_LOC_WRK_B     PLW
                            ,DS_XREF_ACCT           SFD
                            ,DS_XREF_ACCT           OAS
                           <isNotNull property="dispTrtyFlg">
                            ,PROS_TRTY_RESRC_ASG    TRA
                           </isNotNull>
                        WHERE
                                ACP.GLBL_CMPY_CD            = DAT.GLBL_CMPY_CD (+)
                            AND DAT.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_TP_CD           = DAT.DS_ACCT_TP_CD (+)
                            AND ACP.EFF_FROM_DT            &lt;= #salesDate#
                            AND NVL(ACP.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                            AND ACP.RGTN_STS_CD             = #rgtnStsCd_P01#
                           <isNotNull property="locNum_B">
                            AND ACP.LOC_NUM                &lt;&gt; #locNum_B#
                           </isNotNull>
                           
                            AND ACP.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                            AND ACP.PTY_LOC_PK              = PLW.PTY_LOC_PK
                            
                            AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                            AND SFD.EZCANCELFLAG (+)        = '0'
                            AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                            AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = OAS.GLBL_CMPY_CD (+)
                            AND OAS.EZCANCELFLAG (+)        = '0'
                            AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                            AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                            
                           <isNotNull property="dispTrtyFlg">
                            AND ACP.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND TRA.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_NUM             = TRA.DS_ACCT_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND PLW.LOC_NUM                 = TRA.LOC_NUM (+)
                           </isNotNull>
                           <isNotNull property="dsAcctNm_B_not_sps">
                            AND ACP.DS_ACCT_NM_NOT_SPS      LIKE SUBSTR(#dsAcctNm_B_not_sps#, 1, 6) || '%'
                           </isNotNull>
                           <isNotNull property="dsLocNm_B_not_sps">
                            AND REGEXP_REPLACE(PLW.DS_LOC_NM, '[^A-Za-z0-9]+') LIKE SUBSTR(#dsLocNm_B_not_sps#, 1, 6) || '%'
                           </isNotNull>
                           <isNotNull property="address_not_sps">
                            AND PLW.ADDR_NOT_SPS            LIKE SUBSTR(#address_not_sps#, 1, 8) || '%'
                           </isNotNull>
                           <isNotNull property="ctyAddr_B">
                            AND PLW.CTY_ADDR                = #ctyAddr_B#
                           </isNotNull>
                           <isNotNull property="stCd_B">
                            AND PLW.ST_CD                   = #stCd_B#
                           </isNotNull>
                           <isNotNull property="postCd_B">
                            AND PLW.POST_CD                 = #postCd_B#
                           </isNotNull>
                        )
            --Condition 3
                    <isNotNull property="dunsNum_B">
                        UNION
                        (SELECT
                            '3' AS COND
                            ,ACP.DS_ACCT_NUM
                            ,ACP.DS_ACCT_NM
                            ,ACP.DS_ACCT_TP_CD
                            ,DAT.DS_ACCT_TP_DESC_TXT
                            ,PLW.FIRST_LINE_ADDR
                            ,PLW.SCD_LINE_ADDR
                            ,PLW.THIRD_LINE_ADDR
                            ,PLW.FRTH_LINE_ADDR
                            ,PLW.LOC_NUM
                            ,PLW.CTY_ADDR
                            ,PLW.ST_CD
                            ,PLW.POST_CD
                           <isNotNull property="dispTrtyFlg">
                            -- 01
                            ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                             ELSE NULL END AS LOB_ROLE_NM_01
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                             ELSE NULL END AS PSN_NM_01
                            -- 02
                            ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                             ELSE NULL END AS LOB_ROLE_NM_02
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                             ELSE NULL END AS PSN_NM_02
                            -- 03
                            ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                             ELSE NULL END AS LOB_ROLE_NM_03
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                             ELSE NULL END AS PSN_NM_03
                            -- 04
                            ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                             ELSE NULL END AS LOB_ROLE_NM_04
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                             ELSE NULL END AS PSN_NM_04
                            -- 05
                            ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                             ELSE NULL END AS LOB_ROLE_NM_05
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                             ELSE NULL END AS PSN_NM_05
                            -- 06
                            ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                             ELSE NULL END AS LOB_ROLE_NM_06
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                             ELSE NULL END AS PSN_NM_06
                            -- 07
                            ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                             ELSE NULL END AS LOB_ROLE_NM_07
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                             ELSE NULL END AS PSN_NM_07
                            -- 08
                            ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                             ELSE NULL END AS LOB_ROLE_NM_08
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                             ELSE NULL END AS PSN_NM_08
                            -- 09
                            ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                             ELSE NULL END AS LOB_ROLE_NM_09
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                             ELSE NULL END AS PSN_NM_09
                            -- 10
                            ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                             ELSE NULL END AS LOB_ROLE_NM_10
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                             ELSE NULL END AS PSN_NM_10
                            -- 11
                            ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                             ELSE NULL END AS LOB_ROLE_NM_11
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                             ELSE NULL END AS PSN_NM_11
                            -- 12
                            ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                             ELSE NULL END AS LOB_ROLE_NM_12
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                             ELSE NULL END AS PSN_NM_12
                            -- 13
                            ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                             ELSE NULL END AS LOB_ROLE_NM_13
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                             ELSE NULL END AS PSN_NM_13
                            -- 14
                            ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                             ELSE NULL END AS LOB_ROLE_NM_14
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                             ELSE NULL END AS PSN_NM_14
                            -- 15
                            ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                             ELSE NULL END AS LOB_ROLE_NM_15
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                             ELSE NULL END AS PSN_NM_15
                            -- 16
                            ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                             ELSE NULL END AS LOB_ROLE_NM_16
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                             ELSE NULL END AS PSN_NM_16
                            -- 17
                            ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                             ELSE NULL END AS LOB_ROLE_NM_17
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                             ELSE NULL END AS PSN_NM_17
                            -- 18
                            ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                             ELSE NULL END AS LOB_ROLE_NM_18
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                             ELSE NULL END AS PSN_NM_18
                            -- 19
                            ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                             ELSE NULL END AS LOB_ROLE_NM_19
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                             ELSE NULL END AS PSN_NM_19
                            -- 20
                            ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                             ELSE NULL END AS LOB_ROLE_NM_20
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                             ELSE NULL END AS PSN_NM_20
                           </isNotNull>
                            ,SFD.DS_XREF_ACCT_CD AS SFDC_DS_XREF_ACCT_CD
                            ,OAS.DS_XREF_ACCT_CD AS OASIS_DS_XREF_ACCT_CD
                        FROM
                             SELL_TO_CUST_A         ACP
                            ,DS_ACCT_TP             DAT
                            ,ACCT_LOC               ALC
                            ,PTY_LOC_WRK_A          PLW
                            ,DS_XREF_ACCT           SFD
                            ,DS_XREF_ACCT           OAS
                           <isNotNull property="dispTrtyFlg">
                            ,ACCT_TRTY_RESRC_ASG    TRA
                           </isNotNull>
                        WHERE
                                ACP.GLBL_CMPY_CD            = DAT.GLBL_CMPY_CD (+)
                            AND DAT.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_TP_CD           = DAT.DS_ACCT_TP_CD (+)
                            
                            AND ACP.GLBL_CMPY_CD            = ALC.GLBL_CMPY_CD
                            AND ALC.EZCANCELFLAG            = '0'
                            AND ACP.DS_ACCT_NUM             = ALC.DS_ACCT_NUM
                            AND ALC.EFF_FROM_DT            &lt;= #salesDate#
                            AND NVL(ALC.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                            AND ALC.RGTN_STS_CD             = #rgtnStsCd_P20#
                           <isNotNull property="locNum_B">
                            AND ALC.LOC_NUM                &lt;&gt; #locNum_B#
                           </isNotNull>

                            AND ALC.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                            AND ALC.PTY_LOC_PK              = PLW.PTY_LOC_PK
                            
                            AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                            AND SFD.EZCANCELFLAG (+)        = '0'
                            AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                            AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD           = OAS.GLBL_CMPY_CD (+)
                            AND OAS.EZCANCELFLAG (+)        = '0'
                            AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                            AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                            
                           <isNotNull property="dispTrtyFlg">
                            AND ACP.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND TRA.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_NUM             = TRA.DS_ACCT_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND PLW.LOC_NUM                 = TRA.LOC_NUM (+)
                           </isNotNull>
                            AND PLW.DUNS_NUM                = #dunsNum_B#
                            UNION ALL
                            SELECT
                            '3' AS COND
                            ,ACP.DS_ACCT_NUM
                            ,ACP.DS_ACCT_NM
                            ,ACP.DS_ACCT_TP_CD
                            ,DAT.DS_ACCT_TP_DESC_TXT
                            ,PLW.FIRST_LINE_ADDR
                            ,PLW.SCD_LINE_ADDR
                            ,PLW.THIRD_LINE_ADDR
                            ,PLW.FRTH_LINE_ADDR
                            ,PLW.LOC_NUM
                            ,PLW.CTY_ADDR
                            ,PLW.ST_CD
                            ,PLW.POST_CD
                           <isNotNull property="dispTrtyFlg">
                            -- 01
                            ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                             ELSE NULL END AS LOB_ROLE_NM_01
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                             ELSE NULL END AS PSN_NM_01
                            -- 02
                            ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                             ELSE NULL END AS LOB_ROLE_NM_02
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                             ELSE NULL END AS PSN_NM_02
                            -- 03
                            ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                             ELSE NULL END AS LOB_ROLE_NM_03
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                             ELSE NULL END AS PSN_NM_03
                            -- 04
                            ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                             ELSE NULL END AS LOB_ROLE_NM_04
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                             ELSE NULL END AS PSN_NM_04
                            -- 05
                            ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                             ELSE NULL END AS LOB_ROLE_NM_05
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                             ELSE NULL END AS PSN_NM_05
                            -- 06
                            ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                             ELSE NULL END AS LOB_ROLE_NM_06
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                             ELSE NULL END AS PSN_NM_06
                            -- 07
                            ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                             ELSE NULL END AS LOB_ROLE_NM_07
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                             ELSE NULL END AS PSN_NM_07
                            -- 08
                            ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                             ELSE NULL END AS LOB_ROLE_NM_08
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                             ELSE NULL END AS PSN_NM_08
                            -- 09
                            ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                             ELSE NULL END AS LOB_ROLE_NM_09
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                             ELSE NULL END AS PSN_NM_09
                            -- 10
                            ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                             ELSE NULL END AS LOB_ROLE_NM_10
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                             ELSE NULL END AS PSN_NM_10
                            -- 11
                            ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                             ELSE NULL END AS LOB_ROLE_NM_11
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                             ELSE NULL END AS PSN_NM_11
                            -- 12
                            ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                             ELSE NULL END AS LOB_ROLE_NM_12
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                             ELSE NULL END AS PSN_NM_12
                            -- 13
                            ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                             ELSE NULL END AS LOB_ROLE_NM_13
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                             ELSE NULL END AS PSN_NM_13
                            -- 14
                            ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                             ELSE NULL END AS LOB_ROLE_NM_14
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                             ELSE NULL END AS PSN_NM_14
                            -- 15
                            ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                             ELSE NULL END AS LOB_ROLE_NM_15
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                             ELSE NULL END AS PSN_NM_15
                            -- 16
                            ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                             ELSE NULL END AS LOB_ROLE_NM_16
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                             ELSE NULL END AS PSN_NM_16
                            -- 17
                            ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                             ELSE NULL END AS LOB_ROLE_NM_17
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                             ELSE NULL END AS PSN_NM_17
                            -- 18
                            ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                             ELSE NULL END AS LOB_ROLE_NM_18
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                             ELSE NULL END AS PSN_NM_18
                            -- 19
                            ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                             ELSE NULL END AS LOB_ROLE_NM_19
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                             ELSE NULL END AS PSN_NM_19
                            -- 20
                            ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                            ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                             THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                             ELSE NULL END AS LOB_ROLE_NM_20
                            ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                             THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                             ELSE NULL END AS PSN_NM_20
                           </isNotNull>
                            ,SFD.DS_XREF_ACCT_CD AS SFDC_DS_XREF_ACCT_CD
                            ,OAS.DS_XREF_ACCT_CD AS OASIS_DS_XREF_ACCT_CD
                        FROM
                             DS_ACCT_PROS_B         ACP
                            ,DS_ACCT_TP             DAT
                            ,PROS_PTY_LOC_WRK_B     PLW
                            ,DS_XREF_ACCT           SFD
                            ,DS_XREF_ACCT           OAS
                           <isNotNull property="dispTrtyFlg">
                            ,PROS_TRTY_RESRC_ASG    TRA
                           </isNotNull>
                        WHERE
                                ACP.GLBL_CMPY_CD            = DAT.GLBL_CMPY_CD (+)
                            AND DAT.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_TP_CD           = DAT.DS_ACCT_TP_CD (+)
                            AND ACP.EFF_FROM_DT            &lt;= #salesDate#
                            AND NVL(ACP.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                            AND ACP.RGTN_STS_CD             = #rgtnStsCd_P01#
                           <isNotNull property="locNum_B">
                            AND ACP.LOC_NUM                &lt;&gt; #locNum_B#
                           </isNotNull>

                            AND ACP.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                            AND ACP.PTY_LOC_PK              = PLW.PTY_LOC_PK
                            
                            AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                            AND SFD.EZCANCELFLAG (+)        = '0'
                            AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                            AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD           = OAS.GLBL_CMPY_CD (+)
                            AND OAS.EZCANCELFLAG (+)        = '0'
                            AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                            AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                            
                           <isNotNull property="dispTrtyFlg">
                            AND ACP.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND TRA.EZCANCELFLAG (+)        = '0'
                            AND ACP.DS_ACCT_NUM             = TRA.DS_ACCT_NUM (+)
                            
                            AND PLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                            AND PLW.LOC_NUM                 = TRA.LOC_NUM (+)
                           </isNotNull>
                            AND PLW.DUNS_NUM                = #dunsNum_B#
                         )
                    </isNotNull>
                    ) RT
                ORDER BY
                     RT.DS_ACCT_NUM
                    ,RT.LOC_NUM
            ) A
            WHERE
                ROWNUM &lt;= #rowNum#
    </statement>

    <resultMap id="result.getDuplicateList_realTime" class="NMAL2830_CSMsg">
        <result property="xxTpCd_C"                column="COND"                      javaType="EZDSStringItem"/>
        <result property="dsAcctNum_C"             column="DS_ACCT_NUM"               javaType="EZDSStringItem"/>
        <result property="dsAcctNm_C"              column="DS_ACCT_NM"                javaType="EZDSStringItem"/>
        <result property="dsAcctTpCd_C"            column="DS_ACCT_TP_CD"             javaType="EZDSStringItem"/>
        <result property="dsAcctTpNm_C"            column="DS_ACCT_TP_DESC_TXT"       javaType="EZDSStringItem"/>
        <result property="firstLineAddr_C"         column="FIRST_LINE_ADDR"           javaType="EZDSStringItem"/>
        <result property="scdLineAddr_C"           column="SCD_LINE_ADDR"             javaType="EZDSStringItem"/>
        <result property="thirdLineAddr_C"         column="THIRD_LINE_ADDR"           javaType="EZDSStringItem"/>
        <result property="frthLineAddr_C"          column="FRTH_LINE_ADDR"            javaType="EZDSStringItem"/>
        <result property="locNum_C"                column="LOC_NUM"                   javaType="EZDSStringItem"/>
        <result property="ctyAddr_C"               column="CTY_ADDR"                  javaType="EZDSStringItem"/>
        <result property="stCd_C"                  column="ST_CD"                     javaType="EZDSStringItem"/>
        <result property="postCd_C"                column="POST_CD"                   javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_1"  column="LOB_ROLE_NM_01"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_1"         column="ORG_CD_01"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_1"             column="PSN_NM_01"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_2"  column="LOB_ROLE_NM_02"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_2"         column="ORG_CD_02"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_2"             column="PSN_NM_02"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_3"  column="LOB_ROLE_NM_03"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_3"         column="ORG_CD_03"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_3"             column="PSN_NM_03"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_4"  column="LOB_ROLE_NM_04"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_4"         column="ORG_CD_04"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_4"             column="PSN_NM_04"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_5"  column="LOB_ROLE_NM_05"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_5"         column="ORG_CD_05"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_5"             column="PSN_NM_05"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_6"  column="LOB_ROLE_NM_06"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_6"         column="ORG_CD_06"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_6"             column="PSN_NM_06"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_7"  column="LOB_ROLE_NM_07"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_7"         column="ORG_CD_07"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_7"             column="PSN_NM_07"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_8"  column="LOB_ROLE_NM_08"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_8"         column="ORG_CD_08"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_8"             column="PSN_NM_08"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_9"  column="LOB_ROLE_NM_09"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_9"         column="ORG_CD_09"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_9"             column="PSN_NM_09"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_10" column="LOB_ROLE_NM_10"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_10"        column="ORG_CD_10"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_10"            column="PSN_NM_10"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_11" column="LOB_ROLE_NM_11"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_11"        column="ORG_CD_11"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_11"            column="PSN_NM_11"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_12" column="LOB_ROLE_NM_12"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_12"        column="ORG_CD_12"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_12"            column="PSN_NM_12"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_13" column="LOB_ROLE_NM_13"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_13"        column="ORG_CD_13"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_13"            column="PSN_NM_13"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_14" column="LOB_ROLE_NM_14"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_14"        column="ORG_CD_14"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_14"            column="PSN_NM_14"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_15" column="LOB_ROLE_NM_15"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_15"        column="ORG_CD_15"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_15"            column="PSN_NM_15"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_16" column="LOB_ROLE_NM_16"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_16"        column="ORG_CD_16"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_16"            column="PSN_NM_16"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_17" column="LOB_ROLE_NM_17"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_17"        column="ORG_CD_17"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_17"            column="PSN_NM_17"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_18" column="LOB_ROLE_NM_18"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_18"        column="ORG_CD_18"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_18"            column="PSN_NM_18"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_19" column="LOB_ROLE_NM_19"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_19"        column="ORG_CD_19"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_19"            column="PSN_NM_19"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_20" column="LOB_ROLE_NM_20"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_20"        column="ORG_CD_20"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_20"            column="PSN_NM_20"                 javaType="EZDSStringItem"/>

        <result property="dsXrefAcctCd_CS"         column="SFDC_DS_XREF_ACCT_CD"      javaType="EZDSStringItem"/>
        <result property="dsXrefAcctCd_CO"         column="OASIS_DS_XREF_ACCT_CD"     javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getProspectList_nonRealTime" parameterClass="Map" resultMap="result.getProspectList_nonRealTime">
        WITH
            SELL_TO_CUST_A AS (
                SELECT
                     X.GLBL_CMPY_CD
                    ,X.SELL_TO_CUST_CD AS DS_ACCT_NUM
                    ,X.DS_ACCT_NM
                    ,X.DS_ACCT_TP_CD
                FROM
                    (
                        SELECT
                             DAC.GLBL_CMPY_CD
                            ,DAC.SELL_TO_CUST_CD
                            ,DAC.DS_ACCT_NM
                            ,DAC.DS_ACCT_TP_CD
                        FROM
                             SELL_TO_CUST   DAC
                        WHERE
                                DAC.GLBL_CMPY_CD            = #glblCmpyCd#
                            AND DAC.EZCANCELFLAG            = '0'
                            AND DAC.RGTN_STS_CD             = #rgtnStsCd_P20#
                            AND DAC.DS_ACCT_ACTV_CUST_FLG   = 'Y'
                    ) X
            ),
            DS_ACCT_PROS_B AS (
                SELECT
                     X.GLBL_CMPY_CD
                    ,X.DS_ACCT_NUM AS DS_ACCT_NUM
                    ,X.DS_ACCT_NM
                    ,X.DS_ACCT_TP_CD
                    ,X.LOC_NUM
                    ,X.EFF_FROM_DT
                    ,X.EFF_THRU_DT
                    ,X.RGTN_STS_CD
                FROM
                    (
                        SELECT
                             DAP.GLBL_CMPY_CD
                            ,DAP.DS_ACCT_NUM
                            ,DAP.DS_ACCT_NM
                            ,DAP.DS_ACCT_TP_CD
                            ,DAP.LOC_NUM
                            ,DAP.EFF_FROM_DT
                            ,DAP.EFF_THRU_DT
                            ,DAP.RGTN_STS_CD
                        FROM
                             DS_ACCT_PROS   DAP
                        WHERE
                                DAP.GLBL_CMPY_CD            = #glblCmpyCd#
                            AND DAP.EZCANCELFLAG            = '0'
                            AND DAP.RGTN_STS_CD             = #rgtnStsCd_P01#
                            AND DAP.DS_ACCT_ACTV_CUST_FLG   = 'Y'
                    ) X
            )
            SELECT
                 A.DUP_CANDI_DS_ACCT_NUM
                ,A.DS_ACCT_NM
                ,A.DS_ACCT_TP_CD
                ,A.DS_ACCT_TP_DESC_TXT
                ,A.DUP_CANDI_LOC_NUM
                ,A.FIRST_LINE_ADDR
                ,A.SCD_LINE_ADDR
                ,A.THIRD_LINE_ADDR
                ,A.FRTH_LINE_ADDR
                ,A.CTY_ADDR
                ,A.POST_CD
                ,A.ST_CD
               <isNotNull property="dispTrtyFlg">
                ,A.ORG_CD_01
                ,A.LOB_ROLE_NM_01
                ,A.PSN_NM_01
                ,A.ORG_CD_02
                ,A.LOB_ROLE_NM_02
                ,A.PSN_NM_02
                ,A.ORG_CD_03
                ,A.LOB_ROLE_NM_03
                ,A.PSN_NM_03
                ,A.ORG_CD_04
                ,A.LOB_ROLE_NM_04
                ,A.PSN_NM_04
                ,A.ORG_CD_05
                ,A.LOB_ROLE_NM_05
                ,A.PSN_NM_05
                ,A.ORG_CD_06
                ,A.LOB_ROLE_NM_06
                ,A.PSN_NM_06
                ,A.ORG_CD_07
                ,A.LOB_ROLE_NM_07
                ,A.PSN_NM_07
                ,A.ORG_CD_08
                ,A.LOB_ROLE_NM_08
                ,A.PSN_NM_08
                ,A.ORG_CD_09
                ,A.LOB_ROLE_NM_09
                ,A.PSN_NM_09
                ,A.ORG_CD_10
                ,A.LOB_ROLE_NM_10
                ,A.PSN_NM_10
                ,A.ORG_CD_11
                ,A.LOB_ROLE_NM_11
                ,A.PSN_NM_11
                ,A.ORG_CD_12
                ,A.LOB_ROLE_NM_12
                ,A.PSN_NM_12
                ,A.ORG_CD_13
                ,A.LOB_ROLE_NM_13
                ,A.PSN_NM_13
                ,A.ORG_CD_14
                ,A.LOB_ROLE_NM_14
                ,A.PSN_NM_14
                ,A.ORG_CD_15
                ,A.LOB_ROLE_NM_15
                ,A.PSN_NM_15
                ,A.ORG_CD_16
                ,A.LOB_ROLE_NM_16
                ,A.PSN_NM_16
                ,A.ORG_CD_17
                ,A.LOB_ROLE_NM_17
                ,A.PSN_NM_17
                ,A.ORG_CD_18
                ,A.LOB_ROLE_NM_18
                ,A.PSN_NM_18
                ,A.ORG_CD_19
                ,A.LOB_ROLE_NM_19
                ,A.PSN_NM_19
                ,A.ORG_CD_20
                ,A.LOB_ROLE_NM_20
                ,A.PSN_NM_20
               </isNotNull>
                ,A.EXACT_MATCH_FLG
                ,A.PRTL_MATCH_FLG
                ,A.DUNS_MATCH_FLG
            FROM
            (
                SELECT DISTINCT
                     CLW.DUP_CANDI_DS_ACCT_NUM
                   <!-- 2017/10/06 QC#20769 Mod start-->
                   <!-- 
                    ,ACP.DS_ACCT_NM
                    ,ACP.DS_ACCT_TP_CD
                   -->
                    ,ACP2.DS_ACCT_NM
                    ,ACP2.DS_ACCT_TP_CD
                   <!-- 2017/10/06 QC#20769 Mod end-->
                    ,DAT.DS_ACCT_TP_DESC_TXT
                    ,CLW.DUP_CANDI_LOC_NUM
                    ,PLW.FIRST_LINE_ADDR
                    ,PLW.SCD_LINE_ADDR
                    ,PLW.THIRD_LINE_ADDR
                    ,PLW.FRTH_LINE_ADDR
                    ,PLW.CTY_ADDR
                    ,PLW.POST_CD
                    ,PLW.ST_CD
                   <isNotNull property="dispTrtyFlg">
                    -- 01
                    ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                     ELSE NULL END AS LOB_ROLE_NM_01
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                     ELSE NULL END AS PSN_NM_01
                    -- 02
                    ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                     ELSE NULL END AS LOB_ROLE_NM_02
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                     ELSE NULL END AS PSN_NM_02
                    -- 03
                    ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                     ELSE NULL END AS LOB_ROLE_NM_03
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                     ELSE NULL END AS PSN_NM_03
                    -- 04
                    ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                     ELSE NULL END AS LOB_ROLE_NM_04
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                     ELSE NULL END AS PSN_NM_04
                    -- 05
                    ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                     ELSE NULL END AS LOB_ROLE_NM_05
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                     ELSE NULL END AS PSN_NM_05
                    -- 06
                    ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                     ELSE NULL END AS LOB_ROLE_NM_06
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                     ELSE NULL END AS PSN_NM_06
                    -- 07
                    ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                     ELSE NULL END AS LOB_ROLE_NM_07
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                     ELSE NULL END AS PSN_NM_07
                    -- 08
                    ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                     ELSE NULL END AS LOB_ROLE_NM_08
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                     ELSE NULL END AS PSN_NM_08
                    -- 09
                    ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                     ELSE NULL END AS LOB_ROLE_NM_09
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                     ELSE NULL END AS PSN_NM_09
                    -- 10
                    ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                     ELSE NULL END AS LOB_ROLE_NM_10
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                     ELSE NULL END AS PSN_NM_10
                    -- 11
                    ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                     ELSE NULL END AS LOB_ROLE_NM_11
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                     ELSE NULL END AS PSN_NM_11
                    -- 12
                    ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                     ELSE NULL END AS LOB_ROLE_NM_12
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                     ELSE NULL END AS PSN_NM_12
                    -- 13
                    ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                     ELSE NULL END AS LOB_ROLE_NM_13
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                     ELSE NULL END AS PSN_NM_13
                    -- 14
                    ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                     ELSE NULL END AS LOB_ROLE_NM_14
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                     ELSE NULL END AS PSN_NM_14
                    -- 15
                    ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                     ELSE NULL END AS LOB_ROLE_NM_15
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                     ELSE NULL END AS PSN_NM_15
                    -- 16
                    ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                     ELSE NULL END AS LOB_ROLE_NM_16
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                     ELSE NULL END AS PSN_NM_16
                    -- 17
                    ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                     ELSE NULL END AS LOB_ROLE_NM_17
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                     ELSE NULL END AS PSN_NM_17
                    -- 18
                    ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                     ELSE NULL END AS LOB_ROLE_NM_18
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                     ELSE NULL END AS PSN_NM_18
                    -- 19
                    ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                     ELSE NULL END AS LOB_ROLE_NM_19
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                     ELSE NULL END AS PSN_NM_19
                    -- 20
                    ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                     ELSE NULL END AS LOB_ROLE_NM_20
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                     ELSE NULL END AS PSN_NM_20
                   </isNotNull>
                    ,SFD.DS_XREF_ACCT_CD  AS SFDC_DS_XREF_ACCT_CD
                    ,OAS.DS_XREF_ACCT_CD  AS OASIS_DS_XREF_ACCT_CD
                    ,CLW.EXACT_MATCH_FLG  AS EXACT_MATCH_FLG
                    ,CLW.PRTL_MATCH_FLG   AS PRTL_MATCH_FLG
                    ,CLW.DUNS_MATCH_FLG   AS DUNS_MATCH_FLG
                FROM
                     SELL_TO_CUST_A         ACP
                    ,DS_ACCT_TP             DAT
                    ,ACCT_LOC               ALC
                    ,DUP_CANDI_LOC_WRK      CLW
                    ,PTY_LOC_WRK            PLW
                    ,DS_XREF_ACCT           SFD
                    ,DS_XREF_ACCT           OAS
                   <isNotNull property="dispTrtyFlg">
                    ,ACCT_TRTY_RESRC_ASG    TRA
                   </isNotNull>
                   <!-- 2017/10/06 QC#20769 add start-->
                    ,SELL_TO_CUST_A         ACP2
                   <!-- 2017/10/06 QC#20769 add end-->
                WHERE
                        ACP2.GLBL_CMPY_CD           = DAT.GLBL_CMPY_CD (+)
                    AND DAT.EZCANCELFLAG (+)        = '0'
                    AND ACP2.DS_ACCT_TP_CD          = DAT.DS_ACCT_TP_CD (+)
                    
                    AND ACP.GLBL_CMPY_CD            = ALC.GLBL_CMPY_CD
                    AND ALC.EZCANCELFLAG            = '0'
                    AND ACP.DS_ACCT_NUM             = ALC.DS_ACCT_NUM
                    AND ALC.EFF_FROM_DT            &lt;= #salesDate#
                    AND NVL(ALC.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                    AND ALC.RGTN_STS_CD             = #rgtnStsCd_P20#
                    
                    AND ALC.GLBL_CMPY_CD            = CLW.GLBL_CMPY_CD
                    AND CLW.EZCANCELFLAG            = '0'
                    AND ALC.DS_ACCT_NUM             = CLW.DS_ACCT_NUM
                    AND ALC.LOC_NUM                 = CLW.LOC_NUM
                    AND CLW.DS_LOC_TP_CD           &lt;&gt; #locTp_NonUnderReview#
                    AND CLW.DUP_CANDI_LOC_TP_CD    &lt;&gt; #locTp_NonUnderReview#
                    
                    AND CLW.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                    AND PLW.EZCANCELFLAG            = '0'
                    AND CLW.DUP_CANDI_LOC_NUM       = PLW.LOC_NUM
                    
                    AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                    AND SFD.EZCANCELFLAG (+)        = '0'
                    AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                    AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                    
                    AND PLW.GLBL_CMPY_CD            = OAS.GLBL_CMPY_CD (+)
                    AND OAS.EZCANCELFLAG (+)        = '0'
                    AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                    AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                    
                   <isNotNull property="dispTrtyFlg">
                    AND CLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                    AND TRA.EZCANCELFLAG (+)        = '0'
                    AND CLW.DUP_CANDI_DS_ACCT_NUM   = TRA.DS_ACCT_NUM (+)
                    AND CLW.DUP_CANDI_LOC_NUM       = TRA.LOC_NUM (+)
                   </isNotNull>
                   <isNotNull property="dsAcctNum_B">
                    AND ALC.DS_ACCT_NUM             = #dsAcctNum_B#
                   </isNotNull>
                   <isNotNull property="locNum_B">
                    AND ALC.LOC_NUM                 = #locNum_B#
                   </isNotNull>
                   
                   <!-- 2017/10/06 QC#20769 add start-->
                    AND CLW.GLBL_CMPY_CD            = ACP2.GLBL_CMPY_CD
                    AND CLW.DUP_CANDI_DS_ACCT_NUM   = ACP2.DS_ACCT_NUM
                   <!-- 2017/10/06 QC#20769 add end-->
                   UNION ALL
                   SELECT DISTINCT
                     CLW.DUP_CANDI_DS_ACCT_NUM
                   <!-- 2017/10/06 QC#20769 Mod start-->
                   <!-- 
                    ,ACP.DS_ACCT_NM
                    ,ACP.DS_ACCT_TP_CD
                   -->
                    ,ACP2.DS_ACCT_NM
                    ,ACP2.DS_ACCT_TP_CD
                   <!-- 2017/10/06 QC#20769 Mod end-->
                    ,DAT.DS_ACCT_TP_DESC_TXT
                    ,CLW.DUP_CANDI_LOC_NUM
                    ,PLW.FIRST_LINE_ADDR
                    ,PLW.SCD_LINE_ADDR
                    ,PLW.THIRD_LINE_ADDR
                    ,PLW.FRTH_LINE_ADDR
                    ,PLW.CTY_ADDR
                    ,PLW.POST_CD
                    ,PLW.ST_CD
                   <isNotNull property="dispTrtyFlg">
                    -- 01
                    ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                     ELSE NULL END AS LOB_ROLE_NM_01
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                     ELSE NULL END AS PSN_NM_01
                    -- 02
                    ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                     ELSE NULL END AS LOB_ROLE_NM_02
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                     ELSE NULL END AS PSN_NM_02
                    -- 03
                    ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                     ELSE NULL END AS LOB_ROLE_NM_03
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                     ELSE NULL END AS PSN_NM_03
                    -- 04
                    ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                     ELSE NULL END AS LOB_ROLE_NM_04
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                     ELSE NULL END AS PSN_NM_04
                    -- 05
                    ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                     ELSE NULL END AS LOB_ROLE_NM_05
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                     ELSE NULL END AS PSN_NM_05
                    -- 06
                    ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                     ELSE NULL END AS LOB_ROLE_NM_06
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                     ELSE NULL END AS PSN_NM_06
                    -- 07
                    ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                     ELSE NULL END AS LOB_ROLE_NM_07
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                     ELSE NULL END AS PSN_NM_07
                    -- 08
                    ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                     ELSE NULL END AS LOB_ROLE_NM_08
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                     ELSE NULL END AS PSN_NM_08
                    -- 09
                    ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                     ELSE NULL END AS LOB_ROLE_NM_09
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                     ELSE NULL END AS PSN_NM_09
                    -- 10
                    ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                     ELSE NULL END AS LOB_ROLE_NM_10
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                     ELSE NULL END AS PSN_NM_10
                    -- 11
                    ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                     ELSE NULL END AS LOB_ROLE_NM_11
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                     ELSE NULL END AS PSN_NM_11
                    -- 12
                    ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                     ELSE NULL END AS LOB_ROLE_NM_12
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                     ELSE NULL END AS PSN_NM_12
                    -- 13
                    ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                     ELSE NULL END AS LOB_ROLE_NM_13
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                     ELSE NULL END AS PSN_NM_13
                    -- 14
                    ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                     ELSE NULL END AS LOB_ROLE_NM_14
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                     ELSE NULL END AS PSN_NM_14
                    -- 15
                    ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                     ELSE NULL END AS LOB_ROLE_NM_15
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                     ELSE NULL END AS PSN_NM_15
                    -- 16
                    ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                     ELSE NULL END AS LOB_ROLE_NM_16
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                     ELSE NULL END AS PSN_NM_16
                    -- 17
                    ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                     ELSE NULL END AS LOB_ROLE_NM_17
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                     ELSE NULL END AS PSN_NM_17
                    -- 18
                    ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                     ELSE NULL END AS LOB_ROLE_NM_18
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                     ELSE NULL END AS PSN_NM_18
                    -- 19
                    ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                     ELSE NULL END AS LOB_ROLE_NM_19
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                     ELSE NULL END AS PSN_NM_19
                    -- 20
                    ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                     ELSE NULL END AS LOB_ROLE_NM_20
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                     ELSE NULL END AS PSN_NM_20
                   </isNotNull>
                    ,SFD.DS_XREF_ACCT_CD  AS SFDC_DS_XREF_ACCT_CD
                    ,OAS.DS_XREF_ACCT_CD  AS OASIS_DS_XREF_ACCT_CD
                    ,CLW.EXACT_MATCH_FLG  AS EXACT_MATCH_FLG
                    ,CLW.PRTL_MATCH_FLG   AS PRTL_MATCH_FLG
                    ,CLW.DUNS_MATCH_FLG   AS DUNS_MATCH_FLG
                FROM
                     SELL_TO_CUST_A         ACP
                    ,DS_ACCT_TP             DAT
                    ,ACCT_LOC               ALC
                    ,DUP_CANDI_LOC_WRK      CLW
                    ,PROS_PTY_LOC_WRK       PLW
                    ,DS_XREF_ACCT           SFD
                    ,DS_XREF_ACCT           OAS
                   <isNotNull property="dispTrtyFlg">
                    ,ACCT_TRTY_RESRC_ASG    TRA
                   </isNotNull>
                   <!-- 2017/10/06 QC#20769 add start-->
                    ,DS_ACCT_PROS_B         ACP2
                   <!-- 2017/10/06 QC#20769 add end-->
                WHERE
                        ACP2.GLBL_CMPY_CD           = DAT.GLBL_CMPY_CD (+)
                    AND DAT.EZCANCELFLAG (+)        = '0'
                    AND ACP2.DS_ACCT_TP_CD          = DAT.DS_ACCT_TP_CD (+)
                    
                    AND ACP.GLBL_CMPY_CD            = ALC.GLBL_CMPY_CD
                    AND ALC.EZCANCELFLAG            = '0'
                    AND ACP.DS_ACCT_NUM             = ALC.DS_ACCT_NUM
                    AND ALC.EFF_FROM_DT            &lt;= #salesDate#
                    AND NVL(ALC.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                    AND ALC.RGTN_STS_CD             = #rgtnStsCd_P20#
                    
                    AND ALC.GLBL_CMPY_CD            = CLW.GLBL_CMPY_CD
                    AND CLW.EZCANCELFLAG            = '0'
                    AND ALC.DS_ACCT_NUM             = CLW.DS_ACCT_NUM
                    AND ALC.LOC_NUM                 = CLW.LOC_NUM
                    AND CLW.DS_LOC_TP_CD           &lt;&gt; #locTp_NonUnderReview#
                    AND CLW.DUP_CANDI_LOC_TP_CD    &lt;&gt; #locTp_NonUnderReview#
                    
                    AND CLW.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                    AND PLW.EZCANCELFLAG            = '0'
                    AND CLW.DUP_CANDI_LOC_NUM       = PLW.LOC_NUM
                    
                    AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                    AND SFD.EZCANCELFLAG (+)        = '0'
                    AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                    AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                    
                    AND PLW.GLBL_CMPY_CD            = OAS.GLBL_CMPY_CD (+)
                    AND OAS.EZCANCELFLAG (+)        = '0'
                    AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                    AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                    
                   <isNotNull property="dispTrtyFlg">
                    AND CLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                    AND TRA.EZCANCELFLAG (+)        = '0'
                    AND CLW.DUP_CANDI_DS_ACCT_NUM   = TRA.DS_ACCT_NUM (+)
                    AND CLW.DUP_CANDI_LOC_NUM       = TRA.LOC_NUM (+)
                   </isNotNull>
                   <isNotNull property="dsAcctNum_B">
                    AND ALC.DS_ACCT_NUM             = #dsAcctNum_B#
                   </isNotNull>
                   <isNotNull property="locNum_B">
                    AND ALC.LOC_NUM                 = #locNum_B#
                   </isNotNull>
                   
                   <!-- 2017/10/06 QC#20769 add start-->
                    AND CLW.GLBL_CMPY_CD            = ACP2.GLBL_CMPY_CD
                    AND CLW.DUP_CANDI_DS_ACCT_NUM   = ACP2.DS_ACCT_NUM
                  <!-- 2017/10/06 QC#20769 add end-->
                UNION ALL
                SELECT DISTINCT
                     CLW.DUP_CANDI_DS_ACCT_NUM
                   <!-- 2017/10/06 QC#20769 Mod start-->
                   <!-- 
                    ,ACP.DS_ACCT_NM
                    ,ACP.DS_ACCT_TP_CD
                   -->
                    ,ACP2.DS_ACCT_NM
                    ,ACP2.DS_ACCT_TP_CD
                   <!-- 2017/10/06 QC#20769 Mod end-->
                    ,DAT.DS_ACCT_TP_DESC_TXT
                    ,CLW.DUP_CANDI_LOC_NUM
                    ,PLW.FIRST_LINE_ADDR
                    ,PLW.SCD_LINE_ADDR
                    ,PLW.THIRD_LINE_ADDR
                    ,PLW.FRTH_LINE_ADDR
                    ,PLW.CTY_ADDR
                    ,PLW.POST_CD
                    ,PLW.ST_CD
                   <isNotNull property="dispTrtyFlg">
                    -- 01
                    ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                     ELSE NULL END AS LOB_ROLE_NM_01
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                     ELSE NULL END AS PSN_NM_01
                    -- 02
                    ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                     ELSE NULL END AS LOB_ROLE_NM_02
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                     ELSE NULL END AS PSN_NM_02
                    -- 03
                    ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                     ELSE NULL END AS LOB_ROLE_NM_03
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                     ELSE NULL END AS PSN_NM_03
                    -- 04
                    ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                     ELSE NULL END AS LOB_ROLE_NM_04
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                     ELSE NULL END AS PSN_NM_04
                    -- 05
                    ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                     ELSE NULL END AS LOB_ROLE_NM_05
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                     ELSE NULL END AS PSN_NM_05
                    -- 06
                    ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                     ELSE NULL END AS LOB_ROLE_NM_06
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                     ELSE NULL END AS PSN_NM_06
                    -- 07
                    ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                     ELSE NULL END AS LOB_ROLE_NM_07
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                     ELSE NULL END AS PSN_NM_07
                    -- 08
                    ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                     ELSE NULL END AS LOB_ROLE_NM_08
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                     ELSE NULL END AS PSN_NM_08
                    -- 09
                    ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                     ELSE NULL END AS LOB_ROLE_NM_09
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                     ELSE NULL END AS PSN_NM_09
                    -- 10
                    ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                     ELSE NULL END AS LOB_ROLE_NM_10
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                     ELSE NULL END AS PSN_NM_10
                    -- 11
                    ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                     ELSE NULL END AS LOB_ROLE_NM_11
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                     ELSE NULL END AS PSN_NM_11
                    -- 12
                    ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                     ELSE NULL END AS LOB_ROLE_NM_12
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                     ELSE NULL END AS PSN_NM_12
                    -- 13
                    ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                     ELSE NULL END AS LOB_ROLE_NM_13
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                     ELSE NULL END AS PSN_NM_13
                    -- 14
                    ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                     ELSE NULL END AS LOB_ROLE_NM_14
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                     ELSE NULL END AS PSN_NM_14
                    -- 15
                    ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                     ELSE NULL END AS LOB_ROLE_NM_15
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                     ELSE NULL END AS PSN_NM_15
                    -- 16
                    ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                     ELSE NULL END AS LOB_ROLE_NM_16
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                     ELSE NULL END AS PSN_NM_16
                    -- 17
                    ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                     ELSE NULL END AS LOB_ROLE_NM_17
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                     ELSE NULL END AS PSN_NM_17
                    -- 18
                    ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                     ELSE NULL END AS LOB_ROLE_NM_18
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                     ELSE NULL END AS PSN_NM_18
                    -- 19
                    ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                     ELSE NULL END AS LOB_ROLE_NM_19
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                     ELSE NULL END AS PSN_NM_19
                    -- 20
                    ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                     ELSE NULL END AS LOB_ROLE_NM_20
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                     ELSE NULL END AS PSN_NM_20
                   </isNotNull>
                    ,SFD.DS_XREF_ACCT_CD  AS SFDC_DS_XREF_ACCT_CD
                    ,OAS.DS_XREF_ACCT_CD  AS OASIS_DS_XREF_ACCT_CD
                    ,CLW.EXACT_MATCH_FLG  AS EXACT_MATCH_FLG
                    ,CLW.PRTL_MATCH_FLG   AS PRTL_MATCH_FLG
                    ,CLW.DUNS_MATCH_FLG   AS DUNS_MATCH_FLG
                FROM
                     DS_ACCT_PROS_B         ACP
                    ,DS_ACCT_TP             DAT
                    ,DUP_CANDI_LOC_WRK      CLW
                    ,PROS_PTY_LOC_WRK       PLW
                    ,DS_XREF_ACCT           SFD
                    ,DS_XREF_ACCT           OAS
                   <isNotNull property="dispTrtyFlg">
                    ,PROS_TRTY_RESRC_ASG    TRA
                   </isNotNull>
                   <!-- 2017/10/06 QC#20769 add start-->
                    ,DS_ACCT_PROS_B         ACP2
                   <!-- 2017/10/06 QC#20769 add end-->
                WHERE
                        ACP2.GLBL_CMPY_CD           = DAT.GLBL_CMPY_CD (+)
                    AND DAT.EZCANCELFLAG (+)        = '0'
                    AND ACP2.DS_ACCT_TP_CD          = DAT.DS_ACCT_TP_CD (+)
                    
                    AND ACP.EFF_FROM_DT            &lt;= #salesDate#
                    AND NVL(ACP.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                    AND ACP.RGTN_STS_CD             = #rgtnStsCd_P01#
                    
                    AND ACP.GLBL_CMPY_CD            = CLW.GLBL_CMPY_CD
                    AND CLW.EZCANCELFLAG            = '0'
                    AND ACP.DS_ACCT_NUM             = CLW.DS_ACCT_NUM
                    AND ACP.LOC_NUM                 = CLW.LOC_NUM
                    AND CLW.DS_LOC_TP_CD           &lt;&gt; #locTp_NonUnderReview#
                    AND CLW.DUP_CANDI_LOC_TP_CD    &lt;&gt; #locTp_NonUnderReview#
                    
                    AND CLW.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                    AND PLW.EZCANCELFLAG            = '0'
                    AND CLW.DUP_CANDI_LOC_NUM       = PLW.LOC_NUM
                    
                    AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                    AND SFD.EZCANCELFLAG (+)        = '0'
                    AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                    AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                    
                    AND PLW.GLBL_CMPY_CD            = OAS.GLBL_CMPY_CD (+)
                    AND OAS.EZCANCELFLAG (+)        = '0'
                    AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                    AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                    
                   <isNotNull property="dispTrtyFlg">
                    AND CLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                    AND TRA.EZCANCELFLAG (+)        = '0'
                    AND CLW.DUP_CANDI_DS_ACCT_NUM   = TRA.DS_ACCT_NUM (+)
                    AND CLW.DUP_CANDI_LOC_NUM       = TRA.LOC_NUM (+)
                   </isNotNull>
                   <isNotNull property="dsAcctNum_B">
                    AND ACP.DS_ACCT_NUM             = #dsAcctNum_B#
                   </isNotNull>
                   <isNotNull property="locNum_B">
                    AND ACP.LOC_NUM                 = #locNum_B#
                   </isNotNull>
                   
                   <!-- 2017/10/06 QC#20769 add start-->
                    AND CLW.GLBL_CMPY_CD            = ACP2.GLBL_CMPY_CD
                    AND CLW.DUP_CANDI_DS_ACCT_NUM   = ACP2.DS_ACCT_NUM
                   <!-- 2017/10/06 QC#20769 add end-->
               UNION ALL
               SELECT DISTINCT
                     CLW.DUP_CANDI_DS_ACCT_NUM
                   <!-- 2017/10/06 QC#20769 Mod start-->
                   <!-- 
                    ,ACP.DS_ACCT_NM
                    ,ACP.DS_ACCT_TP_CD
                   -->
                    ,ACP2.DS_ACCT_NM
                    ,ACP2.DS_ACCT_TP_CD
                   <!-- 2017/10/06 QC#20769 Mod end-->
                    ,DAT.DS_ACCT_TP_DESC_TXT
                    ,CLW.DUP_CANDI_LOC_NUM
                    ,PLW.FIRST_LINE_ADDR
                    ,PLW.SCD_LINE_ADDR
                    ,PLW.THIRD_LINE_ADDR
                    ,PLW.FRTH_LINE_ADDR
                    ,PLW.CTY_ADDR
                    ,PLW.POST_CD
                    ,PLW.ST_CD
                   <isNotNull property="dispTrtyFlg">
                    -- 01
                    ,TRA.ACCT_TRTY_ORG_CD_01 AS ORG_CD_01
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_01 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_01) 
                     ELSE NULL END AS LOB_ROLE_NM_01
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_01 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_01) 
                     ELSE NULL END AS PSN_NM_01
                    -- 02
                    ,TRA.ACCT_TRTY_ORG_CD_02 AS ORG_CD_02
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_02 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_02) 
                     ELSE NULL END AS LOB_ROLE_NM_02
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_02 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_02) 
                     ELSE NULL END AS PSN_NM_02
                    -- 03
                    ,TRA.ACCT_TRTY_ORG_CD_03 AS ORG_CD_03
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_03 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_03) 
                     ELSE NULL END AS LOB_ROLE_NM_03
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_03 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_03) 
                     ELSE NULL END AS PSN_NM_03
                    -- 04
                    ,TRA.ACCT_TRTY_ORG_CD_04 AS ORG_CD_04
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_04 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_04) 
                     ELSE NULL END AS LOB_ROLE_NM_04
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_04 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_04) 
                     ELSE NULL END AS PSN_NM_04
                    -- 05
                    ,TRA.ACCT_TRTY_ORG_CD_05 AS ORG_CD_05
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_05 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_05) 
                     ELSE NULL END AS LOB_ROLE_NM_05
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_05 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_05) 
                     ELSE NULL END AS PSN_NM_05
                    -- 06
                    ,TRA.ACCT_TRTY_ORG_CD_06 AS ORG_CD_06
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_06 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_06) 
                     ELSE NULL END AS LOB_ROLE_NM_06
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_06 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_06) 
                     ELSE NULL END AS PSN_NM_06
                    -- 07
                    ,TRA.ACCT_TRTY_ORG_CD_07 AS ORG_CD_07
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_07 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_07) 
                     ELSE NULL END AS LOB_ROLE_NM_07
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_07 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_07) 
                     ELSE NULL END AS PSN_NM_07
                    -- 08
                    ,TRA.ACCT_TRTY_ORG_CD_08 AS ORG_CD_08
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_08 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_08) 
                     ELSE NULL END AS LOB_ROLE_NM_08
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_08 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_08) 
                     ELSE NULL END AS PSN_NM_08
                    -- 09
                    ,TRA.ACCT_TRTY_ORG_CD_09 AS ORG_CD_09
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_09 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_09) 
                     ELSE NULL END AS LOB_ROLE_NM_09
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_09 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_09) 
                     ELSE NULL END AS PSN_NM_09
                    -- 10
                    ,TRA.ACCT_TRTY_ORG_CD_10 AS ORG_CD_10
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_10 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_10) 
                     ELSE NULL END AS LOB_ROLE_NM_10
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_10 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_10) 
                     ELSE NULL END AS PSN_NM_10
                    -- 11
                    ,TRA.ACCT_TRTY_ORG_CD_11 AS ORG_CD_11
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_11 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_11) 
                     ELSE NULL END AS LOB_ROLE_NM_11
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_11 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_11) 
                     ELSE NULL END AS PSN_NM_11
                    -- 12
                    ,TRA.ACCT_TRTY_ORG_CD_12 AS ORG_CD_12
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_12 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_12) 
                     ELSE NULL END AS LOB_ROLE_NM_12
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_12 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_12) 
                     ELSE NULL END AS PSN_NM_12
                    -- 13
                    ,TRA.ACCT_TRTY_ORG_CD_13 AS ORG_CD_13
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_13 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_13) 
                     ELSE NULL END AS LOB_ROLE_NM_13
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_13 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_13) 
                     ELSE NULL END AS PSN_NM_13
                    -- 14
                    ,TRA.ACCT_TRTY_ORG_CD_14 AS ORG_CD_14
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_14 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_14) 
                     ELSE NULL END AS LOB_ROLE_NM_14
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_14 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_14) 
                     ELSE NULL END AS PSN_NM_14
                    -- 15
                    ,TRA.ACCT_TRTY_ORG_CD_15 AS ORG_CD_15
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_15 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_15) 
                     ELSE NULL END AS LOB_ROLE_NM_15
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_15 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_15) 
                     ELSE NULL END AS PSN_NM_15
                    -- 16
                    ,TRA.ACCT_TRTY_ORG_CD_16 AS ORG_CD_16
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_16 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_16) 
                     ELSE NULL END AS LOB_ROLE_NM_16
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_16 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_16) 
                     ELSE NULL END AS PSN_NM_16
                    -- 17
                    ,TRA.ACCT_TRTY_ORG_CD_17 AS ORG_CD_17
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_17 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_17) 
                     ELSE NULL END AS LOB_ROLE_NM_17
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_17 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_17) 
                     ELSE NULL END AS PSN_NM_17
                    -- 18
                    ,TRA.ACCT_TRTY_ORG_CD_18 AS ORG_CD_18
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_18 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_18) 
                     ELSE NULL END AS LOB_ROLE_NM_18
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_18 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_18) 
                     ELSE NULL END AS PSN_NM_18
                    -- 19
                    ,TRA.ACCT_TRTY_ORG_CD_19 AS ORG_CD_19
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_19 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_19) 
                     ELSE NULL END AS LOB_ROLE_NM_19
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_19 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_19) 
                     ELSE NULL END AS PSN_NM_19
                    -- 20
                    ,TRA.ACCT_TRTY_ORG_CD_20 AS ORG_CD_20
                    ,CASE WHEN TRA.LINE_BIZ_ROLE_TP_CD_20 IS NOT NULL
                     THEN (SELECT LBRT.LINE_BIZ_ROLE_TP_DESC_TXT FROM LINE_BIZ_ROLE_TP LBRT WHERE LBRT.GLBL_CMPY_CD = #glblCmpyCd# AND LBRT.LINE_BIZ_ROLE_TP_CD = TRA.LINE_BIZ_ROLE_TP_CD_20) 
                     ELSE NULL END AS LOB_ROLE_NM_20
                    ,CASE WHEN TRA.ACCT_TRTY_PSN_CD_20 IS NOT NULL
                     THEN (SELECT SP.PSN_FIRST_NM || ' ' || SP.PSN_LAST_NM FROM S21_PSN SP WHERE SP.GLBL_CMPY_CD = #glblCmpyCd# AND SP.PSN_CD = TRA.ACCT_TRTY_PSN_CD_20) 
                     ELSE NULL END AS PSN_NM_20
                   </isNotNull>
                    ,SFD.DS_XREF_ACCT_CD  AS SFDC_DS_XREF_ACCT_CD
                    ,OAS.DS_XREF_ACCT_CD  AS OASIS_DS_XREF_ACCT_CD
                    ,CLW.EXACT_MATCH_FLG  AS EXACT_MATCH_FLG
                    ,CLW.PRTL_MATCH_FLG   AS PRTL_MATCH_FLG
                    ,CLW.DUNS_MATCH_FLG   AS DUNS_MATCH_FLG
                FROM
                     DS_ACCT_PROS_B         ACP
                    ,DS_ACCT_TP             DAT
                    ,DUP_CANDI_LOC_WRK      CLW
                    ,PTY_LOC_WRK            PLW
                    ,DS_XREF_ACCT           SFD
                    ,DS_XREF_ACCT           OAS
                   <isNotNull property="dispTrtyFlg">
                    ,PROS_TRTY_RESRC_ASG    TRA
                   </isNotNull>
                   <!-- 2017/10/06 QC#20769 add start-->
                    ,SELL_TO_CUST_A         ACP2
                   <!-- 2017/10/06 QC#20769 add end-->
                WHERE
                        ACP2.GLBL_CMPY_CD           = DAT.GLBL_CMPY_CD (+)
                    AND DAT.EZCANCELFLAG (+)        = '0'
                    AND ACP2.DS_ACCT_TP_CD          = DAT.DS_ACCT_TP_CD (+)
                    
                    AND ACP.EFF_FROM_DT            &lt;= #salesDate#
                    AND NVL(ACP.EFF_THRU_DT, #max_date#)       &gt;= #salesDate#
                    AND ACP.RGTN_STS_CD             = #rgtnStsCd_P01#
                    
                    AND ACP.GLBL_CMPY_CD            = CLW.GLBL_CMPY_CD
                    AND CLW.EZCANCELFLAG            = '0'
                    AND ACP.DS_ACCT_NUM             = CLW.DS_ACCT_NUM
                    AND ACP.LOC_NUM                 = CLW.LOC_NUM
                    AND CLW.DS_LOC_TP_CD           &lt;&gt; #locTp_NonUnderReview#
                    AND CLW.DUP_CANDI_LOC_TP_CD    &lt;&gt; #locTp_NonUnderReview#
                    
                    AND CLW.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD
                    AND PLW.EZCANCELFLAG            = '0'
                    AND CLW.DUP_CANDI_LOC_NUM       = PLW.LOC_NUM
                    
                    AND PLW.GLBL_CMPY_CD            = SFD.GLBL_CMPY_CD (+)
                    AND SFD.EZCANCELFLAG (+)        = '0'
                    AND SFD.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_sfdc#
                    AND PLW.LOC_NUM                 = SFD.LOC_NUM (+)
                    
                    AND PLW.GLBL_CMPY_CD            = OAS.GLBL_CMPY_CD (+)
                    AND OAS.EZCANCELFLAG (+)        = '0'
                    AND OAS.DS_XREF_ACCT_TP_CD (+)  = #dsXrefAcctTpCd_oasis#
                    AND PLW.LOC_NUM                 = OAS.LOC_NUM (+)
                    
                   <isNotNull property="dispTrtyFlg">
                    AND CLW.GLBL_CMPY_CD            = TRA.GLBL_CMPY_CD (+)
                    AND TRA.EZCANCELFLAG (+)        = '0'
                    AND CLW.DUP_CANDI_DS_ACCT_NUM   = TRA.DS_ACCT_NUM (+)
                    AND CLW.DUP_CANDI_LOC_NUM       = TRA.LOC_NUM (+)
                   </isNotNull>
                   <isNotNull property="dsAcctNum_B">
                    AND ACP.DS_ACCT_NUM             = #dsAcctNum_B#
                   </isNotNull>
                   <isNotNull property="locNum_B">
                    AND ACP.LOC_NUM                 = #locNum_B#
                   </isNotNull>
                   <!-- 2017/10/06 QC#20769 add start-->
                    AND CLW.GLBL_CMPY_CD            = ACP2.GLBL_CMPY_CD
                    AND CLW.DUP_CANDI_DS_ACCT_NUM   = ACP2.DS_ACCT_NUM
                   <!-- 2017/10/06 QC#20769 add end-->
            ) A
            WHERE ROWNUM &lt;= #rowNum#
            ORDER BY
                 A.DUP_CANDI_DS_ACCT_NUM
                ,A.DUP_CANDI_LOC_NUM
    </statement>

    <resultMap id="result.getProspectList_nonRealTime" class="NMAL2830_CSMsg">
        <result property="dsAcctNum_C"             column="DUP_CANDI_DS_ACCT_NUM"     javaType="EZDSStringItem"/>
        <result property="dsAcctNm_C"              column="DS_ACCT_NM"                javaType="EZDSStringItem"/>
        <result property="dsAcctTpCd_C"            column="DS_ACCT_TP_CD"             javaType="EZDSStringItem"/>
        <result property="dsAcctTpNm_C"            column="DS_ACCT_TP_DESC_TXT"       javaType="EZDSStringItem"/>
        <result property="locNum_C"                column="DUP_CANDI_LOC_NUM"         javaType="EZDSStringItem"/>
        <result property="firstLineAddr_C"         column="FIRST_LINE_ADDR"           javaType="EZDSStringItem"/>
        <result property="scdLineAddr_C"           column="SCD_LINE_ADDR"             javaType="EZDSStringItem"/>
        <result property="thirdLineAddr_C"         column="THIRD_LINE_ADDR"           javaType="EZDSStringItem"/>
        <result property="frthLineAddr_C"          column="FRTH_LINE_ADDR"            javaType="EZDSStringItem"/>
        <result property="ctyAddr_C"               column="CTY_ADDR"                  javaType="EZDSStringItem"/>
        <result property="postCd_C"                column="POST_CD"                   javaType="EZDSStringItem"/>
        <result property="stCd_C"                  column="ST_CD"                     javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_1"  column="LOB_ROLE_NM_01"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_1"         column="ORG_CD_01"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_1"             column="PSN_NM_01"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_2"  column="LOB_ROLE_NM_02"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_2"         column="ORG_CD_02"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_2"             column="PSN_NM_02"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_3"  column="LOB_ROLE_NM_03"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_3"         column="ORG_CD_03"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_3"             column="PSN_NM_03"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_4"  column="LOB_ROLE_NM_04"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_4"         column="ORG_CD_04"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_4"             column="PSN_NM_04"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_5"  column="LOB_ROLE_NM_05"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_5"         column="ORG_CD_05"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_5"             column="PSN_NM_05"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_6"  column="LOB_ROLE_NM_06"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_6"         column="ORG_CD_06"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_6"             column="PSN_NM_06"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_7"  column="LOB_ROLE_NM_07"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_7"         column="ORG_CD_07"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_7"             column="PSN_NM_07"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_8"  column="LOB_ROLE_NM_08"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_8"         column="ORG_CD_08"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_8"             column="PSN_NM_08"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_9"  column="LOB_ROLE_NM_09"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_9"         column="ORG_CD_09"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_9"             column="PSN_NM_09"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_10" column="LOB_ROLE_NM_10"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_10"        column="ORG_CD_10"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_10"            column="PSN_NM_10"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_11" column="LOB_ROLE_NM_11"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_11"        column="ORG_CD_11"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_11"            column="PSN_NM_11"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_12" column="LOB_ROLE_NM_12"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_12"        column="ORG_CD_12"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_12"            column="PSN_NM_12"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_13" column="LOB_ROLE_NM_13"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_13"        column="ORG_CD_13"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_13"            column="PSN_NM_13"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_14" column="LOB_ROLE_NM_14"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_14"        column="ORG_CD_14"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_14"            column="PSN_NM_14"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_15" column="LOB_ROLE_NM_15"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_15"        column="ORG_CD_15"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_15"            column="PSN_NM_15"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_16" column="LOB_ROLE_NM_16"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_16"        column="ORG_CD_16"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_16"            column="PSN_NM_16"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_17" column="LOB_ROLE_NM_17"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_17"        column="ORG_CD_17"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_17"            column="PSN_NM_17"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_18" column="LOB_ROLE_NM_18"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_18"        column="ORG_CD_18"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_18"            column="PSN_NM_18"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_19" column="LOB_ROLE_NM_19"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_19"        column="ORG_CD_19"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_19"            column="PSN_NM_19"                 javaType="EZDSStringItem"/>

        <result property="lineBizRoleTpDescTxt_20" column="LOB_ROLE_NM_20"            javaType="EZDSStringItem"/>
        <result property="acctTrtyOrgCd_20"        column="ORG_CD_20"                 javaType="EZDSStringItem"/>
        <result property="fill73Txt_20"            column="PSN_NM_20"                 javaType="EZDSStringItem"/>

        <result property="dsXrefAcctCd_CS"         column="SFDC_DS_XREF_ACCT_CD"      javaType="EZDSStringItem"/>
        <result property="dsXrefAcctCd_CO"         column="OASIS_DS_XREF_ACCT_CD"     javaType="EZDSStringItem"/>
        <result property="xxChkBox_EM"             column="EXACT_MATCH_FLG"           javaType="EZDSStringItem"/>
        <result property="xxChkBox_PM"             column="PRTL_MATCH_FLG"            javaType="EZDSStringItem"/>
        <result property="xxChkBox_DM"             column="DUNS_MATCH_FLG"            javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="existLocNumCnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SUM(S)
        FROM
        (
        SELECT
            COUNT(AL.GLBL_CMPY_CD) S
        FROM
            (
                SELECT
                     DAC.SELL_TO_CUST_CD AS DS_ACCT_NUM
                FROM
                     SELL_TO_CUST DAC
                WHERE
                        DAC.GLBL_CMPY_CD            = #glblCmpyCd#
                    AND DAC.EZCANCELFLAG            = '0'
                    AND DAC.DS_ACCT_ACTV_CUST_FLG   = 'Y'
            ) DACP
            ,ACCT_LOC AL
        WHERE
                AL.GLBL_CMPY_CD  = #glblCmpyCd#
            AND AL.EZCANCELFLAG  = '0'
            AND AL.DS_ACCT_NUM   = DACP.DS_ACCT_NUM
            AND AL.LOC_NUM       = #locNum#
            AND AL.EFF_FROM_DT  &lt;= #salesDate#
            AND NVL(AL.EFF_THRU_DT, #max_date#) &gt;= #salesDate#
            AND AL.RGTN_STS_CD   = #rgtnStsCd_P20#
        UNION ALL
        SELECT
            COUNT(DAP.GLBL_CMPY_CD) S
        FROM
            DS_ACCT_PROS DAP
        WHERE
                DAP.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DAP.EZCANCELFLAG                = '0'
            AND DAP.LOC_NUM                     = #locNum#
            AND DAP.EFF_FROM_DT                 &lt;= #salesDate#
            AND NVL(DAP.EFF_THRU_DT, #max_date#) &gt;= #salesDate#
            AND DAP.RGTN_STS_CD                 = #rgtnStsCd_P01#
            AND DAP.DS_ACCT_ACTV_CUST_FLG       = 'Y'
        )
    </statement>

    <statement id="getCntActiveLocNum" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SUM(S)
        FROM
            (
	        SELECT
	            COUNT(AL.GLBL_CMPY_CD) S
	        FROM
	            ACCT_LOC AL 
	        WHERE
	                AL.GLBL_CMPY_CD  = #glblCmpyCd#
	            AND AL.EZCANCELFLAG  = '0'
	           <isNotNull property="dsAcctNum">
	            AND AL.DS_ACCT_NUM   = #dsAcctNum#
	           </isNotNull>
	            AND AL.LOC_NUM       = #locNum#
	            AND AL.RGTN_STS_CD   = #rgtnStsCd_P20#
	        UNION ALL
	        SELECT
	            COUNT(DAP.GLBL_CMPY_CD) S
	        FROM
	            DS_ACCT_PROS DAP 
	        WHERE
	                DAP.GLBL_CMPY_CD  = #glblCmpyCd#
	            AND DAP.EZCANCELFLAG  = '0'
	           <isNotNull property="dsAcctNum">
	            AND DAP.DS_ACCT_NUM   = #dsAcctNum#
	           </isNotNull>
	            AND DAP.LOC_NUM       = #locNum#
	            AND DAP.RGTN_STS_CD   = #rgtnStsCd_P01#
            )
    </statement>

    <statement id="getUpdateInfo" parameterClass="Map" resultClass="Map">
        SELECT
              DACP.DS_ACCT_NUM       AS DS_ACCT_NUM
            , DACP.DS_ACCT_NM        AS DS_ACCT_NM
            , DACP.DS_ACCT_ITRL_FLG  AS DS_ACCT_ITRL_FLG
            , DACP.DS_ACCT_CLS_CD    AS DS_ACCT_CLS_CD
            , DACP.DS_ACCT_DLR_CD    AS DS_ACCT_DLR_CD
            , DACP.DS_ACCT_LEGAL_NM  AS DS_ACCT_LEGAL_NM
            , DACP.DBA_NM            AS DBA_NM
            , DACP.COA_AFFL_CD       AS COA_AFFL_CD
            , DACP.COA_CH_CD         AS COA_CH_CD
            , DACP.DS_ACCT_URL       AS DS_ACCT_URL
            , AL.EFF_FROM_DT         AS EFF_FROM_DT
            , AL.EFF_THRU_DT         AS EFF_THRU_DT
            , PLW.FIRST_LINE_ADDR    AS FIRST_LINE_ADDR
            , PLW.SCD_LINE_ADDR      AS SCD_LINE_ADDR
            , PLW.THIRD_LINE_ADDR    AS THIRD_LINE_ADDR
            , PLW.FRTH_LINE_ADDR     AS FRTH_LINE_ADDR
            , PLW.CTY_ADDR           AS CTY_ADDR
            , PLW.CTRY_CD            AS CTRY_CD
            , PLW.PROV_NM            AS PROV_NM
            , PLW.ST_CD              AS ST_CD
            , PLW.POST_CD            AS POST_CD
            , PLW.LOC_NM             AS LOC_NM
            , PLW.ADDL_LOC_NM        AS ADDL_LOC_NM
            , PLW.GLN_NUM            AS GLN_NUM
            , PLW.CNTY_PK            AS CNTY_PK
            , PLW.TEL_NUM            AS TEL_NUM
            , PLW.FAX_NUM            AS FAX_NUM
            , PLW.LINE_BIZ_TP_CD    AS LINE_BIZ_TP_CD
            , PC.PTY_LOC_PK          AS PTY_LOC_PK_PRIMARY
        FROM
            ( 
                SELECT
                      DAC.SELL_TO_CUST_CD AS DS_ACCT_NUM
                    , DAC.DS_ACCT_NM
                    , DAC.DS_ACCT_ITRL_FLG
                    , DAC.DS_ACCT_CLS_CD
                    , DAC.DS_ACCT_DLR_CD
                    , DAC.DS_ACCT_LEGAL_NM
                    , DAC.DBA_NM
                    , DAC.COA_AFFL_CD
                    , DAC.COA_CH_CD
                    , DAC.DS_ACCT_URL
                FROM
                    SELL_TO_CUST DAC
                WHERE
                    DAC.GLBL_CMPY_CD              = #glblCmpyCd#
                    AND DAC.EZCANCELFLAG          = '0'
                    AND DAC.DS_ACCT_ACTV_CUST_FLG = 'Y'
            ) DACP
            , ACCT_LOC        AL
            , PTY_LOC_WRK     PLW
            , PRIN_CUST       PC
        WHERE
            AL.GLBL_CMPY_CD         = #glblCmpyCd#
            AND AL.EZCANCELFLAG     = '0' 
            AND AL.DS_ACCT_NUM      = DACP.DS_ACCT_NUM 
            AND AL.DS_ACCT_NUM      = #dsAcctNum#
            AND AL.LOC_NUM          = #locNum#
            AND AL.EFF_FROM_DT     &lt;= #salesDate#
            AND NVL(AL.EFF_THRU_DT, #max_date#) &gt;= #salesDate#
            AND AL.RGTN_STS_CD      = #rgtnStsCd_P20#
            
            AND AL.GLBL_CMPY_CD     = PLW.GLBL_CMPY_CD
            AND PLW.EZCANCELFLAG    = '0' 
            AND AL.LOC_NUM          = PLW.LOC_NUM
            
            AND PLW.GLBL_CMPY_CD    = PC.GLBL_CMPY_CD(+)
            AND PC.EZCANCELFLAG(+)  = '0' 
            AND PLW.PTY_LOC_PK      = PC.PTY_LOC_PK(+)
         UNION ALL
         SELECT
              DAP.DS_ACCT_NUM        AS DS_ACCT_NUM
            , DAP.DS_ACCT_NM         AS DS_ACCT_NM
            , DAP.DS_ACCT_ITRL_FLG   AS DS_ACCT_ITRL_FLG
            , DAP.DS_ACCT_CLS_CD     AS DS_ACCT_CLS_CD
            , DAP.DS_ACCT_DLR_CD     AS DS_ACCT_DLR_CD
            , DAP.DS_ACCT_LEGAL_NM   AS DS_ACCT_LEGAL_NM
            , DAP.DBA_NM             AS DBA_NM
            , DAP.COA_AFFL_CD        AS COA_AFFL_CD
            , DAP.COA_CH_CD          AS COA_CH_CD
            , DAP.DS_ACCT_URL        AS DS_ACCT_URL
            , DAP.EFF_FROM_DT        AS EFF_FROM_DT
            , DAP.EFF_THRU_DT        AS EFF_THRU_DT
            , PLW.FIRST_LINE_ADDR    AS FIRST_LINE_ADDR
            , PLW.SCD_LINE_ADDR      AS SCD_LINE_ADDR
            , PLW.THIRD_LINE_ADDR    AS THIRD_LINE_ADDR
            , PLW.FRTH_LINE_ADDR     AS FRTH_LINE_ADDR
            , PLW.CTY_ADDR           AS CTY_ADDR
            , PLW.CTRY_CD            AS CTRY_CD
            , PLW.PROV_NM            AS PROV_NM
            , PLW.ST_CD              AS ST_CD
            , PLW.POST_CD            AS POST_CD
            , PLW.LOC_NM             AS LOC_NM
            , PLW.ADDL_LOC_NM        AS ADDL_LOC_NM
            , PLW.GLN_NUM            AS GLN_NUM
            , PLW.CNTY_PK            AS CNTY_PK
            , PLW.TEL_NUM            AS TEL_NUM
            , PLW.FAX_NUM            AS FAX_NUM
            , PLW.LINE_BIZ_TP_CD    AS LINE_BIZ_TP_CD
            , PC.PTY_LOC_PK          AS PTY_LOC_PK_PRIMARY
        FROM
              DS_ACCT_PROS         DAP
            , PROS_PTY_LOC_WRK     PLW
            , PRIN_CUST            PC
        WHERE
            DAP.GLBL_CMPY_CD                     = #glblCmpyCd#
            AND DAP.EZCANCELFLAG                 = '0' 
            AND DAP.DS_ACCT_NUM                  = #dsAcctNum#
            AND DAP.LOC_NUM                      = #locNum#
            AND DAP.EFF_FROM_DT                  &lt;= #salesDate#
            AND NVL(DAP.EFF_THRU_DT, #max_date#) &gt;= #salesDate#
            AND DAP.RGTN_STS_CD                  = #rgtnStsCd_P01#
            AND DAP.DS_ACCT_ACTV_CUST_FLG        = 'Y'
            
            AND DAP.GLBL_CMPY_CD                 = PLW.GLBL_CMPY_CD
            AND PLW.EZCANCELFLAG                 = '0' 
            AND DAP.LOC_NUM                      = PLW.LOC_NUM
            
            AND PLW.GLBL_CMPY_CD                 = PC.GLBL_CMPY_CD(+)
            AND PC.EZCANCELFLAG(+)               = '0' 
            AND PLW.PTY_LOC_PK                   = PC.PTY_LOC_PK(+)
         
    </statement>

    <statement id="getCntActiveLocNumThatExcCurLocNum" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SUM(S)
        FROM
           (
	        SELECT
	            COUNT(AL.GLBL_CMPY_CD) S
	        FROM
	            ACCT_LOC AL 
	        WHERE
	                AL.GLBL_CMPY_CD  = #glblCmpyCd#
	            AND AL.EZCANCELFLAG  = '0'
	            AND AL.DS_ACCT_NUM   = #dsAcctNum#
	            AND AL.LOC_NUM       &lt;&gt; #cur_locNum#
	            AND AL.RGTN_STS_CD   = #rgtnStsCd_P20#
	        UNION ALL
	        SELECT
	            COUNT(DAP.GLBL_CMPY_CD) S
	        FROM
	            DS_ACCT_PROS DAP 
	        WHERE
	                DAP.GLBL_CMPY_CD  = #glblCmpyCd#
	            AND DAP.EZCANCELFLAG  = '0'
	            AND DAP.DS_ACCT_NUM   = #dsAcctNum#
	            AND DAP.LOC_NUM       &lt;&gt; #cur_locNum#
	            AND DAP.RGTN_STS_CD   = #rgtnStsCd_P01#
	        )
    </statement>

    <statement id="getRequestedMergeTo" parameterClass="Map" resultClass="Map">
        SELECT
              DACP.DS_ACCT_NUM        AS DS_ACCT_NUM
            , AL.LOC_NUM              AS LOC_NUM
            , DXA_S.DS_XREF_ACCT_CD   AS SFDC_DS_XREF_ACCT_CD
            , DXA_O.DS_XREF_ACCT_CD   AS OASIS_DS_XREF_ACCT_CD
            , DAT.DS_ACCT_TP_DESC_TXT AS DS_ACCT_TP_DESC_TXT
            , DACP.DS_ACCT_NM         AS DS_ACCT_NM
            , PLW.FIRST_LINE_ADDR     AS FIRST_LINE_ADDR
            , PLW.SCD_LINE_ADDR       AS SCD_LINE_ADDR
            , PLW.THIRD_LINE_ADDR     AS THIRD_LINE_ADDR
            , PLW.FRTH_LINE_ADDR      AS FRTH_LINE_ADDR
            , PLW.CTY_ADDR            AS CTY_ADDR
            , PLW.ST_CD               AS ST_CD
            , PLW.POST_CD             AS POST_CD
        FROM
            ( 
                SELECT
                      DAC.GLBL_CMPY_CD
                    , DAC.SELL_TO_CUST_CD AS DS_ACCT_NUM
                    , DAC.DS_ACCT_NM
                    , DAC.DS_ACCT_TP_CD 
                FROM
                    SELL_TO_CUST DAC 
                WHERE
                    DAC.GLBL_CMPY_CD              = #glblCmpyCd#
                    AND DAC.EZCANCELFLAG          = '0' 
                    AND DAC.DS_ACCT_ACTV_CUST_FLG = 'Y' 
            ) DACP
            , ACCT_LOC     AL
            , PTY_LOC_WRK  PLW
            , DS_XREF_ACCT DXA_S
            , DS_XREF_ACCT DXA_O
            , DS_ACCT_TP   DAT 
        WHERE
            AL.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND AL.EZCANCELFLAG             = '0' 
            AND AL.DS_ACCT_NUM              = DACP.DS_ACCT_NUM 
            AND AL.LOC_NUM                  = #locNum_M#
            AND AL.EFF_FROM_DT          &lt;= #salesDate#
            AND NVL(AL.EFF_THRU_DT, #max_date#)  &gt;= #salesDate#
            AND AL.RGTN_STS_CD              = #rgtnStsCd_P20#

            AND AL.GLBL_CMPY_CD             = PLW.GLBL_CMPY_CD 
            AND PLW.EZCANCELFLAG            = '0' 
            AND PLW.LOC_NUM                 = AL.LOC_NUM 

            AND PLW.GLBL_CMPY_CD            = DXA_S.GLBL_CMPY_CD(+) 
            AND DXA_S.EZCANCELFLAG(+)       = '0' 
            AND DXA_S.DS_XREF_ACCT_TP_CD(+) = #dsXrefAcctTpCd_sfdc#
            AND PLW.LOC_NUM                 = DXA_S.LOC_NUM(+) 

            AND PLW.GLBL_CMPY_CD            = DXA_O.GLBL_CMPY_CD(+) 
            AND DXA_O.EZCANCELFLAG(+)       = '0' 
            AND DXA_O.DS_XREF_ACCT_TP_CD(+) = #dsXrefAcctTpCd_oasis#
            AND PLW.LOC_NUM                 = DXA_O.LOC_NUM(+) 

            AND DACP.GLBL_CMPY_CD           = DAT.GLBL_CMPY_CD(+) 
            AND DAT.EZCANCELFLAG(+)         = '0' 
            AND DACP.DS_ACCT_TP_CD          = DAT.DS_ACCT_TP_CD(+)
        UNION ALL
        SELECT
              DAP.DS_ACCT_NUM         AS DS_ACCT_NUM
            , DAP.LOC_NUM             AS LOC_NUM
            , DXA_S.DS_XREF_ACCT_CD   AS SFDC_DS_XREF_ACCT_CD
            , DXA_O.DS_XREF_ACCT_CD   AS OASIS_DS_XREF_ACCT_CD
            , DAT.DS_ACCT_TP_DESC_TXT AS DS_ACCT_TP_DESC_TXT
            , DAP.DS_ACCT_NM          AS DS_ACCT_NM
            , PLW.FIRST_LINE_ADDR     AS FIRST_LINE_ADDR
            , PLW.SCD_LINE_ADDR       AS SCD_LINE_ADDR
            , PLW.THIRD_LINE_ADDR     AS THIRD_LINE_ADDR
            , PLW.FRTH_LINE_ADDR      AS FRTH_LINE_ADDR
            , PLW.CTY_ADDR            AS CTY_ADDR
            , PLW.ST_CD               AS ST_CD
            , PLW.POST_CD             AS POST_CD
        FROM
              DS_ACCT_PROS      DAP 
            , PROS_PTY_LOC_WRK  PLW
            , DS_XREF_ACCT      DXA_S
            , DS_XREF_ACCT      DXA_O
            , DS_ACCT_TP        DAT 
        WHERE
            DAP.GLBL_CMPY_CD                      = #glblCmpyCd#
            AND DAP.EZCANCELFLAG                  = '0'
            AND DAP.LOC_NUM                       = #locNum_M#
            AND DAP.EFF_FROM_DT                   &lt;= #salesDate#
            AND NVL(DAP.EFF_THRU_DT, #max_date#)  &gt;= #salesDate#
            AND DAP.RGTN_STS_CD                   = #rgtnStsCd_P20#
            AND DAP.DS_ACCT_ACTV_CUST_FLG         = 'Y'

            AND DAP.GLBL_CMPY_CD                   = PLW.GLBL_CMPY_CD 
            AND PLW.EZCANCELFLAG                  = '0' 
            AND PLW.LOC_NUM                       = DAP.LOC_NUM 

            AND PLW.GLBL_CMPY_CD                  = DXA_S.GLBL_CMPY_CD(+) 
            AND DXA_S.EZCANCELFLAG(+)             = '0' 
            AND DXA_S.DS_XREF_ACCT_TP_CD(+)       = #dsXrefAcctTpCd_sfdc#
            AND PLW.LOC_NUM                       = DXA_S.LOC_NUM(+) 

            AND PLW.GLBL_CMPY_CD                  = DXA_O.GLBL_CMPY_CD(+) 
            AND DXA_O.EZCANCELFLAG(+)             = '0' 
            AND DXA_O.DS_XREF_ACCT_TP_CD(+)       = #dsXrefAcctTpCd_oasis#
            AND PLW.LOC_NUM                       = DXA_O.LOC_NUM(+) 

            AND DAP.GLBL_CMPY_CD                  = DAT.GLBL_CMPY_CD(+) 
            AND DAT.EZCANCELFLAG(+)               = '0' 
            AND DAP.DS_ACCT_TP_CD                 = DAT.DS_ACCT_TP_CD(+)
    </statement>
</sqlMap>
