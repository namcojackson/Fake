<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL1890Query">

    <statement id="getConfigNum" parameterClass="Map" resultClass="String">
        SELECT
            DCC.DS_ORD_POSN_NUM
        FROM
            DS_CPO_CONFIG DCC
        WHERE
                DCC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM     = #cpoOrdNum#
            AND DCC.DS_ORD_POSN_NUM = #dsOrdPosnNum#
            AND DCC.CONFIG_CATG_CD  = #configCatgCd#
            AND DCC.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getConfigID" parameterClass="Map" resultClass="String">
        SELECT
            DCC.SVC_CONFIG_MSTR_PK
        FROM
            DS_CPO_CONFIG DCC
        WHERE
                DCC.GLBL_CMPY_CD       = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM        = #cpoOrdNum#
            AND DCC.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
            AND DCC.CONFIG_CATG_CD     = #configCatgCd#
            AND DCC.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getModel" parameterClass="Map" resultClass="String">
        SELECT
            MN.T_MDL_NM 
        FROM
            DS_CPO_CONFIG   DCC
            , MDL_NM        MN
        WHERE
                DCC.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM    = #cpoOrdNum#
            AND DCC.CONFIG_CATG_CD = #configCatgCd#
            AND DCC.EZCANCELFLAG   = '0'
            --
            AND DCC.GLBL_CMPY_CD   = MN.T_GLBL_CMPY_CD
            AND DCC.MDL_ID         = MN.T_MDL_ID
            AND MN.T_MDL_NM        = #mdlNm#
            AND MN.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getBillToCustNm" parameterClass="Map" resultClass="String">
        SELECT
            DCC.BILL_TO_CUST_ACCT_NM
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.BILL_TO_CUST_ACCT_NM = #billToCustNm#
            AND DCC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getBillToCustCd" parameterClass="Map" resultClass="String">
        SELECT
            DCC.BILL_TO_CUST_ACCT_CD
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.BILL_TO_CUST_ACCT_CD = #billToCustCd#
            AND DCC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getBillToLocCd" parameterClass="Map" resultClass="String">
        SELECT
            DCC.BILL_TO_CUST_LOC_CD
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM         = #cpoOrdNum#
            AND DCC.BILL_TO_CUST_LOC_CD = #billToLocCd#
            AND DCC.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getShipToCustNm" parameterClass="Map" resultClass="String">
        SELECT
            DCC.SHIP_TO_CUST_ACCT_NM
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.SHIP_TO_CUST_ACCT_NM = #shipToCustNm#
            AND DCC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getShipToCustCd" parameterClass="Map" resultClass="String">
        SELECT
            DCC.SHIP_TO_CUST_ACCT_CD
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.SHIP_TO_CUST_ACCT_CD = #shipToCustCd#
            AND DCC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getShipToLocCd" parameterClass="Map" resultClass="String">
        SELECT
            DCC.SHIP_TO_CUST_LOC_CD
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM         = #cpoOrdNum#
            AND DCC.SHIP_TO_CUST_LOC_CD = #shipToLocCd#
            AND DCC.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getSoldToCustNm" parameterClass="Map" resultClass="String">
        SELECT
            DCC.SOLD_TO_CUST_ACCT_NM
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.SOLD_TO_CUST_ACCT_NM = #soldToCustNm#
            AND DCC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getSoldToCustCd" parameterClass="Map" resultClass="String">
        SELECT
            DCC.SELL_TO_CUST_CD
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM     = #cpoOrdNum#
            AND DCC.SELL_TO_CUST_CD = #sellToCustCd#
            AND DCC.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getSoldToLocCd" parameterClass="Map" resultClass="String">
        SELECT
            DCC.SOLD_TO_CUST_LOC_CD
        FROM
            DS_CPO_CONFIG_V DCC
        WHERE
                DCC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM         = #cpoOrdNum#
            AND DCC.SOLD_TO_CUST_LOC_CD = #soldToLocCd#
            AND DCC.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getLineNum" parameterClass="Map" resultClass="String">
        SELECT
            DCV.DPLY_LINE_NUM
        FROM
            CPO_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM      = #cpoOrdNum#
            AND DCV.DPLY_LINE_NUM    = #dplyLineNum#
            AND DCV.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getLineSts" parameterClass="Map" resultClass="String">
        SELECT
            DOS.ORD_LINE_STS_NM
        FROM
            DS_ORD_STS_V DOS
        WHERE
                DOS.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DOS.CPO_ORD_NUM      = #cpoOrdNum#
            AND DOS.ORD_LINE_STS_NM  = #ordLineDplySts#
            AND DOS.ORD_LINE_STS_NM  &lt;&gt; #cancelled#
            AND DOS.ORD_LINE_STS_NM  &lt;&gt; #closed#
            AND DOS.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getOrdItem" parameterClass="Map" resultClass="String">
        SELECT
            DECODE(DCV.SBST_MDSE_CD, null, DCV.MDSE_CD, DCV.ORIG_MDSE_CD) MDSE_CD
        FROM
            CPO_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD  = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM   = #cpoOrdNum#
            AND DECODE(DCV.SBST_MDSE_CD, NULL, DCV.MDSE_CD, DCV.ORIG_MDSE_CD) = #mdseCd#
            AND DCV.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getWh" parameterClass="Map" resultClass="String">
        SELECT
            DCV.RTL_WH_NM
        FROM
            CPO_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD  = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM   = #cpoOrdNum#
            AND DCV.RTL_WH_NM     = #whNm#
            AND DCV.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getSwh" parameterClass="Map" resultClass="String">
        SELECT
            DCV.RTL_SWH_NM
        FROM
            CPO_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM  = #cpoOrdNum#
            AND DCV.RTL_SWH_NM   = #swhNm#
            AND DCV.EZCANCELFLAG = '0'
    </statement>

    <statement id="getSrcType" parameterClass="Map" resultClass="String">
        SELECT
            OLS.ORD_LINE_SRC_NM
        FROM
             CPO_DTL_V DCV
            ,ORD_LINE_SRC OLS
        WHERE
                DCV.GLBL_CMPY_CD        = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM         = #cpoOrdNum#
            AND DCV.EZCANCELFLAG        = '0'
            AND OLS.GLBL_CMPY_CD        = DCV.GLBL_CMPY_CD
            AND OLS.ORD_LINE_SRC_CD     = DCV.ORD_LINE_SRC_CD
            AND OLS.ORD_LINE_SRC_NM     = #ordLineSrcNm#
            AND OLS.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getLineSrcRef" parameterClass="Map" resultClass="String">
        SELECT
            DCV.LINE_SRC_REF_NUM
        FROM
            CPO_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM      = #cpoOrdNum#
            AND DCV.LINE_SRC_REF_NUM = #lineSrcRefNum#
            AND DCV.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getSbstItem" parameterClass="Map" resultClass="String">
        SELECT
            DCV.SBST_MDSE_CD
        FROM
            CPO_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD  = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM   = #cpoOrdNum#
            AND DCV.SBST_MDSE_CD  = #sbstItem#
            AND DCV.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getSerNum" parameterClass="Map" resultClass="String">
        SELECT
            DCV.SER_NUM
        FROM
            CPO_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM  = #cpoOrdNum#
            AND DCV.SER_NUM      = #serNum#
            AND DCV.EZCANCELFLAG = '0'
    </statement>

    <statement id="getRMALineNum" parameterClass="Map" resultClass="String">
        SELECT
            DCV.DPLY_LINE_NUM
        FROM
            DS_CPO_RTRN_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCV.DPLY_LINE_NUM        = #dplyLineNum#
            AND DCV.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getRMALineSts" parameterClass="Map" resultClass="String">
        SELECT
            DOS.ORD_LINE_STS_NM
        FROM
            DS_ORD_STS_V DOS
        WHERE
                DOS.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DOS.CPO_ORD_NUM      = #cpoOrdNum#
            AND DOS.ORD_LINE_STS_NM  = #rtrnLineDplySts#
            AND DOS.ORD_LINE_STS_NM  &lt;&gt; #cancelled#
            AND DOS.ORD_LINE_STS_NM  &lt;&gt; #closed#
            AND DOS.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getRMAOrdItem" parameterClass="Map" resultClass="String">
        SELECT
            DCV.MDSE_CD
        FROM
            DS_CPO_RTRN_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM  = #cpoOrdNum#
            AND DCV.MDSE_CD      = #mdseCd#
            AND DCV.EZCANCELFLAG = '0'
    </statement>

    <statement id="getRMARtrnRsn" parameterClass="Map" resultClass="String">
        SELECT
            RR.RTRN_RSN_DESC_TXT
        FROM
            DS_CPO_RTRN_DTL_V DCV
           ,RTRN_RSN RR
        WHERE
                DCV.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM  = #cpoOrdNum#
            AND DCV.EZCANCELFLAG = '0'
            AND DCV.GLBL_CMPY_CD = RR.GLBL_CMPY_CD
            AND DCV.RTRN_RSN_CD  = RR.RTRN_RSN_CD
            AND RR.RTRN_RSN_DESC_TXT  = #rtrnRsnDescTxt#
            AND RR.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getRMAWh" parameterClass="Map" resultClass="String">
        SELECT
            DCV.RTL_WH_NM
        FROM
            DS_CPO_RTRN_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM  = #cpoOrdNum#
            AND DCV.RTL_WH_NM    = #whNm#
            AND DCV.EZCANCELFLAG = '0'
    </statement>

    <statement id="getRMASwh" parameterClass="Map" resultClass="String">
        SELECT
            DCV.RTL_SWH_NM
        FROM
            DS_CPO_RTRN_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM  = #cpoOrdNum#
            AND DCV.RTL_SWH_NM   = #swhNm#
            AND DCV.EZCANCELFLAG = '0'
    </statement>

    <statement id="getRMALineSrcRef" parameterClass="Map" resultClass="String">
        SELECT
            DCV.LINE_SRC_REF_NUM
        FROM
            DS_CPO_RTRN_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM      = #cpoOrdNum#
            AND DCV.LINE_SRC_REF_NUM = #lineSrcRefNum#
            AND DCV.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getRMASerNum" parameterClass="Map" resultClass="String">
        SELECT
            DCV.SER_NUM
        FROM
            DS_CPO_RTRN_DTL_V DCV
        WHERE
                DCV.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCV.CPO_ORD_NUM  = #cpoOrdNum#
            AND DCV.SER_NUM      = #serNum#
            AND DCV.EZCANCELFLAG = '0'
    </statement>

</sqlMap>
