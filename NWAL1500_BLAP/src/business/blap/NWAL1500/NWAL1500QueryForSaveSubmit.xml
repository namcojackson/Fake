<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL1500QueryForSaveSubmit">

    <typeAlias alias="DS_CPO_RTRN_DTLTMsg"           type="business.db.DS_CPO_RTRN_DTLTMsg"/>
    <statement id="checkCustCode" parameterClass="Map" resultClass="Map">
        SELECT
            A.$tblNm$_CD
        FROM
            $tblNm$ A
        WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.$tblNm$_CD    = #custCd#
            AND A.EZCANCELFLAG = '0'
    </statement>
    <statement id="checkCodeTableDescText" parameterClass="Map" resultClass="Map">
        SELECT
            CT.$tblNm$_CD
        FROM
            $tblNm$ CT
        WHERE
                CT.GLBL_CMPY_CD         = #glblCmpyCd#
            AND UPPER(CT.$tblNm$_DESC_TXT)     = UPPER(#descTxt#)
            AND CT.EZCANCELFLAG         = '0'
    </statement>
    <statement id="checkPriceCatgNm" parameterClass="Map" resultClass="Map">
        SELECT
            PC.PRC_CATG_CD
        FROM
            PRC_CATG PC
        WHERE
                PC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND UPPER(PC.PRC_CATG_NM)   = UPPER(#prcCatgNm#)
            AND PC.EZCANCELFLAG         = '0'
    </statement>
    <statement id="checkAssociationProgram" parameterClass="Map" resultClass="Map">
        SELECT
            PC.PRC_CONTR_NUM
        FROM
            PRC_CONTR PC
        WHERE
                PC.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PC.PRC_CONTR_NUM    = #prcContrNum#
            AND PC.EZCANCELFLAG     = '0'
    </statement>
    <statement id="checkModelText" parameterClass="Map" resultClass="Map">
        SELECT
            MN.T_MDL_ID
        FROM
            MDL_NM MN
        WHERE
                MN.T_GLBL_CMPY_CD = #glblCmpyCd#
            AND MN.T_MDL_NM = #mdlDescTxt#
            AND MN.EZCANCELFLAG = '0'
    </statement>
    <statement id="checkMdseCdFromAllMdseV" parameterClass="Map" resultClass="Map">
<!-- QC#12240-2 Del Start
        SELECT
            M.MDSE_CD
        FROM
            ALL_MDSE_V M
        WHERE
                M.GLBL_CMPY_CD = #glblCmpyCd#
            AND M.MDSE_CD      = #mdseCd#
            AND M.EZCANCELFLAG = '0'
     QC#12240-2 Del End -->
<!-- QC#12240-2 Add Start -->
        SELECT
            ALL_MDSE.MDSE_CD
        FROM
            (SELECT
                 M.GLBL_CMPY_CD
                ,M.MDSE_CD
                ,M.EZCANCELFLAG
             FROM
                 MDSE M
             WHERE
                 M.GLBL_CMPY_CD     = #glblCmpyCd#
                 AND M.MDSE_CD      = #mdseCd#
                 AND M.EZCANCELFLAG = '0'
             UNION ALL
             SELECT
                 M.GLBL_CMPY_CD
                ,OTM.ORD_TAKE_MDSE_CD AS MDSE_CD
                ,M.EZCANCELFLAG
             FROM
                 ORD_TAKE_MDSE OTM
                ,MDSE M
             WHERE
                 OTM.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND OTM.ORD_TAKE_MDSE_CD = #mdseCd#
                 AND OTM.EZCANCELFLAG     = '0'
                 AND OTM.GLBL_CMPY_CD     = M.GLBL_CMPY_CD
                 AND OTM.MDSE_CD          = M.MDSE_CD
                 AND M.EZCANCELFLAG       = '0'
            ) ALL_MDSE
        WHERE
            ALL_MDSE.GLBL_CMPY_CD     = #glblCmpyCd#
            AND ALL_MDSE.EZCANCELFLAG = '0'
<!-- QC#12240-2 Add End -->
    </statement>
    <!-- statement id="checkMachSerNum" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.SVC_MACH_MSTR_PK
        FROM
            SVC_MACH_MSTR SMM
        WHERE
                SMM.GLBL_CMPY_CD = #glblCmpyCd#
            AND SMM.SER_NUM      = #serNum#
            AND SMM.MDSE_CD      LIKE #mdseCd# || '%'
            AND SMM.EZCANCELFLAG = '0'
    </statement -->
    <!-- statement id="checkBillToCustAndBillToAccnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            BILL_TO_CUST BC
            ,DS_BILL_TO_CUST DBC
        WHERE
                BC.GLBL_CMPY_CD = #glblCmpyCd#
            AND BC.BILL_TO_CUST_CD = #billToCustCd#
            AND BC.RGTN_STS_CD = #rgtnStsCdReadyForOrdTake#
            AND BC.EZCANCELFLAG = '0'
            AND BC.GLBL_CMPY_CD = DBC.GLBL_CMPY_CD
            AND BC.BILL_TO_CUST_PK = DBC.BILL_TO_CUST_PK
            AND DBC.SELL_TO_CUST_CD = #billToCustAcctCd#
            AND DBC.EZCANCELFLAG = '0'
    </statement -->
    <!-- statement id="checkShipToCustAndAhipToAccnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            SHIP_TO_CUST SH
        WHERE
                SH.GLBL_CMPY_CD = #glblCmpyCd#
            AND SH.SHIP_TO_CUST_CD = #shipToCustCd#
            AND SH.SELL_TO_CUST_CD = #shipToCustAcctCd#
            AND SH.RGTN_STS_CD = #rgtnStsCdReadyForOrdTake#
            AND SH.EZCANCELFLAG = '0'
    </statement -->
    <!-- statement id="checkSalesRepRelation" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            TOC T
            ,BIZ_AREA_ORG BAO
        WHERE
                T.GLBL_CMPY_CD = #glblCmpyCd#
            AND T.TOC_CD = #slsRepTocCd#
            AND T.EZCANCELFLAG = '0'
            AND T.GLBL_CMPY_CD = BAO.GLBL_CMPY_CD
            AND T.FIRST_ORG_CD = BAO.BIZ_ARE_ORG_CD 
            AND BAO.SLS_FLG = 'Y'
            AND BAO.ORG_STRU_TP_CD = #orgStruTpCd#
            AND BAO.EZCANCELFLAG = '0'
    </statement -->
    <!-- statement id="checkPrcListRelation" parameterClass="Map" resultClass="String">
        SELECT
            DOT.DEF_PRC_CATG_CD
        FROM
            DS_ORD_TP_PROC_DFN DOT
        WHERE
            DOT.GLBL_CMPY_CD = #glblCmpyCd#
            AND DOT.DS_ORD_TP_CD = #dsOrdTpCd#
            AND DOT.ACTV_FLG = 'Y'
            AND DOT.EFF_FROM_DT <![CDATA[<=]]> #slsDate#
            AND (DOT.EFF_THRU_DT <![CDATA[>=]]> #slsDate#
             OR DOT.EFF_THRU_DT IS NULL)
    </statement -->
    <!-- statement id="checkCarrShpgSvcLvlAndShpgSvcLvl" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            SHPG_SVC_LVL_CARR_RELN SSLCR
        WHERE
                SSLCR.GLBL_CMPY_CD = #glblCmpyCd#
            AND SSLCR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
            AND SSLCR.CARR_SVC_LVL_CD = #carrSvcLvlCd#
            AND SSLCR.EZCANCELFLAG = '0'
    </statement -->
    <!-- statement id="checkFrtCondRelation" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            FRT_COND_SVC_LVL_RELN FCSLR
        WHERE
                FCSLR.GLBL_CMPY_CD = #glblCmpyCd#
            AND FCSLR.LINE_BIZ_TP_CD = #lineBizTpCd#
            AND FCSLR.FRT_COND_CD = #frtCondCd#
            AND FCSLR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
            AND FCSLR.CARR_SVC_LVL_CD = #carrSvcLvlCd#
            AND FCSLR.EZCANCELFLAG = '0'
    </statement -->
    <!-- statement id="checkCSMPNum" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            CSMP_CONTR CC
        WHERE
                CC.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="csmpNum">
                AND CC.CSMP_NUM = #csmpNum#
            </isNotNull>
            <isNotNull property="dlrRefNum">
                AND CC.DLR_REF_NUM = #dlrRefNum#
            </isNotNull>
            AND CC.DS_ACCT_NUM = #soldToAcctNum#
            AND CC.EZCANCELFLAG = '0'
    </statement -->
    <!-- statement id="checkCustMdseAndMdse" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            CUST_MDSE_XREF CMX
        WHERE
            CMX.GLBL_CMPY_CD = #glblCmpyCd#
            AND CMX.MDSE_CD = #mdseCd#
            AND CMX.CUST_MDSE_CD = #custMdseCd#
            AND CMX.DS_ACCT_NUM = #sellToCustCd#
            AND CMX.CUST_MDSE_XREF_ENBL_FLG = 'Y'
            AND CMX.EZCANCELFLAG = '0'
    </statement -->
    <statement id="getCcyCdByPriceCatgNm" parameterClass="Map" resultClass="Map">
        SELECT
            PC.PRC_CATG_CD
            ,PC.CCY_CD
        FROM
            PRC_CATG PC
        WHERE
                PC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND UPPER(PC.PRC_CATG_NM)   = UPPER(#prcCatgNm#)
            AND PC.EZCANCELFLAG         = '0'
    </statement>
    <!-- statement id="checkRtlWhWithName" parameterClass="Map" resultClass="Map">
        SELECT
            RTL_WH_CD
            ,RTL_WH_NM
        FROM
            RTL_WH
        WHERE
            GLBL_CMPY_CD = #glblCmpyCd#
            AND UPPER(RTL_WH_NM) = UPPER(#rtlWhNm#)
            AND EZCANCELFLAG = '0'
    </statement -->
    <statement id="checkRtlSubWhWithName" parameterClass="Map" resultClass="Map">
        SELECT
            RTL_WH_CD
            ,RTL_SWH_CD
            ,RTL_SWH_NM
        FROM
            DS_INVTY_LOC_V
        WHERE
            GLBL_CMPY_CD = #glblCmpyCd#
            AND UPPER(RTL_WH_CD) = UPPER(#rtlWhCd#)
            AND UPPER(RTL_SWH_NM) = UPPER(#rtlSWhNm#)
            AND EZCANCELFLAG = '0'
    </statement>
    <statement id="checkFutureRddOrCriticEss" parameterClass="Map" resultClass="Map">
        SELECT
            ORD_CATG_CTX_TP_CD
        FROM
            ORD_CATG_BIZ_CTX
        WHERE
            GLBL_CMPY_CD = #glblCmpyCd#
            AND (
                    (
                        DS_ORD_CATG_CD = #dsOrdCatgCd#
                        AND DS_ORD_TP_CD = #dsOrdTpCd#
                    )
                    OR
                    (
                        DS_ORD_CATG_CD = #dsOrdCatgCd#
                        AND DS_ORD_TP_CD IS NULL
                    )
            <iterate property="ordCatgCtxTpCdList" var="ordCatgCtxTpCd[]" open=" AND ORD_CATG_CTX_TP_CD IN (" close=")" conjunction=",">
                #ordCatgCtxTpCd[]#
            </iterate>
            )
            AND EZCANCELFLAG = '0'
    </statement>
    <statement id="getDsConfigPkForAlloc" parameterClass="Map" resultClass="Map">
        SELECT
            DCC.DS_CPO_CONFIG_PK
            ,DCC.BILL_TO_CUST_LOC_CD
        FROM
            DS_CPO_CONFIG DCC
        WHERE
            DCC.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM = #cpoOrdNum#
            AND DCC.CONFIG_CATG_CD = #configCatgOutbound#
            AND DCC.EZCANCELFLAG = '0'
        ORDER BY
            DCC.DS_CPO_CONFIG_PK
    </statement>
    <statement id="getLineAllocInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DCD.CPO_ORD_NUM
            ,DCD.CPO_DTL_LINE_NUM
            ,DCD.CPO_DTL_LINE_SUB_NUM
            ,DCD.MDSE_CD
            ,DCD.CPO_ORD_SUBMT_TS
            ,DCD.RDD_DT
            ,DCD.RSD_DT
            ,DCD.EXPD_SHIP_DT
            ,DCD.SLS_REP_OR_SLS_TEAM_TOC_CD
            ,DCD.SHIP_TO_CUST_CD
            ,DCD.SHIP_TO_ST_CD
            ,DCD.SHIP_TO_POST_CD
            ,DCD.INVTY_LOC_CD
            ,DCD.STK_STS_CD
            ,DCD.FRT_CHRG_TO_CD
            ,DCD.FRT_CHRG_METH_CD
            ,DCD.SHPG_SVC_LVL_CD
            ,DCD.SHIP_CPLT_CD
            ,DCD.SET_ITEM_SHIP_CPLT_FLG
            ,DCD.UOM_CPLT_FLG
            ,DCD.CUST_UOM_CD
            ,DCD.ORD_QTY
            ,DCD.SER_NUM
            <!-- 2016/06/01 S21_NA#9277 Add Start -->
            ,DCD.SVC_MACH_MSTR_PK
            <!-- 2016/06/01 S21_NA#9277 Add End -->
            ,M.DAYS_PRI_ALLOC_NUM
            ,C.SELL_TO_CUST_CD
            ,BOIT.BACK_ORD_IMPCT_TP_CD
        FROM
            CPO C
            ,CPO_DTL DCD
<!-- 2016/7/29 UPD -->
            <!-- ,ALL_MDSE_V M -->
            ,(
                SELECT
                    MDSE_V1.GLBL_CMPY_CD,
                    MDSE_V1.MDSE_CD,
                    MDSE_V1.ORD_TAKE_MDSE_CD,
                    MDSE_V1.INVTY_HARD_ALLOC_TP_CD,
                    MDSE_V1.INVTY_CTRL_FLG,
                    MDSE_V1.DAYS_PRI_ALLOC_NUM,
                    MDSE_V1.BACK_ORD_IMPCT_TP_CD
                FROM
                    (
                        SELECT
                            M.GLBL_CMPY_CD,
                            M.MDSE_CD,
                            M.MDSE_CD AS ORD_TAKE_MDSE_CD,
                            M.INVTY_HARD_ALLOC_TP_CD,
                            M.INVTY_CTRL_FLG,
                            M.DAYS_PRI_ALLOC_NUM,
                            M.BACK_ORD_IMPCT_TP_CD
                        FROM
                             MDSE M
                        WHERE
                            m.EZCANCELFLAG = '0'
                        UNION ALL
                        SELECT
                            M2.GLBL_CMPY_CD,
                            M2.MDSE_CD,
                            OTM.ORD_TAKE_MDSE_CD,
                            M2.INVTY_HARD_ALLOC_TP_CD,
                            M2.INVTY_CTRL_FLG,
                            M2.DAYS_PRI_ALLOC_NUM,
                            M2.BACK_ORD_IMPCT_TP_CD
                        FROM
                             MDSE M2
                            ,ORD_TAKE_MDSE OTM
                        WHERE
                            M2.EZCANCELFLAG = '0'
                        AND OTM.EZCANCELFLAG = '0'
                        AND M2.MDSE_CD = OTM.MDSE_CD
                        AND M2.GLBL_CMPY_CD = OTM.GLBL_CMPY_CD
                     ) MDSE_V1
            ) M
<!-- 2016/7/29 UPD -->
            ,BACK_ORD_IMPCT_TP BOIT
        WHERE
                DCD.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCD.CPO_ORD_NUM = #cpoOrdNum#
            AND DCD.DS_CPO_CONFIG_PK = #dsCpoConfigPk#
            AND DCD.EZCANCELFLAG = '0'
            AND DCD.ORD_LINE_STS_CD <![CDATA[<>]]> #ordLineStsCancelled#

            AND DCD.GLBL_CMPY_CD = M.GLBL_CMPY_CD
<!-- 2016/7/29 UPD -->
            <!-- AND CD.MDSE_CD = M.MDSE_CD -->
            AND DCD.MDSE_CD = M.ORD_TAKE_MDSE_CD
<!-- 2016/7/29 UPD -->
            AND M.INVTY_HARD_ALLOC_TP_CD = #allocTpAuto#
            AND M.INVTY_CTRL_FLG = 'Y'

<!-- 2016/7/29 UPD -->
            <!-- AND M.GLBL_CMPY_CD = BOIT.GLBL_CMPY_CD(+) -->
            <!-- AND M.BACK_ORD_IMPCT_TP_CD = BOIT.BACK_ORD_IMPCT_TP_CD(+) -->
            AND M.GLBL_CMPY_CD = BOIT.GLBL_CMPY_CD(+)
            AND M.BACK_ORD_IMPCT_TP_CD = BOIT.BACK_ORD_IMPCT_TP_CD(+)
<!-- 2016/7/29 UPD -->
            AND BOIT.EZCANCELFLAG(+) = '0'

            AND DCD.GLBL_CMPY_CD = C.GLBL_CMPY_CD
            AND DCD.CPO_ORD_NUM = C.CPO_ORD_NUM
            AND C.EZCANCELFLAG = '0'

<!-- 2016/01/25 S21_NA#3516 Add Start -->
           <isNotNull property="whLst">
            AND DCD.INVTY_LOC_CD NOT IN
                 <iterate property="whLst" var="whLst[]" open="(" close=")" conjunction=",">
                    #whLst[]#
                 </iterate>
           </isNotNull>
<!-- 2016/01/25 S21_NA#3516 Add End -->
<!-- 2016/09/07 S21_NA#8196 ADD START -->
            AND EXISTS 
                       (SELECT 1 
                        FROM   SHPG_PLN SP
                        WHERE  SP.GLBL_CMPY_CD     = DCD.GLBL_CMPY_CD
                        AND    SP.TRX_HDR_NUM      = DCD.CPO_ORD_NUM
                        AND    SP.TRX_LINE_NUM     = DCD.CPO_DTL_LINE_NUM
                        AND    SP.TRX_LINE_SUB_NUM = DCD.CPO_DTL_LINE_SUB_NUM
                        AND    SP.SHPG_STS_CD      = #shpgPlnStsCd#
                        AND    SP.EZCANCELFLAG = '0'
                        )
<!-- 2016/09/07 S21_NA#8196 ADD END -->
        ORDER BY
            BOIT.BACK_ORD_IMPCT_TP_PRTY_NUM NULLS LAST
            ,DCD.CPO_ORD_NUM ASC
            ,DCD.CPO_DTL_LINE_NUM ASC
            ,DCD.CPO_DTL_LINE_SUB_NUM ASC
    </statement>

    <statement id="getSvcMachMaintFlg" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.SVC_MACH_MAINT_AVAL_FLG
            ,SMM.SVC_MACH_MSTR_PK
        FROM
            SVC_MACH_MSTR SMM
        WHERE
            SMM.GLBL_CMPY_CD = #glblCmpyCd#
            <!-- 2016/06/01 S21_NA#9277 Mod Start -->
            <isNotNull property="serNum">
            AND SMM.SER_NUM = #serNum#
            </isNotNull>
            <isNull property="serNum">
                <isNotNull property="svcMachMstrPk">
                AND SMM.SVC_MACH_MSTR_PK = #svcMachMstrPk#
                </isNotNull>
            </isNull>
            <!-- 2016/06/01 S21_NA#9277 Mod End -->
            <!-- AND SMM.MDSE_CD = #mdseCd# -->
            AND SMM.EZCANCELFLAG = '0'
    </statement>
    <statement id="getBizProcLogPK" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            BPL.BIZ_PROC_LOG_PK
        FROM
            BIZ_PROC_LOG BPL
        WHERE
            BPL.EZCANCELFLAG = '0'
            AND BPL.SUB_SYS_ID = #subSysID#
            AND BPL.PROC_ID = #procId#
            AND BPL.EVENT_ID = #eventId#
            AND BPL.DOC_TP_CD = #docTpCd#
            AND BPL.DOC_ID IS NULL
            AND BPL.PRNT_DOC_ID = #prntDocId#
            AND BPL.EZUPUSERID = #ezUpUsrId#
            AND BPL.EZUPTIMEZONE = #ezUpTimeZone#
            AND BPL.EZUPTIME &gt;= #ezUpTime# 
    </statement>
    <statement id="getRtlWh" parameterClass="Map" resultClass="Map">
        SELECT 
             DILV.RTL_WH_CD
            ,DILV.RTL_SWH_CD 
        FROM 
            DS_INVTY_LOC_V DILV 
        WHERE 
                DILV.EZCANCELFLAG   = '0' 
            AND DILV.GLBL_CMPY_CD   = #glblCmpyCd# 
            AND UPPER(DILV.RTL_WH_NM)    = UPPER(#rtlWhNm#) 
            <isNotNull property="rtlSwhNm">
            AND DILV.RTL_SWH_NM          = #rtlSwhNm#
            </isNotNull>
            <isNotNull property="rgtnStsCd">
            AND DILV.RGTN_STS_CD         = #rgtnStsCd#
            </isNotNull>
            <isNotNull property="slsDt">
            AND DILV.EFF_FROM_DT  <![CDATA[<=]]> #slsDt#
            AND NVL(DILV.EFF_THRU_DT, '99991231') <![CDATA[>=]]> #slsDt#
            </isNotNull>
    </statement>
    <statement id="checkSalesRep" parameterClass="Map" resultClass="Map">
        SELECT
            T.TOC_CD
           ,T.TOC_NM 
           ,CB.COA_BR_CD         AS COA_BR_CD
           ,CB.COA_BR_DESC_TXT   AS COA_BR_DESC_TXT
           ,CE.COA_EXTN_CD       AS COA_EXTN_CD
           ,CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT
           ,(CASE
                  WHEN CB.COA_BR_CD IS NOT NULL
                  THEN CB.COA_BR_CD || ':' || CB.COA_BR_DESC_TXT
             END) AS COA_BR_ITEM
           ,(CASE
                  WHEN CE.COA_EXTN_CD IS NOT NULL
                  THEN CE.COA_EXTN_CD || ':' || CE.COA_EXTN_DESC_TXT
             END) AS COA_EXTN_ITEM
        FROM
            TOC T
           ,ORG_FUNC_ROLE_TP OFRT
           ,BIZ_AREA_ORG BA 
           ,COA_BR   CB
           ,COA_EXTN CE
        WHERE
                T.GLBL_CMPY_CD        = #glblCmpyCd#
            AND T.TOC_CD              = #slsRepCd#
            AND T.EZCANCELFLAG        = '0'
            AND T.GLBL_CMPY_CD        = OFRT.GLBL_CMPY_CD
            AND T.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD
            AND OFRT.SLS_REP_FLG      = #flgOnY#
            AND OFRT.EZCANCELFLAG     = '0'
            AND OFRT.GLBL_CMPY_CD     = BA.GLBL_CMPY_CD
            AND OFRT.FIRST_ORG_CD     = BA.BIZ_AREA_ORG_CD
            AND BA.SLS_FLG            = #flgOnY#
            AND BA.ORG_STRU_TP_CD     = #orgStruTpCd#
            AND BA.EZCANCELFLAG       = '0'

            AND T.GLBL_CMPY_CD        = CB.GLBL_CMPY_CD (+)
            AND T.COA_BR_CD           = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+)   = '0'

            AND T.GLBL_CMPY_CD        = CE.GLBL_CMPY_CD (+)
            AND T.COA_EXTN_CD         = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+)   = '0'
    </statement>

    <!-- 2017/05/16 S21_NA#Review structure Lv.2 (Delete Logif For Copy) Del Start -->
    <!-- statement id="getCpoDelyInfoByCpoOrdNum" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              DCDI.GLBL_CMPY_CD                              Global Company Code which is used inside Canon -->
<!--             ,DCDI.DS_CPO_DELY_INFO_PK                       CPO Install Information PK -->
<!--             ,DCDI.CPO_ORD_NUM                               CPO Order Number,Data Examples -->
<!--             ,DCDI.DS_CPO_CONFIG_PK                          DS CPO Config PK -->
<!--             ,DCC.CONFIG_CATG_CD                             Configuration Type Code -->
<!--             ,DCDI.CPO_LINE_NUM                              CPO Detail Line Number,Data Examples -->
<!--             ,DCDI.CPO_LINE_SUB_NUM                          CPO Detail Line Sub Number,Data Examples -->
<!--             ,DCC.DS_ORD_POSN_NUM                            Order Position Number -->
<!--             ,DCDI.DS_DELY_TP_CD                             Direct Sales Delivery Type Code -->
<!--             ,DCDI.RDD_DT                                    Delivery Date -->
<!--             ,DCDI.OPS_FROM_HOUR_MN                          Hours of Operation From -->
<!--             ,DCDI.OPS_TO_HOUR_MN                            Hours of Operation To -->
<!--             ,DCDI.LOAD_DOCK_AVAL_FLG                        Loading Dock Available Flag -->
<!--             ,DCDI.STAIR_CRAW_REQ_FLG                        Stair Crawler Required Flag -->
<!--             ,DCDI.STAIR_CRAW_NUM                            Number of Stair Crawler -->
<!--             ,DCDI.ELEV_AVAL_FLG                             Elevator Available Flag -->
<!--             ,DCDI.DELY_ADDL_CMNT_TXT                        Delivery Instructions -->
<!--         FROM -->
<!--             DS_CPO_DELY_INFO     DCDI         Direct Sales CPO Delivery Information -->
<!--             ,DS_CPO_CONFIG        DCC         Direct Sales CPO Configuration Information -->
<!--         WHERE -->
<!--             DCDI.EZCANCELFLAG       = '0' -->
<!--             AND DCDI.GLBL_CMPY_CD   = #glblCmpyCd# -->
<!--             AND DCDI.CPO_ORD_NUM    = #cpoOrdNum# -->
<!--             AND DCDI.EZCANCELFLAG    = DCC.EZCANCELFLAG(+) -->
<!--             AND DCDI.GLBL_CMPY_CD    = DCC.GLBL_CMPY_CD(+) -->
<!--             AND DCDI.DS_CPO_CONFIG_PK = DCC.DS_CPO_CONFIG_PK(+) -->
    <!-- /statement -->

    <!-- statement id="getCpoIstlInfoByCpoOrdNum" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              DCII.DS_CPO_CONFIG_PK                          DS CPO Config PK -->
<!--             ,DCII.CPO_ORD_NUM                               CPO Order Number,Data Examples -->
<!--             ,DCC.CONFIG_CATG_CD                             Configuration Type Code -->
<!--             ,DCC.DS_ORD_POSN_NUM                            Order Position Number -->
<!--             ,DCII.ISTL_DIV_CD                               Install Division Code -->
<!--             ,DCII.ISTL_TECH_CD                              Install Technician Code -->
<!--             ,DCII.RQST_ISTL_DT                              Request Install Date -->
<!--             ,DCII.RQST_ISTL_TM                              Request Install Time -->
<!--             ,DCII.ISTL_ADDL_CMNT_TXT                        Install Instructions Text -->
<!--             ,DCII.SVC_ISTL_RULE_NUM                         Service Installation Rule Number -->
<!--         FROM -->
<!--             DS_CPO_ISTL_INFO     DCII        Direct Sales CPO Install Information -->
<!--             ,DS_CPO_CONFIG        DCC         Direct Sales CPO Configuration Information -->
<!--         WHERE -->
<!--             DCII.EZCANCELFLAG       = '0' -->
<!--             AND DCII.GLBL_CMPY_CD   = #glblCmpyCd# -->
<!--             AND DCII.CPO_ORD_NUM    = #cpoOrdNum# -->
<!--             AND DCII.EZCANCELFLAG    = DCC.EZCANCELFLAG(+) -->
<!--             AND DCII.GLBL_CMPY_CD    = DCC.GLBL_CMPY_CD(+) -->
<!--             AND DCII.DS_CPO_CONFIG_PK = DCC.DS_CPO_CONFIG_PK(+) -->
    <!-- /statement -->

    <!-- statement id="getCpoSiteSurveyByCpoOrdNum" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              DSS.CPO_ORD_NUM                               CPO Order Number -->
<!--             ,DCC.CONFIG_CATG_CD                            Configuration Type Code -->
<!--             ,DCC.DS_ORD_POSN_NUM                           Order Position Number -->
<!--             ,DSS.DS_CPO_CONFIG_PK                          DS CPO Config PK -->
<!--             ,DSS.CMPY_INFO_APT_BLDG_NM                     Company Information Apartment Or Building Name -->
<!--             ,DSS.CMPY_INFO_FL_NM                           Company Information Floor Name -->
<!--             ,DSS.CMPY_INFO_DEPT_NM                         Company Information Department Name -->
<!--             ,DSS.CMPY_INFO_CTAC_NM                         Company Information Contact Name -->
<!--             ,DSS.CMPY_INFO_TEL_NUM                         Company Information Phone -->
<!--             ,DSS.OTSD_STEP_NUM                             Outside Step Number -->
<!--             ,DSS.INSD_STEP_NUM                             Inside Step Number -->
<!--             ,DSS.STAIR_CRAW_REQ_FLG                        Stair Crawler Required Flag -->
<!--             ,DSS.FLGT_STAIR_NUM                            Flight of Stair Number -->
<!--             ,DSS.ELEV_AVAL_FLG                             Elevator Available Flag -->
<!--             ,DSS.ELEV_AVAL_FROM_HOUR_MN                    Elevator Available From Hours -->
<!--             ,DSS.ELEV_AVAL_TO_HOUR_MN                      Elevator Available To Hours -->
<!--             ,DSS.ELEV_APPT_REQ_FLG                         Elevator Appointment Required Flag -->
<!--             ,DSS.ELEV_CTAC_TEL_NUM                         Elevator Contact Phone Number -->
<!--             ,DSS.ELEV_PROT_REQ_FLG                         Elevator Protection Required Flag -->
<!--             ,DSS.ELEV_WDT                                  Elevator Width -->
<!--             ,DSS.ELEV_DEPTH_NUM                            Elevator Depth -->
<!--             ,DSS.ELEV_CTAC_PSN_NM                          Elevator Contact Person -->
<!--             ,DSS.ELEV_CAP_WT                               Elevator Capacity Weight -->
<!--             ,DSS.ELEV_DOOR_HGT                             Elevator Door Height -->
<!--             ,DSS.ELEV_DOOR_WDT                             Elevator Door Width -->
<!--             ,DSS.STAIR_AND_LDG_WDT                         Stair and Landing Width -->
<!--             ,DSS.CRDR_WDT                                  Corridor Width -->
<!--             ,DSS.DOOR_WDT                                  Door Width -->
<!--             ,DSS.LOAD_DOCK_AVAL_FLG                        Loading Dock Available Flag -->
<!--             ,DSS.LOAD_DOCK_HGT                             Loading Dock Height -->
<!--             ,DSS.TRCTR_AND_TRAIL_ACCS_FLG                  Tractor and Trailer Accessible Flag -->
<!--             ,DSS.BLDG_ENT_DOOR_HGT                         Building Entrance Door Height -->
<!--             ,DSS.BLDG_ENT_DOOR_WDT                         Building Entrance Door Width -->
<!--             ,DSS.LOAD_DOCK_AVAL_FROM_HOUR_MN               Loading Dock Available From Hours -->
<!--             ,DSS.LOAD_DOCK_AVAL_TO_HOUR_MN                 Loading Dock Available To Hours -->
<!--             ,DSS.CARR_DELY_TM_HOUR_MN                      Carrier Delivery Time Hours -->
<!--             ,DSS.DELY_TRNSP_OPT_CD                         Delivery Transport Option Code -->
<!--             ,DSS.SITE_SRVY_ADDL_CMNT_TXT                   Site Survey Additional Comment Text -->
<!--         FROM -->
<!--             DS_SITE_SRVY         DSS          Direct Sales Site Survey -->
<!--             ,DS_CPO_CONFIG        DCC         Direct Sales CPO Configuration Information -->
<!--         WHERE -->
<!--             DSS.EZCANCELFLAG         = '0' -->
<!--             AND DSS.GLBL_CMPY_CD     = #glblCmpyCd# -->
<!--             AND DSS.CPO_ORD_NUM      = #cpoOrdNum# -->
<!--             AND DSS.EZCANCELFLAG     = DCC.EZCANCELFLAG(+) -->
<!--             AND DSS.GLBL_CMPY_CD     = DCC.GLBL_CMPY_CD(+) -->
<!--             AND DSS.DS_CPO_CONFIG_PK = DCC.DS_CPO_CONFIG_PK(+) -->
    <!-- /statement -->

    <!-- statement id="getCpoCtacPsnByCpoOrdNum" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              DCCP.CPO_ORD_NUM                               CPO Order Number -->
<!--             ,DCCP.CTAC_PSN_PK                               Contact person Primary Key -->
<!--             ,DCC.CONFIG_CATG_CD                             Configuration Type Code -->
<!--             ,DCC.DS_ORD_POSN_NUM                            Order Position Number -->
<!--             ,DCCP.CTAC_PSN_TP_CD                            Contact Person Type Code -->
<!--             ,DCCP.CTAC_PSN_OVRD_FLG                         Contact Person Override Flag -->
<!--             ,DCCP.CTAC_PSN_FIRST_NM                         Contact Person First Name -->
<!--             ,DCCP.CTAC_PSN_MID_NM                           Contact Person Middle Name -->
<!--             ,DCCP.CTAC_PSN_LAST_NM                          Contact Person Last Name -->
<!--             ,DCCP.CTAC_PSN_EML_ADDR                         Contact Person Email Address -->
<!--             ,DCCP.CTAC_PSN_EXTN_NUM                         Contact Person Extension Number -->
<!--             ,DCCP.CTAC_PSN_TEL_NUM                          Contact Person (Telephone) Extension Number -->
<!--             ,DCCP.CTAC_PSN_FAX_NUM                          Contact Person FAX Number -->
<!--             ,DCCP.CTAC_PSN_SORT_NUM                         Contact Person Comment Text -->
<!--         FROM -->
<!--             DS_CPO_CTAC_PSN      DCCP        Direct Sales Contact Person -->
<!--             ,DS_CPO_CONFIG       DCC         Direct Sales CPO Configuration Information -->
<!--         WHERE -->
<!--             DCCP.EZCANCELFLAG         = '0' -->
<!--             AND DCCP.GLBL_CMPY_CD     = #glblCmpyCd# -->
<!--             AND DCCP.CPO_ORD_NUM      = #cpoOrdNum# -->
<!--             AND DCCP.EZCANCELFLAG     = DCC.EZCANCELFLAG(+) -->
<!--             AND DCCP.GLBL_CMPY_CD     = DCC.GLBL_CMPY_CD(+) -->
<!--             AND DCCP.DS_CPO_CONFIG_PK = DCC.DS_CPO_CONFIG_PK(+) -->
    <!-- /statement -->
    <!-- 2017/05/16 S21_NA#Review structure Lv.2 (Delete Logif For Copy) Del End -->

    <!-- 2017/05/15 S21_NA#Review structure Lv.2 RS#8335 Del Start -->
    <!-- statement id="getCpoSvcPkByCpoOrdNum" parameterClass="Map" resultClass="BigDecimal" -->
<!--         SELECT -->
<!--              CS.CPO_SVC_PK                               --><!-- Primary key of the entity -->
<!--         FROM -->
<!--             CPO_SVC              CS         --><!-- CPO Service -->
<!--         WHERE -->
<!--             CS.EZCANCELFLAG         = '0' -->
<!--             AND CS.GLBL_CMPY_CD     = #glblCmpyCd# -->
<!--             AND CS.REF_CPO_ORD_NUM  = #cpoOrdNum# -->
    <!-- /statement -->

    <!-- statement id="getCpoSvcDtlForShell" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              CSD.CPO_SVC_DTL_PK                           --><!-- Primary key of the entity -->
<!--             ,CSD.CPO_SVC_LINE_NUM                         --><!-- Maintenance Shell -->
<!--             ,CSD.CPO_SVC_MDSE_CD                          --><!-- Shell Item -->
<!--             ,CSD.PRC_SVC_CONTR_TP_CD                      --><!-- Contract Type -->
<!--             ,CSD.PRC_SVC_PLN_TP_CD                        --><!-- Plan Type -->
<!--             ,CSD.DS_CONTR_CATG_CD                         --><!-- Contract Indicator -->
<!--             ,CSD.BASE_BLLG_CYCLE_CD                       --><!-- Base Bill Cycle -->
<!--             ,CSD.USG_BLLG_CYCLE_CD                        --><!-- Usage Bill Cycle -->
<!--             ,CSD.FROM_PER_MTH_NUM                         --><!-- Period From -->
<!--             ,CSD.TO_PER_MTH_NUM                           --><!-- Period To -->
<!--             ,CSD.TERM_MTH_NUM                             --><!-- Term -->
<!--             ,CSD.BILL_WITH_EQUIP_FLG                      --><!-- Billed w/ Equip -->
<!--             ,CSD.BILL_BY_TP_CD                            --><!-- Billed by -->
<!--             ,CSD.SOLD_TO_CUST_LOC_CD                      --><!-- Location Number -->
<!--             ,CSD.SELL_TO_CUST_CD                          --><!-- Customer -->
<!--             ,CSD.CPO_SVC_AGMT_VER_NUM                     --><!-- Agreement Version -->
<!--             ,CSD.MAN_CONTR_OVRD_FLG                       --><!-- Manual Override -->
<!--             ,CSD.MAN_CONTR_OVRD_RSN_CD                    --><!-- Manual Override Reason -->
<!--             ,CSD.MAN_CONTR_OVRD_CMNT_TXT                  --><!-- Manual Override Comment -->
<!--             ,CSD.DS_CONTR_PK                              --><!-- Add to Contract -->
<!--             ,CSD.SVC_PRC_CATG_CD                          --><!-- MUBC or AUBC or ADCH -->
<!--             ,CSD.BILL_WITH_EQUIP_INVD_FLG                 --><!-- Bill With Equipment Invoiced Flag -->
<!--             ,CSD.CR_REBIL_CD                              --><!-- Credit And Rebill Code -->
<!--             ,CSD.CONTR_CRAT_FLG                           --><!-- Contract Creation Flag -->
<!--             ,CSD.APPLY_EQUIP_BILL_TO_FLG                  --><!-- Maint Bill To Same as Equipment -->
            <!-- 2016/10/11 S21_NA#7924-2 Add Start -->
<!--             ,CSD.TOT_BASE_PRC_DEAL_AMT -->
<!--             ,CSD.TOT_BASE_PRC_FUNC_AMT -->
<!--             ,CSD.ADD_ASRY_FLG -->
            <!-- 2016/10/11 S21_NA#7924-2 Add End -->
            <!-- 2017/03/06 S21_NA#17790 Add Start -->
<!--             ,CSD.FIX_TERM_IN_MTH_AOT -->
<!--             ,CSD.MAX_UPLFT_PCT -->
<!--             ,CSD.CPO_SVC_LINE_ACT_CD -->
            <!-- 2017/03/06 S21_NA#17790 Add End   -->
<!--         FROM -->
<!--             CPO_SVC_DTL          CSD        --><!-- CPO Service Detail -->
<!--         WHERE -->
<!--             CSD.EZCANCELFLAG       = 0 -->
<!--             AND CSD.GLBL_CMPY_CD   = #glblCmpyCd# -->
<!--             AND CSD.CPO_SVC_PK     = #cpoSvcPk# -->
    <!-- /statement -->

    <!-- statement id="getCpoSvcPrcForShell" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              CSP.CPO_SVC_DTL_PK                           --><!-- Reference to parent entity -->
<!--             ,CSD.CPO_SVC_LINE_NUM                         --><!-- Maintenance Shell -->
<!--             ,CSP.MDL_ID                                   --><!-- Model -->
<!--             ,CSP.MAINT_PRC_CATG_CD                        --><!-- Maintenance Price List -->
<!--             ,CSP.MAINT_FL_PRC_CATG_CD                     --><!-- Maintenance Price List(Floor Price List) -->
<!--             ,CSP.PRC_MTR_PKG_PK                           --><!-- Service Package -->
<!--             ,CSP.BASE_PRC_DEAL_AMT                        --><!-- Monthly Total Base Amount -->
<!--             ,CSP.BASE_PRC_FUNC_AMT                        --><!-- Monthly Total Base Amount -->
<!--             ,CSP.DEAL_PRC_LIST_PRC_AMT                    --><!-- Deal Price List Price Amount -->
<!--             ,CSP.FUNC_PRC_LIST_PRC_AMT                    --><!-- Function Price List Price Amount -->
<!--             ,CSP.PRC_TIER_SVC_OFFER_CD                    --><!-- Tiered Pricing -->
<!--             ,CSP.CORP_ADV_PRC_FLG                         --><!-- Corporate Advantage Pricing Flag -->
<!--             ,CSD.CPO_SVC_PK                               --><!-- Primary key of the entity -->
<!--         FROM -->
<!--             CPO_SVC_PRC          CSP        --><!-- CPO Service Price -->
<!--             ,CPO_SVC_DTL         CSD        --><!-- CPO Service Detail -->
<!--         WHERE -->
<!--             CSP.EZCANCELFLAG       = 0 -->
<!--             AND CSP.GLBL_CMPY_CD   = #glblCmpyCd# -->
<!--             AND CSP.EZCANCELFLAG   = CSD.EZCANCELFLAG -->
<!--             AND CSP.GLBL_CMPY_CD   = CSD.GLBL_CMPY_CD -->
<!--             AND CSP.CPO_SVC_DTL_PK = CSD.CPO_SVC_DTL_PK -->
<!--             AND CSD.CPO_SVC_PK     = #cpoSvcPk# -->
    <!-- /statement -->


    <!-- statement id="getCpoSvcConfigRefForShell" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              CSCR.CPO_SVC_DTL_PK                           --><!-- Reference to parent entity -->
<!--             ,CSD.CPO_SVC_LINE_NUM                          --><!-- Maintenance Shell -->
<!--             ,CSCR.CPO_ORD_NUM                              --><!-- CPO Order Number -->
<!--             ,CSCR.CPO_DTL_LINE_NUM                         --><!-- Line/Config -->
<!--             ,CSCR.CPO_DTL_LINE_SUB_NUM                     --><!-- Line/Config -->
<!--             ,DCD.DS_ORD_POSN_NUM                           --><!-- Order Position Number -->
<!--             ,CSCR.SVC_CONFIG_MSTR_PK                       --><!-- -->
<!--             ,CSCR.CUST_ISS_PO_NUM                          --><!-- PO Number -->
<!--             ,CSCR.CUST_ISS_PO_DT                           --><!-- PO Number -->
<!--             ,CSCR.MTR_READ_METH_CD                         --><!-- Meter Method -->
<!--             ,CSCR.CPO_SVC_PRC_PK                           --><!-- Reference to pricing -->
<!--             ,CSCR.SVC_PRC_CATG_CD                          --><!-- MUBC or AUBC or ADCH -->
<!--             ,CSCR.BILL_WITH_EQUIP_INVD_FLG                 --><!-- Bill With Equipment Invoiced Flag -->
<!--             ,CSCR.CR_REBIL_CD                              --><!-- Credit And Rebill Code -->
<!--             ,CSCR.CONTR_CRAT_FLG                           --><!-- Contract Creation Flag -->
<!--         FROM -->
<!--             CPO_SVC_CONFIG_REF   CSCR       --><!-- CPO Service Config Reference -->
<!--             ,CPO_SVC_DTL         CSD        --><!-- CPO Service Detail -->
<!--             ,CPO_DTL             DCD        --><!-- CPO Detail -->
<!--         WHERE -->
<!--             CSCR.EZCANCELFLAG       = 0 -->
<!--             AND CSCR.GLBL_CMPY_CD   = #glblCmpyCd# -->
<!--             AND CSCR.EZCANCELFLAG   = CSD.EZCANCELFLAG -->
<!--             AND CSCR.GLBL_CMPY_CD   = CSD.GLBL_CMPY_CD -->
<!--             AND CSCR.CPO_SVC_DTL_PK = CSD.CPO_SVC_DTL_PK -->
<!--             AND CSD.CPO_SVC_PK      = #cpoSvcPk# -->
<!--             AND CSCR.EZCANCELFLAG   = DCD.EZCANCELFLAG -->
<!--             AND CSCR.GLBL_CMPY_CD   = DCD.GLBL_CMPY_CD -->
<!--             AND CSCR.CPO_ORD_NUM = DCD.CPO_ORD_NUM -->
<!--             AND CSCR.CPO_DTL_LINE_NUM  = DCD.CPO_DTL_LINE_NUM -->
<!--             AND CSCR.CPO_DTL_LINE_SUB_NUM = DCD.CPO_DTL_LINE_SUB_NUM -->
    <!-- /statement -->

    <!-- statement id="getCpoSvcUsgPrcForShell" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              CSUP.CPO_SVC_DTL_PK                           --><!-- Reference to parent entity -->
<!--             ,CSD.CPO_SVC_LINE_NUM                          --><!-- Maintenance Shell -->
<!--             ,CSP.MDL_ID                                    --><!-- Model -->
<!--             ,CSUP.CPO_SVC_PRC_PK                           --><!-- Reference to parent entity -->
<!--             ,CSUP.PRC_LIST_BAND_CD                         --><!-- Band -->
<!--             ,CSUP.PRC_BOOK_MDSE_CD                         --><!-- Price Book Item -->
<!--             ,CSUP.BLLG_MTR_LB_CD                           --><!-- Billing Counter Name -->
<!--             ,CSUP.USG_MDSE_CD                              --><!-- Usage Item -->
<!--             ,CSUP.REG_MTR_LB_CD                            --><!-- Hard Counter Name -->
<!--             ,CSUP.COPY_INCL_PRC_QTY                        --><!-- Covered Image -->
<!--             ,CSUP.XS_MTR_AMT_RATE                          --><!-- Excess Per Image Charge -->
<!--             ,CSUP.CONTR_MTR_MULT_RATE                      --><!-- Multiplier -->
<!--             ,CSUP.PRC_SVC_TIER_TP_CD                       --><!-- Tier Type -->
<!--             ,CSUP.MIN_COPY_VOL_CNT                         --><!-- Range From -->
<!--             ,CSUP.MAX_COPY_VOL_CNT                         --><!-- Range TO -->
<!--             ,CSD.CPO_SVC_PK                                --><!-- Primary key of the entity -->
<!--         FROM -->
<!--             CPO_SVC_USG_PRC      CSUP       --><!-- CPO Service Usage Price -->
<!--             ,CPO_SVC_DTL         CSD        --><!-- CPO Service Detail -->
<!--             ,CPO_SVC_PRC         CSP        --><!-- CPO Service Price -->
<!--         WHERE -->
<!--             CSUP.EZCANCELFLAG       = 0 -->
<!--             AND CSUP.GLBL_CMPY_CD   = #glblCmpyCd# -->
<!--             AND CSUP.EZCANCELFLAG   = CSD.EZCANCELFLAG -->
<!--             AND CSUP.GLBL_CMPY_CD   = CSD.GLBL_CMPY_CD -->
<!--             AND CSUP.CPO_SVC_DTL_PK = CSD.CPO_SVC_DTL_PK -->
<!--             AND CSUP.EZCANCELFLAG   = CSP.EZCANCELFLAG -->      <!-- QC#13604 -->
<!--             AND CSUP.GLBL_CMPY_CD   = CSP.GLBL_CMPY_CD -->      <!-- QC#13604 -->
<!--             AND CSUP.CPO_SVC_PRC_PK = CSP.CPO_SVC_PRC_PK -->    <!-- QC#13604 -->
<!--             AND CSD.CPO_SVC_PK      = #cpoSvcPk# -->
    <!-- /statement -->

    <!-- statement id="getCpoSvcAddlBasePrcForShell" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              CSABP.CPO_ORD_NUM                              --><!-- CPO Order Number -->
<!--             ,CSD.CPO_SVC_LINE_NUM                           --><!-- Maintenance Shell -->
<!--             ,CSABP.CPO_DTL_LINE_NUM                         --><!-- internal sequential number -->
<!--             ,CSABP.CPO_DTL_LINE_SUB_NUM                     --><!-- internal sequential number -->
<!--             ,CSABP.ADDL_BASE_PRC_CATG_CD                    --><!-- Price List -->
<!--             ,CSABP.ADDL_BASE_PRC_DEAL_AMT                   --><!-- Periodic Service Price -->
<!--             ,CSABP.ADDL_BASE_PRC_FUNC_AMT                   --><!-- Periodic Service Price -->
<!--             ,CSABP.DEAL_PRC_LIST_PRC_AMT                    --><!-- Deal Price List Price Amount -->
<!--             ,CSABP.FUNC_PRC_LIST_PRC_AMT                    --><!-- Function Price List Price Amount -->
<!--             ,CSABP.PRC_LIST_EQUIP_CONFIG_NUM                --><!-- Pricing Config Number -->
<!--             ,CSABP.ADDL_EQUIP_PRC_DEAL_AMT                  --><!-- Periodic Rental Price -->
<!--             ,CSABP.ADDL_EQUIP_PRC_FUNC_AMT                  --><!-- Periodic Rental Price -->
<!--             ,CSABP.ADDL_SVC_PRC_DEAL_AMT                    --><!-- Periodic Service Price -->
<!--             ,CSABP.ADDL_SVC_PRC_FUNC_AMT                    --><!-- Periodic Service Price -->
<!--             ,CSABP.SVC_PRC_CATG_CD                          --><!-- MUBC or AUBC or ADCH -->
<!--             ,CSABP.BILL_WITH_EQUIP_INVD_FLG                 --><!-- Bill With Equipment Invoiced Flag -->
<!--             ,CSABP.CR_REBIL_CD                              --><!-- Credit And Rebill Code -->
<!--             ,CSD.CPO_SVC_PK                                 --><!-- Primary key of the entity -->
<!--         FROM -->
<!--             CPO_SVC_ADDL_BASE_PRC CSABP      --><!-- CPO Service Additional Base Price -->
<!--             ,CPO_SVC_DTL         CSD         --><!-- CPO Service Detail -->
<!--         WHERE -->
<!--             CSABP.EZCANCELFLAG       = 0 -->
<!--             AND CSABP.GLBL_CMPY_CD   = #glblCmpyCd# -->
<!--             AND CSABP.EZCANCELFLAG   = CSD.EZCANCELFLAG -->
<!--             AND CSABP.GLBL_CMPY_CD   = CSD.GLBL_CMPY_CD -->
<!--             AND CSABP.CPO_SVC_DTL_PK = CSD.CPO_SVC_DTL_PK -->
<!--             AND CSD.CPO_SVC_PK       = #cpoSvcPk# -->
    <!-- /statement -->


    <!-- statement id="getCpoSvcAddlChrgPrcForShell" parameterClass="Map" resultClass="Map" -->
<!--         SELECT -->
<!--              CSACP.CPO_SVC_DTL_PK                           --><!-- Reference to parent entity -->
<!--             ,CSD.CPO_SVC_LINE_NUM                           --><!-- Maintenance Shell -->
<!--             ,CSACP.CPO_ORD_NUM                              --><!-- CPO Order Number -->
<!--             ,CSACP.CPO_DTL_LINE_NUM                         --><!-- internal sequencial number -->
<!--             ,CSACP.CPO_DTL_LINE_SUB_NUM                     --><!-- internal sequencial number -->
<!--             ,CSACP.ADDL_CHRG_PRC_CATG_CD                    --><!-- Price List -->
<!--             ,CSACP.ADDL_CHRG_MDSE_CD                        --><!-- Additional Charge Item -->
<!--             ,CSACP.ADDL_CHRG_PRC_DEAL_AMT                   --><!-- Periodic Service Price -->
<!--             ,CSACP.ADDL_CHRG_PRC_FUNC_AMT                   --><!-- Periodic Service Price -->
<!--             ,CSACP.DEAL_PRC_LIST_PRC_AMT                    --><!-- Deal Price List Price Amount -->
<!--             ,CSACP.FUNC_PRC_LIST_PRC_AMT                    --><!-- Function Price List Price Amount -->
<!--             ,CSACP.SVC_PRC_CATG_CD                          --><!-- MUBC or AUBC or ADCH -->
<!--             ,CSACP.BILL_WITH_EQUIP_INVD_FLG                 --><!-- Bill With Equipment Invoiced Flag -->
<!--             ,CSACP.CR_REBIL_CD                              --><!-- Credit And Rebill Code -->
<!--             ,CSD.CPO_SVC_PK                                 --><!-- Primary key of the entity -->
<!--         FROM -->
<!--             CPO_SVC_ADDL_CHRG_PRC CSACP      --><!-- CPO Service Additional Charge Price -->
<!--             ,CPO_SVC_DTL         CSD         --><!-- CPO Service Detail -->
<!--         WHERE -->
<!--             CSACP.EZCANCELFLAG       = 0 -->
<!--             AND CSACP.GLBL_CMPY_CD   = #glblCmpyCd# -->
<!--             AND CSACP.EZCANCELFLAG   = CSD.EZCANCELFLAG -->
<!--             AND CSACP.GLBL_CMPY_CD   = CSD.GLBL_CMPY_CD -->
<!--             AND CSACP.CPO_SVC_DTL_PK = CSD.CPO_SVC_DTL_PK -->
<!--             AND CSD.CPO_SVC_PK       = #cpoSvcPk# -->
    <!-- /statement -->
    <!-- 2017/05/15 S21_NA#Review structure Lv.2 RS#8335 Del End -->

    <statement id="cntCustIssPoNum" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*)

        FROM
            CPO C

        WHERE
                C.GLBL_CMPY_CD     = #glblCmpyCd#
            <isNotNull property="cpoOrdNum">
            AND C.CPO_ORD_NUM      <![CDATA[ <> ]]> #cpoOrdNum#
            </isNotNull>
            <!-- 2019/04/03 QC#30756 Mod Start -->
            <!-- AND C.CUST_ISS_PO_NUM  = #custIssPoNum# -->
            AND UPPER(C.CUST_ISS_PO_NUM)  = UPPER(#custIssPoNum#)
            <!-- 2019/04/03 QC#30756 Mod End -->
            AND C.EZCANCELFLAG     = '0'
            AND C.BILL_TO_CUST_ACCT_CD = #billToCustAcctCd#

            AND ROWNUM <![CDATA[ <= ]]> 2
    </statement>

    <statement id="cntLeaseCmpyPoNum" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*)

        FROM
            CPO C

        WHERE
                C.GLBL_CMPY_CD     = #glblCmpyCd#
            <isNotNull property="cpoOrdNum">
            AND C.CPO_ORD_NUM      <![CDATA[ <> ]]> #cpoOrdNum#
            </isNotNull>
            AND C.EZCANCELFLAG     = '0'
            <!-- 2019/04/03 QC#30756 Mod Start -->
            <!-- AND C.LEASE_CMPY_PO_NUM  = #leaseCmpyPoNum# -->
            AND UPPER(C.LEASE_CMPY_PO_NUM)  = UPPER(#leaseCmpyPoNum#)
            <!-- 2019/04/03 QC#30756 Mod End -->
            AND C.BILL_TO_CUST_ACCT_CD = #billToCustAcctCd#

            AND ROWNUM <![CDATA[ <= ]]> 2
    </statement>

    <!-- 2016/08/25 S21_NA#10321 Add Start -->
    <statement id="getSubWhInfoWithRsnOfPerfectMatching" parameterClass="Map" resultClass="String">
        SELECT
            RTL_SWH_CD
        FROM
            DS_INVTY_LOC_V
        WHERE
            GLBL_CMPY_CD     = #glblCmpyCd#
            AND RTL_WH_CD    = #rtlWhCd#
            AND RTL_SWH_NM   = #rtlSWhNm#
            AND EZCANCELFLAG = '0'
    </statement>
    <!-- 2016/08/25 S21_NA#10321 Add End -->

    <!-- S21_NA#13769(S21_NA#8388) ADD START -->
    <statement id="getCntCpoSvcDtl" parameterClass="Map" resultClass="Integer">
    <!-- 2017/05/17 S21_NA#Review structure Lv.2 RS#8339 Mod Start -->
<!--           SELECT COUNT(1)  -->
<!--           FROM   CPO_SVC_DTL CSD -->
<!--           WHERE   -->
<!--                  CSD.GLBL_CMPY_CD = #glblCmpyCd# -->
<!--              AND CSD.EZCANCELFLAG = '0' -->
<!--              AND EXISTS -->
<!--                     ( -->
<!--                     SELECT  -->
<!--                            1 -->
<!--                     FROM    -->
<!--                            CPO_SVC CS -->
<!--                     WHERE   -->
<!--                            CS.GLBL_CMPY_CD    = CSD.GLBL_CMPY_CD -->
<!--                        AND CS.REF_CPO_ORD_NUM = #cpoOrdNum# -->
<!--                        AND CS.CPO_SVC_PK      = CSD.CPO_SVC_PK -->
<!--                        AND CS.EZCANCELFLAG    = '0' -->
<!--                  ) -->
          SELECT COUNT(1) 
          FROM   DS_CONTR_DTL DCD
          <!-- 2017/12/19 S21_NA#22989 Add Start -->
               , DS_CONTR DC
               , DS_CONTR_CATG DCC
          <!-- 2017/12/19 S21_NA#22989 Add End -->
          WHERE  
                 DCD.GLBL_CMPY_CD = #glblCmpyCd#
             AND DCD.CPO_ORD_NUM  = #cpoOrdNum#
             AND DCD.EZCANCELFLAG = '0'
          <!-- 2017/12/19 S21_NA#22989 Add Start -->
             AND DCD.GLBL_CMPY_CD = DC.GLBL_CMPY_CD
             AND DCD.DS_CONTR_PK  = DC.DS_CONTR_PK
             AND DC.EZCANCELFLAG  = '0'

             AND DC.GLBL_CMPY_CD     = DCC.GLBL_CMPY_CD
             AND DC.DS_CONTR_CATG_CD = DCC.DS_CONTR_CATG_CD
             AND DCC.OM_CATG_FLG     = 'Y'
             AND DCC.EZCANCELFLAG    = '0'
          <!-- 2017/12/19 S21_NA#22989 Add End -->
    <!-- 2017/05/17 S21_NA#Review structure Lv.2 RS#8339 Mod End -->
    </statement>

    <statement id="getCntCpoSvcConfigRef" parameterClass="Map" resultClass="Integer">
    <!-- 2017/05/18 S21_NA#Review structure Lv.2 RS#8339 Mod Start -->
<!--           SELECT COUNT(1)  -->
<!--           FROM   CPO_SVC_CONFIG_REF CSCR -->
<!--           WHERE   -->
<!--                  CSCR.GLBL_CMPY_CD         = #glblCmpyCd# -->
<!--              AND CSCR.CPO_ORD_NUM          = #cpoOrdNum# -->
<!--              AND CSCR.CPO_DTL_LINE_NUM     = #cpoDtlLineNum# -->
<!--              AND CSCR.CPO_DTL_LINE_SUB_NUM = #cpoDtlLineSubNum# -->
<!--              AND CSCR.EZCANCELFLAG = '0' -->
          SELECT COUNT(1) 
          FROM   DS_CONTR_DTL DCD
          <!-- 2017/12/19 S21_NA#22989 Add Start -->
               , DS_CONTR DC
               , DS_CONTR_CATG DCC
          <!-- 2017/12/19 S21_NA#22989 Add End -->
          WHERE  
                 DCD.GLBL_CMPY_CD         = #glblCmpyCd#
             AND DCD.CPO_ORD_NUM          = #cpoOrdNum#
             AND DCD.CPO_DTL_LINE_NUM     = #cpoDtlLineNum#
             AND DCD.CPO_DTL_LINE_SUB_NUM = #cpoDtlLineSubNum#
             AND DCD.EZCANCELFLAG         = '0'
          <!-- 2017/12/19 S21_NA#22989 Add Start -->
             AND DCD.GLBL_CMPY_CD         = DC.GLBL_CMPY_CD
             AND DCD.DS_CONTR_PK          = DC.DS_CONTR_PK
             AND DC.EZCANCELFLAG          = '0'

             AND DC.GLBL_CMPY_CD          = DCC.GLBL_CMPY_CD
             AND DC.DS_CONTR_CATG_CD      = DCC.DS_CONTR_CATG_CD
             AND DCC.OM_CATG_FLG          = 'Y'
             AND DCC.EZCANCELFLAG         = '0'
          <!-- 2017/12/19 S21_NA#22989 Add End -->
    <!-- 2017/05/18 S21_NA#Review structure Lv.2 RS#8339 Mod End -->
    </statement>
    <!-- S21_NA#13769(S21_NA#8388) ADD END -->

    <!-- 2016/08/30 S21_NA#9806 Add Start -->
    <statement id="checkCSMPNum" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(CSMP_CONTR_PK) AS CNT
        FROM
            CSMP_CONTR CC
        WHERE
            CC.GLBL_CMPY_CD            = #glblCmpyCd#
            AND CC.DS_ACCT_NUM         = #sellToCustCd#
            AND CC.EFF_FROM_DT         <![CDATA[<=]]> #slsDt#
            AND (CC.EFF_THRU_DT        <![CDATA[>=]]> #slsDt# OR CC.EFF_THRU_DT IS NULL)
            AND CC.CSMP_CONTR_ACTV_FLG = #flgOnY#
            <isNotNull property="csmpNum">
                AND CC.CSMP_NUM            = #csmpNum#
            </isNotNull>
            <isNotNull property="dlrRefNum">
                AND CC.DLR_REF_NUM         = #dlrRefNum#
            </isNotNull>
            AND CC.EZCANCELFLAG        = '0'
    </statement>
    <!-- 2016/08/30 S21_NA#9806 Add End -->

    <!-- 2016/09/13 S21_NA#8276 Add Start -->
    <!-- 2016/10/13 S21_NA#15149 Mod Start -->
    <statement id="checkMdlPrntMdse" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(DMC.MDL_ID) AS RSLT_CNT
        FROM
            DS_MDL_CONFIG DMC
            , DS_MDL DMD
            <!-- 2018/10/09 QC#28383 add start -->
            <isNotNull property="swMdlFlg">
            , SVC_MDL_TP SMT
            </isNotNull>
            <!-- 2018/10/09 QC#28383 add end -->
        WHERE
            DMC.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DMC.PRNT_MDSE_CD        = #mdseCd#
            AND DMC.EFF_FROM_DT         &lt;= #salesDt#
            AND (DMC.EFF_THRU_DT        &gt;= #salesDt#
                OR DMC.EFF_THRU_DT         IS NULL)
            AND DMC.EZCANCELFLAG        = '0'
            AND DMC.GLBL_CMPY_CD        = DMD.GLBL_CMPY_CD
            AND DMC.MDL_ID              = DMD.MDL_ID
            AND DMD.MDL_ACTV_FLG        = 'Y'
            AND DMD.EZCANCELFLAG        = '0'
            <!-- 2018/10/09 QC#28383 add start -->
            <!-- Mod Start 2019/04/01 QC#30912 -->
            <isNotNull property="swMdlFlg">
            AND (DMD.SVC_MDL_TP_CD      IS NULL
            OR  (DMD.GLBL_CMPY_CD       = SMT.GLBL_CMPY_CD
            AND DMD.SVC_MDL_TP_CD       = SMT.SVC_MDL_TP_CD
            AND SMT.EZCANCELFLAG        = '0'
            AND SMT.SW_MDL_FLG          = 'N'))
            </isNotNull>
            <!-- Mod End 2019/04/01 QC#30912 -->
            <!-- 2018/10/09 QC#28383 add start -->
        UNION
        SELECT
            COUNT(DMC.MDL_ID) AS RSLT_CNT
        FROM
            ORD_TAKE_MDSE OTM
            , DS_MDL_CONFIG DMC
            , DS_MDL DMD
            <!-- 2018/10/09 QC#28383 add start -->
            <!-- Mod Start 2019/04/01 QC#30912 -->
            <isNotNull property="swMdlFlg">
            , SVC_MDL_TP SMT
            </isNotNull>
            <!-- Mod End 2019/04/01 QC#30912 -->
            <!-- 2018/10/09 QC#28383 add end -->
        WHERE
            OTM.GLBL_CMPY_CD            = #glblCmpyCd#
            AND OTM.MDSE_CD             = #mdseCd#
            AND OTM.EZCANCELFLAG        = '0'
            AND OTM.GLBL_CMPY_CD        = DMC.GLBL_CMPY_CD
            AND OTM.ORD_TAKE_MDSE_CD    = DMC.PRNT_MDSE_CD
            AND DMC.EFF_FROM_DT         &lt;= #salesDt#
            AND (DMC.EFF_THRU_DT        &gt;= #salesDt#
                OR DMC.EFF_THRU_DT         IS NULL)
            AND DMC.EZCANCELFLAG        = '0'
            AND DMC.GLBL_CMPY_CD        = DMD.GLBL_CMPY_CD
            AND DMC.MDL_ID              = DMD.MDL_ID
            AND DMD.MDL_ACTV_FLG        = 'Y'
            AND DMD.EZCANCELFLAG        = '0'
            <!-- 2018/10/09 QC#28383 add start -->
            <!-- Mod Start 2019/04/01 QC#30912 -->
            <isNotNull property="swMdlFlg">
            AND (DMD.SVC_MDL_TP_CD      IS NULL
            OR  (DMD.GLBL_CMPY_CD       = SMT.GLBL_CMPY_CD
            AND DMD.SVC_MDL_TP_CD       = SMT.SVC_MDL_TP_CD
            AND SMT.EZCANCELFLAG        = '0'
            AND SMT.SW_MDL_FLG          = 'N'))
            </isNotNull>
            <!-- Mod End 2019/04/01 QC#30912 -->
            <!-- 2018/10/09 QC#28383 add start -->
    </statement>
    <!-- 2016/10/13 S21_NA#15149 Mod End -->
    <!-- 2016/09/13 S21_NA#8276 Add End -->

    <!-- 2016/11/08 S21_NA#15427 Add Start -->
    <statement id="getLineCategoryCodeFromValueSet" parameterClass="Map" resultClass="String">
        SELECT
            DS_ORD_LINE_CATG_CD
        FROM
            ORD_LINE_VAL_SET
        WHERE
            GLBL_CMPY_CD            = #glblCmpyCd#
            AND ORD_LINE_CTX_TP_CD  = #ordLineCtxTpCd#
            <isNotNull property="dsOrdLineDrctnCd">
                AND DS_ORD_LINE_DRCTN_CD = #dsOrdLineDrctnCd#
            </isNotNull>
            AND EZCANCELFLAG        = '0'
        ORDER BY
            DS_ORD_LINE_CATG_CD
    </statement>
    <!-- 2016/11/08 S21_NA#15427 Add End -->

    <!-- 2016/11/09 S21_NA#9864 Add Start -->
    <statement id="getLoanShipLineCategory" parameterClass="Map" resultClass="String">
        SELECT
            OLC.DS_ORD_LINE_CATG_CD
        FROM
            DS_ORD_LINE_CATG OLC
            , DS_ORD_LINE_PROC_DFN OLPD
            , ORD_PROC_TP OPT
        WHERE
            OLC.GLBL_CMPY_CD = #glblCmpyCd#
            AND OLC.DS_ORD_LINE_CATG_CD = #dsOrdLineCatgCd#
            AND OLC.EZCANCELFLAG = '0'

            AND OLC.GLBL_CMPY_CD = OLPD.GLBL_CMPY_CD
            AND OLC.DS_ORD_LINE_CATG_CD = OLPD.DS_ORD_LINE_CATG_CD
            AND OLPD.EFF_FROM_DT <![CDATA[<=]]> #slsDt#
            AND NVL(OLPD.EFF_THRU_DT, '99991231') <![CDATA[>=]]> #slsDt#
            <!-- S21_NA#17586 Add Start -->
            AND OLPD.DS_ORD_TP_CD = #dsOrdTpCd#
            <!-- S21_NA#17586 Add End -->
            AND OLPD.ACTV_FLG = #flgOnY#
            AND OLPD.EZCANCELFLAG = '0'

            AND OLPD.GLBL_CMPY_CD = OPT.GLBL_CMPY_CD
            AND OLPD.ORD_PROC_TP_CD = OPT.ORD_PROC_TP_CD
            AND OPT.OUT_OF_WH_INVTY_PROC_FLG = #flgOnY#
            AND OPT.EFF_FROM_DT <![CDATA[<=]]> #slsDt#
            AND NVL(OPT.EFF_THRU_DT, '99991231') <![CDATA[>=]]> #slsDt#
            AND OPT.ACTV_FLG = #flgOnY#
            AND OPT.EZCANCELFLAG = '0'
    </statement>
    <!-- 2016/11/09 S21_NA#9864 Add End -->

    <!-- S21_NA#15889 Add Start -->
    <statement id="getDsCpoDelyInfoPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            DS_CPO_DELY_INFO_PK
        FROM
            DS_CPO_DELY_INFO
        WHERE
            GLBL_CMPY_CD     = #glblCmpyCd#
            AND CPO_ORD_NUM  = #cpoOrdNum#
            AND EZCANCELFLAG = '0'
            <isNull property="dsCpoConfigPk">
                AND DS_CPO_CONFIG_PK IS NULL
            </isNull>
            <isNotNull property="dsCpoConfigPk">
                AND DS_CPO_CONFIG_PK = #dsCpoConfigPk#
            </isNotNull>
    </statement>

    <statement id="getDsCpoIstlInfoPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            DS_CPO_ISTL_INFO_PK
        FROM
            DS_CPO_ISTL_INFO
        WHERE
            GLBL_CMPY_CD     = #glblCmpyCd#
            AND CPO_ORD_NUM  = #cpoOrdNum#
            AND EZCANCELFLAG = '0'
            <isNull property="dsCpoConfigPk">
                AND DS_CPO_CONFIG_PK IS NULL
            </isNull>
            <isNotNull property="dsCpoConfigPk">
                AND DS_CPO_CONFIG_PK = #dsCpoConfigPk#
            </isNotNull>
    </statement>

    <statement id="getDsSiteSrvyPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            DS_SITE_SRVY_PK
        FROM
            DS_SITE_SRVY
        WHERE
            GLBL_CMPY_CD     = #glblCmpyCd#
            AND CPO_ORD_NUM  = #cpoOrdNum#
            AND EZCANCELFLAG = '0'
            <isNull property="dsCpoConfigPk">
                AND DS_CPO_CONFIG_PK IS NULL
            </isNull>
            <isNotNull property="dsCpoConfigPk">
                AND DS_CPO_CONFIG_PK = #dsCpoConfigPk#
            </isNotNull>
    </statement>

    <statement id="getDsCpoCtacPsnPkList" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            DS_CPO_CTAC_PSN_PK
        FROM
            DS_CPO_CTAC_PSN
        WHERE
            GLBL_CMPY_CD     = #glblCmpyCd#
            AND CPO_ORD_NUM  = #cpoOrdNum#
            AND EZCANCELFLAG = '0'
            <isNull property="dsCpoConfigPk">
                AND DS_CPO_CONFIG_PK IS NULL
            </isNull>
            <isNotNull property="dsCpoConfigPk">
                AND DS_CPO_CONFIG_PK = #dsCpoConfigPk#
            </isNotNull>
    </statement>
    <!-- S21_NA#15889 Add End -->

    <!-- 2017/12/07 S21_NA#22794 Add Start -->
    <statement id="getOtherOrderRmaConfigDetail" parameterClass="Map" resultMap="result.getOtherOrderRmaConfigDetail">
        SELECT
            CRD.CPO_ORD_NUM
            ,CRD.DS_CPO_RTRN_LINE_NUM
            ,CRD.DS_CPO_RTRN_LINE_SUB_NUM
            ,CRD.MDSE_CD
            ,CRD.SVC_MACH_MSTR_PK
            ,CRD.SER_NUM
        FROM
            DS_CPO_CONFIG DCC
            ,DS_CPO_RTRN_DTL CRD
        WHERE
            DCC.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM         <![CDATA[<>]]> #cpoOrdNum#
            AND DCC.SVC_CONFIG_MSTR_PK  = #configId#
            AND DCC.CONFIG_CATG_CD      = #configCatgInbound#
            AND DCC.EZCANCELFLAG        = '0'
            AND DCC.GLBL_CMPY_CD        = CRD.GLBL_CMPY_CD
            AND DCC.DS_CPO_CONFIG_PK    = CRD.DS_CPO_CONFIG_PK
            AND CRD.EZCANCELFLAG        = '0'
    </statement>
    <resultMap id="result.getOtherOrderRmaConfigDetail" class="DS_CPO_RTRN_DTLTMsg" noCheckSet="True">
        <result property="cpoOrdNum"            column="CPO_ORD_NUM"                javaType="EZDTStringItem"/>
        <result property="dsCpoRtrnLineNum"     column="DS_CPO_RTRN_LINE_NUM"       javaType="EZDTStringItem"/>
        <result property="dsCpoRtrnLineSubNum"  column="DS_CPO_RTRN_LINE_SUB_NUM"   javaType="EZDTStringItem"/>
        <result property="mdseCd"               column="MDSE_CD"                    javaType="EZDTStringItem"/>
        <result property="svcMachMstrPk"        column="SVC_MACH_MSTR_PK"           javaType="EZDTBigDecimalItem"/>
        <result property="serNum"               column="SER_NUM"                    javaType="EZDTStringItem"/>
    </resultMap>
    <!-- 2017/12/07 S21_NA#22794 Add End -->
    <!-- 2018/03/12 S21_NA#20297(Sol#379) Add Start -->
    <typeAlias alias="DS_CPO_DELY_INFOTMsg"           type="business.db.DS_CPO_DELY_INFOTMsg"/>
    <statement id="getDsCpoDelyInfo" parameterclass="Map" resultMap="result.getDsCpoDelyInfo">
        SELECT
             DCDI.DS_CPO_DELY_INFO_PK
            ,DCDI.CPO_ORD_NUM
            ,DCDI.DS_CPO_CONFIG_PK
            ,DCDI.DS_DELY_TP_CD
            ,DCDI.RDD_DT
            ,DCDI.OPS_FROM_HOUR_MN
            ,DCDI.OPS_TO_HOUR_MN
            ,DCDI.LOAD_DOCK_AVAL_FLG
            ,DCDI.STAIR_CRAW_REQ_FLG
            ,DCDI.STAIR_CRAW_NUM
            ,DCDI.ELEV_AVAL_FLG
            ,DCDI.DELY_ADDL_CMNT_TXT
        FROM
            DS_CPO_DELY_INFO DCDI
        WHERE
            DCDI.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCDI.CPO_ORD_NUM        = #cpoOrdNum#
            AND DCDI.EZCANCELFLAG       = '0'
    </statement>
    <resultMap id="result.getDsCpoDelyInfo" class="DS_CPO_DELY_INFOTMsg" noCheckSet="True">
        <result property="dsCpoDelyInfoPk"  column="DS_CPO_DELY_INFO_PK"  javaType="EZDTBigDecimalItem"/>
        <result property="cpoOrdNum"        column="CPO_ORD_NUM"          javaType="EZDTStringItem"/>
        <result property="dsCpoConfigPk"    column="DS_CPO_CONFIG_PK"     javaType="EZDTBigDecimalItem"/>
        <result property="dsDelyTpCd"       column="DS_DELY_TP_CD"        javaType="EZDTStringItem"/>
        <result property="rddDt"            column="RDD_DT"               javaType="EZDTStringItem"/>
        <result property="opsFromHourMn"    column="OPS_FROM_HOUR_MN"     javaType="EZDTStringItem"/>
        <result property="opsToHourMn"      column="OPS_TO_HOUR_MN"       javaType="EZDTStringItem"/>
        <result property="loadDockAvalFlg"  column="LOAD_DOCK_AVAL_FLG"   javaType="EZDTStringItem"/>
        <result property="stairCrawNum"     column="STAIR_CRAW_NUM"       javaType="EZDTStringItem"/>
        <result property="stairCrawReqFlg"  column="STAIR_CRAW_REQ_FLG"   javaType="EZDTStringItem"/>
        <result property="elevAvalFlg"      column="ELEV_AVAL_FLG"        javaType="EZDTStringItem"/>
        <result property="delyAddlCmntTxt"  column="DELY_ADDL_CMNT_TXT"   javaType="EZDTStringItem"/>
    </resultMap>
    <!-- 2018/03/12 S21_NA#20297(Sol#379) Add End -->

    <!-- 2018/10/25 S21_NA#28897 Add Start -->
    <statement id="checkChangeWhForPendingReturn" parameterClass="Map" resultClass="String">
        SELECT
           RH.RWS_NUM
        FROM
            RWS_HDR RH
           ,RWS_DTL RD
        WHERE
                RH.GLBL_CMPY_CD         = #glblCmpyCd#
            AND RH.TRX_ORD_NUM          = #cpoOrdNum#
            AND RH.RWS_STS_CD           <![CDATA[<>]]> #rwsCanceled#
            AND RH.EZCANCELFLAG         = '0'
            AND RH.GLBL_CMPY_CD         = RD.GLBL_CMPY_CD
            AND RH.RWS_NUM              = RD.RWS_NUM
            AND RD.TRX_LINE_NUM         = #cpoDtlLineNum#
            AND RD.TRX_LINE_SUB_NUM     = #cpoDtlLineSubNum#
            AND RD.RWS_STS_CD           <![CDATA[<>]]> #rwsCanceled#
            AND RD.EZCANCELFLAG         = '0'
    </statement>
    <!-- 2018/10/25 S21_NA#28897 Add End -->

    <!-- START 2018/11/02 Hd.Sugawara [QC#29017,ADD] -->
    <statement id="getSvcMachMstr" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.SER_NUM
           ,SMM.MDSE_CD
        FROM
            SVC_MACH_MSTR SMM
        WHERE
                SMM.GLBL_CMPY_CD       = #glblCmpyCd#
            AND SMM.EZCANCELFLAG       = '0'
            AND SMM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
    </statement>
    <!-- END 2018/11/02 Hd.Sugawara [QC#29017,ADD] -->

    <!-- 2019/07/26 QC#51941 Add Start -->
    <statement id="getMainMachine" parameterClass="Map" resultClass="Map">
        SELECT 
            SMM.MDSE_CD
           ,SMM.SER_NUM
        FROM
            SVC_CONFIG_MSTR SCM
           ,SVC_MACH_MSTR  SMM
        WHERE
                SCM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
            AND SCM.GLBL_CMPY_CD       = #glblCmpyCd#
            AND SCM.EZCANCELFLAG       = '0'
            AND SMM.SVC_MACH_MSTR_PK   = SCM.SVC_MACH_MSTR_PK
            AND SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD
            AND SMM.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2019/07/26 QC#51941 Add End -->

    <!-- Add Start 2019/11/15 QC#54515 -->
    <statement id="checkMultipleIBItem" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(SMM.SVC_MACH_MSTR_PK) 
        FROM
            SVC_MACH_MSTR SMM 
        WHERE
                SMM.GLBL_CMPY_CD       = #glblCmpyCd# 
            AND SMM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
            AND SMM.MDSE_CD            = #mdseCd#
            <isNotNull property="serNum">
                AND SMM.SER_NUM        = #serNum#
            </isNotNull>
            <iterate property="svcMachMstrStsCdList" var="svcMachMstrStsCd[]" open=" AND SMM.SVC_MACH_MSTR_STS_CD NOT IN (" close=")" conjunction=",">
                #svcMachMstrStsCd[]#
            </iterate>
            AND SMM.EZCANCELFLAG       = '0'
    </statement>
    <!-- Add End 2019/11/15 QC#54515 -->
    <!-- Add Start 2020/01/17 QC#55202  -->
    <statement id="checkIsDefaultWH" parameterClass="Map" resultClass="BigDecimal">
    SELECT 
        COUNT(RW.GLBL_CMPY_CD)
    FROM
        RTL_WH RW
    WHERE 
            RW.GLBL_CMPY_CD = #glblCmpyCd#
        AND RW.RTL_WH_DESC_TXT = #returnWH#
        AND RW.RTL_WH_CATG_CD = #dropRmaCd#
        AND RW.EZCANCELFLAG = '0'
    </statement>
    <statement id="checkHasDefaultWH" parameterClass="Map" resultClass="BigDecimal">
    SELECT COUNT(M.GLBL_CMPY_CD)
    FROM MDSE M
    WHERE
            M.GLBL_CMPY_CD = #glblCmpyCd#
        AND M.MDSE_CD = #mdseCd#
        AND M.DROP_RTRN_VND_CD IS NULL
        AND M.EZCANCELFLAG = '0'
    </statement>
    <!-- Add End   2020/01/17 QC#55202  -->
    
</sqlMap>
