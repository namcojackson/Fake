<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NMAL2520Query">

    <typeAlias alias="NMAL2520SMsg"     type="business.blap.NMAL2520.NMAL2520SMsg"/>
    <typeAlias alias="NMAL2520_ASMsg"   type="business.blap.NMAL2520.NMAL2520_ASMsg"/>
    <typeAlias alias="NMAL2520_BSMsg"   type="business.blap.NMAL2520.NMAL2520_BSMsg"/>
    <typeAlias alias="NMAL2520_CSMsg"   type="business.blap.NMAL2520.NMAL2520_CSMsg"/>
    <typeAlias alias="NMAL2520_TSMsg"   type="business.blap.NMAL2520.NMAL2520_TSMsg"/>

    <resultMap id="result.getOrganization"  class="NMAL2520SMsg">
        <result property="orgCd_H1"           column="ORG_CD"             javaType="EZDSStringItem"/>
        <result property="orgStruTpCd_H1"     column="ORG_STRU_TP_CD"     javaType="EZDSStringItem"/>
        <result property="effFromDt_H1"       column="EFF_FROM_DT"        javaType="EZDCDateItem"/>
        <result property="effThruDt_H1"       column="EFF_THRU_DT"        javaType="EZDCDateItem"/>
        <result property="orgNm_H1"           column="ORG_NM"             javaType="EZDSStringItem"/>
        <result property="orgShortNm_H1"      column="ORG_SHORT_NM"       javaType="EZDSStringItem"/>
        <result property="orgDescTxt_H1"      column="ORG_DESC_TXT"       javaType="EZDSStringItem"/>
        <result property="orgTierCd_P1"       column="ORG_TIER_CD"        javaType="EZDSStringItem"/>
        <result property="lineBizTpCd_P1"     column="LINE_BIZ_TP_CD"     javaType="EZDSStringItem"/>
        <result property="bizAreaOrgCd_P1"    column="FIRST_ORG_CD"       javaType="EZDSStringItem"/>
        <result property="csrRgTpCd_P1"       column="CSR_RG_TP_CD"       javaType="EZDSStringItem"/>
        <result property="xxChkBox_H1"        column="AUTO_EST_FLG"       javaType="EZDSStringItem"/>
        <result property="ezUpTime_H1"        column="EZUPTIME"           javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_H1"    column="EZUPTIMEZONE"       javaType="EZDSStringItem"/>
        <result property="struDfnDescTxt_H1"  column="STRU_DFN_DESC_TXT"  javaType="EZDSStringItem"/>
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    </resultMap>
    
    <resultMap id="result.getOrganizationParent"  class="NMAL2520_ASMsg">
        <result property="orgCd_A1"         column="ORG_CD"             javaType="EZDSStringItem"/>
        <result property="orgNm_A1"         column="ORG_NM"             javaType="EZDSStringItem"/>
        <result property="effFromDt_A1"     column="EFF_FROM_DT"        javaType="EZDCDateItem"/>
        <result property="effThruDt_A1"     column="EFF_THRU_DT"        javaType="EZDCDateItem"/>
        <result property="ezUpTime_A1"      column="EZUPTIME"           javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_A1"  column="EZUPTIMEZONE"       javaType="EZDSStringItem"/>
        <result property="firstOrgCd_A1"    column="FIRST_ORG_CD"       javaType="EZDSStringItem"/>
        <result property="orgTierCd_A1"     column="ORG_TIER_CD"        javaType="EZDSStringItem"/>
        <result property="gnrnTpCd_A1"      column="GNRN_TP_CD"         javaType="EZDSStringItem"/>
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs_A1"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm_A1"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs_A1"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm_A1"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm_A1"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
        <!-- 2017/03/06 S21_NA#17760 Add Start-->
        <result property="dsOrgRelnPk_A1"    column="DS_ORG_RELN_PK"     javaType="EZDSBigDecimalItem" />
        <!-- 2017/03/06 S21_NA#17760 Add End  -->
    </resultMap>
    
    <resultMap id="result.getOrganizationChildren"  class="NMAL2520_BSMsg">
        <result property="orgCd_B1"         column="ORG_CD"             javaType="EZDSStringItem"/>
        <result property="orgNm_B1"         column="ORG_NM"             javaType="EZDSStringItem"/>
        <result property="effFromDt_B1"     column="EFF_FROM_DT"        javaType="EZDCDateItem"/>
        <result property="effThruDt_B1"     column="EFF_THRU_DT"        javaType="EZDCDateItem"/>
        <result property="ezUpTime_B1"      column="EZUPTIME"           javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_B1"  column="EZUPTIMEZONE"       javaType="EZDSStringItem"/>
        <result property="firstOrgCd_B1"    column="FIRST_ORG_CD"       javaType="EZDSStringItem"/>
        <result property="orgTierCd_B1"     column="ORG_TIER_CD"        javaType="EZDSStringItem"/>
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs_B1"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm_B1"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs_B1"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm_B1"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm_B1"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
        <!-- 2017/03/06 S21_NA#17760 Add Start-->
        <result property="dsOrgRelnPk_B1"    column="DS_ORG_RELN_PK"     javaType="EZDSBigDecimalItem" />
        <!-- 2017/03/06 S21_NA#17760 Add End  -->
    </resultMap>
    
    <resultMap id="result.getOrganizationHierarchy"  class="NMAL2520_TSMsg">
        <result property="orgCd_T"              column="ORG_CD"                 javaType="EZDSStringItem"/>
        <result property="orgTierCd_T"          column="ORG_TIER_CD"            javaType="EZDSStringItem"/>
        <result property="orgNm_1"              column="FIRST_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_2"              column="SCD_ORG_NM"             javaType="EZDSStringItem"/>
        <result property="orgNm_3"              column="THIRD_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_4"              column="FRTH_ORG_NM"            javaType="EZDSStringItem"/>
        <result property="orgNm_5"              column="FIFTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_6"              column="SIXTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_7"              column="SVNTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_8"              column="EIGHTH_ORG_NM"          javaType="EZDSStringItem"/>
        <result property="orgNm_8"              column="NINTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_10"             column="TENTH_ORG_NM"           javaType="EZDSStringItem"/>
    </resultMap>
    
    <resultMap id="result.getResource"  class="NMAL2520_CSMsg">
        <result property="psnNum_C1"            column="PSN_NUM"               javaType="EZDSStringItem"/>
        <result property="orgFuncRoleTpCd_P1"   column="ORG_FUNC_ROLE_TP_CD"   javaType="EZDSStringItem"/>
        <result property="psnLastNm_C1"         column="PSN_LAST_NM"           javaType="EZDSStringItem"/>
        <result property="psnFirstNm_C1"        column="PSN_FIRST_NM"          javaType="EZDSStringItem"/>
        <result property="asgCustFromNm_C1"     column="ASG_CUST_FROM_NM"      javaType="EZDSStringItem"/>
        <result property="asgCustToNm_C1"       column="ASG_CUST_TO_NM"        javaType="EZDSStringItem"/>
        <result property="effFromDt_C1"         column="EFF_FROM_DT"           javaType="EZDCDateItem"/>
        <result property="effThruDt_C1"         column="EFF_THRU_DT"           javaType="EZDCDateItem"/>
        <result property="psnCd_C1"             column="PSN_CD"                javaType="EZDSStringItem"/>
        <result property="gnrnTpCd_C1"          column="GNRN_TP_CD"            javaType="EZDSStringItem"/>
        <result property="ezUpTime_U1"          column="RELN_EZUPTIME"         javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_U1"      column="RELN_EZUPTIMEZONE"     javaType="EZDSStringItem"/>
        <result property="orgStruTpCd_U1"       column="RELN_ORG_STRU_TP_CD"   javaType="EZDSStringItem"/>
        <result property="tocCd_U1"             column="RELN_TOC_CD"           javaType="EZDSStringItem"/>
        <result property="orgCd_U1"             column="RELN_ORG_CD"           javaType="EZDSStringItem"/>
        <result property="ezUpTime_U2"          column="RQST_EZUPTIME"         javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_U2"      column="RQST_EZUPTIMEZONE"     javaType="EZDSStringItem"/>
        <result property="orgChngRqstPk_U2"     column="RQST_ORG_CHNG_RQST_PK" javaType="EZDSStringItem"/>
        <result property="ezUpTime_U3"          column="ASG_EZUPTIME"          javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_U3"      column="ASG_EZUPTIMEZONE"      javaType="EZDSStringItem"/>
        <result property="psnCd_U3"             column="ASG_PSN_CD"            javaType="EZDSStringItem"/>
        <result property="effFromDt_U3"         column="ASG_EFF_FROM_DT"       javaType="EZDCDateItem"/>
        <result property="tocCd_U3"             column="ASG_TOC_CD"            javaType="EZDSStringItem"/>
        <result property="coaCmpyCd_U2"         column="REV_COA_CMPY_CD"       javaType="EZDSStringItem"/>
        <result property="coaExtnCd_U2"         column="REV_COA_EXTN_CD"       javaType="EZDSStringItem"/>
        <result property="coaBrCd_U2"           column="REV_COA_BR_CD"         javaType="EZDSStringItem"/>
        <result property="coaCcCd_U2"           column="REV_COA_CC_CD"         javaType="EZDSStringItem"/>
        <result property="effFromDt_U4"         column="PSN_EFF_FROM_DT"       javaType="EZDCDateItem"/>
        <result property="effThruDt_U4"         column="PSN_EFF_THRU_DT"       javaType="EZDCDateItem"/>
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs_C1"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm_C1"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs_C1"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm_C1"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm_C1"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="psnNum_CB"            column="PSN_NUM"               javaType="EZDSStringItem"/>
        <result property="orgFuncRoleTpCd_CB"   column="ORG_FUNC_ROLE_TP_CD"   javaType="EZDSStringItem"/>
        <result property="psnLastNm_CB"         column="PSN_LAST_NM"           javaType="EZDSStringItem"/>
        <result property="psnFirstNm_CB"        column="PSN_FIRST_NM"          javaType="EZDSStringItem"/>
        <result property="asgCustFromNm_CB"     column="ASG_CUST_FROM_NM"      javaType="EZDSStringItem"/>
        <result property="asgCustToNm_CB"       column="ASG_CUST_TO_NM"        javaType="EZDSStringItem"/>
        <result property="effFromDt_CB"         column="EFF_FROM_DT"           javaType="EZDCDateItem"/>
        <result property="effThruDt_CB"         column="EFF_THRU_DT"           javaType="EZDCDateItem"/>
        <result property="psnCd_CB"             column="PSN_CD"                javaType="EZDSStringItem"/>
        <result property="gnrnTpCd_CB"          column="GNRN_TP_CD"            javaType="EZDSStringItem"/>
    </resultMap>


    <statement id="getBizAreaOrgPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               ORG.BIZ_AREA_ORG_CD
              ,ORG.BIZ_AREA_ORG_NM
          FROM
               BIZ_AREA_ORG ORG
              ,ORG_STRU_TP STRU
         WHERE
               ORG.GLBL_CMPY_CD   = #globalCmpyCd#
           AND ORG.EZCANCELFLAG   = '0'
           AND STRU.GLBL_CMPY_CD  = #globalCmpyCd#
           AND STRU.EZCANCELFLAG  = '0'
           AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
           AND TRTY_STRU_FLG = #trtyStruFlg#
         ORDER BY
               ORG.BIZ_AREA_ORG_SORT_NUM
    </statement>

    <statement id="getOrgTierPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TIER.ORG_TIER_CD
              ,TIER.ORG_TIER_NM
          FROM
               ORG_TIER TIER
         WHERE
               TIER.GLBL_CMPY_CD  = #globalCmpyCd#
           AND TIER.EZCANCELFLAG  = '0'
           AND TIER.ORG_TIER_CD  &gt; 0
         ORDER BY
               TIER.ORG_TIER_SORT_NUM
    </statement>

    <statement id="getLineBizTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TP.LINE_BIZ_TP_CD
              ,TP.LINE_BIZ_TP_NM
          FROM
               LINE_BIZ_TP TP
         WHERE
               TP.GLBL_CMPY_CD  = #globalCmpyCd#
           AND TP.EZCANCELFLAG  = '0'
         ORDER BY
               TP.LINE_BIZ_TP_SORT_NUM
    </statement>

    <statement id="getCsrRgTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               CSR.CSR_RG_TP_CD
              ,CSR.CSR_RG_TP_NM
          FROM
               CSR_RG_TP CSR
         WHERE
               CSR.GLBL_CMPY_CD  = #globalCmpyCd#
           AND CSR.EZCANCELFLAG  = '0'
         ORDER BY
               CSR.CSR_RG_TP_SORT_NUM
    </statement>

    <statement id="getOrgFuncRoleTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               FUNC.ORG_FUNC_ROLE_TP_CD
              ,FUNC.ORG_FUNC_ROLE_TP_NM
          FROM
               ORG_FUNC_ROLE_TP FUNC
              ,BIZ_AREA_ORG BIZ
         WHERE
               FUNC.GLBL_CMPY_CD  = #globalCmpyCd#
           AND FUNC.EZCANCELFLAG  = '0'
           AND BIZ.GLBL_CMPY_CD  = #globalCmpyCd#
           AND BIZ.EZCANCELFLAG  = '0'
           AND FUNC.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
           AND BIZ.BIZ_AREA_ORG_SORT_NUM = #defaultBusinessArea#
         ORDER BY
               FUNC.ORG_FUNC_ROLE_TP_SORT_NUM
    </statement>
    
    <statement id="getOrgFuncRoleTpWithBusinessAreaPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               FUNC.ORG_FUNC_ROLE_TP_CD
              ,FUNC.ORG_FUNC_ROLE_TP_NM
          FROM
               ORG_FUNC_ROLE_TP FUNC
              ,BIZ_AREA_ORG BIZ
         WHERE
               FUNC.GLBL_CMPY_CD  = #globalCmpyCd#
           AND FUNC.EZCANCELFLAG  = '0'
           AND BIZ.GLBL_CMPY_CD  = #globalCmpyCd#
           AND BIZ.EZCANCELFLAG  = '0'
           AND FUNC.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
           <isNotNull property="cMsg.bizAreaOrgCd_P1">
           AND BIZ.BIZ_AREA_ORG_CD = #cMsg.bizAreaOrgCd_P1#
           </isNotNull>
         ORDER BY
               FUNC.ORG_FUNC_ROLE_TP_SORT_NUM
    </statement>

    <statement id="getTierDescription" parameterClass="Map" resultClass="Map">
        SELECT
            SD.STRU_DFN_DESC_TXT AS STRU_DFN_DESC_TXT
        FROM
            STRU_DFN SD 
          , ORG_HRCH_STRU_DFN OH
          , ORG_TIER OT
          , ORG_STRU_TP OST
          , BIZ_AREA_ORG BAO
        WHERE
            SD.STRU_DFN_CD      = OH.STRU_DFN_CD
        AND OH.BIZ_AREA_ORG_CD  = #cMsg.bizAreaOrgCd_P1#
        AND OH.EFF_FROM_DT  &lt;= #slsDt#
        AND (OH.EFF_THRU_DT &gt;= #slsDt# OR OH.EFF_THRU_DT IS NULL)

        AND OH.ORG_TIER_CD      = OT.ORG_TIER_CD
        AND OT.ORG_TIER_CD      = #cMsg.orgTierCd_P1#

        AND OH.ORG_STRU_TP_CD   = OST.ORG_STRU_TP_CD
        AND OST.TRTY_STRU_FLG   = 'N'

        AND OH.BIZ_AREA_ORG_CD  = BAO.BIZ_AREA_ORG_CD

        AND SD.GLBL_CMPY_CD     = #glblCmpyCd#
        AND SD.GLBL_CMPY_CD     = OH.GLBL_CMPY_CD
        AND OH.GLBL_CMPY_CD     = OT.GLBL_CMPY_CD
        AND OH.GLBL_CMPY_CD     = OST.GLBL_CMPY_CD
        AND OH.GLBL_CMPY_CD     = BAO.GLBL_CMPY_CD

        AND SD.EZCANCELFLAG     = '0'
        AND OT.EZCANCELFLAG     = '0'
        AND OH.EZCANCELFLAG     = '0'
        AND OST.EZCANCELFLAG    = '0'
        AND BAO.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getOrganization" parameterClass="Map" resultMap="result.getOrganization">
        WITH TIER_DESC AS (
        SELECT
            OT.ORG_TIER_CD       AS ORG_TIER_CD
          , SD.STRU_DFN_DESC_TXT AS STRU_DFN_DESC_TXT
          <!-- Add Start 2017/06/08 E.Kameishi QC#18038 -->
          , BAO.BIZ_AREA_ORG_CD 
          <!-- Add End 2017/06/08 E.Kameishi QC#18038 -->
        FROM
            STRU_DFN SD 
          , ORG_HRCH_STRU_DFN OH
          , ORG_TIER OT
          , ORG_STRU_TP OST
          , BIZ_AREA_ORG BAO
        WHERE
            SD.GLBL_CMPY_CD    = #glblCmpyCd#

        AND SD.STRU_DFN_CD     = OH.STRU_DFN_CD
        AND SD.GLBL_CMPY_CD    = OH.GLBL_CMPY_CD
        AND OH.EFF_FROM_DT &lt;= #slsDt#
        AND (OH.EFF_THRU_DT &gt;= #slsDt# OR OH.EFF_THRU_DT IS NULL)

        AND OH.ORG_TIER_CD     = OT.ORG_TIER_CD
        AND OH.GLBL_CMPY_CD    = OT.GLBL_CMPY_CD

        AND OH.GLBL_CMPY_CD    = OST.GLBL_CMPY_CD
        AND OH.ORG_STRU_TP_CD  = OST.ORG_STRU_TP_CD
        AND OST.TRTY_STRU_FLG  = 'N'

        AND OH.GLBL_CMPY_CD    = BAO.GLBL_CMPY_CD
        AND OH.BIZ_AREA_ORG_CD = BAO.BIZ_AREA_ORG_CD

        AND SD.EZCANCELFLAG    = '0'
        AND OH.EZCANCELFLAG    = '0'
        AND OT.EZCANCELFLAG    = '0'
        AND OST.EZCANCELFLAG   = '0'
        AND BAO.EZCANCELFLAG   = '0'
        )
   
        SELECT
             ORG.ORG_CD ORG_CD
            ,ORG.FIRST_ORG_CD
            <!-- QC#4429
            ,ORG.TRTY_GRP_TP_CD AS LINE_BIZ_TP_CD
             -->
            ,ORG.LINE_BIZ_TP_CD
            ,ORG.ORG_NM
            ,ORG.ORG_SHORT_NM
            ,ORG.ORG_DESC_TXT
            ,ORG.ORG_TIER_CD
            ,ORG.EFF_FROM_DT
            ,ORG.EFF_THRU_DT
            ,ORG.CSR_RG_TP_CD
            ,ORG.AUTO_EST_FLG
            ,ORG.ORG_STRU_TP_CD
            ,ORG.EZUPTIME
            ,ORG.EZUPTIMEZONE
            ,TIER_DESC.STRU_DFN_DESC_TXT AS STRU_DFN_DESC_TXT
            <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
            , ORG.EZINTIME             AS XX_REC_HIST_CRAT_TS
            , ORG.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
            , ORG.EZUPTIME             AS XX_REC_HIST_UPD_TS
            , ORG.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
            , 'DS_ORG_UNIT'            AS XX_REC_HIST_TBL_NM
            <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
        FROM
            DS_ORG_UNIT ORG
            ,ORG_STRU_TP STRU
            ,TIER_DESC TIER_DESC
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_TIER_CD &gt;= #firstTierCd#
        AND ORG.ORG_TIER_CD = TIER_DESC.ORG_TIER_CD(+)
        <!-- Add Start 2017/06/08 E.Kameishi QC#18038 -->
        AND ORG.FIRST_ORG_CD = TIER_DESC.BIZ_AREA_ORG_CD(+) 
        <!-- Add Start 2017/06/08 E.Kameishi QC#18038 -->
        <isNotNull property="cMsg.orgCd_H1">
        AND ORG.ORG_CD = #cMsg.orgCd_H1#
        </isNotNull>
        <isNull property="cMsg.orgCd_H1">
            <isNotNull property="cMsg.orgNm_H1">
            AND ORG.ORG_NM = #cMsg.orgNm_H1#
            </isNotNull>
            <isNull property="cMsg.orgNm_H1">
                <isNotNull property="cMsg.bizAreaOrgCd_P1">
                 AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
                 </isNotNull>
                 <isNotNull property="cMsg.lineBizTpCd_P1">
                 <!-- QC#4429
                 AND ORG.TRTY_GRP_TP_CD = #cMsg.lineBizTpCd_P1#
                 -->
                 AND ORG.LINE_BIZ_TP_CD = #cMsg.lineBizTpCd_P1#
                 </isNotNull>
                 <isNotNull property="cMsg.orgShortNm_H1">
                 AND ORG.ORG_SHORT_NM = #cMsg.orgShortNm_H1#
                 </isNotNull>
                 <isNotNull property="cMsg.orgTierCd_P1">
                 AND ORG.ORG_TIER_CD = #cMsg.orgTierCd_P1#
                 </isNotNull>
                 <isNotNull property="cMsg.effFromDt_H1">
                 AND ORG.EFF_FROM_DT &lt;= #cMsg.effFromDt_H1#
                 </isNotNull>
                 <isNotNull property="cMsg.effThruDt_H1"> 
                 AND (ORG.EFF_THRU_DT &gt;= #cMsg.effThruDt_H1#
                  OR ORG.EFF_THRU_DT IS NULL)
                 </isNotNull>
                 <isNotNull property="cMsg.csrRgTpCd_P1">
                 AND ORG.CSR_RG_TP_CD = #cMsg.csrRgTpCd_P1#
                 </isNotNull>
                 <isNotNull property="cMsg.xxChkBox_H1">
                 AND ORG.AUTO_EST_FLG = #cMsg.xxChkBox_H1#
                 </isNotNull>
           </isNull>
       </isNull>
    </statement> 

    <statement id="getOrganizationParent" parameterClass="Map" resultMap="result.getOrganizationParent">
        WITH ORG_REN AS(
            SELECT
                RELN.*
            FROM
                DS_ORG_RELN RELN
                ,ORG_STRU_TP STRU
            WHERE
                RELN.GLBL_CMPY_CD = #globalCmpyCd#
            AND RELN.EZCANCELFLAG = '0'
            AND RELN.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
            AND RELN.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
            <!-- QC#7966 -->
            <isNull property="cMsg.xxChkBox_F1">
            AND (RELN.GNRN_TP_CD = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD =#gnrnTpCdFuture#)
            </isNull>
            <isNotNull property="cMsg.xxChkBox_F1">
            AND RELN.GNRN_TP_CD  != #gnrnTpDelete#
            AND RELN.GNRN_TP_CD  != #gnrnTpTerminated#
            </isNotNull>
            AND STRU.EZCANCELFLAG = '0'
            AND STRU.TRTY_STRU_FLG = 'N'
        )
        ,ORG_PRNT AS(
            SELECT
                ORG_PRNT.*
            FROM
                DS_ORG_UNIT ORG_PRNT
                ,ORG_STRU_TP STRU
            WHERE
                ORG_PRNT.GLBL_CMPY_CD = #globalCmpyCd#
            AND ORG_PRNT.EZCANCELFLAG = '0'
            AND ORG_PRNT.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
            AND ORG_PRNT.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
            AND STRU.EZCANCELFLAG = '0'
            AND STRU.TRTY_STRU_FLG = 'N'
            <!-- QC#7966 -->
            <isNull property="cMsg.xxChkBox_F1">
            AND (ORG_PRNT.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG_PRNT.GNRN_TP_CD =#gnrnTpCdFuture#)
            </isNull>	
        )
        SELECT
             ORG_REN.PRNT_ORG_CD AS ORG_CD
            ,ORG_PRNT.ORG_NM AS ORG_NM
            ,ORG_REN.EFF_FROM_DT AS EFF_FROM_DT
            ,ORG_REN.EFF_THRU_DT AS EFF_THRU_DT
            ,ORG_REN.EZUPTIME AS EZUPTIME
            ,ORG_REN.EZUPTIMEZONE AS EZUPTIMEZONE
            ,ORG_PRNT.ORG_TIER_CD AS ORG_TIER_CD
            ,ORG_PRNT.FIRST_ORG_CD AS FIRST_ORG_CD
            ,ORG_REN.GNRN_TP_CD AS GNRN_TP_CD
            <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
            , ORG_REN.EZINTIME             AS XX_REC_HIST_CRAT_TS
            , ORG_REN.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
            , ORG_REN.EZUPTIME             AS XX_REC_HIST_UPD_TS
            , ORG_REN.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
            , 'DS_ORG_RELN'                AS XX_REC_HIST_TBL_NM
            <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
            <!-- 2017/03/06 S21_NA#17760 Add Start-->
            , ORG_REN.DS_ORG_RELN_PK AS DS_ORG_RELN_PK
            <!-- 2017/03/06 S21_NA#17760 Add End  -->
        FROM
            DS_ORG_UNIT ORG
            ,ORG_REN
            ,ORG_PRNT
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #globalCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND ORG.GLBL_CMPY_CD = ORG_REN.GLBL_CMPY_CD
        AND ORG.ORG_CD = ORG_REN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = ORG_REN.ORG_STRU_TP_CD
        AND ORG_REN.GLBL_CMPY_CD = ORG_PRNT.GLBL_CMPY_CD
        AND ORG_REN.PRNT_ORG_CD = ORG_PRNT.ORG_CD
        AND ORG_REN.ORG_STRU_TP_CD = ORG_PRNT.ORG_STRU_TP_CD
        AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.EZCANCELFLAG = '0'
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_CD = #cMsg.orgCd_H1#
        AND ORG_PRNT.ORG_TIER_CD &gt;= #firstTierCd#
        ORDER BY
            ORG_REN.PRNT_ORG_CD, ORG_REN.EFF_FROM_DT DESC
    </statement>

<!-- QC#7966    
    <statement id="getOrganizationParentWithFilter" parameterClass="Map" resultMap="result.getOrganizationParent">
        WITH ORG_REN AS(
            SELECT
                RELN.*
            FROM
                DS_ORG_RELN RELN
                ,ORG_STRU_TP STRU
            WHERE
                RELN.GLBL_CMPY_CD = #globalCmpyCd#
            AND RELN.EZCANCELFLAG = '0'
            AND RELN.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
            AND RELN.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
            AND STRU.EZCANCELFLAG = '0'
            AND STRU.TRTY_STRU_FLG = 'N'
            AND RELN.GNRN_TP_CD = #gnrnTpCd_Current#
        )
        ,ORG_PRNT AS(
            SELECT
                ORG_PRNT.*
            FROM
                DS_ORG_UNIT ORG_PRNT
                ,ORG_STRU_TP STRU
            WHERE
                ORG_PRNT.GLBL_CMPY_CD = #globalCmpyCd#
            AND ORG_PRNT.EZCANCELFLAG = '0'
            AND ORG_PRNT.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
            AND ORG_PRNT.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
            AND STRU.EZCANCELFLAG = '0'
            AND STRU.TRTY_STRU_FLG = 'N'
            AND ORG_PRNT.GNRN_TP_CD = #gnrnTpCd_Current#
        )
        SELECT
             ORG_REN.PRNT_ORG_CD AS ORG_CD
            ,ORG_PRNT.ORG_NM AS ORG_NM
            ,ORG_REN.EFF_FROM_DT AS EFF_FROM_DT
            ,ORG_REN.EFF_THRU_DT AS EFF_THRU_DT
            ,ORG_REN.EZUPTIME AS EZUPTIME
            ,ORG_REN.EZUPTIMEZONE AS EZUPTIMEZONE
            ,ORG_PRNT.ORG_TIER_CD AS ORG_TIER_CD
            ,ORG_PRNT.FIRST_ORG_CD AS FIRST_ORG_CD
        FROM
            DS_ORG_UNIT ORG
            ,ORG_REN
            ,ORG_PRNT
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #globalCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND ORG.GLBL_CMPY_CD = ORG_REN.GLBL_CMPY_CD
        AND ORG.ORG_CD = ORG_REN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = ORG_REN.ORG_STRU_TP_CD
        AND ORG_REN.GLBL_CMPY_CD = ORG_PRNT.GLBL_CMPY_CD
        AND ORG_REN.PRNT_ORG_CD = ORG_PRNT.ORG_CD
        AND ORG_REN.ORG_STRU_TP_CD = ORG_PRNT.ORG_STRU_TP_CD
        AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.EZCANCELFLAG = '0'
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_CD = #cMsg.orgCd_H1#
        AND ORG_PRNT.ORG_TIER_CD &gt;= #firstTierCd#
        ORDER BY
            ORG_REN.PRNT_ORG_CD, ORG_REN.EFF_FROM_DT DESC
    </statement>
 -->
    
    <statement id="getOrganizationChildren" parameterClass="Map" resultMap="result.getOrganizationChildren">
        WITH ORG_REN AS(
            SELECT
                RELN.*
            FROM
                DS_ORG_RELN RELN
                ,ORG_STRU_TP STRU
            WHERE
                RELN.GLBL_CMPY_CD = #globalCmpyCd#
            AND RELN.EZCANCELFLAG = '0'
            AND RELN.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
            AND RELN.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
            <!-- QC#7966 -->
            <isNull property="cMsg.xxChkBox_F1">
            AND (RELN.GNRN_TP_CD = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD =#gnrnTpCdFuture#)
            </isNull>
            <isNotNull property="cMsg.xxChkBox_F1">
            AND RELN.GNRN_TP_CD  != #gnrnTpDelete#
            AND RELN.GNRN_TP_CD  != #gnrnTpTerminated#
            </isNotNull>
            AND STRU.EZCANCELFLAG = '0'
            AND STRU.TRTY_STRU_FLG = 'N'
        )
        ,ORG_CHLD AS(
            SELECT
                ORG_CHLD.*
            FROM
                DS_ORG_UNIT ORG_CHLD
                ,ORG_STRU_TP STRU
            WHERE
                ORG_CHLD.GLBL_CMPY_CD = #globalCmpyCd#
            AND ORG_CHLD.EZCANCELFLAG = '0'
            AND ORG_CHLD.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
            AND ORG_CHLD.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
            AND STRU.EZCANCELFLAG = '0'
            AND STRU.TRTY_STRU_FLG = 'N'
            <!-- QC#7966 -->
            <isNull property="cMsg.xxChkBox_F1">
            AND (ORG_CHLD.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG_CHLD.GNRN_TP_CD =#gnrnTpCdFuture#)
            </isNull>	
        )
        SELECT
             ORG_CHLD.ORG_CD AS ORG_CD
            ,ORG_CHLD.ORG_NM AS ORG_NM
            ,ORG_REN.EFF_FROM_DT AS EFF_FROM_DT
            ,ORG_REN.EFF_THRU_DT AS EFF_THRU_DT
            ,ORG_REN.EZUPTIME AS EZUPTIME
            ,ORG_REN.EZUPTIMEZONE AS EZUPTIMEZONE
            ,ORG_CHLD.ORG_TIER_CD AS ORG_TIER_CD
            ,ORG_CHLD.FIRST_ORG_CD AS FIRST_ORG_CD
            <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
            , ORG_REN.EZINTIME             AS XX_REC_HIST_CRAT_TS
            , ORG_REN.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
            , ORG_REN.EZUPTIME             AS XX_REC_HIST_UPD_TS
            , ORG_REN.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
            , 'DS_ORG_RELN'                AS XX_REC_HIST_TBL_NM
            <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
            <!-- 2017/03/06 S21_NA#17760 Add Start-->
            , ORG_REN.DS_ORG_RELN_PK AS DS_ORG_RELN_PK
            <!-- 2017/03/06 S21_NA#17760 Add End  -->
        FROM
            DS_ORG_UNIT ORG
            ,ORG_REN
            ,ORG_CHLD
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #globalCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND ORG.GLBL_CMPY_CD = ORG_REN.GLBL_CMPY_CD
        AND ORG.ORG_CD = ORG_REN.PRNT_ORG_CD
        AND ORG.ORG_STRU_TP_CD = ORG_REN.ORG_STRU_TP_CD
        AND ORG_REN.GLBL_CMPY_CD = ORG_CHLD.GLBL_CMPY_CD
        AND ORG_REN.ORG_CD = ORG_CHLD.ORG_CD
        AND ORG_REN.ORG_STRU_TP_CD = ORG_CHLD.ORG_STRU_TP_CD
        AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.EZCANCELFLAG = '0'
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_CD = #orgCd#
        AND ORG_CHLD.ORG_TIER_CD &gt;= #firstTierCd#
        ORDER BY
            ORG_REN.ORG_CD, ORG_REN.EFF_FROM_DT DESC
    </statement>

    <statement id="getOrganizationHierarchy" parameterClass="Map" resultMap="result.getOrganizationHierarchy">
    WITH WRK AS(
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,RELN.PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
        FROM
            DS_ORG_UNIT ORG
            ,DS_ORG_RELN RELN
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #globalCmpyCd#
        AND RELN.GLBL_CMPY_CD = #globalCmpyCd#
        AND STRU.GLBL_CMPY_CD = #globalCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        AND (RELN.GNRN_TP_CD = #gnrnTpCd_Current# OR RELN.GNRN_TP_CD = #gnrnTpCd_Future#)
        AND (ORG.GNRN_TP_CD = #gnrnTpCd_Current# OR ORG.GNRN_TP_CD =#gnrnTpCd_Future#)
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        UNION ALL
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,ORG.ORG_CD AS PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
        FROM
            DS_ORG_UNIT ORG
           ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #globalCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.GLBL_CMPY_CD = #globalCmpyCd#
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG ='N'
        AND ORG.ORG_TIER_CD = '0'
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
    )
    
    ,ORG1 AS(SELECT * FROM WRK)
    ,ORG2 AS(SELECT * FROM WRK)
    ,ORG3 AS(SELECT * FROM WRK)
    ,ORG4 AS(SELECT * FROM WRK)
    ,ORG5 AS(SELECT * FROM WRK)
    ,ORG6 AS(SELECT * FROM WRK)
    ,ORG7 AS(SELECT * FROM WRK)
    ,ORG8 AS(SELECT * FROM WRK)
    ,ORG9 AS(SELECT * FROM WRK)
    ,ORG10 AS(SELECT * FROM WRK)
    
    ,HIERARCHY AS(
        SELECT
            ORG1.ORG_CD
            ,ORG1.ORG_TIER_CD
            ,ORG1.ORG_STRU_TP_CD
            --FIRST
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.ORG_NM
            END AS FIRST_ORG_NM
            --THIRD          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.ORG_NM
            END AS SCD_ORG_NM
            --FRTH          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.ORG_NM
            END AS THIRD_ORG_NM
            --FIFTH         
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.ORG_NM
            END AS FRTH_ORG_NM
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.ORG_NM
            END AS FIFTH_ORG_NM
            --SVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.ORG_NM
            END AS SIXTH_ORG_NM
            --EIGHTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.ORG_NM
            END AS SVNTH_ORG_NM
            --NINTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.ORG_NM
            END AS EIGHTH_ORG_NM
            --TENTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.ORG_NM
            END AS NINTH_ORG_NM
            --ELEVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.ORG_NM
            END AS TENTH_ORG_NM
        FROM
            ORG1
            ,ORG2
            ,ORG3
            ,ORG4
            ,ORG5
            ,ORG6
            ,ORG7
            ,ORG8
            ,ORG9
            ,ORG10
        WHERE
            ORG1.PRNT_ORG_CD = ORG2.ORG_CD
        AND ORG2.PRNT_ORG_CD = ORG3.ORG_CD
        AND ORG3.PRNT_ORG_CD = ORG4.ORG_CD
        AND ORG4.PRNT_ORG_CD = ORG5.ORG_CD
        AND ORG5.PRNT_ORG_CD = ORG6.ORG_CD
        AND ORG6.PRNT_ORG_CD = ORG7.ORG_CD
        AND ORG7.PRNT_ORG_CD = ORG8.ORG_CD
        AND ORG8.PRNT_ORG_CD = ORG9.ORG_CD
        AND ORG9.PRNT_ORG_CD = ORG10.ORG_CD
        UNION ALL
        -- Obtain Organization that do not have parent
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
        FROM
            DS_ORG_UNIT ORG
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #globalCmpyCd#
        AND STRU.GLBL_CMPY_CD = #globalCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        <!-- 2016/10/03 QC#14756 Add Start -->
        AND (ORG.GNRN_TP_CD = #gnrnTpCd_Current# OR ORG.GNRN_TP_CD =#gnrnTpCd_Future#)
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        <!-- 2016/10/03 QC#14756 Add End -->
        AND STRU.TRTY_STRU_FLG = 'N'
        AND NOT EXISTS(
                SELECT
                    1
                FROM
                    DS_ORG_RELN RELN
                WHERE
                    RELN.GLBL_CMPY_CD = #globalCmpyCd#
                AND RELN.EZCANCELFLAG = '0'
                AND RELN.ORG_CD = ORG.ORG_CD
                AND RELN.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
                <!-- 2016/10/03 QC#14756 Add Start -->
                AND (RELN.GNRN_TP_CD = #gnrnTpCd_Current# OR RELN.GNRN_TP_CD = #gnrnTpCd_Future#)
                <!-- 2016/10/03 QC#14756 Add End -->
                AND ORG.ORG_TIER_CD &gt;= #firstTierCd#
            )
    )
    
    SELECT
         H.ORG_CD
        ,H.ORG_TIER_CD
        ,H.FIRST_ORG_NM
        ,H.SCD_ORG_NM
        ,H.THIRD_ORG_NM
        ,H.FRTH_ORG_NM
        ,H.FIFTH_ORG_NM
        ,H.SIXTH_ORG_NM
        ,H.SVNTH_ORG_NM
        ,H.EIGHTH_ORG_NM
        ,H.NINTH_ORG_NM
        ,H.TENTH_ORG_NM
    FROM
        HIERARCHY H
    WHERE
        H.ORG_TIER_CD &gt;= #firstTierCd#
    ORDER BY
        FIRST_ORG_NM NULLS FIRST
        ,SCD_ORG_NM NULLS FIRST
        ,THIRD_ORG_NM NULLS FIRST
        ,FRTH_ORG_NM NULLS FIRST
        ,FIFTH_ORG_NM NULLS FIRST
        ,SIXTH_ORG_NM NULLS FIRST
        ,SVNTH_ORG_NM NULLS FIRST
        ,EIGHTH_ORG_NM NULLS FIRST
        ,NINTH_ORG_NM NULLS FIRST
        ,TENTH_ORG_NM NULLS FIRST
        ,ORG_TIER_CD
    </statement>

    <statement id="getResource" parameterClass="Map" resultMap="result.getResource">
    SELECT
          ORG_UNIT.PSN_NUM
        , ORG_UNIT.ORG_FUNC_ROLE_TP_CD
        , ORG_UNIT.PSN_LAST_NM
        , ORG_UNIT.PSN_FIRST_NM
        , ORG_UNIT.ASG_CUST_FROM_NM
        , ORG_UNIT.ASG_CUST_TO_NM
        , ORG_UNIT.EFF_FROM_DT
        , ORG_UNIT.EFF_THRU_DT
        , ORG_UNIT.PSN_CD
        , ORG_UNIT.RELN_EZUPTIME
        , ORG_UNIT.RELN_EZUPTIMEZONE
        , ORG_UNIT.RELN_ORG_STRU_TP_CD
        , ORG_UNIT.RELN_TOC_CD
        , ORG_UNIT.RELN_ORG_CD
        , ORG_UNIT.RQST_EZUPTIME
        , ORG_UNIT.RQST_EZUPTIMEZONE
        , ORG_UNIT.RQST_ORG_CHNG_RQST_PK
        , ORG_UNIT.ASG_EZUPTIME
        , ORG_UNIT.ASG_EZUPTIMEZONE
        , ORG_UNIT.ASG_PSN_CD
        , ORG_UNIT.ASG_TOC_CD
        , ORG_UNIT.ASG_EFF_FROM_DT
        , ORG_UNIT.GNRN_TP_CD
        , ORG_UNIT.PSN_EFF_FROM_DT
        , ORG_UNIT.PSN_EFF_THRU_DT
        , ORG_UNIT.XX_REC_HIST_CRAT_TS
        , ORG_UNIT.XX_REC_HIST_CRAT_BY_NM
        , ORG_UNIT.XX_REC_HIST_UPD_TS
        , ORG_UNIT.XX_REC_HIST_UPD_BY_NM
        , ORG_UNIT.XX_REC_HIST_TBL_NM

    FROM (
        SELECT
             PSN.PSN_NUM
            ,RQST.ORG_FUNC_ROLE_TP_CD
            ,PSN.PSN_LAST_NM
            ,PSN.PSN_FIRST_NM
            ,RQST.ASG_CUST_FROM_NM
            ,RQST.ASG_CUST_TO_NM
            ,ASG.EFF_FROM_DT
            ,ASG.EFF_THRU_DT
            ,PSN.PSN_CD AS PSN_CD
            ,RELN.EZUPTIME AS RELN_EZUPTIME
            ,RELN.EZUPTIMEZONE AS RELN_EZUPTIMEZONE
            ,RELN.ORG_STRU_TP_CD AS RELN_ORG_STRU_TP_CD
            ,RELN.TOC_CD AS RELN_TOC_CD
            ,RELN.ORG_CD AS RELN_ORG_CD
            ,RQST.EZUPTIME AS RQST_EZUPTIME
            ,RQST.EZUPTIMEZONE AS RQST_EZUPTIMEZONE
            ,RQST.ORG_CHNG_RQST_PK AS RQST_ORG_CHNG_RQST_PK
            ,ASG.EZUPTIME AS ASG_EZUPTIME
            ,ASG.EZUPTIMEZONE AS ASG_EZUPTIMEZONE
            ,ASG.PSN_CD AS ASG_PSN_CD
            ,ASG.TOC_CD AS ASG_TOC_CD
            ,ASG.EFF_FROM_DT AS ASG_EFF_FROM_DT
            ,ASG.GNRN_TP_CD AS GNRN_TP_CD
            ,PSN.EFF_FROM_DT AS PSN_EFF_FROM_DT
            ,PSN.EFF_THRU_DT AS PSN_EFF_THRU_DT
            <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
            , ASG.EZINTIME             AS XX_REC_HIST_CRAT_TS
            , ASG.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
            , ASG.EZUPTIME             AS XX_REC_HIST_UPD_TS
            , ASG.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
            , 'ORG_FUNC_ASG'           AS XX_REC_HIST_TBL_NM
            <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
        FROM
            DS_ORG_UNIT ORG
            ,TOC_ORG_STRU_RELN RELN
            ,ORG_TOC_CHNG_RQST RQST
            ,ORG_FUNC_ASG ASG
            ,S21_PSN PSN
        WHERE
            ORG.GLBL_CMPY_CD = #globalCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.GLBL_CMPY_CD = #globalCmpyCd#
        AND RELN.EZCANCELFLAG = '0'
        AND RQST.GLBL_CMPY_CD = #globalCmpyCd#
        AND RQST.EZCANCELFLAG = '0'
        AND ASG.GLBL_CMPY_CD = #globalCmpyCd#
        AND ASG.EZCANCELFLAG = '0'
        AND PSN.GLBL_CMPY_CD = #globalCmpyCd#
        AND PSN.EZCANCELFLAG = '0'
        AND ORG.ORG_CD = #cMsg.orgCd_H1#
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        AND RELN.TOC_CD = RQST.TOC_CD
        AND RELN.ORG_CD = RQST.ORG_CD
        <!-- QC#7966 -->
        <isNull property="cMsg.xxChkBox_F2">
        AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD =#gnrnTpCdFuture#)
        </isNull>
        AND ASG.GNRN_TP_CD != #gnrnTpDelete#
        AND ASG.GNRN_TP_CD != #gnrnTpTerminated#
        AND RQST.TOC_CD = ASG.TOC_CD
        AND ASG.PSN_CD = PSN.PSN_CD
        ORDER BY
            PSN.PSN_NUM, ASG.EFF_FROM_DT DESC
    ) ORG_UNIT
      WHERE
          ROWNUM                   &lt;=   #limitCount#
    </statement>

    <statement id="getResourceForBackFromPopup" parameterClass="Map" resultClass="Map">
        SELECT
             PSN.PSN_NUM              AS PSN_NUM
            ,RQST.ORG_FUNC_ROLE_TP_CD AS ORG_FUNC_ROLE_TP_CD
            ,PSN.PSN_LAST_NM          AS PSN_LAST_NM
            ,PSN.PSN_FIRST_NM         AS PSN_FIRST_NM
            ,RQST.ASG_CUST_FROM_NM    AS ASG_CUST_FROM_NM
            ,RQST.ASG_CUST_TO_NM      AS ASG_CUST_TO_NM
            ,ASG.EFF_FROM_DT          AS EFF_FROM_DT
            ,ASG.EFF_THRU_DT          AS EFF_THRU_DT
            ,PSN.PSN_CD               AS PSN_CD
            ,RELN.EZUPTIME            AS EZUPTIME_U1
            ,RELN.EZUPTIMEZONE        AS EZUPTIMEZONE_U1
            ,RELN.ORG_STRU_TP_CD      AS RELN_ORG_STRU_TP_CD
            ,RELN.TOC_CD              AS RELN_TOC_CD
            ,RELN.ORG_CD              AS RELN_ORG_CD
            ,RQST.EZUPTIME            AS EZUPTIME_U2
            ,RQST.EZUPTIMEZONE        AS EZUPTIMEZONE_U2
            ,RQST.ORG_CHNG_RQST_PK    AS RQST_ORG_CHNG_RQST_PK
            ,ASG.EZUPTIME             AS EZUPTIME_U3
            ,ASG.EZUPTIMEZONE         AS EZUPTIMEZONE_U3
            ,ASG.PSN_CD               AS ASG_PSN_CD
            ,ASG.TOC_CD               AS ASG_TOC_CD
            ,ASG.EFF_FROM_DT          AS ASG_EFF_FROM_DT
            ,ASG.GNRN_TP_CD           AS GNRN_TP_CD
        FROM
            DS_ORG_UNIT ORG
            ,TOC_ORG_STRU_RELN RELN
            ,ORG_TOC_CHNG_RQST RQST
            ,ORG_FUNC_ASG ASG
            ,S21_PSN PSN
        WHERE
            ORG.GLBL_CMPY_CD = #globalCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.GLBL_CMPY_CD = #globalCmpyCd#
        AND RELN.EZCANCELFLAG = '0'
        AND RQST.GLBL_CMPY_CD = #globalCmpyCd#
        AND RQST.EZCANCELFLAG = '0'
        AND ASG.GLBL_CMPY_CD = #globalCmpyCd#
        AND ASG.EZCANCELFLAG = '0'
        AND PSN.GLBL_CMPY_CD = #globalCmpyCd#
        AND PSN.EZCANCELFLAG = '0'
        AND ORG.ORG_CD = #cMsg.orgCd_H1#
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        AND RELN.TOC_CD = RQST.TOC_CD
        AND RELN.ORG_CD = RQST.ORG_CD
        AND RQST.TOC_CD = ASG.TOC_CD
        AND ASG.PSN_CD = PSN.PSN_CD
        ORDER BY
            PSN.PSN_NUM, ASG.EFF_FROM_DT DESC
    </statement>

    <statement id="checkSalesRoll" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*) CNT
    FROM
        ORG_FUNC_ROLE_TP ROLE
       ,BIZ_AREA_ORG AREA
       ,ORG_STRU_TP STRU
    WHERE
        ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.EZCANCELFLAG = '0'
    AND AREA.GLBL_CMPY_CD = #glblCmpyCd#
    AND AREA.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
    AND AREA.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND AREA.SLS_FLG = 'Y'
    AND AREA.BIZ_AREA_ORG_CD = ROLE.FIRST_ORG_CD
    </statement>
    
    <statement id="checkActiveSalesRepRoll" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*) CNT
    FROM
        ORG_FUNC_ROLE_TP ROLE
       ,BIZ_AREA_ORG AREA
       ,ORG_STRU_TP STRU
    WHERE
        ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.EZCANCELFLAG = '0'
    AND AREA.GLBL_CMPY_CD = #glblCmpyCd#
    AND AREA.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
    AND AREA.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND AREA.SLS_FLG = 'Y'
    AND AREA.BIZ_AREA_ORG_CD = ROLE.FIRST_ORG_CD
    <!-- QC#3509
    AND ROLE.SLS_REP_FLG = 'Y'
     -->
    AND ROLE.ACTV_FLG = 'Y'
    AND ROLE.SLS_REP_FLG = 'Y' <!-- QC#15140-2 MOD-->
    </statement>
    
    <!-- QC#3509 -->
    <statement id="getActiveSalesRepRollByPsnCd" parameterClass="Map" resultClass="Map">
    SELECT DISTINCT
        RELN.ORG_CD
       ,ASG.EFF_FROM_DT AS EFF_FROM_DT
       ,ASG.EFF_THRU_DT AS EFF_THRU_DT
    FROM
        S21_PSN PSN
       ,ORG_FUNC_ASG ASG
       ,ORG_TOC_CHNG_RQST RQST
       ,TOC_ORG_STRU_RELN RELN
       ,DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
       ,BIZ_AREA_ORG BIZ
       ,ORG_FUNC_ROLE_TP ROLE
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND ASG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ASG.EZCANCELFLAG = '0'
    AND RQST.GLBL_CMPY_CD = #glblCmpyCd#
    AND RQST.EZCANCELFLAG = '0'
    AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
    AND RELN.EZCANCELFLAG = '0'
    AND ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND BIZ.GLBL_CMPY_CD = #glblCmpyCd#
    AND BIZ.EZCANCELFLAG = '0'
    AND ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.EZCANCELFLAG = '0'
    AND PSN.PSN_CD = #psnCd#
    AND PSN.PSN_CD = ASG.PSN_CD
    AND ASG.TOC_CD = RQST.TOC_CD
    AND RQST.TOC_CD = RELN.TOC_CD
    AND RQST.ORG_CD = RELN.ORG_CD
    AND ORG.ORG_CD = RELN.ORG_CD
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'N'
    AND ORG.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
    AND ORG.ORG_STRU_TP_CD = BIZ.ORG_STRU_TP_CD
    AND BIZ.BIZ_AREA_ORG_CD = #bizAreaOrgCd#
    AND BIZ.SLS_FLG = 'Y'
    AND RQST.ORG_FUNC_ROLE_TP_CD = ROLE.ORG_FUNC_ROLE_TP_CD
    AND ROLE.ACTV_FLG = 'Y'
    AND ROLE.SLS_REP_FLG = 'Y'<!-- QC#15140-3 ADD-->
    </statement>
    
    <statement id="checkActiveResourceRevenue" parameterClass="Map" resultClass="Map">
    SELECT
        REV.REV_ACCT_TP_CD AS REV_ACCT_TP_CD
    FROM
        DS_ORG_RESRC_REV REV
    WHERE
        REV.GLBL_CMPY_CD = #glblCmpyCd#
    AND REV.EZCANCELFLAG = '0'
    AND REV.PSN_CD = #psnCd#
    AND REV.EFF_FROM_DT &lt;= #slsDt#
    AND (REV.EFF_THRU_DT &gt;= #slsDt# OR REV.EFF_THRU_DT IS NULL)
    </statement>
    
    <statement id="getResourceAdditional" parameterClass="Map" resultClass="Map">
    WITH REVENUE AS (
        SELECT
          REV.PSN_CD
         ,REV.COA_CMPY_CD
         ,REV.COA_EXTN_CD
         ,REV.COA_BR_CD
         ,REV.COA_CC_CD
        FROM
          DS_ORG_RESRC_REV REV
         ,REV_ACCT_TP TP
        WHERE
            REV.GLBL_CMPY_CD = #glblCmpyCd#
        AND REV.EZCANCELFLAG = '0'
        AND TP.GLBL_CMPY_CD = #glblCmpyCd#
        AND TP.EZCANCELFLAG = '0'
        AND REV.REV_ACCT_TP_CD = TP.REV_ACCT_TP_CD
        AND TP.REV_COA_FLG = 'Y'
        AND REV.EFF_FROM_DT &lt;= #slsDt#
        AND (REV.EFF_THRU_DT &gt;= #slsDt# OR REV.EFF_THRU_DT IS NULL)
        )
    
    SELECT
        PSN.PSN_CD AS PSN_CD
        ,PSN.PSN_FIRST_NM AS PSN_FIRST_NM
        ,PSN.PSN_LAST_NM AS PSN_LAST_NM
        ,PSN.EFF_FROM_DT AS EFF_FROM_DT
        ,PSN.EFF_THRU_DT AS EFF_THRU_DT
        ,REV.COA_CMPY_CD AS COA_CMPY_CD
        ,REV.COA_EXTN_CD AS COA_EXTN_CD
        ,REV.COA_BR_CD AS COA_BR_CD
        ,REV.COA_CC_CD AS COA_CC_CD
    FROM
        S21_PSN PSN
        ,REVENUE REV
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND PSN.PSN_CD = #psnCd#
    AND PSN.PSN_CD = REV.PSN_CD(+)
    </statement>
    
    <statement id="getOrganizationAdditional" parameterClass="Map" resultClass="Map">
    SELECT
        ORG.ORG_CD
        ,ORG.ORG_STRU_TP_CD
        ,ORG.ORG_TIER_CD
        ,ORG.FIRST_ORG_CD
    FROM
        DS_ORG_UNIT ORG
        ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND ORG.ORG_CD = #orgCd#
    AND ROWNUM = 1
    </statement>

    <statement id="getOrganizationByName" parameterClass="Map" resultClass="Map">
    SELECT
         ORG.ORG_CD
        ,ORG.ORG_STRU_TP_CD
        ,ORG.ORG_TIER_CD
        ,ORG.FIRST_ORG_CD
    FROM
         DS_ORG_UNIT ORG
        ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND ORG.ORG_NM = #orgNm#
    AND ROWNUM = 1
    </statement>
        
    <statement id="getOrganizationForAddChild" parameterClass="Map" resultClass="Map">
    SELECT
        ORG.ORG_CD
        ,ORG.ORG_STRU_TP_CD
        ,ORG.ORG_TIER_CD
        ,ORG.FIRST_ORG_CD
    FROM
        DS_ORG_UNIT ORG
        ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND ORG.ORG_NM = #orgNm#
    </statement>
    
    <statement id="checkBusinessAreaRoll" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*)
    FROM
        BIZ_AREA_ORG BIZ
       ,ORG_FUNC_ROLE_TP ROLE
       ,ORG_STRU_TP STRU
    WHERE
        BIZ.GLBL_CMPY_CD = #glblCmpyCd#
    AND BIZ.EZCANCELFLAG = '0'
    AND ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND BIZ.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND BIZ.BIZ_AREA_ORG_CD = ROLE.FIRST_ORG_CD
    AND BIZ.BIZ_AREA_ORG_CD = #bizAreaOrgCd#
    AND ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
    </statement>

    <statement id="getZeroTierOrg" parameterClass="Map" resultClass="Map">
    SELECT
        ORG.ORG_CD
        ,ORG.EFF_FROM_DT
        ,ORG.EFF_THRU_DT
        ,ORG.GNRN_TP_CD
    FROM
        DS_ORG_UNIT ORG
        ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND ORG.ORG_TIER_CD = #orgTierCd#
    AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
    </statement>
    
    <statement id="getDefaultRevenue" parameterClass="Map" resultClass="Map">
    SELECT
        REV.COA_CMPY_CD
       ,REV.COA_EXTN_CD
       ,REV.COA_BR_CD
       ,REV.COA_CC_CD
    FROM
        DS_ORG_RESRC_REV REV
       ,REV_ACCT_TP TP
    WHERE
        REV.GLBL_CMPY_CD = #glblCmpyCd#
    AND REV.EZCANCELFLAG = '0'
    AND TP.GLBL_CMPY_CD = #glblCmpyCd#
    AND TP.EZCANCELFLAG = '0'
    AND REV.PSN_CD = #psnCd#
    AND REV.REV_ACCT_TP_CD = TP.REV_ACCT_TP_CD
    AND TP.REV_COA_FLG = #revCoaFlg#
    AND REV.EFF_FROM_DT &lt;= #slsDt#
    AND (REV.EFF_THRU_DT &gt;= #slsDt# OR REV.EFF_THRU_DT IS NULL)
    AND ROWNUM = 1
    </statement>
    
    <statement id="checkDuplicateOrganizationName" parameterClass="Map" resultClass="Map">
    SELECT
        ORG.ORG_CD
    FROM
        DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.ORG_NM = #orgNm#
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    </statement>

    <statement id="checkActiveChildOrganization" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(R.ORG_CD)
    FROM
        DS_ORG_RELN R
    WHERE
        R.GLBL_CMPY_CD       = #glblCmpyCd#
    AND R.EZCANCELFLAG       = 0
    AND (
                (   R.EFF_FROM_DT                  &lt;= #effFromDt#
                AND NVL(R.EFF_THRU_DT, #maxEffDt#) &gt;= #effFromDt#
                )
         <isNotNull property="effThruDt">
            AND  (  R.EFF_FROM_DT                  &lt;= #effThruDt#
                AND NVL(R.EFF_THRU_DT, #maxEffDt#) &gt;= #effThruDt#
                )
        </isNotNull>
        )
    AND R.GNRN_TP_CD IN (#gnrnTpCd_Future#, #gnrnTpCd_Current#)
    START WITH R.PRNT_ORG_CD = #orgCd#
    CONNECT BY NOCYCLE PRIOR
            R.ORG_CD       = R.PRNT_ORG_CD
        AND R.GLBL_CMPY_CD = #glblCmpyCd#
        AND R.EZCANCELFLAG = 0
        AND (
                    (   R.EFF_FROM_DT                  &lt;= #effFromDt#
                    AND NVL(R.EFF_THRU_DT, #maxEffDt#) &gt;= #effFromDt#
                    )
             <isNotNull property="effThruDt">
                AND  (  R.EFF_FROM_DT                  &lt;= #effThruDt#
                    AND NVL(R.EFF_THRU_DT, #maxEffDt#) &gt;= #effThruDt#
                    )
            </isNotNull>
            )
        AND R.GNRN_TP_CD IN (#gnrnTpCd_Future#, #gnrnTpCd_Current#)
    </statement>

    <statement id="isManagerRole" parameterClass="Map" resultClass="Integer">
    SELECT
       COUNT(ROLE.ORG_FUNC_ROLE_TP_CD)
    FROM 
       ORG_FUNC_ROLE_TP ROLE
    WHERE
        ROLE.GLBL_CMPY_CD        =  #glblCmpyCd#
    AND ROLE.ORG_FUNC_ROLE_TP_CD =  #orgFuncRoleTpCd#
    AND ROLE.MGR_FLG             =  #flgOnY#
    AND ROLE.EZCANCELFLAG        =  0
    </statement>

    <statement id="isOrgCurrentOrFuture" parameterClass="Map" resultClass="Integer">
    SELECT 
        COUNT(D.ORG_CD)
    FROM
        DS_ORG_UNIT D
    WHERE
        D.ORG_CD                             = #orgCd#
    AND D.GLBL_CMPY_CD                       = #glblCmpyCd#
    AND D.GNRN_TP_CD                        IN (#gnrnTp_Future#, #gnrnTp_Current#)
    AND D.EFF_FROM_DT                    &lt;= #salesDate#
    AND NVL(D.EFF_THRU_DT, #maxEffDate#) &gt;= #salesDate#
    AND D.EZCANCELFLAG                       = 0
    </statement>

    <statement id="getTopTierParentOrganization" parameterClass="Map" resultClass="String">
        WITH STRU AS
               (
                    SELECT
                        R.PRNT_ORG_CD
                      , U.ORG_TIER_CD
                    FROM
                        DS_ORG_RELN R
                      , DS_ORG_UNIT U
                    WHERE
                        R.GLBL_CMPY_CD                     =  #glblCmpyCd#
                    AND U.GLBL_CMPY_CD                     =  #glblCmpyCd#
                    AND R.EZCANCELFLAG                     =  0
                    AND U.EZCANCELFLAG                     =  0
                    AND R.ORG_CD                           =  U.ORG_CD
                    AND U.EFF_FROM_DT                  &lt;=  #slsDt#
                    AND NVL(U.EFF_THRU_DT, #maxEffDt#) &gt;=  #slsDt#

                    START WITH
                        R.ORG_CD                           =
                           ( SELECT 
                                 DR.ORG_CD
                             FROM
                                 DS_ORG_RELN DR
                             WHERE
                                 DR.GLBL_CMPY_CD                     =  #glblCmpyCd#
                             AND DR.EZCANCELFLAG                     =  '0'
                             AND DR.ORG_CD                           =  #orgCd#
                             AND DR.EFF_FROM_DT                  &lt;=  #slsDt#
                             AND NVL(DR.EFF_THRU_DT, #maxEffDt#) &gt;=  #slsDt#
                             AND DR.GNRN_TP_CD                      IN (#gnrnTp_Current#, #gnrnTp_Future#)
                           )
                    CONNECT BY NOCYCLE PRIOR
                        R.PRNT_ORG_CD                      =  R.ORG_CD
                    AND R.EZCANCELFLAG                     =  0
                    AND R.EFF_FROM_DT                  &lt;=  #slsDt#
                    AND NVL(R.EFF_THRU_DT, #maxEffDt#) &gt;=  #slsDt#
                    AND R.GNRN_TP_CD                      IN (#gnrnTp_Current#, #gnrnTp_Future#)
                )
        SELECT
            STRU.PRNT_ORG_CD
        FROM
            STRU
        WHERE
            STRU.ORG_TIER_CD  =
                    (
                        SELECT
                            MIN(STRU.ORG_TIER_CD)
                        FROM
                            STRU
                    )
    </statement>

    <!-- START 2018/01/30 Hd.Sugawara [QC#22699,ADD] -->
    <statement id="getDeleteZeroTierReln" parameterClass="Map" resultClass="Map">
    WITH ORG_TOP AS (
        SELECT
            ORG.ORG_CD
          , ORG.ORG_STRU_TP_CD
        FROM
            DS_ORG_UNIT ORG
          , ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD    = #glblCmpyCd#
        AND ORG.ORG_TIER_CD     = #orgTierCd#
        AND (
                ORG.GNRN_TP_CD  = #gnrnTpCdCurrent#
                OR
                ORG.GNRN_TP_CD  = #gnrnTpCdFuture#
            )
        AND ORG.EZCANCELFLAG    = '0'

        AND STRU.GLBL_CMPY_CD   = ORG.GLBL_CMPY_CD
        AND STRU.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG  = #trtyStruFlg#
        AND STRU.EZCANCELFLAG   = '0'
    )
    SELECT
        RELN.DS_ORG_RELN_PK
    FROM
        DS_ORG_UNIT ORG
      , ORG_STRU_TP STRU
      , DS_ORG_RELN RELN
      , ORG_TOP
    WHERE
        ORG.GLBL_CMPY_CD    = #glblCmpyCd#
    AND ORG.ORG_CD          = #orgCd#
    AND (
            ORG.GNRN_TP_CD  = #gnrnTpCdCurrent#
            OR
            ORG.GNRN_TP_CD  = #gnrnTpCdFuture#
        )
    AND ORG.EZCANCELFLAG    = '0'

    AND STRU.GLBL_CMPY_CD   = ORG.GLBL_CMPY_CD
    AND STRU.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG  = #trtyStruFlg#
    AND STRU.EZCANCELFLAG   = '0'

    AND RELN.GLBL_CMPY_CD   = ORG.GLBL_CMPY_CD
    AND RELN.ORG_CD         = ORG.ORG_CD
    AND RELN.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
    AND (
            RELN.GNRN_TP_CD = #gnrnTpCdCurrent#
            OR
            RELN.GNRN_TP_CD = #gnrnTpCdFuture#
        )
    AND RELN.EZCANCELFLAG   = '0'

    AND RELN.PRNT_ORG_CD    = ORG_TOP.ORG_CD
    AND RELN.ORG_STRU_TP_CD = ORG_TOP.ORG_STRU_TP_CD
    </statement>
    <!-- END 2018/01/30 Hd.Sugawara [QC#22699,ADD] -->
</sqlMap>
