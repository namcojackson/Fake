<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NPZC005001">

    <statement id="getPoBuyer" parameterClass="Map" resultClass="Map">
        SELECT
            PO.PO_SUBMT_PSN_CD AS BUYER_PSN_CD
           ,NVL2(SSUL.FULL_PSN_NM,SSUL.FULL_PSN_NM,AP.FIRST_NM || (NVL2(AP.MID_NM, ' '||AP.MID_NM||' ', ' ')) || AP.LAST_NM) AS FULL_PSN_NM
        FROM
             PO               PO
            ,SCE_SYS_USR_LIST SSUL
            ,AUTH_PSN         AP
        WHERE
            PO.GLBL_CMPY_CD       = #GLBL_CMPY_CD#
        AND PO.PO_ORD_NUM         = #PO_ORD_NUM#
        AND PO.EZCANCELFLAG       = '0'
        AND PO.GLBL_CMPY_CD       = SSUL.GLBL_CMPY_CD(+)
        AND PO.PO_SUBMT_PSN_CD    = SSUL.FULL_PSN_NM(+)
        AND SSUL.EZCANCELFLAG(+)  = '0'
        AND PO.GLBL_CMPY_CD       = AP.GLBL_CMPY_CD(+)
        AND PO.PO_SUBMT_PSN_CD    = AP.USR_NM(+)
        AND AP.EZCANCELFLAG(+)    = '0'
    </statement>

</sqlMap>