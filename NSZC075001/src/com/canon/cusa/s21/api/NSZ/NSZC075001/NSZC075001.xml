<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<sqlMap namespace="NSZC075001">
    <statement id="getSvcMachMstr" parameterClass="Map" resultClass="Map">
        SELECT
            A.SVC_MACH_MSTR_PK
            ,A.SER_NUM
            ,B.LOC_NM
            ,B.ADDL_LOC_NM
            ,B.FIRST_LINE_ADDR
            ,B.SCD_LINE_ADDR
            ,B.THIRD_LINE_ADDR
            ,B.FRTH_LINE_ADDR
            ,B.CTY_ADDR
            ,B.ST_CD
            ,B.POST_CD
            ,B.CTRY_CD
            ,B.SELL_TO_CUST_CD
            ,C.SVC_CALL_AVAL_FLG
            ,C.WH_CALL_AVAL_FLG
            ,A.CUR_LOC_NUM
            <!-- START 2018/09/10 K.Kitachi [QC#26260, ADD] -->
            ,A.SLD_BY_LINE_BIZ_TP_CD
            <!-- END 2018/09/10 K.Kitachi [QC#26260, ADD] -->
        FROM
            SVC_MACH_MSTR        A
            ,SHIP_TO_CUST        B
            ,SVC_MACH_MSTR_STS   C
        WHERE
            A.GLBL_CMPY_CD             = #glblCmpyCd#
            AND A.SER_NUM              = #serNum#
            AND B.GLBL_CMPY_CD         = A.GLBL_CMPY_CD
            AND B.SHIP_TO_CUST_CD      = A.CUR_LOC_NUM
            AND C.GLBL_CMPY_CD         = A.GLBL_CMPY_CD
            AND C.SVC_MACH_MSTR_STS_CD = A.SVC_MACH_MSTR_STS_CD
            <!-- START 2019/02/27 S.Kitamura [QC#30545, ADD] -->
            <isEqual property="isFromClick" compareValue="Y">
                AND A.SVC_MACH_TP_CD   = #machTpCd#
            </isEqual>
            <!-- END 2019/02/27 S.Kitamura [QC#30545, ADD] -->
            <!-- START 2019/11/18 K.Kitachi [QC#54704, ADD] -->
            <isEqual property="isFromPartsOrder" compareValue="Y">
            AND A.SVC_MACH_TP_CD       = #machTpCd#
            </isEqual>
            <!-- END 2019/11/18 K.Kitachi [QC#54704, ADD] -->
            AND A.EZCANCELFLAG         = '0'
            AND B.EZCANCELFLAG         = '0'
            AND C.EZCANCELFLAG         = '0'
    </statement>
<!-- START 2019/07/26 T.Aoyagi [QC#52029, ADD] -->
    <statement id="getSvcMachMstrBySerNumAndMdlNm" parameterClass="Map" resultClass="Map">
        SELECT
            A.SVC_MACH_MSTR_PK
            ,A.SER_NUM
            ,B.LOC_NM
            ,B.ADDL_LOC_NM
            ,B.FIRST_LINE_ADDR
            ,B.SCD_LINE_ADDR
            ,B.THIRD_LINE_ADDR
            ,B.FRTH_LINE_ADDR
            ,B.CTY_ADDR
            ,B.ST_CD
            ,B.POST_CD
            ,B.CTRY_CD
            ,B.SELL_TO_CUST_CD
            ,C.SVC_CALL_AVAL_FLG
            ,C.WH_CALL_AVAL_FLG
            ,A.CUR_LOC_NUM
            ,A.SLD_BY_LINE_BIZ_TP_CD
        FROM
            SVC_MACH_MSTR        A
            ,SHIP_TO_CUST        B
            ,SVC_MACH_MSTR_STS   C
            ,SVC_CONFIG_MSTR     D
            ,MDL_NM              E
        WHERE
            A.GLBL_CMPY_CD             = #glblCmpyCd#
            AND A.SER_NUM              = #serNum#
            AND B.GLBL_CMPY_CD         = A.GLBL_CMPY_CD
            AND B.SHIP_TO_CUST_CD      = A.CUR_LOC_NUM
            AND C.GLBL_CMPY_CD         = A.GLBL_CMPY_CD
            AND C.SVC_MACH_MSTR_STS_CD = A.SVC_MACH_MSTR_STS_CD
            <isEqual property="isFromClick" compareValue="Y">
            AND A.SVC_MACH_TP_CD   = #machTpCd#
            </isEqual>
            <!-- START 2019/11/18 K.Kitachi [QC#54704, ADD] -->
            <isEqual property="isFromPartsOrder" compareValue="Y">
            AND A.SVC_MACH_TP_CD       = #machTpCd#
            </isEqual>
            <!-- END 2019/11/18 K.Kitachi [QC#54704, ADD] -->
            AND A.GLBL_CMPY_CD         = D.GLBL_CMPY_CD
            AND A.SVC_CONFIG_MSTR_PK   = D.SVC_CONFIG_MSTR_PK
            AND D.GLBL_CMPY_CD         = E.T_GLBL_CMPY_CD
            AND D.MDL_ID               = E.T_MDL_ID
            AND E.T_MDL_NM             = #t_MdlNm# 
            AND A.EZCANCELFLAG         = '0'
            AND B.EZCANCELFLAG         = '0'
            AND C.EZCANCELFLAG         = '0'
            AND D.EZCANCELFLAG         = '0'
            AND E.EZCANCELFLAG         = '0'
    </statement>
<!-- END 2019/07/26 T.Aoyagi [QC#52029, ADD] -->
    <statement id="convLineBizTpToSvcLineBiz" parameterClass="Map" resultClass="String">
        SELECT
            RELN.SVC_LINE_BIZ_CD
        FROM
            SVC_LINE_BIZ_RELN RELN
        WHERE
            RELN.GLBL_CMPY_CD   = #glblCmpyCd#
        AND RELN.EZCANCELFLAG   = '0'
        AND RELN.LINE_BIZ_TP_CD = NVL(#lineBizTpCd#, #nullString#)
    </statement>
<!-- START 2016/11/08 [QC#15819, ADD] -->
    <statement id="getSvcCallTp" parameterClass="Map" resultClass="String">
        SELECT
            A.DS_SVC_CALL_TP_CD
        FROM
            DS_SVC_CALL_TP        A
        WHERE
                A.GLBL_CMPY_CD              = #glblCmpyCd#
            AND A.EZCANCELFLAG              = '0'
            AND A.XTRNL_CALL_TP_REF_TXT     = #xtrnlCallTpRefTxt#
        ORDER BY
            A.DS_SVC_CALL_TP_CD
    </statement>
    <statement id="getSvcPblmTpCd" parameterClass="Map" resultClass="String">
        SELECT
            A.SVC_PBLM_TP_CD
        FROM
            SVC_PBLM_TP        A
        WHERE
                A.GLBL_CMPY_CD              = #glblCmpyCd#
            AND A.EZCANCELFLAG              = '0'
            AND A.XTRNL_PBLM_TP_REF_TXT     = #xtrnlPblmTpRefTxt#
        ORDER BY
            A.SVC_PBLM_TP_CD
    </statement>
<!-- END 2016/11/08 [QC#15819, ADD] -->
</sqlMap>
