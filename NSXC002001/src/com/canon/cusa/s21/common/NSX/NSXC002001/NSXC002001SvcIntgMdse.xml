<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSXC002001SvcIntgMdse">
    <statement id="getIntgMdseCd" parameterClass="Map" resultClass="Map">
        SELECT
            CASE
                WHEN
                    SCT.SVC_BILL_TP_CD = '*'
                THEN
                    SCT.SVC_BILL_TP_CD
                ELSE
                     (SELECT
                         SBT.SVC_CHRG_TP_CD
                     FROM
                         SVC_BILL_TP SBT
                     WHERE
                         SBT.GLBL_CMPY_CD   = SCT.GLBL_CMPY_CD
                     AND SBT.SVC_BILL_TP_CD = SCT.SVC_BILL_TP_CD
                     AND SBT.EZCANCELFLAG   = '0')
            END AS SVC_CHRG_TP_CD
           ,SBI.SVC_CHRG_TP_CD AS SVC_TASK_CHRG_TP_CD
           ,STK.SVC_MACH_MSTR_PK
        FROM
            SVC_TASK       STK
           ,DS_SVC_CALL_TP SCT
           ,SVC_BILL_TP    SBI
        WHERE
            STK.GLBL_CMPY_CD      = #glblCmpyCd#
        AND STK.SVC_TASK_NUM      = #svcTaskNum#
        AND SCT.GLBL_CMPY_CD      = STK.GLBL_CMPY_CD
        AND SCT.DS_SVC_CALL_TP_CD = STK.DS_SVC_CALL_TP_CD
        AND SBI.GLBL_CMPY_CD      = STK.GLBL_CMPY_CD
        AND SBI.SVC_BILL_TP_CD    = STK.SVC_BILL_TP_CD
        AND SBI.EZCANCELFLAG      = '0'
        AND STK.EZCANCELFLAG      = '0'
        AND SCT.EZCANCELFLAG      = '0'
    </statement>
</sqlMap>
