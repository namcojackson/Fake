<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<sqlMap namespace="NSXC002001SerialRangeCheck">
    <statement id="getModificationInfo" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                 SMD.SVC_MOD_DTL_PK      AS SVC_MOD_DTL_PK
        FROM
                 SVC_MOD     SM
                ,SVC_MOD_DTL SMD
        WHERE
                SM.GLBL_CMPY_CD        = #glblCmpyCd#
            AND SM.SVC_MOD_PLN_ID      = #svcModPlnId#
            AND SM.GLBL_CMPY_CD        = SMD.GLBL_CMPY_CD
            AND SM.SVC_MOD_PK          = SMD.SVC_MOD_PK
            AND SMD.MDSE_CD            = #mdseCd#
            AND SM.EZCANCELFLAG        = '0'
            AND SMD.EZCANCELFLAG       = '0'
        <!-- START 2018/08/20 K.Kitachi [QC#27460, ADD] -->
        UNION
        SELECT
                 SMD.SVC_MOD_DTL_PK      AS SVC_MOD_DTL_PK
        FROM
                 SVC_MOD            SM
                ,SVC_MOD_DTL        SMD
                ,MDSE_ITEM_FLIP_SET FLP
        WHERE
                SM.GLBL_CMPY_CD        = #glblCmpyCd#
            AND SM.SVC_MOD_PLN_ID      = #svcModPlnId#
            AND SM.GLBL_CMPY_CD        = SMD.GLBL_CMPY_CD
            AND SM.SVC_MOD_PK          = SMD.SVC_MOD_PK
            AND SMD.GLBL_CMPY_CD       = FLP.GLBL_CMPY_CD
            AND SMD.MDSE_CD            = FLP.MDSE_CD
            AND FLP.RELN_MDSE_CD       = #mdseCd#
            <iterate property="mdseItemRelnTpCdList" var="mdseItemRelnTpCd[]" open="AND FLP.MDSE_ITEM_RELN_TP_CD IN (" close=")" conjunction=",">
                #mdseItemRelnTpCd[]#
            </iterate>
            AND SM.EZCANCELFLAG        = '0'
            AND SMD.EZCANCELFLAG       = '0'
            AND FLP.EZCANCELFLAG       = '0'
        <!-- END 2018/08/20 K.Kitachi [QC#27460, ADD] -->
    </statement>
</sqlMap>
