<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB721001">
    <statement id="getRecordCountByStsCd" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(PI.CSMP_PRC_INTFC_PK)  AS RECORD_COUNT
        FROM
            CSMP_PRC_INTFC                PI
        WHERE
                PI.GLBL_CMPY_CD           = #glblCmpyCd#
            AND PI.EZCANCELFLAG           = '0'
            <iterate property="csmpProcStsCdList" var="csmpProcStsCd[]" open="AND  PI.CSMP_PROC_STS_CD IN (" close=")" conjunction= ", " >
                #csmpProcStsCd[]#
            </iterate>
    </statement>

    <statement id="getTargetRecordByStsCd" parameterClass="Map" resultClass="Map">
        SELECT
             PI.CSMP_PRC_INTFC_PK    AS CSMP_PRC_INTFC_PK
             ,PI.RTL_DLR_CD          AS RTL_DLR_CD
             ,PI.CR_LIST_GNRN_NUM    AS CR_LIST_GNRN_NUM
             ,PI.CR_LIST_TXT         AS CR_LIST_TXT
             ,PI.CUSA_MDSE_CD        AS CUSA_MDSE_CD
             ,PI.CSMP_CR_AMT         AS CSMP_CR_AMT
             ,PI.CSMP_TRX_STS_CD     AS CSMP_TRX_STS_CD
             ,PI.LAST_UPD_DT         AS LAST_UPD_DT
             ,PI.CSA_MDSE_CD         AS CSA_MDSE_CD
             ,PI.CSA_PRC_CATG_CD     AS CSA_PRC_CATG_CD
             ,PI.CSMP_PROC_STS_CD    AS CSMP_PROC_STS_CD
             ,PI.CSMP_ERR_MSG_TXT    AS CSMP_ERR_MSG_TXT
             ,PI.CSMP_PRC_LIST_ID    AS CSMP_PRC_LIST_ID
        FROM
            CSMP_PRC_INTFC           PI
        WHERE
                PI.GLBL_CMPY_CD      = #glblCmpyCd#
            AND PI.EZCANCELFLAG      = '0'
            <iterate property="csmpProcStsCdList" var="csmpProcStsCd[]" open="AND  PI.CSMP_PROC_STS_CD IN (" close=")" conjunction= ", " >
                #csmpProcStsCd[]#
            </iterate>
        ORDER BY
            PI.CSMP_PRC_LIST_ID
    </statement>

    <statement id="getCsmpPrcXrefWithoutEffDt" parameterClass="Map" resultClass="String">
        SELECT
             PX.CSA_PRC_CATG_CD                AS CSA_PRC_CATG_CD
        FROM
            CSMP_PRC_XREF                      PX
        WHERE
                PX.GLBL_CMPY_CD                = #glblCmpyCd#
            AND PX.EZCANCELFLAG                = '0'
            AND PX.CR_LIST_GNRN_NUM            = #crListGnrnNum#
            AND PX.CR_LIST_TXT                 = #crListTxt#
        ORDER BY
            PX.CSA_PRC_CATG_CD
    </statement>

    <statement id="getCsmpPrcXref" parameterClass="Map" resultClass="String">
        SELECT
             PX.CSA_PRC_CATG_CD                AS CSA_PRC_CATG_CD
        FROM
            CSMP_PRC_XREF                      PX
        WHERE
                PX.GLBL_CMPY_CD                = #glblCmpyCd#
            AND PX.EZCANCELFLAG                = '0'
            AND PX.CR_LIST_GNRN_NUM            = #crListGnrnNum#
            AND PX.CR_LIST_TXT                 = #crListTxt#
            AND PX.EFF_FROM_DT                 &lt;= #batProcDate#
            AND NVL(PX.EFF_THRU_DT,'99991231') &gt;= #batProcDate#
        ORDER BY
            PX.CSA_PRC_CATG_CD
    </statement>

    <statement id="getPriceList" parameterClass="Map" resultClass="String">
        SELECT
             PC.PRC_CATG_CD                    AS PRC_CATG_CD
        FROM
             PRC_CATG                           PC
            ,PRC_LIST_TP                        PT
        WHERE
                PC.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND PC.EZCANCELFLAG                 = '0'
            AND PC.PRC_CATG_CD                  = #csaPrcCatgCd#
            AND PC.EFF_FROM_DT                 &lt;= #lastUpdDt#
            AND NVL(PC.EFF_THRU_DT,'99991231') &gt;= #lastUpdDt#
            <isNotNull property="actvFlgY">
                AND PC.ACTV_FLG                = #actvFlgY#
            </isNotNull>
            AND PC.DEL_FLG                     = #delFlgN#
            AND PC.GLBL_CMPY_CD                = PT.GLBL_CMPY_CD
            AND PT.EZCANCELFLAG                = '0'
            AND PC.PRC_LIST_TP_CD              = PT.PRC_LIST_TP_CD
            AND PT.PRC_LIST_STRU_TP_CD          = #prcListStruTpEquip#
        ORDER BY
            PC.PRC_CATG_CD
    </statement>

    <statement id="getPriceListDtl" parameterClass="Map" resultClass="Map">
        SELECT
             EQ.PRC_LIST_EQUIP_PRC_AMT        AS PRC_LIST_EQUIP_PRC_AMT
             ,EQ.EFF_FROM_DT                   AS EFF_FROM_DT
        FROM
            PRC_LIST_EQUIP                     EQ
        WHERE
                EQ.GLBL_CMPY_CD                = #glblCmpyCd#
            AND EQ.EZCANCELFLAG                = '0'
            AND EQ.PRC_CATG_CD                 = #prcCatgCd#
            AND EQ.PRC_LIST_EQUIP_CONFIG_NUM   IS NULL
            AND EQ.PRC_LIST_EQUIP_CONFIG_NM    IS NULL
            AND EQ.PRC_QLFY_TP_CD              = #prcQlfyTpItemCode#
            AND EQ.PRC_QLFY_VAL_TXT            = #workMdseCd#
            AND EQ.PKG_UOM_CD                  = #pkgUomEach#
            AND EQ.PRC_TERM_UOM_CD             IS NULL
            AND EQ.PRC_TERM_AOT                IS NULL
            <isNotNull property="lastUpdDt">
            AND EQ.EFF_FROM_DT                 &lt;= #lastUpdDt#
            AND NVL(EQ.EFF_THRU_DT,'99991231') &gt;= #lastUpdDt#
            </isNotNull>
            AND EQ.DEL_FLG                     = #delFlgN#
    </statement>

    <statement id="getUpdatePriceListDtl" parameterClass="Map" resultClass="Map">
        SELECT
             EQ.PRC_LIST_EQUIP_PK              AS PRC_LIST_EQUIP_PK
             ,EQ.EFF_FROM_DT                   AS EFF_FROM_DT
        FROM
            PRC_LIST_EQUIP                     EQ
        WHERE
                EQ.GLBL_CMPY_CD                = #glblCmpyCd#
            AND EQ.EZCANCELFLAG                = '0'
            AND EQ.PRC_CATG_CD                 = #prcCatgCd#
            AND EQ.PRC_LIST_EQUIP_CONFIG_NUM   IS NULL
            AND EQ.PRC_LIST_EQUIP_CONFIG_NM    IS NULL
            AND EQ.PRC_QLFY_TP_CD              = #prcQlfyTpItemCode#
            AND EQ.PRC_QLFY_VAL_TXT            = #workMdseCd#
            AND EQ.PKG_UOM_CD                  = #pkgUomEach#
            AND EQ.PRC_TERM_UOM_CD             IS NULL
            AND EQ.PRC_TERM_AOT                IS NULL
            AND EQ.EFF_FROM_DT                 &lt;= #lastUpdDt#
            AND NVL(EQ.EFF_THRU_DT,'99991231') &gt;= #lastUpdDt#
            AND EQ.DEL_FLG                     = #delFlgN#
            ORDER BY
                EQ.EFF_FROM_DT
    </statement>

    <statement id="getFuturePriceListDtl" parameterClass="Map" resultClass="Map">
        SELECT
            PRC_LIST_EQUIP_PK              AS PRC_LIST_EQUIP_PK
            ,EFF_FROM_DT                   AS EFF_FROM_DT
        FROM
            (
            SELECT
                 EQ.PRC_LIST_EQUIP_PK              AS PRC_LIST_EQUIP_PK
                 ,EQ.EFF_FROM_DT                   AS EFF_FROM_DT
            FROM
                PRC_LIST_EQUIP                     EQ
            WHERE
                    EQ.GLBL_CMPY_CD                = #glblCmpyCd#
                AND EQ.EZCANCELFLAG                = '0'
                AND EQ.PRC_CATG_CD                 = #prcCatgCd#
                AND EQ.PRC_LIST_EQUIP_CONFIG_NUM   IS NULL
                AND EQ.PRC_LIST_EQUIP_CONFIG_NM    IS NULL
                AND EQ.PRC_QLFY_TP_CD              = #prcQlfyTpItemCode#
                AND EQ.PRC_QLFY_VAL_TXT            = #workMdseCd#
                AND EQ.PKG_UOM_CD                  = #pkgUomEach#
                AND EQ.PRC_TERM_UOM_CD             IS NULL
                AND EQ.PRC_TERM_AOT                IS NULL
                AND EQ.EFF_FROM_DT                 &gt; #lastUpdDt#
                AND EQ.DEL_FLG                     = #delFlgN#
                ORDER BY
                    EQ.EFF_FROM_DT)
        WHERE
            ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="getInsAndUpdDup" parameterClass="Map" resultClass="Map">
        SELECT
             PI1.CSMP_PRC_INTFC_PK    AS CSMP_PRC_INTFC_PK
        FROM
            CSMP_PRC_INTFC            PI1
        WHERE
                PI1.GLBL_CMPY_CD      = #glblCmpyCd#
            AND PI1.EZCANCELFLAG      = '0'
            AND PI1.CSMP_PROC_STS_CD  = #procStsNew#
            AND PI1.CSMP_TRX_STS_CD   = #trxStsInsert#
            AND EXISTS (
                SELECT
                    1
                FROM
                    CSMP_PRC_INTFC   PI2
                WHERE
                    PI2.GLBL_CMPY_CD      = #glblCmpyCd#
                AND PI2.EZCANCELFLAG      = '0'
                AND PI2.CSMP_PROC_STS_CD  = #procStsNew#
                AND PI2.CSMP_TRX_STS_CD   = #trxStsUpdate#
                AND SUBSTR(PI1.CUSA_MDSE_CD, #substrFromPos#, #digitForMdseCd#)
                                          = SUBSTR(PI2.CUSA_MDSE_CD, #substrFromPos#, #digitForMdseCd#)
                AND PI1.CR_LIST_TXT       = PI2.CR_LIST_TXT
                AND PI1.CSA_PRC_CATG_CD   = PI2.CSA_PRC_CATG_CD)
    </statement>

    <statement id="getRecordDuplicationByKeyAndTrxSts" parameterClass="Map" resultClass="Map">
        SELECT
             PI1.CSMP_PRC_INTFC_PK    AS CSMP_PRC_INTFC_PK
             ,PI1.RTL_DLR_CD          AS RTL_DLR_CD
             ,PI1.CR_LIST_GNRN_NUM    AS CR_LIST_GNRN_NUM
             ,PI1.CR_LIST_TXT         AS CR_LIST_TXT
             ,PI1.CUSA_MDSE_CD        AS CUSA_MDSE_CD
             ,PI1.CSMP_CR_AMT         AS CSMP_CR_AMT
             ,PI1.CSMP_TRX_STS_CD     AS CSMP_TRX_STS_CD
             ,PI1.LAST_UPD_DT         AS LAST_UPD_DT
             ,PI1.CSA_MDSE_CD         AS CSA_MDSE_CD
             ,PI1.CSA_PRC_CATG_CD     AS CSA_PRC_CATG_CD
             ,PI1.CSMP_PROC_STS_CD    AS CSMP_PROC_STS_CD
             ,PI1.CSMP_ERR_MSG_TXT    AS CSMP_ERR_MSG_TXT
             ,PI1.CSMP_PRC_LIST_ID    AS CSMP_PRC_LIST_ID
        FROM
            CSMP_PRC_INTFC            PI1
            ,(
                SELECT
                    CSA_MDSE_CD
                    ,CSA_PRC_CATG_CD
                    ,CSMP_CR_AMT
                    ,CR_LIST_TXT
                FROM
                    CSMP_PRC_INTFC PI2
                WHERE
                    PI2.GLBL_CMPY_CD      = #glblCmpyCd#
                AND PI2.EZCANCELFLAG      = '0'
                AND PI2.CSMP_PROC_STS_CD  = #procStsNew#
                AND PI2.CSA_MDSE_CD       IS NOT NULL
                AND PI2.CSA_PRC_CATG_CD   IS NOT NULL
                AND PI2.CSMP_TRX_STS_CD   = #trxStsInsert#
                GROUP BY
                    PI2.CSA_MDSE_CD
                    ,PI2.CSA_PRC_CATG_CD
                    ,PI2.CSMP_CR_AMT
                    ,PI2.CR_LIST_TXT
                HAVING
                    COUNT(PI2.CSMP_PRC_LIST_ID) > #minRecCnt#
            ) DUP_PI
        WHERE
            PI1.GLBL_CMPY_CD     = #glblCmpyCd#
        AND PI1.EZCANCELFLAG     = '0'
        AND PI1.CSMP_PROC_STS_CD = #procStsNew#
        AND PI1.CSA_MDSE_CD      = DUP_PI.CSA_MDSE_CD
        AND PI1.CSA_PRC_CATG_CD  = DUP_PI.CSA_PRC_CATG_CD
        AND PI1.CSMP_CR_AMT      = DUP_PI.CSMP_CR_AMT
        AND PI1.CR_LIST_TXT      = DUP_PI.CR_LIST_TXT
        ORDER BY
            PI1.CSA_MDSE_CD
            ,PI1.CSA_PRC_CATG_CD
            ,PI1.CSMP_CR_AMT
            ,PI1.CR_LIST_TXT
            ,PI1.CSMP_PRC_LIST_ID
    </statement>

    <statement id="getRecordDuplicationByKey" parameterClass="Map" resultClass="Map">
        SELECT
             PI1.CSMP_PRC_INTFC_PK    AS CSMP_PRC_INTFC_PK
             ,PI1.RTL_DLR_CD          AS RTL_DLR_CD
             ,PI1.CR_LIST_GNRN_NUM    AS CR_LIST_GNRN_NUM
             ,PI1.CR_LIST_TXT         AS CR_LIST_TXT
             ,PI1.CUSA_MDSE_CD        AS CUSA_MDSE_CD
             ,PI1.CSMP_CR_AMT         AS CSMP_CR_AMT
             ,PI1.CSMP_TRX_STS_CD     AS CSMP_TRX_STS_CD
             ,PI1.LAST_UPD_DT         AS LAST_UPD_DT
             ,PI1.CSA_MDSE_CD         AS CSA_MDSE_CD
             ,PI1.CSA_PRC_CATG_CD     AS CSA_PRC_CATG_CD
             ,PI1.CSMP_PROC_STS_CD    AS CSMP_PROC_STS_CD
             ,PI1.CSMP_ERR_MSG_TXT    AS CSMP_ERR_MSG_TXT
             ,PI1.CSMP_PRC_LIST_ID    AS CSMP_PRC_LIST_ID
        FROM
            CSMP_PRC_INTFC            PI1
            ,(
                SELECT
                    CSA_MDSE_CD
                    ,CSA_PRC_CATG_CD
                    ,CSMP_CR_AMT
                FROM
                    CSMP_PRC_INTFC PI2
                WHERE
                    PI2.GLBL_CMPY_CD      = #glblCmpyCd#
                AND PI2.EZCANCELFLAG      = '0'
                AND PI2.CSMP_PROC_STS_CD  = #procStsNew#
                AND PI2.CSA_MDSE_CD       IS NOT NULL
                AND PI2.CSA_PRC_CATG_CD   IS NOT NULL
                GROUP BY
                    PI2.CSA_MDSE_CD
                    ,PI2.CSA_PRC_CATG_CD
                    ,PI2.CSMP_CR_AMT
                HAVING
                    COUNT(PI2.CSMP_PRC_LIST_ID) > #minRecCnt#
            ) DUP_PI
        WHERE
            PI1.GLBL_CMPY_CD     = #glblCmpyCd#
        AND PI1.EZCANCELFLAG     = '0'
        AND PI1.CSMP_PROC_STS_CD = #procStsNew#
        AND PI1.CSA_MDSE_CD      = DUP_PI.CSA_MDSE_CD
        AND PI1.CSA_PRC_CATG_CD  = DUP_PI.CSA_PRC_CATG_CD
        AND PI1.CSMP_CR_AMT      = DUP_PI.CSMP_CR_AMT
        ORDER BY
            PI1.CSA_MDSE_CD
            ,PI1.CSA_PRC_CATG_CD
            ,PI1.CSMP_CR_AMT
            ,PI1.CSMP_PRC_LIST_ID
    </statement>

    <statement id="getCheckClearRecord" parameterClass="Map" resultClass="Map">
        SELECT
             PI.CSMP_PRC_INTFC_PK    AS CSMP_PRC_INTFC_PK
             ,PI.RTL_DLR_CD          AS RTL_DLR_CD
             ,PI.CR_LIST_GNRN_NUM    AS CR_LIST_GNRN_NUM
             ,PI.CR_LIST_TXT         AS CR_LIST_TXT
             ,PI.CUSA_MDSE_CD        AS CUSA_MDSE_CD
             ,PI.CSMP_CR_AMT         AS CSMP_CR_AMT
             ,PI.CSMP_TRX_STS_CD     AS CSMP_TRX_STS_CD
             ,PI.LAST_UPD_DT         AS LAST_UPD_DT
             ,PI.CSA_MDSE_CD         AS CSA_MDSE_CD
             ,PI.CSA_PRC_CATG_CD     AS CSA_PRC_CATG_CD
             ,PI.CSMP_PROC_STS_CD    AS CSMP_PROC_STS_CD
             ,PI.CSMP_ERR_MSG_TXT    AS CSMP_ERR_MSG_TXT
             ,PI.CSMP_PRC_LIST_ID    AS CSMP_PRC_LIST_ID
        FROM
            CSMP_PRC_INTFC           PI
        WHERE
                PI.GLBL_CMPY_CD      = #glblCmpyCd#
            AND PI.EZCANCELFLAG      = '0'
            AND PI.CSMP_PROC_STS_CD  = #csmpProcStsProcessed#
        ORDER BY
            PI.CSA_MDSE_CD
            ,PI.CSA_PRC_CATG_CD
            ,PI.CSMP_PRC_LIST_ID
    </statement>

    <statement id="getErrorMessage" parameterClass="Map" resultClass="Map">
        SELECT
            PI.CR_LIST_TXT       AS CR_LIST_TXT
            ,PI.CR_LIST_GNRN_NUM AS CR_LIST_GNRN_NUM
            ,PI.CUSA_MDSE_CD     AS CUSA_MDSE_CD
            ,PI.CSMP_TRX_STS_CD  AS CSMP_TRX_STS_CD
            ,PI.LAST_UPD_DT      AS LAST_UPD_DT
            ,PI.CSA_MDSE_CD      AS CSA_MDSE_CD
            ,PI.CSMP_ERR_MSG_TXT AS CSMP_ERR_MSG_TXT
        FROM
            CSMP_PRC_INTFC           PI
        WHERE
                PI.GLBL_CMPY_CD      = #glblCmpyCd#
            AND PI.EZCANCELFLAG      = '0'
            <iterate property="targetRecPkList" var="targetRecPk[]" open="AND  PI.CSMP_PRC_INTFC_PK IN (" close=")" conjunction= ", " >
                #targetRecPk[]#
            </iterate>
            <iterate property="csmpProcStsCdList" var="csmpProcStsCd[]" open="AND  PI.CSMP_PROC_STS_CD IN (" close=")" conjunction= ", " >
                #csmpProcStsCd[]#
            </iterate>
        ORDER BY
            PI.LAST_UPD_DT DESC NULLS LAST
            ,PI.CR_LIST_TXT
            ,PI.CR_LIST_GNRN_NUM
            ,PI.CUSA_MDSE_CD
    </statement>
</sqlMap>