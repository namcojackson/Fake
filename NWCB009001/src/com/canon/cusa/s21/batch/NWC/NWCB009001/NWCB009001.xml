<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWCB009001">

    <statement id="getTargetData" parameterClass="Map">
        SELECT
             'N'                                                        EASY_PAC_FLG
            ,INV.BILL_TO_CUST_CD                                        BILL_TO_CUST_CD
            ,BTC.LOC_NM                                                 BILL_TO_CUST_NM
            ,BTC.LOC_NUM                                                LOC_NUM
            ,INV.BILL_TO_CUST_ACCT_CD                                   BILL_TO_CUST_ACCT_CD
            ,INV.BILL_TO_CUST_ACCT_NM                                   BILL_TO_CUST_ACCT_NM
            ,INV.INV_NUM                                                INV_NUM
            ,INV.CUST_ISS_PO_NUM                                        CUST_ISS_PO_NUM
            ,INV.DS_BIZ_AREA_CD                                        DS_BIZ_AREA_CD
            ,SINV.DS_CONTR_NUM                                          DS_CONTR_NUM
            ,SINV.BLLG_PER_FROM_DT
                 || DECODE(SINV.BLLG_PER_TO_DT, NULL, '', '-')
                 || SINV.BLLG_PER_TO_DT                                 BLLG_PER
            ,SINV.SER_NUM                                               SER_NUM
            ,SINV.MDL_NM                                                MDL_NM
            ,INV.INV_DT                                                 INV_DT
            ,INV.INV_TP_CD                                              INV_TP_CD
            ,INV.INV_TOT_DEAL_NET_AMT                                   INV_TOT_DEAL_NET_AMT
            ,INV.INV_TOT_FUNC_NET_AMT                                   INV_TOT_FUNC_NET_AMT
            ,ATB.DEAL_RMNG_BAL_GRS_AMT                                  DEAL_RMNG_BAL_GRS_AMT
            ,ATB.FUNC_RMNG_BAL_GRS_AMT                                  FUNC_RMNG_BAL_GRS_AMT
            ,INV.PMT_TERM_CASH_DISC_CD                                  PMT_TERM_CASH_DISC_CD
            ,INV.PMT_TERM_CD                                            PMT_TERM_CD
            ,INV.PMT_TERM_CASH_DISC_DESC_TXT                            PMT_TERM_CASH_DISC_DESC_TXT
            ,PTC.PMT_TERM_CONSL_LAST_DOM_FLG                            PMT_TERM_CONSL_LAST_DOM_FLG
            ,PTC.PMT_TERM_CONSL_DUE_DAY                                 PMT_TERM_CONSL_DUE_DAY
            <!-- QC#7000 2016/04/15 add Start -->
            ,INV.ORIG_INV_NUM                                           ORIG_INV_NUM
            <!-- QC#7000 2016/04/15 add End -->
            <!-- QC#23604 add Start -->
            ,SINV.DS_CONTR_CATG_CD                                      DS_CONTR_CATG_CD
            <!-- START 2018/06/25 U.Kim [QC#26703,MOD] -->
            <!-- ,(SELECT -->
            <!--         SIL.FIRST_BLLG_ATTRB_VAL_TXT || ' ' || -->
            <!--         SIL.SCD_BLLG_ATTRB_VAL_TXT   || ' ' || -->
            <!--         SIL.THIRD_BLLG_ATTRB_VAL_TXT || ' ' || -->
            <!--         SIL.FRTH_BLLG_ATTRB_VAL_TXT  || ' ' || -->
            <!--         SIL.FIFTH_BLLG_ATTRB_VAL_TXT || ' ' || -->
            <!--         SIL.SIXTH_BLLG_ATTRB_VAL_TXT -->
            <!--     FROM -->
            <!--         SVC_INV_LINE    SIL -->
            <!--     WHERE -->
            <!--         SIL.GLBL_CMPY_CD    = SINV.GLBL_CMPY_CD -->
            <!--     AND SIL.SVC_INV_NUM     = SINV.SVC_INV_NUM -->
            <!--     AND SIL.EZCANCELFLAG    = '0' -->
            <!--     AND ROWNUM = 1 -->
            <!-- )                                                           IB_CONTROL_FIELDS -->
            ,(SELECT SIL.FIRST_BLLG_ATTRB_VAL_TXT FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS FIRST_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.SCD_BLLG_ATTRB_VAL_TXT   FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS SCD_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.THIRD_BLLG_ATTRB_VAL_TXT FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS THIRD_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.FRTH_BLLG_ATTRB_VAL_TXT  FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS FRTH_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.FIFTH_BLLG_ATTRB_VAL_TXT FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS FIFTH_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.SIXTH_BLLG_ATTRB_VAL_TXT FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS SIXTH_BLLG_ATTRB_VAL_TXT
            <!-- END 2018/06/25 U.Kim [QC#26703,MOD] -->
            ,SINV.INV_DUE_DT                                            INV_DUE_DT
            <!-- QC#23604 add ENd -->
            <!-- START 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- START 2022/03/22  [QC#59683,Mod] -->
            <!-- ,CTR.CONTR_LINK_NUM                                         CONTR_LINK_NUM-->
            ,SINV.CONTR_LINK_NUM                                         CONTR_LINK_NUM
            <!-- END   2022/03/22  [QC#59683,Mod] -->
            <!-- END 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- 2021/04/13 QC#57811 ADD START -->
            ,NVL(CECH.CONS_BILL_STATUS, 'Y')                          CONS_BILL_STATUS
            <!-- 2021/04/13 QC#57811 ADD END -->
        FROM
             INV                INV
            ,SVC_INV            SINV
            ,AR_TRX_BAL         ATB
            ,BILL_TO_CUST       BTC
            ,PMT_TERM_CASH_DISC PTC
            <!-- START 2018/11/06 T.Tomita [QC#28627,ADD] -->
            ,DS_CONTR           CTR
            <!-- END 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- 2021/04/13 QC#57811 ADD START -->
            ,CANON_E193_CS_HEADERS CECH
            <!-- 2021/04/13 QC#57811 ADD END -->
        WHERE
                INV.GLBL_CMPY_CD            = #glblCmpyCd#
            AND INV.INV_PRINT_STS_CD        = '1'
            AND INV.FNLZ_INV_FLG            = 'Y'
            <!-- QC#17962 del Start -->
            <!-- AND INV.SYS_SRC_CD             != #excludeSysSrcCd# -->
            <!-- QC#17962 del End -->
            AND INV.INV_DT              &lt;= #slsDt#
            AND INV.EZCANCELFLAG            = '0'

            AND NOT EXISTS (
                SELECT
                    '1'
                FROM
                    ORD_CATG_BIZ_CTX CTX
                WHERE
                        CTX.GLBL_CMPY_CD       = INV.GLBL_CMPY_CD
                    AND (CTX.DS_ORD_TP_CD      = INV.DS_ORD_TP_CD OR CTX.DS_ORD_TP_CD IS NULL)
                    AND CTX.DS_ORD_CATG_CD     = INV.DS_ORD_CATG_CD
                    AND CTX.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCdEasyPAC#
                    AND CTX.EZCANCELFLAG       = '0'
            )

            AND NOT EXISTS (
                SELECT
                    '1'
                FROM
                    CONSL_BILL_LINE CBL
                WHERE
                        CBL.GLBL_CMPY_CD      = INV.GLBL_CMPY_CD
                    AND CBL.CONSL_BILL_TRX_ID = INV.INV_NUM
                    AND CBL.EZCANCELFLAG      = '0'
            )

            AND SINV.GLBL_CMPY_CD (+)   = INV.GLBL_CMPY_CD
            AND SINV.SVC_INV_NUM (+)    = INV.INV_NUM
            AND SINV.EZCANCELFLAG (+)   = '0'

            AND ATB.GLBL_CMPY_CD (+)    = INV.GLBL_CMPY_CD
            AND ATB.AR_TRX_NUM (+)      = INV.INV_NUM
            AND ATB.EZCANCELFLAG (+)    = '0'

            AND BTC.GLBL_CMPY_CD        = INV.GLBL_CMPY_CD
            AND BTC.BILL_TO_CUST_CD     = INV.BILL_TO_CUST_CD
            AND BTC.EZCANCELFLAG        = '0'

            AND PTC.GLBL_CMPY_CD          = INV.GLBL_CMPY_CD
            AND PTC.PMT_TERM_CASH_DISC_CD = INV.PMT_TERM_CASH_DISC_CD
            AND PTC.EZCANCELFLAG          = '0'

            <!-- START 2018/11/06 T.Tomita [QC#28627,ADD] -->
            AND SINV.GLBL_CMPY_CD       = CTR.GLBL_CMPY_CD(+)
            AND SINV.DS_CONTR_PK        = CTR.DS_CONTR_PK(+)
            AND CTR.EZCANCELFLAG(+)     = '0'
            <!-- END 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- 2021/04/13 QC#57811 ADD START -->
            AND SINV.CUST_CARE_TKT_NUM        = CECH.TICKET_NUMBER(+)
            <!-- 2021/04/13 QC#57811 ADD END -->
        UNION ALL
        <!-- Waiting Consolidation -->
        SELECT
             'N'                                                        EASY_PAC_FLG
            ,INV.BILL_TO_CUST_CD                                        BILL_TO_CUST_CD
            ,BTC.LOC_NM                                                 BILL_TO_CUST_NM
            ,BTC.LOC_NUM                                                LOC_NUM
            ,INV.BILL_TO_CUST_ACCT_CD                                   BILL_TO_CUST_ACCT_CD
            ,INV.BILL_TO_CUST_ACCT_NM                                   BILL_TO_CUST_ACCT_NM
            ,INV.INV_NUM                                                INV_NUM
            ,INV.CUST_ISS_PO_NUM                                        CUST_ISS_PO_NUM
            ,INV.DS_BIZ_AREA_CD                                         DS_BIZ_AREA_CD
            ,SINV.DS_CONTR_NUM                                          DS_CONTR_NUM
            ,SINV.BLLG_PER_FROM_DT
                 || DECODE(SINV.BLLG_PER_TO_DT, NULL, '', '-')
                 || SINV.BLLG_PER_TO_DT                                 BLLG_PER
            ,SINV.SER_NUM                                               SER_NUM
            ,SINV.MDL_NM                                                MDL_NM
            ,INV.INV_DT                                                 INV_DT
            ,INV.INV_TP_CD                                              INV_TP_CD
            ,INV.INV_TOT_DEAL_NET_AMT                                   INV_TOT_DEAL_NET_AMT
            ,INV.INV_TOT_FUNC_NET_AMT                                   INV_TOT_FUNC_NET_AMT
            ,ATB.DEAL_RMNG_BAL_GRS_AMT                                  DEAL_RMNG_BAL_GRS_AMT
            ,ATB.FUNC_RMNG_BAL_GRS_AMT                                  FUNC_RMNG_BAL_GRS_AMT
            ,INV.PMT_TERM_CASH_DISC_CD                                  PMT_TERM_CASH_DISC_CD
            ,INV.PMT_TERM_CD                                            PMT_TERM_CD
            ,INV.PMT_TERM_CASH_DISC_DESC_TXT                            PMT_TERM_CASH_DISC_DESC_TXT
            ,PTC.PMT_TERM_CONSL_LAST_DOM_FLG                            PMT_TERM_CONSL_LAST_DOM_FLG
            ,PTC.PMT_TERM_CONSL_DUE_DAY                                 PMT_TERM_CONSL_DUE_DAY
            <!-- QC#7000 2016/04/15 add Start -->
            ,INV.ORIG_INV_NUM                                           ORIG_INV_NUM
            <!-- QC#7000 2016/04/15 add End -->
            <!-- QC#23604 add Start -->
            ,SINV.DS_CONTR_CATG_CD                                      DS_CONTR_CATG_CD
            <!-- START 2018/06/25 U.Kim [QC#26703,MOD] -->
            <!-- ,(SELECT -->
            <!--         SIL.FIRST_BLLG_ATTRB_VAL_TXT || ' ' || -->
            <!--         SIL.SCD_BLLG_ATTRB_VAL_TXT   || ' ' || -->
            <!--         SIL.THIRD_BLLG_ATTRB_VAL_TXT || ' ' || -->
            <!--         SIL.FRTH_BLLG_ATTRB_VAL_TXT  || ' ' || -->
            <!--         SIL.FIFTH_BLLG_ATTRB_VAL_TXT || ' ' || -->
            <!--         SIL.SIXTH_BLLG_ATTRB_VAL_TXT -->
            <!--     FROM -->
            <!--         SVC_INV_LINE    SIL -->
            <!--     WHERE -->
            <!--         SIL.GLBL_CMPY_CD    = SINV.GLBL_CMPY_CD -->
            <!--     AND SIL.SVC_INV_NUM     = SINV.SVC_INV_NUM -->
            <!--     AND SIL.EZCANCELFLAG    = '0' -->
            <!--     AND ROWNUM = 1 -->
            <!-- )                                                           IB_CONTROL_FIELDS -->
            ,(SELECT SIL.FIRST_BLLG_ATTRB_VAL_TXT FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS FIRST_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.SCD_BLLG_ATTRB_VAL_TXT   FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS SCD_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.THIRD_BLLG_ATTRB_VAL_TXT FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS THIRD_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.FRTH_BLLG_ATTRB_VAL_TXT  FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS FRTH_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.FIFTH_BLLG_ATTRB_VAL_TXT FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS FIFTH_BLLG_ATTRB_VAL_TXT
            ,(SELECT SIL.SIXTH_BLLG_ATTRB_VAL_TXT FROM SVC_INV_LINE SIL WHERE SIL.GLBL_CMPY_CD = SINV.GLBL_CMPY_CD AND SIL.SVC_INV_NUM = SINV.SVC_INV_NUM AND SIL.EZCANCELFLAG = '0' AND ROWNUM = 1 ) AS SIXTH_BLLG_ATTRB_VAL_TXT
            <!-- END 2018/06/25 U.Kim [QC#26703,MOD] -->
            ,SINV.INV_DUE_DT                                            INV_DUE_DT
            <!-- QC#23604 add ENd -->
            <!-- START 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- START 2022/03/22  [QC#59683,Mod] -->
            <!-- ,CTR.CONTR_LINK_NUM                                         CONTR_LINK_NUM-->
            ,SINV.CONTR_LINK_NUM                                         CONTR_LINK_NUM
            <!-- END   2022/03/22  [QC#59683,Mod] -->
            <!-- END 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- 2021/04/13 QC#57811 ADD START -->
            ,NVL(CECH.CONS_BILL_STATUS, 'Y')                          CONS_BILL_STATUS
            <!-- 2021/04/13 QC#57811 ADD END -->
        FROM
             INV                INV
            ,SVC_INV            SINV
            ,AR_TRX_BAL         ATB
            ,BILL_TO_CUST       BTC
            ,PMT_TERM_CASH_DISC PTC
            <!-- START 2018/11/06 T.Tomita [QC#28627,ADD] -->
            ,DS_CONTR           CTR
            <!-- END 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- 2021/04/13 QC#57811 ADD START -->
            ,CANON_E193_CS_HEADERS CECH
            <!-- 2021/04/13 QC#57811 ADD END -->
        WHERE
                INV.GLBL_CMPY_CD            = #glblCmpyCd#
            <!-- QC#17868 add Start -->
            AND INV.INV_PRINT_STS_CD       != '1'
            <!-- QC#17868 add End -->
            <!-- QC#17962 del Start -->
            <!-- AND INV.SYS_SRC_CD             != #excludeSysSrcCd# -->
            <!-- QC#17962 del End -->
            AND INV.EZCANCELFLAG            = '0'
            AND EXISTS (
                SELECT
                    '1'
                FROM
                    INV_PRT_CTRL IPC
                WHERE
                        IPC.GLBL_CMPY_CD     = INV.GLBL_CMPY_CD
                    AND IPC.INV_NUM          = INV.INV_NUM
                    AND IPC.CONSL_BILL_NUM   IS NULL
                    AND IPC.CONSL_BILL_FLG   = 'Y'
                    AND IPC.INV_OTPT_REQ_FLG = 'N'
                    AND IPC.EZCANCELFLAG     = '0'
            )

            AND NOT EXISTS (
                SELECT
                    '1'
                FROM
                    ORD_CATG_BIZ_CTX CTX
                WHERE
                        CTX.GLBL_CMPY_CD       = INV.GLBL_CMPY_CD
                    AND (CTX.DS_ORD_TP_CD      = INV.DS_ORD_TP_CD OR CTX.DS_ORD_TP_CD IS NULL)
                    AND CTX.DS_ORD_CATG_CD     = INV.DS_ORD_CATG_CD
                    AND CTX.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCdEasyPAC#
                    AND CTX.EZCANCELFLAG       = '0'
            )

            AND NOT EXISTS (
                SELECT
                    '1'
                FROM
                    CONSL_BILL_LINE CBL
                WHERE
                        CBL.GLBL_CMPY_CD      = INV.GLBL_CMPY_CD
                    AND CBL.CONSL_BILL_TRX_ID = INV.INV_NUM
                    AND CBL.EZCANCELFLAG      = '0'
            )

            AND SINV.GLBL_CMPY_CD (+)       = INV.GLBL_CMPY_CD
            AND SINV.SVC_INV_NUM (+)        = INV.INV_NUM
            AND SINV.EZCANCELFLAG (+)       = '0'

            AND ATB.GLBL_CMPY_CD (+)        = INV.GLBL_CMPY_CD
            AND ATB.AR_TRX_NUM (+)          = INV.INV_NUM
            AND ATB.EZCANCELFLAG (+)        = '0'

            AND BTC.GLBL_CMPY_CD            = INV.GLBL_CMPY_CD
            AND BTC.BILL_TO_CUST_CD         = INV.BILL_TO_CUST_CD
            AND BTC.EZCANCELFLAG            = '0'

            AND PTC.GLBL_CMPY_CD            = INV.GLBL_CMPY_CD
            AND PTC.PMT_TERM_CASH_DISC_CD   = INV.PMT_TERM_CASH_DISC_CD
            AND PTC.EZCANCELFLAG            = '0'

            <!-- START 2018/11/06 T.Tomita [QC#28627,ADD] -->
            AND SINV.GLBL_CMPY_CD           = CTR.GLBL_CMPY_CD(+)
            AND SINV.DS_CONTR_PK            = CTR.DS_CONTR_PK(+)
            AND CTR.EZCANCELFLAG(+)         = '0'
            <!-- END 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- 2021/04/13 QC#57811 ADD START -->
            AND SINV.CUST_CARE_TKT_NUM        = CECH.TICKET_NUMBER(+)
            <!-- 2021/04/13 QC#57811 ADD END -->
        UNION ALL
        <!-- EasyPAC -->
        SELECT
             'Y'                                                        EASY_PAC_FLG
            ,INV.BILL_TO_CUST_CD                                        BILL_TO_CUST_CD
            ,BTC.LOC_NM                                                 BILL_TO_CUST_NM
            ,BTC.LOC_NUM                                                LOC_NUM
            ,INV.BILL_TO_CUST_ACCT_CD                                   BILL_TO_CUST_ACCT_CD
            ,INV.BILL_TO_CUST_ACCT_NM                                   BILL_TO_CUST_ACCT_NM
            ,INV.INV_NUM                                                INV_NUM
            ,NULL                                                       CUST_ISS_PO_NUM
            ,NULL                                                       DS_BIZ_AREA_CD
            ,NULL                                                       DS_CONTR_NUM
            ,NULL                                                       BLLG_PER
            ,NULL                                                       SER_NUM
            ,NULL                                                       MDL_NM
            ,INV.INV_DT                                                 INV_DT
            ,INV.INV_TP_CD                                              INV_TP_CD
            ,INV.INV_TOT_DEAL_NET_AMT                                   INV_TOT_DEAL_NET_AMT
            ,INV.INV_TOT_FUNC_NET_AMT                                   INV_TOT_FUNC_NET_AMT
            ,ATB.DEAL_RMNG_BAL_GRS_AMT                                  DEAL_RMNG_BAL_GRS_AMT
            ,ATB.FUNC_RMNG_BAL_GRS_AMT                                  FUNC_RMNG_BAL_GRS_AMT
            ,NULL                                                       PMT_TERM_CASH_DISC_CD
            ,NULL                                                       PMT_TERM_CD
            ,NULL                                                       PMT_TERM_CASH_DISC_DESC_TXT
            ,NULL                                                       PMT_TERM_CONSL_LAST_DOM_FLG
            ,NULL                                                       PMT_TERM_CONSL_DUE_DAY
            <!-- QC#7000 2016/04/15 add Start -->
            ,INV.ORIG_INV_NUM                                           ORIG_INV_NUM
            <!-- QC#7000 2016/04/15 add End -->
            <!-- QC#23604 add Start -->
            ,NULL                                                       DS_CONTR_CATG_CD
            <!-- START 2018/06/25 U.Kim [QC#26703,MOD] -->
            <!-- ,NULL                                                       IB_CONTROL_FIELDS -->
            ,NULL                                                       FIRST_BLLG_ATTRB_VAL_TXT
            ,NULL                                                       SCD_BLLG_ATTRB_VAL_TXT
            ,NULL                                                       THIRD_BLLG_ATTRB_VAL_TXT
            ,NULL                                                       FRTH_BLLG_ATTRB_VAL_TXT
            ,NULL                                                       FIFTH_BLLG_ATTRB_VAL_TXT
            ,NULL                                                       SIXTH_BLLG_ATTRB_VAL_TXT
            <!-- END 2018/06/25 U.Kim [QC#26703,MOD] -->
            ,NULL                                                       SVC_INV_DUE_DT
            <!-- QC#23604 add ENd -->
            <!-- START 2018/11/06 T.Tomita [QC#28627,ADD] -->
            ,NULL                                                       CONTR_LINK_NUM
            <!-- END 2018/11/06 T.Tomita [QC#28627,ADD] -->
            <!-- 2021/04/13 QC#57811 ADD START -->
            ,'Y'                                                        CONS_BILL_STATUS
            <!-- 2021/04/13 QC#57811 ADD END -->
        FROM
             INV            INV
            ,AR_TRX_BAL     ATB
            ,BILL_TO_CUST   BTC
        WHERE
                INV.GLBL_CMPY_CD          = #glblCmpyCd#
            AND INV.INV_DT            &lt;= #easyPacInvDt#
            AND INV.SYS_SRC_CD           != #excludeSysSrcCd#
            AND INV.EZCANCELFLAG          = '0'
            AND EXISTS (
                SELECT
                    '1'
                FROM
                    INV_PRT_CTRL IPC
                WHERE
                        IPC.GLBL_CMPY_CD            = INV.GLBL_CMPY_CD
                    AND IPC.INV_NUM                 = INV.INV_NUM
                    AND IPC.CONSL_BILL_NUM          IS NULL
                    AND IPC.CONSL_BILL_FLG          = 'Y'
                    AND IPC.INV_OTPT_REQ_FLG        = 'N'
                    AND IPC.SPLY_PGM_INV_RVW_FLG    = 'Y'
                    AND IPC.EZCANCELFLAG            = '0'
            )
            AND EXISTS (
                SELECT
                    '1'
                FROM
                    ORD_CATG_BIZ_CTX CTX
                WHERE
                        CTX.GLBL_CMPY_CD       = INV.GLBL_CMPY_CD
                    AND (CTX.DS_ORD_TP_CD      = INV.DS_ORD_TP_CD OR CTX.DS_ORD_TP_CD IS NULL)
                    AND CTX.DS_ORD_CATG_CD     = INV.DS_ORD_CATG_CD
                    AND CTX.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCdEasyPAC#
                    AND CTX.EZCANCELFLAG       = '0'
            )

            AND NOT EXISTS (
                SELECT
                    '1'
                FROM
                    CONSL_BILL_LINE CBL
                WHERE
                        CBL.GLBL_CMPY_CD      = INV.GLBL_CMPY_CD
                    AND CBL.CONSL_BILL_TRX_ID = INV.INV_NUM
                    AND CBL.EZCANCELFLAG      = '0'
            )

            AND ATB.GLBL_CMPY_CD (+)    = INV.GLBL_CMPY_CD
            AND ATB.AR_TRX_NUM (+)      = INV.INV_NUM
            AND ATB.EZCANCELFLAG (+)    = '0'

            AND BTC.GLBL_CMPY_CD        = INV.GLBL_CMPY_CD
            AND BTC.BILL_TO_CUST_CD     = INV.BILL_TO_CUST_CD
            AND BTC.EZCANCELFLAG        = '0'

        ORDER BY
            <!-- START 2018/11/06 T.Tomita [QC#28627,MOD] -->
            <!--  EASY_PAC_FLG -->
             CONTR_LINK_NUM
            ,EASY_PAC_FLG
            <!-- END 2018/11/06 T.Tomita [QC#28627,MOD] -->
            ,BILL_TO_CUST_CD
            ,INV_NUM
    </statement>
    <!-- QC#22278 -->
    <statement id="getAppliedInvoice" parameterClass="Map" resultClass="Map">
        SELECT 
            A.AR_TRX_NUM
        FROM 
            AR_CASH_APP A
           ,AR_CASH_APP B
        WHERE 1=1
        AND A.GLBL_CMPY_CD = #glblCmpyCd#
        AND A.EZCANCELFLAG = '0'
        AND B.GLBL_CMPY_CD = #glblCmpyCd#
        AND B.EZCANCELFLAG = '0'
        AND A.RCPT_NUM = B.RCPT_NUM
        AND B.AR_TRX_NUM = #arTrxNum#  <!-- Credit Memo -->
        AND A.AR_TRX_NUM != #arTrxNum# <!-- not my self -->
    </statement>
    <!-- START 2022/11/29 S.Nakatani [QC#60140,ADD] -->
    <statement id="getPaymentTermFlag" parameterClass="Map" resultClass="String">
        SELECT
           C.INV_USED_CONSL_PMT_TERM_FLG
        FROM 
           BILL_TO_CUST    A
           ,PTY_LOC_WRK     B
           ,LINE_BIZ_TP     C
        WHERE 
           A.GLBL_CMPY_CD     = #glblCmpyCd#
           AND A.BILL_TO_CUST_CD  = #billToCustCd#
           AND A.EZCANCELFLAG     = '0'
           AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
           AND A.PTY_LOC_PK       = B.PTY_LOC_PK
           AND B.EZCANCELFLAG     = '0'
           AND B.GLBL_CMPY_CD     = C.GLBL_CMPY_CD
           AND B.LINE_BIZ_TP_CD   = C.LINE_BIZ_TP_CD
           AND C.EZCANCELFLAG     = '0'
    </statement>
    <!-- END 2022/11/29 S.Nakatani [QC#60140,ADD] -->

</sqlMap>
