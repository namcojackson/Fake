<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWZC157001">

    <statement id="selectDsOrdTp" parameterClass="Map" resultClass="Map">
        SELECT
             DOTPD.DEF_PRC_CATG_CD
            ,DOTPD.DEF_MAINT_PRC_CATG_CD
            ,PC.CCY_CD
            ,COT.INV_TP_CD
            ,DIP.TAX_CALC_FLG
            ,DIP.TAX_EXEM_FLG
            ,DIP.TAX_EXEM_RSN_CD
        FROM
             DS_ORD_TP DOT
            ,DS_ORD_TP_PROC_DFN DOTPD
            ,PRC_CATG PC
            ,CPO_ORD_TP COT
            ,DS_INV_TP DIP
        WHERE
            DOT.GLBL_CMPY_CD = #glblCmpyCd#
        AND DOT.EZCANCELFLAG = '0'
        AND DOT.DS_ORD_TP_CD = #dsOrdTpCd#
        AND DOT.GLBL_CMPY_CD = DOTPD.GLBL_CMPY_CD(+)
        AND DOT.EZCANCELFLAG = DOTPD.EZCANCELFLAG(+)
        AND DOT.DS_ORD_TP_CD = DOTPD.DS_ORD_TP_CD(+)
        AND DOTPD.GLBL_CMPY_CD = PC.GLBL_CMPY_CD(+)
        AND DOTPD.EZCANCELFLAG = PC.EZCANCELFLAG(+)
        AND DOTPD.DEF_PRC_CATG_CD = PC.PRC_CATG_CD(+)
        AND DOT.GLBL_CMPY_CD = COT.GLBL_CMPY_CD(+)
        AND DOT.EZCANCELFLAG = COT.EZCANCELFLAG(+)
        AND DOT.CPO_ORD_TP_CD = COT.CPO_ORD_TP_CD(+)
        AND DOTPD.GLBL_CMPY_CD = DIP.GLBL_CMPY_CD(+)
        AND DOTPD.EZCANCELFLAG = DIP.EZCANCELFLAG(+)
        AND DOTPD.DS_INV_TP_CD = DIP.DS_INV_TP_CD(+)
    </statement>

    <statement id="selectDsAcctCust" parameterClass="Map" resultClass="Map">
        SELECT
             S.DS_ACCT_NM
            ,S.DS_CUST_SIC_CD
            ,S.LOC_NUM
            ,S.DS_ACCT_CLS_CD
            ,S.DS_ACCT_TP_CD
            ,S.DS_ACCT_DLR_CD
            ,DAGA.DS_ACCT_GRP_CD
            ,S.COA_CH_CD
            ,S.DS_TAX_GRP_EXEM_CD
            ,NVL(DTGE.DS_TAX_GRP_EXEM_RESL_FLG, 'N') DS_TAX_GRP_EXEM_RESL_FLG
        FROM
             SELL_TO_CUST S
            ,( SELECT
                  GLBL_CMPY_CD
                , EZCANCELFLAG
                , DS_ACCT_NUM
                , DS_ACCT_GRP_CD
               FROM DS_ACCT_GRP_ASG DAGA
               WHERE
                    DAGA.GLBL_CMPY_CD = #glblCmpyCd#
                AND DAGA.EZCANCELFLAG = '0'
                AND DAGA.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (DAGA.EFF_THRU_DT &gt;= #prcBaseDt# OR DAGA.EFF_THRU_DT IS NULL )
            ) DAGA
            ,DS_TAX_GRP_EXEM DTGE
        WHERE
            S.GLBL_CMPY_CD = #glblCmpyCd#
        AND S.EZCANCELFLAG = '0'
        AND S.SELL_TO_CUST_CD = #dsAcctNum#
        AND S.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (S.EFF_THRU_DT &gt;= #prcBaseDt# OR S.EFF_THRU_DT IS NULL )
        AND S.GLBL_CMPY_CD = DAGA.GLBL_CMPY_CD(+)
        AND S.EZCANCELFLAG = DAGA.EZCANCELFLAG(+)
        AND S.SELL_TO_CUST_CD = DAGA.DS_ACCT_NUM(+)
        AND S.GLBL_CMPY_CD = DTGE.GLBL_CMPY_CD(+)
        AND S.EZCANCELFLAG = DTGE.EZCANCELFLAG(+)
        AND S.DS_TAX_GRP_EXEM_CD = DTGE.DS_TAX_GRP_EXEM_CD(+)
    </statement>

    <statement id="selectBillToCust" parameterClass="Map" resultClass="Map">
        SELECT
            BTC.DS_TAX_GRP_EXEM_CD
           ,NVL(DTGE.DS_TAX_GRP_EXEM_RESL_FLG, 'N') DS_TAX_GRP_EXEM_RESL_FLG
        FROM
            BILL_TO_CUST BTC
           ,DS_TAX_GRP_EXEM DTGE
        WHERE
            BTC.GLBL_CMPY_CD = #glblCmpyCd#
        AND BTC.EZCANCELFLAG = '0'
        AND BTC.BILL_TO_CUST_CD = #billToCustCd#
        AND BTC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (BTC.EFF_THRU_DT &gt;= #prcBaseDt# OR BTC.EFF_THRU_DT IS NULL )
        AND BTC.GLBL_CMPY_CD = DTGE.GLBL_CMPY_CD(+)
        AND BTC.EZCANCELFLAG = DTGE.EZCANCELFLAG(+)
        AND BTC.DS_TAX_GRP_EXEM_CD = DTGE.DS_TAX_GRP_EXEM_CD(+)
    </statement>

    <statement id="selectShipToCust" parameterClass="Map" resultClass="Map">
        SELECT
            STC.DS_TAX_GRP_EXEM_CD
           ,NVL(DTGE.DS_TAX_GRP_EXEM_RESL_FLG, 'N') DS_TAX_GRP_EXEM_RESL_FLG
           ,STC.GEO_CD
           ,STC.DS_INSD_CTY_LIMIT_FLG
        FROM
            SHIP_TO_CUST STC
           ,DS_TAX_GRP_EXEM DTGE
        WHERE
            STC.GLBL_CMPY_CD = #glblCmpyCd#
        AND STC.EZCANCELFLAG = '0'
        AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
        AND STC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (STC.EFF_THRU_DT &gt;= #prcBaseDt# OR STC.EFF_THRU_DT IS NULL )
        AND STC.GLBL_CMPY_CD = DTGE.GLBL_CMPY_CD(+)
        AND STC.EZCANCELFLAG = DTGE.EZCANCELFLAG(+)
        AND STC.DS_TAX_GRP_EXEM_CD = DTGE.DS_TAX_GRP_EXEM_CD(+)
    </statement>

    <statement id="selectMdse" parameterClass="Map" resultClass="Map">
        SELECT 
             M2.ORD_TAKE_MDSE_CD
            ,M2.MDSE_CD
            ,M2.MDSE_NM
            ,M2.MDSE_TP_CD
            ,M2.FIRST_PROD_CTRL_CD
            ,M2.SCD_PROD_CTRL_CD
            ,M2.THIRD_PROD_CTRL_CD
            ,M2.FRTH_PROD_CTRL_CD
            ,M2.FIFTH_PROD_CTRL_CD
            <!-- 2018/04/24 QC#22569 add start -->
            ,M2.SLS_MAT_GRP_CD_01
            ,M2.SLS_MAT_GRP_CD_02
            ,M2.SLS_MAT_GRP_CD_03
            <!-- 2018/04/24 QC#22569 add end -->
            ,M2.MDSE_ITEM_TP_CD
            ,M2.MDSE_ITEM_CLS_TP_CD
            ,M2.COA_MDSE_TP_CD
            ,M2.COA_PROD_CD
            ,M2.MKT_MDL_CD
            ,M2.MKT_MDL_SEG_CD
            ,M2.SVC_ALLOC_TP_CD
            ,SAT.SVC_ALLOC_TRX_TP_NM
            ,M2.TAX_EXEM_TP_CD
            ,BMSP.IN_POUND_WT
            ,BMSP.PKG_UOM_CD
            ,MSP.IN_EACH_QTY
            ,M2.INVTY_CTRL_FLG
        FROM (
            SELECT
                 OTM.ORD_TAKE_MDSE_CD
                ,M.MDSE_NM
                ,M.FIRST_PROD_CTRL_CD
                ,M.SCD_PROD_CTRL_CD
                ,M.THIRD_PROD_CTRL_CD
                ,M.FRTH_PROD_CTRL_CD
                ,M.FIFTH_PROD_CTRL_CD
                <!-- 2018/04/24 QC#22569 add start -->
                ,M.SLS_MAT_GRP_CD_01
                ,M.SLS_MAT_GRP_CD_02
                ,M.SLS_MAT_GRP_CD_03
                <!-- 2018/04/24 QC#22569 add end -->
                ,M.COA_PROD_CD
                ,M.GLBL_CMPY_CD
                ,M.EZCANCELFLAG
                ,M.MDSE_CD
                ,M.MDSE_TP_CD
                ,M.MDSE_ITEM_TP_CD
                ,M.MDSE_ITEM_CLS_TP_CD
                ,M.COA_MDSE_TP_CD
                ,M.MKT_MDL_CD
                ,M.MKT_MDL_SEG_CD
                ,M.SVC_ALLOC_TP_CD
                ,M.TAX_EXEM_TP_CD
                ,M.INVTY_CTRL_FLG
            FROM
                 ORD_TAKE_MDSE OTM
                ,MDSE M
            WHERE
                OTM.GLBL_CMPY_CD = #glblCmpyCd#
            AND OTM.EZCANCELFLAG = '0'
            AND OTM.ORD_TAKE_MDSE_CD = SUBSTR(#mdseCd#, 1, 8)
            AND OTM.GLBL_CMPY_CD = M.GLBL_CMPY_CD
            AND OTM.EZCANCELFLAG = M.EZCANCELFLAG
            AND OTM.MDSE_CD = M.MDSE_CD
          UNION ALL
            SELECT
                 NULL ORD_TAKE_MDSE_CD
                ,M.MDSE_NM
                ,M.FIRST_PROD_CTRL_CD
                ,M.SCD_PROD_CTRL_CD
                ,M.THIRD_PROD_CTRL_CD
                ,M.FRTH_PROD_CTRL_CD
                ,M.FIFTH_PROD_CTRL_CD
                <!-- 2018/04/24 QC#22569 add start -->
                ,M.SLS_MAT_GRP_CD_01
                ,M.SLS_MAT_GRP_CD_02
                ,M.SLS_MAT_GRP_CD_03
                <!-- 2018/04/24 QC#22569 add end -->
                ,M.COA_PROD_CD
                ,M.GLBL_CMPY_CD
                ,M.EZCANCELFLAG
                ,M.MDSE_CD
                ,M.MDSE_TP_CD
                ,M.MDSE_ITEM_TP_CD
                ,M.MDSE_ITEM_CLS_TP_CD
                ,M.COA_MDSE_TP_CD
                ,M.MKT_MDL_CD
                ,M.MKT_MDL_SEG_CD
                ,M.SVC_ALLOC_TP_CD
                ,M.TAX_EXEM_TP_CD
                ,M.INVTY_CTRL_FLG
            FROM
                 MDSE M
            WHERE
                M.GLBL_CMPY_CD = #glblCmpyCd#
            AND M.EZCANCELFLAG = '0'
            AND M.MDSE_CD = #mdseCd#
            AND NOT EXISTS (
                    SELECT 1 FROM ORD_TAKE_MDSE OTM
                    WHERE OTM.GLBL_CMPY_CD = #glblCmpyCd#
                    AND OTM.ORD_TAKE_MDSE_CD = SUBSTR(M.MDSE_CD, 1 , 8)
                    AND OTM.EZCANCELFLAG = '0'
                )
            ) M2
            ,SVC_ALLOC_TP SAT
            ,(
                SELECT
                    MSP.GLBL_CMPY_CD
                   ,MSP.EZCANCELFLAG
                   ,MSP.MDSE_CD
                   ,MSP.IN_POUND_WT
                   ,MSP.PKG_UOM_CD
                   ,MSP.IN_EACH_QTY
                FROM
                    MDSE_STORE_PKG MSP
                WHERE
                    MSP.GLBL_CMPY_CD = #glblCmpyCd#
                AND MSP.EZCANCELFLAG = '0'
                AND MSP.BASE_PKG_UOM_CD IS NOT NULL
            ) BMSP
           ,MDSE_STORE_PKG MSP
        WHERE
            M2.GLBL_CMPY_CD       = SAT.GLBL_CMPY_CD(+)
        AND M2.EZCANCELFLAG       = SAT.EZCANCELFLAG(+)
        AND M2.SVC_ALLOC_TP_CD    = SAT.SVC_ALLOC_TP_CD(+)
        AND M2.GLBL_CMPY_CD       = BMSP.GLBL_CMPY_CD
        AND M2.EZCANCELFLAG       = BMSP.EZCANCELFLAG
        AND M2.MDSE_CD            = BMSP.MDSE_CD
        AND M2.GLBL_CMPY_CD       = MSP.GLBL_CMPY_CD(+)
        AND M2.EZCANCELFLAG       = MSP.EZCANCELFLAG(+)
        AND M2.MDSE_CD            = MSP.MDSE_CD(+)
        AND MSP.PKG_UOM_CD(+)     = #pkgUomCd#
        AND ROWNUM = 1
    </statement>

    <statement id="getChildMdse" parameterClass="Map" resultClass="Map">
        SELECT
                 M.MDSE_CD
                ,M.MDSE_TP_CD
                ,MSP.IN_POUND_WT * CHILD_MDSE_QTY AS IN_POUND_WT
        FROM (
            SELECT
                 M.GLBL_CMPY_CD
                ,M.EZCANCELFLAG
                ,M.MDSE_CD
                ,M.MDSE_TP_CD
                ,C.CHILD_MDSE_QTY
            FROM
                 CMPSN C
                ,MDSE M
            WHERE
                C.GLBL_CMPY_CD           = #glblCmpyCd#
            AND C.EZCANCELFLAG           = '0'
            AND C.PRNT_MDSE_CD           = #mdseCd#
            AND #prcBaseDt# BETWEEN C.EFF_FROM_DT AND NVL(C.EFF_THRU_DT, '99991231')
            AND C.GLBL_CMPY_CD           = M.GLBL_CMPY_CD
            AND C.EZCANCELFLAG           = M.EZCANCELFLAG
            AND C.CHILD_MDSE_CD          = M.MDSE_CD
            UNION ALL
            SELECT
                 M.GLBL_CMPY_CD
                ,M.EZCANCELFLAG
                ,M.MDSE_CD
                ,M.MDSE_TP_CD
                ,C.CHILD_MDSE_QTY
            FROM
                 CMPSN C
                ,ORD_TAKE_MDSE OTM
                ,MDSE M
            WHERE
                C.GLBL_CMPY_CD           = #glblCmpyCd#
            AND C.EZCANCELFLAG           = '0'
            AND C.PRNT_MDSE_CD           = #mdseCd#
            AND #prcBaseDt# BETWEEN C.EFF_FROM_DT AND NVL(C.EFF_THRU_DT, '99991231')
            AND C.GLBL_CMPY_CD           = OTM.GLBL_CMPY_CD
            AND C.EZCANCELFLAG           = OTM.EZCANCELFLAG
            AND C.CHILD_ORD_TAKE_MDSE_CD = OTM.ORD_TAKE_MDSE_CD
            AND OTM.GLBL_CMPY_CD         = M.GLBL_CMPY_CD
            AND OTM.EZCANCELFLAG         = M.EZCANCELFLAG
            AND OTM.MDSE_CD              = M.MDSE_CD
            ) M
            ,MDSE_STORE_PKG MSP
        WHERE
            M.GLBL_CMPY_CD        = MSP.GLBL_CMPY_CD
        AND M.EZCANCELFLAG        = MSP.EZCANCELFLAG
        AND M.MDSE_CD             = MSP.MDSE_CD
        AND MSP.PRIM_PKG_UOM_FLG = 'Y'
    </statement>

    <statement id="selectTaxArea" parameterClass="Map" resultClass="String">
        SELECT
            TA.TAX_AREA_ID
        FROM
            TAX_AREA TA
        <isNotNull property="cntyNm">
           ,CNTY C
        </isNotNull>
        WHERE
            TA.GLBL_CMPY_CD = #glblCmpyCd#
        AND TA.EZCANCELFLAG = '0'
        <isNotNull property="cntyNm">
        AND TA.GLBL_CMPY_CD = C.GLBL_CMPY_CD
        AND TA.CNTY_PK = C.CNTY_PK
        AND TA.EZCANCELFLAG = C.EZCANCELFLAG
        AND C.CNTY_NM = #cntyNm#
        </isNotNull>
        <isNull property="cntyNm">
        AND TA.CNTY_PK IS NULL
        </isNull>
        <isNotNull property="ctyAddr">
        AND TA.CTY_ADDR = #ctyAddr#
        </isNotNull>
        <isNull property="ctyAddr">
        AND TA.CTY_ADDR IS NULL
        </isNull>
        AND TA.ST_CD = #stCd#
    </statement>

    <statement id="selectRtlWh" parameterClass="Map" resultClass="Map">
        SELECT
            RW.GEO_CD
           ,RW.FIRST_LINE_ADDR
           ,RW.SCD_LINE_ADDR
           ,RW.CTY_ADDR
           ,RW.ST_CD
           ,RW.POST_CD
           ,RW.CTRY_CD
           ,C.CNTY_NM
        FROM
            RTL_WH RW
           ,CNTY C
        WHERE
            RW.GLBL_CMPY_CD = #glblCmpyCd#
        AND RW.EZCANCELFLAG = '0'
        AND RW.RTL_WH_CD = #rtlWhCd#
        AND RW.GLBL_CMPY_CD = C.GLBL_CMPY_CD(+)
        AND RW.EZCANCELFLAG = C.EZCANCELFLAG(+)
        AND RW.CNTY_PK = C.CNTY_PK(+)
    </statement>

    <statement id="selectToc" parameterClass="Map" resultClass="Map">
        SELECT
            PSN.GEO_CD
           ,PSN.DS_INSD_CTY_LIMIT_FLG
           ,PSN.FIRST_LINE_ADDR
           ,PSN.SCD_LINE_ADDR
           ,PSN.CTY_ADDR
           ,PSN.ST_CD
           ,PSN.POST_CD
           ,PSN.CTRY_CD
           ,C.CNTY_NM
        FROM
            TOC TOC
           ,ORG_FUNC_ASG OFA
           ,S21_PSN PSN
           ,CNTY C
        WHERE
            TOC.GLBL_CMPY_CD = #glblCmpyCd#
        AND TOC.EZCANCELFLAG = '0'
        AND TOC.TOC_CD = #slsRepOrSlsTeamTocCd#
        AND TOC.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD
        AND TOC.EZCANCELFLAG = OFA.EZCANCELFLAG
        AND TOC.TOC_CD = OFA.TOC_CD
        AND OFA.GLBL_CMPY_CD = PSN.GLBL_CMPY_CD
        AND OFA.EZCANCELFLAG = PSN.EZCANCELFLAG
        AND OFA.PSN_CD = PSN.PSN_CD
        AND PSN.GLBL_CMPY_CD = C.GLBL_CMPY_CD(+)
        AND PSN.EZCANCELFLAG = C.EZCANCELFLAG(+)
        AND PSN.CNTY_PK = C.CNTY_PK(+)
    </statement>

    <statement id="selectPriceList" parameterClass="Map" resultClass="Map">
        SELECT
            PLV.PRTY_NUM
           ,PLV.PRC_CATG_CD
           ,PLV.CCY_CD
           ,PLV.DEF_PRC_TP_FLG
           ,PTA.PRC_TRX_AUDC_PK
        FROM
            (
             <!-- PRTY = 1 - 6 -->
             SELECT
                 /*+ NO_EXPAND */  <!-- 2018/11/29 QC#28432 Add -->
                 PC.GLBL_CMPY_CD
                ,PC.EZCANCELFLAG
                ,CASE 
                     WHEN PCA.CSMP_NUM_01 IS NOT NULL THEN '1'
                     WHEN PCA.CSMP_NUM_02 IS NOT NULL THEN '1'
                     WHEN PCA.CSMP_NUM_03 IS NOT NULL THEN '1'
                     WHEN PCA.LINE_BIZ_TP_CD_01 IS NOT NULL AND PCA.DS_ACCT_NUM_01 IS NOT NULL THEN '2'
                     WHEN PCA.LINE_BIZ_TP_CD_01 IS NOT NULL AND PCA.DS_ACCT_NUM_02 IS NOT NULL THEN '2'
                     WHEN PCA.LINE_BIZ_TP_CD_01 IS NOT NULL AND PCA.DS_ACCT_NUM_03 IS NOT NULL THEN '2'
                     WHEN PCA.DS_ACCT_NUM_01 IS NOT NULL THEN '3'
                     WHEN PCA.DS_ACCT_NUM_02 IS NOT NULL THEN '3'
                     WHEN PCA.DS_ACCT_NUM_03 IS NOT NULL THEN '3'
                     WHEN PCA.PRC_GRP_PK_01 IS NOT NULL THEN '4'
                     WHEN PCA.PRC_GRP_PK_02 IS NOT NULL THEN '4'
                     WHEN PCA.PRC_GRP_PK_03 IS NOT NULL THEN '4'
                     WHEN PCA.COA_CH_CD_01 IS NOT NULL THEN '5'
                     ELSE '6'
                 END AS PRTY_NUM
                ,PC.PRC_CATG_CD
                ,PC.CCY_CD
                ,PC.PRC_LIST_TP_CD
                ,PCR.DEF_PRC_TP_FLG
             FROM
                 PRC_CATG PC
                ,PRC_CTX_RELN PCR
                ,PRC_CUST_AUDC PCA
             WHERE
                     PC.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND PC.EZCANCELFLAG        = '0'
                 AND PC.ACTV_FLG            = #actvFlg#
                 AND PC.DEL_FLG             = #delFlg#
                 AND PC.EFF_FROM_DT         &lt;= #prcBaseDt#
                 AND (PC.EFF_THRU_DT        &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL)
                 AND PC.GLBL_CMPY_CD        = PCR.GLBL_CMPY_CD
                 AND PC.EZCANCELFLAG        = PCR.EZCANCELFLAG
                 AND PC.PRC_LIST_TP_CD      = PCR.PRC_LIST_TP_CD
                 AND PCR.PRC_CTX_TP_CD      = #prcCtxTpCd#
                 AND PC.GLBL_CMPY_CD        = PCA.GLBL_CMPY_CD
                 AND PC.EZCANCELFLAG        = PCA.EZCANCELFLAG
                 AND PC.PRC_CATG_CD         = PCA.PRC_CATG_CD
                 AND PCA.PUB_FLG_01         = #pubFlg_N#
                 <isNotNull property="lineBizTpCd">
                 AND (PCA.LINE_BIZ_TP_CD_01 = #lineBizTpCd#  OR PCA.LINE_BIZ_TP_CD_01 IS NULL)
                 </isNotNull>
                 AND (PCA.DS_ACCT_NUM_01    = #dsAcctNum# OR PCA.DS_ACCT_NUM_01 IS NULL)
                 AND (PCA.COA_CH_CD_01      = #coaChCd01# OR PCA.COA_CH_CD_01 IS NULL)
                 AND (PCA.DS_ACCT_GRP_CD_01 = #dsAcctGrpCd#  OR PCA.DS_ACCT_GRP_CD_01 IS NULL)
                 AND (PCA.COA_BR_CD_01      = #coaBrCd#  OR PCA.COA_BR_CD_01 IS NULL)
                 AND (PCA.CSMP_NUM_01       IS NULL
                      OR EXISTS(
                                SELECT
                                    CCV1.CSMP_NUM
                                FROM
                                    (
                                     SELECT
                                         CC.GLBL_CMPY_CD
                                        ,CC.CSMP_NUM
                                     FROM 
                                         CSMP_CONTR CC
                                     WHERE
                                         CC.GLBL_CMPY_CD            = #glblCmpyCd#
                                         AND CC.DS_ACCT_NUM         = #dsAcctNum#
                                         AND CC.CSMP_CONTR_ACTV_FLG = #actvFlg#
                                         AND CC.EFF_FROM_DT         &lt;= #prcBaseDt#
                                         AND (CC.EFF_THRU_DT        &gt;= #prcBaseDt# OR CC.EFF_THRU_DT IS NULL )
                                         AND CC.EZCANCELFLAG        = '0'
                                    ) CCV1
                                WHERE
                                    PCA.GLBL_CMPY_CD    = CCV1.GLBL_CMPY_CD
                                    AND PCA.CSMP_NUM_01 = CCV1.CSMP_NUM
                               )
                     )
                 AND (PCA.PRC_GRP_PK_01 IS NULL
                      OR EXISTS(
                                SELECT
                                    PRC_GRP_PK
                                FROM
                                    (
                                     SELECT
                                         GLBL_CMPY_CD
                                        ,PRC_GRP_PK
                                     FROM
                                         (
                                          SELECT
                                               A.GLBL_CMPY_CD
                                              ,A.PRC_GRP_PK
                                              ,COUNT( DISTINCT B.PRC_GRP_TRGT_ATTRB_CD) CNT1
                                              ,COUNT( DISTINCT
                                                  CASE B.PRC_GRP_TRGT_ATTRB_CD
                                                      <isNotNull property="dsAcctNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_14#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              <isNotNull property="dsAcctNum_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_BL# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctNum_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_SH# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctNm">
                                                      WHEN #PrcGrpTrgtAttrbCd_15#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              <isNotNull property="dsAcctNm_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_BL# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctNm_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_SH# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsCustSicCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_16#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsCustSicCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsCustSicCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="locNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_17#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="locNum_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="locNum_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctClsCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_18#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctClsCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctClsCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctTpCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_19#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctTpCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctTpCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctDlrCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_20#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctDlrCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctDlrCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="csmpNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_21#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #csmpNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #csmpNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#csmpNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #csmpNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dlrRefNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_22#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dlrRefNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dlrRefNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dlrRefNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dlrRefNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="prcContrNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_24#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #prcContrNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #prcContrNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#prcContrNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #prcContrNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <!-- QC#18789 add start -->
                                                      <isNotNull property="coaChCd01">
                                                      WHEN #PrcGrpTrgtAttrbCd_28#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd01# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd01# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd01# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd01# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="coaChCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="coaChCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <!-- QC#18789 add end -->
                                                      END
                                              ) CNT2
                                          FROM
                                               PRC_GRP A
                                              ,PRC_GRP_DTL B
                                          WHERE
                                              A.GLBL_CMPY_CD      = #glblCmpyCd#
                                              AND A.PRC_GRP_TP_CD = #prcGrpTpCdCust#
                                              AND ACTV_FLG        = #actvFlg#
                                              AND A.EFF_FROM_DT &lt;= #prcBaseDt#
                                              AND (A.EFF_THRU_DT &gt;= #prcBaseDt# OR A.EFF_THRU_DT IS NULL)
                                              AND A.EZCANCELFLAG  = '0'
                                              AND A.GLBL_CMPY_CD  = B.GLBL_CMPY_CD
                                              AND A.PRC_GRP_PK    = B.PRC_GRP_PK
                                              AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                                              AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                                              AND B.EZCANCELFLAG  = '0'
                                          GROUP BY
                                              A.GLBL_CMPY_CD
                                             ,A.PRC_GRP_PK
                                         )
                                     WHERE
                                         CNT1 = CNT2
                                    ) WPG1
                                WHERE
                                    PCA.GLBL_CMPY_CD      = WPG1.GLBL_CMPY_CD
                                    AND PCA.PRC_GRP_PK_01 = WPG1.PRC_GRP_PK
                               )
                     )
                 AND (PCA.DS_ACCT_NUM_02 = #dsAcctNum# OR PCA.DS_ACCT_NUM_02 IS NULL)
                 AND (PCA.DS_ACCT_GRP_CD_02 = #dsAcctGrpCd#  OR PCA.DS_ACCT_GRP_CD_02 IS NULL)
                 AND (PCA.COA_BR_CD_02 = #coaBrCd#  OR PCA.COA_BR_CD_02 IS NULL)
                 AND (PCA.CSMP_NUM_02 IS NULL
                      OR EXISTS(
                                SELECT
                                    CCV2.CSMP_NUM
                                FROM
                                    (
                                     SELECT
                                         CC.GLBL_CMPY_CD
                                        ,CC.CSMP_NUM
                                     FROM 
                                         CSMP_CONTR CC
                                     WHERE
                                         CC.GLBL_CMPY_CD            = #glblCmpyCd#
                                         AND CC.DS_ACCT_NUM         = #dsAcctNum#
                                         AND CC.CSMP_CONTR_ACTV_FLG = #actvFlg#
                                         AND CC.EFF_FROM_DT         &lt;= #prcBaseDt#
                                         AND (CC.EFF_THRU_DT        &gt;= #prcBaseDt# OR CC.EFF_THRU_DT IS NULL )
                                         AND CC.EZCANCELFLAG        = '0'
                                    ) CCV2
                                WHERE
                                    PCA.GLBL_CMPY_CD    = CCV2.GLBL_CMPY_CD
                                    AND PCA.CSMP_NUM_02 = CCV2.CSMP_NUM
                               )
                     )
                 AND (PCA.PRC_GRP_PK_02 IS NULL
                      OR EXISTS(
                                SELECT
                                    PRC_GRP_PK
                                FROM
                                    (
                                     SELECT
                                         GLBL_CMPY_CD
                                        ,PRC_GRP_PK
                                     FROM
                                         (
                                          SELECT
                                               A.GLBL_CMPY_CD
                                              ,A.PRC_GRP_PK
                                              ,COUNT( DISTINCT B.PRC_GRP_TRGT_ATTRB_CD) CNT1
                                              ,COUNT( DISTINCT
                                                  CASE B.PRC_GRP_TRGT_ATTRB_CD
                                                      <isNotNull property="dsAcctNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_14#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              <isNotNull property="dsAcctNum_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_BL# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctNum_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_SH# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctNm">
                                                      WHEN #PrcGrpTrgtAttrbCd_15#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              <isNotNull property="dsAcctNm_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_BL# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctNm_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_SH# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsCustSicCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_16#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsCustSicCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsCustSicCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="locNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_17#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="locNum_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="locNum_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctClsCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_18#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctClsCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctClsCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctTpCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_19#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctTpCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctTpCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctDlrCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_20#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctDlrCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctDlrCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="csmpNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_21#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #csmpNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #csmpNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#csmpNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #csmpNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dlrRefNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_22#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dlrRefNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dlrRefNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dlrRefNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dlrRefNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="prcContrNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_24#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #prcContrNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #prcContrNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#prcContrNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #prcContrNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <!-- QC#18789 add start -->
                                                      <isNotNull property="coaChCd01">
                                                      WHEN #PrcGrpTrgtAttrbCd_28#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd01# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd01# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd01# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd01# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="coaChCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="coaChCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL 
                                                          END
                                                      </isNotNull>
                                                      <!-- QC#18789 add end -->
                                                      END
                                              ) CNT2
                                          FROM
                                               PRC_GRP A
                                              ,PRC_GRP_DTL B
                                          WHERE
                                              A.GLBL_CMPY_CD      = #glblCmpyCd#
                                              AND A.PRC_GRP_TP_CD = #prcGrpTpCdCust#
                                              AND ACTV_FLG        = #actvFlg#
                                              AND A.EFF_FROM_DT &lt;= #prcBaseDt#
                                              AND (A.EFF_THRU_DT &gt;= #prcBaseDt# OR A.EFF_THRU_DT IS NULL)
                                              AND A.EZCANCELFLAG  = '0'
                                              AND A.GLBL_CMPY_CD  = B.GLBL_CMPY_CD
                                              AND A.PRC_GRP_PK    = B.PRC_GRP_PK
                                              AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                                              AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                                              AND B.EZCANCELFLAG  = '0'
                                          GROUP BY
                                              A.GLBL_CMPY_CD
                                             ,A.PRC_GRP_PK
                                         )
                                     WHERE
                                         CNT1 = CNT2
                                    ) WPG2
                                WHERE
                                    PCA.GLBL_CMPY_CD      = WPG2.GLBL_CMPY_CD
                                    AND PCA.PRC_GRP_PK_02 = WPG2.PRC_GRP_PK
                               )
                     )
                 AND (PCA.DS_ACCT_NUM_03 = #dsAcctNum# OR PCA.DS_ACCT_NUM_03 IS NULL)
                 AND (PCA.DS_ACCT_GRP_CD_03 = #dsAcctGrpCd#  OR PCA.DS_ACCT_GRP_CD_03 IS NULL)
                 AND (PCA.COA_BR_CD_03 = #coaBrCd#  OR PCA.COA_BR_CD_03 IS NULL)
                 AND (PCA.CSMP_NUM_03 IS NULL
                      OR EXISTS(
                                SELECT
                                    CCV3.CSMP_NUM
                                FROM
                                    (
                                     SELECT
                                         CC.GLBL_CMPY_CD
                                        ,CC.CSMP_NUM
                                     FROM 
                                         CSMP_CONTR CC
                                     WHERE
                                         CC.GLBL_CMPY_CD            = #glblCmpyCd#
                                         AND CC.DS_ACCT_NUM         = #dsAcctNum#
                                         AND CC.CSMP_CONTR_ACTV_FLG = #actvFlg#
                                         AND CC.EFF_FROM_DT         &lt;= #prcBaseDt#
                                         AND (CC.EFF_THRU_DT        &gt;= #prcBaseDt# OR CC.EFF_THRU_DT IS NULL )
                                         AND CC.EZCANCELFLAG        = '0'
                                    ) CCV3
                                WHERE
                                    PCA.GLBL_CMPY_CD    = CCV3.GLBL_CMPY_CD
                                    AND PCA.CSMP_NUM_03 = CCV3.CSMP_NUM
                               )
                     )
                 AND (PCA.PRC_GRP_PK_03 IS NULL
                      OR EXISTS(
                                SELECT
                                    PRC_GRP_PK
                                FROM
                                    (
                                     SELECT
                                         GLBL_CMPY_CD
                                        ,PRC_GRP_PK
                                     FROM
                                         (
                                          SELECT
                                               A.GLBL_CMPY_CD
                                              ,A.PRC_GRP_PK
                                              ,COUNT( DISTINCT B.PRC_GRP_TRGT_ATTRB_CD) CNT1
                                              ,COUNT( DISTINCT
                                                  CASE B.PRC_GRP_TRGT_ATTRB_CD
                                                      <isNotNull property="dsAcctNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_14#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              <isNotNull property="dsAcctNum_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_BL# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctNum_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum_SH# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctNm">
                                                      WHEN #PrcGrpTrgtAttrbCd_15#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              <isNotNull property="dsAcctNm_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_BL# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctNm_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm_SH# LIKE B.PRC_GRP_FROM_TXT  THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsCustSicCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_16#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsCustSicCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsCustSicCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="locNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_17#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="locNum_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="locNum_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctClsCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_18#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctClsCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctClsCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctTpCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_19#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctTpCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctTpCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dsAcctDlrCd">
                                                      WHEN #PrcGrpTrgtAttrbCd_20#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="dsAcctDlrCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="dsAcctDlrCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="csmpNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_21#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #csmpNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #csmpNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#csmpNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #csmpNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="dlrRefNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_22#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dlrRefNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dlrRefNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dlrRefNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dlrRefNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <isNotNull property="prcContrNum">
                                                      WHEN #PrcGrpTrgtAttrbCd_24#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #prcContrNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #prcContrNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#prcContrNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #prcContrNum# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <!-- QC#18789 add start -->
                                                      <isNotNull property="coaChCd01">
                                                      WHEN #PrcGrpTrgtAttrbCd_28#  THEN
                                                          CASE
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd01# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd01# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd01# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd01# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              <isNotNull property="coaChCd_BL">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd_BL# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd_BL# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd_BL# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd_BL# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              <isNotNull property="coaChCd_SH">
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd_SH# = B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd_SH# != B.PRC_GRP_FROM_TXT  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd_SH# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                              WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd_SH# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                              </isNotNull>
                                                              ELSE NULL
                                                          END
                                                      </isNotNull>
                                                      <!-- QC#18789 add end -->
                                                      END
                                              ) CNT2
                                          FROM
                                               PRC_GRP A
                                              ,PRC_GRP_DTL B
                                          WHERE
                                              A.GLBL_CMPY_CD      = #glblCmpyCd#
                                              AND A.PRC_GRP_TP_CD = #prcGrpTpCdCust#
                                              AND ACTV_FLG        = #actvFlg#
                                              AND A.EFF_FROM_DT &lt;= #prcBaseDt#
                                              AND (A.EFF_THRU_DT &gt;= #prcBaseDt# OR A.EFF_THRU_DT IS NULL)
                                              AND A.EZCANCELFLAG  = '0'
                                              AND A.GLBL_CMPY_CD  = B.GLBL_CMPY_CD
                                              AND A.PRC_GRP_PK    = B.PRC_GRP_PK
                                              AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                                              AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                                              AND B.EZCANCELFLAG  = '0'
                                          GROUP BY
                                              A.GLBL_CMPY_CD
                                             ,A.PRC_GRP_PK
                                         )
                                     WHERE
                                         CNT1 = CNT2
                                    ) WPG3
                                WHERE
                                    PCA.GLBL_CMPY_CD      = WPG3.GLBL_CMPY_CD
                                    AND PCA.PRC_GRP_PK_03 = WPG3.PRC_GRP_PK
                               )
                     )
                 AND PCA.EFF_FROM_DT &lt;= #prcBaseDt#
                 AND (PCA.EFF_THRU_DT &gt;= #prcBaseDt# OR PCA.EFF_THRU_DT IS NULL)

             <!-- PRTY = 7 Default Price List-->
             UNION ALL
             SELECT 
                 PC.GLBL_CMPY_CD
                ,PC.EZCANCELFLAG
                ,'7' AS PRTY_NUM
                ,PC.PRC_CATG_CD
                ,#ccyCd# AS CCY_CD
                ,PC.PRC_LIST_TP_CD
                ,PCR.DEF_PRC_TP_FLG
             FROM
                 PRC_CATG PC
                ,PRC_CTX_RELN PCR
             WHERE
                 PC.GLBL_CMPY_CD            = #glblCmpyCd#
                 AND PC.EZCANCELFLAG        = '0'
                 AND PC.PRC_CATG_CD         = #defPrcCatgCd#
                 AND PC.ACTV_FLG            = #actvFlg#
                 AND PC.DEL_FLG             = #delFlg#
                 AND PC.EFF_FROM_DT         &lt;= #prcBaseDt#
                 AND (PC.EFF_THRU_DT        &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
                 AND PC.GLBL_CMPY_CD        = PCR.GLBL_CMPY_CD
                 AND PC.EZCANCELFLAG        = PCR.EZCANCELFLAG
                 AND PC.PRC_LIST_TP_CD      = PCR.PRC_LIST_TP_CD
                 AND PCR.PRC_CTX_TP_CD      = #prcCtxTpCd#

             <!-- PRTY = 8 public -->
             UNION ALL
             SELECT 
                 PC.GLBL_CMPY_CD
                ,PC.EZCANCELFLAG
                ,'8' AS PRTY_NUM
                ,PC.PRC_CATG_CD
                ,PC.CCY_CD
                ,PC.PRC_LIST_TP_CD
                ,PCR.DEF_PRC_TP_FLG
             FROM
                 PRC_CATG PC
                ,PRC_CTX_RELN PCR
                ,PRC_CUST_AUDC PCA
             WHERE
                 PC.GLBL_CMPY_CD            = #glblCmpyCd#
                 AND PC.EZCANCELFLAG        = '0'
                 AND PC.ACTV_FLG            = #actvFlg#
                 AND PC.DEL_FLG             = #delFlg#
                 AND PC.EFF_FROM_DT         &lt;= #prcBaseDt#
                 AND (PC.EFF_THRU_DT        &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL)
                 AND PC.GLBL_CMPY_CD        = PCR.GLBL_CMPY_CD
                 AND PC.EZCANCELFLAG        = PCR.EZCANCELFLAG
                 AND PC.PRC_LIST_TP_CD      = PCR.PRC_LIST_TP_CD
                 AND PCR.PRC_CTX_TP_CD      = #prcCtxTpCd#
                 AND PC.GLBL_CMPY_CD        = PCA.GLBL_CMPY_CD
                 AND PC.EZCANCELFLAG        = PCA.EZCANCELFLAG
                 AND PC.PRC_CATG_CD         = PCA.PRC_CATG_CD
                 AND PCA.PUB_FLG_01         = #pubFlg_Y#
                 AND PCA.EFF_FROM_DT        &lt;= #prcBaseDt#
                 AND (PCA.EFF_THRU_DT       &gt;= #prcBaseDt# OR PCA.EFF_THRU_DT IS NULL)
            ) PLV
           ,(
             SELECT
                 PTA.GLBL_CMPY_CD
                ,PTA.EZCANCELFLAG
                ,PTA.PRC_TRX_AUDC_PK
                ,PTA.PRC_CATG_CD
                ,PTA.PRC_GRP_PK
                ,PTA.DS_ORD_CATG_CD
                ,PTA.DS_ORD_TP_CD_01
                ,PTA.DS_ORD_TP_CD_02
             FROM
                 PRC_TRX_AUDC PTA
             WHERE
                 PTA.GLBL_CMPY_CD           = #glblCmpyCd#
                 AND PTA.EZCANCELFLAG       = '0'
                 AND PTA.EFF_FROM_DT        &lt;= #prcBaseDt#
                 AND (PTA.EFF_THRU_DT       &gt;= #prcBaseDt#  OR PTA.EFF_THRU_DT IS NULL)
            ) PTA
           ,DS_ORD_TP_PRC_LIST_RELN DOPR
        WHERE
                PLV.GLBL_CMPY_CD            = PTA.GLBL_CMPY_CD(+)
            AND PLV.EZCANCELFLAG            = PTA.EZCANCELFLAG(+)
            AND PLV.PRC_CATG_CD             = PTA.PRC_CATG_CD(+)
            AND (PTA.DS_ORD_CATG_CD         = #dsOrdCatgCd# OR  PTA.DS_ORD_CATG_CD  IS NULL)
            AND (PTA.DS_ORD_TP_CD_01        = #dsOrdTpCd#   OR  PTA.DS_ORD_TP_CD_01 IS NULL)
            AND (PTA.DS_ORD_TP_CD_02        = #dsOrdTpCd#   OR  PTA.DS_ORD_TP_CD_02 IS NULL)
            AND (
                 CASE WHEN PTA.PRC_CATG_CD IS NOT NULL AND PTA.PRC_GRP_PK IS NULL THEN 1
                      WHEN PTA.PRC_CATG_CD IS NOT NULL AND EXISTS(
                                                                  SELECT
                                                                      PTA.PRC_GRP_PK
                                                                  FROM
                                                                     (
                                                                      SELECT
                                                                          A.GLBL_CMPY_CD
                                                                         ,A.PRC_GRP_PK 
                                                                      FROM
                                                                          PRC_GRP A
                                                                      WHERE
                                                                          A.GLBL_CMPY_CD  = #glblCmpyCd#
                                                                          AND A.EZCANCELFLAG  = '0'
                                                                          AND A.PRC_GRP_TP_CD = #prcGrpTpCdTran#
                                                                          AND ACTV_FLG        = #actvFlg#
                                                                          AND A.EFF_FROM_DT &lt;= #prcBaseDt#
                                                                          AND (A.EFF_THRU_DT &gt;= #prcBaseDt# OR A.EFF_THRU_DT IS NULL)
                                                                          AND (
                                                                               SELECT
                                                                                   COUNT(DISTINCT PRC_GRP_TRGT_ATTRB_CD)
                                                                               FROM
                                                                                   PRC_GRP_DTL B
                                                                               WHERE
                                                                                   A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
                                                                                   AND A.PRC_GRP_PK   = B.PRC_GRP_PK
                                                                                   AND B.EZCANCELFLAG = '0'
                                                                                   AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                                                                                   AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                                                                              )
                                                                               =
                                                                              ( 
                                                                               SELECT
                                                                                   COUNT(DISTINCT PRC_GRP_TRGT_ATTRB_CD)
                                                                               FROM
                                                                                   PRC_GRP_DTL B
                                                                               WHERE
                                                                                   A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
                                                                                   AND A.PRC_GRP_PK   = B.PRC_GRP_PK
                                                                                   AND B.EZCANCELFLAG = '0'
                                                                                   AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                                                                                   AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                                                                                   AND (
                                                                                        CASE B.PRC_GRP_TRGT_ATTRB_CD
                                                                                        WHEN #PrcGrpTrgtAttrbCd_25#  THEN
                                                                                            CASE
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsOrdCatgCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsOrdCatgCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsOrdCatgCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsOrdCatgCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                                                                ELSE 0
                                                                                            END
                                                                                        WHEN #PrcGrpTrgtAttrbCd_26#  THEN
                                                                                            CASE
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsOrdTpCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsOrdTpCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsOrdTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsOrdTpCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                                                                ELSE 0
                                                                                            END
                                                                                        <isNotNull property="dsCpoLineCatgCd">
                                                                                        WHEN #PrcGrpTrgtAttrbCd_27#  THEN
                                                                                            CASE
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCpoLineCatgCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCpoLineCatgCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCpoLineCatgCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                                                                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCpoLineCatgCd# LIKE B.PRC_GRP_FROM_TXT THEN 1
                                                                                                ELSE 0
                                                                                            END
                                                                                        </isNotNull>
                                                                                        END
                                                                                      ) = 1
                                                                              )
                                                                          AND EXISTS (
                                                                                      SELECT
                                                                                          1
                                                                                      FROM
                                                                                          PRC_GRP_DTL B
                                                                                      WHERE
                                                                                          A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
                                                                                          AND A.PRC_GRP_PK   = B.PRC_GRP_PK
                                                                                          AND B.EZCANCELFLAG = '0'
                                                                                          AND B.EFF_FROM_DT  &lt;= #prcBaseDt#
                                                                                          AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                                                                                     )
                                                                     ) PGAV
                                                                  WHERE
                                                                      PTA.GLBL_CMPY_CD   = PGAV.GLBL_CMPY_CD
                                                                      AND PTA.PRC_GRP_PK = PGAV.PRC_GRP_PK
                                                                 ) THEN 1
                      WHEN PTA.PRC_CATG_CD IS NULL THEN 1
                      ELSE 0 
                 END
                ) = 1
            AND PLV.GLBL_CMPY_CD            = DOPR.GLBL_CMPY_CD
            AND PLV.EZCANCELFLAG            = DOPR.EZCANCELFLAG
            AND PLV.PRC_LIST_TP_CD          = DOPR.PRC_LIST_TP_CD
            AND DOPR.DS_ORD_TP_CD           = #dsOrdTpCd#
        ORDER BY
            PRTY_NUM
           ,PRC_CATG_CD
    </statement>

    <statement id="selectPriceListForCSMPCredit" parameterClass="Map" resultClass="Map">
        SELECT
            '1'                 AS PRTY_NUM
           ,PC.PRC_CATG_CD
           ,PC.CCY_CD
           ,PCR.DEF_PRC_TP_FLG
        FROM
            CSMP_CONTR CC
           ,PRC_CATG PC
           ,PRC_CTX_RELN PCR
        WHERE
            CC.GLBL_CMPY_CD                 = #glblCmpyCd#
        AND CC.EZCANCELFLAG                 = '0'
        AND CC.DS_ACCT_NUM                  = #dsAcctNum#
         <isNotNull property="csmpNum">
        AND CC.CSMP_NUM                     = #csmpNum#
        </isNotNull>
         <isNotNull property="dlrRefNum">
        AND CC.DLR_REF_NUM                  = #dlrRefNum#
        </isNotNull>
        AND CC.GLBL_CMPY_CD                 = PC.GLBL_CMPY_CD 
        AND CC.EZCANCELFLAG                 = PC.EZCANCELFLAG
        AND CC.PRC_CATG_CD                  = PC.PRC_CATG_CD
        AND PC.ACTV_FLG                     = #actvFlg#
        AND PC.DEL_FLG                      = #delFlg#
        AND PC.EFF_FROM_DT                  &lt;= #prcBaseDt#
        AND (PC.EFF_THRU_DT                &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
        AND PC.GLBL_CMPY_CD                 = PCR.GLBL_CMPY_CD
        AND PC.EZCANCELFLAG                 = PCR.EZCANCELFLAG
        AND PC.PRC_LIST_TP_CD               = PCR.PRC_LIST_TP_CD
        AND PCR.PRC_CTX_TP_CD               = #prcCtxTpCd#
    </statement>

    <statement id="getPrcListConfig" parameterClass="Map" resultClass="Map">
        SELECT
            PLE.PRC_QLFY_VAL_TXT
           ,PLE.PKG_UOM_CD
           <!-- ,PLE.CUST_BID_QTY For Performance QC#10321 Del -->
           ,OTM.MDSE_CD
        FROM
            PRC_CATG PC
           ,PRC_LIST_EQUIP PLE
           ,ORD_TAKE_MDSE OTM
        WHERE
            PC.GLBL_CMPY_CD                 = #glblCmpyCd#
        AND PC.EZCANCELFLAG                 = '0'
        AND PC.PRC_CATG_CD                  = #prcCatgCd#
        AND PC.ACTV_FLG                     = #activFlg#
        ANd PC.DEL_FLG                      = #delFlg#
        AND PC.EFF_FROM_DT                  &lt;= #prcBaseDt#
        AND (PC.EFF_THRU_DT                 &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
        AND PC.GLBL_CMPY_CD                 = PLE.GLBL_CMPY_CD
        AND PC.EZCANCELFLAG                 = PLE.EZCANCELFLAG
        AND PC.PRC_CATG_CD                  = PLE.PRC_CATG_CD
        AND PLE.PRC_LIST_EQUIP_CONFIG_NUM   = #prcListEquipConfigNum#
        AND PLE.PRC_QLFY_TP_CD              = #prcqlfyTpItem#
        AND PLE.EFF_FROM_DT                 &lt;= #prcBaseDt#
        AND (PLE.EFF_THRU_DT                &gt;= #prcBaseDt# OR PLE.EFF_THRU_DT IS NULL )
        AND PLE.DEL_FLG                     = #delFlg#
        AND PLE.GLBL_CMPY_CD                = OTM.GLBL_CMPY_CD(+)
        AND PLE.EZCANCELFLAG                = OTM.EZCANCELFLAG(+)
        AND PLE.PRC_QLFY_VAL_TXT            = OTM.ORD_TAKE_MDSE_CD(+) 
    </statement>

    <statement id="selectSubPriceList" parameterClass="Map" resultClass="String">
        SELECT
            DPCS.SUB_PRC_CATG_CD
        FROM
            DS_PRC_CATG_SUB DPCS
        WHERE
            DPCS.GLBL_CMPY_CD               = #glblCmpyCd#
        AND DPCS.EZCANCELFLAG               = '0'
        AND DPCS.EFF_FROM_DT                &lt;= #prcBaseDt#
        AND (DPCS.EFF_THRU_DT               &gt;= #prcBaseDt# OR DPCS.EFF_THRU_DT IS NULL )
        AND DPCS.PRC_CATG_CD                = #prcCatgCd#
        ORDER BY SUB_PRC_PRTY_NUM
    </statement>

    <statement id="getPrcListStruTp" parameterClass="Map" resultClass="String">
        SELECT
            PLT.PRC_LIST_STRU_TP_CD
        FROM
            PRC_CATG PC
           ,PRC_LIST_TP PLT
        WHERE 
            PC.GLBL_CMPY_CD                 = #glblCmpyCd#
        AND PC.EZCANCELFLAG                 = '0'
        AND PC.PRC_CATG_CD                  = #prcCatgCd#
        AND PC.ACTV_FLG                     = #activFlg#
        ANd PC.DEL_FLG                      = #delFlg#
        AND PC.EFF_FROM_DT                  &lt;= #prcBaseDt#
        AND (PC.EFF_THRU_DT                 &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
        AND PC.GLBL_CMPY_CD                 = PLT.GLBL_CMPY_CD
        AND PC.EZCANCELFLAG                 = PLT.EZCANCELFLAG
        AND PC.PRC_LIST_TP_CD               = PLT.PRC_LIST_TP_CD
    </statement>

    <statement id="getPrcLeaseTp" parameterClass="Map" resultClass="String">
         SELECT
             PECA.PRC_LEASE_TP_CD
         FROM
             PRC_CATG PC
            ,PRC_EQUIP_CONTR_ATTRB PECA
         WHERE
             PC.GLBL_CMPY_CD                = #glblCmpyCd#
         AND PC.EZCANCELFLAG                = '0'
         AND PC.PRC_CATG_CD                 = #prcCatgCd# 
         AND PC.ACTV_FLG                    = #activFlg#
         AND PC.DEL_FLG                     = #delFlg#
         AND PC.EFF_FROM_DT                 &lt;= #prcBaseDt#
         AND (PC.EFF_THRU_DT                &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
         AND PC.GLBL_CMPY_CD                = PECA.GLBL_CMPY_CD(+)
         AND PC.EZCANCELFLAG                = PECA.EZCANCELFLAG(+)
         AND PC.PRC_CATG_CD                 = PECA.PRC_CATG_CD(+)
    </statement>

    <statement id="getBasePriceEquipment" parameterClass="Map" resultClass="Map">
    WITH PRC_LIST_EQUIP_V  AS (
         SELECT
             PLE.GLBL_CMPY_CD
            ,PLE.EZCANCELFLAG
            ,PLE.PRC_LIST_EQUIP_PK
            ,PLE.PRC_LIST_EQUIP_PRC_AMT
            ,PLE.MLY_PMT_AMT
            ,PLE.MIN_PRC_AMT
            ,PLE.MAX_PRC_AMT
            ,PLE.PRC_FMLA_PK
            ,PLE.PRC_QLFY_TP_CD
            ,PLE.PRC_QLFY_VAL_TXT
            ,PLE.PRC_LIST_EQUIP_CONFIG_NUM
            ,PLE.PRC_TERM_AOT
            ,PLE.PRC_TERM_UOM_CD
            ,PECA.PRC_LEASE_TP_CD
            ,PLE.PKG_UOM_CD
         FROM
             PRC_CATG PC
            ,PRC_LIST_EQUIP PLE
            ,PRC_EQUIP_CONTR_ATTRB PECA
         WHERE
             PC.GLBL_CMPY_CD = #glblCmpyCd#
         AND PC.EZCANCELFLAG = '0'
         AND PC.PRC_CATG_CD = #prcCatgCd# 
         AND PC.ACTV_FLG = #activFlg#
         AND PC.DEL_FLG = #delFlg#
         AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
         AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
         AND PC.GLBL_CMPY_CD = PLE.GLBL_CMPY_CD
         AND PC.EZCANCELFLAG = PLE.EZCANCELFLAG
         AND PC.PRC_CATG_CD = PLE.PRC_CATG_CD
         <!-- QC#50130
         AND (CASE WHEN PLE.PRC_QLFY_TP_CD = #prcQlfyTp03# AND PLE.PRC_QLFY_VAL_TXT =  #zerothProdCtrlCd# THEN 1
                   WHEN PLE.PRC_QLFY_TP_CD = #prcQlfyTp04# AND PLE.PRC_QLFY_VAL_TXT =  #firstProdCtrlCd# THEN 1
                   WHEN PLE.PRC_QLFY_TP_CD = #prcQlfyTp05# AND PLE.PRC_QLFY_VAL_TXT =  #scdProdCtrlCd# THEN 1
                   WHEN PLE.PRC_QLFY_TP_CD = #prcQlfyTp06# AND PLE.PRC_QLFY_VAL_TXT =  #thirdProdCtrlCd# THEN 1
                   WHEN PLE.PRC_QLFY_TP_CD = #prcQlfyTp07# AND PLE.PRC_QLFY_VAL_TXT =  #frthProdCtrlCd# THEN 1
                   WHEN PLE.PRC_QLFY_TP_CD = #prcQlfyTp01# AND PLE.PRC_QLFY_VAL_TXT IN  (#mdseCd#, #ordTakeMdseCd#) THEN 1
                   WHEN PLE.PRC_QLFY_TP_CD = #prcQlfyTp02# AND PLE.PRC_QLFY_VAL_TXT = #coaMdseTpCd# THEN 1
                   ELSE 0
             END) = 1
         -->
         AND (  (PLE.PRC_QLFY_TP_CD = #prcQlfyTp03# AND PLE.PRC_QLFY_VAL_TXT =  #zerothProdCtrlCd#)
             OR (PLE.PRC_QLFY_TP_CD = #prcQlfyTp04# AND PLE.PRC_QLFY_VAL_TXT =  #firstProdCtrlCd#)
             OR (PLE.PRC_QLFY_TP_CD = #prcQlfyTp05# AND PLE.PRC_QLFY_VAL_TXT =  #scdProdCtrlCd#)
             OR (PLE.PRC_QLFY_TP_CD = #prcQlfyTp06# AND PLE.PRC_QLFY_VAL_TXT =  #thirdProdCtrlCd#)
             OR (PLE.PRC_QLFY_TP_CD = #prcQlfyTp07# AND PLE.PRC_QLFY_VAL_TXT =  #frthProdCtrlCd#)
             OR (PLE.PRC_QLFY_TP_CD = #prcQlfyTp01# AND PLE.PRC_QLFY_VAL_TXT IN  (#mdseCd#, #ordTakeMdseCd#))
             OR (PLE.PRC_QLFY_TP_CD = #prcQlfyTp02# AND PLE.PRC_QLFY_VAL_TXT = #coaMdseTpCd#)
         )
         AND PLE.PKG_UOM_CD = #pkgUomCd#
         AND PLE.EFF_FROM_DT &lt;= #prcBaseDt#
         AND (PLE.EFF_THRU_DT &gt;= #prcBaseDt# OR PLE.EFF_THRU_DT IS NULL )
         AND PLE.DEL_FLG = #delFlg#
         AND PC.GLBL_CMPY_CD = PECA.GLBL_CMPY_CD(+)
         AND PC.EZCANCELFLAG = PECA.EZCANCELFLAG(+)
         AND PC.PRC_CATG_CD = PECA.PRC_CATG_CD(+)
    )
    SELECT
            NVL(PLEDV.PRC_BREAK_AMT,PLE.PRC_LIST_EQUIP_PRC_AMT) PRC_LIST_EQUIP_PRC_AMT
           ,PLE.MLY_PMT_AMT
           ,PLE.MIN_PRC_AMT
           ,PLE.MAX_PRC_AMT
           ,PLE.PRC_FMLA_PK
           ,PLE.PRC_QLFY_TP_CD
           ,PLE.PRC_QLFY_VAL_TXT
           ,PLE.PKG_UOM_CD
           ,PLEDV.PRC_BREAK_AMT
        FROM
            PRC_LIST_EQUIP_V PLE
           ,(
                SELECT 
                     PLED.GLBL_CMPY_CD
                    ,PLED.EZCANCELFLAG
                    ,PLED.PRC_LIST_EQUIP_PK
                    ,PLED.PRC_BREAK_AMT
                FROM
                     (
                        SELECT
                             PLEDX.GLBL_CMPY_CD
                            ,PLEDX.EZCANCELFLAG
                            ,PLEDX.PRC_LIST_EQUIP_PK
                            ,PLEDX.PRC_BREAK_AMT
                            ,ROW_NUMBER() OVER (PARTITION BY PLEDX.GLBL_CMPY_CD, PLEDX.PRC_LIST_EQUIP_PK ORDER BY PLEDX.QTY_DISC_DTL_QTY DESC) RNO
                        FROM
                             PRC_LIST_EQUIP_DTL PLEDX
                        WHERE
                             PLEDX.QTY_DISC_DTL_QTY &lt;= #qtyDiscQty#
                        AND  PLEDX.DEL_FLG = #delFlg#
                        AND  PLEDX.EZCANCELFLAG = '0'
                ) PLED
                WHERE
                     PLED.RNO = 1
           ) PLEDV
        WHERE
            PLE.GLBL_CMPY_CD = #glblCmpyCd#
        AND PLE.EZCANCELFLAG = '0'
        <isNotNull property="configUseFlg">
          <isNull property="prcListEquipConfigNum">
            AND PLE.PRC_LIST_EQUIP_CONFIG_NUM IS NULL
          </isNull>
          <isNotNull property="prcListEquipConfigNum">
            AND PLE.PRC_LIST_EQUIP_CONFIG_NUM = #prcListEquipConfigNum#
          </isNotNull>
        </isNotNull>
        <isNull property="configUseFlg">
        AND PLE.PRC_LIST_EQUIP_CONFIG_NUM IS NOT NULL
        </isNull>
        <isNull property="rentalFlg">
        AND (CASE WHEN PLE.PRC_LEASE_TP_CD = #prcLeaseTp# THEN
                    CASE WHEN PLE.PRC_TERM_AOT = #prcTermAot# AND PLE.PRC_TERM_UOM_CD = #prcTeamUom# THEN 1
                         ELSE 0
                    END
                  ELSE 1
             END
           ) = 1
        </isNull>
        <isNotNull property="rentalFlg">
        AND (CASE WHEN PLE.PRC_TERM_AOT = #prcTermAot# AND PLE.PRC_TERM_UOM_CD = #prcTeamUom# THEN 1
                  ELSE 0
             END
           ) = 1
        </isNotNull>
        AND PLE.GLBL_CMPY_CD = PLEDV.GLBL_CMPY_CD(+)
        AND PLE.EZCANCELFLAG = PLEDV.EZCANCELFLAG(+)
        AND PLE.PRC_LIST_EQUIP_PK = PLEDV.PRC_LIST_EQUIP_PK(+)
    </statement>

    <statement id="getBasePriceService" parameterClass="Map" resultClass="Map">
        SELECT
            PLS.MIN_COPY_VOL_CNT
           ,PLS.MAX_COPY_VOL_CNT
           ,PLS.BASE_AMT
           ,PLS.MIN_BASE_AMT
           ,PLS.MAX_BASE_AMT
           ,PLS.CPC_AMT_RATE
           ,PLS.MIN_CPC_AMT_RATE
           ,PLS.MAX_CPC_AMT_RATE
           ,PLS.MTR_MULT_RATE
        FROM
            PRC_CATG PC
           ,PRC_LIST_SVC PLS
        WHERE
            PC.GLBL_CMPY_CD = #glblCmpyCd#
        AND PC.EZCANCELFLAG = '0'
        AND PC.PRC_CATG_CD = #prcCatgCd# 
        AND PC.ACTV_FLG = #activFlg#
        ANd PC.DEL_FLG = #delFlg#
        AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
        AND PC.GLBL_CMPY_CD = PLS.GLBL_CMPY_CD
        AND PC.EZCANCELFLAG = PLS.EZCANCELFLAG
        AND PC.PRC_CATG_CD = PLS.PRC_CATG_CD
        <isNotNull property="prcRateTpCd">
        AND PLS.PRC_RATE_TP_CD = #prcRateTpCd#
        </isNotNull>
        <isNotNull property="mdlId">
        AND PLS.MDL_ID = #mdlId#
        </isNotNull>
        <isNotNull property="prcMtrPkgPk">
        AND PLS.PRC_MTR_PKG_PK = #prcMtrPkgPk#
        </isNotNull>
        <isNotNull property="prcSvcPlnTpCd">
        AND PLS.PRC_SVC_PLN_TP_CD = #prcSvcPlnTpCd#
        </isNotNull>
        <isNotNull property="prcSvcContrTpCd">
        AND PLS.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
        </isNotNull>
        <isNotNull property="mtrLbCd">
        AND PLS.BLLG_MTR_LB_CD = #mtrLbCd#
        </isNotNull>
        <isNotNull property="prcListBandCd">
        AND PLS.PRC_LIST_BAND_CD = #prcListBandCd#
        </isNotNull>
        AND PLS.MDSE_CD IN (#mdseCd#, #ordTakeMdseCd#)
        <isNotNull property="termFromMthAot">
        AND PLS.TERM_FROM_MTH_AOT = #termFromMthAot#
        </isNotNull>
        <isNotNull property="termThruMthAot">
        AND PLS.TERM_THRU_MTH_AOT = #termThruMthAot#
        </isNotNull>
        AND PLS.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PLS.EFF_THRU_DT &gt;= #prcBaseDt# OR PLS.EFF_THRU_DT IS NULL )
        AND PLS.DEL_FLG = #delFlg#
    </statement>

    <statement id="getBasePriceServiceTier" parameterClass="Map" resultClass="Map">
        SELECT
            PLST.MIN_COPY_VOL_CNT
           ,PLST.MAX_COPY_VOL_CNT
           ,PLST.BASE_AMT
           ,PLST.MIN_BASE_AMT
           ,PLST.MAX_BASE_AMT
           ,PLST.CPC_AMT_RATE
           ,PLST.MIN_CPC_AMT_RATE
           ,PLST.MAX_CPC_AMT_RATE
           ,PLST.MTR_MULT_RATE
        FROM
            PRC_CATG PC
           ,PRC_LIST_SVC_TIER PLST
        WHERE
            PC.GLBL_CMPY_CD = #glblCmpyCd#
        AND PC.EZCANCELFLAG = '0'
        AND PC.PRC_CATG_CD = #prcCatgCd# 
        AND PC.ACTV_FLG = #activFlg#
        ANd PC.DEL_FLG = #delFlg#
        AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
        AND PC.GLBL_CMPY_CD = PLST.GLBL_CMPY_CD
        AND PC.EZCANCELFLAG = PLST.EZCANCELFLAG
        AND PC.PRC_CATG_CD = PLST.PRC_CATG_CD
        <isNotNull property="mdlId">
        AND PLST.MDL_ID = #mdlId#
        </isNotNull>
        <isNotNull property="prcMtrPkgPk">
        AND PLST.PRC_MTR_PKG_PK = #prcMtrPkgPk#
        </isNotNull>
        <isNotNull property="prcSvcPlnTpCd">
        AND PLST.PRC_SVC_PLN_TP_CD = #prcSvcPlnTpCd#
        </isNotNull>
        <isNotNull property="prcSvcContrTpCd">
        AND PLST.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
        </isNotNull>
        <isNotNull property="mtrLbCd">
        AND PLST.BLLG_MTR_LB_CD = #mtrLbCd#
        </isNotNull>
        <isNotNull property="prcListBandCd">
        AND PLST.PRC_LIST_BAND_CD = #prcListBandCd#
        </isNotNull>
        AND PLST.MDSE_CD IN (#mdseCd#, #ordTakeMdseCd#)
        <isNotNull property="termFromMthAot">
        AND PLST.TERM_FROM_MTH_AOT = #termFromMthAot#
        </isNotNull>
        <isNotNull property="termThruMthAot">
        AND PLST.TERM_THRU_MTH_AOT = #termThruMthAot#
        </isNotNull>
        AND PLST.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PLST.EFF_THRU_DT &gt;= #prcBaseDt# OR PLST.EFF_THRU_DT IS NULL )
        AND PLST.DEL_FLG = #delFlg#
    </statement>

    <statement id="getBasePriceAddCharge" parameterClass="Map" resultClass="Map">
        SELECT
            PLAC.ADDL_CHRG_PRC_AMT
        FROM
            PRC_CATG PC
           ,PRC_LIST_ADDL_CHRG PLAC
        WHERE
            PC.GLBL_CMPY_CD = #glblCmpyCd#
        AND PC.EZCANCELFLAG = '0'
        AND PC.PRC_CATG_CD = #prcCatgCd# 
        AND PC.ACTV_FLG = #activFlg#
        ANd PC.DEL_FLG = #delFlg#
        AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
        AND PC.GLBL_CMPY_CD = PLAC.GLBL_CMPY_CD
        AND PC.EZCANCELFLAG = PLAC.EZCANCELFLAG
        AND PC.PRC_CATG_CD = PLAC.PRC_CATG_CD
        AND PLAC.MDSE_CD IN (#mdseCd#, #ordTakeMdseCd#)
        <isNotNull property="mdlId">
        AND PLAC.MDL_ID = #mdlId#
        </isNotNull>
        AND PLAC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PLAC.EFF_THRU_DT &gt;= #prcBaseDt# OR PLAC.EFF_THRU_DT IS NULL )
        AND PLAC.DEL_FLG = #delFlg#
    </statement>

    <statement id="getBasePriceSupplyProgram" parameterClass="Map" resultClass="Map">
        SELECT
            PLSP.MIN_COPY_VOL_CNT
           ,PLSP.MAX_COPY_VOL_CNT
           ,PLSP.TOT_BASE_AMT
           ,PLSP.SPLY_BASE_AMT
           ,PLSP.CPC_AMT_RATE
           ,PLSP.MIN_CPC_AMT_RATE
           ,PLSP.MAX_CPC_AMT_RATE
           ,PLSP.MTR_MULT_RATE
           ,PLSP.SPLY_AGMT_PLN_PK
        FROM
            PRC_CATG PC
           ,PRC_LIST_SPLY_PGM PLSP
        WHERE
            PC.GLBL_CMPY_CD = #glblCmpyCd#
        AND PC.EZCANCELFLAG = '0'
        AND PC.PRC_CATG_CD = #prcCatgCd# 
        AND PC.ACTV_FLG = #activFlg#
        ANd PC.DEL_FLG = #delFlg#
        AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
        AND PC.GLBL_CMPY_CD = PLSP.GLBL_CMPY_CD
        AND PC.EZCANCELFLAG = PLSP.EZCANCELFLAG
        AND PC.PRC_CATG_CD = PLSP.PRC_CATG_CD
        <isNotNull property="mdlId">
        AND PLSP.MDL_ID = #mdlId#
        </isNotNull>
        <isNotNull property="prcMtrPkgPk">
        AND PLSP.PRC_MTR_PKG_PK = #prcMtrPkgPk#
        </isNotNull>
        <isNotNull property="prcSvcPlnTpCd">
        AND PLSP.PRC_SVC_PLN_TP_CD = #prcSvcPlnTpCd#
        </isNotNull>
        <isNotNull property="prcSvcContrTpCd">
        AND PLSP.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
        </isNotNull>
        <isNotNull property="mtrLbCd">
        AND PLSP.BLLG_MTR_LB_CD = #mtrLbCd#
        </isNotNull>
        <isNotNull property="prcListBandCd">
        AND PLSP.PRC_LIST_BAND_CD = #prcListBandCd#
        </isNotNull>
        AND PLSP.MDSE_CD IN (#mdseCd#, #ordTakeMdseCd#)
        <isNotNull property="termFromMthAot">
        AND PLSP.TERM_FROM_MTH_AOT = #termFromMthAot#
        </isNotNull>
        <isNotNull property="termThruMthAot">
        AND PLSP.TERM_THRU_MTH_AOT = #termThruMthAot#
        </isNotNull>
        AND PLSP.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PLSP.EFF_THRU_DT &gt;= #prcBaseDt# OR PLSP.EFF_THRU_DT IS NULL )
        AND PLSP.DEL_FLG = #delFlg#
    </statement>

    <statement id="getBaseQtyDiscount" parameterClass="Map" resultClass="Map">
        SELECT
            PLQD.QTY_DISC_PRC_AMT AS QTY_DISC_PRC_AMT
        FROM
            PRC_CATG PC
           ,PRC_LIST_QTY_DISC PLQD
        WHERE
            PC.GLBL_CMPY_CD = #glblCmpyCd#
        AND PC.EZCANCELFLAG = '0'
        AND PC.PRC_CATG_CD = #prcCatgCd# 
        AND PC.ACTV_FLG = #activFlg#
        ANd PC.DEL_FLG = #delFlg#
        AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
        AND PC.GLBL_CMPY_CD = PLQD.GLBL_CMPY_CD
        AND PC.EZCANCELFLAG = PLQD.EZCANCELFLAG
        AND PC.PRC_CATG_CD = PLQD.PRC_CATG_CD
        AND PLQD.PRC_QLFY_VAL_TXT IN (#mdseCd#, #ordTakeMdseCd#)
        AND PLQD.PKG_UOM_CD = #pkgUomCd#
        AND PLQD.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PLQD.EFF_THRU_DT &gt;= #prcBaseDt# OR PLQD.EFF_THRU_DT IS NULL )
        AND PLQD.DEL_FLG = #delFlg#
        AND NOT EXISTS (
            SELECT 1 FROM PRC_LIST_QTY_DISC_DTL PLQDD
            WHERE PLQD.GLBL_CMPY_CD = PLQDD.GLBL_CMPY_CD
              AND PLQD.EZCANCELFLAG = PLQDD.EZCANCELFLAG
              AND PLQD.PRC_LIST_QTY_DISC_PK = PLQDD.PRC_LIST_QTY_DISC_PK
              AND PLQDD.QTY_DISC_DTL_QTY &lt;= #qtyDiscQty#
              AND PLQDD.DEL_FLG = #delFlg#
        )

        UNION ALL

        SELECT
            PLQDD.PRC_BREAK_AMT
        FROM
           (
            SELECT
                PLQDDX.GLBL_CMPY_CD
               ,PLQDDX.EZCANCELFLAG
               ,PLQDDX.PRC_LIST_QTY_DISC_PK
               ,MAX(PLQDDX.QTY_DISC_DTL_QTY) QTY_DISC_DTL_QTY
            FROM
                PRC_CATG PC
               ,PRC_LIST_QTY_DISC PLQDX
               ,PRC_LIST_QTY_DISC_DTL PLQDDX
            WHERE
                PC.GLBL_CMPY_CD = #glblCmpyCd#
            AND PC.EZCANCELFLAG = '0'
            AND PC.PRC_CATG_CD = #prcCatgCd# 
            AND PC.ACTV_FLG = #activFlg#
            AND PC.DEL_FLG = #delFlg#
            AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
            AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )
            AND PC.GLBL_CMPY_CD = PLQDX.GLBL_CMPY_CD
            AND PC.EZCANCELFLAG = PLQDX.EZCANCELFLAG
            AND PC.PRC_CATG_CD = PLQDX.PRC_CATG_CD
            AND PLQDX.PRC_QLFY_VAL_TXT IN (#mdseCd#, #ordTakeMdseCd#)
            AND PLQDX.EFF_FROM_DT &lt;= #prcBaseDt#
            AND (PLQDX.EFF_THRU_DT &gt;= #prcBaseDt# OR PLQDX.EFF_THRU_DT IS NULL )
            AND PLQDX.DEL_FLG = #delFlg#
            AND PLQDX.GLBL_CMPY_CD = PLQDDX.GLBL_CMPY_CD
            AND PLQDX.EZCANCELFLAG = PLQDDX.EZCANCELFLAG
            AND PLQDX.PRC_LIST_QTY_DISC_PK = PLQDDX.PRC_LIST_QTY_DISC_PK
            AND PLQDDX.QTY_DISC_DTL_QTY &lt;= #qtyDiscQty#
            AND PLQDDX.PKG_UOM_CD = #pkgUomCd#
            AND PLQDDX.DEL_FLG = #delFlg#

            GROUP BY 
                PLQDDX.GLBL_CMPY_CD
               ,PLQDDX.EZCANCELFLAG
               ,PLQDDX.PRC_LIST_QTY_DISC_PK
           ) X
           ,PRC_LIST_QTY_DISC_DTL PLQDD
           ,PRC_LIST_QTY_DISC PLQD
        WHERE 
            X.GLBL_CMPY_CD = PLQDD.GLBL_CMPY_CD
        AND X.EZCANCELFLAG = PLQDD.EZCANCELFLAG
        AND X.PRC_LIST_QTY_DISC_PK = PLQDD.PRC_LIST_QTY_DISC_PK
        AND X.QTY_DISC_DTL_QTY = PLQDD.QTY_DISC_DTL_QTY
        AND PLQDD.GLBL_CMPY_CD = PLQD.GLBL_CMPY_CD
        AND PLQDD.EZCANCELFLAG = PLQD.EZCANCELFLAG
        AND PLQDD.PRC_LIST_QTY_DISC_PK = PLQD.PRC_LIST_QTY_DISC_PK
    </statement>

    <statement id="getPriceContractInfo" parameterClass="Map" resultClass="Map">
        SELECT
            PCTC.PRC_CONTR_CHRG_TP_CD
          , PCTC.PRC_CONTR_TRX_CHRG_PCT
          , PCTC.PRC_CONTR_TRX_CHRG_AMT
        FROM
            PRC_CONTR PC
          , PRC_CONTR_TRX_CHRG PCTC
          , PRC_CONTR_ORD_CATG PCOC
          , ORD_CATG_BIZ_CTX OCBC
        WHERE
              PC.GLBL_CMPY_CD = #glblCmpyCd#
          AND PC.EZCANCELFLAG = '0'
          AND PC.PRC_CONTR_NUM = #prcContrNum#
          AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
          AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )

          AND PC.GLBL_CMPY_CD = PCTC.GLBL_CMPY_CD
          AND PC.EZCANCELFLAG = PCTC.EZCANCELFLAG
          AND PC.PRC_CONTR_PK = PCTC.PRC_CONTR_PK
          AND PCTC.MDSE_CD IN (#mdseCd#, #ordTakeMdseCd#)
          <isNotNull property="soldToCustNum">
          AND ( PCTC.DS_ACCT_NUM IN (#soldToCustNum#, #billToCustNum#, #shipToCustNum#) OR PCTC.DS_ACCT_NUM IS NULL )
          </isNotNull>
          AND PCTC.EFF_FROM_DT &lt;= #prcBaseDt#
          AND (PCTC.EFF_THRU_DT &gt;= #prcBaseDt# OR PCTC.EFF_THRU_DT IS NULL )

          AND PCTC.GLBL_CMPY_CD = PCOC.GLBL_CMPY_CD
          AND PCTC.EZCANCELFLAG = PCOC.EZCANCELFLAG
          AND PCTC.PRC_CONTR_PK = PCOC.PRC_CONTR_PK
          AND PCTC.PRC_CONTR_TRX_CHRG_PK = PCOC.PRC_CONTR_TRX_CHRG_PK
          AND PCOC.DS_ORD_CATG_CD = #dsOrdCatgCd#

          AND PCTC.GLBL_CMPY_CD = OCBC.GLBL_CMPY_CD
          AND PCTC.EZCANCELFLAG = OCBC.EZCANCELFLAG
          AND PCTC.PRC_CONTR_REB_TP_CD = OCBC.THIRD_BIZ_CTX_ATTRB_TXT
          AND OCBC.DS_ORD_CATG_CD = #dsOrdCatgCd#
          AND OCBC.ORD_CATG_CTX_TP_CD IN (#ordCatgCtgTpEquip#, #ordCatgcTGTpSupplis#)
      UNION ALL
        SELECT
            PCTC.PRC_CONTR_CHRG_TP_CD
          , PCTC.PRC_CONTR_TRX_CHRG_PCT
          , PCTC.PRC_CONTR_TRX_CHRG_AMT
        FROM
            PRC_CONTR PC
          , PRC_CONTR_TRX_CHRG PCTC
          , ORD_CATG_BIZ_CTX OCBC
        WHERE
              PC.GLBL_CMPY_CD = #glblCmpyCd#
          AND PC.EZCANCELFLAG = '0'
          AND PC.PRC_CONTR_NUM = #prcContrNum#
          AND PC.EFF_FROM_DT &lt;= #prcBaseDt#
          AND (PC.EFF_THRU_DT &gt;= #prcBaseDt# OR PC.EFF_THRU_DT IS NULL )

          AND PC.GLBL_CMPY_CD = PCTC.GLBL_CMPY_CD
          AND PC.EZCANCELFLAG = PCTC.EZCANCELFLAG
          AND PC.PRC_CONTR_PK = PCTC.PRC_CONTR_PK
          AND PCTC.MDSE_CD IN (#mdseCd#, #ordTakeMdseCd#)
          <isNotNull property="soldToCustNum">
          AND ( PCTC.DS_ACCT_NUM IN (#soldToCustNum#, #billToCustNum#, #shipToCustNum#) OR PCTC.DS_ACCT_NUM IS NULL )
          </isNotNull>
          AND PCTC.EFF_FROM_DT &lt;= #prcBaseDt#
          AND (PCTC.EFF_THRU_DT &gt;= #prcBaseDt# OR PCTC.EFF_THRU_DT IS NULL )

          AND NOT EXISTS (
              SELECT * FROM PRC_CONTR_ORD_CATG PCOC
              WHERE
                    PCTC.GLBL_CMPY_CD = PCOC.GLBL_CMPY_CD
                AND PCTC.EZCANCELFLAG = PCOC.EZCANCELFLAG
                AND PCTC.PRC_CONTR_PK = PCOC.PRC_CONTR_PK
                AND PCTC.PRC_CONTR_TRX_CHRG_PK = PCOC.PRC_CONTR_TRX_CHRG_PK
          )

          AND PCTC.GLBL_CMPY_CD = OCBC.GLBL_CMPY_CD
          AND PCTC.EZCANCELFLAG = OCBC.EZCANCELFLAG
          AND PCTC.PRC_CONTR_REB_TP_CD = OCBC.THIRD_BIZ_CTX_ATTRB_TXT
          AND OCBC.DS_ORD_CATG_CD = #dsOrdCatgCd#
          AND OCBC.ORD_CATG_CTX_TP_CD IN (#ordCatgCtgTpEquip#, #ordCatgcTGTpSupplis#)
    </statement>

    <statement id="getPriceRule" parameterClass="Map" resultClass="Map">
        SELECT
             DTL.PRC_RULE_ADJ_LVL_CD
            ,DTL.PRC_RULE_MOD_TP_CD
            ,DTL.PRC_RULE_ADJ_TP_CD
            ,DTL.PRC_RULE_ATTRB_CD
        FROM SPEC_COND_PRC SCP
             ,PRC_RULE_DTL  DTL
        WHERE
              SCP.GLBL_CMPY_CD     = #glblCmpyCd#
        AND   SCP.SPEC_COND_PRC_PK = #specCondPrcPK#
        AND   SCP.EZCANCELFLAG     = '0'
        AND   SCP.GLBL_CMPY_CD     = DTL.GLBL_CMPY_CD
        AND   SCP.PRC_RULE_DTL_PK  = DTL.PRC_RULE_DTL_PK 
        AND   SCP.EZCANCELFLAG     = DTL.EZCANCELFLAG
        UNION ALL
        SELECT
             HDR.PRC_RULE_ADJ_LVL_CD
            ,HDR.PRC_RULE_MOD_TP_CD
            ,HDR.PRC_RULE_ADJ_TP_CD
            ,DTL.PRC_RULE_ATTRB_CD
        FROM SPEC_COND_PRC SCP
            ,PRC_ADJ_DTL  DTL
            ,PRC_RULE_HDR  HDR
        WHERE
              SCP.GLBL_CMPY_CD     = #glblCmpyCd#
        AND   SCP.SPEC_COND_PRC_PK = #specCondPrcPK#
        AND   SCP.EZCANCELFLAG     = '0'
        AND   SCP.GLBL_CMPY_CD     = DTL.GLBL_CMPY_CD
        AND   SCP.PRC_RULE_DTL_PK  = DTL.PRC_RULE_DTL_PK 
        AND   SCP.EZCANCELFLAG     = DTL.EZCANCELFLAG
        AND   DTL.GLBL_CMPY_CD     = HDR.GLBL_CMPY_CD
        AND   DTL.PRC_RULE_HDR_PK  = HDR.PRC_RULE_HDR_PK 
        AND   DTL.EZCANCELFLAG     = HDR.EZCANCELFLAG
              
    </statement>

</sqlMap>
