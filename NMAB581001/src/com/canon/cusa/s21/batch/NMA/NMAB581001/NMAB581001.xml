<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB581001">
    <statement id="getCbsFedexSvcDlr" parameterClass="Map" resultClass="Map">
        SELECT 
             CV.GLBL_CMPY_CD
            ,CV.RTL_DLR_CD
            ,CV.LOC_NM
            ,CV.ADDL_LOC_NM  
            ,CV.RTL_SELL_TO_ATTN_TXT
            ,CV.FIRST_LINE_ADDR
            ,CV.CTY_ADDR
            ,CV.ST_CD
            ,CV.POST_CD
            ,CV.TEL_NUM
            ,CV.FAX_NUM
            ,CV.EML_ADDR
        FROM
            CSA_FEDEX_SVC_DLR_V CV
        WHERE
            CV.EZCANCELFLAG = '0'
        ORDER BY
            CV.RTL_DLR_CD
    </statement>
    <statement id="getVendInfo" parameterClass="Map" resultClass="Map">
        SELECT
             VND.VND_PK
            ,VND.VND_CD
            ,VND.LOC_NUM
        FROM
            VND          VND
        WHERE
            VND.GLBL_CMPY_CD            = #GLBL_CMPY_CD#
        AND VND.SPLY_SITE_DEAL_CD       = #SPLY_SITE_DEAL_CD#
        AND VND.EZCANCELFLAG            = '0'
    </statement>
    <statement id="getContactType" parameterClass="Map" resultClass="String">
        SELECT
            CTAC_TP_CD
        FROM
        (
            SELECT
                CT.CTAC_TP_CD AS CTAC_TP_CD
            FROM
                CTAC_TP CT
            WHERE
                CT.GLBL_CMPY_CD    = #GLBL_CMPY_CD#
            AND CT.SPLY_IND_FLG    = 'Y'
            AND CT.ACTV_FLG        = 'Y'
            AND CT.EZCANCELFLAG    = '0'
            ORDER BY 
                CT.CTAC_TP_SORT_NUM
        )
        WHERE
            ROWNUM    = 1
    </statement>
    <statement id="getPrntVndTpCd" parameterClass="Map" resultClass="String">
        SELECT
            PVT.PRNT_VND_TP_CD
        FROM
             PRNT_VND_TP_CONV PVCT
            ,PRNT_VND_TP PVT
        WHERE
            PVCT.GLBL_CMPY_CD              = #GLBL_CMPY_CD#
        AND PVCT.XTRNL_SYS_VND_TP_LKUP_TXT = #XTRNL_SYS_VND_TP_LKUP_TXT#
        AND PVCT.GLBL_CMPY_CD              = PVT.GLBL_CMPY_CD
        AND PVCT.PRNT_VND_TP_CD            = PVT.PRNT_VND_TP_CD
        AND PVCT.EZCANCELFLAG              = '0'
        AND PVT.EZCANCELFLAG               = '0'
    </statement>
    <statement id="getSplyContact" parameterClass="Map" resultClass="Map">
        SELECT
             DCPR.EFF_FROM_DT
            ,CP.CTAC_PSN_PK
            ,CP.CTAC_PSN_FIRST_NM
            ,CP.CTAC_PSN_LAST_NM
            ,DCPR.CTAC_TP_CD
            ,DCP.DS_CTAC_PNT_PK
            ,DCP.DS_CTAC_PNT_TP_CD
            ,V.VND_CD
        FROM
             VND V
            ,PRNT_VND PV
            ,DS_CTAC_PSN_RELN DCPR
            ,CTAC_PSN CP
            ,DS_CTAC_PNT DCP
        WHERE
            V.GLBL_CMPY_CD             = #GLBL_CMPY_CD#
        AND V.SPLY_SITE_DEAL_CD        = #SPLY_SITE_DEAL_CD#
        AND V.GLBL_CMPY_CD             = PV.GLBL_CMPY_CD
        AND V.PRNT_VND_PK              = PV.PRNT_VND_PK
        AND V.GLBL_CMPY_CD             = DCPR.GLBL_CMPY_CD
        AND V.LOC_NUM                  = DCPR.LOC_NUM
        AND DCPR.GLBL_CMPY_CD          = CP.GLBL_CMPY_CD
        AND DCPR.CTAC_PSN_PK           = CP.CTAC_PSN_PK
        AND CP.GLBL_CMPY_CD            = DCP.GLBL_CMPY_CD
        AND CP.CTAC_PSN_PK             = DCP.CTAC_PSN_PK
        AND V.EZCANCELFLAG             = '0'
        AND PV.EZCANCELFLAG            = '0'
        AND DCPR.EZCANCELFLAG          = '0'
        AND CP.EZCANCELFLAG            = '0'
        AND DCP.EZCANCELFLAG           = '0'
        ORDER BY
            DCP.DS_CTAC_PNT_TP_CD
    </statement>
</sqlMap>
