<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NPAB232001">

    <statement id="findIFData" parameterClass="Map" resultClass="Map">
        SELECT
            AMV.MDSE_CD
            ,TPWRX.RTL_WH_CD
            ,TPWRX.RTL_SWH_CD
            ,WO.WH_OWNR_CD
            ,SHIP.SHIP_TO_CUST_CD
            ,SHIP.FIRST_LINE_ADDR
            ,SHIP.SCD_LINE_ADDR
            ,SHIP.THIRD_LINE_ADDR
            ,SHIP.FRTH_LINE_ADDR
            ,PLW.LOC_NM
            ,SHIP.ADDL_LOC_NM
            ,SHIP.CTY_ADDR
            ,SHIP.ST_CD
            ,SHIP.PROV_NM
            ,CNTY.CNTY_NM
            ,SHIP.POST_CD
            ,SHIP.CTRY_CD
            ,IF.PO_QTY
            ,IF.WH_RG_CD
            ,IF.RTL_WH_CD AS IF_RTL_WH_CD
            ,IF.MDSE_CD   AS IF_MDSE_CD
            ,IF.DUE_DT
            ,AH.PRNT_VND_CD
            ,AD.VND_CD
            ,AD.UNIT_PRC_AMT
            ,AD.MDSE_CD AS ASL_MDSE_CD
            ,AD.SPLY_ITEM_NUM
            ,AD.ASL_DTL_PK
            ,IF.PRIM_SPLY_SITE_TXT
            ,NVL(IF.SRC_APVL_ID, 0) AS SRC_APVL_ID
            ,NVL(IF.SRC_APVL_SQ, 0) AS SRC_APVL_SQ
            <!-- START 2022/07/18 F.Fadriquela [QC#60274 ADD] -->
            ,RW.RTL_WH_CATG_CD
            <!-- END 2022/07/18 F.Fadriquela [QC#60274 ADD] -->
        FROM
            NPAI2320_01         IF
           ,TRD_PTNR_WH_RG_XREF TPWRX
           ,ALL_MDSE_V          AMV
           ,RTL_WH              RW
           ,WH_OWNR             WO
           ,SHIP_TO_CUST        SHIP
           ,CNTY                CNTY
           ,PTY_LOC_WRK         PLW
           ,ASL_HDR AH
           ,ASL_DTL AD
        WHERE
            IF.INTERFACE_ID                         = #interfaceId#
        AND IF.TRANSACTION_ID                       = #transactionId#
        AND TPWRX.GLBL_CMPY_CD(+)                   = #glblCmpyCd#
        AND IF.WH_RG_CD                             = TPWRX.TRD_PTNR_WH_RG_NM(+)
        AND IF.RTL_WH_CD                            = TPWRX.RTL_WH_CD(+)
        AND AMV.GLBL_CMPY_CD(+)                     = #glblCmpyCd#
        AND IF.MDSE_CD                              = AMV.MDSE_CD(+)
        AND TPWRX.GLBL_CMPY_CD                      = RW.GLBL_CMPY_CD(+)
        AND TPWRX.RTL_WH_CD                         = RW.RTL_WH_CD(+)
        AND RW.GLBL_CMPY_CD                         = WO.GLBL_CMPY_CD(+)
        AND RW.WH_OWNR_CD                           = WO.WH_OWNR_CD(+)
        AND TPWRX.GLBL_CMPY_CD                      = SHIP.GLBL_CMPY_CD(+)
        AND TPWRX.RTL_WH_CD                         = SHIP.SHIP_TO_CUST_CD(+)
        AND SHIP.GLBL_CMPY_CD                       = CNTY.GLBL_CMPY_CD(+)
        AND SHIP.CNTY_PK                            = CNTY.CNTY_PK(+)
        AND SHIP.GLBL_CMPY_CD                       = PLW.GLBL_CMPY_CD(+)
        AND SHIP.PTY_LOC_PK                         = PLW.PTY_LOC_PK(+)
        AND AMV.GLBL_CMPY_CD                        = AD.GLBL_CMPY_CD(+)
        AND AMV.MDSE_CD                             = AD.MDSE_CD(+)
        AND AD.PRIM_SPLY_FLG(+) = 'Y'
        AND NVL(AD.EFF_FROM_DT(+), '00000000')  &lt;= #salesDate#
        AND NVL(AD.EFF_THRU_DT(+), '99991231')  &gt;= #salesDate#
        AND AD.PRIM_SPLY_FLG(+)                     = 'Y'
        AND IF.PRIM_SPLY_SITE_TXT                   = AD.VND_CD(+)
        AND AMV.MDSE_CD                             = AD.MDSE_CD(+)
        AND AD.GLBL_CMPY_CD                         = AH.GLBL_CMPY_CD(+)
        AND AD.ASL_HDR_PK                           = AH.ASL_HDR_PK(+)
        AND NVL(AH.ASL_START_DT(+), '00000000') &lt;= #salesDate#
        AND NVL(AH.ASL_END_DT(+), '99991231')   &gt;= #salesDate#
        AND AD.GLBL_CMPY_CD                         = AH.GLBL_CMPY_CD(+)
        AND AD.ASL_HDR_PK                           = AH.ASL_HDR_PK(+)
        AND IF.EZCANCELFLAG(+)                      = '0'
        AND TPWRX.EZCANCELFLAG(+)                   = '0'
        AND RW.EZCANCELFLAG(+)                      = '0'
        AND WO.EZCANCELFLAG(+)                      = '0'
        AND SHIP.EZCANCELFLAG(+)                    = '0'
        AND CNTY.EZCANCELFLAG(+)                    = '0'
        AND PLW.EZCANCELFLAG(+)                     = '0'
        AND AH.EZCANCELFLAG(+)                      = '0'
        AND AD.EZCANCELFLAG(+)                      = '0'
        ORDER BY
            TPWRX.RTL_WH_CD
            ,TPWRX.RTL_SWH_CD
            ,PRNT_VND_CD
            ,DUE_DT
            ,SRC_APVL_ID
            ,SRC_APVL_SQ
            ,AMV.MDSE_CD
    </statement>

</sqlMap>
