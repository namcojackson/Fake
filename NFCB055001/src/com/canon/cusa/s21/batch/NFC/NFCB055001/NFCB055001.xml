<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NFCB055001">
   <statement id="getTargetList" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE1_1.RCPT_NUM              ECHK_NTFY_INFO_REF_TXT
         ,INLINE1_1.RCPT_NUM              RCPT_NUM
         ,INLINE1_1.RCPT_CHK_NUM          RCPT_CHK_NUM
         ,CASE
             WHEN (INLINE1_1.AR_CASH_APPLY_STS_CD = #arCashApplyStsCd_U# OR INLINE1_1.AR_CASH_APPLY_STS_CD = #arCashApplyStsCd_P#) THEN INLINE1_1.FUNC_RCPT_AMT
             ELSE INLINE1_1.FUNC_NET_RCPT_AMT
          END                             FUNC_RCPT_AMT
         ,INLINE1_1.AR_CASH_APPLY_STS_CD  AR_CASH_APPLY_STS_CD
         ,INLINE1_1.PAYER_CUST_CD         PAYER_CUST_CD
         ,INLINE1_2.LOC_NM                LOC_NM
         ,''                              AR_RCPT_RCV_ERR_FLG
         ,CASE WHEN INLINE1_1.PAYER_CUST_CD IS NULL THEN '10'
                WHEN INLINE1_1.PAYER_CUST_CD IS NOT NULL AND (INLINE1_1.AR_CASH_APPLY_STS_CD = #arCashApplyStsCd_U# OR INLINE1_1.AR_CASH_APPLY_STS_CD = #arCashApplyStsCd_P#) THEN '20'
                ELSE '30' END ERR_STS_CD
         ,INLINE1_2.CLT_PTFO_NM CLT_PTFO_NM
         ,INLINE1_2.CLT_PSN_CD CLT_PSN_CD
         ,INLINE1_2.CLT_PSN_NM CLT_PSN_NM
         ,'' AR_RCPT_RCV_INTFC_PK
     FROM
          AR_RCPT INLINE1_1
          ,(
             SELECT
                    INLINE1_2_1.SELL_TO_CUST_CD
                    ,INLINE1_2_1.LOC_NM
                    ,INLINE1_2_2.CLT_PTFO_NM
                    ,INLINE1_2_2.CLT_PSN_CD
                    ,INLINE1_2_2.CLT_PSN_NM
                FROM
                     SELL_TO_CUST INLINE1_2_1
                    ,CLT_PTFO INLINE1_2_2
               WHERE
                     INLINE1_2_1.EZCANCELFLAG = '0'
                 AND INLINE1_2_2.EZCANCELFLAG = '0'
                 AND INLINE1_2_1.GLBL_CMPY_CD = #glblCmpyCd#
                 AND INLINE1_2_1.GLBL_CMPY_CD = INLINE1_2_2.GLBL_CMPY_CD
                 AND INLINE1_2_1.CLT_PTFO_PK = INLINE1_2_2.CLT_PTFO_PK
           ) INLINE1_2
    WHERE
          INLINE1_1.EZCANCELFLAG = '0'
      AND INLINE1_1.GLBL_CMPY_CD = #glblCmpyCd#
      AND INLINE1_1.RCV_FUNC_ID = #rcvFuncId#
      AND INLINE1_1.PAYER_CUST_CD = INLINE1_2.SELL_TO_CUST_CD(+)
      AND NOT EXISTS (
                      SELECT
                             INLINE1_3.ECHK_NTFY_INFO_REF_TXT
                        FROM
                             ECHK_NTFY_INFO INLINE1_3
                       WHERE INLINE1_3.EZCANCELFLAG = '0'
                         AND INLINE1_3.GLBL_CMPY_CD = #glblCmpyCd#
                         AND INLINE1_3.ECHK_NTFY_INFO_REF_TXT = INLINE1_1.RCPT_NUM
                     )
    UNION
   SELECT
          TO_CHAR(INLINE2_1.AR_RCPT_RCV_INTFC_PK)  ECHK_NTFY_INFO_REF_TXT
         ,INLINE2_1.CUST_RCPT_NUM                  RCPT_NUM
         ,INLINE2_1.CUST_RCPT_NUM                  RCPT_CHK_NUM
         ,INLINE2_1.CUST_RCPT_AMT                  FUNC_RCPT_AMT
         ,''                                       AR_CASH_APPLY_STS_CD
         ,INLINE2_1.PAYER_CUST_CD                  PAYER_CUST_CD
         ,INLINE2_2.LOC_NM                         LOC_NM
         ,INLINE2_1.AR_RCPT_RCV_ERR_FLG            AR_RCPT_RCV_ERR_FLG
         ,'90'                                     ERR_STS_CD
         ,INLINE2_2.CLT_PTFO_NM CLT_PTFO_NM
         ,INLINE2_2.CLT_PSN_CD CLT_PSN_CD
         ,INLINE2_2.CLT_PSN_NM CLT_PSN_NM
         ,TO_CHAR(INLINE2_1.AR_RCPT_RCV_INTFC_PK) AR_RCPT_RCV_INTFC_PK
      FROM
           AR_RCPT_RCV_INTFC INLINE2_1
          ,(
             SELECT
                    INLINE2_2_1.SELL_TO_CUST_CD
                   ,INLINE2_2_1.LOC_NM
                   ,INLINE2_2_2.CLT_PTFO_NM
                   ,INLINE2_2_2.CLT_PSN_CD
                   ,INLINE2_2_2.CLT_PSN_NM
               FROM
                    SELL_TO_CUST INLINE2_2_1
                   ,CLT_PTFO INLINE2_2_2
              WHERE
                    INLINE2_2_1.EZCANCELFLAG = '0'
                AND INLINE2_2_2.EZCANCELFLAG = '0'
                AND INLINE2_2_1.GLBL_CMPY_CD = #glblCmpyCd#
                AND INLINE2_2_1.GLBL_CMPY_CD = INLINE2_2_2.GLBL_CMPY_CD
                AND INLINE2_2_1.CLT_PTFO_PK = INLINE2_2_2.CLT_PTFO_PK
             ) INLINE2_2
     WHERE INLINE2_1.EZCANCELFLAG = '0'
       AND INLINE2_1.GLBL_CMPY_CD = #glblCmpyCd#
       AND INLINE2_1.RCV_FUNC_ID = #rcvFuncId#
       AND INLINE2_1.AR_RCPT_RCV_ERR_FLG = #arRcptRcvErrFlg#
       AND INLINE2_1.PAYER_CUST_CD = INLINE2_2.SELL_TO_CUST_CD(+)
       AND NOT EXISTS (
                       SELECT
                              INLINE2_3.ECHK_NTFY_INFO_REF_TXT
                         FROM
                              ECHK_NTFY_INFO INLINE2_3
                        WHERE
                              INLINE2_3.EZCANCELFLAG = '0'
                          AND INLINE2_3.GLBL_CMPY_CD = #glblCmpyCd#
                          AND TO_CHAR(INLINE2_1.AR_RCPT_RCV_INTFC_PK) = INLINE2_3.ECHK_NTFY_INFO_REF_TXT
                       )
   </statement>
   <statement id="getInvoiceInformation" parameterClass="Map" resultClass="Map">
   SELECT	NVL(INLINE4.AR_TRX_NUM, INLINE2.AR_CUST_REF_NUM) AR_TRX_NUM,
			INLINE4.AR_TRX_TP_CD,
			INLINE4.AR_CASH_APPLY_STS_CD,
			INLINE4.FUNC_ORIG_GRS_AMT,
			INLINE4.FUNC_RMNG_BAL_GRS_AMT
	FROM	AR_RCPT INLINE1,
			AR_RCPT_DTL INLINE2,
			AR_CASH_APP INLINE3,
			AR_TRX_BAL INLINE4
	WHERE	INLINE1.EZCANCELFLAG = '0'
	AND		INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
	AND		INLINE1.RCPT_NUM = #rcptNum#
	AND		INLINE2.EZCANCELFLAG = '0'
	AND		INLINE1.GLBL_CMPY_CD = INLINE2.GLBL_CMPY_CD
	AND		INLINE1.RCPT_NUM = INLINE2.RCPT_NUM
	AND		INLINE2.AUTO_CRAT_FLG = 'N'
	AND		INLINE3.EZCANCELFLAG (+)= '0'
	AND		INLINE2.GLBL_CMPY_CD = INLINE3.GLBL_CMPY_CD(+)
	AND		INLINE2.RCPT_NUM = INLINE3.RCPT_NUM(+)
	AND		INLINE2.INV_NUM = INLINE3.AR_TRX_NUM(+)
	AND		INLINE4.EZCANCELFLAG (+)= '0'
	AND		INLINE3.GLBL_CMPY_CD = INLINE4.GLBL_CMPY_CD(+)
	AND		INLINE3.AR_TRX_NUM = INLINE4.AR_TRX_NUM(+)
	AND		INLINE4.AR_TRX_TP_CD (+)IN (#arTrxTpCd_Inv#,#arTrxTpCd_Crm#)
	AND		INLINE4.AR_CASH_APPLY_STS_CD (+)IN (#arCashApplyStsCd_P#,#arCashApplyStsCd_A#)
   </statement>
</sqlMap>