<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAL0020Query">

    <typeAlias alias="NSAL0020CMsg"      type="business.blap.NSAL0020.NSAL0020CMsg"/>
    <typeAlias alias="NSAL0020_ASMsg"    type="business.blap.NSAL0020.NSAL0020_ASMsg"/>

    <statement id="getSvcMachMstrStsTpList" parameterClass="Map" resultClass="Map">
        SELECT
            SM.SVC_MACH_MSTR_STS_CD        AS SVC_MACH_MSTR_STS_CD
           ,SM.SVC_MACH_MSTR_STS_DESC_TXT  AS SVC_MACH_MSTR_STS_DESC_TXT
        FROM
            SVC_MACH_MSTR_STS SM
        WHERE
            SM.GLBL_CMPY_CD              = #glblCmpyCd#
            AND SM.EZCANCELFLAG          = '0'
        ORDER BY
            SM.SVC_MACH_MSTR_STS_SORT_NUM
    </statement>

<!-- START 2016/02/04 T.Tomita [QC#545, DEL] -->
<!--
    <statement id="getCoaMdseTpCdList" parameterClass="Map" resultClass="Map">
        SELECT
            CMT.COA_MDSE_TP_CD        AS COA_MDSE_TP_CD
           ,CMT.COA_MDSE_TP_DESC_TXT  AS COA_MDSE_TP_DESC_TXT
        FROM
            COA_MDSE_TP CMT
        WHERE
            CMT.GLBL_CMPY_CD             = #glblCmpyCd#
            AND CMT.EZCANCELFLAG         = '0'
        ORDER BY
            CMT.COA_MDSE_TP_SORT_NUM
    </statement>
-->
<!-- END 2016/02/04 T.Tomita [QC#545, DEL] -->

    <statement id="getSvcCtacTpCdList" parameterClass="Map" resultClass="Map">
        SELECT
            SC.SVC_CTAC_TP_CD  AS SVC_CTAC_TP_CD
           ,SC.SVC_CTAC_TP_NM  AS SVC_CTAC_TP_NM
        FROM
            SVC_CTAC_TP SC
        WHERE
            SC.GLBL_CMPY_CD              = #glblCmpyCd#
            AND SC.EZCANCELFLAG          = '0'
        ORDER BY
            SC.SVC_CTAC_TP_SORT_NUM
    </statement>

    <statement id="getSavedSearchOptionList" parameterClass="Map" resultClass="Map">
        SELECT
                  SSO.SRCH_OPT_PK
                , SSO.SRCH_OPT_NM
            FROM
                SAVE_SRCH_OPT SSO 
            WHERE
                SSO.GLBL_CMPY_CD        = #glblCmpyCd#
                AND SSO.SRCH_OPT_APL_ID = #srchOptAplId#
                AND SSO.SRCH_OPT_USR_ID = #srchOptUsrId#
                AND SSO.EZCANCELFLAG    = '0'
            ORDER BY
                  SSO.SRCH_OPT_PK
    </statement>

<!-- START 2018/03/05 K.Kojima [QC#24477, ADD] -->
    <statement id="getMachMstrInfoListForScreen" parameterClass="Map" resultMap="result.getMachMstrInfoList">
<!-- START 2018/07/19 K.Kojima [QC#27326, ADD] -->
        WITH SVC_MACH_MSTR_TMP AS (
            SELECT
                 SMM.GLBL_CMPY_CD
                ,SMM.SVC_MACH_MSTR_PK
                ,SMM.SVC_CONFIG_MSTR_PK
                ,SMM.SER_NUM
                ,SMM.MDSE_CD
                ,SMM.SVC_MACH_MSTR_STS_CD
                ,SMM.OWNR_ACCT_NUM
                ,SMM.BILL_TO_ACCT_NUM
                ,SMM.BILL_TO_LOC_NUM
                ,SMM.CUR_LOC_ACCT_NUM
                ,SMM.CUR_LOC_NUM
                ,SMM.IND_BILL_TO_LOC_NUM
                ,SMM.IND_CUR_LOC_NUM
                ,SMM.ISTL_DT
                ,SMM.EZINTIME
                ,SMM.EZINUSERID
                ,SMM.EZUPTIME
                ,SMM.EZUPUSERID
                ,SMM.EZTABLEID
            FROM
                SVC_MACH_MSTR SMM
            WHERE
                    SMM.GLBL_CMPY_CD = #glblCmpyCd#
                AND SMM.EZCANCELFLAG = '0'
                <isNotNull property="bizMsg.serNum">
                <isEqual property="serNumLikeFlag" compareValue="N">
<!-- START 2024/02/28 K.Watanabe [QC#63541,MOD] -->
<!--            AND SMM.SER_NUM                 =    #bizMsg.serNum# -->
                AND (
                        SMM.SER_NUM             = #bizMsg.serNum#
                    OR  SMM.CUST_MACH_CTRL_NUM  = #bizMsg.serNum#
                )
<!-- END 2024/02/28 K.Watanabe [QC#63541,MOD] -->
                </isEqual>
                <isEqual property="serNumLikeFlag" compareValue="Y">
<!-- START 2024/02/28 K.Watanabe [QC#63541,MOD] -->
<!--            AND SMM.SER_NUM              LIKE    #bizMsg.serNum# -->
                AND (
                        SMM.SER_NUM             LIKE #bizMsg.serNum#
                    OR  SMM.CUST_MACH_CTRL_NUM  LIKE #bizMsg.serNum#
                )
<!-- END 2024/02/28 K.Watanabe [QC#63541,MOD] -->
                </isEqual>
                </isNotNull>
                <isNotNull property="bizMsg.xxScrItem30Txt_03">
                AND SMM.SVC_MACH_MSTR_PK     LIKE    #bizMsg.xxScrItem30Txt_03#
                </isNotNull>
                <isNotNull property="bizMsg.xxChkBox">
                AND SMM.SVC_MACH_MSTR_STS_CD &lt;&gt;     #svcMachMstrSts#
                </isNotNull>
                <isNotNull property="bizMsg.istlDt_FR">
                AND SMM.ISTL_DT              &gt;=    #bizMsg.istlDt_FR#
                </isNotNull>
                <isNotNull property="bizMsg.istlDt_TO">
                AND SMM.ISTL_DT              &lt;=    #bizMsg.istlDt_TO#
                </isNotNull>
                <isNotNull property="bizMsg.svcMachMstrStsCd_PS">
                AND SMM.SVC_MACH_MSTR_STS_CD  =      #bizMsg.svcMachMstrStsCd_PS#
                </isNotNull>
                <isNotNull property="bizMsg.ownrAcctNum">
                AND SMM.OWNR_ACCT_NUM        LIKE    #bizMsg.ownrAcctNum#
                </isNotNull>
                <isNotNull property="bizMsg.billToAcctNum">
                AND SMM.BILL_TO_ACCT_NUM     LIKE    #bizMsg.billToAcctNum#
                </isNotNull>
                <isNotNull property="bizMsg.indBillToLocNum">
                AND SMM.IND_BILL_TO_LOC_NUM  LIKE    #bizMsg.indBillToLocNum#
                </isNotNull>
                <isNotNull property="bizMsg.curLocAcctNum">
                AND SMM.CUR_LOC_ACCT_NUM     LIKE    #bizMsg.curLocAcctNum#
                </isNotNull>
                <isNotNull property="bizMsg.indCurLocNum">
                AND SMM.IND_CUR_LOC_NUM      LIKE    #bizMsg.indCurLocNum#
                </isNotNull>
                <isNotNull property="bizMsg.mdseCd">
                AND SMM.MDSE_CD              LIKE    #bizMsg.mdseCd#
                </isNotNull>
                <isNotNull property="bizMsg.cpoOrdNum">
                AND SMM.CPO_ORD_NUM          LIKE    #bizMsg.cpoOrdNum#
                </isNotNull>
                <isNotNull property="bizMsg.custMachCtrlNum">
                AND SMM.CUST_MACH_CTRL_NUM   LIKE    #bizMsg.custMachCtrlNum#
                </isNotNull>
                <isNotNull property="bizMsg.xxScrItem30Txt_04">
                AND SMM.SVC_LIC_CNT          LIKE    #bizMsg.xxScrItem30Txt_04#
                </isNotNull>
                <isNotNull property="bizMsg.custIssPoNum">
                <!-- START 2019/03/13 S.Kitamura [QC#30747, MOD]  -->
                <!-- AND SMM.CUST_ISS_PO_NUM      LIKE    #bizMsg.custIssPoNum# -->
                AND UPPER(SMM.CUST_ISS_PO_NUM) LIKE    #bizMsg.custIssPoNum#
                <!-- END 2019/03/13 S.Kitamura [QC#30747, MOD]  -->
                </isNotNull>
                <isEqual property="svcConfigMstrSearchFlag" compareValue="Y">
                AND EXISTS(
                    SELECT
                        1
                    FROM
                         SVC_CONFIG_MSTR SCM
                        <isNotNull property="bizMsg.t_MdlNm">
                        ,MDL_NM         MN
                        </isNotNull>
                    WHERE
                            SMM.GLBL_CMPY_CD          = SCM.GLBL_CMPY_CD
                        AND SMM.SVC_CONFIG_MSTR_PK    = SCM.SVC_CONFIG_MSTR_PK
                        AND SCM.EZCANCELFLAG          = '0'
                        <isNotNull property="bizMsg.xxScrItem30Txt_02">
                        <isEqual property="svcConfigMstrPkLikeFlag" compareValue="N">
                        AND SCM.SVC_CONFIG_MSTR_PK    = #bizMsg.xxScrItem30Txt_02#
                        </isEqual>
                        <isEqual property="svcConfigMstrPkLikeFlag" compareValue="Y">
                        AND SCM.SVC_CONFIG_MSTR_PK LIKE #bizMsg.xxScrItem30Txt_02#
                        </isEqual>
                        </isNotNull>
                        <isNotNull property="bizMsg.xxScrItem30Txt_01">
                        AND SCM.SVC_SLN_SQ         LIKE #bizMsg.xxScrItem30Txt_01#
                        </isNotNull>
                        <isNotNull property="bizMsg.svcSlnNm">
                        AND SCM.SVC_SLN_NM         LIKE #bizMsg.svcSlnNm#
                        </isNotNull>
                        <isNotNull property="bizMsg.t_MdlNm">
                        AND SCM.GLBL_CMPY_CD          = MN.T_GLBL_CMPY_CD
                        AND SCM.MDL_ID                = MN.T_MDL_ID
                        AND MN.EZCANCELFLAG           = '0'
                        AND MN.T_MDL_NM            LIKE #bizMsg.t_MdlNm#
                        </isNotNull>
                )
                </isEqual>
                <isNotNull property="bizMsg.xxComnScrColValTxt_O">
                AND EXISTS(
                    SELECT
                        1
                    FROM
                        SELL_TO_CUST STC1
                    WHERE
                            SMM.GLBL_CMPY_CD                     = STC1.GLBL_CMPY_CD
                        AND SMM.OWNR_ACCT_NUM                    = STC1.SELL_TO_CUST_CD
                        AND STC1.EFF_FROM_DT                 &lt;= #bizMsg.slsDt#
                        AND NVL(STC1.EFF_THRU_DT, #maxDate#) &gt;= #bizMsg.slsDt#
                        AND STC1.RGTN_STS_CD                     = #rgtnStsCd#
                        AND STC1.EZCANCELFLAG                    = '0'
                        AND STC1.DS_ACCT_NM                   LIKE #bizMsg.xxComnScrColValTxt_O#
                )
                </isNotNull>
                <isNotNull property="bizMsg.xxComnScrColValTxt_B">
                AND EXISTS(
                    SELECT
                        1
                    FROM
                         SELL_TO_CUST STC2
                        ,BILL_TO_CUST BTC2
                    WHERE
                            SMM.GLBL_CMPY_CD                     = STC2.GLBL_CMPY_CD
                        AND SMM.BILL_TO_ACCT_NUM                 = STC2.SELL_TO_CUST_CD
                        AND STC2.EFF_FROM_DT                 &lt;= #bizMsg.slsDt#
                        AND NVL(STC2.EFF_THRU_DT, #maxDate#) &gt;= #bizMsg.slsDt#
                        AND STC2.RGTN_STS_CD                     = #rgtnStsCd#
                        AND STC2.EZCANCELFLAG                    = '0'
                        AND SMM.GLBL_CMPY_CD                     = BTC2.GLBL_CMPY_CD
                        AND SMM.BILL_TO_LOC_NUM                  = BTC2.BILL_TO_CUST_CD
                        AND BTC2.EFF_FROM_DT                 &lt;= #bizMsg.slsDt#
                        AND NVL(BTC2.EFF_THRU_DT, #maxDate#) &gt;= #bizMsg.slsDt#
                        AND BTC2.RGTN_STS_CD                     = #rgtnStsCd#
                        AND BTC2.EZCANCELFLAG                    = '0'
                        AND STC2.DS_ACCT_NM
                            || DECODE(BTC2.FIRST_LINE_ADDR,  null, '', ' ' || BTC2.FIRST_LINE_ADDR)
                            || DECODE(BTC2.SCD_LINE_ADDR,    null, '', ' ' || BTC2.SCD_LINE_ADDR)
                            || DECODE(BTC2.THIRD_LINE_ADDR,  null, '', ' ' || BTC2.THIRD_LINE_ADDR)
                            || DECODE(BTC2.FRTH_LINE_ADDR,   null, '', ' ' || BTC2.FRTH_LINE_ADDR)
                            || DECODE(BTC2.CTY_ADDR,         null, '', ' ' || BTC2.CTY_ADDR)
                            || DECODE(BTC2.ST_CD,            null, '', ' ' || BTC2.ST_CD)
                            || DECODE(BTC2.POST_CD,          null, '', ' ' || BTC2.POST_CD)
                                                              LIKE #bizMsg.xxComnScrColValTxt_B#
                )
                </isNotNull>
                <isNotNull property="bizMsg.xxComnScrColValTxt_C">
                AND EXISTS(
                    SELECT
                        1
                    FROM
                         SELL_TO_CUST STC3
                        ,SHIP_TO_CUST STC
                    WHERE
                            SMM.GLBL_CMPY_CD                     = STC3.GLBL_CMPY_CD
                        AND SMM.CUR_LOC_ACCT_NUM                 = STC3.SELL_TO_CUST_CD
                        AND STC3.EFF_FROM_DT                 &lt;= #bizMsg.slsDt#
                        AND NVL(STC3.EFF_THRU_DT, #maxDate#) &gt;= #bizMsg.slsDt#
                        AND STC3.RGTN_STS_CD                     = #rgtnStsCd#
                        AND STC3.EZCANCELFLAG                    = '0'
                        AND SMM.GLBL_CMPY_CD                     = STC.GLBL_CMPY_CD
                        AND SMM.CUR_LOC_NUM                      = STC.SHIP_TO_CUST_CD
                        AND STC.EFF_FROM_DT                  &lt;= #bizMsg.slsDt#
                        AND NVL(STC.EFF_THRU_DT , #maxDate#) &gt;= #bizMsg.slsDt#
                        AND STC.RGTN_STS_CD                      = #rgtnStsCd#
                        AND STC.EZCANCELFLAG                     = '0'
                        AND STC3.DS_ACCT_NM
                            || DECODE(STC.FIRST_LINE_ADDR,  null, '', ' ' || STC.FIRST_LINE_ADDR)
                            || DECODE(STC.SCD_LINE_ADDR,    null, '', ' ' || STC.SCD_LINE_ADDR)
                            || DECODE(STC.THIRD_LINE_ADDR,  null, '', ' ' || STC.THIRD_LINE_ADDR)
                            || DECODE(STC.FRTH_LINE_ADDR,   null, '', ' ' || STC.FRTH_LINE_ADDR)
                            || DECODE(STC.CTY_ADDR,         null, '', ' ' || STC.CTY_ADDR)
                            || DECODE(STC.ST_CD,            null, '', ' ' || STC.ST_CD)
                            || DECODE(STC.POST_CD,          null, '', ' ' || STC.POST_CD)
                                                              LIKE #bizMsg.xxComnScrColValTxt_C#
                )
                </isNotNull>
                <isEqual property="mdseSearchFlag" compareValue="Y">
                AND EXISTS(
                    SELECT
                        1
                    FROM
                        MDSE MS
                    WHERE
                            SMM.GLBL_CMPY_CD          = MS.GLBL_CMPY_CD
                        AND SMM.MDSE_CD               = MS.MDSE_CD
                        AND MS.EZCANCELFLAG           = '0'
                        <isNotNull property="bizMsg.mdseCd">
                        AND MS.MDSE_CD             LIKE #bizMsg.mdseCd#
                        </isNotNull>
                        <isNotNull property="bizMsg.mdseDescShortTxt">
                        AND MS.MDSE_DESC_SHORT_TXT LIKE #bizMsg.mdseDescShortTxt#
                        </isNotNull>
                        <isNotNull property="bizMsg.coaMdseTpCd_PS">
                        AND MS.COA_MDSE_TP_CD = #bizMsg.coaMdseTpCd_PS#
                        </isNotNull> 
                )
                </isEqual>
                <isNotNull property="bizMsg.dsContrNum">
                AND EXISTS(
                    SELECT
                        1
                    FROM
                         DS_CONTR_DTL DCD
                        ,DS_CONTR     DC
                    WHERE
                            SMM.GLBL_CMPY_CD                               =        DCD.GLBL_CMPY_CD
                        AND SMM.SVC_MACH_MSTR_PK                           =        DCD.SVC_MACH_MSTR_PK
                        AND DCD.CONTR_EFF_FROM_DT                          &lt;=    #bizMsg.slsDt#
                        AND NVL(DCD.CONTR_CLO_DT, DCD.CONTR_EFF_THRU_DT)   &gt;=    #bizMsg.slsDt#
                        AND DCD.DS_CONTR_DTL_STS_CD                        NOT IN   (#dsContrDtlStsCanc#)
                        AND DCD.EZCANCELFLAG                               =        '0'
                        AND DCD.GLBL_CMPY_CD                               =        DC.GLBL_CMPY_CD
                        AND DCD.DS_CONTR_PK                                =        DC.DS_CONTR_PK
                        AND DC.DS_CONTR_NUM                                LIKE     #bizMsg.dsContrNum#
                        AND DC.EZCANCELFLAG                                =        '0'
                )
                </isNotNull>
                <isEqual property="cpoSearchFlag" compareValue="Y">
                AND EXISTS(
                    SELECT
                        1
                    FROM
                         CPO_DTL           CD
                        <isNotNull property="bizMsg.tocNm">
                        ,TOC               TOC
                        </isNotNull>
                    WHERE
                            SMM.GLBL_CMPY_CD                =      CD.GLBL_CMPY_CD
                        AND SMM.CPO_ORD_NUM                 =      CD.CPO_ORD_NUM
                        AND SMM.CPO_DTL_LINE_NUM            =      CD.CPO_DTL_LINE_NUM
                        AND SMM.CPO_DTL_LINE_SUB_NUM        =      CD.CPO_DTL_LINE_SUB_NUM
                        <isNotNull property="bizMsg.cpoOrdNum">
                        AND CD.CPO_ORD_NUM                  LIKE   #bizMsg.cpoOrdNum#
                        </isNotNull>
                        AND CD.EZCANCELFLAG                 =      '0'
                        <isNotNull property="bizMsg.tocNm">
                        AND CD.GLBL_CMPY_CD                 =      TOC.GLBL_CMPY_CD
                        AND CD.SLS_REP_OR_SLS_TEAM_TOC_CD   =      TOC.TOC_CD
                        AND UPPER(TOC.TOC_NM)               LIKE   UPPER(#bizMsg.tocNm#)
                        AND TOC.EZCANCELFLAG                =      '0'
                        </isNotNull>
                )
                </isEqual>
                <isNotNull property="bizMsg.svcCtacTpCd_PS">
                AND EXISTS (
                    SELECT
                        *
                    FROM
                        SVC_MACH_CTAC_PSN SMCP
                    WHERE
                <!-- SVC_MACH_CTAC_PSN -->
                            SMM.GLBL_CMPY_CD          =      SMCP.GLBL_CMPY_CD
                        AND SMM.SVC_MACH_MSTR_PK      =      SMCP.SVC_MACH_MSTR_PK
                        AND SMCP.EFF_FROM_DT        &lt;=    #bizMsg.slsDt#
                        AND NVL(SMCP.EFF_THRU_DT, #maxDate#)
                                                    &gt;=    #bizMsg.slsDt#
                        AND SMCP.SVC_CTAC_TP_CD       =      #bizMsg.svcCtacTpCd_PS#
                        AND SMCP.EZCANCELFLAG         =      '0')
                </isNotNull>
                <isNotNull property="bizMsg.ctacPsnLastNm">
                AND EXISTS (
                    SELECT
                        *
                    FROM
                         SVC_MACH_CTAC_PSN SMCP
                        ,DS_CTAC_PNT       DCP
                        ,CTAC_PSN          CP
                    WHERE
                <!-- SVC_MACH_CTAC_PSN -->
                            SMM.GLBL_CMPY_CD          =      SMCP.GLBL_CMPY_CD
                        AND SMM.SVC_MACH_MSTR_PK      =      SMCP.SVC_MACH_MSTR_PK
                        AND SMCP.EZCANCELFLAG         =      '0'
                    <isNotNull property="bizMsg.svcCtacTpCd_PS">
                        AND SMCP.EFF_FROM_DT        &lt;=    #bizMsg.slsDt#
                        AND NVL(SMCP.EFF_THRU_DT, #maxDate#)
                                                    &gt;=    #bizMsg.slsDt#
                        AND SMCP.SVC_CTAC_TP_CD       =      #bizMsg.svcCtacTpCd_PS#
                    </isNotNull>
                <!-- DS_CTAC_PNT -->
                        AND SMCP.GLBL_CMPY_CD         =      DCP.GLBL_CMPY_CD
                        AND SMCP.DS_CTAC_PNT_PK       =      DCP.DS_CTAC_PNT_PK
                        AND DCP.EZCANCELFLAG          =      '0'
                <!-- CTAC_PSN -->
                        AND DCP.GLBL_CMPY_CD          =      CP.GLBL_CMPY_CD
                        AND DCP.CTAC_PSN_PK           =      CP.CTAC_PSN_PK
                        AND UPPER(CP.CTAC_PSN_LAST_NM) LIKE  UPPER(#bizMsg.ctacPsnLastNm#)
                        AND CP.EZCANCELFLAG           =      '0')
                </isNotNull>
        )
        , SELL_TO_CUST_TMP AS (
            SELECT /*+ INDEX(STC SELL_TO_CUST_I1) */
                 STC.SELL_TO_CUST_CD
                ,STC.DS_ACCT_NM
            FROM
                SELL_TO_CUST STC
            WHERE
                    STC.GLBL_CMPY_CD = #glblCmpyCd#
                AND STC.EZCANCELFLAG = '0'
                AND STC.EFF_FROM_DT                 &lt;= #bizMsg.slsDt#
                AND NVL(STC.EFF_THRU_DT, #maxDate#) &gt;= #bizMsg.slsDt#
                AND STC.RGTN_STS_CD                     = #rgtnStsCd#
                AND EXISTS(SELECT 1 FROM SVC_MACH_MSTR_TMP SMMT WHERE SMMT.OWNR_ACCT_NUM = STC.SELL_TO_CUST_CD)
            UNION
            SELECT /*+ INDEX(STC SELL_TO_CUST_I1) */
                 STC.SELL_TO_CUST_CD
                ,STC.DS_ACCT_NM
            FROM
                SELL_TO_CUST STC
            WHERE
                    STC.GLBL_CMPY_CD = #glblCmpyCd#
                AND STC.EZCANCELFLAG = '0'
                AND STC.EFF_FROM_DT                 &lt;= #bizMsg.slsDt#
                AND NVL(STC.EFF_THRU_DT, #maxDate#) &gt;= #bizMsg.slsDt#
                AND STC.RGTN_STS_CD                     = #rgtnStsCd#
                AND EXISTS(SELECT 1 FROM SVC_MACH_MSTR_TMP SMMT WHERE SMMT.BILL_TO_ACCT_NUM = STC.SELL_TO_CUST_CD)
            UNION
            SELECT /*+ INDEX(STC SELL_TO_CUST_I1) */
                 STC.SELL_TO_CUST_CD
                ,STC.DS_ACCT_NM
            FROM
                SELL_TO_CUST STC
            WHERE
                    STC.GLBL_CMPY_CD = #glblCmpyCd#
                AND STC.EZCANCELFLAG = '0'
                AND STC.EFF_FROM_DT                 &lt;= #bizMsg.slsDt#
                AND NVL(STC.EFF_THRU_DT, #maxDate#) &gt;= #bizMsg.slsDt#
                AND STC.RGTN_STS_CD                     = #rgtnStsCd#
                AND EXISTS(SELECT 1 FROM SVC_MACH_MSTR_TMP SMMT WHERE SMMT.CUR_LOC_ACCT_NUM = STC.SELL_TO_CUST_CD)
        )
<!-- END 2018/07/19 K.Kojima [QC#27326, ADD] -->
<!-- START 2018/10/01 K.Kojima [QC#28389, ADD] -->
        ,MDSE_TMP AS(
            SELECT
                 M.MDSE_CD
                ,M.MDSE_DESC_SHORT_TXT
            FROM
                MDSE M
            WHERE
                    M.GLBL_CMPY_CD = 'ADB'
                AND M.EZCANCELFLAG = '0'
                AND EXISTS(SELECT 1 FROM SVC_MACH_MSTR_TMP SMMT WHERE SMMT.MDSE_CD = M.MDSE_CD)
        )
<!-- END 2018/10/01 K.Kojima [QC#28389, ADD] -->
        SELECT
            A.SER_NUM                     SER_NUM
           ,A.SVC_SLN_SQ                  SVC_SLN_SQ
           ,A.SVC_CONFIG_MSTR_PK          SVC_CONFIG_MSTR_PK
           ,A.SVC_MACH_MSTR_PK            SVC_MACH_MSTR_PK
           ,A.ISTL_DT                     ISTL_DT
           ,A.SVC_MACH_MSTR_STS_DESC_TXT  SVC_MACH_MSTR_STS_DESC_TXT
           ,A.XX_COMN_SCR_COL_VAL_TXT_O   XX_COMN_SCR_COL_VAL_TXT_O
           ,A.OWNR_ACCT_NUM               OWNR_ACCT_NUM
           ,A.XX_COMN_SCR_COL_VAL_TXT_B   XX_COMN_SCR_COL_VAL_TXT_B
           ,A.BILL_TO_ACCT_NUM            BILL_TO_ACCT_NUM
           ,A.IND_BILL_TO_LOC_NUM         IND_BILL_TO_LOC_NUM
           ,A.XX_COMN_SCR_COL_VAL_TXT_C   XX_COMN_SCR_COL_VAL_TXT_C
           ,A.CUR_LOC_ACCT_NUM            CUR_LOC_ACCT_NUM
           ,A.IND_CUR_LOC_NUM             IND_CUR_LOC_NUM
           ,A.T_MDL_NM                    T_MDL_NM
           ,A.MDSE_CD                     MDSE_CD
           ,A.MDSE_DESC_SHORT_TXT         MDSE_DESC_SHORT_TXT
           ,A.XX_REC_HIST_CRAT_TS_A
           ,A.XX_REC_HIST_CRAT_BY_NM_A
           ,A.XX_REC_HIST_UPD_TS_A
           ,A.XX_REC_HIST_UPD_BY_NM_A
           ,A.XX_REC_HIST_TBL_NM_A
        FROM (
                SELECT
                    SMM.SER_NUM                     SER_NUM
                   ,SCM.SVC_SLN_SQ                  SVC_SLN_SQ
                   ,SCM.SVC_CONFIG_MSTR_PK          SVC_CONFIG_MSTR_PK
                   ,SMM.SVC_MACH_MSTR_PK            SVC_MACH_MSTR_PK
                   ,SMM.ISTL_DT                     ISTL_DT
                   ,SMMS.SVC_MACH_MSTR_STS_DESC_TXT SVC_MACH_MSTR_STS_DESC_TXT
                   ,STC1.DS_ACCT_NM                 XX_COMN_SCR_COL_VAL_TXT_O
                   ,SMM.OWNR_ACCT_NUM               OWNR_ACCT_NUM
                   ,STC2.DS_ACCT_NM
                    || DECODE(BTC2.FIRST_LINE_ADDR,  null, '', ' ' || BTC2.FIRST_LINE_ADDR)
                    || DECODE(BTC2.SCD_LINE_ADDR,    null, '', ' ' || BTC2.SCD_LINE_ADDR)
                    || DECODE(BTC2.THIRD_LINE_ADDR,  null, '', ' ' || BTC2.THIRD_LINE_ADDR)
                    || DECODE(BTC2.FRTH_LINE_ADDR,   null, '', ' ' || BTC2.FRTH_LINE_ADDR)
                    || DECODE(BTC2.CTY_ADDR,         null, '', ' ' || BTC2.CTY_ADDR)
                    || DECODE(BTC2.ST_CD,            null, '', ' ' || BTC2.ST_CD)
                    || DECODE(BTC2.POST_CD,          null, '', ' ' || BTC2.POST_CD)
                                                    XX_COMN_SCR_COL_VAL_TXT_B
                   ,SMM.BILL_TO_ACCT_NUM            BILL_TO_ACCT_NUM
                   ,SMM.IND_BILL_TO_LOC_NUM         IND_BILL_TO_LOC_NUM
                   ,STC3.DS_ACCT_NM
                    || DECODE(STC.FIRST_LINE_ADDR,  null, '', ' ' || STC.FIRST_LINE_ADDR)
                    || DECODE(STC.SCD_LINE_ADDR,    null, '', ' ' || STC.SCD_LINE_ADDR)
                    || DECODE(STC.THIRD_LINE_ADDR,  null, '', ' ' || STC.THIRD_LINE_ADDR)
                    || DECODE(STC.FRTH_LINE_ADDR,   null, '', ' ' || STC.FRTH_LINE_ADDR)
                    || DECODE(STC.CTY_ADDR,         null, '', ' ' || STC.CTY_ADDR)
                    || DECODE(STC.ST_CD,            null, '', ' ' || STC.ST_CD)
                    || DECODE(STC.POST_CD,          null, '', ' ' || STC.POST_CD)
                                                    XX_COMN_SCR_COL_VAL_TXT_C
                   ,SMM.CUR_LOC_ACCT_NUM            CUR_LOC_ACCT_NUM
                   ,SMM.IND_CUR_LOC_NUM             IND_CUR_LOC_NUM
                   ,MN.T_MDL_NM                     T_MDL_NM
                   ,SMM.MDSE_CD                     MDSE_CD
                   ,MS.MDSE_DESC_SHORT_TXT          MDSE_DESC_SHORT_TXT
                   ,SMM.EZINTIME    AS XX_REC_HIST_CRAT_TS_A
                   ,SMM.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM_A
                   ,SMM.EZUPTIME    AS XX_REC_HIST_UPD_TS_A
                   ,SMM.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM_A
                   ,SMM.EZTABLEID   AS XX_REC_HIST_TBL_NM_A
                FROM
<!-- START 2018/07/19 K.Kojima [QC#27326, MOD] -->
<!--                SVC_MACH_MSTR     SMM -->
                    SVC_MACH_MSTR_TMP SMM
<!-- END 2018/07/19 K.Kojima [QC#27326, MOD] -->
                   ,SVC_CONFIG_MSTR   SCM
                   ,MDL_NM            MN
<!-- START 2018/07/19 K.Kojima [QC#27326, MOD] -->
<!--               ,SELL_TO_CUST      STC1 -->
<!--               ,SELL_TO_CUST      STC2 -->
<!--               ,SELL_TO_CUST      STC3 -->
                   ,SELL_TO_CUST_TMP  STC1
                   ,SELL_TO_CUST_TMP  STC2
                   ,SELL_TO_CUST_TMP  STC3
<!-- END 2018/07/19 K.Kojima [QC#27326, MOD] -->
                   ,BILL_TO_CUST      BTC2
                   ,SHIP_TO_CUST      STC
<!-- START 2018/10/01 K.Kojima [QC#28389, MOD] -->
<!--               ,MDSE              MS -->
                   ,MDSE_TMP          MS
<!-- END 2018/10/01 K.Kojima [QC#28389, MOD] -->
                   ,SVC_MACH_MSTR_STS SMMS
                WHERE
                        SMM.GLBL_CMPY_CD          =      #glblCmpyCd#
                    <!-- SVC_CONFIG_MSTR -->
                    AND SMM.GLBL_CMPY_CD          =      SCM.GLBL_CMPY_CD(+)
                    AND SMM.SVC_CONFIG_MSTR_PK    =      SCM.SVC_CONFIG_MSTR_PK(+)
                    <!-- MDL_NM -->
                    AND SCM.GLBL_CMPY_CD          =      MN.T_GLBL_CMPY_CD(+)
                    AND SCM.MDL_ID                =      MN.T_MDL_ID(+)
                    <!-- SELL_TO_CUST(Owner) -->
                    AND SMM.OWNR_ACCT_NUM         =      STC1.SELL_TO_CUST_CD(+)
                    <!-- SELL_TO_CUST(Bill To) -->
                    AND SMM.BILL_TO_ACCT_NUM      =      STC2.SELL_TO_CUST_CD(+)
                    <!-- BILL_TO_CUST(Bill To) -->
                    AND SMM.GLBL_CMPY_CD          =      BTC2.GLBL_CMPY_CD(+)
                    AND SMM.BILL_TO_LOC_NUM       =      BTC2.BILL_TO_CUST_CD(+)
                    AND BTC2.EFF_FROM_DT(+)      &lt;=    #bizMsg.slsDt#
                    AND NVL(BTC2.EFF_THRU_DT(+), #maxDate#)
                                                &gt;=    #bizMsg.slsDt#
                    AND BTC2.RGTN_STS_CD(+)        =      #rgtnStsCd#
                    <!-- SELL_TO_CUST(Current Location) -->
                    AND SMM.CUR_LOC_ACCT_NUM      =      STC3.SELL_TO_CUST_CD(+)
                    <!-- SHIP_TO_CUST(Current Location) -->
                    AND SMM.GLBL_CMPY_CD          =      STC.GLBL_CMPY_CD(+)
                    AND SMM.CUR_LOC_NUM           =      STC.SHIP_TO_CUST_CD(+)
                    AND STC.EFF_FROM_DT(+)      &lt;=    #bizMsg.slsDt#
                    AND NVL(STC.EFF_THRU_DT(+), #maxDate#)
                                                &gt;=    #bizMsg.slsDt#
                    AND STC.RGTN_STS_CD(+)        =      #rgtnStsCd#
                    <!-- MDSE -->
<!-- START 2018/10/01 K.Kojima [QC#28389, DEL] -->
<!--                AND SMM.GLBL_CMPY_CD          =      MS.GLBL_CMPY_CD -->
<!-- END 2018/10/01 K.Kojima [QC#28389, DEL] -->
                    AND SMM.MDSE_CD               =      MS.MDSE_CD
                    <!-- SVC_MACH_MSTR_STS -->
                    AND SMM.GLBL_CMPY_CD          =      SMMS.GLBL_CMPY_CD(+)
                    AND SMM.SVC_MACH_MSTR_STS_CD  =      SMMS.SVC_MACH_MSTR_STS_CD(+)
                    AND SCM.EZCANCELFLAG(+)       =      '0'
                    AND MN.EZCANCELFLAG(+)        =      '0'
                    AND BTC2.EZCANCELFLAG(+)      =      '0'
                    AND STC.EZCANCELFLAG(+)       =      '0'
<!-- START 2018/10/01 K.Kojima [QC#28389, DEL] -->
<!--                AND MS.EZCANCELFLAG           =      '0' -->
<!-- END 2018/10/01 K.Kojima [QC#28389, DEL] -->
                    AND SMMS.EZCANCELFLAG(+)      =      '0'
           ORDER BY
                SMM.SER_NUM
               ,SMM.MDSE_CD
       ) A
       WHERE
           ROWNUM                          &lt;=   #limitCount#
    </statement>
<!-- END 2018/03/05 K.Kojima [QC#24477, ADD] -->

<!-- START 2016/05/13 T.Tomita [QC#4578, MOD] -->
    <statement id="getMachMstrInfoList" parameterClass="Map" resultMap="result.getMachMstrInfoList">
        SELECT
            A.SER_NUM                     SER_NUM
           ,A.SVC_SLN_SQ                  SVC_SLN_SQ
           ,A.SVC_SLN_NM                  SVC_SLN_NM
           ,A.SVC_CONFIG_MSTR_PK          SVC_CONFIG_MSTR_PK
           ,A.SVC_MACH_MSTR_PK            SVC_MACH_MSTR_PK
           ,A.SVC_MACH_MSTR_STS_CD        SVC_MACH_MSTR_STS_CD
           ,A.ISTL_DT                     ISTL_DT
           ,A.SVC_MACH_MSTR_STS_DESC_TXT  SVC_MACH_MSTR_STS_DESC_TXT
           ,A.SVC_LIC_CNT                 SVC_LIC_CNT
           ,A.XX_COMN_SCR_COL_VAL_TXT_O   XX_COMN_SCR_COL_VAL_TXT_O
           ,A.OWNR_ACCT_NUM               OWNR_ACCT_NUM
           ,A.XX_COMN_SCR_COL_VAL_TXT_B   XX_COMN_SCR_COL_VAL_TXT_B
           ,A.BILL_TO_ACCT_NUM            BILL_TO_ACCT_NUM
           ,A.IND_BILL_TO_LOC_NUM         IND_BILL_TO_LOC_NUM
           ,A.XX_COMN_SCR_COL_VAL_TXT_C   XX_COMN_SCR_COL_VAL_TXT_C
           ,A.CUR_LOC_ACCT_NUM            CUR_LOC_ACCT_NUM
           ,A.IND_CUR_LOC_NUM             IND_CUR_LOC_NUM
           ,A.T_MDL_NM                    T_MDL_NM
           ,A.MDSE_CD                     MDSE_CD
           <!-- START 2016/09/15 N.Arai [QC#11616, MOD] -->
           <!-- ,A.MDSE_NM                     MDSE_NM -->
           ,A.MDSE_DESC_SHORT_TXT         MDSE_DESC_SHORT_TXT
           <!-- START 2016/09/15 N.Arai [QC#11616, MOD] -->
           ,A.COA_MDSE_TP_CD              COA_MDSE_TP_CD
           ,A.CPO_ORD_NUM                 CPO_ORD_NUM
           ,A.CUST_MACH_CTRL_NUM          CUST_MACH_CTRL_NUM
           <!-- START 2016/12/13 K.Ochiai [QC#16563, MOD] -->
           ,A.CUST_ISS_PO_NUM             CUST_ISS_PO_NUM
           <!-- END 2016/12/13 K.Ochiai [QC#16563, MOD] -->
           ,A.DS_CONTR_NUM                DS_CONTR_NUM
           ,A.TOC_NM                      TOC_NM
           <!-- START 2016/11/28 K.Kojima [QC#14204, ADD] -->
           ,A.XX_REC_HIST_CRAT_TS_A
           ,A.XX_REC_HIST_CRAT_BY_NM_A
           ,A.XX_REC_HIST_UPD_TS_A
           ,A.XX_REC_HIST_UPD_BY_NM_A
           ,A.XX_REC_HIST_TBL_NM_A
           <!-- END 2016/11/28 K.Kojima [QC#14204, ADD] -->
        FROM (
            SELECT
                A1.SER_NUM                     SER_NUM
               ,A1.SVC_SLN_SQ                  SVC_SLN_SQ
               ,A1.SVC_SLN_NM                  SVC_SLN_NM
               ,A1.SVC_CONFIG_MSTR_PK          SVC_CONFIG_MSTR_PK
               ,A1.SVC_MACH_MSTR_PK            SVC_MACH_MSTR_PK
               ,A1.SVC_MACH_MSTR_STS_CD        SVC_MACH_MSTR_STS_CD
               ,A1.ISTL_DT                     ISTL_DT
               ,A1.SVC_MACH_MSTR_STS_DESC_TXT  SVC_MACH_MSTR_STS_DESC_TXT
               ,A1.SVC_LIC_CNT                 SVC_LIC_CNT
               ,A1.XX_COMN_SCR_COL_VAL_TXT_O   XX_COMN_SCR_COL_VAL_TXT_O
               ,A1.OWNR_ACCT_NUM               OWNR_ACCT_NUM
               ,A1.XX_COMN_SCR_COL_VAL_TXT_B   XX_COMN_SCR_COL_VAL_TXT_B
               ,A1.BILL_TO_ACCT_NUM            BILL_TO_ACCT_NUM
               ,A1.IND_BILL_TO_LOC_NUM         IND_BILL_TO_LOC_NUM
               ,A1.XX_COMN_SCR_COL_VAL_TXT_C   XX_COMN_SCR_COL_VAL_TXT_C
               ,A1.CUR_LOC_ACCT_NUM            CUR_LOC_ACCT_NUM
               ,A1.IND_CUR_LOC_NUM             IND_CUR_LOC_NUM
               ,A1.T_MDL_NM                    T_MDL_NM
               ,A1.MDSE_CD                     MDSE_CD
               <!-- START 2016/09/15 N.Arai [QC#11616, MOD] -->
               <!-- ,A1.MDSE_NM                     MDSE_NM  -->
               ,A1.MDSE_DESC_SHORT_TXT         MDSE_DESC_SHORT_TXT
               <!-- END 2016/09/15 N.Arai [QC#11616, MOD] -->
               ,A1.COA_MDSE_TP_CD              COA_MDSE_TP_CD
               ,A1.CPO_ORD_NUM                 CPO_ORD_NUM
               ,A1.CUST_MACH_CTRL_NUM          CUST_MACH_CTRL_NUM
               <!-- START 2016/12/13 K.Ochiai [QC#16563, MOD] -->
               ,A1.CUST_ISS_PO_NUM             CUST_ISS_PO_NUM
               <!-- END 2016/12/13 K.Ochiai [QC#16563, MOD] -->
               ,A1.DS_CONTR_NUM                DS_CONTR_NUM
               ,A1.TOC_NM                      TOC_NM
               <!-- START 2016/11/28 K.Kojima [QC#14204, ADD] -->
               ,A1.XX_REC_HIST_CRAT_TS_A
               ,A1.XX_REC_HIST_CRAT_BY_NM_A
               ,A1.XX_REC_HIST_UPD_TS_A
               ,A1.XX_REC_HIST_UPD_BY_NM_A
               ,A1.XX_REC_HIST_TBL_NM_A
               <!-- END 2016/11/28 K.Kojima [QC#14204, ADD] -->
            FROM (
                SELECT
                    SMM.SER_NUM                     SER_NUM
                   ,SCM.SVC_SLN_SQ                  SVC_SLN_SQ
                   ,SCM.SVC_SLN_NM                  SVC_SLN_NM
                   ,SCM.SVC_CONFIG_MSTR_PK          SVC_CONFIG_MSTR_PK
                   ,SMM.SVC_MACH_MSTR_PK            SVC_MACH_MSTR_PK
                   ,SMM.SVC_MACH_MSTR_STS_CD        SVC_MACH_MSTR_STS_CD
                   ,SMM.ISTL_DT                     ISTL_DT
                   ,SMMS.SVC_MACH_MSTR_STS_DESC_TXT SVC_MACH_MSTR_STS_DESC_TXT
                   ,SMM.SVC_LIC_CNT                 SVC_LIC_CNT
                   ,STC1.DS_ACCT_NM                 XX_COMN_SCR_COL_VAL_TXT_O
                   ,SMM.OWNR_ACCT_NUM               OWNR_ACCT_NUM
                   ,STC2.DS_ACCT_NM
                    || DECODE(BTC2.FIRST_LINE_ADDR,  null, '', ' ' || BTC2.FIRST_LINE_ADDR)
                    || DECODE(BTC2.SCD_LINE_ADDR,    null, '', ' ' || BTC2.SCD_LINE_ADDR)
                    || DECODE(BTC2.THIRD_LINE_ADDR,  null, '', ' ' || BTC2.THIRD_LINE_ADDR)
                    || DECODE(BTC2.FRTH_LINE_ADDR,   null, '', ' ' || BTC2.FRTH_LINE_ADDR)
                    || DECODE(BTC2.CTY_ADDR,         null, '', ' ' || BTC2.CTY_ADDR)
                    || DECODE(BTC2.ST_CD,            null, '', ' ' || BTC2.ST_CD)
                    || DECODE(BTC2.POST_CD,          null, '', ' ' || BTC2.POST_CD)
                                                    XX_COMN_SCR_COL_VAL_TXT_B
                   ,SMM.BILL_TO_ACCT_NUM            BILL_TO_ACCT_NUM
                   ,SMM.IND_BILL_TO_LOC_NUM         IND_BILL_TO_LOC_NUM
                   ,STC3.DS_ACCT_NM
                    || DECODE(STC.FIRST_LINE_ADDR,  null, '', ' ' || STC.FIRST_LINE_ADDR)
                    || DECODE(STC.SCD_LINE_ADDR,    null, '', ' ' || STC.SCD_LINE_ADDR)
                    || DECODE(STC.THIRD_LINE_ADDR,  null, '', ' ' || STC.THIRD_LINE_ADDR)
                    || DECODE(STC.FRTH_LINE_ADDR,   null, '', ' ' || STC.FRTH_LINE_ADDR)
                    || DECODE(STC.CTY_ADDR,         null, '', ' ' || STC.CTY_ADDR)
                    || DECODE(STC.ST_CD,            null, '', ' ' || STC.ST_CD)
                    || DECODE(STC.POST_CD,          null, '', ' ' || STC.POST_CD)
                                                    XX_COMN_SCR_COL_VAL_TXT_C
                   ,SMM.CUR_LOC_ACCT_NUM            CUR_LOC_ACCT_NUM
                   ,SMM.IND_CUR_LOC_NUM             IND_CUR_LOC_NUM
                   ,MN.T_MDL_NM                     T_MDL_NM
                   ,SMM.MDSE_CD                     MDSE_CD
                   <!-- START 2016/09/15 N.Arai [QC#11616, MOD] -->
                   <!--,MS.MDSE_NM                      MDSE_NM -->
                   ,MS.MDSE_DESC_SHORT_TXT          MDSE_DESC_SHORT_TXT
                    <!-- END 2016/09/15 N.Arai [QC#11616, MOD] -->
                   ,MS.COA_MDSE_TP_CD               COA_MDSE_TP_CD
                   ,SMM.CPO_ORD_NUM                 CPO_ORD_NUM
                   ,SMM.CUST_MACH_CTRL_NUM          CUST_MACH_CTRL_NUM
                   <!-- START 2016/12/13 K.Ochiai [QC#16563, MOD] -->
                   ,SMM.CUST_ISS_PO_NUM             CUST_ISS_PO_NUM
                   <!-- END 2016/12/13 K.Ochiai [QC#16563, MOD] -->
                   ,DC.DS_CONTR_NUM                 DS_CONTR_NUM
                   ,TOC.TOC_NM                      TOC_NM
                   <!-- START 2016/07/14 K.Yamada [QC#11368, MOD] -->
                   <!-- ,ROW_NUMBER() OVER(PARTITION BY SMM.SVC_MACH_MSTR_PK ORDER BY DCD.CONTR_EFF_THRU_DT DESC)
                                                    ROW_NUM
                   -->
                   ,RANK() OVER(
                       PARTITION BY DCD.SVC_MACH_MSTR_PK
                       ORDER BY 
                           NVL(DCD.CONTR_CLO_DT, DCD.CONTR_EFF_THRU_DT) DESC
                           ,DECODE(DC.DS_CONTR_CATG_CD, #warranty#, 2, 1)
                   ) RANK
                    <!-- END 2016/07/14 K.Yamada [QC#11368, MOD] -->
                   <!-- START 2016/11/28 K.Kojima [QC#14204, ADD] -->
                   ,SMM.EZINTIME    AS XX_REC_HIST_CRAT_TS_A
                   ,SMM.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM_A
                   ,SMM.EZUPTIME    AS XX_REC_HIST_UPD_TS_A
                   ,SMM.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM_A
                   ,SMM.EZTABLEID   AS XX_REC_HIST_TBL_NM_A
                   <!-- END 2016/11/28 K.Kojima [QC#14204, ADD] -->
                FROM
                    SVC_MACH_MSTR     SMM
                   ,SVC_CONFIG_MSTR   SCM
                   ,MDL_NM            MN
                   ,SELL_TO_CUST      STC1
                   ,SELL_TO_CUST      STC2
                   ,SELL_TO_CUST      STC3
                   ,BILL_TO_CUST      BTC2
                   ,SHIP_TO_CUST      STC
                   ,MDSE              MS
                   ,DS_CONTR_DTL      DCD
                   ,DS_CONTR          DC
                   ,CPO_DTL           CD
                   ,TOC               TOC
                   ,SVC_MACH_MSTR_STS SMMS
                WHERE
                        SMM.GLBL_CMPY_CD          =      #glblCmpyCd#
                    <!-- SVC_MACH_MSTR -->
                    <isNotNull property="bizMsg.serNum">
                    AND SMM.SER_NUM              LIKE    #bizMsg.serNum#
                    </isNotNull>
                    <!-- START 2016/04/20 M.Gotou [QC#6749, MOD] -->
                    <isNotNull property="bizMsg.xxScrItem30Txt_03">
                    AND SMM.SVC_MACH_MSTR_PK     LIKE    #bizMsg.xxScrItem30Txt_03#
                    </isNotNull>
                    <isNotNull property="bizMsg.xxChkBox">
                    AND SMM.SVC_MACH_MSTR_STS_CD &lt;&gt;     #svcMachMstrSts#
                    </isNotNull>
                    <isNotNull property="bizMsg.istlDt_FR">
                    AND SMM.ISTL_DT              &gt;=    #bizMsg.istlDt_FR#
                    </isNotNull>
                    <isNotNull property="bizMsg.istlDt_TO">
                    AND SMM.ISTL_DT              &lt;=    #bizMsg.istlDt_TO#
                    </isNotNull>
                    <isNotNull property="bizMsg.svcMachMstrStsCd_PS">
                    AND SMM.SVC_MACH_MSTR_STS_CD  =      #bizMsg.svcMachMstrStsCd_PS#
                    </isNotNull>
                    <isNotNull property="bizMsg.ownrAcctNum">
                    AND SMM.OWNR_ACCT_NUM        LIKE    #bizMsg.ownrAcctNum#
                    </isNotNull>
                    <isNotNull property="bizMsg.billToAcctNum">
                    AND SMM.BILL_TO_ACCT_NUM     LIKE    #bizMsg.billToAcctNum#
                    </isNotNull>
                    <isNotNull property="bizMsg.indBillToLocNum">
                    AND SMM.IND_BILL_TO_LOC_NUM  LIKE    #bizMsg.indBillToLocNum#
                    </isNotNull>
                    <isNotNull property="bizMsg.curLocAcctNum">
                    AND SMM.CUR_LOC_ACCT_NUM     LIKE    #bizMsg.curLocAcctNum#
                    </isNotNull>
                    <isNotNull property="bizMsg.indCurLocNum">
                    AND SMM.IND_CUR_LOC_NUM      LIKE    #bizMsg.indCurLocNum#
                    </isNotNull>
                    <isNotNull property="bizMsg.mdseCd">
                    AND SMM.MDSE_CD              LIKE    #bizMsg.mdseCd#
                    </isNotNull>
                    <isNotNull property="bizMsg.cpoOrdNum">
                    AND SMM.CPO_ORD_NUM          LIKE    #bizMsg.cpoOrdNum#
                    </isNotNull>
                    <isNotNull property="bizMsg.custMachCtrlNum">
                    AND SMM.CUST_MACH_CTRL_NUM   LIKE    #bizMsg.custMachCtrlNum#
                    </isNotNull>
                    <isNotNull property="bizMsg.xxScrItem30Txt_04">
                    AND SMM.SVC_LIC_CNT          LIKE    #bizMsg.xxScrItem30Txt_04#
                    </isNotNull>
                    <!-- START 2016/12/13 K.Ochiai [QC#16563, MOD] -->
                    <isNotNull property="bizMsg.custIssPoNum">
                    <!-- START 2019/03/13 S.Kitamura [QC#30747, MOD]  -->
                    <!-- AND SMM.CUST_ISS_PO_NUM      LIKE    #bizMsg.custIssPoNum# -->
                    AND UPPER(SMM.CUST_ISS_PO_NUM) LIKE  #bizMsg.custIssPoNum#
                    <!-- END 2019/03/13 S.Kitamura [QC#30747, MOD]  -->
                    </isNotNull>
                    <!-- END 2016/12/13 K.Ochiai [QC#16563, MOD] -->
                    <!-- SVC_CONFIG_MSTR -->
                    AND SMM.GLBL_CMPY_CD          =      SCM.GLBL_CMPY_CD(+)
                    AND SMM.SVC_CONFIG_MSTR_PK    =      SCM.SVC_CONFIG_MSTR_PK(+)
                    <isNotNull property="bizMsg.xxScrItem30Txt_02">
                    AND SCM.SVC_CONFIG_MSTR_PK   LIKE    #bizMsg.xxScrItem30Txt_02#
                    </isNotNull>
                    <isNotNull property="bizMsg.xxScrItem30Txt_01">
                    AND SCM.SVC_SLN_SQ           LIKE    #bizMsg.xxScrItem30Txt_01#
                    </isNotNull>
                    <!-- END 2016/04/20 M.Gotou [QC#6749, MOD] -->
                    <isNotNull property="bizMsg.svcSlnNm">
                    AND SCM.SVC_SLN_NM           LIKE    #bizMsg.svcSlnNm#
                    </isNotNull>
                    <!-- MDL_NM -->
                    AND SCM.GLBL_CMPY_CD          =      MN.T_GLBL_CMPY_CD(+)
                    AND SCM.MDL_ID                =      MN.T_MDL_ID(+)
                    <isNotNull property="bizMsg.t_MdlNm">
                    AND MN.T_MDL_NM              LIKE    #bizMsg.t_MdlNm#
                    </isNotNull>
                    <!-- SELL_TO_CUST(Owner) -->
                    AND SMM.GLBL_CMPY_CD          =      STC1.GLBL_CMPY_CD(+)
                    AND SMM.OWNR_ACCT_NUM         =      STC1.SELL_TO_CUST_CD(+)
                    AND STC1.EFF_FROM_DT(+)      &lt;=    #bizMsg.slsDt#
                    AND NVL(STC1.EFF_THRU_DT(+), #maxDate#)
                                                &gt;=    #bizMsg.slsDt#
                    AND STC1.RGTN_STS_CD(+)        =      #rgtnStsCd#
                    <isNotNull property="bizMsg.xxComnScrColValTxt_O">
                    AND STC1.DS_ACCT_NM           LIKE   #bizMsg.xxComnScrColValTxt_O#
                     </isNotNull>
                    <!-- SELL_TO_CUST(Bill To) -->
                    AND SMM.GLBL_CMPY_CD          =      STC2.GLBL_CMPY_CD(+)
                    AND SMM.BILL_TO_ACCT_NUM      =      STC2.SELL_TO_CUST_CD(+)
                    AND STC2.EFF_FROM_DT(+)      &lt;=    #bizMsg.slsDt#
                    AND NVL(STC2.EFF_THRU_DT(+), #maxDate#)
                                                &gt;=    #bizMsg.slsDt#
                    AND STC2.RGTN_STS_CD(+)        =      #rgtnStsCd#
                    <!-- BILL_TO_CUST(Bill To) -->
                    AND SMM.GLBL_CMPY_CD          =      BTC2.GLBL_CMPY_CD(+)
                    AND SMM.BILL_TO_LOC_NUM       =      BTC2.BILL_TO_CUST_CD(+)
                    AND BTC2.EFF_FROM_DT(+)      &lt;=    #bizMsg.slsDt#
                    AND NVL(BTC2.EFF_THRU_DT(+), #maxDate#)
                                                &gt;=    #bizMsg.slsDt#
                    AND BTC2.RGTN_STS_CD(+)        =      #rgtnStsCd#
                    <isNotNull property="bizMsg.xxComnScrColValTxt_B">
<!-- START 2018/06/08 T.Murai  [QC#25167, MOD] -->
                    AND STC2.DS_ACCT_NM
<!--                 || ' ' || BTC2.FIRST_LINE_ADDR
                     || ' ' || BTC2.SCD_LINE_ADDR
                     || ' ' || BTC2.THIRD_LINE_ADDR
                     || ' ' || BTC2.FRTH_LINE_ADDR
                     || ' ' || BTC2.CTY_ADDR
                     || ' ' || BTC2.ST_CD
                     || ' ' || BTC2.POST_CD-->
                    || DECODE(BTC2.FIRST_LINE_ADDR,  null, '', ' ' || BTC2.FIRST_LINE_ADDR)
                    || DECODE(BTC2.SCD_LINE_ADDR,    null, '', ' ' || BTC2.SCD_LINE_ADDR)
                    || DECODE(BTC2.THIRD_LINE_ADDR,  null, '', ' ' || BTC2.THIRD_LINE_ADDR)
                    || DECODE(BTC2.FRTH_LINE_ADDR,   null, '', ' ' || BTC2.FRTH_LINE_ADDR)
                    || DECODE(BTC2.CTY_ADDR,         null, '', ' ' || BTC2.CTY_ADDR)
                    || DECODE(BTC2.ST_CD,            null, '', ' ' || BTC2.ST_CD)
                    || DECODE(BTC2.POST_CD,          null, '', ' ' || BTC2.POST_CD)
<!-- END 2018/06/08 T.Murai  [QC#25167, MOD] -->
                                                  LIKE   #bizMsg.xxComnScrColValTxt_B#
                     </isNotNull>
                    <!-- SELL_TO_CUST(Current Location) -->
                    AND SMM.GLBL_CMPY_CD          =      STC3.GLBL_CMPY_CD(+)
                    AND SMM.CUR_LOC_ACCT_NUM      =      STC3.SELL_TO_CUST_CD(+)
                    AND STC3.EFF_FROM_DT(+)      &lt;=    #bizMsg.slsDt#
                    AND NVL(STC3.EFF_THRU_DT(+), #maxDate#)
                                                &gt;=    #bizMsg.slsDt#
                    AND STC3.RGTN_STS_CD(+)        =      #rgtnStsCd#
                    <!-- SHIP_TO_CUST(Current Location) -->
                    AND SMM.GLBL_CMPY_CD          =      STC.GLBL_CMPY_CD(+)
                    AND SMM.CUR_LOC_NUM           =      STC.SHIP_TO_CUST_CD(+)
                    AND STC.EFF_FROM_DT(+)      &lt;=    #bizMsg.slsDt#
                    AND NVL(STC.EFF_THRU_DT(+), #maxDate#)
                                                &gt;=    #bizMsg.slsDt#
                    AND STC.RGTN_STS_CD(+)        =      #rgtnStsCd#
                    <isNotNull property="bizMsg.xxComnScrColValTxt_C">
                    AND STC3.DS_ACCT_NM
<!-- START 2018/06/08 T.Murai  [QC#25167, MOD] -->
<!--                 || ' ' || STC.FIRST_LINE_ADDR
                     || ' ' || STC.SCD_LINE_ADDR
                     || ' ' || STC.THIRD_LINE_ADDR
                     || ' ' || STC.FRTH_LINE_ADDR
                     || ' ' || STC.CTY_ADDR
                     || ' ' || STC.ST_CD
                     || ' ' || STC.POST_CD -->
                    || DECODE(STC.FIRST_LINE_ADDR,  null, '', ' ' || STC.FIRST_LINE_ADDR)
                    || DECODE(STC.SCD_LINE_ADDR,    null, '', ' ' || STC.SCD_LINE_ADDR)
                    || DECODE(STC.THIRD_LINE_ADDR,  null, '', ' ' || STC.THIRD_LINE_ADDR)
                    || DECODE(STC.FRTH_LINE_ADDR,   null, '', ' ' || STC.FRTH_LINE_ADDR)
                    || DECODE(STC.CTY_ADDR,         null, '', ' ' || STC.CTY_ADDR)
                    || DECODE(STC.ST_CD,            null, '', ' ' || STC.ST_CD)
                    || DECODE(STC.POST_CD,          null, '', ' ' || STC.POST_CD)
<!-- END 2018/06/08 T.Murai  [QC#25167, MOD] -->
                                                  LIKE   #bizMsg.xxComnScrColValTxt_C#
                     </isNotNull>
                    <!-- MDSE -->
                    AND SMM.GLBL_CMPY_CD          =      MS.GLBL_CMPY_CD
                    AND SMM.MDSE_CD               =      MS.MDSE_CD
                    <isNotNull property="bizMsg.mdseCd">
                    AND MS.MDSE_CD               LIKE    #bizMsg.mdseCd#
                    </isNotNull>
                    <!-- START 2016/09/15 N.Arai [QC#11616, MOD] -->
                    <!-- <isNotNull property="bizMsg.mdseNm">
                    AND MS.MDSE_NM               LIKE    #bizMsg.mdseNm#
                    </isNotNull>                                 -->
                    <isNotNull property="bizMsg.mdseDescShortTxt">
                    AND MS.MDSE_DESC_SHORT_TXT   LIKE    #bizMsg.mdseDescShortTxt#
                    </isNotNull>
                    <!-- END 2016/09/15 N.Arai [QC#11616, MOD] -->
                    <isNotNull property="bizMsg.coaMdseTpCd_PS">
                    AND MS.COA_MDSE_TP_CD         =      #bizMsg.coaMdseTpCd_PS#
                     </isNotNull> 
                    <!-- DS_CONTR_DTL -->
                    AND SMM.GLBL_CMPY_CD          =      DCD.GLBL_CMPY_CD(+)
                    AND SMM.SVC_MACH_MSTR_PK      =      DCD.SVC_MACH_MSTR_PK(+)
                    AND DCD.CONTR_EFF_FROM_DT(+)                   &lt;=   #bizMsg.slsDt#
                    <!-- START 2016/07/14 K.Yamada [QC#11368, MOD] -->
                    AND NVL(DCD.CONTR_CLO_DT(+),      DCD.CONTR_EFF_THRU_DT(+))   &gt;=   #bizMsg.slsDt#
                    AND DCD.DS_CONTR_DTL_STS_CD(+)                 NOT IN (#dsContrDtlStsCanc#)
                    <!-- END 2016/07/14 K.Yamada [QC#11368, MOD] -->
                    <!-- DS_CONTR -->
                    AND DCD.GLBL_CMPY_CD          =      DC.GLBL_CMPY_CD(+)
                    AND DCD.DS_CONTR_PK           =      DC.DS_CONTR_PK(+)
                    <isNotNull property="bizMsg.dsContrNum">
                    AND DC.DS_CONTR_NUM          LIKE    #bizMsg.dsContrNum#
                    </isNotNull>
                    <!-- CPO_DTL -->
                    AND SMM.GLBL_CMPY_CD          =      CD.GLBL_CMPY_CD(+)
                    AND SMM.CPO_ORD_NUM           =      CD.CPO_ORD_NUM(+)
                    AND SMM.CPO_DTL_LINE_NUM      =      CD.CPO_DTL_LINE_NUM(+)
                    AND SMM.CPO_DTL_LINE_SUB_NUM  =      CD.CPO_DTL_LINE_SUB_NUM(+)
                    <isNotNull property="bizMsg.cpoOrdNum">
                    AND CD.CPO_ORD_NUM           LIKE    #bizMsg.cpoOrdNum#
                    </isNotNull>
                    <!-- TOC -->
                    AND CD.GLBL_CMPY_CD           =      TOC.GLBL_CMPY_CD(+)
                    AND CD.SLS_REP_OR_SLS_TEAM_TOC_CD
                                                  =      TOC.TOC_CD(+)
                    <isNotNull property="bizMsg.tocNm">
                    AND UPPER(TOC.TOC_NM)         LIKE   UPPER(#bizMsg.tocNm#)
                    </isNotNull>
                    <!-- SVC_MACH_MSTR_STS -->
                    AND SMM.GLBL_CMPY_CD          =      SMMS.GLBL_CMPY_CD(+)
                    AND SMM.SVC_MACH_MSTR_STS_CD  =      SMMS.SVC_MACH_MSTR_STS_CD(+)
                    AND SMM.EZCANCELFLAG          =      '0'
                    AND SCM.EZCANCELFLAG(+)       =      '0'
                    AND MN.EZCANCELFLAG(+)        =      '0'
                    AND STC1.EZCANCELFLAG(+)      =      '0'
                    AND STC2.EZCANCELFLAG(+)      =      '0'
                    AND STC3.EZCANCELFLAG(+)      =      '0'
                    AND BTC2.EZCANCELFLAG(+)      =      '0'
                    AND STC.EZCANCELFLAG(+)       =      '0'
                    AND MS.EZCANCELFLAG           =      '0'
                    AND DCD.EZCANCELFLAG(+)       =      '0'
                    AND DC.EZCANCELFLAG(+)        =      '0'
                    AND CD.EZCANCELFLAG(+)        =      '0'
                    AND TOC.EZCANCELFLAG(+)       =      '0'
                    AND SMMS.EZCANCELFLAG(+)      =      '0'
                    <isNotNull property="bizMsg.svcCtacTpCd_PS">
                    AND EXISTS (
                        SELECT
                            *
                        FROM
                            SVC_MACH_CTAC_PSN SMCP
                        WHERE
                    <!-- SVC_MACH_CTAC_PSN -->
                                SMM.GLBL_CMPY_CD          =      SMCP.GLBL_CMPY_CD
                            AND SMM.SVC_MACH_MSTR_PK      =      SMCP.SVC_MACH_MSTR_PK
                            AND SMCP.EFF_FROM_DT        &lt;=    #bizMsg.slsDt#
                            AND NVL(SMCP.EFF_THRU_DT, #maxDate#)
                                                        &gt;=    #bizMsg.slsDt#
                            AND SMCP.SVC_CTAC_TP_CD       =      #bizMsg.svcCtacTpCd_PS#
                            AND SMCP.EZCANCELFLAG         =      '0')
                    </isNotNull>
                    <isNotNull property="bizMsg.ctacPsnLastNm">
                    AND EXISTS (
                        SELECT
                            *
                        FROM
                             SVC_MACH_CTAC_PSN SMCP
                            ,DS_CTAC_PNT       DCP
                            ,CTAC_PSN          CP
                        WHERE
                    <!-- SVC_MACH_CTAC_PSN -->
                                SMM.GLBL_CMPY_CD          =      SMCP.GLBL_CMPY_CD
                            AND SMM.SVC_MACH_MSTR_PK      =      SMCP.SVC_MACH_MSTR_PK
                            AND SMCP.EZCANCELFLAG         =      '0'
                        <isNotNull property="bizMsg.svcCtacTpCd_PS">
                            AND SMCP.EFF_FROM_DT        &lt;=    #bizMsg.slsDt#
                            AND NVL(SMCP.EFF_THRU_DT, #maxDate#)
                                                        &gt;=    #bizMsg.slsDt#
                            AND SMCP.SVC_CTAC_TP_CD       =      #bizMsg.svcCtacTpCd_PS#
                        </isNotNull>
                    <!-- DS_CTAC_PNT -->
                            AND SMCP.GLBL_CMPY_CD         =      DCP.GLBL_CMPY_CD
                            AND SMCP.DS_CTAC_PNT_PK       =      DCP.DS_CTAC_PNT_PK
                            AND DCP.EZCANCELFLAG          =      '0'
                    <!-- CTAC_PSN -->
                            AND DCP.GLBL_CMPY_CD          =      CP.GLBL_CMPY_CD
                            AND DCP.CTAC_PSN_PK           =      CP.CTAC_PSN_PK
                            AND UPPER(CP.CTAC_PSN_LAST_NM) LIKE  UPPER(#bizMsg.ctacPsnLastNm#)
                            AND CP.EZCANCELFLAG           =      '0')
                    </isNotNull>
                ORDER BY
                    SMM.SVC_MACH_MSTR_PK
                   ,RANK
           ) A1
           WHERE
               RANK = 1
           ORDER BY
                A1.SER_NUM
               ,A1.MDSE_CD
       ) A
       WHERE
           ROWNUM                          &lt;=   #limitCount#
    </statement>

    <resultMap id="result.getMachMstrInfoList" class="NSAL0020_ASMsg">
        <result property="serNum_A0"                   column="SER_NUM"                         javaType="EZDSStringItem"/>
        <result property="mdseCd_A0"                   column="MDSE_CD"                         javaType="EZDSStringItem"/>
        <result property="mdseDescShortTxt_A0"         column="MDSE_DESC_SHORT_TXT"             javaType="EZDSStringItem"/>
        <result property="svcMachMstrStsDescTxt_A0"    column="SVC_MACH_MSTR_STS_DESC_TXT"      javaType="EZDSStringItem"/>
        <result property="t_MdlNm_A0"                  column="T_MDL_NM"                        javaType="EZDSStringItem"/>
        <result property="svcConfigMstrPk_A0"          column="SVC_CONFIG_MSTR_PK"              javaType="EZDSBigDecimalItem"/>
        <result property="svcSlnSq_A0"                 column="SVC_SLN_SQ"                      javaType="EZDSBigDecimalItem"/>
        <result property="istlDt_A0"                   column="ISTL_DT"                         javaType="EZDSStringItem"/>
        <result property="svcMachMstrPk_A0"            column="SVC_MACH_MSTR_PK"                javaType="EZDSBigDecimalItem"/>
        <result property="xxComnScrColValTxt_AO"       column="XX_COMN_SCR_COL_VAL_TXT_O"       javaType="EZDSStringItem"/>
        <result property="ownrAcctNum_A0"              column="OWNR_ACCT_NUM"                   javaType="EZDSStringItem"/>
        <result property="xxComnScrColValTxt_AC"       column="XX_COMN_SCR_COL_VAL_TXT_C"       javaType="EZDSStringItem"/>
        <result property="curLocAcctNum_A0"            column="CUR_LOC_ACCT_NUM"                javaType="EZDSStringItem"/>
        <result property="indCurLocNum_A0"             column="IND_CUR_LOC_NUM"                 javaType="EZDSStringItem"/>
        <result property="xxComnScrColValTxt_AB"       column="XX_COMN_SCR_COL_VAL_TXT_B"       javaType="EZDSStringItem"/>
        <result property="billToAcctNum_A0"            column="BILL_TO_ACCT_NUM"                javaType="EZDSStringItem"/>
        <result property="indBillToLocNum_A0"          column="IND_BILL_TO_LOC_NUM"             javaType="EZDSStringItem"/>
        <!-- START 2016/11/28 K.Kojima [QC#14204, ADD] -->
        <result property="xxRecHistCratTs_A"           column="XX_REC_HIST_CRAT_TS_A"           javaType="EZDSStringItem"/>
        <result property="xxRecHistCratByNm_A"         column="XX_REC_HIST_CRAT_BY_NM_A"        javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdTs_A"            column="XX_REC_HIST_UPD_TS_A"            javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdByNm_A"          column="XX_REC_HIST_UPD_BY_NM_A"         javaType="EZDSStringItem"/>
        <result property="xxRecHistTblNm_A"            column="XX_REC_HIST_TBL_NM_A"            javaType="EZDSStringItem"/>
        <!-- END 2016/11/28 K.Kojima [QC#14204, ADD] -->
    </resultMap>
<!-- END 2016/05/13 T.Tomita [QC#4578, MOD] -->
</sqlMap>
