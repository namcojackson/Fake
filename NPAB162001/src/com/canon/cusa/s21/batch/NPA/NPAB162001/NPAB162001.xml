<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NPAB162001">

    <statement id="getEdiPrcList" parameterClass="Map" resultClass="Map">
        SELECT
            EPH.TRANSACTION_ID
           ,EPH.SEGMENT_ID
           ,EPH.EDI_PRC_CAT_CCY_CD
           ,EPH.EDI_PRC_CAT_ACT_TP_TXT
           ,EPH.EDI_SHIP_FROM_CUST_NM
           ,EPH.EDI_PRC_CAT_BIG_DEAL_NUM
           ,EPD.EDI_PRC_CAT_VND_PROD_NUM
           ,EPD.EDI_PRC_CAT_UOM_TXT
           ,EPD.EDI_PRC_CAT_EFF_FROM_DT
           ,EPD.EDI_PRC_CAT_EFF_THRU_DT
           ,EPD.EDI_PRC_CAT_UNIT_PRC_TXT
           ,ASL.MDSE_CD
           ,ASL.VND_UOM_CD
           ,ASL.SPLY_ITEM_NUM
           ,ASL.VND_CD
           ,ASL.UNIT_PRC_AMT
           ,ASL.BASE_ORD_QTY
           ,ASL.VND_UOM_QTY
           ,ASL.EFF_FROM_DT
           ,ASL.EFF_THRU_DT
           ,ASL.VND_MIN_ORD_QTY
           ,ASL.VND_INCR_ORD_QTY
           ,ASL.ASL_QLFY_REF_CD
           ,DCC.DS_COND_CONST_VAL_TXT_01 DCC_VND_UOM_CD
        FROM
            NPAI2110_01   EPH
           ,NPAI2110_02   EPD
           ,DS_COND_CONST DCC
           ,(
                SELECT
                    AD.MDSE_CD
                   ,AD.VND_UOM_CD
                   ,AD.SPLY_ITEM_NUM
                   ,AD.VND_CD
                   ,AD.UNIT_PRC_AMT
                   ,AD.BASE_ORD_QTY
                   ,AD.VND_UOM_QTY
                   ,AD.EFF_FROM_DT
                   ,AD.EFF_THRU_DT
                   ,AD.VND_MIN_ORD_QTY
                   ,AD.VND_INCR_ORD_QTY
                   ,AQR.ASL_QLFY_REF_CD
                FROM
                    ASL_HDR       AH
                   ,ASL_DTL       AD
                   ,ASL_QLFY_RELN AQR
                WHERE
                    AH.GLBL_CMPY_CD                             = #glblCmpyCd#
                AND AH.GLBL_CMPY_CD                             = AD.GLBL_CMPY_CD
                AND AH.PRNT_VND_CD                              = #prntVndCd#
                AND AH.ASL_HDR_PK                               = AD.ASL_HDR_PK
                AND AD.EFF_FROM_DT                          &lt;= #slsDt#
                AND NVL(AD.EFF_THRU_DT, #effThruDtDefault#) &gt;= #slsDt#
                AND AD.VND_CD                                   = #vndCd#
                AND AH.GLBL_CMPY_CD                             = AQR.GLBL_CMPY_CD (+)
                AND AH.ASL_HDR_PK                               = AQR.ASL_HDR_PK (+)
                AND AQR.ASL_QLFY_TP_CD (+)                      = #aslQlfyTpCd02#
                AND AH.EZCANCELFLAG                             = '0'
                AND AD.EZCANCELFLAG                             = '0'
                AND AQR.EZCANCELFLAG (+)                        = '0'
            ) ASL
        WHERE
            1=1
        AND EPH.TRANSACTION_ID            = #transactionId#
        AND EPH.TRANSACTION_ID            = EPD.TRANSACTION_ID
        AND EPH.SEGMENT_ID                = EPD.SEGMENT_ID
        AND DCC.GLBL_CMPY_CD (+)          = #glblCmpyCd#
        AND DCC.DS_COND_CONST_GRP_ID (+)  = #grpIdVndUomXref#
        AND EPD.EDI_PRC_CAT_UOM_TXT       = DCC.DS_COND_CONST_CD (+)
        AND EPD.EDI_PRC_CAT_VND_PROD_NUM  = ASL.SPLY_ITEM_NUM (+)
        AND EPH.EZCANCELFLAG              = '0'
        AND EPD.EZCANCELFLAG              = '0'
        AND DCC.EZCANCELFLAG (+)          = '0'
        ORDER BY
            EPH.TRANSACTION_ID
           ,EPH.SEGMENT_ID
           ,EPH.EDI_PRC_CAT_BIG_DEAL_NUM
           ,EPD.EDI_PRC_CAT_VND_PROD_NUM
    </statement>

    <statement id="getAzertyVndCd" parameterClass="Map" resultClass="String">
        SELECT
            RAV.RCV_ASN_VND_CD
        FROM
            RCV_ASN_VND RAV
        WHERE
            RAV.GLBL_CMPY_CD  = #glblCmpyCd#
        AND RAV.VND_SYS_TP_CD = #vndSysTpCdA#
        AND RAV.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getAzertyPrntVndCd" parameterClass="Map" resultClass="String">
        SELECT
            PV.PRNT_VND_CD
        FROM
            VND        V
           ,PRNT_VND   PV
        WHERE
            V.GLBL_CMPY_CD  = #glblCmpyCd#
        AND V.VND_CD        = #vndCd#
        AND V.GLBL_CMPY_CD  = PV.GLBL_CMPY_CD
        AND V.PRNT_VND_PK   = PV.PRNT_VND_PK
        AND V.EZCANCELFLAG  = '0'
        AND PV.EZCANCELFLAG = '0'
    </statement>

</sqlMap>
