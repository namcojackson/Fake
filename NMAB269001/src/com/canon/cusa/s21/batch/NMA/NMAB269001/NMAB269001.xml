<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB269001">
    <statement id="getDunsInfoWrk" parameterClass="Map" resultClass="Map">
        SELECT
              DRIW.UPLD_CSV_RQST_PK         AS UPLD_CSV_RQST_PK
            , DRIW.UPLD_CSV_RQST_ROW_NUM    AS UPLD_CSV_RQST_ROW_NUM
            , DRIW.DS_ACCT_NM               AS DS_ACCT_NM
            , DRIW.DS_ACCT_NUM              AS DS_ACCT_NUM
            , DRIW.LOC_NUM                  AS LOC_NUM
            , DRIW.CUR_FIRST_LINE_ADDR      AS CUR_FIRST_LINE_ADDR
            , DRIW.CUR_SCD_LINE_ADDR        AS CUR_SCD_LINE_ADDR
            , DRIW.CUR_CTY_ADDR             AS CUR_CTY_ADDR
            , DRIW.CUR_ST_CD                AS CUR_ST_CD
            , DRIW.CUR_POST_CD              AS CUR_POST_CD
            , DRIW.CUR_DS_LOC_EMP_NUM       AS CUR_DS_LOC_EMP_NUM
            , DRIW.CUR_DS_LOC_REV_AMT       AS CUR_DS_LOC_REV_AMT
            , DRIW.CUR_DS_CUST_SIC_DESC_TXT AS CUR_DS_CUST_SIC_DESC_TXT
            , DRIW.CUR_DS_CUST_SIC_CD       AS CUR_DS_CUST_SIC_CD
            , DRIW.CUR_DUNS_NUM             AS CUR_DUNS_NUM
            , DRIW.CUR_DS_ULT_DUNS_NUM      AS CUR_DS_ULT_DUNS_NUM
            , DRIW.CUR_HQ_DUNS_NUM          AS CUR_HQ_DUNS_NUM
            , DRIW.CUR_DS_PRNT_DUNS_NUM     AS CUR_DS_PRNT_DUNS_NUM
            , DRIW.CUR_DUNS_PROC_DT_TXT     AS CUR_DUNS_PROC_DT
            , DRIW.CUR_DUNS_BIZ_NM          AS CUR_DUNS_BIZ_NM
            , DRIW.CUR_DUNS_TRADE_STYLE_NM  AS CUR_DUNS_TRADE_STYLE_NM
            , DRIW.CUR_DUNS_LINE_ADDR       AS CUR_DUNS_LINE_ADDR
            , DRIW.CUR_DUNS_ACTV_CD         AS CUR_DUNS_ACTV_CD
            , DRIW.CUR_DS_LAST_UPD_DUNS_DT_TXT  AS CUR_DS_LAST_UPD_DUNS_DT
            , DRIW.CUR_DS_CMPY_SIC_CD       AS CUR_DS_CMPY_SIC_CD
            , DRIW.CUR_DS_CMPY_SIC_DESC_TXT AS CUR_DS_CMPY_SIC_DESC_TXT
            , DRIW.RCV_DUNS_MATCH_CD        AS RCV_DUNS_MATCH_CD
            , DRIW.RCV_NM_PRFL_CD           AS RCV_NM_PRFL_CD
            , DRIW.RCV_STR_NO_PRFL_CD       AS RCV_STR_NO_PRFL_CD
            , DRIW.RCV_STR_NM_PRFL_CD       AS RCV_STR_NM_PRFL_CD
            , DRIW.RCV_DUNS_CNFD_CD         AS RCV_DUNS_CNFD_CD
            , DRIW.RCV_MATCH_GRD_CD         AS RCV_MATCH_GRD_CD
            , DRIW.RCV_NIXIE_A_CD           AS RCV_NIXIE_A_CD
            , DRIW.RCV_DUNS_ACTV_CD         AS RCV_DUNS_ACTV_CD
            , DRIW.RCV_DUNS_BIZ_NM          AS RCV_DUNS_BIZ_NM
            , DRIW.RCV_DUNS_TRADE_STYLE_NM  AS RCV_DUNS_TRADE_STYLE_NM
            , DRIW.RCV_DUNS_LINE_ADDR       AS RCV_DUNS_LINE_ADDR
            , DRIW.RCV_DUNS_CTY_NM          AS RCV_DUNS_CTY_NM
            , DRIW.RCV_DUNS_ST_CD           AS RCV_DUNS_ST_CD
            , DRIW.RCV_POST_CD              AS RCV_POST_CD
            , DRIW.RCV_DUNS_NUM             AS RCV_DUNS_NUM
            , DRIW.RCV_EMP_TOT_NUM          AS RCV_EMP_TOT_NUM
            , DRIW.RCV_ANN_SLS_AMT          AS RCV_ANN_SLS_AMT
            , DRIW.RCV_LINE_BIZ_NM          AS RCV_LINE_BIZ_NM
            , DRIW.RCV_FIRST_SIC_CD         AS RCV_FIRST_SIC_CD
            , DRIW.RCV_GLBL_ULT_DUNS_NUM    AS RCV_GLBL_ULT_DUNS_NUM
            , DRIW.RCV_HQ_DUNS_NUM          AS RCV_HQ_DUNS_NUM
            , DRIW.RCV_PRNT_DUNS_NUM        AS RCV_PRNT_DUNS_NUM
            , DRIW.RCV_GLBL_ULT_BIZ_NM      AS RCV_GLBL_ULT_BIZ_NM
            , DRIW.RCV_CMPY_SIC_CD          AS RCV_CMPY_SIC_CD
            , DRIW.RCV_CMPY_SIC_DESC_TXT    AS RCV_CMPY_SIC_DESC_TXT
            , DRIW.UPLD_CSV_RQST_CMNT_TXT   AS UPLD_CSV_RQST_CMNT_TXT
            , DA.EFF_FROM_DT                AS EFF_FROM_DT
            , DA.EFF_THRU_DT                AS EFF_THRU_DT
            , DA.ORG_LOC_NUM                AS ORG_LOC_NUM
            , DA.DS_ACCT_TYPE               AS DS_ACCT_TYPE
            , DA.DS_ACCT_NUM                AS ORG_DS_ACCT_NUM
            , DA.DS_ACCT_DLR_CD             AS DS_ACCT_DLR_CD
            , DA.DS_ACCT_LEGAL_NM           AS DS_ACCT_LEGAL_NM
            , DA.DBA_NM                     AS DBA_NM
            , DA.RGTN_STS_CD                AS RGTN_STS_CD
            , DA.DS_ACCT_URL                AS DS_ACCT_URL
            , DA.DS_ACCT_DUNS_NM            AS DS_ACCT_DUNS_NM
            , DA.DS_ACCT_ALT_NM             AS DS_ACCT_ALT_NM
            , DA.DS_XTRNL_REF_TXT           AS DS_XTRNL_REF_TXT
            , DA.DS_DATA_SRC_TXT            AS DS_DATA_SRC_TXT
            , DA.FIRST_REF_CMNT_TXT         AS FIRST_REF_CMNT_TXT
            , DA.SCD_REF_CMNT_TXT           AS SCD_REF_CMNT_TXT
            , DA.DS_ACCT_ITRL_FLG           AS DS_ACCT_ITRL_FLG
            , NVL(DA.DUNS_SEND_CNT, 0)      AS ORG_DUNS_SEND_CNT
            , DA.DS_LAST_RCV_DUNS_DT
            , DA.DS_LAST_RCV_DUNS_TXT
            , DA.ORG_LINE_BIZ_TP_CD
            , DA.ORG_DS_INSD_CTY_LIMIT_FLG
            , DA.ORG_DS_ACCT_NM
            , DA.DS_LOC_NM
            , DA.ORG_FIRST_LINE_ADDR
            , DA.ORG_SCD_LINE_ADDR
            , DA.ORG_THIRD_LINE_ADDR
            , DA.ORG_FRTH_LINE_ADDR
            , DA.ORG_CTY_ADDR
            , DA.ORG_ST_CD
            , DA.ORG_POST_CD
            , DA.ORG_CTRY_CD
            , DA.ORG_ADDL_LOC_NM
            , DA.ORG_GLN_NUM
            , DA.ORG_TEL_NUM
            , DA.ORG_FAX_NUM
            , DA.ORG_PROV_NM
            , DA.ORG_GEO_CD
            , DA.ORG_LOC_NM
            , CNTY.CNTY_NM                  AS ORG_CNTY_NM
            , DA.ORIG_DS_ACCT_NM 
        FROM
              DUNS_RVW_INFO_WRK DRIW
            , ( 
                SELECT
                      #typePros#             AS DS_ACCT_TYPE
                    , DAP.DS_ACCT_NUM        AS DS_ACCT_NUM
                    , DAP.LOC_NUM            AS LOC_NUM
                    , DAP.DS_ACCT_DLR_CD     AS DS_ACCT_DLR_CD
                    , DAP.DS_ACCT_LEGAL_NM   AS DS_ACCT_LEGAL_NM
                    , DAP.DBA_NM             AS DBA_NM
                    , DAP.RGTN_STS_CD        AS RGTN_STS_CD
                    , DAP.DS_ACCT_URL        AS DS_ACCT_URL
                    , DAP.GLBL_CMPY_CD       AS GLBL_CMPY_CD
                    , DAP.EZCANCELFLAG       AS EZCANCELFLAG 
                    , DAP.DS_ACCT_DUNS_NM    AS DS_ACCT_DUNS_NM
                    , DAP.DS_ACCT_ALT_NM     AS DS_ACCT_ALT_NM
                    , DAP.DS_XTRNL_REF_TXT   AS DS_XTRNL_REF_TXT
                    , DAP.DS_DATA_SRC_TXT    AS DS_DATA_SRC_TXT
                    , DAP.FIRST_REF_CMNT_TXT AS FIRST_REF_CMNT_TXT
                    , DAP.SCD_REF_CMNT_TXT   AS SCD_REF_CMNT_TXT
                    , DAP.DS_ACCT_ITRL_FLG   AS DS_ACCT_ITRL_FLG
                    , DAP.EFF_FROM_DT        AS EFF_FROM_DT
                    , DAP.EFF_THRU_DT        AS EFF_THRU_DT
                    , DAP.LOC_NUM            AS ORG_LOC_NUM
                    , PPLW.DS_LAST_RCV_DUNS_DT       AS DS_LAST_RCV_DUNS_DT
                    , PPLW.DS_LAST_RCV_DUNS_TXT      AS DS_LAST_RCV_DUNS_TXT
                    , PPLW.LINE_BIZ_TP_CD            AS ORG_LINE_BIZ_TP_CD
                    , PPLW.DS_INSD_CTY_LIMIT_FLG     AS ORG_DS_INSD_CTY_LIMIT_FLG
                    , PPLW.DS_ACCT_NM                AS ORG_DS_ACCT_NM
                    , PPLW.DS_LOC_NM                 AS DS_LOC_NM
                    , PPLW.FIRST_LINE_ADDR           AS ORG_FIRST_LINE_ADDR
                    , PPLW.SCD_LINE_ADDR             AS ORG_SCD_LINE_ADDR
                    , PPLW.THIRD_LINE_ADDR           AS ORG_THIRD_LINE_ADDR
                    , PPLW.FRTH_LINE_ADDR            AS ORG_FRTH_LINE_ADDR
                    , PPLW.CTY_ADDR                  AS ORG_CTY_ADDR
                    , PPLW.ST_CD                     AS ORG_ST_CD
                    , PPLW.POST_CD                   AS ORG_POST_CD
                    , PPLW.CTRY_CD                   AS ORG_CTRY_CD
                    , PPLW.ADDL_LOC_NM               AS ORG_ADDL_LOC_NM
                    , PPLW.GLN_NUM                   AS ORG_GLN_NUM
                    , PPLW.TEL_NUM                   AS ORG_TEL_NUM
                    , PPLW.FAX_NUM                   AS ORG_FAX_NUM
                    , PPLW.PROV_NM                   AS ORG_PROV_NM
                    , PPLW.GEO_CD                    AS ORG_GEO_CD
                    , PPLW.LOC_NM                    AS ORG_LOC_NM
                    , PPLW.CNTY_PK                   AS CNTY_PK
                    , PPLW.DUNS_SEND_CNT             AS DUNS_SEND_CNT
                    , DAP.DS_ACCT_NM                 AS ORIG_DS_ACCT_NM 
                FROM
                      DS_ACCT_PROS DAP
                    , PROS_PTY_LOC_WRK PPLW
                WHERE
                        DAP.GLBL_CMPY_CD          = #glblCmpyCd# 
                    AND DAP.EZCANCELFLAG          = '0' 
                    AND DAP.DS_ACCT_ACTV_CUST_FLG = 'Y' 
                    AND DAP.RGTN_STS_CD           != #rgtnStsCdP99# 
                    AND DAP.GLBL_CMPY_CD          = PPLW.GLBL_CMPY_CD
                    AND DAP.EZCANCELFLAG          = PPLW.EZCANCELFLAG
                    AND DAP.PTY_LOC_PK            = PPLW.PTY_LOC_PK
                UNION 
                SELECT
                      #typeCust#              AS DS_ACCT_TYPE
                    , SELL.SELL_TO_CUST_CD    AS DS_ACCT_NUM
                    , SELL.LOC_NUM            AS LOC_NUM
                    , SELL.DS_ACCT_DLR_CD     AS DS_ACCT_DLR_CD
                    , SELL.DS_ACCT_LEGAL_NM   AS DS_ACCT_LEGAL_NM
                    , SELL.DBA_NM             AS DBA_NM
                    , SELL.RGTN_STS_CD        AS RGTN_STS_CD
                    , SELL.DS_ACCT_URL        AS DS_ACCT_URL
                    , SELL.GLBL_CMPY_CD       AS GLBL_CMPY_CD
                    , SELL.EZCANCELFLAG       AS EZCANCELFLAG 
                    , SELL.DS_ACCT_DUNS_NM    AS DS_ACCT_DUNS_NM
                    , SELL.DS_ACCT_ALT_NM     AS DS_ACCT_ALT_NM
                    , SELL.DS_XTRNL_REF_TXT   AS DS_XTRNL_REF_TXT
                    , SELL.DS_DATA_SRC_TXT    AS DS_DATA_SRC_TXT
                    , SELL.FIRST_REF_CMNT_TXT AS FIRST_REF_CMNT_TXT
                    , SELL.SCD_REF_CMNT_TXT   AS SCD_REF_CMNT_TXT
                    , SELL.DS_ACCT_ITRL_FLG   AS DS_ACCT_ITRL_FLG
                    , AL.EFF_FROM_DT          AS EFF_FROM_DT
                    , AL.EFF_THRU_DT          AS EFF_THRU_DT
                    , AL.LOC_NUM              AS ORG_LOC_NUM
                    , PLW.DS_LAST_RCV_DUNS_DT       AS DS_LAST_RCV_DUNS_DT
                    , PLW.DS_LAST_RCV_DUNS_TXT      AS DS_LAST_RCV_DUNS_TXT
                    , PLW.LINE_BIZ_TP_CD            AS ORG_LINE_BIZ_TP_CD
                    , PLW.DS_INSD_CTY_LIMIT_FLG     AS ORG_DS_INSD_CTY_LIMIT_FLG
                    , PLW.DS_ACCT_NM                AS ORG_DS_ACCT_NM
                    , PLW.DS_LOC_NM                 AS DS_LOC_NM
                    , PLW.FIRST_LINE_ADDR           AS ORG_FIRST_LINE_ADDR
                    , PLW.SCD_LINE_ADDR             AS ORG_SCD_LINE_ADDR
                    , PLW.THIRD_LINE_ADDR           AS ORG_THIRD_LINE_ADDR
                    , PLW.FRTH_LINE_ADDR            AS ORG_FRTH_LINE_ADDR
                    , PLW.CTY_ADDR                  AS ORG_CTY_ADDR
                    , PLW.ST_CD                     AS ORG_ST_CD
                    , PLW.POST_CD                   AS ORG_POST_CD
                    , PLW.CTRY_CD                   AS ORG_CTRY_CD
                    , PLW.ADDL_LOC_NM               AS ORG_ADDL_LOC_NM
                    , PLW.GLN_NUM                   AS ORG_GLN_NUM
                    , PLW.TEL_NUM                   AS ORG_TEL_NUM
                    , PLW.FAX_NUM                   AS ORG_FAX_NUM
                    , PLW.PROV_NM                   AS ORG_PROV_NM
                    , PLW.GEO_CD                    AS ORG_GEO_CD
                    , PLW.LOC_NM                    AS ORG_LOC_NM
                    , PLW.CNTY_PK                   AS CNTY_PK
                    , PLW.DUNS_SEND_CNT             AS DUNS_SEND_CNT
                    , SELL.DS_ACCT_NM               AS ORIG_DS_ACCT_NM
                FROM
                      SELL_TO_CUST SELL
                    , ACCT_LOC AL
                    , PTY_LOC_WRK PLW
                WHERE
                        SELL.GLBL_CMPY_CD          = #glblCmpyCd# 
                    AND SELL.EZCANCELFLAG          = '0' 
                    AND SELL.DS_ACCT_ACTV_CUST_FLG = 'Y'
                    AND SELL.SELL_TO_CUST_CD       = AL.DS_ACCT_NUM(+) 
                    AND SELL.GLBL_CMPY_CD          = AL.GLBL_CMPY_CD(+) 
                    AND SELL.EZCANCELFLAG          = AL.EZCANCELFLAG(+) 
                    AND AL.RGTN_STS_CD(+)          != #rgtnStsCdP99#
                    AND AL.LOC_NUM                 = PLW.LOC_NUM(+) 
                    AND AL.GLBL_CMPY_CD            = PLW.GLBL_CMPY_CD(+) 
                    AND AL.EZCANCELFLAG            = PLW.EZCANCELFLAG(+) 
                    AND PLW.RGTN_STS_CD(+)         = #rgtnStsCdP20# 
              ) DA
            , CNTY 
        WHERE
                DRIW.UPLD_CSV_RQST_PK = #upldCsvRqstPk# 
            AND DRIW.GLBL_CMPY_CD     = #glblCmpyCd# 
            AND DRIW.EZCANCELFLAG     = '0' 
            AND DRIW.DS_ACCT_NUM      = DA.DS_ACCT_NUM(+) 
            AND DRIW.GLBL_CMPY_CD     = DA.GLBL_CMPY_CD(+) 
            AND DRIW.EZCANCELFLAG     = DA.EZCANCELFLAG(+) 
            AND DRIW.LOC_NUM          = DA.ORG_LOC_NUM(+)
            AND DA.CNTY_PK            = CNTY.CNTY_PK(+) 
            AND DA.GLBL_CMPY_CD       = CNTY.GLBL_CMPY_CD(+) 
            AND DA.EZCANCELFLAG       = CNTY.EZCANCELFLAG(+) 
        ORDER BY
              DRIW.UPLD_CSV_RQST_PK ASC
            , DRIW.DS_ACCT_NUM ASC
            , DRIW.LOC_NUM ASC
            , DRIW.UPLD_CSV_RQST_ROW_NUM ASC

	</statement>
</sqlMap>
