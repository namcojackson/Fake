<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB118001">

    <statement id="getTrgtDtRec" parameterClass="Map" resultClass="BigDecimal">
        SELECT COUNT(1)
        FROM
            DMN_MDSE                 MDSE
        WHERE 
            MDSE.GLBL_CMPY_CD         = #glblCmpyCd#
        AND MDSE.DWH_TRGT_DT          = #trgtDt#
        AND MDSE.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getMainData" parameterClass="Map" resultClass="Map">
       SELECT
            MDSE.MDSE_CD
           ,MDSE.MDSE_DESC_SHORT_TXT
           ,MDSE.MDSE_DESC_LONG_TXT
           ,MDSE.COA_PROD_CD
           ,CP.COA_PROD_DESC_TXT
           ,MDSE.MDSE_TP_CD
           ,MDT.MDSE_TP_DESC_TXT
           ,MDSE.THIS_MTH_FOB_AMT
           ,MDSE.THIS_MTH_INLND_FRT_AMT
           ,MDSE.THIS_MTH_INTL_FRT_AMT
           ,MDSE.THIS_MTH_IMPT_DTY_AMT
           ,MDSE.THIS_MTH_INS_AMT
           ,MDSE.THIS_MTH_TOT_STD_COST_AMT
           ,MDSE.ZEROTH_PROD_CTRL_CD
           ,MDSE.ZEROTH_PROD_CTRL_NM
           ,MDSE.FIRST_PROD_CTRL_CD
           ,MDSE.FIRST_PROD_CTRL_NM
           ,MDSE.SCD_PROD_CTRL_CD
           ,MDSE.SCD_PROD_CTRL_NM
           ,MDSE.THIRD_PROD_CTRL_CD
           ,MDSE.THIRD_PROD_CTRL_NM
           ,MDSE.FRTH_PROD_CTRL_CD
           ,MDSE.FRTH_PROD_CTRL_NM
           ,MDSE.FIFTH_PROD_CTRL_CD
           ,MDSE.FIFTH_PROD_CTRL_NM
           ,MDSE.SIXTH_PROD_CTRL_CD
           ,MDSE.SIXTH_PROD_CTRL_NM
           ,MDSE.SVNTH_PROD_CTRL_CD
           ,MDSE.SVNTH_PROD_CTRL_NM
           ,MDSE.SLS_MAT_GRP_CD_01
           ,SMG1.SLS_MAT_GRP_DESC_TXT       AS SLS_MAT_GRP_DESC_TXT_01
           ,MDSE.SLS_MAT_GRP_CD_02
           ,SMG2.SLS_MAT_GRP_DESC_TXT       AS SLS_MAT_GRP_DESC_TXT_02
           ,MDSE.SLS_MAT_GRP_CD_03
           ,SMG3.SLS_MAT_GRP_DESC_TXT       AS SLS_MAT_GRP_DESC_TXT_03
           ,MDSE.DS_CMSN_GRP_CD
           ,DCG.DS_CMSN_GRP_DESC_TXT
           ,MDSE.MNF_ITEM_CD
           ,MDSE.MDSE_ITEM_MNF_CD
           ,MIM.MDSE_ITEM_MNF_DESC_TXT
           ,MDSE.REV_COA_ACCT_CD
           ,CAR.COA_ACCT_DESC_TXT           AS REV_COA_ACCT_DESC_TXT
           ,MDSE.COGS_COA_ACCT_CD
           ,CACO.COA_ACCT_DESC_TXT          AS COGS_COA_ACCT_DESC_TXT
           ,MDSE.EXP_COA_ACCT_CD
           ,CAEX.COA_ACCT_DESC_TXT          AS EXP_COA_ACCT_DESC_TXT
           ,MDSE.ASSET_RECOV_COST_AMT
           ,MDSE.ASSET_RECOV_COST_AMT_UPD_DT
           ,MDSE.MDSE_ITEM_STS_CD
           ,MIS.MDSE_ITEM_STS_DESC_TXT
           ,MDSE.COA_MDSE_TP_CD
           ,CMT.COA_PROJ_DESC_TXT AS COA_MDSE_TP_DESC_TXT
           ,MDSE.RGTN_STS_CD
           ,MDSE.MDSE_ITEM_TP_CD
           ,MIT.MDSE_ITEM_TP_DESC_TXT
           ,MDSE.MDSE_ITEM_CLS_TP_CD
           ,MICT.MDSE_ITEM_CLS_TP_DESC_TXT
           ,SR.SUPD_TO_MDSE_CD
           ,MDSE.PRT_ITEM_TP_CD
       FROM
            MDSE             MDSE
           ,MDSE_TP          MDT
           ,MDSE_ITEM_TP     MIT
           ,MDSE_ITEM_CLS_TP MICT
           ,SUPD_RELN        SR
           ,COA_PROD         CP
           ,COA_PROJ         CMT
           ,MDSE_ITEM_STS    MIS
           ,COA_ACCT         CAR
           ,COA_ACCT         CACO
           ,COA_ACCT         CAEX
           ,SLS_MAT_GRP      SMG1
           ,SLS_MAT_GRP      SMG2
           ,SLS_MAT_GRP      SMG3
           ,MDSE_ITEM_MNF    MIM
           ,DS_CMSN_GRP      DCG
       WHERE
               MDSE.GLBL_CMPY_CD       = #glblCmpyCd#
           AND MDSE.GLBL_CMPY_CD       = MDT.GLBL_CMPY_CD(+)
           AND MDSE.MDSE_TP_CD         = MDT.MDSE_TP_CD(+)
           AND MDSE.GLBL_CMPY_CD       = CP.GLBL_CMPY_CD(+)
           AND MDSE.COA_PROD_CD        = CP.COA_PROD_CD(+)
           AND MDSE.GLBL_CMPY_CD        = MIT.GLBL_CMPY_CD(+)
           AND MDSE.MDSE_ITEM_TP_CD     = MIT.MDSE_ITEM_TP_CD(+)
           AND MDSE.GLBL_CMPY_CD        = MICT.GLBL_CMPY_CD(+)
           AND MDSE.MDSE_ITEM_CLS_TP_CD = MICT.MDSE_ITEM_CLS_TP_CD(+)
           AND MDSE.GLBL_CMPY_CD       = SR.GLBL_CMPY_CD(+)
           AND MDSE.MDSE_CD            = SR.SUPD_FROM_MDSE_CD(+)
           AND MDSE.GLBL_CMPY_CD        = CMT.GLBL_CMPY_CD(+)
           AND MDSE.COA_MDSE_TP_CD      = CMT.COA_PROJ_CD(+)
           AND MDSE.GLBL_CMPY_CD        = MIS.GLBL_CMPY_CD(+)
           AND MDSE.MDSE_ITEM_STS_CD    = MIS.MDSE_ITEM_STS_CD(+)
           AND MDSE.GLBL_CMPY_CD        = CAR.GLBL_CMPY_CD(+)
           AND MDSE.REV_COA_ACCT_CD     = CAR.COA_ACCT_CD(+)
           AND MDSE.GLBL_CMPY_CD        = CACO.GLBL_CMPY_CD(+)
           AND MDSE.COGS_COA_ACCT_CD    = CACO.COA_ACCT_CD(+)
           AND MDSE.GLBL_CMPY_CD        = CAEX.GLBL_CMPY_CD(+)
           AND MDSE.EXP_COA_ACCT_CD     = CAEX.COA_ACCT_CD(+)
           AND MDSE.GLBL_CMPY_CD        = SMG1.GLBL_CMPY_CD(+)
           AND MDSE.SLS_MAT_GRP_CD_01   = SMG1.SLS_MAT_GRP_CD(+)
           AND MDSE.GLBL_CMPY_CD        = SMG2.GLBL_CMPY_CD(+)
           AND MDSE.SLS_MAT_GRP_CD_02   = SMG2.SLS_MAT_GRP_CD(+)
           AND MDSE.GLBL_CMPY_CD        = SMG3.GLBL_CMPY_CD(+)
           AND MDSE.SLS_MAT_GRP_CD_03   = SMG3.SLS_MAT_GRP_CD(+)
           AND MDSE.GLBL_CMPY_CD        = MIM.GLBL_CMPY_CD(+)
           AND MDSE.MDSE_ITEM_MNF_CD    = MIM.MDSE_ITEM_MNF_CD(+)
           AND MDSE.GLBL_CMPY_CD        = DCG.GLBL_CMPY_CD(+)
           AND MDSE.DS_CMSN_GRP_CD      = DCG.DS_CMSN_GRP_CD(+)
           AND MDSE.EZCANCELFLAG       = '0'
           AND MDT.EZCANCELFLAG(+)     = '0'
           AND CP.EZCANCELFLAG(+)      = '0'
           AND MIT.EZCANCELFLAG(+)     = '0'
           AND MICT.EZCANCELFLAG(+)    = '0'
           AND SR.EZCANCELFLAG(+)      = '0'
           AND CMT.EZCANCELFLAG(+)     = '0'
           AND MIS.EZCANCELFLAG(+)     = '0'
           AND CAR.EZCANCELFLAG(+)     = '0'
           AND CACO.EZCANCELFLAG(+)    = '0'
           AND CAEX.EZCANCELFLAG(+)    = '0'
           AND SMG1.EZCANCELFLAG(+)    = '0'
           AND SMG2.EZCANCELFLAG(+)    = '0'
           AND SMG3.EZCANCELFLAG(+)    = '0'
           AND MIM.EZCANCELFLAG(+)     = '0'
           AND DCG.EZCANCELFLAG(+)     = '0'
           AND NOT EXISTS( 
               SELECT
                     1 
               FROM
                   RPT_COND_CONST RCC 
               WHERE
                   RCC.GLBL_CMPY_CD = #glblCmpyCd# 
                   AND RCC.EZCANCELFLAG = '0' 
                   AND RCC.RPT_COND_CONST_GRP_ID = 'NMAB1180_EXCEL_MDSE' 
                   AND RCC.RPT_COND_CONST_CD = MDSE.MDSE_CD
           )
    </statement>
</sqlMap>
