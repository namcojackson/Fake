<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NLGB010001">

    <!-- ==== Type Aliases ==== -->
    <typeAlias alias="WMS_INBD_TRXTMsg" type="business.db.WMS_INBD_TRXTMsg"/>
    <typeAlias alias="WMS_WHTMsg"       type="business.db.WMS_WHTMsg"/>

    <statement id="getIfData" parameterClass="Map" resultMap="result.WMS_INBD_TRXTMsg">
    SELECT
           IF.INTERFACE_ID INTFC_ID
          ,IF.EZINTIME INTFC_RCV_TS
          ,IF.TRANSACTION_ID INTFC_TRX_ID
          ,IF.UNIT_ID INTFC_TRX_SQ_NUM
          ,IF.WMS_REC_ID
          ,IF.WH_CD
          ,IF.WMS_TASK_CD
          ,IF.WMS_STS_CD
          ,IF.WMS_RSN_CD
          ,IF.WMS_MDSE_CD
          ,IF.WMS_PKG_CD
          ,IF.WMS_TAG_ID
          ,IF.WMS_LOT_NUM
          ,IF.WMS_LOC_ID
          ,IF.WMS_ORG_QTY
          ,IF.WMS_ORD_QTY
          ,IF.WMS_EXPD_QTY
          ,IF.RCV_TO_DATE_QTY
          ,IF.WMS_PROC_QTY
          ,IF.WMS_CNTNR_ID
          ,IF.WMS_OUT_CNTNR_NUM
          ,IF.SER_NUM
          ,IF.WMS_STK_STS_CD
          ,IF.WMS_DMG_FLG
          ,IF.WMS_OLD_STK_STS_CD
          ,IF.WMS_OLD_DMG_FLG
          ,IF.WMS_OP_ID
          ,IF.INBD_ORD_NUM
          ,IF.INBD_ORD_TP_CD
          ,IF.INBD_ORD_LINE_NUM
          ,IF.WMS_RCV_NUM
          ,IF.WMS_RCPT_ID
          ,IF.WMS_SPLY_NM
          ,IF.WMS_RCV_LOC_ID
          ,IF.OTBD_ORD_NUM
          ,IF.OTBD_ORD_TP_CD
          ,IF.OTBD_ORD_LINE_NUM
          ,IF.WMS_LINE_SQ_NUM
          ,IF.WMS_ORD_STS_CD
          ,IF.WMS_SHIP_ID
          ,IF.WMS_ASN_NUM
          ,IF.PACK_MARK_SEPT_FLG
          ,IF.WMS_WAVE_ID
          ,IF.WH_SRCH_ID
          ,IF.WMS_TOT_VOL
          ,IF.WMS_TOT_WT
          ,IF.WMS_TOT_PIECE_NUM
          ,IF.ORD_LINE_CPLT_FLG
          ,IF.SHIP_UNIT_WT
          ,IF.WMS_AWB_NUM
          ,IF.BOL_NUM
          ,IF.WMS_MNIF_NUM
          ,IF.PRO_NUM
          ,IF.WMS_INV_NUM
          ,IF.WMS_CARR_CD
          ,IF.WMS_TRAIL_ID
          ,IF.WMS_FRT_ID
          ,IF.WMS_FRT_CHRG_AMT
          ,IF.WMS_FRT_TERM_CD
          ,IF.SHIP_TO_LOC_NM
          ,IF.SHIP_TO_FIRST_LINE_ADDR
          ,IF.SHIP_TO_SCD_LINE_ADDR
          ,IF.SHIP_TO_CTY_ADDR
          ,IF.SHIP_TO_ST_NM
          ,IF.SHIP_TO_POST_CD
          ,IF.WMS_GRP_ID_01
          ,IF.WMS_GRP_ID_02
          ,IF.WMS_GRP_ID_03
          ,IF.USR_ID_01
          ,IF.USR_ID_02
          ,IF.USR_ID_03
          ,IF.WMS_TRX_DT_TM_TS
          ,IF.WMS_RCPT_DT_TM_TS
          ,IF.WMS_RTN_DT_TM_TS
          ,IF.WMS_SHIP_DT_TM_TS
          ,IF.WMS_DATA_CRAT_DT_TM_TS
          ,IF.WMS_DATA_MOD_DT_TM_TS
          ,IF.MOD_BY_TXT
          ,IF.MOD_BY_RESRC_TXT
          ,IF.WMS_MOD_CNT
          ,IF.WMS_CNTNR_NUM
          ,IF.EST_DOCK_DT_TM_TS
          ,IF.TMS_FRT_CHRG_AMT
          ,IF.TMS_FRT_CHRG_COST_AMT
          ,WH.WMS_ORG_HOST_ID WMS_ORG_HOST_ID
          ,TASK.INTFC_TP_ID INTFC_TP_ID
          ,IF.TMS_TRK_NUM
          ,IF.CYCLE_CNT_RSN_CD
          ,IF.CYCLE_CNT_RSN_CMNT_TXT
      FROM
           NLGI0100_01 IF
          ,WMS_WH      WH
          ,WMS_TASK    TASK
     WHERE
           IF.WH_CD          = WH.WH_CD
       AND WH.GLBL_CMPY_CD   = #glblCmpyCd#
       AND WH.EZCANCELFLAG   = '0'
       AND TASK.GLBL_CMPY_CD = #glblCmpyCd#
       AND IF.WMS_TASK_CD    = TASK.WMS_TASK_CD
       AND TASK.EZCANCELFLAG = '0'
       AND IF.INTERFACE_ID   = #interfaceId#
       AND IF.TRANSACTION_ID = #transactionId#
       <iterate property="wmsTrgtWhCd" var="elem[]" open="AND WH.WH_CD IN (" close=")" conjunction=",">
       #elem[]#
       </iterate>
       AND IF.EZCANCELFLAG   = '0'
     ORDER BY
           IF.INTERFACE_ID
          ,IF.TRANSACTION_ID
          ,IF.SEGMENT_ID
          ,IF.UNIT_ID
          ,IF.SEQ_NUMBER
    </statement>

    <resultMap id="result.WMS_INBD_TRXTMsg" class="WMS_INBD_TRXTMsg">
        <result property="intfcId"             column="INTFC_ID"                javaType="EZDTStringItem"/>
        <result property="intfcRcvTs"          column="INTFC_RCV_TS"            javaType="EZDTStringItem"/>
        <result property="intfcTrxId"          column="INTFC_TRX_ID"            javaType="EZDTStringItem"/>
        <result property="intfcTrxSqNum"       column="INTFC_TRX_SQ_NUM"        javaType="EZDTStringItem"/>
        <result property="wmsRecId"            column="WMS_REC_ID"              javaType="EZDTStringItem"/>
        <result property="whCd"                column="WH_CD"                   javaType="EZDTStringItem"/>
        <result property="wmsTaskCd"           column="WMS_TASK_CD"             javaType="EZDTStringItem"/>
        <result property="wmsStsCd"            column="WMS_STS_CD"              javaType="EZDTStringItem"/>
        <result property="wmsRsnCd"            column="WMS_RSN_CD"              javaType="EZDTStringItem"/>
        <result property="wmsMdseCd"           column="WMS_MDSE_CD"             javaType="EZDTStringItem"/>
        <result property="wmsPkgCd"            column="WMS_PKG_CD"              javaType="EZDTStringItem"/>
        <result property="wmsTagId"            column="WMS_TAG_ID"              javaType="EZDTStringItem"/>
        <result property="wmsLotNum"           column="WMS_LOT_NUM"             javaType="EZDTStringItem"/>
        <result property="wmsLocId"            column="WMS_LOC_ID"              javaType="EZDTStringItem"/>
        <result property="wmsOrgQty"           column="WMS_ORG_QTY"             javaType="EZDTBigDecimalItem"/>
        <result property="wmsOrdQty"           column="WMS_ORD_QTY"             javaType="EZDTBigDecimalItem"/>
        <result property="wmsExpdQty"          column="WMS_EXPD_QTY"            javaType="EZDTBigDecimalItem"/>
        <result property="rcvToDateQty"        column="RCV_TO_DATE_QTY"         javaType="EZDTBigDecimalItem"/>
        <result property="wmsProcQty"          column="WMS_PROC_QTY"            javaType="EZDTBigDecimalItem"/>
        <result property="wmsCntnrId"          column="WMS_CNTNR_ID"            javaType="EZDTStringItem"/>
        <result property="wmsOutCntnrNum"      column="WMS_OUT_CNTNR_NUM"       javaType="EZDTStringItem"/>
        <result property="serNum"              column="SER_NUM"                 javaType="EZDTStringItem"/>
        <result property="wmsStkStsCd"         column="WMS_STK_STS_CD"          javaType="EZDTStringItem"/>
        <result property="wmsDmgFlg"           column="WMS_DMG_FLG"             javaType="EZDTStringItem"/>
        <result property="wmsOldStkStsCd"      column="WMS_OLD_STK_STS_CD"      javaType="EZDTStringItem"/>
        <result property="wmsOldDmgFlg"        column="WMS_OLD_DMG_FLG"         javaType="EZDTStringItem"/>
        <result property="wmsOpId"             column="WMS_OP_ID"               javaType="EZDTStringItem"/>
        <result property="inbdOrdNum"          column="INBD_ORD_NUM"            javaType="EZDTStringItem"/>
        <result property="inbdOrdTpCd"         column="INBD_ORD_TP_CD"          javaType="EZDTStringItem"/>
        <result property="inbdOrdLineNum"      column="INBD_ORD_LINE_NUM"       javaType="EZDTBigDecimalItem"/>
        <result property="wmsRcvNum"           column="WMS_RCV_NUM"             javaType="EZDTBigDecimalItem"/>
        <result property="wmsRcptId"           column="WMS_RCPT_ID"             javaType="EZDTStringItem"/>
        <result property="wmsSplyNm"           column="WMS_SPLY_NM"             javaType="EZDTStringItem"/>
        <result property="wmsRcvLocId"         column="WMS_RCV_LOC_ID"          javaType="EZDTStringItem"/>
        <result property="otbdOrdNum"          column="OTBD_ORD_NUM"            javaType="EZDTStringItem"/>
        <result property="otbdOrdTpCd"         column="OTBD_ORD_TP_CD"          javaType="EZDTStringItem"/>
        <result property="otbdOrdLineNum"      column="OTBD_ORD_LINE_NUM"       javaType="EZDTBigDecimalItem"/>
        <result property="wmsLineSqNum"        column="WMS_LINE_SQ_NUM"         javaType="EZDTBigDecimalItem"/>
        <result property="wmsOrdStsCd"         column="WMS_ORD_STS_CD"          javaType="EZDTStringItem"/>
        <result property="wmsShipId"           column="WMS_SHIP_ID"             javaType="EZDTStringItem"/>
        <result property="wmsAsnNum"           column="WMS_ASN_NUM"             javaType="EZDTStringItem"/>
        <result property="packMarkSeptFlg"     column="PACK_MARK_SEPT_FLG"      javaType="EZDTStringItem"/>
        <result property="wmsWaveId"           column="WMS_WAVE_ID"             javaType="EZDTStringItem"/>
        <result property="whSrchId"            column="WH_SRCH_ID"              javaType="EZDTStringItem"/>
        <result property="wmsTotVol"           column="WMS_TOT_VOL"             javaType="EZDTBigDecimalItem"/>
        <result property="wmsTotWt"            column="WMS_TOT_WT"              javaType="EZDTBigDecimalItem"/>
        <result property="wmsTotPieceNum"      column="WMS_TOT_PIECE_NUM"       javaType="EZDTBigDecimalItem"/>
        <result property="ordLineCpltFlg"      column="ORD_LINE_CPLT_FLG"       javaType="EZDTStringItem"/>
        <result property="shipUnitWt"          column="SHIP_UNIT_WT"            javaType="EZDTBigDecimalItem"/>
        <result property="wmsAwbNum"           column="WMS_AWB_NUM"             javaType="EZDTStringItem"/>
        <result property="bolNum"              column="BOL_NUM"                 javaType="EZDTStringItem"/>
        <result property="wmsMnifNum"          column="WMS_MNIF_NUM"            javaType="EZDTStringItem"/>
        <result property="proNum"              column="PRO_NUM"                 javaType="EZDTStringItem"/>
        <result property="wmsInvNum"           column="WMS_INV_NUM"             javaType="EZDTStringItem"/>
        <result property="wmsCarrCd"           column="WMS_CARR_CD"             javaType="EZDTStringItem"/>
        <result property="wmsTrailId"          column="WMS_TRAIL_ID"            javaType="EZDTStringItem"/>
        <result property="wmsFrtId"            column="WMS_FRT_ID"              javaType="EZDTStringItem"/>
        <result property="wmsFrtChrgAmt"       column="WMS_FRT_CHRG_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="wmsFrtTermCd"        column="WMS_FRT_TERM_CD"         javaType="EZDTStringItem"/>
        <result property="shipToLocNm"         column="SHIP_TO_LOC_NM"          javaType="EZDTStringItem"/>
        <result property="shipToFirstLineAddr" column="SHIP_TO_FIRST_LINE_ADDR" javaType="EZDTStringItem"/>
        <result property="shipToScdLineAddr"   column="SHIP_TO_SCD_LINE_ADDR"   javaType="EZDTStringItem"/>
        <result property="shipToCtyAddr"       column="SHIP_TO_CTY_ADDR"        javaType="EZDTStringItem"/>
        <result property="shipToStNm"          column="SHIP_TO_ST_NM"           javaType="EZDTStringItem"/>
        <result property="shipToPostCd"        column="SHIP_TO_POST_CD"         javaType="EZDTStringItem"/>
        <result property="wmsGrpId_01"         column="WMS_GRP_ID_01"           javaType="EZDTStringItem"/>
        <result property="wmsGrpId_02"         column="WMS_GRP_ID_02"           javaType="EZDTStringItem"/>
        <result property="wmsGrpId_03"         column="WMS_GRP_ID_03"           javaType="EZDTStringItem"/>
        <result property="usrId_01"            column="USR_ID_01"               javaType="EZDTStringItem"/>
        <result property="usrId_02"            column="USR_ID_02"               javaType="EZDTStringItem"/>
        <result property="usrId_03"            column="USR_ID_03"               javaType="EZDTStringItem"/>
        <result property="wmsTrxDtTmTs"        column="WMS_TRX_DT_TM_TS"        javaType="EZDTStringItem"/>
        <result property="wmsRcptDtTmTs"       column="WMS_RCPT_DT_TM_TS"       javaType="EZDTStringItem"/>
        <result property="wmsRtnDtTmTs"        column="WMS_RTN_DT_TM_TS"        javaType="EZDTStringItem"/>
        <result property="wmsShipDtTmTs"       column="WMS_SHIP_DT_TM_TS"       javaType="EZDTStringItem"/>
        <result property="wmsDataCratDtTmTs"   column="WMS_DATA_CRAT_DT_TM_TS"  javaType="EZDTStringItem"/>
        <result property="wmsDataModDtTmTs"    column="WMS_DATA_MOD_DT_TM_TS"   javaType="EZDTStringItem"/>
        <result property="modByTxt"            column="MOD_BY_TXT"              javaType="EZDTStringItem"/>
        <result property="modByResrcTxt"       column="MOD_BY_RESRC_TXT"        javaType="EZDTStringItem"/>
        <result property="wmsModCnt"           column="WMS_MOD_CNT"             javaType="EZDTBigDecimalItem"/>
        <result property="wmsCntnrNum"         column="WMS_CNTNR_NUM"           javaType="EZDTStringItem"/>
        <result property="estDockDtTmTs"       column="EST_DOCK_DT_TM_TS"       javaType="EZDTStringItem"/>
        <result property="tmsFrtChrgAmt"       column="TMS_FRT_CHRG_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="tmsFrtChrgCostAmt"   column="TMS_FRT_CHRG_COST_AMT"   javaType="EZDTBigDecimalItem"/>
        <result property="wmsOrgHostId"        column="WMS_ORG_HOST_ID"         javaType="EZDTStringItem"/>
        <result property="intfcTpId"           column="INTFC_TP_ID"             javaType="EZDTStringItem"/>
        <result property="tmsTrkNum"           column="TMS_TRK_NUM"             javaType="EZDTStringItem"/>
        <result property="cycleCntRsnCd"       column="CYCLE_CNT_RSN_CD"        javaType="EZDTStringItem"/>
        <result property="cycleCntRsnCmntTxt"  column="CYCLE_CNT_RSN_CMNT_TXT"  javaType="EZDTStringItem"/>
    </resultMap>

    <statement id="getWmsOrdTpCdForSo" parameterClass="Map" resultClass="Map">
        SELECT
               WISH.WMS_ORD_TP_CD
          FROM
               WMS_INBD_SO_HDR WISH
         WHERE
               WISH.GLBL_CMPY_CD = #glblCmpyCd#
           AND WISH.WMS_SO_ID    = #soNum#
           AND WISH.EZCANCELFLAG = '0'
    </statement>

    <statement id="getWmsOrdTpCdForPo" parameterClass="Map" resultClass="Map">
        SELECT
               WIPH.WMS_PRCH_TP_CD
          FROM
               WMS_INBD_PO_HDR WIPH
         WHERE
               WIPH.GLBL_CMPY_CD = #glblCmpyCd#
           AND WIPH.WMS_PO_ID    = #poNum#
           AND WIPH.EZCANCELFLAG = '0'
    </statement>
    <statement id="getRwsNum" parameterClass="Map" resultClass="String">
        SELECT
            A.RWS_NUM
        FROM (
            SELECT
                RWS_NUM
            FROM
                WMS_INBD_PO_HDR
	        WHERE
	            GLBL_CMPY_CD = #glblCmpyCd#
	        AND WH_CD        = #whCd#
	        AND WMS_PO_ID    = #wmsPoId#
	        AND EZCANCELFLAG = '0'
	        ORDER BY
	            WMS_SQ_NUM DESC
            ) A
        WHERE ROWNUM = 1
    </statement>
	<!-- Start QC#57442 Add -->
    <statement id="getShpgOrdCnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT COUNT(SO.SO_NUM) AS CNT
        FROM SHPG_ORD SO
        WHERE SO.GLBL_CMPY_CD = #glblCmpyCd#
        AND SO.SO_NUM         = #otbdOrdNum#
        AND SO.EZCANCELFLAG   = '0'
    </statement>
    <statement id="getRwsHdrCnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT COUNT(RH.RWS_NUM) AS CNT
        FROM RWS_HDR RH
        WHERE RH.GLBL_CMPY_CD = #glblCmpyCd#
        AND RH.RWS_REF_NUM  = #inbdOrdNum#
        AND RH.EZCANCELFLAG = '0'
    </statement>
    <!-- End QC#57442 Add -->
</sqlMap>
