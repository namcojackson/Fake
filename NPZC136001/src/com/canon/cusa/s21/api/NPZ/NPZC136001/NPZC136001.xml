<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NPZC136001">
   
    <statement id="getBigDealNumber" parameterClass="Map" resultClass="String">
        SELECT
            STC.BIG_DEAL_NUM
        FROM
            SHIP_TO_CUST STC
        WHERE
                STC.GLBL_CMPY_CD     = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD  = #shipToCustCd#
            AND STC.EZCANCELFLAG     = '0'
    </statement>
    
    <statement id="searchAslDetails" parameterClass="Map" resultClass="Map">
        SELECT
                D.ASL_DTL_PK           AS  ASL_DTL_PK
              , D.MDSE_CD              AS  MDSE_CD
              , D.SPLY_ITEM_NUM        AS  SPLY_ITEM_NUM
              , D.VND_CD               AS  VND_CD
              , D.VND_UOM_CD           AS  VND_UOM_CD
              , D.UNIT_PRC_AMT         AS  UNIT_PRC_AMT
              , D.VND_MIN_ORD_QTY      AS  VND_MIN_ORD_QTY
              , D.VND_INCR_ORD_QTY     AS  VND_INCR_ORD_QTY
              , D.PRIM_SPLY_FLG        AS  PRIM_SPLY_FLG
              , H.PRNT_VND_CD          AS  PRNT_VND_CD
              , D.VND_LT_DAYS_NUM      AS  VND_LT_DAYS_NUM
          FROM
                ASL_HDR                H
              , ASL_DTL                D
             <isNotNull property="aslQlfyTpCd">
              , ASL_QLFY_RELN          QR
             </isNotNull>
         WHERE
            <!-- join condition. -->
                H.GLBL_CMPY_CD                     =       D.GLBL_CMPY_CD(+)
            AND H.ASL_HDR_PK                       =       D.ASL_HDR_PK(+)
            <isNotNull property="aslQlfyTpCd">
            AND H.GLBL_CMPY_CD                     =       QR.GLBL_CMPY_CD(+)
            AND H.ASL_HDR_PK                       =       QR.ASL_HDR_PK(+)
            </isNotNull>
            <!-- query condition. -->
            AND H.GLBL_CMPY_CD                     =       #glblCmpyCd#
            AND NVL(H.ASL_START_DT, '00000000')    &lt;=   #salesDate#
            AND NVL(H.ASL_END_DT, '99991231')      &gt;=   #salesDate#
            AND H.EZCANCELFLAG                     =       '0'
            AND D.MDSE_CD                          =       #mdseCd#
            AND NVL(D.EFF_FROM_DT, '00000000')     &lt;=   #salesDate#
            AND NVL(D.EFF_THRU_DT, '99991231')     &gt;=   #salesDate#
            AND D.EZCANCELFLAG(+)                  =       '0'
            AND D.VND_CD IS NOT NULL
            <isNotNull property="vndCd">
            AND D.VND_CD                           =       #vndCd#
            AND H.PRNT_VND_CD                      =       #prntVndCd#
            </isNotNull>
            <isNotNull property="primSplyFlg">
            AND D.PRIM_SPLY_FLG                    =       #primSplyFlg#
            </isNotNull>
            <isNotNull property="aslQlfyTpCd">
            AND QR.ASL_QLFY_TP_CD                  =       #aslQlfyTpCd#
            AND QR.ASL_QLFY_REF_CD                 =       #aslQlfyRefCd#
            AND QR.EZCANCELFLAG(+)                 =       '0'
            </isNotNull>
    </statement>
</sqlMap>
