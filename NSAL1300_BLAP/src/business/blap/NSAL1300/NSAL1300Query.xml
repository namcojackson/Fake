<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAL1300Query">
    <typeAlias alias="NSAL1300_ACMsg" type="business.blap.NSAL1300.NSAL1300_ACMsg"/>
    <statement id="getUsageMeterData" parameterClass="Map" resultMap="result.getUsageMeterData">
        SELECT
             A.SVC_CONTR_BLLG_PK
            ,B.SVC_CONTR_MTR_BLLG_PK
            ,B.DS_CONTR_BLLG_MTR_PK
            ,B.COPY_INCL_QTY
            ,B.MTR_COPY_QTY
            ,B.BLLG_COPY_QTY
            ,B.MTR_CHRG_DEAL_AMT
            ,B.XS_CHRG_TP_CD
            ,D.MTR_LB_CD
            ,D.MTR_LB_DESC_TXT
            ,E.SVC_CONTR_XS_MTR_BLLG_PK
            ,E.CONTR_XS_COPY_PK
            ,E.XS_MTR_COPY_QTY
            ,E.XS_MTR_AMT_RATE
            ,E.XS_MTR_CHRG_DEAL_AMT
            ,(SELECT
                COUNT(*)
              FROM
                 SVC_CONTR_MTR_BLLG F
                ,SVC_CONTR_XS_MTR_BLLG G
              WHERE
                    F.GLBL_CMPY_CD              = A.GLBL_CMPY_CD
                AND F.SVC_CONTR_BLLG_PK         = A.SVC_CONTR_BLLG_PK
                AND F.EZCANCELFLAG              = '0'
                AND F.GLBL_CMPY_CD              = G.GLBL_CMPY_CD
                AND F.SVC_CONTR_MTR_BLLG_PK     = G.SVC_CONTR_MTR_BLLG_PK
                AND G.EZCANCELFLAG              = '0'
             ) AS                           SCXMB_CNT
            <!-- START 2016/12/07 K.Kojima [QC#14204, ADD] -->
            ,B.EZINTIME    AS XX_REC_HIST_CRAT_TS_A
            ,B.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM_A
            ,B.EZUPTIME    AS XX_REC_HIST_UPD_TS_A
            ,B.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM_A
            ,B.EZTABLEID   AS XX_REC_HIST_TBL_NM_A
            <!-- END 2016/12/07 K.Kojima [QC#14204, ADD] -->
        FROM
             SVC_CONTR_BLLG           A
            ,SVC_CONTR_MTR_BLLG       B
            ,DS_CONTR_BLLG_MTR        C
            ,MTR_LB                   D
            ,SVC_CONTR_XS_MTR_BLLG    E
        WHERE
                A.GLBL_CMPY_CD                      = #glblCmpyCd#
            AND A.BILL_TO_CUST_CD                   = #billToCustCd#
            AND A.SVC_CONTR_BLLG_THRU_DT            = #svcContrBllgThruDt#
            <isNotNull property="dsContrPk">
            AND A.DS_CONTR_PK                       = #dsContrPk#
            </isNotNull>
            <isNotNull property="svcMachMstrPk">
            AND A.SVC_MACH_MSTR_PK                  = #svcMachMstrPk#
            </isNotNull>
            AND A.USG_CHRG_FLG                      = 'Y'
            AND A.EZCANCELFLAG                      = '0'
            AND A.GLBL_CMPY_CD                      = B.GLBL_CMPY_CD
            AND A.SVC_CONTR_BLLG_PK                 = B.SVC_CONTR_BLLG_PK
            AND B.EZCANCELFLAG                      = '0'
            AND B.GLBL_CMPY_CD                      = C.GLBL_CMPY_CD
            AND B.DS_CONTR_BLLG_MTR_PK              = C.DS_CONTR_BLLG_MTR_PK
            AND C.EZCANCELFLAG                      = '0'
            AND C.GLBL_CMPY_CD                      = D.GLBL_CMPY_CD
            AND C.BLLG_MTR_LB_CD                    = D.MTR_LB_CD
            AND D.EZCANCELFLAG                      = '0'
            AND B.GLBL_CMPY_CD                      = E.GLBL_CMPY_CD
            AND B.SVC_CONTR_MTR_BLLG_PK             = E.SVC_CONTR_MTR_BLLG_PK
            AND E.EZCANCELFLAG                      = '0'
        ORDER BY
             A.SVC_CONTR_BLLG_PK        ASC
            ,B.SVC_CONTR_MTR_BLLG_PK    ASC
            ,E.XS_MTR_FROM_COPY_QTY     ASC
    </statement>
    <resultMap id="result.getUsageMeterData"    class="NSAL1300_ACMsg">
        <result property="mtrLbCd_A"                column="MTR_LB_CD"                  javaType="EZDCStringItem"/>
        <result property="svcContrMtrBllgPk_A"      column="SVC_CONTR_MTR_BLLG_PK"      javaType="EZDCBigDecimalItem"/>
        <result property="svcContrBllgPk_A"         column="SVC_CONTR_BLLG_PK"          javaType="EZDCBigDecimalItem"/>
        <result property="dsContrBllgMtrPk_A"       column="DS_CONTR_BLLG_MTR_PK"       javaType="EZDCBigDecimalItem"/>
        <result property="svcContrXsMtrBllgPk_A"    column="SVC_CONTR_XS_MTR_BLLG_PK"   javaType="EZDCBigDecimalItem"/>
        <result property="contrXsCopyPk_A"          column="CONTR_XS_COPY_PK"           javaType="EZDCBigDecimalItem"/>
        <result property="mtrLbDescTxt_A"           column="MTR_LB_DESC_TXT"            javaType="EZDCStringItem"/>
        <result property="copyInclQty_A"            column="COPY_INCL_QTY"              javaType="EZDCBigDecimalItem"/>
        <result property="mtrCopyQty_A"             column="MTR_COPY_QTY"               javaType="EZDCBigDecimalItem"/>
        <result property="bllgCopyQty_A"            column="BLLG_COPY_QTY"              javaType="EZDCBigDecimalItem"/>
        <result property="xsMtrAmtRate_A"           column="XS_MTR_AMT_RATE"            javaType="EZDCBigDecimalItem"/>
        <result property="mtrChrgDealAmt_A"         column="MTR_CHRG_DEAL_AMT"          javaType="EZDCBigDecimalItem"/>
        <result property="xxTotAmt_A"               column="MTR_CHRG_DEAL_AMT"          javaType="EZDCBigDecimalItem"/>
        <result property="xsMtrCopyQty_A"           column="XS_MTR_COPY_QTY"            javaType="EZDCBigDecimalItem"/>
        <result property="xsMtrChrgDealAmt_A"       column="XS_MTR_CHRG_DEAL_AMT"       javaType="EZDCBigDecimalItem"/>
        <result property="xsChrgTpCd_A"             column="XS_CHRG_TP_CD"              javaType="EZDCStringItem"/>
        <result property="xxDtlCnt_A"               column="SCXMB_CNT"                  javaType="EZDCBigDecimalItem"/>
        <!-- START 2016/12/07 K.Kojima [QC#14204, ADD] -->
        <result property="xxRecHistCratTs_A"        column="XX_REC_HIST_CRAT_TS_A"      javaType="EZDSStringItem"/>
        <result property="xxRecHistCratByNm_A"      column="XX_REC_HIST_CRAT_BY_NM_A"   javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdTs_A"         column="XX_REC_HIST_UPD_TS_A"       javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdByNm_A"       column="XX_REC_HIST_UPD_BY_NM_A"    javaType="EZDSStringItem"/>
        <result property="xxRecHistTblNm_A"         column="XX_REC_HIST_TBL_NM_A"       javaType="EZDSStringItem"/>
        <!-- END 2016/12/07 K.Kojima [QC#14204, ADD] -->
    </resultMap>
    <typeAlias alias="NSAL1300_BSMsg" type="business.blap.NSAL1300.NSAL1300_BSMsg"/>
    <statement id="getFleetUsageMeterDetail" parameterClass="Map" resultMap="result.getFleetUsageMeterDetail">
        <!-- START 2018/05/14 K.Kojima [QC#24817,ADD] -->
        WITH MTR_FMLA_DATA AS (
            SELECT
                *
            FROM
                MTR_FMLA MF
            WHERE
                    MF.GLBL_CMPY_CD = #glblCmpyCd#
                AND MF.EZCANCELFLAG = '0'
        )
        ,MTR_FMLA_INFO AS (
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_01 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_01 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_02 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_02 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_03 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_03 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_04 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_04 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_05 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_05 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_06 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_06 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_07 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_07 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_08 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_08 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_09 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_09 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_10 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_10 IS NOT NULL
        )
        <!-- END 2018/05/14 K.Kojima [QC#24817,ADD] -->
        SELECT
             BILL_TO_CUST_CD
            ,SVC_CONTR_BLLG_THRU_DT
            ,DS_CONTR_PK
            ,DS_CONTR_NUM
            ,DS_CONTR_CATG_CD
            ,SVC_MACH_MSTR_PK
            ,MDSE_CD
            ,SVC_CONFIG_MSTR_PK
            ,SVC_MACH_SQ_NUM
            ,SER_NUM
            ,SVC_PHYS_MTR_PK
            ,DS_MTR_READ_TP_CD
            ,PREV_MTR_READ_DT
            ,PREV_READ_MTR_CNT
            ,SVC_PHYS_MTR_READ_PK
            ,PHYS_MTR_ID
            ,MTR_CLS_TP_CD
            ,CURT_MTR_READ_DT
            ,CURT_READ_MTR_CNT
            ,MTR_ENTRY_CMNT_TXT
            ,SVC_PHYS_MTR_READ_GRP_SQ
            ,DS_MTR_READ_TP_SORT_NUM
            ,DS_MTR_READ_TP_DESC_TXT
            ,MTR_LB_DESC_TXT
            ,MTR_LB_CD
            ,CREATED_BY
            ,MTR_READ_SRC_TP_CD
            ,MTR_READ_SRC_TP_SORT_NUM
            ,CASE WHEN
                FIRST_MTR_READ_DT >= PAST_MTR_READ_DT THEN FIRST_MTR_READ_DT
             ELSE PAST_MTR_READ_DT
             END                      START_MTR_READ_DT
            <!-- START 2016/12/07 K.Kojima [QC#14204, ADD] -->
            ,XX_REC_HIST_CRAT_TS_B
            ,XX_REC_HIST_CRAT_BY_NM_B
            ,XX_REC_HIST_UPD_TS_B
            ,XX_REC_HIST_UPD_BY_NM_B
            ,XX_REC_HIST_TBL_NM_B
            <!-- END 2016/12/07 K.Kojima [QC#14204, ADD] -->
        FROM (
            SELECT
                 A.BILL_TO_CUST_CD
                ,A.SVC_CONTR_BLLG_THRU_DT
                ,C.DS_CONTR_PK
                ,C.DS_CONTR_NUM
                ,C.DS_CONTR_CATG_CD
                ,D.SVC_MACH_MSTR_PK
                ,D.MDSE_CD
                ,D.SVC_CONFIG_MSTR_PK
                ,D.SVC_MACH_SQ_NUM
                ,D.SER_NUM
                ,E.SVC_PHYS_MTR_PK
                ,F.DS_MTR_READ_TP_CD
                ,F.MTR_READ_DT                              AS PREV_MTR_READ_DT
                ,F.READ_MTR_CNT                             AS PREV_READ_MTR_CNT
                ,G.SVC_PHYS_MTR_READ_PK
                ,G.PHYS_MTR_ID
                ,G.MTR_CLS_TP_CD
                ,G.MTR_READ_DT                              AS CURT_MTR_READ_DT
                ,G.READ_MTR_CNT                             AS CURT_READ_MTR_CNT
                ,G.MTR_ENTRY_CMNT_TXT
                ,G.SVC_PHYS_MTR_READ_GRP_SQ
                ,H.DS_MTR_READ_TP_SORT_NUM
                ,H.DS_MTR_READ_TP_DESC_TXT
                ,I.MTR_LB_DESC_TXT
                ,I.MTR_LB_CD
                ,CASE WHEN 
                    K.PSN_FIRST_NM || K.PSN_LAST_NM IS NULL THEN L.MTR_READ_SRC_TP_DESC_TXT
                 ELSE
                    K.PSN_FIRST_NM || ' ' || K.PSN_LAST_NM
                 END                                        AS CREATED_BY
                ,L.MTR_READ_SRC_TP_CD
                ,L.MTR_READ_SRC_TP_SORT_NUM
                ,(SELECT
                    MIN(M.MTR_READ_DT)
                  FROM SVC_PHYS_MTR_READ M
                  WHERE
                        M.GLBL_CMPY_CD      = A.GLBL_CMPY_CD 
                    AND M.SVC_MACH_MSTR_PK  = D.SVC_MACH_MSTR_PK
                    AND M.DS_CONTR_DTL_PK   = A.DS_CONTR_DTL_PK
                    AND M.MTR_LB_CD         = I.MTR_LB_CD
                    AND M.EZCANCELFLAG      = '0'
                 ) AS FIRST_MTR_READ_DT
                ,TO_CHAR(ADD_MONTHS(TO_DATE(F.MTR_READ_DT,'yyyymmdd'), #pastMonths#),'yyyymmdd') AS PAST_MTR_READ_DT
                <!-- START 2016/12/07 K.Kojima [QC#14204, ADD] -->
                ,G.EZINTIME    AS XX_REC_HIST_CRAT_TS_B
                ,G.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM_B
                ,G.EZUPTIME    AS XX_REC_HIST_UPD_TS_B
                ,G.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM_B
                ,G.EZTABLEID   AS XX_REC_HIST_TBL_NM_B
                <!-- END 2016/12/07 K.Kojima [QC#14204, ADD] -->
            FROM
                 SVC_CONTR_BLLG                 A
                ,SVC_CONTR_MTR_BLLG             B
                ,DS_CONTR                       C
                ,SVC_MACH_MSTR                  D
                ,CONTR_PHYS_BLLG_MTR_RELN       E
                ,SVC_PHYS_MTR_READ              F
                ,SVC_PHYS_MTR_READ              G
                ,DS_MTR_READ_TP                 H
                ,MTR_LB                         I
                ,MTR_LB                         J
                ,S21_PSN                        K
                ,MTR_READ_SRC_TP                L
                <!-- START 2018/05/14 K.Kojima [QC#24817,ADD] -->
                ,SVC_PHYS_MTR                   SPM
                <!-- END 2018/05/14 K.Kojima [QC#24817,ADD] -->
            WHERE
                    A.GLBL_CMPY_CD                      = #glblCmpyCd#
                AND A.PRNT_SVC_CONTR_BLLG_PK            = #svcContrBllgPk#
                AND A.EZCANCELFLAG                      = '0'
                AND A.GLBL_CMPY_CD                      = B.GLBL_CMPY_CD
                AND A.SVC_CONTR_BLLG_PK                 = B.SVC_CONTR_BLLG_PK
                AND B.EZCANCELFLAG                      = '0'
                AND A.GLBL_CMPY_CD                      = C.GLBL_CMPY_CD
                AND A.DS_CONTR_PK                       = C.DS_CONTR_PK
                AND C.EZCANCELFLAG                      = '0'
                AND A.GLBL_CMPY_CD                      = D.GLBL_CMPY_CD
                AND A.SVC_MACH_MSTR_PK                  = D.SVC_MACH_MSTR_PK
                <isNotNull property="flterSerial">
                AND D.SER_NUM                           LIKE #flterSerial#
                </isNotNull>
                AND D.EZCANCELFLAG                      = '0'
                AND D.GLBL_CMPY_CD                      = E.GLBL_CMPY_CD
                <!-- START 2018/03/12 U.Kim [QC#24672, ADD] -->
                AND A.DS_CONTR_DTL_PK                   = E.DS_CONTR_DTL_PK
                <!-- END 2018/03/12 U.Kim [QC#24672, ADD] -->
                AND D.SVC_MACH_MSTR_PK                  = E.MACH_MSTR_PK
                AND E.EZCANCELFLAG                      = '0'
                AND B.GLBL_CMPY_CD                      = F.GLBL_CMPY_CD
                AND B.PREV_PHYS_MTR_READ_GRP_SQ         = F.SVC_PHYS_MTR_READ_GRP_SQ
                AND E.SVC_PHYS_MTR_PK                   = F.SVC_PHYS_MTR_PK
                AND F.EZCANCELFLAG                      = '0'
                AND B.GLBL_CMPY_CD                      = G.GLBL_CMPY_CD
                AND B.SVC_PHYS_MTR_READ_GRP_SQ          = G.SVC_PHYS_MTR_READ_GRP_SQ
                AND E.SVC_PHYS_MTR_PK                   = G.SVC_PHYS_MTR_PK
                AND G.EZCANCELFLAG                      = '0'
                AND G.GLBL_CMPY_CD                      = H.GLBL_CMPY_CD
                AND G.DS_MTR_READ_TP_CD                 = H.DS_MTR_READ_TP_CD
                AND H.EZCANCELFLAG                      = '0'
                AND G.GLBL_CMPY_CD                      = I.GLBL_CMPY_CD
                AND G.MTR_LB_CD                         = I.MTR_LB_CD
                <isNotNull property="flterCounterName">
                AND I.MTR_LB_DESC_TXT                   LIKE #flterCounterName#
                </isNotNull>
                AND I.EZCANCELFLAG                      = '0'
                AND E.GLBL_CMPY_CD                      = J.GLBL_CMPY_CD(+)
                AND E.BLLG_MTR_LB_CD                    = J.MTR_LB_CD(+)
                <isNotNull property="flterCounterType">
                AND J.MTR_LB_DESC_TXT                   LIKE #flterCounterType#
                </isNotNull>
                AND J.EZCANCELFLAG(+)                   = '0'
                AND G.GLBL_CMPY_CD                      = K.GLBL_CMPY_CD(+)
                AND G.EZINUSERID                        = K.PSN_CD(+)
                AND K.EZCANCELFLAG(+)                   = '0'
                AND G.GLBL_CMPY_CD                      = L.GLBL_CMPY_CD
                AND G.MTR_READ_SRC_TP_CD                = L.MTR_READ_SRC_TP_CD
                AND L.EZCANCELFLAG                      = '0'
                <!-- START 2018/05/14 K.Kojima [QC#24817,ADD] -->
                AND E.GLBL_CMPY_CD                      = SPM.GLBL_CMPY_CD
                AND E.SVC_PHYS_MTR_PK                   = SPM.SVC_PHYS_MTR_PK
                AND SPM.EZCANCELFLAG                    = '0'
                AND NOT EXISTS(
                    SELECT
                        1
                    FROM
                        MTR_FMLA_DATA MFD
                    WHERE
                            MFD.MTR_GRP_PK   = SPM.MTR_GRP_PK
                        AND MFD.MTR_LB_CD    = SPM.MDL_MTR_LB_CD
                )
                AND (
                    E.BLLG_MTR_LB_CD IS NOT NULL
                    OR
                    EXISTS(
                        SELECT
                            1
                        FROM
                            MTR_FMLA_INFO MFI
                        WHERE
                                MFI.MTR_GRP_PK     = SPM.MTR_GRP_PK
                            AND MFI.FMLA_MTR_LB_CD = SPM.MDL_MTR_LB_CD
                    )
                )
                <!-- END 2018/05/14 K.Kojima [QC#24817,ADD] -->
            ORDER BY
                 D.SER_NUM      ASC
                ,I.MTR_LB_CD    ASC )
        WHERE
            ROWNUM  &lt;= #limitCnt#
    </statement>
    <resultMap id="result.getFleetUsageMeterDetail"    class="NSAL1300_BSMsg">
        <result property="dsContrPk_B"              column="DS_CONTR_PK"                    javaType="EZDSBigDecimalItem"/>
        <result property="dsContrNum_B"             column="DS_CONTR_NUM"                   javaType="EZDSStringItem"/>
        <result property="mtrLbCd_B"                column="MTR_LB_CD"                      javaType="EZDSStringItem"/>
        <result property="svcMachMstrPk_B"          column="SVC_MACH_MSTR_PK"               javaType="EZDSBigDecimalItem"/>
        <result property="serNum_B"                 column="SER_NUM"                        javaType="EZDSStringItem"/>
        <result property="mdseCd_B"                 column="MDSE_CD"                        javaType="EZDSStringItem"/>
        <result property="svcConfigMstrPk_B"        column="SVC_CONFIG_MSTR_PK"             javaType="EZDSBigDecimalItem"/>
        <result property="svcMachSqNum_B"           column="SVC_MACH_SQ_NUM"                javaType="EZDSBigDecimalItem"/>
        <result property="dsMtrReadTpCd_B"          column="DS_MTR_READ_TP_CD"              javaType="EZDSStringItem"/>
        <result property="dsMtrReadTpSortNum_B"     column="DS_MTR_READ_TP_SORT_NUM"        javaType="EZDSBigDecimalItem"/>
        <result property="svcPhysMtrPk_B"           column="SVC_PHYS_MTR_PK"                javaType="EZDSBigDecimalItem"/>
        <result property="physMtrId_B"              column="PHYS_MTR_ID"                    javaType="EZDSStringItem"/>
        <result property="mtrClsTpCd_B"             column="MTR_CLS_TP_CD"                  javaType="EZDSStringItem"/>
        <result property="mtrReadSrcTpCd_B"         column="MTR_READ_SRC_TP_CD"             javaType="EZDSStringItem"/>
        <result property="svcPhysMtrReadGrpSq_B"    column="SVC_PHYS_MTR_READ_GRP_SQ"       javaType="EZDSBigDecimalItem"/>
        <result property="mtrReadSrcTpSortNum_B"    column="MTR_READ_SRC_TP_SORT_NUM"       javaType="EZDSBigDecimalItem"/>
        <result property="dsMtrReadTpDescTxt_B"     column="DS_MTR_READ_TP_DESC_TXT"        javaType="EZDSStringItem"/>
        <result property="mtrReadDt_BL"             column="PREV_MTR_READ_DT"               javaType="EZDSStringItem"/>
        <result property="mtrReadDt_B"              column="CURT_MTR_READ_DT"               javaType="EZDSStringItem"/>
        <result property="mtrLbDescTxt_B"           column="MTR_LB_DESC_TXT"                javaType="EZDSStringItem"/>
        <result property="readMtrCnt_BL"            column="PREV_READ_MTR_CNT"              javaType="EZDSBigDecimalItem"/>
        <result property="readMtrCnt_B"             column="CURT_READ_MTR_CNT"              javaType="EZDSBigDecimalItem"/>
        <result property="mtrReadSrcTpDescTxt_B"    column="CREATED_BY"                     javaType="EZDSStringItem"/>
        <result property="mtrEntryCmntTxt_B"        column="MTR_ENTRY_CMNT_TXT"             javaType="EZDSStringItem"/>
        <result property="billToCustCd_B"           column="BILL_TO_CUST_CD"                javaType="EZDSStringItem"/>
        <result property="dsContrCatgCd_B"          column="DS_CONTR_CATG_CD"               javaType="EZDSStringItem"/>
        <result property="svcContrBllgThruDt_B"     column="SVC_CONTR_BLLG_THRU_DT"         javaType="EZDSStringItem"/>
        <result property="svcPhysMtrReadPk_B"       column="SVC_PHYS_MTR_READ_PK"           javaType="EZDSBigDecimalItem"/>
        <!-- START 2016/12/07 K.Kojima [QC#14204, ADD] -->
        <result property="xxRecHistCratTs_B"        column="XX_REC_HIST_CRAT_TS_B"          javaType="EZDSStringItem"/>
        <result property="xxRecHistCratByNm_B"      column="XX_REC_HIST_CRAT_BY_NM_B"       javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdTs_B"         column="XX_REC_HIST_UPD_TS_B"           javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdByNm_B"       column="XX_REC_HIST_UPD_BY_NM_B"        javaType="EZDSStringItem"/>
        <result property="xxRecHistTblNm_B"         column="XX_REC_HIST_TBL_NM_B"           javaType="EZDSStringItem"/>
        <!-- END 2016/12/07 K.Kojima [QC#14204, ADD] -->
    </resultMap>

    <statement id="getNotFleetUsageMeterDetail" parameterClass="Map" resultMap="result.getNotFleetUsageMeterDetail">
        <!-- START 2018/05/14 K.Kojima [QC#24817,ADD] -->
        WITH MTR_FMLA_DATA AS (
            SELECT
                *
            FROM
                MTR_FMLA MF
            WHERE
                    MF.GLBL_CMPY_CD = #glblCmpyCd#
                AND MF.EZCANCELFLAG = '0'
        )
        ,MTR_FMLA_INFO AS (
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_01 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_01 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_02 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_02 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_03 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_03 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_04 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_04 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_05 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_05 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_06 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_06 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_07 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_07 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_08 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_08 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_09 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_09 IS NOT NULL UNION
            SELECT A.MTR_GRP_PK,A.FMLA_MTR_LB_CD_10 AS FMLA_MTR_LB_CD FROM MTR_FMLA_DATA A WHERE A.FMLA_MTR_LB_CD_10 IS NOT NULL
        )
        <!-- END 2018/05/14 K.Kojima [QC#24817,ADD] -->
        SELECT
             BILL_TO_CUST_CD
            ,SVC_CONTR_BLLG_THRU_DT
            ,DS_CONTR_PK
            ,DS_CONTR_NUM
            ,DS_CONTR_CATG_CD
            ,SVC_MACH_MSTR_PK
            ,MDSE_CD
            ,SVC_CONFIG_MSTR_PK
            ,SVC_MACH_SQ_NUM
            ,SER_NUM
            ,SVC_PHYS_MTR_PK
            ,DS_MTR_READ_TP_CD
            ,PREV_MTR_READ_DT
            ,PREV_READ_MTR_CNT
            ,SVC_PHYS_MTR_READ_PK
            ,PHYS_MTR_ID
            ,MTR_CLS_TP_CD
            ,CURT_MTR_READ_DT
            ,CURT_READ_MTR_CNT
            ,MTR_ENTRY_CMNT_TXT
            ,SVC_PHYS_MTR_READ_GRP_SQ
            ,DS_MTR_READ_TP_SORT_NUM
            ,DS_MTR_READ_TP_DESC_TXT
            ,MTR_LB_DESC_TXT
            ,MTR_LB_CD
            ,CREATED_BY
            ,MTR_READ_SRC_TP_CD
            ,MTR_READ_SRC_TP_SORT_NUM
            ,CASE WHEN
                FIRST_MTR_READ_DT >= PAST_MTR_READ_DT THEN FIRST_MTR_READ_DT
             ELSE PAST_MTR_READ_DT
             END                      START_MTR_READ_DT
            <!-- START 2016/12/07 K.Kojima [QC#14204, ADD] -->
            ,XX_REC_HIST_CRAT_TS_B
            ,XX_REC_HIST_CRAT_BY_NM_B
            ,XX_REC_HIST_UPD_TS_B
            ,XX_REC_HIST_UPD_BY_NM_B
            ,XX_REC_HIST_TBL_NM_B
            <!-- END 2016/12/07 K.Kojima [QC#14204, ADD] -->
        FROM (
            SELECT
                 A.BILL_TO_CUST_CD
                ,A.SVC_CONTR_BLLG_THRU_DT
                ,C.DS_CONTR_PK
                ,C.DS_CONTR_NUM
                ,C.DS_CONTR_CATG_CD
                ,D.SVC_MACH_MSTR_PK
                ,D.MDSE_CD
                ,D.SVC_CONFIG_MSTR_PK
                ,D.SVC_MACH_SQ_NUM
                ,D.SER_NUM
                ,E.SVC_PHYS_MTR_PK
                ,F.DS_MTR_READ_TP_CD
                ,F.MTR_READ_DT                              AS PREV_MTR_READ_DT
                ,F.READ_MTR_CNT                             AS PREV_READ_MTR_CNT
                ,G.SVC_PHYS_MTR_READ_PK
                ,G.PHYS_MTR_ID
                ,G.MTR_CLS_TP_CD
                ,G.MTR_READ_DT                              AS CURT_MTR_READ_DT
                ,G.READ_MTR_CNT                             AS CURT_READ_MTR_CNT
                ,G.MTR_ENTRY_CMNT_TXT
                ,G.SVC_PHYS_MTR_READ_GRP_SQ
                ,H.DS_MTR_READ_TP_SORT_NUM
                ,H.DS_MTR_READ_TP_DESC_TXT
                ,I.MTR_LB_DESC_TXT
                ,I.MTR_LB_CD
                ,CASE WHEN 
                    K.PSN_FIRST_NM || K.PSN_LAST_NM IS NULL THEN L.MTR_READ_SRC_TP_DESC_TXT
                 ELSE
                    K.PSN_FIRST_NM || ' ' || K.PSN_LAST_NM
                 END                                        AS CREATED_BY
                ,L.MTR_READ_SRC_TP_CD
                ,L.MTR_READ_SRC_TP_SORT_NUM
                ,(SELECT
                    MIN(M.MTR_READ_DT)
                  FROM SVC_PHYS_MTR_READ M
                  WHERE
                        M.GLBL_CMPY_CD      = A.GLBL_CMPY_CD 
                    AND M.SVC_MACH_MSTR_PK  = D.SVC_MACH_MSTR_PK
                    AND M.DS_CONTR_DTL_PK   = A.DS_CONTR_DTL_PK
                    AND M.MTR_LB_CD         = I.MTR_LB_CD
                    AND M.EZCANCELFLAG      = '0'
                 ) AS FIRST_MTR_READ_DT
                ,TO_CHAR(ADD_MONTHS(TO_DATE(F.MTR_READ_DT,'yyyymmdd'), #pastMonths#),'yyyymmdd') AS PAST_MTR_READ_DT
                <!-- START 2016/12/07 K.Kojima [QC#14204, ADD] -->
                ,G.EZINTIME    AS XX_REC_HIST_CRAT_TS_B
                ,G.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM_B
                ,G.EZUPTIME    AS XX_REC_HIST_UPD_TS_B
                ,G.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM_B
                ,G.EZTABLEID   AS XX_REC_HIST_TBL_NM_B
                <!-- END 2016/12/07 K.Kojima [QC#14204, ADD] -->
            FROM
                 SVC_CONTR_BLLG                 A
                ,SVC_CONTR_MTR_BLLG             B
                ,DS_CONTR                       C
                ,SVC_MACH_MSTR                  D
                ,CONTR_PHYS_BLLG_MTR_RELN       E
                ,SVC_PHYS_MTR_READ              F
                ,SVC_PHYS_MTR_READ              G
                ,DS_MTR_READ_TP                 H
                ,MTR_LB                         I
                ,MTR_LB                         J
                ,S21_PSN                        K
                ,MTR_READ_SRC_TP                L
                <!-- START 2018/05/14 K.Kojima [QC#24817,ADD] -->
                ,SVC_PHYS_MTR                   SPM
                <!-- END 2018/05/14 K.Kojima [QC#24817,ADD] -->
            WHERE
                    A.GLBL_CMPY_CD                      = #glblCmpyCd#
                AND A.SVC_CONTR_BLLG_PK                 = #svcContrBllgPk#
                AND A.EZCANCELFLAG                      = '0'
                AND A.GLBL_CMPY_CD                      = B.GLBL_CMPY_CD
                AND A.SVC_CONTR_BLLG_PK                 = B.SVC_CONTR_BLLG_PK
                AND B.EZCANCELFLAG                      = '0'
                AND A.GLBL_CMPY_CD                      = C.GLBL_CMPY_CD
                AND A.DS_CONTR_PK                       = C.DS_CONTR_PK
                AND C.EZCANCELFLAG                      = '0'
                AND A.GLBL_CMPY_CD                      = D.GLBL_CMPY_CD
                AND A.SVC_MACH_MSTR_PK                  = D.SVC_MACH_MSTR_PK
                <isNotNull property="flterSerial">
                AND D.SER_NUM                           LIKE #flterSerial#
                </isNotNull>
                AND D.EZCANCELFLAG                      = '0'
                AND D.GLBL_CMPY_CD                      = E.GLBL_CMPY_CD
                <!-- START 2018/03/12 U.Kim [QC#24672, ADD] -->
                AND A.DS_CONTR_DTL_PK                   = E.DS_CONTR_DTL_PK
                <!-- END 2018/03/12 U.Kim [QC#24672, ADD] -->
                AND D.SVC_MACH_MSTR_PK                  = E.MACH_MSTR_PK
                AND E.EZCANCELFLAG                      = '0'
                AND B.GLBL_CMPY_CD                      = F.GLBL_CMPY_CD
                AND B.PREV_PHYS_MTR_READ_GRP_SQ         = F.SVC_PHYS_MTR_READ_GRP_SQ
                AND E.SVC_PHYS_MTR_PK                   = F.SVC_PHYS_MTR_PK
                AND F.EZCANCELFLAG                      = '0'
                AND B.GLBL_CMPY_CD                      = G.GLBL_CMPY_CD
                AND B.SVC_PHYS_MTR_READ_GRP_SQ          = G.SVC_PHYS_MTR_READ_GRP_SQ
                AND E.SVC_PHYS_MTR_PK                   = G.SVC_PHYS_MTR_PK
                AND G.EZCANCELFLAG                      = '0'
                AND G.GLBL_CMPY_CD                      = H.GLBL_CMPY_CD
                AND G.DS_MTR_READ_TP_CD                 = H.DS_MTR_READ_TP_CD
                AND H.EZCANCELFLAG                      = '0'
                AND G.GLBL_CMPY_CD                      = I.GLBL_CMPY_CD
                AND G.MTR_LB_CD                         = I.MTR_LB_CD
                <isNotNull property="flterCounterName">
                AND I.MTR_LB_DESC_TXT                   LIKE #flterCounterName#
                </isNotNull>
                AND I.EZCANCELFLAG                      = '0'
                AND E.GLBL_CMPY_CD                      = J.GLBL_CMPY_CD(+)
                AND E.BLLG_MTR_LB_CD                    = J.MTR_LB_CD(+)
                <isNotNull property="flterCounterType">
                AND J.MTR_LB_DESC_TXT                   LIKE #flterCounterType#
                </isNotNull>
                AND J.EZCANCELFLAG(+)                   = '0'
                AND G.GLBL_CMPY_CD                      = K.GLBL_CMPY_CD(+)
                AND G.EZINUSERID                        = K.PSN_CD(+)
                AND K.EZCANCELFLAG(+)                   = '0'
                AND G.GLBL_CMPY_CD                      = L.GLBL_CMPY_CD
                AND G.MTR_READ_SRC_TP_CD                = L.MTR_READ_SRC_TP_CD
                AND L.EZCANCELFLAG                      = '0'
                <!-- START 2018/05/14 K.Kojima [QC#24817,ADD] -->
                AND E.GLBL_CMPY_CD                      = SPM.GLBL_CMPY_CD
                AND E.SVC_PHYS_MTR_PK                   = SPM.SVC_PHYS_MTR_PK
                AND SPM.EZCANCELFLAG                    = '0'
                AND NOT EXISTS(
                    SELECT
                        1
                    FROM
                        MTR_FMLA_DATA MFD
                    WHERE
                            MFD.MTR_GRP_PK   = SPM.MTR_GRP_PK
                        AND MFD.MTR_LB_CD    = SPM.MDL_MTR_LB_CD
                )
                AND (
                    E.BLLG_MTR_LB_CD IS NOT NULL
                    OR
                    EXISTS(
                        SELECT
                            1
                        FROM
                            MTR_FMLA_INFO MFI
                        WHERE
                                MFI.MTR_GRP_PK     = SPM.MTR_GRP_PK
                            AND MFI.FMLA_MTR_LB_CD = SPM.MDL_MTR_LB_CD
                    )
                )
                <!-- END 2018/05/14 K.Kojima [QC#24817,ADD] -->
            ORDER BY
                 D.SER_NUM      ASC
                ,I.MTR_LB_CD    ASC )
        WHERE
            ROWNUM  &lt;= #limitCnt#
    </statement>
    <resultMap id="result.getNotFleetUsageMeterDetail"    class="NSAL1300_BSMsg">
        <result property="dsContrPk_B"              column="DS_CONTR_PK"                    javaType="EZDSBigDecimalItem"/>
        <result property="dsContrNum_B"             column="DS_CONTR_NUM"                   javaType="EZDSStringItem"/>
        <result property="mtrLbCd_B"                column="MTR_LB_CD"                      javaType="EZDSStringItem"/>
        <result property="svcMachMstrPk_B"          column="SVC_MACH_MSTR_PK"               javaType="EZDSBigDecimalItem"/>
        <result property="serNum_B"                 column="SER_NUM"                        javaType="EZDSStringItem"/>
        <result property="mdseCd_B"                 column="MDSE_CD"                        javaType="EZDSStringItem"/>
        <result property="svcConfigMstrPk_B"        column="SVC_CONFIG_MSTR_PK"             javaType="EZDSBigDecimalItem"/>
        <result property="svcMachSqNum_B"           column="SVC_MACH_SQ_NUM"                javaType="EZDSBigDecimalItem"/>
        <result property="dsMtrReadTpCd_B"          column="DS_MTR_READ_TP_CD"              javaType="EZDSStringItem"/>
        <result property="dsMtrReadTpSortNum_B"     column="DS_MTR_READ_TP_SORT_NUM"        javaType="EZDSBigDecimalItem"/>
        <result property="svcPhysMtrPk_B"           column="SVC_PHYS_MTR_PK"                javaType="EZDSBigDecimalItem"/>
        <result property="physMtrId_B"              column="PHYS_MTR_ID"                    javaType="EZDSStringItem"/>
        <result property="mtrClsTpCd_B"             column="MTR_CLS_TP_CD"                  javaType="EZDSStringItem"/>
        <result property="mtrReadSrcTpCd_B"         column="MTR_READ_SRC_TP_CD"             javaType="EZDSStringItem"/>
        <result property="svcPhysMtrReadGrpSq_B"    column="SVC_PHYS_MTR_READ_GRP_SQ"       javaType="EZDSBigDecimalItem"/>
        <result property="mtrReadSrcTpSortNum_B"    column="MTR_READ_SRC_TP_SORT_NUM"       javaType="EZDSBigDecimalItem"/>
        <result property="dsMtrReadTpDescTxt_B"     column="DS_MTR_READ_TP_DESC_TXT"        javaType="EZDSStringItem"/>
        <result property="mtrReadDt_BL"             column="PREV_MTR_READ_DT"               javaType="EZDSStringItem"/>
        <result property="mtrReadDt_B"              column="CURT_MTR_READ_DT"               javaType="EZDSStringItem"/>
        <result property="mtrLbDescTxt_B"           column="MTR_LB_DESC_TXT"                javaType="EZDSStringItem"/>
        <result property="readMtrCnt_BL"            column="PREV_READ_MTR_CNT"              javaType="EZDSBigDecimalItem"/>
        <result property="readMtrCnt_B"             column="CURT_READ_MTR_CNT"              javaType="EZDSBigDecimalItem"/>
        <result property="mtrReadSrcTpDescTxt_B"    column="CREATED_BY"                     javaType="EZDSStringItem"/>
        <result property="mtrEntryCmntTxt_B"        column="MTR_ENTRY_CMNT_TXT"             javaType="EZDSStringItem"/>
        <result property="billToCustCd_B"           column="BILL_TO_CUST_CD"                javaType="EZDSStringItem"/>
        <result property="dsContrCatgCd_B"          column="DS_CONTR_CATG_CD"               javaType="EZDSStringItem"/>
        <result property="svcContrBllgThruDt_B"     column="SVC_CONTR_BLLG_THRU_DT"         javaType="EZDSStringItem"/>
        <result property="svcPhysMtrReadPk_B"       column="SVC_PHYS_MTR_READ_PK"           javaType="EZDSBigDecimalItem"/>
        <result property="mtrReadDt_BS"             column="START_MTR_READ_DT"              javaType="EZDSStringItem"/>
        <!-- START 2016/12/07 K.Kojima [QC#14204, ADD] -->
        <result property="xxRecHistCratTs_B"        column="XX_REC_HIST_CRAT_TS_B"          javaType="EZDSStringItem"/>
        <result property="xxRecHistCratByNm_B"      column="XX_REC_HIST_CRAT_BY_NM_B"       javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdTs_B"         column="XX_REC_HIST_UPD_TS_B"           javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdByNm_B"       column="XX_REC_HIST_UPD_BY_NM_B"        javaType="EZDSStringItem"/>
        <result property="xxRecHistTblNm_B"         column="XX_REC_HIST_TBL_NM_B"           javaType="EZDSStringItem"/>
        <!-- END 2016/12/07 K.Kojima [QC#14204, ADD] -->
    </resultMap>

    <statement id="getPastSvcPhysMtrRead" parameterClass="Map" resultClass="Map">
        SELECT
             A.MTR_READ_DT
            ,A.READ_MTR_CNT
        FROM
            SVC_PHYS_MTR_READ A
        WHERE
                A.GLBL_CMPY_CD              = #glblCmpyCd#
            AND A.SVC_MACH_MSTR_PK          = #svcMachMstrPk#
            AND A.MTR_LB_CD                 = #mtrLbCd#
            AND A.VLD_MTR_FLG               = 'Y'
            AND A.DS_MTR_READ_TP_GRP_CD     = #dsMtrReadTpGrp#
            AND A.MTR_READ_DT               &gt;= #mtrReadDtFr#
            AND A.MTR_READ_DT               &lt; #mtrReadDtTo#
            AND A.EZCANCELFLAG              = '0'
        ORDER BY
             A.MTR_READ_DT ASC
            ,A.SVC_PHYS_MTR_READ_GRP_SQ ASC
    </statement>

    <statement id="getSvcPhysMtrRead" parameterClass="Map" resultClass="Map">
        SELECT
             A.READ_MTR_CNT
            ,A.SVC_PHYS_MTR_PK
            ,A.SVC_PHYS_MTR_READ_PK
            ,A.MTR_LB_CD
            ,A.MTR_READ_DT
        FROM
            SVC_PHYS_MTR_READ A
        WHERE
                A.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND A.SVC_PHYS_MTR_READ_GRP_SQ      = #svcPhysMtrReadGrpSq#
            AND A.EZCANCELFLAG                  = '0'
        </statement>

    <statement id="getSvcPhysMtrReadGrpSq" parameterClass="Map" resultClass="Map">
        SELECT
             A.SVC_PHYS_MTR_READ_GRP_SQ
        FROM
            SVC_PHYS_MTR_READ A
        WHERE
                A.GLBL_CMPY_CD              = #glblCmpyCd#
            AND A.SVC_MACH_MSTR_PK          = #svcMachMstrPk#
            AND A.SVC_PHYS_MTR_PK           = #svcPhysMtrPk#
            AND A.MTR_READ_DT               &gt;= #startReadDt#
            AND A.MTR_READ_DT               &lt;= #endReadDt#
            AND NVL(A.READ_MTR_CNT, 0)      &gt; #startReadMtrCnt#
            AND NVL(A.READ_MTR_CNT, 0)      &gt; #newReadMtrCnt#
            AND A.VLD_MTR_FLG               = 'Y'
            AND A.EZCANCELFLAG              = '0'
        </statement>

    <!-- START 2018/05/14 K.Kojima [QC#24817,ADD] -->
    <statement id="getSvcPhysMtrReadForMeterEntry" parameterClass="Map" resultClass="Map">
        SELECT
             SPMR.READ_MTR_CNT
            ,SPMR.SVC_PHYS_MTR_PK
            ,SPMR.SVC_PHYS_MTR_READ_PK
            ,SPMR.MTR_LB_CD
            ,SPMR.MTR_READ_DT
        FROM
             SVC_PHYS_MTR_READ SPMR
            ,SVC_PHYS_MTR      SPM
        WHERE
                SPMR.GLBL_CMPY_CD               = #glblCmpyCd#
            AND SPMR.SVC_PHYS_MTR_READ_GRP_SQ   = #svcPhysMtrReadGrpSq#
            AND SPMR.EZCANCELFLAG               = '0'
            AND SPMR.GLBL_CMPY_CD               = SPM.GLBL_CMPY_CD
            AND SPMR.SVC_PHYS_MTR_PK            = SPM.SVC_PHYS_MTR_PK
            AND SPM.EZCANCELFLAG                = '0'
            AND NOT EXISTS(
                SELECT
                    1
                FROM
                    MTR_FMLA MF
                WHERE
                        MF.GLBL_CMPY_CD = SPM.GLBL_CMPY_CD
                    AND MF.MTR_GRP_PK   = SPM.MTR_GRP_PK
                    AND MF.MTR_LB_CD    = SPM.MDL_MTR_LB_CD
                    AND MF.EZCANCELFLAG = '0'
            )
    </statement>
    <!-- END 2018/05/14 K.Kojima [QC#24817,ADD] -->
</sqlMap>
