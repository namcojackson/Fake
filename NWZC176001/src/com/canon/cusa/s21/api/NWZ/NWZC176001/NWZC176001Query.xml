<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWZC176001Query">

    <statement id="cntBuyoutBillingHold" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(H.GLBL_CMPY_CD)
        FROM
            HLD H
        WHERE
            H.GLBL_CMPY_CD         = #glblCmpyCd#
        AND H.CPO_ORD_NUM          = #dsCpoDtlTMsg.cpoOrdNum#
        AND H.CPO_DTL_LINE_NUM     = #dsCpoDtlTMsg.cpoDtlLineNum#
        AND H.CPO_DTL_LINE_SUB_NUM = #dsCpoDtlTMsg.cpoDtlLineSubNum#
        AND H.HLD_RSN_CD           = #hldRsnCd#
        AND H.EZCANCELFLAG         = '0'
    </statement>

    <statement id="cntCreditOrder" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(CD.GLBL_CMPY_CD)
        FROM
            CPO_DTL CD
        WHERE
            CD.GLBL_CMPY_CD         = #pMsg.glblCmpyCd#
        AND CD.EZCANCELFLAG         = '0'
        AND CD.CPO_ORD_NUM          = #pMsg.cpoOrdNum_I#
        AND CD.ORD_LINE_STS_CD      &lt;&gt; #ordLineStsCd#
        AND CD.CR_REBIL_CD          = #crRebilCd#
    </statement>
    
    <statement id="getDsCpoDtlInfo" parameterClass="Map" resultClass="Map">
        SELECT
            CD.CPO_ORD_NUM
           ,CD.CPO_DTL_LINE_NUM
           ,CD.CPO_DTL_LINE_SUB_NUM
        FROM
            CPO_DTL     CD
           ,CPO         DC
           ,DS_ORD_LINE_PROC_DFN  DPD
           ,ORD_PROC_TP  OPT
        WHERE
            CD.GLBL_CMPY_CD          = #pMsg.glblCmpyCd#
        AND CD.EZCANCELFLAG          = '0'
        AND CD.CPO_ORD_NUM           = #dsCpoDtlTMsg.cpoOrdNum#
        AND CD.ORD_LINE_STS_CD       &lt;&gt; #ordLineStsCd#
        <isNotNull property="dsCpoDtlTMsg.dsCpoConfigPk">
        AND CD.DS_CPO_CONFIG_PK     = #dsCpoDtlTMsg.dsCpoConfigPk#
        </isNotNull>
        <isNull property="dsCpoDtlTMsg.dsCpoConfigPk">
        AND CD.DS_CPO_CONFIG_PK     is NULL
        </isNull>
        AND DC.GLBL_CMPY_CD          = CD.GLBL_CMPY_CD 
        AND DC.CPO_ORD_NUM           = CD.CPO_ORD_NUM
        AND DC.EZCANCELFLAG          = '0'
        AND DPD.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
        AND DPD.DS_ORD_TP_CD         = DC.DS_ORD_TP_CD 
        AND DPD.DS_ORD_LINE_CATG_CD  = CD.DS_ORD_LINE_CATG_CD
        AND DPD.EFF_FROM_DT          &lt;= #pMsg.slsDt#
        AND (DPD.EFF_THRU_DT         &gt;= #pMsg.slsDt#
         OR DPD.EFF_THRU_DT          IS NULL) 
        AND DPD.ACTV_FLG             = 'Y'
        AND DPD.EZCANCELFLAG         = '0'
        AND OPT.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
        AND OPT.ORD_PROC_TP_CD       = DPD.ORD_PROC_TP_CD
        AND OPT.EFF_FROM_DT          &lt;= #pMsg.slsDt#
        AND (OPT.EFF_THRU_DT         &gt;= #pMsg.slsDt#
         OR OPT.EFF_THRU_DT          IS NULL)
        AND OPT.ACTV_FLG             = 'Y'
        AND OPT.CHK_RQST_PROC_FLG    = 'Y'
        AND OPT.EZCANCELFLAG         = '0'
    </statement>
</sqlMap>
