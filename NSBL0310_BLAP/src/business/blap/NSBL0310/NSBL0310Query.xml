<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSBL0310Query">

    <typeAlias alias="NSBL0310_ASMsg"    type="business.blap.NSBL0310.NSBL0310_ASMsg"/>

    <statement id="getOpenSvcTask"  parameterClass="Map" resultMap="result.NSBL0310_ASMsg">
<!-- mod start 2016/10/18 CSA Defect#11030 --> 
        SELECT
            PREV_OPEN_TASK_CNT
            ,INPROC_TASK_CNT
            ,CLO_TASK_CNT
            ,CANC_TASK_CNT
            ,REJ_TASK_CNT
            ,SVC_RSP_TM_NUM
            ,AVG_TM_RSP_CNT
            <!-- START 2019/03/28 S.Kitamura [QC#30233,ADD] -->
            ,TO_BE_OPTM_TASK_CNT
            ,SCHD_TASK_CNT
            <!-- END 2019/03/28 S.Kitamura [QC#30233,ADD] -->
            ,ASG_TASK_CNT
            ,OPEN_TASK_CNT
            ,HLD_TASK_CNT
            ,ESCL_TASK_CNT
            ,VIP_TASK_CNT
            ,ATTN_TASK_CNT
            ,SVC_MGR_PSN_CD
            ,PSN_LAST_NM
            ,PSN_FIRST_NM
        FROM (
            SELECT DISTINCT
                 OSTS.PREV_OPEN_TASK_CNT   AS PREV_OPEN_TASK_CNT
                ,OSTS.INPROC_TASK_CNT      AS INPROC_TASK_CNT
                ,OSTS.CLO_TASK_CNT         AS CLO_TASK_CNT
                ,OSTS.CANC_TASK_CNT        AS CANC_TASK_CNT
                ,OSTS.REJ_TASK_CNT         AS REJ_TASK_CNT
                ,OSTS.SVC_RSP_TM_NUM       AS SVC_RSP_TM_NUM
                ,OSTS.AVG_TM_RSP_CNT       AS AVG_TM_RSP_CNT
                <!-- START 2019/03/28 S.Kitamura [QC#30233,ADD] -->
                ,OSTS.TO_BE_OPTM_TASK_CNT  AS TO_BE_OPTM_TASK_CNT
                ,OSTS.SCHD_TASK_CNT        AS SCHD_TASK_CNT
                <!-- END 2019/03/28 S.Kitamura [QC#30233,ADD] -->
                ,OSTS.ASG_TASK_CNT         AS ASG_TASK_CNT
                ,OSTS.OPEN_TASK_CNT        AS OPEN_TASK_CNT
                ,OSTS.HLD_TASK_CNT         AS HLD_TASK_CNT
                ,OSTS.ESCL_TASK_CNT        AS ESCL_TASK_CNT
                ,OSTS.VIP_TASK_CNT         AS VIP_TASK_CNT
                ,OSTS.ATTN_TASK_CNT        AS ATTN_TASK_CNT
                ,OSTS.SVC_MGR_PSN_CD       AS SVC_MGR_PSN_CD
                ,SP.PSN_LAST_NM            AS PSN_LAST_NM
                ,SP.PSN_FIRST_NM           AS PSN_FIRST_NM
            FROM
                 OPEN_SVC_TASK_SMRY      OSTS
                ,S21_PSN                 SP
            WHERE
                OSTS.GLBL_CMPY_CD          = #glblCmpyCd#
                AND OSTS.SVC_MGR_TP_CD     = #svcMgrTpCd#
                <isNotNull property="firstOrgCd">
                AND OSTS.FIRST_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="scdOrgCd">
                AND OSTS.SCD_ORG_CD        = #orgCd#
                </isNotNull>
                <isNotNull property="thirdOrgCd">
                AND OSTS.THIRD_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="frthOrgCd">
                AND OSTS.FRTH_ORG_CD       = #orgCd#
                </isNotNull>
                <isNotNull property="fifthOrgCd">
                AND OSTS.FIFTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="sixthOrgCd">
                AND OSTS.SIXTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="svnthOrgCd">
                AND OSTS.SVNTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="eightOrgCd">
                AND OSTS.EIGHTH_ORG_CD     = #orgCd#
                </isNotNull>
                <isNotNull property="ninthOrgCd">
                AND OSTS.NINTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="tenthOrgCd">
                AND OSTS.TENTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="elvthOrgCd">
                AND OSTS.ELVTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNull property="orgLayerNum">
                AND (
                        OSTS.FIRST_ORG_CD  = #orgCd#
                    OR  OSTS.SCD_ORG_CD    = #orgCd#
                    OR  OSTS.THIRD_ORG_CD  = #orgCd#
                    OR  OSTS.FRTH_ORG_CD   = #orgCd#
                    OR  OSTS.FIFTH_ORG_CD  = #orgCd#
                    OR  OSTS.SIXTH_ORG_CD  = #orgCd#
                    OR  OSTS.SVNTH_ORG_CD  = #orgCd#
                    OR  OSTS.EIGHTH_ORG_CD = #orgCd#
                    OR  OSTS.NINTH_ORG_CD  = #orgCd#
                    OR  OSTS.TENTH_ORG_CD  = #orgCd#
                    OR  OSTS.ELVTH_ORG_CD  = #orgCd#
                )
                </isNull>
                AND OSTS.GLBL_CMPY_CD      = SP.GLBL_CMPY_CD
                AND OSTS.SVC_MGR_PSN_CD    = SP.PSN_CD
                AND OSTS.EZCANCELFLAG      = '0'
                AND SP.EZCANCELFLAG        = '0'
            ORDER BY
                 PSN_LAST_NM
                ,PSN_FIRST_NM
        )
        WHERE
            ROWNUM        &lt;= #rowNum#
<!-- mod end 2016/10/18 CSA Defect#11030 --> 
    </statement>
    <resultMap id="result.NSBL0310_ASMsg"  class="NSBL0310_ASMsg">
        <result property="prevOpenTaskCnt_A" column="PREV_OPEN_TASK_CNT" javaType="EZDSBigDecimalItem"/>
        <result property="inprocTaskCnt_A"   column="INPROC_TASK_CNT"    javaType="EZDSBigDecimalItem"/>
        <result property="cloTaskCnt_A"      column="CLO_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="cancTaskCnt_A"     column="CANC_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <result property="rejTaskCnt_A"      column="REJ_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="svcRspTmNum_A"     column="SVC_RSP_TM_NUM"     javaType="EZDSBigDecimalItem"/>
        <result property="xxRcvTm_A"         column="AVG_TM_RSP_CNT"     javaType="EZDSStringItem"/>
        <!-- START 2019/03/28 S.Kitamura [QC#30233,ADD] -->
        <result property="toBeOptmTaskCnt_A" column="TO_BE_OPTM_TASK_CNT" javaType="EZDSBigDecimalItem"/>
        <result property="schdTaskCnt_A"     column="SCHD_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <!-- END 2019/03/28 S.Kitamura [QC#30233,ADD] -->
        <result property="asgTaskCnt_A"      column="ASG_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="openTaskCnt_A"     column="OPEN_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <result property="hldTaskCnt_A"      column="HLD_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="esclTaskCnt_A"     column="ESCL_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <result property="vipTaskCnt_A"      column="VIP_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="attnTaskCnt_A"     column="ATTN_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <result property="orgLayerNum_A"     column="MGR_ORG_LAYER_NUM"  javaType="EZDSBigDecimalItem"/>
        <result property="svcMgrPsnCd_A"     column="SVC_MGR_PSN_CD"     javaType="EZDSStringItem"/>
        <result property="orgCd_A"           column="ORG_CD"             javaType="EZDSStringItem"/>
        <result property="psnFirstNm_A"      column="PSN_FIRST_NM"       javaType="EZDSStringItem"/>
        <result property="psnLastNm_A"       column="PSN_LAST_NM"        javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getOpenSvcTaskSmry"  parameterClass="Map" resultMap="result.NSBL0310_ASMsg">
<!-- mod start 2016/10/18 CSA Defect#11030 --> 
        SELECT
            SUM(PREV_OPEN_TASK_CNT)  AS PREV_OPEN_TASK_CNT
            ,SUM(INPROC_TASK_CNT)    AS INPROC_TASK_CNT
            ,SUM(CLO_TASK_CNT)       AS CLO_TASK_CNT
            ,SUM(CANC_TASK_CNT)      AS CANC_TASK_CNT
            ,SUM(REJ_TASK_CNT)       AS REJ_TASK_CNT
            ,SUM(SVC_RSP_TM_NUM)     AS SVC_RSP_TM_NUM
            ,SUM(AVG_TM_RSP_CNT)     AS AVG_TM_RSP_CNT
            <!-- START 2019/03/28 S.Kitamura [QC#30233,ADD] -->
            ,SUM(TO_BE_OPTM_TASK_CNT) AS TO_BE_OPTM_TASK_CNT
            ,SUM(SCHD_TASK_CNT)      AS SCHD_TASK_CNT
            <!-- END 2019/03/28 S.Kitamura [QC#30233,ADD] -->
            ,SUM(ASG_TASK_CNT)       AS ASG_TASK_CNT
            ,SUM(OPEN_TASK_CNT)      AS OPEN_TASK_CNT
            ,SUM(HLD_TASK_CNT)       AS HLD_TASK_CNT
            ,SUM(ESCL_TASK_CNT)      AS ESCL_TASK_CNT
            ,SUM(VIP_TASK_CNT)       AS VIP_TASK_CNT
            ,SUM(ATTN_TASK_CNT)      AS ATTN_TASK_CNT
        FROM (
            SELECT DISTINCT
                 OSTS.PREV_OPEN_TASK_CNT   AS PREV_OPEN_TASK_CNT
                ,OSTS.INPROC_TASK_CNT      AS INPROC_TASK_CNT
                ,OSTS.CLO_TASK_CNT         AS CLO_TASK_CNT
                ,OSTS.CANC_TASK_CNT        AS CANC_TASK_CNT
                ,OSTS.REJ_TASK_CNT         AS REJ_TASK_CNT
                ,OSTS.SVC_RSP_TM_NUM       AS SVC_RSP_TM_NUM
                ,OSTS.AVG_TM_RSP_CNT       AS AVG_TM_RSP_CNT
                <!-- START 2019/03/28 S.Kitamura [QC#30233,ADD] -->
                ,OSTS.TO_BE_OPTM_TASK_CNT  AS TO_BE_OPTM_TASK_CNT
                ,OSTS.SCHD_TASK_CNT        AS SCHD_TASK_CNT
                <!-- END 2019/03/28 S.Kitamura [QC#30233,ADD] -->
                ,OSTS.ASG_TASK_CNT         AS ASG_TASK_CNT
                ,OSTS.OPEN_TASK_CNT        AS OPEN_TASK_CNT
                ,OSTS.HLD_TASK_CNT         AS HLD_TASK_CNT
                ,OSTS.ESCL_TASK_CNT        AS ESCL_TASK_CNT
                ,OSTS.VIP_TASK_CNT         AS VIP_TASK_CNT
                ,OSTS.ATTN_TASK_CNT        AS ATTN_TASK_CNT
                ,SP.PSN_LAST_NM            AS PSN_LAST_NM
                ,SP.PSN_FIRST_NM           AS PSN_FIRST_NM
            FROM
                 OPEN_SVC_TASK_SMRY      OSTS
                ,S21_PSN                 SP
            WHERE
                OSTS.GLBL_CMPY_CD          = #glblCmpyCd#
                AND OSTS.SVC_MGR_TP_CD     = #svcMgrTpCd#
                <isNotNull property="firstOrgCd">
                AND OSTS.FIRST_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="scdOrgCd">
                AND OSTS.SCD_ORG_CD        = #orgCd#
                </isNotNull>
                <isNotNull property="thirdOrgCd">
                AND OSTS.THIRD_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="frthOrgCd">
                AND OSTS.FRTH_ORG_CD       = #orgCd#
                </isNotNull>
                <isNotNull property="fifthOrgCd">
                AND OSTS.FIFTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="sixthOrgCd">
                AND OSTS.SIXTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="svnthOrgCd">
                AND OSTS.SVNTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="eightOrgCd">
                AND OSTS.EIGHTH_ORG_CD     = #orgCd#
                </isNotNull>
                <isNotNull property="ninthOrgCd">
                AND OSTS.NINTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="tenthOrgCd">
                AND OSTS.TENTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNotNull property="elvthOrgCd">
                AND OSTS.ELVTH_ORG_CD      = #orgCd#
                </isNotNull>
                <isNull property="orgLayerNum">
                AND (
                        OSTS.FIRST_ORG_CD  = #orgCd#
                    OR  OSTS.SCD_ORG_CD    = #orgCd#
                    OR  OSTS.THIRD_ORG_CD  = #orgCd#
                    OR  OSTS.FRTH_ORG_CD   = #orgCd#
                    OR  OSTS.FIFTH_ORG_CD  = #orgCd#
                    OR  OSTS.SIXTH_ORG_CD  = #orgCd#
                    OR  OSTS.SVNTH_ORG_CD  = #orgCd#
                    OR  OSTS.EIGHTH_ORG_CD = #orgCd#
                    OR  OSTS.NINTH_ORG_CD  = #orgCd#
                    OR  OSTS.TENTH_ORG_CD  = #orgCd#
                    OR  OSTS.ELVTH_ORG_CD  = #orgCd#
                )
                </isNull>
                AND OSTS.GLBL_CMPY_CD      = SP.GLBL_CMPY_CD
                AND OSTS.SVC_MGR_PSN_CD    = SP.PSN_CD
                AND OSTS.EZCANCELFLAG      = '0'
                AND SP.EZCANCELFLAG        = '0'
            ORDER BY
                 PSN_LAST_NM
                ,PSN_FIRST_NM
        )
        WHERE
            ROWNUM        &lt;= #rowNum#
<!-- mod end 2016/10/18 CSA Defect#11030 --> 
    </statement>
    <resultMap id="result.NSBL0310_ASMsg"  class="NSBL0310_ASMsg">
        <result property="prevOpenTaskCnt_A" column="PREV_OPEN_TASK_CNT" javaType="EZDSBigDecimalItem"/>
        <result property="inprocTaskCnt_A"   column="INPROC_TASK_CNT"    javaType="EZDSBigDecimalItem"/>
        <result property="cloTaskCnt_A"      column="CLO_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="cancTaskCnt_A"     column="CANC_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <result property="rejTaskCnt_A"      column="REJ_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="svcRspTmNum_A"     column="SVC_RSP_TM_NUM"     javaType="EZDSBigDecimalItem"/>
        <result property="xxRcvTm_A"         column="AVG_TM_RSP_CNT"     javaType="EZDSStringItem"/>
        <!-- START 2019/03/28 S.Kitamura [QC#30233,ADD] -->
        <result property="toBeOptmTaskCnt_A" column="TO_BE_OPTM_TASK_CNT" javaType="EZDSBigDecimalItem"/>
        <result property="schdTaskCnt_A"     column="SCHD_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <!-- END 2019/03/28 S.Kitamura [QC#30233,ADD] -->
        <result property="asgTaskCnt_A"      column="ASG_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="openTaskCnt_A"     column="OPEN_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <result property="hldTaskCnt_A"      column="HLD_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="esclTaskCnt_A"     column="ESCL_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <result property="vipTaskCnt_A"      column="VIP_TASK_CNT"       javaType="EZDSBigDecimalItem"/>
        <result property="attnTaskCnt_A"     column="ATTN_TASK_CNT"      javaType="EZDSBigDecimalItem"/>
        <result property="svcMgrPsnCd_A"     column="SVC_MGR_PSN_CD"     javaType="EZDSStringItem"/>
        <result property="psnFirstNm_A"      column="PSN_FIRST_NM"       javaType="EZDSStringItem"/>
        <result property="psnLastNm_A"       column="PSN_LAST_NM"        javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getLayerNum"  parameterClass="Map" resultClass="BigDecimal">
        SELECT
            ORG_LAYER_NUM
        FROM
            ORG_STRU
        WHERE
                GLBL_CMPY_CD                = #glblCmpyCd#
            AND ORG_CD                      = #orgCd#
            AND EZCANCELFLAG                = '0'
   </statement>
</sqlMap>
