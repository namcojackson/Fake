<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NFAL0120Query">

	<typeAlias alias="NFAL0120CMsg"		type="business.blap.NFAL0120.NFAL0120CMsg"/>
	<typeAlias alias="NFAL0120_ASMsg"	type="business.blap.NFAL0120.NFAL0120_ASMsg"/>

	<statement id="getResult"  parameterClass="Map" resultMap="result.NFAL0120_ASMsg">
		WITH JE_CRDR AS (
			SELECT
				*
			FROM
				(
				SELECT
					JE.*
				FROM
				<!-- START 2019/12/19 MOD QC#53730-->
				<!--<isEqual property="archived" compareValue="Y" >-->
				<!--	JRNL_ENTRY_ARC JE-->
				<!--</isEqual>-->
				<!--<isNotEqual property="archived" compareValue="Y">-->
				<!--		JRNL_ENTRY JE-->
				<!--</isNotEqual>	-->
				       ALL_JRNL_ENTRY_V JE
				<!-- END  2019/12/19 MOD QC#53730-->
				WHERE
						JE.GLBL_CMPY_CD 	= #glblCmpyCd#
						
				<isNotNull property="bizMsg.glDt_FR">
					<isNotNull property="bizMsg.glDt_TO">
						AND	JE.GL_DT 			BETWEEN TO_CHAR(#glDt_FR#) AND TO_CHAR(#glDt_TO#)
					</isNotNull>
					<isNull property="bizMsg.glDt_TO">
						AND JE.GL_DT 	&gt;= #glDt_FR#
					</isNull>
				</isNotNull>
				<isNull property="bizMsg.glDt_FR">
					<isNotNull property="bizMsg.glDt_TO">   
			  			AND	JE.GL_DT 		&lt;= #glDt_TO#
					</isNotNull>   
				</isNull>
				
				<isNotNull property="bizMsg.glPerNm">
					AND JE.GL_DT             LIKE #yyyymm#
				</isNotNull>
				
				<isNotNull	property="bizMsg.sysSrcCd_3">
					AND	JE.JRNL_SRC_CD 		= #sysSrcCd#
				</isNotNull>
				<!-- mod 2016.05.31			
				<isNotNull	property="bizMsg.trxCd_3">
					AND	JE.TRX_CD 			= #trxCd#
				</isNotNull>
				<isNotNull	property="bizMsg.trxRsnCd_3">
					AND	JE.TRX_RSN_CD 		= #trxRsnCd#
				</isNotNull>
				-->
                <!-- START 2017/12/04 MOD QC#12525 -->
				<isNotNull	property="bizMsg.jrnlCatgCd">
				    AND JE.JRNL_CATG_CD = #bizMsg.jrnlCatgCd#
				</isNotNull>
				<!-- end 2016/05/31 -->
				<isNotNull	property="bizMsg.xxQueryFltrTxt_AT">
					<isNotNull	property="bizMsg.ajeTrxTpCd_3">
				    AND TO_CHAR(JE.$srchColNm$) = #bizMsg.xxQueryFltrTxt_AT#
					</isNotNull>
				</isNotNull>
                <!-- END   2017/12/04 MOD QC#12525 -->
                <!-- START 2016/12/20 MOD QC#16702-->
				<isEqual property="bizMsg.srchOptTxt" compareValue="INVTY_TRX_PK">
					AND	 INVTY_TRX_PK 		= TO_NUMBER(#anyWord#)
				</isEqual>
                <!-- END 2016/12/20 MOD QC#16702-->
				<isEqual property="bizMsg.srchOptTxt" compareValue="RCPT_NUM">
					AND	 RCPT_NUM	 		= #anyWord#
				</isEqual>
				<isNull  property="bizMsg.srchOptTxt">
					<isNotNull property="anyWord">
					AND	 UPPER(JRNL_ENTRY_REF_TXT) LIKE #anyWord#
					</isNotNull>
				</isNull>

				<isNotNull property="tocCd">
					AND	 SUBSTRB(UPPER(JRNL_ENTRY_REF_TXT), INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 1) + 1, INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 2) - (INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 1) + 1)) = #tocCd# 
				</isNotNull>

				<isEqual property="hasCrDrCondtion" compareValue="Y" >
					AND (
							-- DR
							(	JE.EZCANCELFLAG 	= '0'
							
						<isNotNull property="bizMsg.jrnlDealDrAmt_FM">
							<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
							AND (JE.JRNL_DEAL_DR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
							AND  JE.JRNL_DEAL_DR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#)
							</isNotNull>
							<isNull property="bizMsg.jrnlDealDrAmt_TO">
							AND JE.JRNL_DEAL_DR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
							</isNull>
						</isNotNull>
						<isNull property="bizMsg.jrnlDealDrAmt_FM">
							<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
								AND  JE.JRNL_DEAL_DR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#
							</isNotNull>
						</isNull>	
							
                        <!-- START 2017/12/04 MOD QC#12525 -->
						<isNotNull property="bizMsg.coaCmpyCd">
							AND	JE.DR_COA_CMPY_CD 	= #bizMsg.coaCmpyCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaBrCd">
							AND	JE.DR_COA_BR_CD 	LIKE #bizMsg.coaBrCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaCcCd">
							AND	JE.DR_COA_CC_CD 	LIKE #bizMsg.coaCcCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaAcctCd">   
							AND	JE.DR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaProdCd">
							AND	JE.DR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaChCd">
							AND	JE.DR_COA_CH_CD 	LIKE #bizMsg.coaChCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaAfflCd">
							AND	JE.DR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaProjCd">
							AND	JE.DR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaExtnCd">
							AND	JE.DR_COA_EXTN_CD 	LIKE #bizMsg.coaExtnCd#
						</isNotNull>
                        <!-- END   2017/12/04 MOD QC#12525 -->
							)
							OR
							-- CR
							(	JE.EZCANCELFLAG 	= '0'
							
                        <!-- START 2017/12/04 MOD QC#12525 -->
						<isNotNull property="bizMsg.jrnlDealDrAmt_FM">
							<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
							AND (JE.JRNL_DEAL_CR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
							AND  JE.JRNL_DEAL_CR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#)
							</isNotNull>
							<isNull property="bizMsg.jrnlDealDrAmt_TO">
							AND JE.JRNL_DEAL_CR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
							</isNull>
						</isNotNull>
						<isNull property="bizMsg.jrnlDealDrAmt_FM">
							<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
								AND  JE.JRNL_DEAL_CR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#
							</isNotNull>
						</isNull>
						
						<isNotNull property="bizMsg.coaCmpyCd">
							AND	JE.CR_COA_CMPY_CD 	= #bizMsg.coaCmpyCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaBrCd">
							AND	JE.CR_COA_BR_CD 	LIKE #bizMsg.coaBrCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaCcCd">
							AND	JE.CR_COA_CC_CD 	LIKE #bizMsg.coaCcCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaAcctCd">
							AND	JE.CR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaProdCd">
							AND	JE.CR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaChCd">
							AND	JE.CR_COA_CH_CD 	LIKE #bizMsg.coaChCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaAfflCd">
							AND	JE.CR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaProjCd">
							AND	JE.CR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd#
						</isNotNull>
						<isNotNull property="bizMsg.coaExtnCd">
							AND	JE.CR_COA_EXTN_CD 	LIKE #bizMsg.coaExtnCd#
						</isNotNull>
                        <!-- END   2017/12/04 MOD QC#12525 -->
							)
						)
				</isEqual>
				<isNotEqual property="hasCrDrCondtion" compareValue="Y" >
					AND	JE.EZCANCELFLAG = '0'
				</isNotEqual>

				ORDER BY
					JRNL_ENTRY_PK
				)
			<isNotNull property="rowNum" >
			WHERE
				ROWNUM &lt; #rowNum#
			</isNotNull>
		)
		SELECT
			DR.JRNL_ENTRY_PK   		AS JRNL_ENTRY_PK,
			DR.GL_DT           		AS GL_DT,
			DR.GL_SEND_CPLT_FLG 	AS GL_SEND_CPLT_FLG,
			DR.AJE_ID          		AS AJE_ID,
			DR.JRNL_SRC_NM     		AS JRNL_SRC_NM,
			DR.JRNL_CATG_NM    		AS JRNL_CATG_NM,
			'1'             		AS DR_OR_CR,
			DR.DR_COA_ACCT_CD		AS COA_ACCT_CD,
			DR.DR_COA_CMPY_CD		AS COA_CMPY_CD,
			DR.DR_COA_BR_CD			AS COA_BR_CD,
			DR.DR_COA_CC_CD			AS COA_CC_CD,
			DR.DR_COA_PROD_CD		AS COA_PROD_CD_DC,
			DR.DR_COA_CH_CD			AS COA_CH_CD,
			DR.DR_COA_AFFL_CD		AS COA_AFFL_CD,
			DR.DR_COA_PROJ_CD		AS COA_PROJ_CD,
			DR.DR_COA_EXTN_CD		AS COA_EXTN_CD,
			DR.DR_COA_CMPY_CD||#divider#||DR.DR_COA_BR_CD||#divider#||DR.DR_COA_CC_CD||#divider#||DR.DR_COA_ACCT_CD||#divider#||DR.DR_COA_PROD_CD||#divider#
			||DR.DR_COA_CH_CD||#divider#||DR.DR_COA_AFFL_CD||#divider#||DR.DR_COA_PROJ_CD||#divider#||DR.DR_COA_EXTN_CD AS COA_ACCT_STRG,
			DR.JRNL_FUNC_DR_AMT  	AS JRNL_FUNC_DR_AMT,
			DR.JRNL_FUNC_CR_AMT  	AS JRNL_FUNC_CR_AMT,
			DR.COA_PROD_CD			AS COA_PROD_CD,
			DR.TOC_CD				AS TOC_CD,
			<!-- START 2016/08/25 S.Fujita [QC#4105,ADD] -->
			SP.PSN_NUM				AS PSN_NUM,
			<!-- END   2016/08/25 S.Fujita [QC#4105,ADD] -->
			DR.BILL_TO_CUST_CD  	AS BILL_TO_CUST_CD,
			DR.VND_CD				AS VND_CD,
			DR.AJE_INV_NUM  		AS AJE_INV_NUM,
			DR.PRMO_PK  			AS PRMO_PK,
			DR.AJE_ITEM_CD  		AS AJE_ITEM_CD,
			<!-- START 2018/06/22 S.Katsuma [QC#24025,ADD] -->
			DR.AJE_ITEM_DESC_TXT	AS AJE_ITEM_DESC_TXT,
			<!-- END 2018/06/22 S.Katsuma [QC#24025,ADD] -->
			DR.SO_NUM				AS SO_NUM,
			DR.MACH_CONFIG_NUM      AS MACH_CONFIG_NUM,
			DR.DS_ORD_TP_CD         AS DS_ORD_TP_CD,
			DR.DS_ORD_RSN_CD        AS DS_ORD_RSN_CD,
			DR.SER_NUM              AS SER_NUM,
			DR.CPO_ORD_NUM          AS CPO_ORD_NUM,
			DR.RCPT_NUM             AS RCPT_NUM,
			DR.DS_ACCT_NUM          AS DS_ACCT_NUM,
			DR.INVTY_TRX_PK         AS INVTY_TRX_PK,
			DR.PO_ORD_NUM           AS PO_ORD_NUM
	       ,DR.JRNL_QTY             AS JRNL_QTY
	       ,DR.PRNT_DS_ASSET_MSTR_PK AS PRNT_DS_ASSET_MSTR_PK
	       ,DR.MAN_JRNL_ENTRY_HDR_PK AS MAN_JRNL_ENTRY_HDR_PK
	       ,(CASE WHEN DR.SVC_MACH_MSTR_PK = 0
			      THEN NULL
			      ELSE DR.SVC_MACH_MSTR_PK END)     AS SVC_MACH_MSTR_PK,
			(CASE WHEN DR.JRNL_ENTRY_FIRST_REF_TXT IS NOT NULL 
			      THEN DR.JRNL_ENTRY_FIRST_ATTRB_NM||':'||DR.JRNL_ENTRY_FIRST_REF_TXT
			      ELSE '' END)  AS JRNL_ENTRY_FIRST_REF_TXT,
			(CASE WHEN DR.JRNL_ENTRY_SCD_REF_TXT IS NOT NULL 
			      THEN DR.JRNL_ENTRY_SCD_ATTRB_NM||':'||DR.JRNL_ENTRY_SCD_REF_TXT
			      ELSE '' END)     AS JRNL_ENTRY_SCD_REF_TXT,
			(CASE WHEN DR.JRNL_ENTRY_THIRD_REF_TXT IS NOT NULL 
			      THEN DR.JRNL_ENTRY_THIRD_ATTRB_NM||':'||DR.JRNL_ENTRY_THIRD_REF_TXT 
			      ELSE '' END) AS JRNL_ENTRY_THIRD_REF_TXT,
			(CASE WHEN DR.JRNL_ENTRY_FRTH_REF_TXT IS NOT NULL
			      THEN DR.JRNL_ENTRY_FRTH_ATTRB_NM||':'||DR.JRNL_ENTRY_FRTH_REF_TXT
			      ELSE '' END) AS JRNL_ENTRY_FRTH_REF_TXT,
			(CASE WHEN (DR.JRNL_ENTRY_FIFTH_REF_TXT IS NOT NULL AND DR.JRNL_ENTRY_FIFTH_ATTRB_NM IS NOT NULL)
			      THEN DR.JRNL_ENTRY_FIFTH_ATTRB_NM||':'||DR.JRNL_ENTRY_FIFTH_REF_TXT
			      ELSE '' END) AS JRNL_ENTRY_FIFTH_REF_TXT

            <!-- START 2017/03/16 [QC#14205,ADD] -->
             , DR.EZINTIME                    AS XX_REC_HIST_CRAT_TS
             , DR.EZUPTIME                    AS XX_REC_HIST_UPD_TS
             , DR.EZTABLEID                   AS XX_REC_HIST_TBL_NM
             ,CASE WHEN IN_AP.MID_NM IS NULL AND IN_AP.FIRST_NM IS NULL THEN DR.EZINUSERID
                   WHEN IN_AP.MID_NM IS NULL THEN DR.EZINUSERID || ' : ' || IN_AP.FIRST_NM || ' ' || IN_AP.LAST_NM
                   WHEN IN_AP.MID_NM IS NOT NULL THEN DR.EZINUSERID || ' : ' || IN_AP.FIRST_NM || IN_AP.MID_NM || ' ' || IN_AP.LAST_NM
                   ELSE DR.EZINUSERID
              END AS XX_REC_HIST_CRAT_BY_NM
             ,CASE WHEN UP_AP.MID_NM IS NULL AND UP_AP.FIRST_NM IS NULL THEN DR.EZUPUSERID
                   WHEN UP_AP.MID_NM IS NULL THEN DR.EZUPUSERID || ' : ' || UP_AP.FIRST_NM || ' ' || UP_AP.LAST_NM
                   WHEN UP_AP.MID_NM IS NOT NULL THEN DR.EZUPUSERID || ' : ' || UP_AP.FIRST_NM || UP_AP.MID_NM || ' ' || UP_AP.LAST_NM
                   ELSE DR.EZUPUSERID
              END AS XX_REC_HIST_UPD_BY_NM
            <!-- END   2017/03/16 [QC#14205,ADD] -->
            <!-- START 2019/08/20 S.Takami [QC#51897,ADD] -->
           ,(CASE WHEN DR.SVC_CONFIG_MSTR_PK = 0
                  THEN NULL
                  ELSE DR.SVC_CONFIG_MSTR_PK END)     AS SVC_CONFIG_MSTR_PK
            <!-- END 2019/08/20 S.Takami [QC#51897,ADD] -->
		FROM 
		    JE_CRDR DR
		    <!-- START 2016/08/25 S.Fujita [QC#4105,ADD] -->
		    ,ORG_FUNC_ASG       OFA
            ,S21_PSN            SP
		    <!-- END   2016/08/25 S.Fujita [QC#4105,ADD] -->
            ,AUTH_PSN    IN_AP
            ,AUTH_PSN    UP_AP
		WHERE
		    DR.DR_COA_CMPY_CD IS NOT NULL
		<isEqual property="hasCrDrCondtion" compareValue="Y" >
			    AND DR.GLBL_CMPY_CD 	= #glblCmpyCd#
			    <!-- 2016/06/01 Exclude the dummy entry generated by manual journal entry -->
			    AND DR.DR_COA_BR_CD IS NOT NULL
			    <!-- end 2016/06/01 -->
			    	
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.jrnlDealDrAmt_FM">
				<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
				AND (DR.JRNL_DEAL_DR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
				AND  DR.JRNL_DEAL_DR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#)
				</isNotNull>
				<isNull property="bizMsg.jrnlDealDrAmt_TO">
				AND DR.JRNL_DEAL_DR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
				</isNull>
			</isNotNull>
			<isNull property="bizMsg.jrnlDealDrAmt_FM">
				<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
					AND  DR.JRNL_DEAL_DR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#
				</isNotNull>
			</isNull>
						
			 <isNotNull property="bizMsg.coaCmpyCd">
				AND	DR.DR_COA_CMPY_CD 	= #bizMsg.coaCmpyCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaBrCd">
				AND	DR.DR_COA_BR_CD 	LIKE #bizMsg.coaBrCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaCcCd">
				AND	DR.DR_COA_CC_CD 	LIKE #bizMsg.coaCcCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaAcctCd">
				AND	DR.DR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaProdCd">
				AND	DR.DR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaChCd">
				AND	DR.DR_COA_CH_CD 	LIKE #bizMsg.coaChCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaAfflCd">
				AND	DR.DR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaProjCd">
				AND	DR.DR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaExtnCd">
				AND	DR.DR_COA_EXTN_CD 	LIKE #bizMsg.coaExtnCd#
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
		</isEqual>
		<!-- START 2016/08/25 S.Fujita [QC#4105,ADD] -->
		    AND DR.GLBL_CMPY_CD             = OFA.GLBL_CMPY_CD (+)
            AND DR.TOC_CD                   = OFA.TOC_CD (+)
            AND OFA.EZCANCELFLAG (+)        = '0'
            AND OFA.GLBL_CMPY_CD            = SP.GLBL_CMPY_CD (+)
            AND OFA.PSN_CD                  = SP.PSN_CD (+)
            AND SP.EFF_FROM_DT (+)      &lt;= DR.GL_DT
            AND NVL(SP.EFF_THRU_DT (+),'99991231')   &gt;= DR.GL_DT
            AND SP.EZCANCELFLAG (+)         = '0'
        <!-- END   2016/08/25 S.Fujita [QC#4105,ADD] -->
            AND DR.GLBL_CMPY_CD          = IN_AP.GLBL_CMPY_CD(+)
            AND UPPER(DR.EZINUSERID)     = UPPER(IN_AP.USR_NM(+))
            AND IN_AP.EZCANCELFLAG(+)    = '0'
            AND DR.GLBL_CMPY_CD          = UP_AP.GLBL_CMPY_CD(+)
            AND UPPER(DR.EZUPUSERID)     = UPPER(UP_AP.USR_NM(+))
            AND UP_AP.EZCANCELFLAG(+)    = '0'

		UNION ALL

		SELECT
			CR.JRNL_ENTRY_PK   		AS JRNL_ENTRY_PK,
			CR.GL_DT           		AS GL_DT,
			CR.GL_SEND_CPLT_FLG     AS GL_SEND_CPLT_FLG,
			CR.AJE_ID          		AS AJE_ID,
			CR.JRNL_SRC_NM     		AS JRNL_SRC_NM,
			CR.JRNL_CATG_NM    		AS JRNL_CATG_NM,
			'2'             		AS DR_OR_CR,
			CR.CR_COA_ACCT_CD		AS COA_ACCT_CD,
			CR.CR_COA_CMPY_CD		AS COA_CMPY_CD,
			CR.CR_COA_BR_CD			AS COA_BR_CD,
			CR.CR_COA_CC_CD			AS COA_CC_CD,
			CR.CR_COA_PROD_CD		AS COA_PROD_CD_DC,
			CR.CR_COA_CH_CD			AS COA_CH_CD,
			CR.CR_COA_AFFL_CD		AS COA_AFFL_CD,
			CR.CR_COA_PROJ_CD		AS COA_PROJ_CD,
			CR.CR_COA_EXTN_CD		AS COA_EXTN_CD,
			CR.CR_COA_CMPY_CD||#divider#||CR.CR_COA_BR_CD||#divider#||CR.CR_COA_CC_CD||#divider#||CR.CR_COA_ACCT_CD||#divider#||CR.CR_COA_PROD_CD||#divider#
			||CR.CR_COA_CH_CD||#divider#||CR.CR_COA_AFFL_CD||#divider#||CR.CR_COA_PROJ_CD||#divider#||CR.CR_COA_EXTN_CD AS COA_ACCT_STRG,
			CR.JRNL_FUNC_DR_AMT  	AS JRNL_FUNC_DR_AMT,
			CR.JRNL_FUNC_CR_AMT  	AS JRNL_FUNC_CR_AMT,
			CR.COA_PROD_CD			AS COA_PROD_CD,
			CR.TOC_CD				AS TOC_CD,
			<!-- START 2016/08/25 S.Fujita [QC#4105,ADD] -->
			SP.PSN_NUM				AS PSN_NUM,
			<!-- END   2016/08/25 S.Fujita [QC#4105,ADD] -->
			CR.BILL_TO_CUST_CD  	AS BILL_TO_CUST_CD,
			CR.VND_CD				AS VND_CD,
			CR.AJE_INV_NUM  		AS AJE_INV_NUM,
			CR.PRMO_PK  			AS PRMO_PK,
			CR.AJE_ITEM_CD  		AS AJE_ITEM_CD,
			<!-- START 2018/06/22 S.Katsuma [QC#24025,ADD] -->
			CR.AJE_ITEM_DESC_TXT	AS AJE_ITEM_DESC_TXT,
			<!-- END 2018/06/22 S.Katsuma [QC#24025,ADD] -->
			CR.SO_NUM				AS SO_NUM,
			CR.MACH_CONFIG_NUM      AS MACH_CONFIG_NUM,
			CR.DS_ORD_TP_CD         AS DS_ORD_TP_CD,
			CR.DS_ORD_RSN_CD        AS DS_ORD_RSN_CD,
			CR.SER_NUM              AS SER_NUM,
			CR.CPO_ORD_NUM          AS CPO_ORD_NUM,
			CR.RCPT_NUM             AS RCPT_NUM,
			CR.DS_ACCT_NUM          AS DS_ACCT_NUM,
			CR.INVTY_TRX_PK         AS INVTY_TRX_PK,
			CR.PO_ORD_NUM           AS PO_ORD_NUM
	       ,CR.JRNL_QTY             AS JRNL_QTY
	       ,CR.PRNT_DS_ASSET_MSTR_PK AS PRNT_DS_ASSET_MSTR_PK
	       ,CR.MAN_JRNL_ENTRY_HDR_PK AS MAN_JRNL_ENTRY_HDR_PK
		   ,(CASE WHEN CR.SVC_MACH_MSTR_PK = 0 
			      THEN NULL
			      ELSE CR.SVC_MACH_MSTR_PK END)     AS SVC_MACH_MSTR_PK,
			(CASE WHEN CR.JRNL_ENTRY_FIRST_REF_TXT IS NOT NULL 
			      THEN CR.JRNL_ENTRY_FIRST_ATTRB_NM||':'||CR.JRNL_ENTRY_FIRST_REF_TXT
			      ELSE '' END)  AS JRNL_ENTRY_FIRST_REF_TXT,
			(CASE WHEN CR.JRNL_ENTRY_SCD_REF_TXT IS NOT NULL 
			      THEN CR.JRNL_ENTRY_SCD_ATTRB_NM||':'||CR.JRNL_ENTRY_SCD_REF_TXT
			      ELSE '' END)     AS JRNL_ENTRY_SCD_REF_TXT,
			(CASE WHEN CR.JRNL_ENTRY_THIRD_REF_TXT IS NOT NULL 
			      THEN CR.JRNL_ENTRY_THIRD_ATTRB_NM||':'||CR.JRNL_ENTRY_THIRD_REF_TXT 
			      ELSE '' END) AS JRNL_ENTRY_THIRD_REF_TXT,
			(CASE WHEN CR.JRNL_ENTRY_FRTH_REF_TXT IS NOT NULL
			      THEN CR.JRNL_ENTRY_FRTH_ATTRB_NM||':'||CR.JRNL_ENTRY_FRTH_REF_TXT
			      ELSE '' END) AS JRNL_ENTRY_FRTH_REF_TXT,
			(CASE WHEN (CR.JRNL_ENTRY_FIFTH_REF_TXT IS NOT NULL AND CR.JRNL_ENTRY_FIFTH_ATTRB_NM IS NOT NULL)
			      THEN CR.JRNL_ENTRY_FIFTH_ATTRB_NM||':'||CR.JRNL_ENTRY_FIFTH_REF_TXT
			      ELSE '' END) AS JRNL_ENTRY_FIFTH_REF_TXT
            <!-- START 2017/03/16 [QC#14205,ADD] -->
             , CR.EZINTIME                    AS XX_REC_HIST_CRAT_TS
             , CR.EZUPTIME                    AS XX_REC_HIST_UPD_TS
             , CR.EZTABLEID                   AS XX_REC_HIST_TBL_NM
             ,CASE WHEN IN_AP.MID_NM IS NULL AND IN_AP.FIRST_NM IS NULL THEN CR.EZINUSERID
                   WHEN IN_AP.MID_NM IS NULL THEN CR.EZINUSERID || ' : ' || IN_AP.FIRST_NM || ' ' || IN_AP.LAST_NM
                   WHEN IN_AP.MID_NM IS NOT NULL THEN CR.EZINUSERID || ' : ' || IN_AP.FIRST_NM || IN_AP.MID_NM || ' ' || IN_AP.LAST_NM
                   ELSE CR.EZINUSERID
              END AS XX_REC_HIST_CRAT_BY_NM
             ,CASE WHEN UP_AP.MID_NM IS NULL AND UP_AP.FIRST_NM IS NULL THEN CR.EZUPUSERID
                   WHEN UP_AP.MID_NM IS NULL THEN CR.EZUPUSERID || ' : ' || UP_AP.FIRST_NM || ' ' || UP_AP.LAST_NM
                   WHEN UP_AP.MID_NM IS NOT NULL THEN CR.EZUPUSERID || ' : ' || UP_AP.FIRST_NM || UP_AP.MID_NM || ' ' || UP_AP.LAST_NM
                   ELSE CR.EZUPUSERID
              END AS XX_REC_HIST_UPD_BY_NM
            <!-- END   2017/03/16 [QC#14205,ADD] -->
            <!-- START 2019/08/20 S.Takami [QC#51897,ADD] -->
           ,(CASE WHEN CR.SVC_CONFIG_MSTR_PK = 0 
                  THEN NULL
                  ELSE CR.SVC_CONFIG_MSTR_PK END)     AS SVC_CONFIG_MSTR_PK
            <!-- END 2019/08/20 S.Takami [QC#51897,ADD] -->
		FROM 
		    JE_CRDR CR
		    <!-- START 2016/08/25 S.Fujita [QC#4105,ADD] -->
		    ,ORG_FUNC_ASG       OFA
            ,S21_PSN            SP
		    <!-- END   2016/08/25 S.Fujita [QC#4105,ADD] -->
            ,AUTH_PSN    IN_AP
            ,AUTH_PSN    UP_AP
		WHERE
		    CR.CR_COA_CMPY_CD IS NOT NULL
		<isEqual property="hasCrDrCondtion" compareValue="Y" >
			    AND CR.GLBL_CMPY_CD 	= #glblCmpyCd#
			    	
			    <!-- 2016/06/01 Exclude the dummy entry generated by manual journal entry -->
			    AND CR.CR_COA_BR_CD IS NOT NULL
			    <!-- end 2016/06/01 -->
			    
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.jrnlDealDrAmt_FM">
				<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
				AND (CR.JRNL_DEAL_CR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
				AND  CR.JRNL_DEAL_CR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#)
				</isNotNull>
				<isNull property="bizMsg.jrnlDealDrAmt_TO">
				AND CR.JRNL_DEAL_CR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
				</isNull>
			</isNotNull>
			<isNull property="bizMsg.jrnlDealDrAmt_FM">
				<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
					AND  CR.JRNL_DEAL_CR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#
				</isNotNull>
			</isNull>
			
			<isNotNull property="bizMsg.coaCmpyCd">
				AND	CR.CR_COA_CMPY_CD 	= #bizMsg.coaCmpyCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaBrCd">
				AND	CR.CR_COA_BR_CD 	LIKE #bizMsg.coaBrCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaCcCd">
				AND	CR.CR_COA_CC_CD 	LIKE #bizMsg.coaCcCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaAcctCd">
				AND	CR.CR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaProdCd">
				AND	CR.CR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaChCd">
				AND	CR.CR_COA_CH_CD 	LIKE #bizMsg.coaChCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaAfflCd">
				AND	CR.CR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaProjCd">
				AND	CR.CR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaExtnCd">
				AND	CR.CR_COA_EXTN_CD 	LIKE #bizMsg.coaExtnCd#
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
		</isEqual>
		<!-- START 2016/08/25 S.Fujita [QC#4105,ADD] -->
		    AND CR.GLBL_CMPY_CD             = OFA.GLBL_CMPY_CD (+)
            AND CR.TOC_CD                   = OFA.TOC_CD (+)
            AND OFA.EZCANCELFLAG (+)        = '0'
            AND OFA.GLBL_CMPY_CD            = SP.GLBL_CMPY_CD (+)
            AND OFA.PSN_CD                  = SP.PSN_CD (+)
            AND SP.EFF_FROM_DT (+)      &lt;= CR.GL_DT
            AND NVL(SP.EFF_THRU_DT (+),'99991231')   &gt;= CR.GL_DT
            AND SP.EZCANCELFLAG (+)         = '0'
        <!-- END   2016/08/25 S.Fujita [QC#4105,ADD] -->
            AND CR.GLBL_CMPY_CD          = IN_AP.GLBL_CMPY_CD(+)
            AND UPPER(CR.EZINUSERID)     = UPPER(IN_AP.USR_NM(+))
            AND IN_AP.EZCANCELFLAG(+)    = '0'
            AND CR.GLBL_CMPY_CD          = UP_AP.GLBL_CMPY_CD(+)
            AND UPPER(CR.EZUPUSERID)     = UPPER(UP_AP.USR_NM(+))
            AND UP_AP.EZCANCELFLAG(+)    = '0'
		ORDER BY
			 JRNL_ENTRY_PK
			,DR_OR_CR
	</statement>

	<statement id="getResultArReclass"  parameterClass="Map" resultMap="result.NFAL0120_ASMsg">
	SELECT 
        COA_CMPY_CD									AS COA_CMPY_CD,
        COA_BR_CD 									AS COA_BR_CD,
        COA_CC_CD									AS COA_CC_CD,
        COA_ACCT_CD									AS COA_ACCT_CD,
        INTFC_COA_PROD_CD							AS COA_PROD_CD_DC,
        COA_CH_CD									AS COA_CH_CD,
        COA_AFFL_CD									AS COA_AFFL_CD,
        COA_PROJ_CD									AS COA_PROJ_CD,
        COA_EXTN_CD									AS COA_EXTN_CD,
        NVL(JRNL_FUNC_DR_AMT,INTFC_FUNC_ACCT_AMT) 	AS JRNL_FUNC_DR_AMT,
        NVL(JRNL_FUNC_CR_AMT,0) 					AS JRNL_FUNC_CR_AMT
    FROM 
        (SELECT
            COA_CMPY_CD             AS COA_CMPY_CD,
            COA_BR_CD               AS COA_BR_CD,
            COA_CC_CD               AS COA_CC_CD,
            COA_ACCT_CD             AS COA_ACCT_CD,
            COA_PROD_CD_DC          AS COA_PROD_CD_DC,
            COA_CH_CD               AS COA_CH_CD,
            COA_AFFL_CD             AS COA_AFFL_CD,
            COA_PROJ_CD             AS COA_PROJ_CD,
            COA_EXTN_CD             AS COA_EXTN_CD,
            SUM(JRNL_FUNC_DR_AMT)   AS JRNL_FUNC_DR_AMT,
            SUM(JRNL_FUNC_CR_AMT)   AS JRNL_FUNC_CR_AMT
         FROM 
            ((SELECT
                   DR.DR_COA_CMPY_CD       AS COA_CMPY_CD,
                   DR.DR_COA_BR_CD         AS COA_BR_CD,
                   DR.DR_COA_CC_CD         AS COA_CC_CD,
                   DR.DR_COA_ACCT_CD       AS COA_ACCT_CD,
                   DR.DR_COA_PROD_CD       AS COA_PROD_CD_DC,
                   DR.DR_COA_CH_CD         AS COA_CH_CD,
                   DR.DR_COA_AFFL_CD       AS COA_AFFL_CD,
                   DR.DR_COA_PROJ_CD       AS COA_PROJ_CD,
                   DR.DR_COA_EXTN_CD       AS COA_EXTN_CD,
                   DR.JRNL_FUNC_DR_AMT     AS JRNL_FUNC_DR_AMT,
                   0                       AS JRNL_FUNC_CR_AMT
               FROM 
                   <isEqual property="archived" compareValue="Y" >
					JRNL_ENTRY_ARC DR
				   </isEqual>
				   <isNotEqual property="archived" compareValue="Y">
						JRNL_ENTRY DR
				   </isNotEqual>	
               WHERE
                   DR.GLBL_CMPY_CD     = #glblCmpyCd#
               AND    DR.EZCANCELFLAG  = '0'
               AND    DR.GL_DT         LIKE #glDtYYYYMM#
               AND    DR.TRX_CD        = #trxCdArRcls#
               AND    DR.TRX_RSN_CD    = #trxRsnCdArRcls#
             )
            UNION ALL
             (SELECT
                  CR.CR_COA_CMPY_CD       AS COA_CMPY_CD,
                  CR.CR_COA_BR_CD         AS COA_BR_CD,
                  CR.CR_COA_CC_CD         AS COA_CC_CD,
                  CR.CR_COA_ACCT_CD       AS COA_ACCT_CD,
                  CR.CR_COA_PROD_CD       AS COA_PROD_CD_DC,
                  CR.CR_COA_CH_CD         AS COA_CH_CD,
                  CR.CR_COA_AFFL_CD       AS COA_AFFL_CD,
                  CR.CR_COA_PROJ_CD       AS COA_PROJ_CD,
                  CR.CR_COA_EXTN_CD       AS COA_EXTN_CD,
                  0                       AS JRNL_FUNC_DR_AMT,
                  CR.JRNL_FUNC_CR_AMT     AS JRNL_FUNC_CR_AMT
               FROM 
                  <isEqual property="archived" compareValue="Y" >
					JRNL_ENTRY_ARC CR
				   </isEqual>
				   <isNotEqual property="archived" compareValue="Y">
						JRNL_ENTRY CR
				   </isNotEqual>	
               WHERE
                   CR.GLBL_CMPY_CD     = #glblCmpyCd#
               AND    CR.EZCANCELFLAG  = '0'
               AND    CR.GL_DT         LIKE #glDtYYYYMM#
               AND    CR.TRX_CD        = #trxCdArRcls#
               AND    CR.TRX_RSN_CD    = #trxRsnCdArRcls#
             )
            )
        GROUP BY 
            COA_CMPY_CD,
            COA_BR_CD,
            COA_CC_CD,
            COA_ACCT_CD,
            COA_PROD_CD_DC,
            COA_CH_CD,
            COA_AFFL_CD,
            COA_PROJ_CD,
            COA_EXTN_CD
        ORDER BY 
            COA_CMPY_CD,
            COA_BR_CD,
            COA_CC_CD,
            COA_ACCT_CD,
            COA_PROD_CD_DC,
            COA_CH_CD,
            COA_AFFL_CD,
            COA_PROJ_CD,
            COA_EXTN_CD
        ) JE
       ,(SELECT
             COA_PROD_CD             AS INTFC_COA_PROD_CD,
             SUM(DEAL_ACCT_AMT)      AS INTFC_FUNC_ACCT_AMT
         FROM
             AJE_AR_INTFC
         WHERE 
             GLBL_CMPY_CD     = #glblCmpyCd#
         AND    EZCANCELFLAG  = '0'
         AND    GL_DT         LIKE #glDtYYYYMM#
         AND    TRX_CD        = #trxCdArRcls#
         AND    TRX_RSN_CD    = #trxRsnCdArRcls#
         GROUP BY 
            COA_PROD_CD
        ) AAI 
    WHERE 1=1
    AND JE.COA_PROD_CD_DC(+) = AAI.INTFC_COA_PROD_CD
	</statement>

	<resultMap id="result.NFAL0120_ASMsg" class="NFAL0120_ASMsg">	
		<result property="jrnlEntryPk_A"	column="JRNL_ENTRY_PK" 		javaType="EZDSBigDecimalItem"/>
		
		<result property="glDt_A"			column="GL_DT"				javaType="EZDSDateItem"/>
		<result property="glSendCpltFlg_A"	column="GL_SEND_CPLT_FLG"	javaType="EZDSStringItem"/>
		<result property="ajeId_A"			column="AJE_ID"				javaType="EZDSStringItem"/>
		<result property="jrnlSrcNm_A"		column="JRNL_SRC_NM"		javaType="EZDSStringItem"/>		
		<result property="jrnlCatgNm_A"		column="JRNL_CATG_NM"		javaType="EZDSStringItem"/>
		<result property="xxScrId_A"		column="DR_OR_CR"			javaType="EZDSStringItem"/>
		
		<result property="drCoaCmpyCd_A"	column="COA_CMPY_CD"		javaType="EZDSStringItem"/>
		<result property="drCoaBrCd_A"		column="COA_BR_CD"			javaType="EZDSStringItem"/>
		<result property="drCoaCcCd_A"		column="COA_CC_CD"			javaType="EZDSStringItem"/>
		<result property="drCoaAcctCd_A"	column="COA_ACCT_CD"		javaType="EZDSStringItem"/>
		<result property="drCoaProdCd_A"	column="COA_PROD_CD_DC"		javaType="EZDSStringItem"/>
		<result property="drCoaChCd_A"		column="COA_CH_CD"			javaType="EZDSStringItem"/>		
		<result property="drCoaAfflCd_A"	column="COA_AFFL_CD"		javaType="EZDSStringItem"/>
		<result property="drCoaProjCd_A"	column="COA_PROJ_CD"		javaType="EZDSStringItem"/>
		<result property="drCoaExtnCd_A"	column="COA_EXTN_CD"		javaType="EZDSStringItem"/>
		
		<result property="jrnlFuncDrAmt_A"	column="JRNL_FUNC_DR_AMT"	javaType="EZDSBigDecimalItem"/>
		<result property="jrnlFuncCrAmt_A"	column="JRNL_FUNC_CR_AMT"	javaType="EZDSBigDecimalItem"/>	
		
		<result property="coaProdCd_A"		column="COA_PROD_CD"		javaType="EZDSStringItem"/>
		<result property="tocCd_A"			column="TOC_CD"				javaType="EZDSStringItem"/>

		<!-- START 2016/08/25 S.Fujita [QC#4105,ADD] -->
		<result property="psnNum_A"			column="PSN_NUM"			javaType="EZDSStringItem"/>
		<!-- END   2016/08/25 S.Fujita [QC#4105,ADD] -->

		<result property="billToCustCd_A"	column="BILL_TO_CUST_CD"	javaType="EZDSStringItem"/>
		<result property="vndCd_A"			column="VND_CD"				javaType="EZDSStringItem"/>
		<result property="ajeInvNum_A"		column="AJE_INV_NUM"		javaType="EZDSStringItem"/>
		<result property="prmoPk_A"			column="PRMO_PK"			javaType="EZDSBigDecimalItem"/>
		<result property="ajeItemCd_A"		column="AJE_ITEM_CD"		javaType="EZDSStringItem"/>
		<!-- START 2018/06/22 S.Katsuma [QC#24025,ADD] -->
		<result property="ajeItemDescTxt_A"	column="AJE_ITEM_DESC_TXT"	javaType="EZDSStringItem"/>
		<!-- END 2018/06/22 S.Katsuma [QC#24025,ADD] -->
		<result property="soNum_A"			column="SO_NUM"				javaType="EZDSStringItem"/>		
		<result property="machConfigNum_A"	column="MACH_CONFIG_NUM"	javaType="EZDSStringItem"/>
		<result property="dsOrdTpCd_A"		column="DS_ORD_TP_CD"		javaType="EZDSStringItem"/>
		<result property="dsOrdRsnCd_A"		column="DS_ORD_RSN_CD"		javaType="EZDSStringItem"/>

		<result property="drCoaCmpyCd_B"	column="COA_CMPY_CD"		javaType="EZDSStringItem"/>
		<result property="drCoaBrCd_B"		column="COA_BR_CD"			javaType="EZDSStringItem"/>
		<result property="drCoaCcCd_B"		column="COA_CC_CD"			javaType="EZDSStringItem"/>
		<result property="drCoaAcctCd_B"	column="COA_ACCT_CD"		javaType="EZDSStringItem"/>
		<result property="drCoaProdCd_B"	column="COA_PROD_CD_DC"		javaType="EZDSStringItem"/>
		<result property="drCoaChCd_B"		column="COA_CH_CD"			javaType="EZDSStringItem"/>
		<result property="drCoaAfflCd_B"	column="COA_AFFL_CD"		javaType="EZDSStringItem"/>
		<result property="drCoaProjCd_B"	column="COA_PROJ_CD"		javaType="EZDSStringItem"/>
		<result property="drCoaExtnCd_B"	column="COA_EXTN_CD"		javaType="EZDSStringItem"/>
		
		<result property="jrnlFuncDrAmt_B"	column="JRNL_FUNC_DR_AMT"	javaType="EZDSBigDecimalItem"/>
		<result property="jrnlFuncCrAmt_B"	column="JRNL_FUNC_CR_AMT"	javaType="EZDSBigDecimalItem"/>
		
		<result property="xxComnScrCondValTxt_A" column="COA_ACCT_STRG"             javaType="EZDSStringItem"/>
		<result property="serNum_A"              column="SER_NUM"                   javaType="EZDSStringItem"/>
		<result property="rcptNum_A"             column="RCPT_NUM"                  javaType="EZDSStringItem"/>
		<result property="cpoOrdNum_A"           column="CPO_ORD_NUM"               javaType="EZDSStringItem"/>
		<result property="dsAcctNum_A"           column="DS_ACCT_NUM"               javaType="EZDSStringItem"/>
		<result property="svcMachMstrPk_A"       column="SVC_MACH_MSTR_PK"          javaType="EZDSBigDecimalItem"/>
		<result property="invtyTrxPk_A"          column="INVTY_TRX_PK"              javaType="EZDSBigDecimalItem"/>
		<result property="xxQueryFltrTxt_A1"     column="JRNL_ENTRY_FIRST_REF_TXT"  javaType="EZDSStringItem"/>
		<result property="xxQueryFltrTxt_A2"     column="JRNL_ENTRY_SCD_REF_TXT"    javaType="EZDSStringItem"/>
		<result property="xxQueryFltrTxt_A3"     column="JRNL_ENTRY_THIRD_REF_TXT"  javaType="EZDSStringItem"/>
		<result property="xxQueryFltrTxt_A4"     column="JRNL_ENTRY_FRTH_REF_TXT"   javaType="EZDSStringItem"/>
		<result property="xxQueryFltrTxt_A5"     column="JRNL_ENTRY_FIFTH_REF_TXT"  javaType="EZDSStringItem"/>
		
		<result property="poOrdNum_A"            column="PO_ORD_NUM"                javaType="EZDSStringItem"/>
		<result property="jrnlQty_A"             column="JRNL_QTY"                  javaType="EZDSBigDecimalItem"/>
		<result property="prntDsAssetMstrPk_A"   column="PRNT_DS_ASSET_MSTR_PK"     javaType="EZDSBigDecimalItem"/>
		<result property="manJrnlEntryHdrPk_A"   column="MAN_JRNL_ENTRY_HDR_PK"     javaType="EZDSBigDecimalItem"/>
		
        <!-- START 2017/03/16 [QC#14205,ADD] -->
        <result property="xxRecHistCratTs_A"     column="XX_REC_HIST_CRAT_TS"        javaType="EZDCStringItem"/>
        <result property="xxRecHistCratByNm_A"   column="XX_REC_HIST_CRAT_BY_NM"     javaType="EZDCStringItem"/>
        <result property="xxRecHistUpdTs_A"      column="XX_REC_HIST_UPD_TS"         javaType="EZDCStringItem"/>
        <result property="xxRecHistUpdByNm_A"    column="XX_REC_HIST_UPD_BY_NM"      javaType="EZDCStringItem"/>
        <result property="xxRecHistTblNm_A"      column="XX_REC_HIST_TBL_NM"         javaType="EZDCStringItem"/>
        <!-- END   2017/03/16 [QC#14205,ADD] -->
        <!-- START 2019/08/20 S.Takami [QC#51897,ADD] -->
        <result property="svcConfigMstrPk_A"     column="SVC_CONFIG_MSTR_PK"        javaType="EZDSBigDecimalItem"/>
        <!-- END 2019/08/20 S.Takami [QC#51897,ADD] -->
	</resultMap>
	
	<!-- Test -->
	<statement id="getResultDrCr"  parameterClass="Map" resultClass="Map">
		SELECT
			<!-- ROW_NUMBER() OVER (ORDER BY A.JRNL_ENTRY_PK ) AS ROW_NUMS, -->
			A.JRNL_ENTRY_PK   	AS JRNL_ENTRY_PK,
			A.GL_DT           	AS GL_DT,
			A.PROC_DT         	AS PROC_DT,
			A.AJE_ID          	AS AJE_ID,
			A.JRNL_SRC_NM     	AS JRNL_SRC_NM,
			A.JRNL_CATG_NM    	AS JRNL_CATG_NM,
			A.DR_COA_ACCT_CD	AS DR_COA_ACCT_CD,
			A.DR_COA_CMPY_CD	AS DR_COA_CMPY_CD,
			A.DR_COA_BR_CD		AS DR_COA_BR_CD,
			A.DR_COA_CC_CD		AS DR_COA_CC_CD,
			A.DR_COA_PROD_CD	AS DR_COA_PROD_CD,
			A.DR_COA_CH_CD		AS DR_COA_CH_CD,
			A.DR_COA_AFFL_CD	AS DR_COA_AFFL_CD,
			A.DR_COA_PROJ_CD	AS DR_COA_PROJ_CD,
			A.DR_COA_EXTN_CD	AS DR_COA_EXTN_CD,
			A.CR_COA_ACCT_CD	AS CR_COA_ACCT_CD,
			A.CR_COA_CMPY_CD	AS CR_COA_CMPY_CD,
			A.CR_COA_BR_CD		AS CR_COA_BR_CD,
			A.CR_COA_CC_CD		AS CR_COA_CC_CD,
			A.CR_COA_PROD_CD	AS CR_COA_PROD_CD,
			A.CR_COA_CH_CD		AS CR_COA_CH_CD,
			A.CR_COA_AFFL_CD	AS CR_COA_AFFL_CD,
			A.CR_COA_PROJ_CD	AS CR_COA_PROJ_CD,
			A.CR_COA_EXTN_CD	AS CR_COA_EXTN_CD,
			A.JRNL_FUNC_DR_AMT  AS JRNL_FUNC_DR_AMT,
			A.JRNL_FUNC_CR_AMT  AS JRNL_FUNC_CR_AMT,
			A.COA_PROD_CD		AS COA_PROD_CD,
			A.TOC_CD			AS TOC_CD,
			A.BILL_TO_CUST_CD  	AS BILL_TO_CUST_CD,
			A.VND_CD  			AS VND_CD,
			A.AJE_INV_NUM  		AS AJE_INV_NUM,
			A.PRMO_PK  			AS PRMO_PK,
			A.AJE_ITEM_CD  		AS AJE_ITEM_CD,
			A.SO_NUM			AS SO_NUM
		FROM 
			<isEqual property="archived" compareValue="Y" >
				JRNL_ENTRY_ARC A
			</isEqual>
			<isNotEqual property="archived" compareValue="Y">
				JRNL_ENTRY A
			</isNotEqual>	
		WHERE
			A.GLBL_CMPY_CD 	= #glblCmpyCd#
		AND	A.EZCANCELFLAG 	= '0'
		<isNull property="bizMsg.glDt_TO">   
		  AND	A.GL_DT 			= #glDt_FR#
		</isNull>			  
		<isNotNull property="bizMsg.glDt_TO">   
		  AND	A.GL_DT 			BETWEEN TO_CHAR(#glDt_FR#) AND TO_CHAR(#glDt_TO#)
		</isNotNull>
		<isNotNull	property="bizMsg.sysSrcCd_3">   
		  AND	A.JRNL_SRC_CD 		= #sysSrcCd#
		</isNotNull>			
		<isNotNull	property="bizMsg.trxCd_3">   
		  AND	A.TRX_CD 			= #trxCd#
		</isNotNull>
		<isNotNull	property="bizMsg.trxRsnCd_3">   
		  AND	A.TRX_RSN_CD 		= #trxRsnCd#
		</isNotNull>
        <!-- START 2017/12/04 MOD QC#12525 -->
		<isNotNull property="bizMsg.coaBrCd">   
		  AND ( A.DR_COA_BR_CD 		LIKE #bizMsg.coaBrCd#		OR		A.CR_COA_BR_CD LIKE #bizMsg.coaBrCd# )
		</isNotNull>
		<isNotNull property="bizMsg.coaCcCd">   
		  AND ( A.DR_COA_CC_CD 		LIKE #bizMsg.coaCcCd#		OR		A.CR_COA_CC_CD LIKE #bizMsg.coaCcCd# )
		</isNotNull>
		<isNotNull property="bizMsg.coaAcctCd">   
		  AND ( A.DR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd#	OR		A.CR_COA_ACCT_CD LIKE #bizMsg.coaAcctCd# )
		</isNotNull>
		<isNotNull property="bizMsg.coaProdCd">   
		  AND ( A.DR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd#	OR		A.CR_COA_PROD_CD LIKE #bizMsg.coaProdCd# )
		</isNotNull>
		<isNotNull property="bizMsg.coaChCd">
		  AND ( A.DR_COA_CH_CD 		LIKE #bizMsg.coaChCd#		OR		A.CR_COA_CH_CD LIKE #bizMsg.coaChCd# )
		</isNotNull>
		<isNotNull property="bizMsg.coaAfflCd">
		  AND ( A.DR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd#	OR		A.CR_COA_AFFL_CD LIKE #bizMsg.coaAfflCd# )
		</isNotNull>
		<isNotNull property="bizMsg.coaProjCd">   
		  AND ( A.DR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd#	OR		A.CR_COA_PROJ_CD LIKE #bizMsg.coaProjCd# )
		</isNotNull>
        <!-- END   2017/12/04 MOD QC#12525 -->
		<isNotNull property="bizMsg.billToCustCd">   
		  AND A.BILL_TO_CUST_CD 	LIKE #billToCustCd# 
		</isNotNull>
		<isNotNull property="bizMsg.vndCd">   
		  AND A.VND_CD 				LIKE #vndCd# 
		</isNotNull>			
		<isNotNull property="bizMsg.ajeInvNum">   
		  AND A.AJE_INV_NUM 		LIKE #ajeInvNum# 
		</isNotNull>
		<isNotNull property="bizMsg.prmoPk">   
		  AND A.PRMO_PK 			LIKE #prmoPk# 
		</isNotNull>
		<isNotNull property="bizMsg.ajeItemCd">   
		  AND A.AJE_ITEM_CD 		LIKE #ajeItemCd# 
		</isNotNull>
        <!-- START 2017/12/04 MOD QC#12525 -->
		<isNotNull property="bizMsg.coaProdCd">   
		  AND A.COA_PROD_CD 		LIKE #bizMsg.coaProdCd# 
		</isNotNull>
        <!-- END   2017/12/04 MOD QC#12525 -->
		<isNotNull property="bizMsg.tocCd">   
		  AND A.TOC_CD 				LIKE #tocCd# 
		</isNotNull>
		<isNotNull property="bizMsg.soNum">   
		  AND A.SO_NUM 				LIKE #soNum# 
		</isNotNull>
		  AND ROWNUM &lt; #rowNum#
	</statement>
	
	<!-- *****************************************************  For Report (Start)***************************************************** -->
	<statement id="getResultDrForReport"  parameterClass="Map" resultClass="Map">
			  SELECT
					DR.JRNL_ENTRY_PK   	AS JRNL_ENTRY_PK,
					DR.GL_DT           	AS GL_DT,
					DR.PROC_DT         	AS PROC_DT,
					DR.AJE_ID          	AS AJE_ID,
					DR.JRNL_SRC_NM     	AS JRNL_SRC_NM,
					DR.JRNL_CATG_NM    	AS JRNL_CATG_NM,
					'1'             	AS DR_OR_CR,
					DR.DR_COA_ACCT_CD		AS COA_ACCT_CD,
					DR.DR_COA_CMPY_CD		AS COA_CMPY_CD,
					DR.DR_COA_BR_CD		AS COA_BR_CD,
					DR.DR_COA_CC_CD		AS COA_CC_CD,
					DR.DR_COA_PROD_CD		AS COA_PROD_CD_DC,
					DR.DR_COA_CH_CD		AS COA_CH_CD,
					DR.DR_COA_AFFL_CD		AS COA_AFFL_CD,
					DR.DR_COA_PROJ_CD		AS COA_PROJ_CD,
					DR.DR_COA_EXTN_CD		AS COA_EXTN_CD,
					DR.JRNL_FUNC_DR_AMT  	AS JRNL_FUNC_DR_AMT,
					DR.JRNL_FUNC_CR_AMT  	AS JRNL_FUNC_CR_AMT,
					DR.COA_PROD_CD			AS COA_PROD_CD,
					DR.TOC_CD				AS TOC_CD,
					DR.BILL_TO_CUST_CD  	AS BILL_TO_CUST_CD,
					DR.VND_CD  			AS VND_CD,
					DR.AJE_INV_NUM  		AS AJE_INV_NUM,
					DR.PRMO_PK  			AS PRMO_PK,
					DR.AJE_ITEM_CD  		AS AJE_ITEM_CD,
					DR.SO_NUM				AS SO_NUM
			  FROM 
				<isEqual property="archived" compareValue="Y" >
					JRNL_ENTRY_ARC DR
				</isEqual>
				<isNotEqual property="archived" compareValue="Y">
						JRNL_ENTRY DR
				</isNotEqual>	
			  WHERE
			    	DR.GLBL_CMPY_CD 	= #glblCmpyCd#
			  AND	DR.EZCANCELFLAG 	= '0'
			<isNull property="bizMsg.glDt_TO">   
			  AND	DR.GL_DT 			= #glDt_FR#
			</isNull>
			<isNotNull property="bizMsg.glDt_TO">   
			  AND	DR.GL_DT 			BETWEEN TO_CHAR(#glDt_FR#) AND TO_CHAR(#glDt_TO#)
			</isNotNull>
			<isNotNull	property="bizMsg.sysSrcCd_3">   
			  AND	DR.JRNL_SRC_CD 		= #sysSrcCd#
			</isNotNull>			
			<isNotNull	property="bizMsg.trxCd_3">   
			  AND	DR.TRX_CD 		= #trxCd#
			</isNotNull>
			<isNotNull	property="bizMsg.trxRsnCd_3">   
			  AND	DR.TRX_RSN_CD 		= #trxRsnCd#
			</isNotNull>
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.coaBrCd">   
			  AND	DR.DR_COA_BR_CD 	LIKE #bizMsg.coaBrCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaCcCd">   
			  AND	DR.DR_COA_CC_CD 	LIKE #bizMsg.coaCcCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAcctCd">   
			  AND	DR.DR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProdCd">   
			  AND	DR.DR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaChCd">   
			  AND	DR.DR_COA_CH_CD 	LIKE #bizMsg.coaChCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAfflCd">   
			  AND	DR.DR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProjCd">   
			  AND	DR.DR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd# 
			</isNotNull>			
            <!-- END   2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.billToCustCd">   
			  AND	DR.BILL_TO_CUST_CD 	LIKE #billToCustCd# 
			</isNotNull>
			<isNotNull property="bizMsg.vndCd">   
			  AND	DR.VND_CD 			LIKE #vndCd# 
			</isNotNull>			
			<isNotNull property="bizMsg.ajeInvNum">   
			  AND	DR.AJE_INV_NUM 		LIKE #ajeInvNum# 
			</isNotNull>
			<isNotNull property="bizMsg.prmoPk">   
			  AND	DR.PRMO_PK 			LIKE #prmoPk# 
			</isNotNull>
			<isNotNull property="bizMsg.ajeItemCd">   
			  AND	DR.AJE_ITEM_CD 		LIKE #ajeItemCd# 
			</isNotNull>
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.coaProdCd">   
			  AND	DR.COA_PROD_CD 		LIKE #bizMsg.coaProdCd# 
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.tocCd">   
			  AND	DR.TOC_CD 			LIKE #tocCd# 
			</isNotNull>
			<isNotNull property="bizMsg.soNum">   
			  AND	DR.SO_NUM 			LIKE #soNum# 
			</isNotNull>
			<isEqual property="suppressReclass" compareValue="Y">
			  AND 
				(
				  (
				      DR.TRX_CD = #trxCdReclass#
				      AND DR.TRX_RSN_CD NOT IN 
				      	<iterate property="trxRsnCdList" var="trxRsnCd[]" open="(" close=")" conjunction=",">
							#trxRsnCd[]#
						</iterate>
				  )
				  OR DR.TRX_CD != #trxCdReclass#
				)
			</isEqual>
	</statement>

	<statement id="getResultCrForReport"  parameterClass="Map" resultClass="Map">
			  SELECT
				    CR.JRNL_ENTRY_PK   	AS JRNL_ENTRY_PK,
				    CR.GL_DT           	AS GL_DT,
				    CR.PROC_DT         	AS PROC_DT,
				    CR.AJE_ID          	AS AJE_ID,
				    CR.JRNL_SRC_NM     	AS JRNL_SRC_NM,
				    CR.JRNL_CATG_NM    	AS JRNL_CATG_NM,
				    '2'             	AS DR_OR_CR,
				    CR.CR_COA_ACCT_CD		AS COA_ACCT_CD,
				    CR.CR_COA_CMPY_CD		AS COA_CMPY_CD,
				    CR.CR_COA_BR_CD		AS COA_BR_CD,
				    CR.CR_COA_CC_CD		AS COA_CC_CD,
				    CR.CR_COA_PROD_CD		AS COA_PROD_CD_DC,
				    CR.CR_COA_CH_CD		AS COA_CH_CD,
				    CR.CR_COA_AFFL_CD		AS COA_AFFL_CD,
				    CR.CR_COA_PROJ_CD		AS COA_PROJ_CD,
				    CR.CR_COA_EXTN_CD		AS COA_EXTN_CD,
				    CR.JRNL_FUNC_DR_AMT  	AS JRNL_FUNC_DR_AMT,
				    CR.JRNL_FUNC_CR_AMT  	AS JRNL_FUNC_CR_AMT,
					CR.COA_PROD_CD			AS COA_PROD_CD,
					CR.TOC_CD				AS TOC_CD,
					CR.BILL_TO_CUST_CD  	AS BILL_TO_CUST_CD,
					CR.VND_CD  			AS VND_CD,
					CR.AJE_INV_NUM  		AS AJE_INV_NUM,
					CR.PRMO_PK  			AS PRMO_PK,
					CR.AJE_ITEM_CD  		AS AJE_ITEM_CD,
					CR.SO_NUM				AS SO_NUM
			  FROM 
			    <isEqual property="archived" compareValue="Y" >
					JRNL_ENTRY_ARC CR
				</isEqual>
				<isNotEqual property="archived" compareValue="Y">
					JRNL_ENTRY CR
				</isNotEqual>	
			  WHERE
			    	CR.GLBL_CMPY_CD 	= #glblCmpyCd#
			  AND	CR.EZCANCELFLAG 	= '0'
			<isNull property="bizMsg.glDt_TO">   
			  AND	CR.GL_DT 			= #glDt_FR#
			</isNull>			  
			<isNotNull property="bizMsg.glDt_TO">   
			  AND	CR.GL_DT 			BETWEEN TO_CHAR(#glDt_FR#) AND TO_CHAR(#glDt_TO#)
			</isNotNull>
			<isNotNull	property="bizMsg.sysSrcCd_3">   
			  AND	CR.JRNL_SRC_CD 		= #sysSrcCd#
			</isNotNull>			
			<isNotNull	property="bizMsg.trxCd_3">   
			  AND	CR.TRX_CD 		= #trxCd#
			</isNotNull>
			<isNotNull	property="bizMsg.trxRsnCd_3">   
			  AND	CR.TRX_RSN_CD 		= #trxRsnCd#
			</isNotNull>
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.coaBrCd">   
			  AND	CR.CR_COA_BR_CD 	LIKE #bizMsg.coaBrCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaCcCd">   
			  AND	CR.CR_COA_CC_CD 	LIKE #bizMsg.coaCcCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAcctCd">   
			  AND	CR.CR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProdCd">   
			  AND	CR.CR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaChCd">   
			  AND	CR.CR_COA_CH_CD 	LIKE #bizMsg.coaChCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAfflCd">
			  AND	CR.CR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProjCd">   
			  AND	CR.CR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd# 
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.billToCustCd">   
			  AND	CR.BILL_TO_CUST_CD 	LIKE #billToCustCd# 
			</isNotNull>
			<isNotNull property="bizMsg.vndCd">   
			  AND	CR.VND_CD 			LIKE #vndCd# 
			</isNotNull>			
			<isNotNull property="bizMsg.ajeInvNum">   
			  AND	CR.AJE_INV_NUM 		LIKE #ajeInvNum# 
			</isNotNull>
			<isNotNull property="bizMsg.prmoPk">   
			  AND	CR.PRMO_PK 			LIKE #prmoPk# 
			</isNotNull>
			<isNotNull property="bizMsg.ajeItemCd">   
			  AND	CR.AJE_ITEM_CD 		LIKE #ajeItemCd# 
			</isNotNull>
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.coaProdCd">   
			  AND	CR.COA_PROD_CD 		LIKE #bizMsg.coaProdCd# 
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.tocCd">   
			  AND	CR.TOC_CD 			LIKE #tocCd# 
			</isNotNull>
			<isNotNull property="bizMsg.soNum">   
			  AND	CR.SO_NUM 			LIKE #soNum# 
			</isNotNull>
			<isEqual property="suppressReclass" compareValue="Y">
			  AND 
				(
				  (
				      CR.TRX_CD = #trxCdReclass#
				      AND CR.TRX_RSN_CD NOT IN 
				      	<iterate property="trxRsnCdList" var="trxRsnCd[]" open="(" close=")" conjunction=",">
							#trxRsnCd[]#
						</iterate>
				  )
				  OR CR.TRX_CD != #trxCdReclass#
				)
			</isEqual>
	</statement>
	
	<statement id="countResultDr"  parameterClass="Map" resultClass="Map">
			  SELECT
					COUNT(1) AS DR_TOT_COUNT
			  FROM 
			    <isEqual property="archived" compareValue="Y" >
					JRNL_ENTRY_ARC DR
				</isEqual>
				<isNotEqual property="archived" compareValue="Y">
					JRNL_ENTRY DR
				</isNotEqual>	
			  WHERE
			    	DR.GLBL_CMPY_CD 	= #glblCmpyCd#
			  AND	DR.EZCANCELFLAG 	= '0'
			<isNull property="bizMsg.glDt_TO">   
			  AND	DR.GL_DT 			= #glDt_FR#
			</isNull>
			<isNotNull property="bizMsg.glDt_TO">   
			  AND	DR.GL_DT 			BETWEEN TO_CHAR(#glDt_FR#) AND TO_CHAR(#glDt_TO#)
			</isNotNull>
			<isNotNull	property="bizMsg.sysSrcCd_3">   
			  AND	DR.JRNL_SRC_CD 		= #sysSrcCd#
			</isNotNull>			
			<isNotNull	property="bizMsg.trxCd_3">   
			  AND	DR.TRX_CD 		= #trxCd#
			</isNotNull>
			<isNotNull	property="bizMsg.trxRsnCd_3">   
			  AND	DR.TRX_RSN_CD 		= #trxRsnCd#
			</isNotNull>
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.coaBrCd">   
			  AND	DR.DR_COA_BR_CD 	LIKE #bizMsg.coaBrCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaCcCd">   
			  AND	DR.DR_COA_CC_CD 	LIKE #bizMsg.coaCcCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAcctCd">   
			  AND	DR.DR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProdCd">   
			  AND	DR.DR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaChCd">   
			  AND	DR.DR_COA_CH_CD 	LIKE #bizMsg.coaChCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAfflCd">   
			  AND	DR.DR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProjCd">   
			  AND	DR.DR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd# 
			</isNotNull>
			
			<!-- start CSA mod added reference text & extension & company -->
			<isNotNull property="bizMsg.coaCmpyCd">
				AND DR.DR_COA_CMPY_CD 	= #bizMsg.coaCmpyCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaExtnCd">
				AND DR.DR_COA_EXTN_CD 	LIKE #bizMsg.coaExtnCd#
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
            <!-- START 2016/12/20 MOD QC#16702-->
			<isEqual property="bizMsg.srchOptTxt" compareValue="INVTY_TRX_PK">
				AND	 INVTY_TRX_PK       = TO_NUMBER(#anyWord#)
			</isEqual>
			<isEqual property="bizMsg.srchOptTxt" compareValue="RCPT_NUM">
				AND	 RCPT_NUM           = #anyWord#
			</isEqual>
			<isNull  property="bizMsg.srchOptTxt">
			     <isNotNull property="anyWord">
				    AND UPPER(DR.JRNL_ENTRY_REF_TXT) LIKE #anyWord#
			     </isNotNull>
			</isNull>
            <!-- END 2016/12/20 MOD QC#16702-->
			<!-- end -->
			
			<isEqual property="suppressReclass" compareValue="Y">
			  AND 
				(
				  (
				      DR.TRX_CD = #trxCdReclass#
				      AND DR.TRX_RSN_CD NOT IN 
				      	<iterate property="trxRsnCdList" var="trxRsnCd[]" open="(" close=")" conjunction=",">
							#trxRsnCd[]#
						</iterate>
				  )
				  OR DR.TRX_CD != #trxCdReclass#
				)
			</isEqual>
	</statement>

	<statement id="countResultCr"  parameterClass="Map" resultClass="Map">
			  SELECT
					COUNT(1) AS CR_TOT_COUNT
			  FROM 
				<isEqual property="archived" compareValue="Y" >
					JRNL_ENTRY_ARC CR
				</isEqual>
				<isNotEqual property="archived" compareValue="Y">
					JRNL_ENTRY CR
				</isNotEqual>	
			  WHERE
			    	CR.GLBL_CMPY_CD 	= #glblCmpyCd#
			  AND	CR.EZCANCELFLAG 	= '0'
			<isNull property="bizMsg.glDt_TO">   
			  AND	CR.GL_DT 			= #glDt_FR#
			</isNull>			  
			<isNotNull property="bizMsg.glDt_TO">   
			  AND	CR.GL_DT 			BETWEEN TO_CHAR(#glDt_FR#) AND TO_CHAR(#glDt_TO#)
			</isNotNull>
			<isNotNull	property="bizMsg.sysSrcCd_3">   
			  AND	CR.JRNL_SRC_CD 		= #sysSrcCd#
			</isNotNull>			
			<isNotNull	property="bizMsg.trxCd_3">   
			  AND	CR.TRX_CD 		= #trxCd#
			</isNotNull>
			<isNotNull	property="bizMsg.trxRsnCd_3">   
			  AND	CR.TRX_RSN_CD 		= #trxRsnCd#
			</isNotNull>
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.coaBrCd">   
			  AND	CR.CR_COA_BR_CD 	LIKE #bizMsg.coaBrCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaCcCd">   
			  AND	CR.CR_COA_CC_CD 	LIKE #bizMsg.coaCcCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAcctCd">   
			  AND	CR.CR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProdCd">   
			  AND	CR.CR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaChCd">   
			  AND	CR.CR_COA_CH_CD 	LIKE #bizMsg.coaChCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAfflCd">
			  AND	CR.CR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProjCd">   
			  AND	CR.CR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd# 
			</isNotNull>
			
			<!-- start CSA mod added reference text & extension & company -->
			<isNotNull property="bizMsg.coaCmpyCd">
				AND CR.DR_COA_CMPY_CD 	= #bizMsg.coaCmpyCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaExtnCd">
				AND CR.DR_COA_EXTN_CD 	LIKE #bizMsg.coaExtnCd#
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
            <!-- START 2016/12/20 MOD QC#16702-->
			<isEqual property="bizMsg.srchOptTxt" compareValue="INVTY_TRX_PK">
				AND	 INVTY_TRX_PK       = #anyWord#
			</isEqual>
			<isEqual property="bizMsg.srchOptTxt" compareValue="RCPT_NUM">
				AND	 RCPT_NUM           = #anyWord#
			</isEqual>
			<isNull  property="bizMsg.srchOptTxt">
			     <isNotNull property="anyWord">
				    AND UPPER(CR.JRNL_ENTRY_REF_TXT) LIKE #anyWord#
			     </isNotNull>
			</isNull>
            <!-- END 2016/12/20 MOD QC#16702-->
			<!-- end -->
			
			<isEqual property="suppressReclass" compareValue="Y">
			  AND 
				(
				  (
				      CR.TRX_CD = #trxCdReclass#
				      AND CR.TRX_RSN_CD NOT IN 
				      	<iterate property="trxRsnCdList" var="trxRsnCd[]" open="(" close=")" conjunction=",">
							#trxRsnCd[]#
						</iterate>
				  )
				  OR CR.TRX_CD != #trxCdReclass#
				)
			</isEqual>
	</statement>
	
	<!-- *****************************************************  For Report (End)***************************************************** -->
	
	<!-- *****************************************************  For Total (Start)***************************************************** -->
	
	<statement id="getDebitTotal"  parameterClass="Map" resultClass="Map">
			  SELECT
			    	COUNT(DR.JRNL_ENTRY_PK)		AS DR_TOT_COUNT,
			    	SUM(DR.JRNL_FUNC_DR_AMT)	AS DR_TOT_AMT
			  FROM 
				<!-- START 2019/12/19 MOD QC#53730-->
			    <!--<isEqual property="archived" compareValue="Y" >-->
				<!--	JRNL_ENTRY_ARC DR-->
				<!--</isEqual>-->
				<!--<isNotEqual property="archived" compareValue="Y">-->
				<!--	JRNL_ENTRY DR-->
				<!--</isNotEqual>	-->
				        ALL_JRNL_ENTRY_V DR
				<!-- END   2019/12/19 MOD QC#53730-->
			  WHERE
			    	DR.GLBL_CMPY_CD 	= #glblCmpyCd#
			  AND	DR.DR_COA_CMPY_CD	IS NOT NULL
			  AND	DR.EZCANCELFLAG 	= '0'
			  
			<isNotNull property="bizMsg.glDt_FR">
				<isNotNull property="bizMsg.glDt_TO">
					AND	DR.GL_DT 			BETWEEN TO_CHAR(#glDt_FR#) AND TO_CHAR(#glDt_TO#)
				</isNotNull>
				<isNull property="bizMsg.glDt_TO">
					AND DR.GL_DT 	&gt;= #glDt_FR#
				</isNull>
			</isNotNull>
			<isNull property="bizMsg.glDt_FR">
				<isNotNull property="bizMsg.glDt_TO">   
			  		AND	DR.GL_DT 		&lt;= #glDt_TO#
				</isNotNull>   
			</isNull>	
			
			<isNotNull property="bizMsg.glPerNm">
				AND DR.GL_DT             LIKE #yyyymm#
			</isNotNull>
			
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull	property="bizMsg.jrnlCatgCd">
			    AND DR.JRNL_CATG_CD = #bizMsg.jrnlCatgCd#
			</isNotNull>
			<isNotNull	property="bizMsg.xxQueryFltrTxt_AT">
				<isNotNull	property="bizMsg.ajeTrxTpCd_3">
			    AND TO_CHAR(DR.$srchColNm$) = #bizMsg.xxQueryFltrTxt_AT#
				</isNotNull>
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
			
			<isNotNull property="bizMsg.jrnlDealDrAmt_FM">
				<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
				AND (DR.JRNL_DEAL_DR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
				AND  DR.JRNL_DEAL_DR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#)
				</isNotNull>
				<isNull property="bizMsg.jrnlDealDrAmt_TO">
				AND DR.JRNL_DEAL_DR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
				</isNull>
			</isNotNull>
			<isNull property="bizMsg.jrnlDealDrAmt_FM">
				<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
					AND  DR.JRNL_DEAL_DR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#
				</isNotNull>
			</isNull>
				
			<isNotNull	property="bizMsg.sysSrcCd_3">   
			  AND	DR.JRNL_SRC_CD 		= #sysSrcCd#
			</isNotNull>			
			<isNotNull	property="bizMsg.trxCd_3">   
			  AND	DR.TRX_CD 		= #trxCd#
			</isNotNull>
			<isNotNull	property="bizMsg.trxRsnCd_3">   
			  AND	DR.TRX_RSN_CD 		= #trxRsnCd#
			</isNotNull>
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.coaBrCd">   
			  AND	DR.DR_COA_BR_CD 	LIKE #bizMsg.coaBrCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaCcCd">   
			  AND	DR.DR_COA_CC_CD 	LIKE #bizMsg.coaCcCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAcctCd">   
			  AND	DR.DR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProdCd">   
			  AND	DR.DR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaChCd">   
			  AND	DR.DR_COA_CH_CD 	LIKE #bizMsg.coaChCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAfflCd">   
			  AND	DR.DR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProjCd">   
			  AND	DR.DR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd# 
			</isNotNull>
			
			<!-- start CSA mod added reference text & extension & company -->
			<isNotNull property="bizMsg.coaCmpyCd">
				AND DR.DR_COA_CMPY_CD 	= #bizMsg.coaCmpyCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaExtnCd">
				AND DR.DR_COA_EXTN_CD 	LIKE #bizMsg.coaExtnCd#
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
            <!-- START 2016/12/20 MOD QC#16702-->
			<isEqual property="bizMsg.srchOptTxt" compareValue="INVTY_TRX_PK">
				AND	 INVTY_TRX_PK       = TO_NUMBER(#anyWord#)
			</isEqual>
			<isEqual property="bizMsg.srchOptTxt" compareValue="RCPT_NUM">
				AND	 RCPT_NUM           = #anyWord#
			</isEqual>
			<isNull  property="bizMsg.srchOptTxt">
			     <isNotNull property="anyWord">
				    AND UPPER(DR.JRNL_ENTRY_REF_TXT) LIKE #anyWord#
			     </isNotNull>
			</isNull>
            <!-- END 2016/12/20 MOD QC#16702-->
			<!-- end -->

			<isNotNull property="tocCd">
					AND	 SUBSTRB(UPPER(JRNL_ENTRY_REF_TXT), INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 1) + 1, INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 2) - (INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 1) + 1)) = #tocCd# 
			</isNotNull>

	</statement>
	
	<statement id="getCreditTotal"  parameterClass="Map" resultClass="Map">
			  SELECT
			    	COUNT(CR.JRNL_ENTRY_PK)		AS CR_TOT_COUNT,
			    	SUM(CR.JRNL_FUNC_CR_AMT)	AS CR_TOT_AMT
			  FROM 
				<!-- START 2019/12/19 MOD QC#53730-->
			    <!--<isEqual property="archived" compareValue="Y" >-->
				<!--	JRNL_ENTRY_ARC CR-->
				<!--</isEqual>-->
				<!--<isNotEqual property="archived" compareValue="Y">-->
				<!--	JRNL_ENTRY CR-->
				<!--</isNotEqual>	-->
				        ALL_JRNL_ENTRY_V CR
				<!-- END   2019/12/19 MOD QC#53730-->
			  WHERE
			    	CR.GLBL_CMPY_CD 	= #glblCmpyCd#
			  AND	CR.CR_COA_CMPY_CD	IS NOT NULL
			  AND	CR.EZCANCELFLAG 	= '0'
			  
			<isNotNull property="bizMsg.glDt_FR">
				<isNotNull property="bizMsg.glDt_TO">
					AND	CR.GL_DT 			BETWEEN TO_CHAR(#glDt_FR#) AND TO_CHAR(#glDt_TO#)
				</isNotNull>
				<isNull property="bizMsg.glDt_TO">
					AND CR.GL_DT 	&gt;= #glDt_FR#
				</isNull>
			</isNotNull>
			<isNull property="bizMsg.glDt_FR">
				<isNotNull property="bizMsg.glDt_TO">   
			  		AND	CR.GL_DT 		&lt;= #glDt_TO#
				</isNotNull>   
			</isNull>			  
			
			<isNotNull property="bizMsg.glPerNm">
					AND CR.GL_DT             LIKE #yyyymm#
			</isNotNull>
				
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull	property="bizMsg.jrnlCatgCd">
			    AND CR.JRNL_CATG_CD     = #bizMsg.jrnlCatgCd#
			</isNotNull>
			<isNotNull	property="bizMsg.xxQueryFltrTxt_AT">
				<isNotNull	property="bizMsg.ajeTrxTpCd_3">
			    AND TO_CHAR(CR.$srchColNm$) = #bizMsg.xxQueryFltrTxt_AT#
				</isNotNull>
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
			
			<isNotNull property="bizMsg.jrnlDealDrAmt_FM">
				<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
				AND (CR.JRNL_DEAL_CR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
				AND  CR.JRNL_DEAL_CR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#)
				</isNotNull>
				<isNull property="bizMsg.jrnlDealDrAmt_TO">
				AND CR.JRNL_DEAL_CR_AMT &gt;= #bizMsg.jrnlDealDrAmt_FM#
				</isNull>
			</isNotNull>
			<isNull property="bizMsg.jrnlDealDrAmt_FM">
				<isNotNull property="bizMsg.jrnlDealDrAmt_TO">
					AND  CR.JRNL_DEAL_CR_AMT &lt;= #bizMsg.jrnlDealDrAmt_TO#
				</isNotNull>
			</isNull>
			
			<isNotNull	property="bizMsg.sysSrcCd_3">   
			  AND	CR.JRNL_SRC_CD 		= #sysSrcCd#
			</isNotNull>			
			<isNotNull	property="bizMsg.trxCd_3">   
			  AND	CR.TRX_CD 		= #trxCd#
			</isNotNull>
			<isNotNull	property="bizMsg.trxRsnCd_3">   
			  AND	CR.TRX_RSN_CD 		= #trxRsnCd#
			</isNotNull>
            <!-- START 2017/12/04 MOD QC#12525 -->
			<isNotNull property="bizMsg.coaBrCd">   
			  AND	CR.CR_COA_BR_CD 	LIKE #bizMsg.coaBrCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaCcCd">   
			  AND	CR.CR_COA_CC_CD 	LIKE #bizMsg.coaCcCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAcctCd">   
			  AND	CR.CR_COA_ACCT_CD 	LIKE #bizMsg.coaAcctCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProdCd">   
			  AND	CR.CR_COA_PROD_CD 	LIKE #bizMsg.coaProdCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaChCd">   
			  AND	CR.CR_COA_CH_CD 	LIKE #bizMsg.coaChCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaAfflCd">
			  AND	CR.CR_COA_AFFL_CD 	LIKE #bizMsg.coaAfflCd# 
			</isNotNull>
			<isNotNull property="bizMsg.coaProjCd">   
			  AND	CR.CR_COA_PROJ_CD 	LIKE #bizMsg.coaProjCd# 
			</isNotNull>
			
			<!-- start CSA mod added reference text & extension & company -->
			<isNotNull property="bizMsg.coaCmpyCd">
				AND CR.CR_COA_CMPY_CD 	= #bizMsg.coaCmpyCd#
			</isNotNull>
			<isNotNull property="bizMsg.coaExtnCd">
				AND CR.CR_COA_EXTN_CD 	LIKE #bizMsg.coaExtnCd#
			</isNotNull>
            <!-- END   2017/12/04 MOD QC#12525 -->
			<!-- START 2016/12/20 MOD QC#16702-->
			<isEqual property="bizMsg.srchOptTxt" compareValue="INVTY_TRX_PK">
				AND	 INVTY_TRX_PK       = TO_NUMBER(#anyWord#)
			</isEqual>
			<isEqual property="bizMsg.srchOptTxt" compareValue="RCPT_NUM">
				AND	 RCPT_NUM           = #anyWord#
			</isEqual>
			<isNull  property="bizMsg.srchOptTxt">
			     <isNotNull property="anyWord">
				    AND UPPER(CR.JRNL_ENTRY_REF_TXT) LIKE #anyWord#
			     </isNotNull>
			</isNull>
            <!-- END 2016/12/20 MOD QC#16702-->
			<!-- end -->

			<isNotNull property="tocCd">
					AND	 SUBSTRB(UPPER(JRNL_ENTRY_REF_TXT), INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 1) + 1, INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 2) - (INSTRB(UPPER(JRNL_ENTRY_REF_TXT), '^', 1, 1) + 1)) = #tocCd# 
			</isNotNull>
	</statement>
	
	<!-- *****************************************************  For Total (End)***************************************************** -->
	
	<statement id="checkAjeId"  parameterClass="Map" resultClass="Map">
		SELECT 
			AJE_ID
		FROM 
			AJE_PTRN 
		WHERE 
			GLBL_CMPY_CD 	= #glblCmpyCd#
		AND EZCANCELFLAG 	= '0'
		AND AJE_ID 			= #ajeId#
	</statement>
	
	<statement id="checkVndCd"  parameterClass="Map" resultClass="Map">
		SELECT 
			VND_CD
		FROM 
			VND 
		WHERE 
			GLBL_CMPY_CD 	= #glblCmpyCd#
		AND EZCANCELFLAG 	= '0'
		AND VND_CD 			= #vndCd#
	</statement>
	
	<statement id="checkBillToCustCd"  parameterClass="Map" resultClass="Map">
		SELECT 
			BILL_TO_CUST_CD
		FROM 
			BILL_TO_CUST 
		WHERE 
			GLBL_CMPY_CD 	= #glblCmpyCd#
		AND EZCANCELFLAG 	= '0'
		AND BILL_TO_CUST_CD = #billToCustCd#
	</statement>	

	<statement id="getLastMonth" parameterClass="Map" resultClass="String">
		SELECT 
			GL_DT
		FROM 
			JRNL_ENTRY
		WHERE 
			GLBL_CMPY_CD 	= #glblCmpyCd#
		AND EZCANCELFLAG 	= '0'
		AND GL_DT           LIKE #lastMonth#||'%'
		AND ROWNUM = 1
	</statement>
	
	<statement id="isArchived" parameterClass="Map" resultClass="Integer">
		SELECT 
			COUNT(*) AS CNT
		FROM 
			ARC_COND
		WHERE 
			GLBL_CMPY_CD 	= #glblCmpyCd#
		AND EZCANCELFLAG 	= '0'
		AND ARC_COND_CD     = 'JRNL_ENTRY'
		AND SRC_RETEN_NUM = 0
	</statement>
	
	<!-- 2016/05/31 add -->
	<statement id="getSavedSearchOptionList" parameterClass="Map" resultClass="Map">
        SELECT
                  SSO.SRCH_OPT_PK
                , SSO.SRCH_OPT_NM
            FROM
                SAVE_SRCH_OPT SSO 
            WHERE
                SSO.GLBL_CMPY_CD        = #glblCmpyCd#
                AND SSO.SRCH_OPT_APL_ID = #srchOptAplId#
                AND SSO.SRCH_OPT_USR_ID = #srchOptUsrId#
                AND SSO.EZCANCELFLAG    = '0'
            ORDER BY
                  SSO.SRCH_OPT_NM
    </statement>
	<!-- end 2016/05/31 -->

	<!-- START 2016/08/29 S.Fujita [QC#4105,ADD] -->
	<statement id="getTocCd" parameterClass="Map" resultClass="Map">
        SELECT
            T.TOC_CD
        FROM
            TOC T
           ,ORG_FUNC_ROLE_TP OFRT
           ,BIZ_AREA_ORG     BA
           ,ORG_FUNC_ASG     OFA
           ,S21_ORG          SO
           ,S21_PSN          SP
        WHERE
                T.GLBL_CMPY_CD          = #glblCmpyCd#
            AND T.GLBL_CMPY_CD          = OFRT.GLBL_CMPY_CD
            AND T.ORG_FUNC_ROLE_TP_CD   = OFRT.ORG_FUNC_ROLE_TP_CD
            AND OFRT.SLS_REP_FLG        = #slsRepFlg#
            AND OFRT.GLBL_CMPY_CD       = BA.GLBL_CMPY_CD
            AND OFRT.FIRST_ORG_CD       = BA.BIZ_AREA_ORG_CD
            AND BA.SLS_FLG              = #slsRepFlg#
            AND BA.ORG_STRU_TP_CD       = #orgStruTpCd#

            AND T.GLBL_CMPY_CD          = OFA.GLBL_CMPY_CD
            AND T.TOC_CD                = OFA.TOC_CD

            AND T.GLBL_CMPY_CD          = SO.GLBL_CMPY_CD
            AND T.TOC_CD                = SO.TOC_CD

            AND OFA.GLBL_CMPY_CD        = SP.GLBL_CMPY_CD
            AND OFA.PSN_CD              = SP.PSN_CD
            AND SP.PSN_NUM              = #psnNum#

            AND T.EZCANCELFLAG          = '0'
            AND OFRT.EZCANCELFLAG       = '0'
            AND BA.EZCANCELFLAG         = '0'
            AND OFA.EZCANCELFLAG        = '0'
            AND SO.EZCANCELFLAG         = '0'
            AND SP.EZCANCELFLAG         = '0'
    </statement>
	<!-- END   2016/08/29 S.Fujita [QC#4105,ADD] -->

	<!-- START 2017/12/04 [QC#12525,ADD] -->
	<statement id="getSrchColNm" parameterClass="Map" resultClass="String">
        SELECT
            ATT.SRCH_COL_NM
        FROM
            AJE_TRX_TP ATT
        WHERE
                ATT.GLBL_CMPY_CD        = #glblCmpyCd#
            AND ATT.AJE_TRX_TP_CD       = #ajeTrxTpCd#
            AND ATT.EZCANCELFLAG        = '0'
    </statement>
	<!-- END   2017/12/04 [QC#12525,ADD] -->
</sqlMap>
