<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NWCL0140Query">

    <statement id="findCfsLeaseEligAcct" parameterClass="Map" resultClass="Map">
        SELECT
            MAIN.CFS_LEASE_ELIG_ACCT_PK
            ,MAIN.BILL_TO_CUST_ACCT_CD
            ,MAIN.BILL_TO_CUST_CD
            ,MAIN.DS_ACCT_NM
            ,MAIN.EZUPTIME
            ,MAIN.EZUPTIMEZONE
        FROM (
            SELECT
                CLEA.CFS_LEASE_ELIG_ACCT_PK
                ,CLEA.BILL_TO_CUST_ACCT_CD
                ,CLEA.BILL_TO_CUST_CD
                ,DAC.DS_ACCT_NM
                ,CLEA.EZUPTIME
                ,CLEA.EZUPTIMEZONE
            FROM
                CFS_LEASE_ELIG_ACCT CLEA
                ,SELL_TO_CUST DAC
            WHERE 
                1 = 1
            AND CLEA.GLBL_CMPY_CD         = #glblCmpyCd#
            <isNotNull property="billToCustAcctCd">
            AND CLEA.BILL_TO_CUST_ACCT_CD LIKE #billToCustAcctCd#
            </isNotNull>
            <isNotNull property="billToCustCd">
            AND CLEA.BILL_TO_CUST_CD      LIKE #billToCustCd#
            </isNotNull>
            AND CLEA.GLBL_CMPY_CD         = DAC.GLBL_CMPY_CD
            AND CLEA.BILL_TO_CUST_ACCT_CD = DAC.SELL_TO_CUST_CD
            AND CLEA.EZCANCELFLAG         = '0'
            AND DAC.EZCANCELFLAG          = '0'
            ORDER BY
                BILL_TO_CUST_ACCT_CD ASC
                ,BILL_TO_CUST_CD ASC
            ) MAIN
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="findCfsLeaseAttrb" parameterClass="Map" resultClass="Map">
        SELECT
            CLA.ATTRB_VAL_NUM
            ,CLA.EZUPTIME
            ,CLA.EZUPTIMEZONE
        FROM
            CFS_LEASE_ATTRB CLA
        WHERE 
            1 = 1
        AND CLA.GLBL_CMPY_CD     = #glblCmpyCd#
        AND CLA.ATTRB_KEY_NM     = #attrbKeyNm#
        AND CLA.EZCANCELFLAG     = '0'
    </statement>

    <statement id="findCfsLeaseEligAOrdCatg" parameterClass="Map" resultClass="Map">
        SELECT
            MAIN.CFS_LEASE_ELIG_ORD_CATG_PK
            ,MAIN.DS_ORD_CATG_CD
            ,MAIN.DS_ORD_TP_CD
            ,MAIN.ORD_CATG_INCL_FLG
            ,MAIN.DS_ORD_CATG_DESC_TXT
            ,MAIN.DS_ORD_TP_DESC_TXT
            ,MAIN.EZUPTIME
            ,MAIN.EZUPTIMEZONE
        FROM (
            SELECT
                CLEOC.CFS_LEASE_ELIG_ORD_CATG_PK
                ,CLEOC.DS_ORD_CATG_CD
                ,CLEOC.DS_ORD_TP_CD
                ,CLEOC.ORD_CATG_INCL_FLG
                ,DOC.DS_ORD_CATG_DESC_TXT
                ,DOT.DS_ORD_TP_DESC_TXT
                ,CLEOC.EZUPTIME
                ,CLEOC.EZUPTIMEZONE
            FROM
                CFS_LEASE_ELIG_ORD_CATG CLEOC
                ,DS_ORD_CATG DOC
                ,DS_ORD_TP DOT
            WHERE 
                1 = 1
            AND CLEOC.GLBL_CMPY_CD         = #glblCmpyCd#
            -- JOIN TO DS_ORD_CATG
            AND CLEOC.GLBL_CMPY_CD         = DOC.GLBL_CMPY_CD
            AND CLEOC.DS_ORD_CATG_CD       = DOC.DS_ORD_CATG_CD
            <isNotNull property="dsOrdCatgDescTxt">
            AND DOC.DS_ORD_CATG_DESC_TXT   LIKE #dsOrdCatgDescTxt#
            </isNotNull>
            -- JOIN TO DS_ORD_TP
            AND CLEOC.GLBL_CMPY_CD         = DOT.GLBL_CMPY_CD
            AND CLEOC.DS_ORD_TP_CD         = DOT.DS_ORD_TP_CD
            <isNotNull property="dsOrdTpDescTxt">
            AND DOT.DS_ORD_TP_DESC_TXT     LIKE #dsOrdTpDescTxt#
            </isNotNull>
            -- EZCANCELFLAG
            AND CLEOC.EZCANCELFLAG         = '0'
            AND DOC.EZCANCELFLAG           = '0'
            AND DOT.EZCANCELFLAG           = '0'
            ORDER BY
                CLEOC.DS_ORD_CATG_CD ASC
                ,CLEOC.DS_ORD_TP_CD ASC
            ) MAIN
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="countBillSellCd" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            BILL_TO_CUST BTC
        WHERE 
            1 = 1
        AND BTC.GLBL_CMPY_CD                     = #glblCmpyCd#
        <isNotNull property="billToCustCd">
        AND BTC.BILL_TO_CUST_CD                  = #billToCustCd#
        </isNotNull>
        AND BTC.RGTN_STS_CD                      = #rgtnStsCd#
        AND BTC.SELL_TO_CUST_CD                  = #billToCustAcctCd#
        AND BTC.EZCANCELFLAG                     = '0'
    </statement>

    <statement id="countCfsLeaseEligAcct" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            CFS_LEASE_ELIG_ACCT CLEA
        WHERE 
            1 = 1
        AND CLEA.GLBL_CMPY_CD         = #glblCmpyCd#
        AND CLEA.BILL_TO_CUST_ACCT_CD = #billToCustAcctCd#
        <isNotNull property="billToCustCd">
        AND CLEA.BILL_TO_CUST_CD      = #billToCustCd#
        </isNotNull>
        <isNull property="billToCustCd">
        AND CLEA.BILL_TO_CUST_CD      IS NULL
        </isNull>
        <iterate property="cfsLeaseEligAcctPkList" var="cfsLeaseEligAcctPkList[]" open="AND CLEA.CFS_LEASE_ELIG_ACCT_PK NOT IN (" conjunction= ", " close=")">
            #cfsLeaseEligAcctPkList[]#
        </iterate>
        AND CLEA.EZCANCELFLAG         = '0'
    </statement>

    <statement id="countCfsLeaseEligOrdCatg" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            CFS_LEASE_ELIG_ORD_CATG CLEOC
        WHERE 
            1 = 1
        AND CLEOC.GLBL_CMPY_CD         = #glblCmpyCd#
        AND CLEOC.DS_ORD_CATG_CD       = #dsOrdCatgCd#
        AND CLEOC.DS_ORD_TP_CD         = #dsOrdTpCd#
        <iterate property="cfsLeaseEligOrdCatgPkList" var="cfsLeaseEligOrdCatgPkList[]" open="AND CLEOC.CFS_LEASE_ELIG_ORD_CATG_PK NOT IN (" conjunction= ", " close=")">
            #cfsLeaseEligOrdCatgPkList[]#
        </iterate>
        AND CLEOC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="findDsOrdCatg" parameterClass="Map" resultClass="String">
        SELECT
            OC.DS_ORD_CATG_CD
        FROM
            DS_ORD_CATG OC
        WHERE
            1 = 1
            AND OC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND OC.DS_ORD_CATG_DESC_TXT = #dsOrdCatgDescTxt#
            AND OC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="findDsOrdTp" parameterClass="Map" resultClass="String">
        SELECT
            OC.DS_ORD_TP_CD
        FROM
            DS_ORD_TP OC
        WHERE
            1 = 1
            AND OC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND OC.DS_ORD_CATG_CD       = #dsOrdCatgCd#
            AND OC.DS_ORD_TP_DESC_TXT   = #dsOrdTpDescTxt#
            AND OC.EZCANCELFLAG         = '0'
    </statement>

</sqlMap>