<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NFCL3040Query">

    <typeAlias alias="NFCL3040SMsg"     type="business.blap.NFCL3040.NFCL3040SMsg"/>
    <typeAlias alias="NFCL3040_ASMsg"   type="business.blap.NFCL3040.NFCL3040_ASMsg"/>

    <statement id="searchBatchList" parameterClass="Map" resultMap="result.searchBatchList">
        SELECT
             AR_BAT_RCPT_NM
            ,AR_RCPT_SRC_NM
            ,AR_BAT_RCPT_DT
            ,AR_BAT_RCPT_STS_NM
            ,AR_BAT_RCPT_CNT
            ,AR_BAT_RCPT_AMT
            ,AR_LOCK_BOX_FILE_NM
            ,AR_LOCK_BOX_NM
            ,AR_LOCK_BOX_BAT_NUM
        FROM
        (
        SELECT
             BR.AR_BAT_RCPT_NM            AS AR_BAT_RCPT_NM
            ,SRC.AR_RCPT_SRC_NM           AS AR_RCPT_SRC_NM
            ,BR.AR_BAT_RCPT_DT            AS AR_BAT_RCPT_DT
            ,STS.AR_BAT_RCPT_STS_NM       AS AR_BAT_RCPT_STS_NM
            ,BR.AR_BAT_RCPT_CNT           AS AR_BAT_RCPT_CNT
            ,BR.AR_BAT_RCPT_AMT           AS AR_BAT_RCPT_AMT
            ,BR.AR_LOCK_BOX_FILE_NM       AS AR_LOCK_BOX_FILE_NM
            ,LB.AR_LOCK_BOX_DESC_TXT      AS AR_LOCK_BOX_NM
            ,BR.AR_LOCK_BOX_BAT_NUM       AS AR_LOCK_BOX_BAT_NUM
            ,BR.AR_BAT_RCPT_DT            AS RCPT_DT

        FROM AR_BAT_RCPT      BR
            ,AR_RCPT_SRC      SRC
            ,AR_BAT_RCPT_STS  STS
            ,AR_LOCK_BOX      LB
            ,(
                SELECT
                     A.DS_BANK_ACCT_PK
                    ,A.DS_BANK_ACCT_NUM
                    ,A.DS_BANK_ACCT_NM
                    ,A.DS_BANK_ACCT_TP_CD
                    ,B.BANK_RTE_NUM
                    ,B.DS_BANK_BR_NM
                FROM
                     DS_BANK_ACCT   A
                    ,DS_BANK_BR     B
                WHERE
                        A.GLBL_CMPY_CD         = #glblCmpyCd#
                    AND A.GLBL_CMPY_CD         = B.GLBL_CMPY_CD
                    AND A.DS_BANK_BR_PK        = B.DS_BANK_BR_PK
                    AND A.EZCANCELFLAG         = '0'
                    AND B.EZCANCELFLAG         = '0'
             ) ACCT
          WHERE 
                BR.GLBL_CMPY_CD                = #glblCmpyCd#
            AND BR.EZCANCELFLAG                = '0'
            AND BR.GLBL_CMPY_CD                = SRC.GLBL_CMPY_CD(+)
            AND BR.AR_RCPT_SRC_CD              = SRC.AR_RCPT_SRC_CD(+)
            AND SRC.EZCANCELFLAG(+)            = '0'
            AND BR.GLBL_CMPY_CD                = STS.GLBL_CMPY_CD(+)
            AND BR.AR_BAT_RCPT_STS_CD          = STS.AR_BAT_RCPT_STS_CD(+)
            AND STS.EZCANCELFLAG(+)            = '0'
            AND BR.GLBL_CMPY_CD                = LB.GLBL_CMPY_CD(+)
            AND BR.AR_LOCK_BOX_CD              = LB.AR_LOCK_BOX_CD(+)
            AND LB.EZCANCELFLAG(+)             = '0'
            AND BR.REM_DS_BANK_ACCT_PK         = ACCT.DS_BANK_ACCT_PK(+)
            <isNotNull property="dsBankAcctNm_H">
            AND UPPER(ACCT.DS_BANK_ACCT_NM) LIKE #dsBankAcctNm_H#
            </isNotNull>
            <isNotNull property="bizMsg.dsBankAcctNum_H">
            AND ACCT.DS_BANK_ACCT_NUM       LIKE #bizMsg.dsBankAcctNum_H#
            </isNotNull>
            <isNotNull property="dsBankBrNm_H">
            AND UPPER(ACCT.DS_BANK_BR_NM)   LIKE #dsBankBrNm_H#
            </isNotNull>
            <isNotNull property="bizMsg.arRcptSrcCd_H">
            AND BR.AR_RCPT_SRC_CD              = #bizMsg.arRcptSrcCd_H#
            </isNotNull>
            <isNotNull property="bizMsg.arBatRcptNm_H">
            AND BR.AR_BAT_RCPT_NM           LIKE #bizMsg.arBatRcptNm_H#
            </isNotNull>
            <isNotNull property="bizMsg.arBatRcptStsCd_H">
            AND BR.AR_BAT_RCPT_STS_CD          = #bizMsg.arBatRcptStsCd_H#
            </isNotNull>
            <isNotNull property="bizMsg.arLockBoxFileNm_H">
            AND BR.AR_LOCK_BOX_FILE_NM      LIKE #bizMsg.arLockBoxFileNm_H#
            </isNotNull>
            <isNotNull property="bizMsg.arLockBoxCd_H">
            AND BR.AR_LOCK_BOX_CD              = #bizMsg.arLockBoxCd_H#
            </isNotNull>
            <isNotNull property="bizMsg.arLockBoxBatNum_H">
            AND BR.AR_LOCK_BOX_BAT_NUM         = #bizMsg.arLockBoxBatNum_H#
            </isNotNull>
            <isNotNull property="bizMsg.cratDt_H1">
            AND BR.AR_BAT_RCPT_DT          &gt;= #bizMsg.cratDt_H1#
            </isNotNull>
            <isNotNull property="bizMsg.cratDt_H2">
            AND BR.AR_BAT_RCPT_DT          &lt;= #bizMsg.cratDt_H2#
            </isNotNull>
        ORDER BY
                 BR.AR_BAT_RCPT_DT
                ,BR.AR_BAT_RCPT_NM
        )
        <isNotNull property="rowNum">
        WHERE 
            ROWNUM &lt;= #rowNum#
        </isNotNull>
    </statement>

    <resultMap id="result.searchBatchList" class="NFCL3040_ASMsg">
        <result property="arBatRcptNm"      column="AR_BAT_RCPT_NM"       javaType="EZDSStringItem" />
        <result property="arRcptSrcNm"      column="AR_RCPT_SRC_NM"       javaType="EZDSStringItem" />
        <result property="arBatRcptDt"      column="AR_BAT_RCPT_DT"       javaType="EZDSDateItem" />
        <result property="arBatRcptStsNm"   column="AR_BAT_RCPT_STS_NM"   javaType="EZDSStringItem" />
        <result property="arBatRcptCnt"     column="AR_BAT_RCPT_CNT"      javaType="EZDSBigDecimalItem" />
        <result property="arBatRcptAmt"     column="AR_BAT_RCPT_AMT"      javaType="EZDSBigDecimalItem" />
        <result property="arLockBoxFileNm"  column="AR_LOCK_BOX_FILE_NM"  javaType="EZDSStringItem" />
        <result property="arLockBoxNm"      column="AR_LOCK_BOX_NM"       javaType="EZDSStringItem" />
        <result property="arLockBoxBatNum"  column="AR_LOCK_BOX_BAT_NUM"  javaType="EZDSStringItem" />
    </resultMap>

</sqlMap>