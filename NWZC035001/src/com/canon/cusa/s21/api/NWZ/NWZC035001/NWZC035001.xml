<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NWZC035001">

<!-- #################### Type Alias #################### -->
	<typeAlias alias="NWZC035002PMsg" type="business.parts.NWZC035002PMsg"/>
	<typeAlias alias="INVTMsg" type="business.db.INVTMsg"/>
	<typeAlias alias="INV_BOLTMsg" type="business.db.INV_BOLTMsg"/>
	<typeAlias alias="INV_LINETMsg" type="business.db.INV_LINETMsg"/>
	<typeAlias alias="INV_PRMO_INFOTMsg" type="business.db.INV_PRMO_INFOTMsg"/>
	<typeAlias alias="CTAC_PSNTMsg" type="business.db.CTAC_PSNTMsg"/>
	<typeAlias alias="DS_INVTY_LOC_VTMsg" type="business.db.DS_INVTY_LOC_VTMsg"/>
	<typeAlias alias="S21_PSNTMsg" type="business.db.S21_PSNTMsg"/>

<!-- #################### Statement #################### -->
	<statement id="queryContainSHPG_PLN" parameterClass="Map" resultMap="result.queryContainSHPG_PLN">
		SELECT
			C.GLBL_CMPY_CD
			,C.CPO_ORD_NUM
			,SUBSTR(C.CPO_ORD_TS, 1, 8) CPO_ORD_TS
			,C.CUST_ISS_PO_NUM
			,C.CUST_ISS_PO_DT
			,C.BILL_TO_CUST_CD
			,C.SELL_TO_CUST_CD
			,C.PAYER_CUST_CD
			,CD.PMT_TERM_CD
			,CD.CASH_DISC_TERM_CD
			,C.ADMIN_PSN_CD
			,CD.CCY_CD
			,CD.EXCH_RATE
			,C.SYS_SRC_CD
			,CD.ORIG_CPO_ORD_NUM
			,CD.ORIG_INV_NUM
			,SP.SO_NUM
			,SP.BOL_NUM
			,SP.CARR_CD
			,SP.CARR_NM
			,SP.PRO_NUM
            ,DECODE(CD.CR_REBIL_CD, NULL, SP.INVTY_LOC_CD, 'CR')    AS INVTY_LOC_CD
			,SP.SHIP_TO_CUST_CD
			,SP.DROP_SHIP_FLG
			,SP.SHIP_TO_LOC_NM
			,SP.SHIP_TO_ADDL_LOC_NM
			,SP.SHIP_TO_FIRST_LINE_ADDR
			,SP.SHIP_TO_SCD_LINE_ADDR
			,SP.SHIP_TO_THIRD_LINE_ADDR
			,SP.SHIP_TO_FRTH_LINE_ADDR
			,SP.SHIP_TO_CTY_ADDR
			,SP.SHIP_TO_CNTY_NM
			,SP.SHIP_TO_PROV_ADDR
			,SP.SHIP_TO_ST_CD
			,SP.SHIP_TO_POST_CD
			,SP.SHIP_TO_CTRY_CD
			,SP.SHIP_TO_FIRST_REF_CMNT_TXT
			,SP.SHIP_TO_SCD_REF_CMNT_TXT
			,CD.EXPT_FLG
			,SP.ACTL_SHIP_DT
			,SP.ACTL_ARV_DT
			,SP.REQ_SHPG_SVC_LVL_CD
			,SP.REQ_FRT_CHRG_TO_CD
			,SP.REQ_FRT_CHRG_METH_CD
			,SP.STK_STS_CD
			,SP.SLS_REP_TOC_CD
			,SP.MDSE_CD
			,CD.ORD_QTY as CD_ORD_QTY
			,SP.ORD_QTY as SP_ORD_QTY
			,CD.MAN_PRC_FLG
            <!-- QC#21841 Mod Start -->
            <!--,SP.SP_TOT_DEAL_FRT_AMT -->
            <!--,SP.SP_TOT_FUNC_FRT_AMT -->
            ,0 AS SP_TOT_DEAL_FRT_AMT
            ,0 AS SP_TOT_FUNC_FRT_AMT
            <!-- QC#21841 Mod End -->
			,CD.TAX_FLG
			,CD.COA_ACCT_CD
			,CD.COA_PROJ_CD
			,SP.SET_MDSE_CD
			,C.SEND_INV_FLG
			,C.CPO_SRC_TP_CD
			,CD.SHIP_CPLT_CD
			,CD.COA_CMPY_CD
			,CD.COA_AFFL_CD
			,CD.COA_BR_CD
			,CD.COA_CH_CD
			,CD.COA_CC_CD
			,CD.COA_EXTN_CD
            ,M.COA_PROD_CD
			,CD.PRC_CATG_CD
			,C.SHPG_CHRG_AMT
			,SP.PMT_TERM_CASH_DISC_CD
			,SP.SET_SHPG_PLN_NUM
			,NVL(C.INV_RCPNT_CUST_CD, DCC.BILL_TO_CUST_LOC_CD) AS INV_RCPNT_CUST_CD
			,CD.DS_ORD_POSN_NUM
			,CD.SVC_CONFIG_MSTR_PK
            ,M.MDSE_TP_CD
			,C.DS_ORD_TP_CD
			,C.DS_ORD_RSN_CD
			,CD.DS_CONTR_NUM
			,CD.DS_CONTR_SQ_NUM
			,SP.TRX_CD
			,SP.TRX_RSN_CD
			,C.DS_ORD_CATG_CD
			,C.PRE_PMT_AMT
			,C.PRE_PMT_CHK_NUM
			,C.PRE_PMT_TP_CD
			,C.CR_REBIL_RSN_CATG_CD
			,C.DS_PMT_METH_CD
			,C.NEGO_DEAL_AMT
			,C.LEASE_CMPY_PO_NUM
			,C.LEASE_PRCH_OPT_CD
			,C.LEASE_TERM_CD
			,C.LEASE_PMT_FREQ_CD
			,C.SOLD_TO_CUST_LOC_CD
			,DCC.BILL_TO_CUST_ACCT_CD
			,C.SLS_REP_TOC_CD    AS SLS_REP_TOC_CD_H
			,DCC.SHIP_TO_CUST_ACCT_CD
			,CD.CSMP_CONTR_NUM
			,CD.DLR_REF_NUM
			,CD.FIRST_BLLG_ATTRB_VAL_TXT
			,CD.SCD_BLLG_ATTRB_VAL_TXT
			,CD.THIRD_BLLG_ATTRB_VAL_TXT
			,CD.FRTH_BLLG_ATTRB_VAL_TXT
			,CD.FIFTH_BLLG_ATTRB_VAL_TXT
			,CD.SIXTH_BLLG_ATTRB_VAL_TXT
			,CD.CUST_UOM_CD          AS UOM_CD
			,CD.DS_CPO_LINE_NUM
			,CD.DS_CPO_LINE_SUB_NUM
			,CD.ORD_CUST_UOM_QTY
			,CD.CPO_DTL_DEAL_NET_AMT <!-- 2017/10/12 QC#21645 Add-->
            ,NVL(CD.CUST_MDSE_CD, CD.ORIG_MDSE_CD) AS ORIG_OR_CUST_MDSE_CD
			,CD.BASE_CMPT_FLG
			,DCC.MDL_ID
			,CD.DS_CPO_CONFIG_PK
			,CD.CR_REBIL_CD
			,DCC.BILL_TO_CUST_LOC_CD
			,SP.SO_SLP_NUM
			,'N' AS BILL_WITH_EQUIP_FLG
            ,M.INVTY_CTRL_FLG
            ,SP.PO_REQ_FLG
            ,CD.DS_ORD_LINE_CATG_CD
            ,C.FRT_COND_CD
            ,CD.ORIG_INVTY_LOC_CD <!-- 2017/10/20 QC#21730 Add -->
		FROM
			CPO C, CPO_DTL CD, SHPG_PLN SP
			,DS_CPO_CONFIG DCC
            ,ALL_MDSE_V M
		WHERE
			C.GLBL_CMPY_CD          = #glblCmpyCd#
		AND	C.CPO_ORD_NUM           = #cpoOrdNum#
		AND	C.EZCANCELFLAG          = '0'
		AND	CD.CPO_DTL_LINE_NUM     = #cpoDtlLineNum#
		AND	CD.CPO_DTL_LINE_SUB_NUM = #cpoDtlLineSubNum#
		AND	CD.EZCANCELFLAG         = '0'
		AND	SP.SHPG_PLN_NUM         = #shpgPlnNum#
		AND	SP.EZCANCELFLAG         = '0'
		AND	C.GLBL_CMPY_CD          = CD.GLBL_CMPY_CD
		AND	C.CPO_ORD_NUM           = CD.CPO_ORD_NUM
		AND	CD.GLBL_CMPY_CD         = SP.GLBL_CMPY_CD
		AND	CD.CPO_ORD_NUM          = SP.TRX_HDR_NUM
		AND	CD.CPO_DTL_LINE_NUM     = SP.TRX_LINE_NUM
		AND	CD.CPO_DTL_LINE_SUB_NUM = SP.TRX_LINE_SUB_NUM
		AND	CD.GLBL_CMPY_CD         = DCC.GLBL_CMPY_CD
		AND	CD.DS_CPO_CONFIG_PK     = DCC.DS_CPO_CONFIG_PK
		AND	CD.CPO_ORD_NUM          = DCC.CPO_ORD_NUM
		AND	DCC.EZCANCELFLAG        = '0'
        AND M.GLBL_CMPY_CD          = SP.GLBL_CMPY_CD
        AND M.MDSE_CD               = SP.MDSE_CD
        AND M.EZCANCELFLAG          = '0'

        ORDER BY
             PMT_TERM_CD
            ,CASH_DISC_TERM_CD
            ,CCY_CD
            ,BILL_TO_CUST_ACCT_CD
            ,ORIG_INV_NUM
            ,SHIP_TO_CUST_ACCT_CD
            ,SHIP_TO_CUST_CD
            ,SO_NUM
            ,BOL_NUM
            ,PRO_NUM
            ,INVTY_LOC_CD
<!-- 2017/10/20 QC#50654 Add Start -->
            ,ORIG_INVTY_LOC_CD
<!-- 2017/10/20 QC#50654 Add End -->
	</statement>

	<statement id="queryMSG_TXT_DTL" parameterClass="Map" resultClass="Map">
		SELECT
			MTD.CPO_DTL_LINE_NUM
			,MTD.CPO_DTL_LINE_SUB_NUM
			,MTD.MSG_TXT_INFO_TXT
			,MTD.TXT_SQ_NUM
		FROM
			MSG_TXT_DTL MTD
		WHERE
			MTD.GLBL_CMPY_CD = #glblCmpyCd#
		AND	MTD.CPO_ORD_NUM  = #cpoOrdNum#
		AND	MTD.TXT_TP_CD    = #txtTpCd#
		AND	MTD.MSG_TXT_INFO_TXT IS NOT NULL
		AND	MTD.EZCANCELFLAG = '0'
		ORDER BY CPO_DTL_LINE_NUM, CPO_DTL_LINE_SUB_NUM, TXT_SQ_NUM
	</statement>

	<statement id="queryPRC_DTL" parameterClass="EZDMsg" resultMap="result.queryPRC_DTL">
		SELECT
			PD.PRMO_PK
			,PD.PRMO_CATG_PK
			,PD.PRMO_CATG_NM
			,PD.PRMO_SHORT_NM
			,PD.PRC_DT
			,PD.SHIP_UNIT_QTY
			,PD.DEAL_UNIT_PRC_AMT
			,PD.DEAL_LAST_NET_UNIT_PRC_AMT
			,PD.DEAL_NET_AMT
			,PD.DEAL_DISC_AMT
			,PD.DEAL_PRMO_NET_UNIT_PRC_AMT
			,PD.DEAL_PK
			,PD.DEAL_PER_UNIT_FIX_AMT
			,PD.DEAL_SLS_PCT_NUM
			,PD.FUNC_PER_UNIT_FIX_AMT
			,PD.FUNC_UNIT_PRC_AMT
			,PD.FUNC_LAST_NET_UNIT_PRC_AMT
			,PD.FUNC_NET_AMT
			,PD.FUNC_DISC_AMT
			,PD.FUNC_PRMO_NET_UNIT_PRC_AMT
			,PD.DEAL_NM
			,PD.PRMO_DESC_TXT
			,PD.COA_ACCT_CD
			,PD.CPO_LINE_PRC_NUM
		FROM
			PRC_DTL PD
		WHERE
			PD.GLBL_CMPY_CD         = #glblCmpyCd#
		AND	PD.CPO_ORD_NUM          = #cpoOrdNum#
		AND	PD.CPO_DTL_LINE_NUM     = #cpoDtlLineNum#
		AND	PD.CPO_DTL_LINE_SUB_NUM = #cpoDtlLineSubNum#
		<isNotNull property="shpgPlnNum">
		AND	PD.SHPG_PLN_NUM         = #shpgPlnNum#
		</isNotNull>
		AND PD.EZCANCELFLAG         = '0'
	</statement>

	<statement id="queryBILL_TO_FOR_FLR_PLN_FLG" parameterClass="EZDMsg" resultMap="result.queryBILL_TO_FOR_FLR_PLN_FLG">
		SELECT
			BT.FL_PLN_CMPY_FLG
		FROM
			BILL_TO_CUST BT
		WHERE
			BT.GLBL_CMPY_CD    = #glblCmpyCd#
		AND	BT.BILL_TO_CUST_CD = #payerCustCd#
		AND	BT.EZCANCELFLAG    = '0'
	</statement>

	<statement id="queryHLD" parameterClass="Map" resultMap="result.queryHLD">
		SELECT
			H.APVL_NUM
		FROM
			HLD H
		WHERE
			H.GLBL_CMPY_CD = #glblCmpyCd#
		AND	H.CPO_ORD_NUM  = #cpoOrdNum#
		AND	H.HLD_RSN_CD   = #hldRsnCd#
		AND	H.EZCANCELFLAG = '0'
	</statement>

	<statement id="queryBILL_TO_and_REM_TO" parameterClass="EZDMsg" resultMap="result.queryBILL_TO_and_REM_TO">
		SELECT
			RMT.LOC_NM
			,RMT.ADDL_LOC_NM
			,RMT.REM_ID
		FROM
			BILL_TO_CUST BT, REM_TO RMT
		WHERE
			BT.GLBL_CMPY_CD    = #glblCmpyCd#
		AND	BT.BILL_TO_CUST_CD = #payerCustCd#
		AND BT.EZCANCELFLAG    = '0'
		AND	BT.GLBL_CMPY_CD    = RMT.GLBL_CMPY_CD
		AND BT.REM_ID          = RMT.REM_ID
		AND RMT.EZCANCELFLAG   = '0'
	</statement>

	<statement id="queryINV_RCPNT_FOR_DUNS_NUM" parameterClass="Map" resultMap="result.queryINV_RCPNT_FOR_DUNS_NUM">
		SELECT
			IR.DUNS_NUM
		FROM
			INV_RCPNT IR
		WHERE
			IR.GLBL_CMPY_CD         = #glblCmpyCd#
		AND IR.INV_RCPNT_CUST_CD    = #invRcpntCustCd#
		AND IR.PRINT_DUNS_ON_INV_FLG = 'Y'
		AND IR.RGTN_STS_CD           = #rgtnStsCd#
		AND	IR.EZCANCELFLAG          = '0'
	</statement>

	<statement id="querySELL_TO_and_CNTY" parameterClass="EZDMsg" resultMap="result.querySELL_TO_and_CNTY">
		SELECT
			SE.LOC_NM
			,SE.ADDL_LOC_NM
			,SE.FIRST_LINE_ADDR
			,SE.SCD_LINE_ADDR
			,SE.THIRD_LINE_ADDR
			,SE.FRTH_LINE_ADDR
			,SE.CTY_ADDR
			,SE.PROV_NM
			,SE.ST_CD
			,SE.POST_CD
			,SE.CTRY_CD
			,SE.FIRST_REF_CMNT_TXT
			,SE.SCD_REF_CMNT_TXT
			,CNT.CNTY_NM
		FROM
			SELL_TO_CUST SE, CNTY CNT
		WHERE
			SE.GLBL_CMPY_CD     = #glblCmpyCd#
		AND SE.SELL_TO_CUST_CD  = #sellToCustCd#
		AND	SE.EZCANCELFLAG     = '0'
		AND	SE.GLBL_CMPY_CD     = CNT.GLBL_CMPY_CD(+)
		AND SE.CNTY_PK          = CNT.CNTY_PK(+)
		AND CNT.EZCANCELFLAG(+) = '0'
	</statement>

	<statement id="queryINV_RCPNT_and_CNTY" parameterClass="Map" resultMap="result.queryINV_RCPNT_and_CNTY">
		SELECT
			IR.LOC_NM
			,IR.ADDL_LOC_NM
			,IR.FIRST_LINE_ADDR
			,IR.SCD_LINE_ADDR
			,IR.THIRD_LINE_ADDR
			,IR.FRTH_LINE_ADDR
			,IR.CTY_ADDR
			,IR.PROV_NM
			,IR.ST_CD
			,IR.POST_CD
			,IR.CTRY_CD
			,CNT.CNTY_NM
		FROM
			INV_RCPNT IR, CNTY CNT
		WHERE
			IR.GLBL_CMPY_CD         = #glblCmpyCd#
		AND IR.INV_RCPNT_CUST_CD    = #invRcpntCustCd#
		AND IR.RGTN_STS_CD  = #rgtnStsCd#
		AND	IR.EZCANCELFLAG     = '0'
		AND	IR.GLBL_CMPY_CD     = CNT.GLBL_CMPY_CD(+)
		AND IR.CNTY_PK          = CNT.CNTY_PK(+)
		AND CNT.EZCANCELFLAG(+) = '0'
	</statement>

	<statement id="queryPMT_TERM" parameterClass="EZDMsg" resultClass="Map">
		SELECT
			PT.PMT_TERM_NM
			,PT.PMT_TERM_AOT
		FROM
			PMT_TERM PT
		WHERE
			PT.GLBL_CMPY_CD = #glblCmpyCd#
		AND	PT.PMT_TERM_CD  = #pmtTermCd#
		AND	PT.EZCANCELFLAG = '0'
	</statement>

	<statement id="queryCASH_DISC_TERM" parameterClass="Map" resultClass="Map">
		SELECT
			CDT.CASH_DISC_FROM_AOT
			,CDT.CASH_DISC_PCT
		FROM
			CASH_DISC_TERM CDT
		WHERE
			CDT.GLBL_CMPY_CD                   = #glblCmpyCd#
		AND	CDT.CASH_DISC_TERM_CD              = #cashDiscTermCd#
		AND	CDT.CASH_DISC_TERM_EFF_FROM_DT &lt;= #slsDt#
		AND NVL(CDT.CASH_DISC_TERM_EFF_THRU_DT,'99991231') &gt;= #slsDt#
		AND CDT.CASH_DISC_FROM_AOT         &lt;= #cashDiscAOT#
		AND	CDT.CASH_DISC_PCT                 != 0
		AND	CDT.EZCANCELFLAG                   = '0'
	</statement>

	<statement id="queryS21_PSN" parameterClass="EZDMsg" resultClass="Map">
		SELECT
			P.PSN_FIRST_NM
			,P.PSN_MID_NM
			,P.PSN_LAST_NM
		FROM
			S21_PSN P
		WHERE
			P.GLBL_CMPY_CD = #glblCmpyCd#
		AND	P.PSN_CD       = #crAnlstPsnCd#
		AND	P.EZCANCELFLAG = '0'
	</statement>

	<statement id="querySHPG_SVC_LVL" parameterClass="EZDMsg" resultMap="result.querySHPG_SVC_LVL">
		SELECT
			SSL.SHPG_SVC_LVL_NM
		FROM
			SHPG_SVC_LVL SSL
		WHERE
			SSL.GLBL_CMPY_CD    = #glblCmpyCd#
		AND	SSL.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
		AND SSL.EZCANCELFLAG    = '0'
	</statement>

	<statement id="queryFRT_CHRG_TO" parameterClass="EZDMsg" resultMap="result.queryFRT_CHRG_TO">
		SELECT
			FCT.FRT_CHRG_TO_NM
		FROM
			FRT_CHRG_TO FCT
		WHERE
			FCT.GLBL_CMPY_CD   = #glblCmpyCd#
		AND	FCT.FRT_CHRG_TO_CD = #frtChrgToCd#
		AND FCT.EZCANCELFLAG   = '0'
	</statement>

	<statement id="queryCPOforCount" parameterClass="Map" resultClass="Integer">
		SELECT
			COUNT(1)
		FROM
			INV I
		WHERE
			I.GLBL_CMPY_CD  = #glblCmpyCd#
		AND	I.TRX_SRC_TP_CD = #wholeSales#
		AND	I.CPO_ORD_NUM   = #cpoOrdNum#
		AND	I.EZCANCELFLAG  = '0'
	</statement>

	<statement id="queryCCY" parameterClass="EZDMsg" resultClass="Integer">
		SELECT
			CCY.AFT_DECL_PNT_DIGIT_NUM
		FROM
			CCY CCY
		WHERE
			CCY.GLBL_CMPY_CD = #glblCmpyCd#
		AND CCY.CCY_CD       = #dealCcyCd#
		AND CCY.EZCANCELFLAG = '0'
	</statement>

<!-- CSA ADD Start -->
	<statement id="queryDS_CPO_DTL_FOR_MAKE_DUMMY_SET_MDSE" parameterClass="EZDMsg" resultClass="Map">
		SELECT
			CD.CPO_DTL_LINE_SUB_NUM
			,CD.MDSE_CD
			,CD.ORD_QTY
			,CD.SLS_REP_OR_SLS_TEAM_TOC_CD
			,CD.BASE_CMPT_FLG
		FROM
			CPO_DTL CD
		WHERE
			CD.GLBL_CMPY_CD          = #glblCmpyCd#
		AND	CD.CPO_ORD_NUM           = #cpoOrdNum#
		AND	CD.CPO_DTL_LINE_NUM      = #cpoDtlLineNum#
		AND	CD.CPO_DTL_LINE_SUB_NUM != #cpoDtlLineSubNum#
		AND	CD.EZCANCELFLAG          = '0'
	</statement>
<!-- CSA ADD End -->

	<statement id="queryMDSE" parameterClass="Map" resultClass="Map">
		SELECT
			M.MDSE_NM
			,M.EXP_ITEM_FLG
			,M.ZEROTH_PROD_CTRL_CD
			,M.ZEROTH_PROD_CTRL_NM
			,M.FIRST_PROD_CTRL_CD
			,M.FIRST_PROD_CTRL_NM
			,M.SCD_PROD_CTRL_CD
			,M.SCD_PROD_CTRL_NM
			,M.THIRD_PROD_CTRL_CD
			,M.THIRD_PROD_CTRL_NM
			,M.FRTH_PROD_CTRL_CD
			,M.FRTH_PROD_CTRL_NM
			,M.FIFTH_PROD_CTRL_CD
			,M.FIFTH_PROD_CTRL_NM
			,M.SIXTH_PROD_CTRL_CD
			,M.SIXTH_PROD_CTRL_NM
			,M.SVNTH_PROD_CTRL_CD
			,M.SVNTH_PROD_CTRL_NM
			,M.THIS_MTH_TOT_STD_COST_AMT
			,M.INVTY_CTRL_FLG
			,M.INVTY_VAL_FLG
			,M.MDSE_TP_CD
		FROM
			ALL_MDSE_V M
		WHERE
			M.GLBL_CMPY_CD = #glblCmpyCd#
		AND	M.MDSE_CD      = #mdseCd#
		AND	M.EZCANCELFLAG = '0'
	</statement>

	<statement id="queryCR_DR_SUB_RSN_FOR_MDSE_NM" parameterClass="EZDMsg" resultClass="String">
		SELECT
			CDS.CR_DR_SUB_RSN_NM
		FROM
			CR_DR_SUB_RSN CDS
		WHERE
			CDS.GLBL_CMPY_CD     = #glblCmpyCd#
		AND	CDS.CR_DR_SUB_RSN_CD = #crDrRsnSubCd#
		AND	CDS.EZCANCELFLAG     = '0'
	</statement>

	<statement id="queryCOA_PROD" parameterClass="EZDMsg" resultMap="result.queryCOA_PROD">
		SELECT
			CPD.COA_PROD_NM
		FROM
			COA_PROD CPD
		WHERE
			CPD.GLBL_CMPY_CD = #glblCmpyCd#
		AND	CPD.COA_PROD_CD  = #coaProdCd#
		AND	CPD.EZCANCELFLAG = '0'
	</statement>

	<statement id="queryCOA_PROD_BySalesRep" parameterClass="EZDMsg" resultMap="result.queryCOA_PROD">
		SELECT
			CPD.COA_PROD_CD
			,CPD.COA_PROD_NM
		FROM
			COA_PROD CPD
		WHERE
			CPD.GLBL_CMPY_CD = #glblCmpyCd#
		AND	CPD.EZCANCELFLAG = '0'
		AND	EXISTS (
				SELECT
					'X'
				FROM
					S21_ORG O
				WHERE
					O.GLBL_CMPY_CD = CPD.GLBL_CMPY_CD
					AND O.COA_PROD_CD = CPD.COA_PROD_CD
					AND O.TOC_CD = #slsRepTocCd#
					AND O.EZCANCELFLAG = '0'
			)
	</statement>

	<statement id="queryMDSE_SFTY_INFO" parameterClass="Map" resultMap="result.queryMDSE_SFTY_INFO">
		SELECT
		    MSF.MERC_CNTN_FLG
		FROM
			MDSE_SFTY_INFO MSF
		WHERE
			MSF.GLBL_CMPY_CD = #glblCmpyCd#
		AND	MSF.MDSE_CD      = #mdseCd#
		AND	MSF.EZCANCELFLAG = '0'
	</statement>

	<statement id="querySFTY_INV_TXT" parameterClass="Map" resultClass="Map">
		SELECT
			STX.FIRST_SFTY_INV_TXT
			,STX.SCD_SFTY_INV_TXT
			,STX.THIRD_SFTY_INV_TXT
		FROM
			SFTY_INV_TXT STX
		WHERE
			STX.GLBL_CMPY_CD    = #glblCmpyCd#
		AND	STX.SFTY_INV_TXT_CD = #sftyInvTxtCd#
		AND	STX.EZCANCELFLAG    = '0'
	</statement>

	<statement id="querySHPG_PLN" parameterClass="Map" resultClass="BigDecimal">
		SELECT
			SP.ORD_QTY
		FROM
			SHPG_PLN SP
<!-- Add Start WDS Defect #97 -->
			,MDSE MD
<!-- Add End WDS Defect #97 -->
		WHERE
			SP.GLBL_CMPY_CD     = #glblCmpyCd#
		AND	SP.TRX_HDR_NUM      = #cpoOrdNum#
		AND	SP.TRX_LINE_NUM     = #cpoDtlLineNum#
		AND	SP.TRX_LINE_SUB_NUM = #cpoDtlLineSubNum#
		AND	SP.SHPG_STS_CD      = #shpgStsCd#
		AND	SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
		AND	SP.EZCANCELFLAG     = '0'
<!-- Add Start WDS Defect #97 -->
        AND MD.GLBL_CMPY_CD     =  SP.GLBL_CMPY_CD
        AND MD.MDSE_CD          =  SP.MDSE_CD
        AND MD.MDSE_TP_CD       &lt;&gt;  #mdseTpCd#
        AND MD.EZCANCELFLAG     =  '0'
<!-- Add End WDS Defect #97 -->
	</statement>

	<statement id="queryMAX_INV_BOL_LINE_NUM" parameterClass="EZDMsg" resultClass="String">
		SELECT
			MAX(IB.INV_BOL_LINE_NUM) MAX_INV_BOL_LINE_NUM
		FROM
			INV_BOL IB
		WHERE
			IB.GLBL_CMPY_CD = #glblCmpyCd#
		AND	IB.INV_NUM      = #invNum#
		AND	IB.EZCANCELFLAG = '0'
	</statement>

	<statement id="queryINV_BOL_LINE_NUM" parameterClass="EZDMsg" resultClass="String">
		SELECT
			IB.INV_BOL_LINE_NUM
		FROM
			INV_BOL IB
		WHERE
			IB.GLBL_CMPY_CD = #glblCmpyCd#
		AND	IB.INV_NUM      = #invNum#
		<isNotNull property="soNum">
		AND	IB.SO_NUM       = #soNum#
		</isNotNull>
		<isNull property="soNum">
		AND	IB.SO_NUM       IS NULL
		</isNull>
		<isNotNull property="bolNum">
		AND	IB.BOL_NUM      = #bolNum#
		</isNotNull>
		<isNull property="bolNum">
		AND	IB.BOL_NUM      IS NULL
		</isNull>
		<isNotNull property="proNum">
		AND	IB.PRO_NUM      = #proNum#
		</isNotNull>
		<isNull property="proNum">
		AND	IB.PRO_NUM      IS NULL
		</isNull>
        <isNotNull property="shipFromInvtyLocCd">
        AND IB.SHIP_FROM_INVTY_LOC_CD = #shipFromInvtyLocCd#
        </isNotNull>
        <isNull property="shipFromInvtyLocCd">
        AND IB.SHIP_FROM_INVTY_LOC_CD IS NULL
        </isNull>
        <!-- 2019/10/01 QC#53697 Add Start -->
        <isNotNull property="origInvtyLocCd">
        AND IB.ORIG_INVTY_LOC_CD = #origInvtyLocCd#
        </isNotNull>
        <isNull property="origInvtyLocCd">
        AND IB.ORIG_INVTY_LOC_CD IS NULL
        </isNull>
        <!-- 2019/10/01 QC#53697 Add End -->
		AND	IB.EZCANCELFLAG = '0'
	</statement>

	<statement id="queryMAX_INV_LINE_NUM" parameterClass="EZDMsg" resultClass="String">
		SELECT
			MAX(INV_LINE_NUM) MAX_INV_LINE_NUM
		FROM
			INV_LINE
		WHERE
			GLBL_CMPY_CD		= #glblCmpyCd#
		AND	INV_NUM				= #invNum#
		AND	INV_BOL_LINE_NUM	= #invBolLineNum#
		AND	EZCANCELFLAG		= '0'
	</statement>

	<statement id="queryMargeINV" parameterClass="Map" resultMap="result.queryMargeINV">
		SELECT
			 I.INV_NUM
			,I.INV_TOT_DEAL_NET_AMT
			,I.INV_TOT_DEAL_SLS_AMT
			,I.INV_TOT_DEAL_FRT_AMT
			,I.INV_TOT_DEAL_TAX_AMT
			,I.INV_TOT_DEAL_DISC_AMT
			,I.INV_TOT_FUNC_NET_AMT
			,I.INV_TOT_FUNC_SLS_AMT
			,I.INV_TOT_FUNC_FRT_AMT
			,I.INV_TOT_FUNC_TAX_AMT
			,I.INV_TOT_FUNC_DISC_AMT 
		FROM INV I
			,INV_BOL IB
			,DS_ORD_TP DOT
		WHERE
			I.EZCANCELFLAG = '0'
		AND IB.EZCANCELFLAG = '0'
		AND I.GLBL_CMPY_CD = #glblCmpyCd#
		AND I.GLBL_CMPY_CD = IB.GLBL_CMPY_CD
		AND I.INV_NUM = IB.INV_NUM
		AND I.CPO_ORD_NUM = #cpoOrdNum#
		AND I.PMT_TERM_CD = #pmtTermCd#
		<isNotNull property="cashDiscTermCd">
		AND I.CASH_DISC_TERM_CD = #cashDiscTermCd#
		</isNotNull>
		<isNull property="cashDiscTermCd">
		AND I.CASH_DISC_TERM_CD IS NULL
		</isNull>
		AND I.DEAL_CCY_CD = #dealCcyCd#
		AND I.INV_DT = #invDt#
		AND IB.SHIP_TO_CUST_CD = #shipToCustCd#
		AND $shipToCustAdrs$
		AND I.INV_RCPNT_CD		= #invRcpntCd#
		AND I.DS_ORD_TP_CD     = DOT.DS_ORD_TP_CD
		AND I.GLBL_CMPY_CD     = DOT.GLBL_CMPY_CD
		AND DOT.CONSL_INV_FLG   = 'N'
		AND DOT.EZCANCELFLAG    = '0'
		AND ROWNUM = 1
		FOR UPDATE OF I.INV_NUM
	</statement>

	<statement id="queryMargeINV_DS" parameterClass="Map" resultMap="result.queryMargeINV_DS">
		SELECT
			I.INV_NUM
			,I.INV_TOT_DEAL_NET_AMT
			,I.INV_TOT_DEAL_SLS_AMT
			,I.INV_TOT_DEAL_FRT_AMT
			,I.INV_TOT_DEAL_TAX_AMT
			,I.INV_TOT_DEAL_DISC_AMT
			,I.INV_TOT_FUNC_NET_AMT
			,I.INV_TOT_FUNC_SLS_AMT
			,I.INV_TOT_FUNC_FRT_AMT
			,I.INV_TOT_FUNC_TAX_AMT
			,I.INV_TOT_FUNC_DISC_AMT
		FROM
			INV I
			,DS_ORD_TP DOT
		WHERE
				I.GLBL_CMPY_CD		= #glblCmpyCd#
			AND I.CPO_ORD_NUM		= #cpoOrdNum#
			AND I.PMT_TERM_CD		= #pmtTermCd#
			<isNotNull property="cashDiscTermCd">
			AND I.CASH_DISC_TERM_CD	= #cashDiscTermCd#
			</isNotNull>
			<isNull property="cashDiscTermCd">
			AND I.CASH_DISC_TERM_CD	IS NULL
			</isNull>
			AND I.DEAL_CCY_CD		= #dealCcyCd#
			AND I.INV_DT			= #invDt#
            <isNotNull property="origInvNum">
			AND I.ORIG_INV_NUM		= #origInvNum#
            </isNotNull>
            <isNull property="origInvNum">
            AND I.ORIG_INV_NUM      IS NULL
            </isNull>
			AND I.FNLZ_INV_FLG		= 'N'
			AND I.EZCANCELFLAG		= '0'
            <isNotNull property="billToCtacPsnFirstNm">
                AND I.BILL_TO_CTAC_PSN_FIRST_NM = #billToCtacPsnFirstNm#
            </isNotNull>
            <isNull property="billToCtacPsnFirstNm">
                AND I.BILL_TO_CTAC_PSN_FIRST_NM IS NULL
            </isNull>
            <isNotNull property="billToCtacPsnMidNm">
                AND I.BILL_TO_CTAC_PSN_MID_NM   = #billToCtacPsnMidNm#
            </isNotNull>
            <isNull property="billToCtacPsnMidNm">
                AND I.BILL_TO_CTAC_PSN_MID_NM   IS NULL
            </isNull>
            <isNotNull property="billToCtacPsnLastNm">
                AND I.BILL_TO_CTAC_PSN_LAST_NM  = #billToCtacPsnLastNm#
            </isNotNull>
            <isNull property="billToCtacPsnLastNm">
                AND I.BILL_TO_CTAC_PSN_LAST_NM  IS NULL
            </isNull>
			AND I.INV_RCPNT_CUST_CD	= #invRcpntCd#
			AND I.DS_ORD_TP_CD     = DOT.DS_ORD_TP_CD
			AND I.GLBL_CMPY_CD     = DOT.GLBL_CMPY_CD
			AND DOT.CONSL_INV_FLG   = 'N'
			AND DOT.EZCANCELFLAG    = '0'
		<isEqual property="optGrpKeyFlg" compareValue="Y">
			AND EXISTS (
				SELECT *
				FROM
					INV_BOL IB
				WHERE
					IB.GLBL_CMPY_CD	= I.GLBL_CMPY_CD
				AND IB.INV_NUM			= I.INV_NUM
				<isNotNull property="shipToCustAcctCd">
					AND IB.SHIP_TO_CUST_ACCT_CD	= #shipToCustAcctCd#
				</isNotNull>
				<isNotNull property="ctacPsnPk">
					AND IB.CTAC_PSN_PK		= #ctacPsnPk#
				</isNotNull>
				<isNotNull property="shipToCustLocCd">
					AND IB.SHIP_TO_CUST_CD	= #shipToCustLocCd#
				</isNotNull>
				AND IB.EZCANCELFLAG		= '0'
			)
		</isEqual>
			FOR UPDATE OF I.INV_NUM
	</statement>

	<statement id="queryDsInvRcpnt" parameterClass="EZDMsg" resultClass="Map">
		SELECT
			DIR.CUST_PK
		FROM
			INV_RCPNT DIR
		WHERE
			DIR.GLBL_CMPY_CD		= #glblCmpyCd#
		AND	DIR.INV_RCPNT_CUST_CD	= #invRcpntCustCd#
		AND	DIR.EZCANCELFLAG		= '0'
	</statement>

	<!-- WDS ADD END -->

<!-- #################### Result Mapping #################### -->
	<resultMap id="result.queryContainSHPG_PLN" class="NWZC035002PMsg">
		<result property="glblCmpyCd"				column="GLBL_CMPY_CD"				javaType="EZDPStringItem"/>
		<result property="cpoOrdNum"				column="CPO_ORD_NUM"				javaType="EZDPStringItem"/>
		<result property="ordDt"					column="CPO_ORD_TS"					javaType="EZDPStringItem"/>
		<result property="custIssPoNum"				column="CUST_ISS_PO_NUM"			javaType="EZDPStringItem"/>
		<result property="custIssPoDt"				column="CUST_ISS_PO_DT"				javaType="EZDPStringItem"/>
		<result property="billToCustCd"				column="BILL_TO_CUST_CD"			javaType="EZDPStringItem"/>
		<result property="sellToCustCd"				column="SELL_TO_CUST_CD"			javaType="EZDPStringItem"/>
		<result property="payerCustCd"				column="PAYER_CUST_CD"				javaType="EZDPStringItem"/>
		<result property="pmtTermCd"				column="PMT_TERM_CD"				javaType="EZDPStringItem"/>
		<result property="cashDiscTermCd"			column="CASH_DISC_TERM_CD"			javaType="EZDPStringItem"/>
		<result property="slsAdminPsnCd"			column="ADMIN_PSN_CD"				javaType="EZDPStringItem"/>
		<result property="dealCcyCd"				column="CCY_CD"						javaType="EZDPStringItem"/>
		<result property="actlApplyExchRate"		column="EXCH_RATE"					javaType="EZDPStringItem"/>
		<result property="sysSrcCd"					column="SYS_SRC_CD"					javaType="EZDPStringItem"/>
		<result property="origCpoOrdNum"			column="ORIG_CPO_ORD_NUM"			javaType="EZDPStringItem"/>
		<result property="origInvNum"				column="ORIG_INV_NUM"				javaType="EZDPStringItem"/>
		<result property="soNum"					column="SO_NUM"						javaType="EZDPStringItem"/>
		<result property="bolNum"					column="BOL_NUM"					javaType="EZDPStringItem"/>
		<result property="carrCd"					column="CARR_CD"					javaType="EZDPStringItem"/>
		<result property="carrNm"					column="CARR_NM"					javaType="EZDPStringItem"/>
		<result property="proNum"					column="PRO_NUM"					javaType="EZDPStringItem"/>
		<result property="shipFromInvtyLocCd"		column="INVTY_LOC_CD"				javaType="EZDPStringItem"/>
		<result property="shipToCustCd"				column="SHIP_TO_CUST_CD"			javaType="EZDPStringItem"/>
		<result property="dropShipFlg"				column="DROP_SHIP_FLG"				javaType="EZDPStringItem"/>
		<result property="shipToLocNm"				column="SHIP_TO_LOC_NM"				javaType="EZDPStringItem"/>
		<result property="shipToAddlLocNm"			column="SHIP_TO_ADDL_LOC_NM"		javaType="EZDPStringItem"/>
		<result property="shipToFirstLineAddr"		column="SHIP_TO_FIRST_LINE_ADDR"	javaType="EZDPStringItem"/>
		<result property="shipToScdLineAddr"		column="SHIP_TO_SCD_LINE_ADDR"		javaType="EZDPStringItem"/>
		<result property="shipToThirdLineAddr"		column="SHIP_TO_THIRD_LINE_ADDR"	javaType="EZDPStringItem"/>
		<result property="shipToFrthLineAddr"		column="SHIP_TO_FRTH_LINE_ADDR"		javaType="EZDPStringItem"/>
		<result property="shipToCtyAddr"			column="SHIP_TO_CTY_ADDR"			javaType="EZDPStringItem"/>
		<result property="shipToCntyNm"				column="SHIP_TO_CNTY_NM"			javaType="EZDPStringItem"/>
		<result property="shipToProvNm"				column="SHIP_TO_PROV_ADDR"			javaType="EZDPStringItem"/>
		<result property="shipToStCd"				column="SHIP_TO_ST_CD"				javaType="EZDPStringItem"/>
		<result property="shipToPostCd"				column="SHIP_TO_POST_CD"			javaType="EZDPStringItem"/>
		<result property="shipToCtryCd"				column="SHIP_TO_CTRY_CD"			javaType="EZDPStringItem"/>
		<result property="shipToFirstRefCmntTxt"	column="SHIP_TO_FIRST_REF_CMNT_TXT"	javaType="EZDPStringItem"/>
		<result property="shipToScdRefCmntTxt"		column="SHIP_TO_SCD_REF_CMNT_TXT"	javaType="EZDPStringItem"/>
		<result property="exptFlg"					column="EXPT_FLG"					javaType="EZDPStringItem"/>
		<result property="shipDt"					column="ACTL_SHIP_DT"				javaType="EZDPStringItem"/>
		<result property="arvDt"					column="ACTL_ARV_DT"				javaType="EZDPStringItem"/>
		<result property="shpgSvcLvlCd"				column="REQ_SHPG_SVC_LVL_CD"		javaType="EZDPStringItem"/>
		<result property="frtChrgToCd"				column="REQ_FRT_CHRG_TO_CD"			javaType="EZDPStringItem"/>
		<result property="frtChrgMethCd"			column="REQ_FRT_CHRG_METH_CD"		javaType="EZDPStringItem"/>
		<result property="stkStsCd"					column="STK_STS_CD"					javaType="EZDPStringItem"/>
		<result property="slsRepTocCd"				column="SLS_REP_TOC_CD"				javaType="EZDPStringItem"/>
		<result property="mdseCd"					column="MDSE_CD"					javaType="EZDPStringItem"/>
		<result property="ordQty"					column="CD_ORD_QTY"					javaType="EZDPBigDecimalItem"/>
		<result property="shipQty"					column="SP_ORD_QTY"					javaType="EZDPBigDecimalItem"/>
		<result property="manPrcFlg"				column="MAN_PRC_FLG"				javaType="EZDPStringItem"/>
		<result property="shipDealFrtAmt"			column="SP_TOT_DEAL_FRT_AMT"		javaType="EZDPBigDecimalItem"/>
		<result property="shipFuncFrtAmt"			column="SP_TOT_FUNC_FRT_AMT"		javaType="EZDPBigDecimalItem"/>
		<result property="taxFlg"					column="TAX_FLG"					javaType="EZDPStringItem"/>
		<result property="coaAcctCd"				column="COA_ACCT_CD"				javaType="EZDPStringItem"/>
		<result property="coaProjCd"				column="COA_PROJ_CD"				javaType="EZDPStringItem"/>
		<result property="setMdseCd"				column="SET_MDSE_CD"				javaType="EZDPStringItem"/>
		<result property="sendInvFlg"				column="SEND_INV_FLG"				javaType="EZDPStringItem"/>
		<result property="cpoSrcTpCd"				column="CPO_SRC_TP_CD"				javaType="EZDPStringItem"/>
		<result property="shipCpltCd"				column="SHIP_CPLT_CD"				javaType="EZDPStringItem"/>
		<result property="coaCmpyCd"				column="COA_CMPY_CD"				javaType="EZDPStringItem"/>
		<result property="coaAfflCd"				column="COA_AFFL_CD"				javaType="EZDPStringItem"/>
		<result property="coaBrCd"					column="COA_BR_CD"					javaType="EZDPStringItem"/>
		<result property="coaChCd"					column="COA_CH_CD"					javaType="EZDPStringItem"/>
		<result property="coaCcCd"					column="COA_CC_CD"					javaType="EZDPStringItem"/>
		<result property="coaExtnCd"				column="COA_EXTN_CD"				javaType="EZDPStringItem"/>
		<result property="coaProdCd"				column="COA_PROD_CD"				javaType="EZDPStringItem"/>
		<result property="prcCatgCd"				column="PRC_CATG_CD"				javaType="EZDPStringItem"/>
		<result property="shpgChrgAmt"				column="SHPG_CHRG_AMT"				javaType="EZDPBigDecimalItem"/>
		<result property="pmtTermCashDiscCd"		column="PMT_TERM_CASH_DISC_CD"		javaType="EZDPStringItem"/>
		<result property="setShpgPlnNum"			column="SET_SHPG_PLN_NUM"			javaType="EZDPStringItem"/>
		<result property="mdseTpCd"					column="MDSE_TP_CD"					javaType="EZDPStringItem"/>
		<result property="invRcpntCustCd"			column="INV_RCPNT_CUST_CD"			javaType="EZDPStringItem"/>
		<result property="dsOrdPosnNum"				column="DS_ORD_POSN_NUM"			javaType="EZDPStringItem"/>
		<result property="svcConfigMstrPk"			column="SVC_CONFIG_MSTR_PK"			javaType="EZDPBigDecimalItem"/>
		<result property="dsOrdTpCd"				column="DS_ORD_TP_CD"				javaType="EZDPStringItem"/>
		<result property="dsOrdRsnCd"				column="DS_ORD_RSN_CD"				javaType="EZDPStringItem"/>
		<result property="dsContrNum"				column="DS_CONTR_NUM"				javaType="EZDPStringItem"/>
		<result property="dsContrSqNum"				column="DS_CONTR_SQ_NUM"			javaType="EZDPStringItem"/>
		<result property="trxCd"					column="TRX_CD"						javaType="EZDPStringItem"/>
		<result property="trxRsnCd"					column="TRX_RSN_CD"					javaType="EZDPStringItem"/>
		<result property="dsOrdCatgCd"				column="DS_ORD_CATG_CD"				javaType="EZDPStringItem"/>
		<result property="prePmtAmt"				column="PRE_PMT_AMT"				javaType="EZDPBigDecimalItem"/>
		<result property="prePmtChkNum"				column="PRE_PMT_CHK_NUM"			javaType="EZDPStringItem"/>
		<result property="prePmtTpCd"				column="PRE_PMT_TP_CD"				javaType="EZDPStringItem"/>
		<result property="crRebilRsnCatgCd"			column="CR_REBIL_RSN_CATG_CD"		javaType="EZDPStringItem"/>
		<result property="dsPmtMethCd"				column="DS_PMT_METH_CD"				javaType="EZDPStringItem"/>
		<result property="negoDealAmt"				column="NEGO_DEAL_AMT"				javaType="EZDPBigDecimalItem"/>
		<result property="leaseCmpyPoNum"			column="LEASE_CMPY_PO_NUM"			javaType="EZDPStringItem"/>
		<result property="leasePrchOptCd"			column="LEASE_PRCH_OPT_CD"			javaType="EZDPStringItem"/>
		<result property="leaseTermCd"				column="LEASE_TERM_CD"				javaType="EZDPStringItem"/>
		<result property="leasePmtFreqCd"			column="LEASE_PMT_FREQ_CD"			javaType="EZDPStringItem"/>
		<result property="soldToCustLocCd"			column="SOLD_TO_CUST_LOC_CD"		javaType="EZDPStringItem"/>
		<result property="billToCustAcctCd"			column="BILL_TO_CUST_ACCT_CD"		javaType="EZDPStringItem"/>
		<result property="slsRepTocCd_H"			column="SLS_REP_TOC_CD_H"			javaType="EZDPStringItem"/>
		<result property="shipToCustAcctCd"			column="SHIP_TO_CUST_ACCT_CD"		javaType="EZDPStringItem"/>
		<result property="csmpContrNum"				column="CSMP_CONTR_NUM"				javaType="EZDPStringItem"/>
		<result property="dlrRefNum"				column="DLR_REF_NUM"				javaType="EZDPStringItem"/>
		<result property="firstBllgAttrbValTxt"		column="FIRST_BLLG_ATTRB_VAL_TXT"	javaType="EZDPStringItem"/>
		<result property="scdBllgAttrbValTxt"		column="SCD_BLLG_ATTRB_VAL_TXT"		javaType="EZDPStringItem"/>
		<result property="thirdBllgAttrbValTxt"		column="THIRD_BLLG_ATTRB_VAL_TXT"	javaType="EZDPStringItem"/>
		<result property="frthBllgAttrbValTxt"		column="FRTH_BLLG_ATTRB_VAL_TXT"	javaType="EZDPStringItem"/>
		<result property="fifthBllgAttrbValTxt"		column="FIFTH_BLLG_ATTRB_VAL_TXT"	javaType="EZDPStringItem"/>
		<result property="sixthBllgAttrbValTxt"		column="SIXTH_BLLG_ATTRB_VAL_TXT"	javaType="EZDPStringItem"/>
		<result property="uomCd"				column="UOM_CD"				javaType="EZDPStringItem"/>
		<result property="dsCpoLineNum"				column="DS_CPO_LINE_NUM"			javaType="EZDPStringItem"/>
		<result property="dsCpoLineSubNum"			column="DS_CPO_LINE_SUB_NUM"		javaType="EZDPStringItem"/>
		<result property="ordCustUomQty"			column="ORD_CUST_UOM_QTY"		javaType="EZDPBigDecimalItem"/>
		<result property="cpoDtlDealNetAmt"		column="CPO_DTL_DEAL_NET_AMT"		javaType="EZDPBigDecimalItem"/> <!-- 2017/10/12 QC#21645 Add -->
		<result property="origOrCustMdseCd"			column="ORIG_OR_CUST_MDSE_CD"		javaType="EZDPStringItem"/>
		<result property="baseCmptFlg"				column="BASE_CMPT_FLG"				javaType="EZDPStringItem"/>
		<result property="mdlId"					column="MDL_ID"						javaType="EZDPStringItem"/>
		<result property="dsCpoConfigPk"			column="DS_CPO_CONFIG_PK"			javaType="EZDPBigDecimalItem"/>
		<result property="crRebilCd"				column="CR_REBIL_CD"				javaType="EZDPStringItem"/>
		<result property="billToCustLocCd"			column="BILL_TO_CUST_LOC_CD"		javaType="EZDPStringItem"/>
		<result property="soSlpNum"					column="SO_SLP_NUM"					javaType="EZDPStringItem"/>
		<result property="billWithEquipFlg"			column="BILL_WITH_EQUIP_FLG"		javaType="EZDPStringItem"/>
		<result property="invtyCtrlFlg"			column="INVTY_CTRL_FLG"		javaType="EZDPStringItem"/>
		<result property="poReqFlg"			column="PO_REQ_FLG"		javaType="EZDPStringItem"/>
        <result property="dsOrdLineCatgCd"          column="DS_ORD_LINE_CATG_CD"        javaType="EZDPStringItem"/>
        <result property="frtCondCd"          column="FRT_COND_CD"        javaType="EZDPStringItem"/>
        <result property="origInvtyLocCd"			column="ORIG_INVTY_LOC_CD"			javaType="EZDPStringItem"/> <!-- 2-17/10/20 QC#21730 Add -->
	</resultMap>

	<resultMap id="result.queryPRC_DTL" class="INV_PRMO_INFOTMsg">
		<result property="prmoPk"					column="PRMO_PK"					javaType="EZDPBigDecimalItem"/>
		<result property="prmoCatgPk"				column="PRMO_CATG_PK"				javaType="EZDPBigDecimalItem"/>
		<result property="prmoCatgNm"				column="PRMO_CATG_NM"				javaType="EZDPStringItem"/>
		<result property="prmoShortNm"				column="PRMO_SHORT_NM"				javaType="EZDPStringItem"/>
		<result property="prcDt"					column="PRC_DT"						javaType="EZDPStringItem"/>
		<result property="prmoQty"					column="SHIP_UNIT_QTY"				javaType="EZDPBigDecimalItem"/>
		<result property="dealUnitPrcAmt"			column="DEAL_UNIT_PRC_AMT"			javaType="EZDPBigDecimalItem"/>
		<result property="dealLastNetUnitPrcAmt"	column="DEAL_LAST_NET_UNIT_PRC_AMT"	javaType="EZDPBigDecimalItem"/>
		<result property="dealNetAmt"				column="DEAL_NET_AMT"				javaType="EZDPBigDecimalItem"/>
		<result property="dealDiscAmt"				column="DEAL_DISC_AMT"				javaType="EZDPBigDecimalItem"/>
		<result property="dealPrmoNetUnitPrcAmt"	column="DEAL_PRMO_NET_UNIT_PRC_AMT"	javaType="EZDPBigDecimalItem"/>
		<result property="dealPk"					column="DEAL_PK"					javaType="EZDPBigDecimalItem"/>
		<result property="dealPerUnitFixAmt"		column="DEAL_PER_UNIT_FIX_AMT"		javaType="EZDPBigDecimalItem"/>
		<result property="dealSlsPctNum"			column="DEAL_SLS_PCT_NUM"			javaType="EZDPBigDecimalItem"/>
		<result property="funcPerUnitFixAmt"		column="FUNC_PER_UNIT_FIX_AMT"		javaType="EZDPBigDecimalItem"/>
		<result property="funcUnitPrcAmt"			column="FUNC_UNIT_PRC_AMT"			javaType="EZDPBigDecimalItem"/>
		<result property="funcLastNetUnitPrcAmt"	column="FUNC_LAST_NET_UNIT_PRC_AMT"	javaType="EZDPBigDecimalItem"/>
		<result property="funcNetAmt"				column="FUNC_NET_AMT"				javaType="EZDPBigDecimalItem"/>
		<result property="funcDiscAmt"				column="FUNC_DISC_AMT"				javaType="EZDPBigDecimalItem"/>
		<result property="funcPrmoNetUnitPrcAmt"	column="FUNC_PRMO_NET_UNIT_PRC_AMT"	javaType="EZDPBigDecimalItem"/>
		<result property="dealNm"					column="DEAL_NM"					javaType="EZDPStringItem"/>
		<result property="prmoDescTxt"				column="PRMO_DESC_TXT"				javaType="EZDPStringItem"/>
		<result property="coaAcctCd"				column="COA_ACCT_CD"				javaType="EZDPStringItem"/>
		<result property="invPrmoInfoSqNum"			column="CPO_LINE_PRC_NUM"			javaType="EZDPStringItem"/>
	</resultMap>

	<resultMap id="result.queryBILL_TO_FOR_FLR_PLN_FLG" class="NWZC035002PMsg">
		<result property="flPlnFlg"  column="FL_PLN_CMPY_FLG"	javaType="EZDPStringItem"/>
	</resultMap>

	<resultMap id="result.queryHLD" class="NWZC035002PMsg">
		<result property="apvlNum"  column="APVL_NUM"	javaType="EZDPStringItem"/>
	</resultMap>

	<resultMap id="result.queryBILL_TO_and_REM_TO" class="INVTMsg">
		<result property="remitToLocNm"		column="LOC_NM"			javaType="EZDTStringItem"/>
		<result property="remitToAddlLocNm"	column="ADDL_LOC_NM"	javaType="EZDTStringItem"/>
		<result property="remId"			column="REM_ID"			javaType="EZDTStringItem"/>
	</resultMap>

	<resultMap id="result.queryINV_RCPNT_FOR_DUNS_NUM" class="INVTMsg">
		<result property="dunsNum"  column="DUNS_NUM"	javaType="EZDTStringItem"/>
	</resultMap>

	<resultMap id="result.querySELL_TO_and_CNTY" class="INVTMsg">
		<result property="sellToLocNm"  			column="LOC_NM"				javaType="EZDTStringItem"/>
		<result property="sellToAddlLocNm"			column="ADDL_LOC_NM"		javaType="EZDTStringItem"/>
		<result property="sellToFirstLineAddr"  	column="FIRST_LINE_ADDR"	javaType="EZDTStringItem"/>
		<result property="sellToScdLineAddr"		column="SCD_LINE_ADDR"		javaType="EZDTStringItem"/>
		<result property="sellToThirdLineAddr"  	column="THIRD_LINE_ADDR"	javaType="EZDTStringItem"/>
		<result property="sellToFrthLineAddr"		column="FRTH_LINE_ADDR"		javaType="EZDTStringItem"/>
		<result property="sellToCtyAddr"			column="CTY_ADDR"			javaType="EZDTStringItem"/>
		<result property="sellToProvNm"				column="PROV_NM"			javaType="EZDTStringItem"/>
		<result property="sellToStCd"				column="ST_CD"				javaType="EZDTStringItem"/>
		<result property="sellToPostCd"				column="POST_CD"			javaType="EZDTStringItem"/>
		<result property="sellToCtryCd"				column="CTRY_CD"			javaType="EZDTStringItem"/>
		<result property="sellToFirstRefCmntTxt"	column="FIRST_REF_CMNT_TXT"	javaType="EZDTStringItem"/>
		<result property="sellToScdRefCmntTxt"  	column="SCD_REF_CMNT_TXT"	javaType="EZDTStringItem"/>
		<result property="sellToCntyNm"  			column="CNTY_NM"			javaType="EZDTStringItem"/>
	</resultMap>

	<resultMap id="result.queryINV_RCPNT_and_CNTY" class="INVTMsg">
		<result property="rcpntLocNm"			column="LOC_NM"				javaType="EZDTStringItem"/>
		<result property="rcpntAddlLocNm"		column="ADDL_LOC_NM"		javaType="EZDTStringItem"/>
		<result property="rcpntFirstLineAddr"	column="FIRST_LINE_ADDR"	javaType="EZDTStringItem"/>
		<result property="rcpntScdLineAddr"		column="SCD_LINE_ADDR"		javaType="EZDTStringItem"/>
		<result property="rcpntThirdLineAddr"	column="THIRD_LINE_ADDR"	javaType="EZDTStringItem"/>
		<result property="rcpntFrthLineAddr"	column="FRTH_LINE_ADDR"		javaType="EZDTStringItem"/>
		<result property="rcpntCtyAddr"			column="CTY_ADDR"			javaType="EZDTStringItem"/>
		<result property="rcpntProvNm"			column="PROV_NM"			javaType="EZDTStringItem"/>
		<result property="rcpntStCd"			column="ST_CD"				javaType="EZDTStringItem"/>
		<result property="rcpntPostCd"			column="POST_CD"			javaType="EZDTStringItem"/>
		<result property="rcpntCtryCd"			column="CTRY_CD"			javaType="EZDTStringItem"/>
		<result property="rcpntCntyNm"			column="CNTY_NM"			javaType="EZDTStringItem"/>
	</resultMap>

	<resultMap id="result.querySHPG_SVC_LVL" class="INV_BOLTMsg">
		<result property="shpgSvcLvlNm"  column="SHPG_SVC_LVL_NM"	javaType="EZDTStringItem"/>
	</resultMap>

	<resultMap id="result.queryFRT_CHRG_TO" class="INV_BOLTMsg">
		<result property="frtChrgToNm"  column="FRT_CHRG_TO_NM"	javaType="EZDTStringItem"/>
	</resultMap>

	<resultMap id="result.queryCOA_PROD" class="INV_LINETMsg">
		<result property="coaProdCd"  column="COA_PROD_CD"	javaType="EZDTStringItem"/>
		<result property="coaProdNm"  column="COA_PROD_NM"	javaType="EZDTStringItem"/>
	</resultMap>

	<resultMap id="result.queryMDSE_SFTY_INFO" class="INV_LINETMsg">
		<result property="mercCntnFlg"  column="MERC_CNTN_FLG"	javaType="EZDTStringItem"/>
	</resultMap>

	<resultMap id="result.queryMargeINV" class="INVTMsg">
		<result property="invNum"				column="INV_NUM"				javaType="EZDTStringItem"/>
	  	<result property="invTotDealNetAmt"		column="INV_TOT_DEAL_NET_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotDealSlsAmt"		column="INV_TOT_DEAL_SLS_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotDealFrtAmt"		column="INV_TOT_DEAL_FRT_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotDealTaxAmt"		column="INV_TOT_DEAL_TAX_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotDealDiscAmt"	column="INV_TOT_DEAL_DISC_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncNetAmt"	    column="INV_TOT_FUNC_NET_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncSlsAmt"		column="INV_TOT_FUNC_SLS_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncFrtAmt"		column="INV_TOT_FUNC_FRT_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncTaxAmt"		column="INV_TOT_FUNC_TAX_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncDiscAmt"	column="INV_TOT_FUNC_DISC_AMT"	javaType="EZDTBigDecimalItem"/>
	</resultMap>

	<!-- WDS ADD START -->
	<resultMap id="result.queryMargeINV_DS" class="INVTMsg">
		<result property="invNum"				column="INV_NUM"				javaType="EZDTStringItem"/>
	  	<result property="invTotDealNetAmt"		column="INV_TOT_DEAL_NET_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotDealSlsAmt"		column="INV_TOT_DEAL_SLS_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotDealFrtAmt"		column="INV_TOT_DEAL_FRT_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotDealTaxAmt"		column="INV_TOT_DEAL_TAX_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotDealDiscAmt"	column="INV_TOT_DEAL_DISC_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncNetAmt"		column="INV_TOT_FUNC_NET_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncSlsAmt"		column="INV_TOT_FUNC_SLS_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncFrtAmt"		column="INV_TOT_FUNC_FRT_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncTaxAmt"		column="INV_TOT_FUNC_TAX_AMT"	javaType="EZDTBigDecimalItem"/>
		<result property="invTotFuncDiscAmt"	column="INV_TOT_FUNC_DISC_AMT"	javaType="EZDTBigDecimalItem"/>
	</resultMap>
	<!-- WDS ADD END -->

<!-- CSA ADD START -->
    <statement id="queryCPO_SVC_PRC" parameterClass="Map" resultClass="Map">
        SELECT
             CNTD.DS_CONTR_DTL_PK
            ,CNTD.CPO_SVC_DTL_PK
            ,CNTD.SHELL_LINE_NUM
            ,CNTD.SELL_TO_CUST_CD
            ,CNTD.SVC_PRC_CATG_CD
            ,CNTD.BASE_BLLG_CYCLE_CD
            ,CNTD.MDL_ID
            ,CNTD.BASE_PRC_DEAL_AMT
            ,CNTD.PRC_CATG_CD
            ,CNT.SVC_PGM_MDSE_CD
            ,(CNTD.TO_PER_MTH_NUM -  CNTD.FROM_PER_MTH_NUM) + 1 AS CONTR_DURN_AOT
            ,CNT.BILL_BY_TP_CD
            ,CNT.ALT_PAYER_CUST_CD
            <!-- 2019/07/01 QC#50780 Add Start  -->
            ,CNT.DS_CONTR_NUM
            <!-- 2019/07/01 QC#50780 Add Start  -->
        FROM
             DS_CONTR_DTL         CNTD
            ,DS_CONTR             CNT
        WHERE
                CNTD.GLBL_CMPY_CD              = #glblCmpyCd#
            AND CNTD.DS_CONTR_DTL_PK           = #dsContrDtlPk#
            AND CNTD.BILL_WITH_EQUIP_FLG       = 'Y'
            AND CNTD.BILL_WITH_EQUIP_INVD_FLG  = 'N'
            AND CNTD.DS_CONTR_DTL_TP_CD IN 
            <iterate property="dsContrDtlTpCdList" var="dsContrDtlTpCd[]" open=" (" close=")" conjunction=",">
                #dsContrDtlTpCd[]#
            </iterate>
            AND CNTD.EZCANCELFLAG              = '0'

            AND CNTD.GLBL_CMPY_CD              = CNT.GLBL_CMPY_CD
            AND CNTD.DS_CONTR_PK               = CNT.DS_CONTR_PK
            AND CNT.EZCANCELFLAG               = '0'
    </statement>

    <statement id="queryCPO_SVC_ADDL_BASE_PRC" parameterClass="Map" resultClass="Map">
        SELECT
             CNTD.PRC_CATG_CD
            ,CNTD.BASE_PRC_DEAL_AMT
            ,CNTD.SVC_PRC_CATG_CD
            ,CNTD.BASE_BLLG_CYCLE_CD
            ,CNTD.CPO_SVC_DTL_PK
            ,(CNTD.TO_PER_MTH_NUM -  CNTD.FROM_PER_MTH_NUM) + 1 AS CONTR_DURN_AOT
            ,CNT.SVC_PGM_MDSE_CD
            ,CHRG.SVC_PRC_CATG_CD          AS CHRG_PRC_CATG_CD
        FROM
             DS_CONTR_DTL          CNTD
            ,DS_CONTR              CNT
            ,DS_CONTR_ADDL_CHRG    CHRG
        WHERE
                CNTD.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND CNTD.DS_CONTR_DTL_PK              = #dsContrDtlPk#
            AND CNTD.BILL_WITH_EQUIP_FLG          = 'Y'
            AND CNTD.BILL_WITH_EQUIP_INVD_FLG     = 'N'
            AND CNTD.DS_CONTR_DTL_TP_CD           = #dsContrDtlTpCd#
            AND CNTD.EZCANCELFLAG                 = '0'

            AND CNTD.GLBL_CMPY_CD                 = CNT.GLBL_CMPY_CD
            AND CNTD.DS_CONTR_PK                  = CNT.DS_CONTR_PK
            AND CNT.EZCANCELFLAG                  = '0'

            AND CNTD.GLBL_CMPY_CD                 = CHRG.GLBL_CMPY_CD(+)
            AND CNTD.DS_CONTR_DTL_PK              = CHRG.DS_CONTR_DTL_PK(+)
            AND CHRG.BILL_WITH_EQUIP_FLG(+)       = 'Y'
            AND CHRG.BILL_WITH_EQUIP_INVD_FLG(+)  = 'N'
            AND CHRG.ADDL_CHRG_CATG_CD(+)         = #addlChrgCatgCd#
            AND CHRG.EZCANCELFLAG(+)              = '0'
    </statement>

    <statement id="queryCPO_SVC_ADDL_CHRG_PRC" parameterClass="Map" resultClass="Map">
        SELECT
             CNTD.CPO_SVC_DTL_PK
            ,CNTD.BASE_BLLG_CYCLE_CD
            ,CNTD.PRC_CATG_CD
            ,CNTD.SVC_PRC_CATG_CD
            ,(CNTD.TO_PER_MTH_NUM -  CNTD.FROM_PER_MTH_NUM) + 1 AS CONTR_DURN_AOT
            ,CHRG.DS_CONTR_ADDL_CHRG_PK
            ,CHRG.ADDL_CHRG_TP_CD
            ,CHRG.ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,CHRG.SVC_PRC_CATG_CD                  AS CHRG_PRC_CATG_CD
        FROM
             DS_CONTR_DTL          CNTD
            ,DS_CONTR              CNT
            ,DS_CONTR_ADDL_CHRG    CHRG
        WHERE
                CNTD.GLBL_CMPY_CD              = #glblCmpyCd#
            AND CNTD.DS_CONTR_DTL_PK           = #dsContrDtlPk#
            AND CNTD.BILL_WITH_EQUIP_FLG       = 'Y'
            AND CNTD.BILL_WITH_EQUIP_INVD_FLG  = 'N'
            AND CNTD.EZCANCELFLAG              = '0'

            AND CNTD.GLBL_CMPY_CD              = CNT.GLBL_CMPY_CD
            AND CNTD.DS_CONTR_PK               = CNT.DS_CONTR_PK
            AND CNT.EZCANCELFLAG               = '0'

            AND CNTD.GLBL_CMPY_CD              = CHRG.GLBL_CMPY_CD
            AND CNTD.DS_CONTR_DTL_PK           = CHRG.DS_CONTR_DTL_PK
            AND CHRG.BILL_WITH_EQUIP_FLG       = 'Y'
            AND CHRG.BILL_WITH_EQUIP_INVD_FLG  = 'N'
            AND CHRG.ADDL_CHRG_CATG_CD         = #addlChrgCatgCd#
            AND CHRG.EZCANCELFLAG              = '0'
    </statement>

	<statement id="getTrxCdForBillWithEquip" parameterClass="Map" resultClass="Map">
		SELECT
			 ILA.SVC_TRX_CD
			,ILA.SVC_TRX_RSN_CD
		FROM
			 MDSE               M
			,AJE_INV_LINE_ALLOC ILA
		WHERE
				M.GLBL_CMPY_CD     = #glblCmpyCd#
			AND M.MDSE_CD          = #mdseCd#
			AND M.EZCANCELFLAG    = '0'
			AND ILA.GLBL_CMPY_CD    = M.GLBL_CMPY_CD
			AND ILA.SVC_ALLOC_TP_CD = M.SVC_ALLOC_TP_CD
			AND ILA.EZCANCELFLAG    = '0'
	</statement>
<!-- QC#14434 add Start -->
    <statement id="getBillWithEquipmentTargetCpoSvcDtlPk" parameterClass="Map" resultClass="Map">
        SELECT
            DISTINCT <!-- 2018/05/21 S21_NA#26068 Add -->
            CNTD.DS_CONTR_DTL_PK
            <!-- QC#19783 add Start -->
           ,DC.DS_CONTR_CATG_CD
           ,DC.DS_CONTR_PK
            <!-- QC#19783 add End -->
        FROM
             DS_CONTR_DTL        CNTD
            ,DS_CONTR_ADDL_CHRG  CHRG
            <!-- QC#19783 add Start -->
            ,DS_CONTR            DC
            <!-- QC#19783 add End -->
        WHERE
                CNTD.GLBL_CMPY_CD                = #glblCmpyCd#
            AND CNTD.CPO_ORD_NUM                 = #cpoOrdNum#
            AND CNTD.CPO_DTL_LINE_NUM            = #cpoDtlLineNum#
            AND CNTD.CPO_DTL_LINE_SUB_NUM        = #cpoDtlLineSubNum#
            AND CNTD.BILL_WITH_EQUIP_FLG         = 'Y'
            AND CNTD.BILL_WITH_EQUIP_INVD_FLG    = 'N'
            AND CNTD.EZCANCELFLAG                = '0'

            AND CHRG.GLBL_CMPY_CD                = CNTD.GLBL_CMPY_CD
            AND CHRG.DS_CONTR_DTL_PK             = CNTD.DS_CONTR_DTL_PK
            AND CHRG.BILL_WITH_EQUIP_FLG         = CNTD.BILL_WITH_EQUIP_FLG
            AND CHRG.BILL_WITH_EQUIP_INVD_FLG    = CNTD.BILL_WITH_EQUIP_INVD_FLG
            AND CHRG.EZCANCELFLAG                = '0'
            <!-- QC#19783 add Start -->
            AND DC.GLBL_CMPY_CD                  = CNTD.GLBL_CMPY_CD
            AND DC.DS_CONTR_PK                   = CNTD.DS_CONTR_PK
            AND DC.EZCANCELFLAG                  = '0'
            <!-- QC#19783 add End -->
        UNION ALL
        SELECT
            CNTD.DS_CONTR_DTL_PK
            <!-- QC#19783 add Start -->
           ,DC.DS_CONTR_CATG_CD
           ,DC.DS_CONTR_PK
           <!-- QC#19783 add End -->
        FROM
            DS_CONTR_DTL         CNTD
            <!-- QC#19783 add Start -->
           ,DS_CONTR             DC
            <!-- QC#19783 add End -->
        WHERE
                CNTD.GLBL_CMPY_CD                = 'ADB'
            <isNotNull property="dsContrDtlPk">
            AND CNTD.DS_CONTR_DTL_PK             = #dsContrDtlPk#
            </isNotNull>
            <isNull property="dsContrDtlPk">
            AND CNTD.CPO_ORD_NUM                 = #cpoOrdNum#
            AND CNTD.CPO_DTL_LINE_NUM            = #cpoDtlLineNum#
            AND CNTD.CPO_DTL_LINE_SUB_NUM        = #cpoDtlLineSubNum#
            </isNull>
            AND CNTD.BILL_WITH_EQUIP_FLG         = 'Y'
            AND CNTD.BILL_WITH_EQUIP_INVD_FLG    = 'N'
            AND CNTD.EZCANCELFLAG                = '0'
            <!-- QC#19783 add Start -->
            AND DC.GLBL_CMPY_CD                  = CNTD.GLBL_CMPY_CD
            AND DC.DS_CONTR_PK                   = CNTD.DS_CONTR_PK
            AND DC.EZCANCELFLAG                  = '0'
            <!-- QC#19783 add End -->
            AND (
                NOT EXISTS (
                    SELECT
                        '1' 
                    FROM
                        DS_CONTR_ADDL_CHRG CHRG
                    WHERE
                            CHRG.GLBL_CMPY_CD                = CNTD.GLBL_CMPY_CD
                        AND CHRG.DS_CONTR_DTL_PK             = CNTD.DS_CONTR_DTL_PK
                        AND CHRG.EZCANCELFLAG                = '0'
                    )
                )
    </statement>
<!-- QC#14434 add End -->

<!-- QC#19783 add Start -->
    <statement id="getBillWithEquipmentTargetCpoSvcDtlPkFleet" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            CNTD.DS_CONTR_DTL_PK
        FROM
            DS_CONTR_DTL        CNTD
        WHERE
                CNTD.GLBL_CMPY_CD                = #glblCmpyCd#
            AND CNTD.CPO_ORD_NUM                 = #cpoOrdNum#
            AND CNTD.DS_CONTR_PK                 = #dsContrPk#
            <isNotNull property="dsContrDtlTpCd">
            AND CNTD.DS_CONTR_DTL_TP_CD          = #dsContrDtlTpCd#
            AND CNTD.CPO_DTL_LINE_NUM            IS NULL
            AND CNTD.CPO_DTL_LINE_SUB_NUM        IS NULL
            </isNotNull>
            <isNull property="dsContrDtlTpCd">
            AND CNTD.BILL_WITH_EQUIP_FLG         = 'Y'
            AND CNTD.BILL_WITH_EQUIP_INVD_FLG    = 'Y'
            </isNull>
            AND CNTD.EZCANCELFLAG                = '0'
    </statement>
<!-- QC#19783 add End -->



	<statement id="getCtacPsnFromCpo" parameterClass="Map" resultMap="result.getCtacPsnFromCpo">
<!-- QC#23559 add Start -->
        WITH    CTAC AS (
            SELECT
                 DCCP.DS_CPO_CTAC_PSN_PK
                ,DCCP.CTAC_PSN_TP_CD
            FROM
                 DS_CPO_CTAC_PSN    DCCP
            WHERE
                DCCP.GLBL_CMPY_CD       = #glblCmpyCd#
            AND DCCP.CPO_ORD_NUM        = #cpoOrdNum#
        <isNull property="dsCpoConfigPk">
            AND DCCP.DS_CPO_CONFIG_PK   IS NULL
        </isNull>
        <isNotNull property="dsCpoConfigPk">
            AND DCCP.DS_CPO_CONFIG_PK   = #dsCpoConfigPk#
        </isNotNull>
        <isNull property="scdCtacTpCd">
            AND DCCP.CTAC_PSN_TP_CD     = #ctacTpCd#
        </isNull>
        <isNotNull property="scdCtacTpCd">
            AND DCCP.CTAC_PSN_TP_CD     IN (#ctacTpCd#, #scdCtacTpCd#)
        </isNotNull>
            AND DCCP.EZCANCELFLAG       = '0'
        )
<!-- QC#23559 add End -->
		SELECT
			 CTAC_PSN_PK
			,CTAC_PSN_FIRST_NM
			,CTAC_PSN_MID_NM
			,CTAC_PSN_LAST_NM
		FROM
			DS_CPO_CTAC_PSN
		WHERE
            DS_CPO_CTAC_PSN_PK = (
<!-- QC#23559 mod Start -->
<!-- 
				SELECT
					MAX(DCCP.DS_CPO_CTAC_PSN_PK)
				FROM
					DS_CPO_CTAC_PSN DCCP
				WHERE
					DCCP.GLBL_CMPY_CD     = #glblCmpyCd#
				<isNotNull property="dsCpoConfigPk">
				AND DCCP.DS_CPO_CONFIG_PK = #dsCpoConfigPk#
				</isNotNull>
				<isNotNull property="cpoOrdNum">
				AND DCCP.CPO_ORD_NUM      = #cpoOrdNum#
				</isNotNull>
				AND DCCP.CTAC_PSN_TP_CD   = #ctacTpCd#
				AND DCCP.EZCANCELFLAG     = '0'
 -->
                SELECT
                    NVL((SELECT MAX(DS_CPO_CTAC_PSN_PK) FROM CTAC WHERE CTAC_PSN_TP_CD = #ctacTpCd#)
                    <isNotNull property="scdCtacTpCd">
                       ,(SELECT MAX(DS_CPO_CTAC_PSN_PK) FROM CTAC WHERE CTAC_PSN_TP_CD = #scdCtacTpCd#)
                    </isNotNull>
                    <isNull property="scdCtacTpCd">
                       ,NULL
                    </isNull>
                    )
                FROM DUAL
<!-- QC#23559 mod End -->
			)
	</statement>
	<resultMap id="result.getCtacPsnFromCpo" class="CTAC_PSNTMsg">
	  	<result property="ctacPsnPk"			column="CTAC_PSN_PK"			javaType="EZDTBigDecimalItem"/>
		<result property="ctacPsnFirstNm"		column="CTAC_PSN_FIRST_NM"		javaType="EZDTStringItem"/>
		<result property="ctacPsnMidNm"			column="CTAC_PSN_MID_NM"		javaType="EZDTStringItem"/>
		<result property="ctacPsnLastNm"		column="CTAC_PSN_LAST_NM"		javaType="EZDTStringItem"/>
	</resultMap>

    <statement id="getCtacPsnFromCustomer" parameterClass="Map" resultMap="result.getCtacPsnFromCustomer">
<!-- QC#23559 add Start -->
        WITH CTAC AS (
            SELECT
                 DCR.CTAC_PSN_PK
                ,DCR.CTAC_TP_CD
                ,DCR.DS_PRIM_LOC_FLG
            FROM
                 DS_CTAC_PSN_RELN   DCR
                ,CTAC_PSN           CP
            WHERE
                DCR.GLBL_CMPY_CD            = 'ADB'
                <isNotNull property="custLocCd">
                AND DCR.LOC_NUM             = (
                    <isNotNull property="billToLocFlg">
                        SELECT LOC_NUM
                            FROM
                                BILL_TO_CUST
                           WHERE
                                GLBL_CMPY_CD    = #glblCmpyCd#
                            AND BILL_TO_CUST_CD = #custLocCd#
                            AND EZCANCELFLAG    = '0'
                    </isNotNull>
                    <isNull property="billToLocFlg">
                        SELECT LOC_NUM
                            FROM
                                SHIP_TO_CUST
                           WHERE
                                GLBL_CMPY_CD    = #glblCmpyCd#
                            AND SHIP_TO_CUST_CD = #custLocCd#
                            AND EZCANCELFLAG    = '0'
                    </isNull>
                    )
                </isNotNull>
                <isNotNull property="custAcctCd">
                AND DCR.DS_ACCT_NUM         = #custAcctCd#
                </isNotNull>
                AND DCR.EFF_FROM_DT         &lt;= #invDt#
                AND (DCR.EFF_THRU_DT        &gt;= #invDt#
                    OR
                    DCR.EFF_THRU_DT         IS NULL
                )
                <isNull property="scdCtacTpCd">
                    AND DCR.CTAC_TP_CD      = #ctacTpCd#
                </isNull>
                <isNotNull property="scdCtacTpCd">
                    AND DCR.CTAC_TP_CD      IN (#ctacTpCd#, #scdCtacTpCd#)
                </isNotNull>
                AND DCR.EZCANCELFLAG        = '0'
                AND CP.GLBL_CMPY_CD         = DCR.GLBL_CMPY_CD
                AND CP.CTAC_PSN_PK          = DCR.CTAC_PSN_PK
                AND CP.EZCANCELFLAG         = '0'
                AND CP.CTAC_PSN_ACTV_FLG    = #activeFlg#
        )
<!-- QC#23559 add End -->
        SELECT
             CTAC_PSN_PK
            ,CTAC_PSN_FIRST_NM
            ,CTAC_PSN_MID_NM
            ,CTAC_PSN_LAST_NM
        FROM
            CTAC_PSN
        WHERE
            CTAC_PSN_PK = (
<!-- QC#23559 mod Start -->
<!-- 
                SELECT
                    MAX(CP.CTAC_PSN_PK)
                FROM
                     DS_CTAC_PSN_RELN DCR
                    ,CTAC_PSN CP
                WHERE
                    DCR.GLBL_CMPY_CD        = #glblCmpyCd#
                <isNotNull property="custLocCd">
                AND DCR.LOC_NUM             = (
                    <isNotNull property="billToLocFlg">
                        SELECT LOC_NUM
                            FROM
                                BILL_TO_CUST
                           WHERE
                                GLBL_CMPY_CD    = #glblCmpyCd#
                            AND BILL_TO_CUST_CD = #custLocCd#
                            AND EZCANCELFLAG    = '0'
                    </isNotNull>
                    <isNull property="billToLocFlg">
                        SELECT LOC_NUM
                            FROM
                                SHIP_TO_CUST
                           WHERE
                                GLBL_CMPY_CD    = #glblCmpyCd#
                            AND SHIP_TO_CUST_CD = #custLocCd#
                            AND EZCANCELFLAG    = '0'
                    </isNull>
                    )
                </isNotNull>
                <isNotNull property="custAcctCd">
                AND DCR.DS_ACCT_NUM         = #custAcctCd#
                </isNotNull>
                AND DCR.EFF_FROM_DT         &lt;= #invDt#
                AND (DCR.EFF_THRU_DT        &gt;= #invDt#
                    OR
                    DCR.EFF_THRU_DT         IS NULL
                )
                AND DCR.CTAC_TP_CD          = #ctacTpCd#
                AND DCR.EZCANCELFLAG        = '0'
                AND CP.GLBL_CMPY_CD         = DCR.GLBL_CMPY_CD
                AND CP.CTAC_PSN_PK          = DCR.CTAC_PSN_PK
                AND CP.EZCANCELFLAG         = '0'
                AND CP.CTAC_PSN_ACTV_FLG    = #activeFlg#
                <isNotNull property="dsCtacPsnDeptCd">
                AND CP.DS_CTAC_PSN_DEPT_CD  = #dsCtacPsnDeptCd#
                </isNotNull>
                AND DCR.EZCANCELFLAG        = '0'
 -->
                SELECT
                    NVL((SELECT MAX(CTAC_PSN_PK) FROM CTAC      WHERE CTAC_TP_CD = #ctacTpCd# AND DS_PRIM_LOC_FLG = 'Y')
                        ,NVL((SELECT MAX(CTAC_PSN_PK) FROM CTAC WHERE CTAC_TP_CD = #ctacTpCd#)
                <isNotNull property="scdCtacTpCd">
                            ,NVL((SELECT MAX(CTAC_PSN_PK) FROM CTAC WHERE CTAC_TP_CD = #scdCtacTpCd# AND DS_PRIM_LOC_FLG = 'Y')
                                ,(SELECT MAX(CTAC_PSN_PK) FROM CTAC WHERE CTAC_TP_CD = #scdCtacTpCd#)
                            )
                </isNotNull>
                <isNull property="scdCtacTpCd">
                            ,NULL
                </isNull>
                        )
                    )
                FROM DUAL
             )
    </statement>
<!-- QC#23559 mod End -->

	<resultMap id="result.getCtacPsnFromCustomer" class="CTAC_PSNTMsg">
	  	<result property="ctacPsnPk"			column="CTAC_PSN_PK"			javaType="EZDTBigDecimalItem"/>
		<result property="ctacPsnFirstNm"		column="CTAC_PSN_FIRST_NM"		javaType="EZDTStringItem"/>
		<result property="ctacPsnMidNm"			column="CTAC_PSN_MID_NM"		javaType="EZDTStringItem"/>
		<result property="ctacPsnLastNm"		column="CTAC_PSN_LAST_NM"		javaType="EZDTStringItem"/>
	</resultMap>

<!-- QC#27172 Add Start --> 
    <statement id="getBillToCtacPsnFromCustomer" parameterClass="Map" resultClass="Map">
        WITH CTAC AS (
            SELECT
                 DCR.CTAC_PSN_PK
                ,DCR.CTAC_TP_CD
                ,DCR.DS_PRIM_LOC_FLG
            FROM
                 DS_CTAC_PSN_RELN   DCR
                ,CTAC_PSN           CP
            WHERE
                DCR.GLBL_CMPY_CD            = 'ADB'
                <isNotNull property="custLocCd">
                AND DCR.LOC_NUM             = (
                    <isNotNull property="billToLocFlg">
                        SELECT LOC_NUM
                            FROM
                                BILL_TO_CUST
                           WHERE
                                GLBL_CMPY_CD    = #glblCmpyCd#
                            AND BILL_TO_CUST_CD = #custLocCd#
                            AND EZCANCELFLAG    = '0'
                    </isNotNull>
                    <isNull property="billToLocFlg">
                        SELECT LOC_NUM
                            FROM
                                SHIP_TO_CUST
                           WHERE
                                GLBL_CMPY_CD    = #glblCmpyCd#
                            AND SHIP_TO_CUST_CD = #custLocCd#
                            AND EZCANCELFLAG    = '0'
                    </isNull>
                    )
                </isNotNull>
                <isNotNull property="custAcctCd">
                AND DCR.DS_ACCT_NUM         = #custAcctCd#
                </isNotNull>
                AND DCR.EFF_FROM_DT         &lt;= #invDt#
                AND (DCR.EFF_THRU_DT        &gt;= #invDt#
                    OR
                    DCR.EFF_THRU_DT         IS NULL
                )
                <isNull property="scdCtacTpCd">
                    AND DCR.CTAC_TP_CD      = #ctacTpCd#
                </isNull>
                <isNotNull property="scdCtacTpCd">
                    AND DCR.CTAC_TP_CD      IN (#ctacTpCd#, #scdCtacTpCd#)
                </isNotNull>
                AND DCR.EZCANCELFLAG        = '0'
                AND CP.GLBL_CMPY_CD         = DCR.GLBL_CMPY_CD
                AND CP.CTAC_PSN_PK          = DCR.CTAC_PSN_PK
                AND CP.EZCANCELFLAG         = '0'
                AND CP.CTAC_PSN_ACTV_FLG    = #activeFlg#
        )
        SELECT
             CTAC_PSN_PK
            ,CTAC_PSN_FIRST_NM
            ,CTAC_PSN_MID_NM
            ,CTAC_PSN_LAST_NM
        FROM
            CTAC_PSN
        WHERE
            CTAC_PSN_PK IN (
                WITH CTAC_LIST AS ( 
                  SELECT
                      CTAC_PSN_PK
                    , 1 PRIORITY 
                  FROM
                    CTAC 
                  WHERE
                    CTAC_TP_CD = #ctacTpCd#
                    AND DS_PRIM_LOC_FLG = 'Y'
                  UNION ALL 
                  SELECT
                      CTAC_PSN_PK
                    , 2 PRIORITY 
                  FROM
                    CTAC 
                  WHERE
                    CTAC_TP_CD = #ctacTpCd#
                <isNotNull property="scdCtacTpCd">
                  UNION ALL 
                  SELECT
                      CTAC_PSN_PK
                    , 3 PRIORITY 
                  FROM
                    CTAC 
                  WHERE
                    CTAC_TP_CD = #scdCtacTpCd#
                    AND DS_PRIM_LOC_FLG = 'Y'
                  UNION ALL 
                  SELECT
                      CTAC_PSN_PK
                    , 4 PRIORITY 
                  FROM
                    CTAC 
                  WHERE
                    CTAC_TP_CD = #scdCtacTpCd#
                </isNotNull>
                ) 
                SELECT
                    DISTINCT(CTAC_PSN_PK) 
                FROM
                  (SELECT MIN(PRIORITY) PRIORITY FROM CTAC_LIST) MIN_LIST
                  , CTAC_LIST CL 
                WHERE
                  MIN_LIST.PRIORITY = CL.PRIORITY
             )
    </statement>
<!-- QC#27172 Add End -->

	<statement id="getInvGrpAttrbTxt" parameterClass="Map" resultClass="String">
		SELECT
			IGA.INV_GRP_ATTRB_TXT
		FROM
			DS_INV_GRP_ATTRB IGA
		WHERE
			    IGA.GLBL_CMPY_CD = #glblCmpyCd#
			AND IGA.DS_INV_TP_CD = #dsInvTpCd#
			AND IGA.EZCANCELFLAG = '0'
	</statement>

	<statement id="getBizAreaCd" parameterClass="Map" resultClass="String">
		SELECT
            OCB.SCD_BIZ_CTX_ATTRB_TXT
		FROM
			ORD_CATG_BIZ_CTX OCB
		WHERE
			    OCB.GLBL_CMPY_CD       = #glblCmpyCd#
			AND OCB.ORD_CATG_CTX_TP_CD in
			<iterate property="ordCatgCtxTpCdList" var="ordCatgCtxTpCd[]" open=" (" close=")" conjunction=",">
				#ordCatgCtxTpCd[]#
			</iterate>
			AND  OCB.DS_ORD_CATG_CD    = #dsOrdCatgCd#
			AND (OCB.DS_ORD_TP_CD      is null
			  OR OCB.DS_ORD_TP_CD      = #dsOrdTpCd#)
			AND (OCB.DS_ORD_RSN_CD     is null
			  OR OCB.DS_ORD_RSN_CD     = #dsOrdRsnCd#)
			AND  OCB.EZCANCELFLAG      = '0'
		
	</statement>

	<statement id="getSoldToCustLocNm" parameterClass="Map" resultClass="String">
		SELECT
			BT.LOC_NM
		FROM
			BILL_TO_CUST BT
		WHERE
			    BT.GLBL_CMPY_CD     = #glblCmpyCd#
			AND BT.BILL_TO_CUST_CD  = #billToCustCd#
			AND BT.EZCANCELFLAG     = '0'
	</statement>
	<statement id="getCustAcctNm" parameterClass="Map" resultClass="String">
		SELECT
			ST.DS_ACCT_NM
		FROM
			SELL_TO_CUST ST
		WHERE
				ST.GLBL_CMPY_CD    = #glblCmpyCd#
			AND ST.SELL_TO_CUST_CD = #dsAcctNum#
			AND ST.EZCANCELFLAG    = '0'
	</statement>
	<statement id="queryTRTY_STRU" parameterClass="Map" resultClass="Map">
	    <!-- QC#53909 Mod Start-->
		SELECT
		    TSV.FIRST_BIZ_AREA_ORG_CD
		  , TSV.FIRST_ORG_CD
		  , TSV.FIRST_ORG_NM
		  , TSV.SCD_ORG_CD
		  , TSV.SCD_ORG_NM
		  , TSV.THIRD_ORG_CD
		  , TSV.THIRD_ORG_NM
		  , TSV.FRTH_ORG_CD
		  , TSV.FRTH_ORG_NM
		  , TSV.FIFTH_ORG_CD
		  , TSV.FIFTH_ORG_NM
		  , TSV.SIXTH_ORG_CD
		  , TSV.SIXTH_ORG_NM
		  , TSV.SVNTH_ORG_CD
		  , TSV.SVNTH_ORG_NM
		  , TSV.EIGHTH_ORG_CD
		  , TSV.EIGHTH_ORG_NM
		  , TSV.NINTH_ORG_CD
		  , TSV.NINTH_ORG_NM
		  , TSV.TENTH_ORG_CD
		  , TSV.TENTH_ORG_NM 
		FROM
		  ORG_FUNC_ASG OFA
		  , DS_ORG_RESRC_RELN DORR
		  , ( 
		    SELECT
		        ORG1.GLBL_CMPY_CD,
		        ORG1.ORG_CD,
		        ORG1.ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '0' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '0' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '0' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '0' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '0' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '0' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '0' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '0' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '0' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '0' THEN ORG10.ORG_CD
		        END
		           AS FIRST_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '0' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '0' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '0' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '0' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '0' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '0' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '0' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '0' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '0' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '0' THEN ORG10.ORG_NM
		        END
		           AS FIRST_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '0' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '0' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '0' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '0' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '0' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '0' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '0' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '0' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '0' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '0' THEN ORG10.ORG_TIER_CD
		        END
		           AS FIRST_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '0' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '0' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '0' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '0' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '0' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '0' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '0' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '0' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '0' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '0' THEN ORG10.FIRST_ORG_CD
		        END
		           AS FIRST_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '0' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '0' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '0' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '0' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '0' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '0' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '0' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '0' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '0' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '0' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS FIRST_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '0' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '0' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '0' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '0' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '0' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '0' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '0' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '0' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '0' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '0' THEN ORG10.TRTY_TP_CD
		        END
		           AS FIRST_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.ORG_CD
		        END
		           AS SCD_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.ORG_NM
		        END
		           AS SCD_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.ORG_TIER_CD
		        END
		           AS SCD_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.FIRST_ORG_CD
		        END
		           AS SCD_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS SCD_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.TRTY_TP_CD
		        END
		           AS SCD_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.ORG_CD
		        END
		           AS THIRD_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.ORG_NM
		        END
		           AS THIRD_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.ORG_TIER_CD
		        END
		           AS THIRD_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.FIRST_ORG_CD
		        END
		           AS THIRD_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS THIRD_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.TRTY_TP_CD
		        END
		           AS THIRD_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.ORG_CD
		        END
		           AS FRTH_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.ORG_NM
		        END
		           AS FRTH_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.ORG_TIER_CD
		        END
		           AS FRTH_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.FIRST_ORG_CD
		        END
		           AS FRTH_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS FRTH_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.TRTY_TP_CD
		        END
		           AS FRTH_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.ORG_CD
		        END
		           AS FIFTH_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.ORG_NM
		        END
		           AS FIFTH_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.ORG_TIER_CD
		        END
		           AS FIFTH_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.FIRST_ORG_CD
		        END
		           AS FIFTH_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS FIFTH_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.TRTY_TP_CD
		        END
		           AS FIFTH_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.ORG_CD
		        END
		           AS SIXTH_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.ORG_NM
		        END
		           AS SIXTH_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.ORG_TIER_CD
		        END
		           AS SIXTH_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.FIRST_ORG_CD
		        END
		           AS SIXTH_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS SIXTH_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.TRTY_TP_CD
		        END
		           AS SIXTH_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.ORG_CD
		        END
		           AS SVNTH_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.ORG_NM
		        END
		           AS SVNTH_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.ORG_TIER_CD
		        END
		           AS SVNTH_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.FIRST_ORG_CD
		        END
		           AS SVNTH_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS SVNTH_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.TRTY_TP_CD
		        END
		           AS SVNTH_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.ORG_CD
		        END
		           AS EIGHTH_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.ORG_NM
		        END
		           AS EIGHTH_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.ORG_TIER_CD
		        END
		           AS EIGHTH_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.FIRST_ORG_CD
		        END
		           AS EIGHTH_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS EIGHTH_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.TRTY_TP_CD
		        END
		           AS EIGHTH_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.ORG_CD
		        END
		           AS NINTH_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.ORG_NM
		        END
		           AS NINTH_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.ORG_TIER_CD
		        END
		           AS NINTH_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.FIRST_ORG_CD
		        END
		           AS NINTH_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS NINTH_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.TRTY_TP_CD
		        END
		           AS NINTH_TRTY_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.ORG_CD
		        END
		           AS TENTH_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.ORG_NM
		           WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.ORG_NM
		           WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.ORG_NM
		           WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.ORG_NM
		           WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.ORG_NM
		           WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.ORG_NM
		           WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.ORG_NM
		           WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.ORG_NM
		           WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.ORG_NM
		           WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.ORG_NM
		        END
		           AS TENTH_ORG_NM,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.ORG_TIER_CD
		           WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.ORG_TIER_CD
		           WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.ORG_TIER_CD
		           WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.ORG_TIER_CD
		           WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.ORG_TIER_CD
		           WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.ORG_TIER_CD
		           WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.ORG_TIER_CD
		           WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.ORG_TIER_CD
		           WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.ORG_TIER_CD
		           WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.ORG_TIER_CD
		        END
		           AS TENTH_ORG_TIER_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.FIRST_ORG_CD
		           WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.FIRST_ORG_CD
		           WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.FIRST_ORG_CD
		           WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.FIRST_ORG_CD
		           WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.FIRST_ORG_CD
		           WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.FIRST_ORG_CD
		           WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.FIRST_ORG_CD
		           WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.FIRST_ORG_CD
		           WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.FIRST_ORG_CD
		           WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.FIRST_ORG_CD
		        END
		           AS TENTH_BIZ_AREA_ORG_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.TRTY_GRP_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.TRTY_GRP_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.TRTY_GRP_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.TRTY_GRP_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.TRTY_GRP_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.TRTY_GRP_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.TRTY_GRP_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.TRTY_GRP_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.TRTY_GRP_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.TRTY_GRP_TP_CD
		        END
		           AS TENTH_TRTY_GRP_TP_CD,
		        CASE
		           WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.TRTY_TP_CD
		           WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.TRTY_TP_CD
		           WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.TRTY_TP_CD
		           WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.TRTY_TP_CD
		           WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.TRTY_TP_CD
		           WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.TRTY_TP_CD
		           WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.TRTY_TP_CD
		           WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.TRTY_TP_CD
		           WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.TRTY_TP_CD
		           WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.TRTY_TP_CD
		        END
		           AS TENTH_TRTY_TP_CD
		    FROM
		      ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG1
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG2
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG3
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG4
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG5
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG6
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG7
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG8
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG9
		      , ( 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , RELN.PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , DS_ORG_RELN RELN
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND RELN.EZCANCELFLAG = '0' 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_CD = RELN.ORG_CD 
		          AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD 
		          AND ORG.ORG_TIER_CD != '0' 
		          AND ORG.GNRN_TP_CD = '2' 
		          AND RELN.GNRN_TP_CD = '2' 
		        UNION ALL 
		        SELECT
		            ORG.GLBL_CMPY_CD
		          , ORG.ORG_CD
		          , ORG.ORG_TIER_CD
		          , ORG.ORG_NM
		          , ORG.FIRST_ORG_CD
		          , ORG.TRTY_GRP_TP_CD
		          , ORG.TRTY_TP_CD
		          , ORG.ORG_CD AS PRNT_ORG_CD 
		        FROM
		          DS_ORG_UNIT ORG
		          , ORG_STRU_TP STRU 
		        WHERE
		          ORG.GLBL_CMPY_CD = 'ADB' 
		          AND ORG.EZCANCELFLAG = '0' 
		          AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD 
		          AND STRU.EZCANCELFLAG = '0' 
		          AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD 
		          AND STRU.TRTY_STRU_FLG = 'Y' 
		          AND ORG.ORG_TIER_CD = '0' 
		          AND ORG.GNRN_TP_CD = '2'
		      ) ORG10 
		    WHERE
		      ORG1.PRNT_ORG_CD = ORG2.ORG_CD 
		      AND ORG2.PRNT_ORG_CD = ORG3.ORG_CD 
		      AND ORG3.PRNT_ORG_CD = ORG4.ORG_CD 
		      AND ORG4.PRNT_ORG_CD = ORG5.ORG_CD 
		      AND ORG5.PRNT_ORG_CD = ORG6.ORG_CD 
		      AND ORG6.PRNT_ORG_CD = ORG7.ORG_CD 
		      AND ORG7.PRNT_ORG_CD = ORG8.ORG_CD 
		      AND ORG8.PRNT_ORG_CD = ORG9.ORG_CD 
		      AND ORG9.PRNT_ORG_CD = ORG10.ORG_CD 
		    ORDER BY
		      ORG1.FIRST_ORG_CD
		      , ORG1.ORG_CD
		      , ORG1.ORG_TIER_CD
		  ) TSV 
		WHERE
		  OFA.GLBL_CMPY_CD = #glblCmpyCd# 
		  AND OFA.TOC_CD = #tocCd# 
		  AND OFA.EZCANCELFLAG = '0' 
		  AND DORR.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD 
		  AND DORR.PSN_CD = OFA.PSN_CD 
		  AND DORR.EZCANCELFLAG = '0' 
		  AND TSV.GLBL_CMPY_CD = DORR.GLBL_CMPY_CD 
		  AND TSV.ORG_CD = DORR.ORG_CD
		<!-- 
		SELECT
			 TSV.FIRST_BIZ_AREA_ORG_CD
			,TSV.FIRST_ORG_CD
			,TSV.FIRST_ORG_NM
			,TSV.SCD_ORG_CD
			,TSV.SCD_ORG_NM
			,TSV.THIRD_ORG_CD
			,TSV.THIRD_ORG_NM
			,TSV.FRTH_ORG_CD
			,TSV.FRTH_ORG_NM
			,TSV.FIFTH_ORG_CD
			,TSV.FIFTH_ORG_NM
			,TSV.SIXTH_ORG_CD
			,TSV.SIXTH_ORG_NM
			,TSV.SVNTH_ORG_CD
			,TSV.SVNTH_ORG_NM
			,TSV.EIGHTH_ORG_CD
			,TSV.EIGHTH_ORG_NM
			,TSV.NINTH_ORG_CD
			,TSV.NINTH_ORG_NM
			,TSV.TENTH_ORG_CD
			,TSV.TENTH_ORG_NM
		FROM
			 ORG_FUNC_ASG OFA
			,DS_ORG_RESRC_RELN DORR
			,TRTY_STRU_V TSV
		WHERE
			    OFA.GLBL_CMPY_CD  = #glblCmpyCd#
			AND OFA.TOC_CD        = #tocCd#
			AND OFA.EZCANCELFLAG  = '0'
			AND DORR.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD
			AND DORR.PSN_CD       = OFA.PSN_CD
			AND DORR.EZCANCELFLAG = '0'
			AND TSV.GLBL_CMPY_CD  = DORR.GLBL_CMPY_CD
			AND TSV.ORG_CD        = DORR.ORG_CD
			AND TSV.EZCANCELFLAG  = '0'
		-->
	    <!-- QC#53909 Mod End-->
	</statement>

	<statement id="queryORD_CATG_BIZ_CTX" parameterClass="Map" resultClass="Integer">
		SELECT
			COUNT(*)
		FROM
			ORD_CATG_BIZ_CTX OCBC
		WHERE
			    OCBC.GLBL_CMPY_CD       = #glblCmpyCd#
			AND OCBC.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCd#
			AND (  OCBC.DS_ORD_CATG_CD  = #dsOrdCatgCd#
				OR OCBC.DS_ORD_CATG_CD  is null)
			AND (  OCBC.DS_ORD_TP_CD    = #dsOrdTpCd#
				OR OCBC.DS_ORD_TP_CD    is null)
			AND (  OCBC.DS_ORD_RSN_CD   = #dsOrdRsnCd#
				OR OCBC.DS_ORD_RSN_CD   is null)
			AND OCBC.EZCANCELFLAG       = '0'
			AND EXISTS (
					SELECT *
					FROM
						SPLY_PGM_CONTR SPC
					WHERE
							SPC.GLBL_CMPY_CD     = #glblCmpyCd#
						AND SPC.BILL_TO_CUST_ACCT_CD = #billToCustAcctCd#
						AND (SPC.BILL_TO_CUST_LOC_CD = #billToCustLocCd#
							OR
							SPC.BILL_TO_CUST_LOC_CD is null)
						AND	SPC.EFF_FROM_DT &lt;= #invDt#
						AND NVL(SPC.EFF_THRU_DT,'99991231') &gt;= #invDt#
				)
	</statement>

	<statement id="querySHIP_SER_NUM" parameterClass="Map" resultClass="String">
		SELECT
			SSN.SER_NUM
		FROM
			SHIP_SER_NUM SSN
		WHERE
				SSN.GLBL_CMPY_CD = #glblCmpyCd#
			AND SSN.MDSE_CD      = #mdseCd#
			AND SSN.SO_NUM       = #soNum#
			AND SSN.SO_SLP_NUM   = #soSlpNum#
			AND SSN.EZCANCELFLAG = '0'
	</statement>
	
	<statement id="queryPO_SER_NUM" parameterClass="Map" resultClass="String">
		SELECT
			PSN.SER_NUM
		FROM
			PO_SER_NUM PSN
		WHERE
				PSN.GLBL_CMPY_CD   = #glblCmpyCd#
			AND PSN.KEY_INFO_CD_01 = #keyInfoCd01#
			AND PSN.KEY_INFO_CD_02 = #keyInfoCd02#
			AND PSN.KEY_INFO_CD_03 = #keyInfoCd03#
			AND PSN.EZCANCELFLAG   = '0'
	</statement>
	
	<statement id="queryDS_INV_LINE_SER_NUM" parameterClass="Map" resultClass="BigDecimal">
		SELECT
			DS_INV_LINE_SER_NUM_PK
		FROM
			DS_INV_LINE_SER_NUM A
		WHERE
				A.GLBL_CMPY_CD         = #glblCmpyCd#
			AND A.INV_NUM              = #invNum#
			AND A.INV_BOL_LINE_NUM     = #invBolLineNum#
			AND A.INV_LINE_NUM         = #invLineNum#
			AND A.INV_TRX_LINE_SUB_NUM = #invTrxLineSubNum#
			AND A.MDSE_CD              = #mdseCd#
			AND A.SER_NUM              = #serNum#
			AND A.EZCANCELFLAG = '0'
	</statement>
	
	<statement id="queryDS_INV_LINE_TAX_DTL" parameterClass="Map" resultClass="BigDecimal">
		SELECT
			DS_INV_LINE_TAX_DTL_PK
		FROM
			DS_INV_LINE_TAX_DTL A
		WHERE
				A.GLBL_CMPY_CD         = #glblCmpyCd#
			AND A.INV_NUM              = #invNum#
			AND A.INV_BOL_LINE_NUM     = #invBolLineNum#
			AND A.INV_LINE_NUM         = #invLineNum#
			AND A.INV_LINE_SUB_NUM     = #invLineSubNum#
			AND A.INV_TRX_LINE_SUB_NUM = #invTrxLineSubNum#
			AND A.DS_SLS_TAX_TP_CD     = #dsSlsTaxTpCd#
			AND A.EZCANCELFLAG = '0'
	</statement>
<!-- QC#24705 add Start -->
    <statement id="queryDS_INV_LINE_TAX_DTL_forUpdate" parameterClass="Map" resultClass="Map">
        SELECT
            DS_INV_LINE_TAX_DTL_PK
            ,FUNC_SLS_TAX_AMT
            ,DEAL_SLS_TAX_AMT
        FROM
            DS_INV_LINE_TAX_DTL A
        WHERE
                A.GLBL_CMPY_CD         = #glblCmpyCd#
            AND A.INV_NUM              = #invNum#
            AND A.EZCANCELFLAG = '0'
    </statement>
<!-- QC#24705 add End -->
	
	<statement id="getTaxGrpExemCdFromBillToCust" parameterClass="Map" resultClass="String">
		SELECT
			BT.DS_TAX_GRP_EXEM_CD
		FROM
			 BILL_TO_CUST BT
		WHERE
				BT.GLBL_CMPY_CD     = #glblCmpyCd#
			AND BT.BILL_TO_CUST_CD  = #billToCustCd#
			AND BT.EZCANCELFLAG     = '0'
	</statement>
			
	<statement id="getTaxGrpExemCdFromDsAcctCust" parameterClass="Map" resultClass="String">
		SELECT
			DAC.DS_TAX_GRP_EXEM_CD
		FROM
			SELL_TO_CUST DAC
		WHERE
			    DAC.GLBL_CMPY_CD = #glblCmpyCd#
			AND DAC.SELL_TO_CUST_CD  = #acctNum#
			AND DAC.EZCANCELFLAG = '0'
	</statement>

	<statement id="getTaxGrpExemCdFromShipToCust" parameterClass="Map" resultClass="String">
		SELECT
			ST.DS_TAX_GRP_EXEM_CD
		FROM
			SHIP_TO_CUST ST
		WHERE
				ST.GLBL_CMPY_CD     = #glblCmpyCd#
			AND ST.SHIP_TO_CUST_CD  = #shipToCustCd#
			AND ST.EZCANCELFLAG     = '0'
	</statement>

	<statement id="querySHIP_TO_CUST" parameterClass="Map" resultClass="Map">
		SELECT
			 ST.CNTY_PK
			,ST.GEO_CD
			,ST.DS_INSD_CTY_LIMIT_FLG
		FROM
			 SHIP_TO_CUST ST
		WHERE
				ST.GLBL_CMPY_CD     = #glblCmpyCd#
			AND ST.SHIP_TO_CUST_CD  = #shipToCustCd#
			AND ST.EZCANCELFLAG     = '0'
	</statement>

	<statement id="queryDS_INVTY_LOC_V" parameterClass="Map" resultMap="result.queryDS_INVTY_LOC_V">
		SELECT
			 A.FIRST_LINE_ADDR
			,A.SCD_LINE_ADDR
			,A.CTY_ADDR
			,A.CNTY_PK
			,A.ST_CD
			,A.POST_CD
			,A.CTRY_CD
			,A.GEO_CD
			,A.RTL_WH_CD
		FROM
			 DS_INVTY_LOC_V A
		WHERE
				A.GLBL_CMPY_CD = #glblCmpyCd#
			AND A.INVTY_LOC_CD = #invtyLocCd#
			AND A.EZCANCELFLAG = '0'
	</statement>
	<resultMap id="result.queryDS_INVTY_LOC_V" class="DS_INVTY_LOC_VTMsg">
		<result property="firstLineAddr"	column="FIRST_LINE_ADDR"	javaType="EZDTStringItem"/>
		<result property="scdLineAddr"		column="SCD_LINE_ADDR"		javaType="EZDTStringItem"/>
		<result property="ctyAddr"			column="CTY_ADDR"			javaType="EZDTStringItem"/>
		<result property="cntyPk"			column="CNTY_PK"			javaType="EZDTBigDecimalItem"/>
		<result property="stCd"				column="ST_CD"				javaType="EZDTStringItem"/>
		<result property="postCd"			column="POST_CD"			javaType="EZDTStringItem"/>
		<result property="ctryCd"			column="CTRY_CD"			javaType="EZDTStringItem"/>
		<result property="geoCd"			column="GEO_CD"		    	javaType="EZDTStringItem"/>
		<result property="rtlWhCd"			column="RTL_WH_CD"			javaType="EZDTStringItem"/>
	</resultMap>

    <statement id="getRtlWh" parameterClass="Map" resultClass="String">
        SELECT DISTINCT
             NVL(SWH.RTL_WH_CD, #invtyLocCd#)
        FROM
             RTL_SWH SWH
        WHERE
                SWH.GLBL_CMPY_CD = #glblCmpyCd#
            AND SWH.INVTY_LOC_CD = #invtyLocCd#
            AND SWH.EZCANCELFLAG = '0'
    </statement>

	<statement id="getSalesRepAdress" parameterClass="Map" resultMap="result.getSalesRepAdress">
		SELECT
			 SP.FIRST_LINE_ADDR
			,SP.SCD_LINE_ADDR
			,SP.THIRD_LINE_ADDR
			,SP.FRTH_LINE_ADDR
			,SP.CTY_ADDR
			,SP.CNTY_PK
			,SP.PROV_NM
			,SP.ST_CD
			,SP.POST_CD
			,SP.CTRY_CD
            ,SP.GEO_CD
            ,SP.DS_INSD_CTY_LIMIT_FLG
		FROM
			 ORG_FUNC_ASG OFA
			,S21_PSN SP
		WHERE
			    OFA.GLBL_CMPY_CD  = #glblCmpyCd#
			AND OFA.TOC_CD        = #tocCd#
			AND OFA.EZCANCELFLAG  = '0'
			AND SP.GLBL_CMPY_CD   = OFA.GLBL_CMPY_CD
			AND SP.PSN_CD         = OFA.PSN_CD
			AND SP.EZCANCELFLAG   = '0'
	</statement>
	<resultMap id="result.getSalesRepAdress" class="S21_PSNTMsg">
		<result property="firstLineAddr"	column="FIRST_LINE_ADDR"	javaType="EZDTStringItem"/>
		<result property="scdLineAddr"		column="SCD_LINE_ADDR"		javaType="EZDTStringItem"/>
		<result property="thirdLineAddr"	column="THIRD_LINE_ADDR"	javaType="EZDTStringItem"/>
		<result property="frthLineAddr"		column="FRTH_LINE_ADDR"		javaType="EZDTStringItem"/>
		<result property="ctyAddr"			column="CTY_ADDR"			javaType="EZDTStringItem"/>
		<result property="cntyPk"			column="CNTY_PK"			javaType="EZDTBigDecimalItem"/>
		<result property="provNm"			column="PROV_NM"			javaType="EZDTStringItem"/>
		<result property="stCd"				column="ST_CD"				javaType="EZDTStringItem"/>
		<result property="postCd"			column="POST_CD"			javaType="EZDTStringItem"/>
		<result property="ctryCd"			column="CTRY_CD"			javaType="EZDTStringItem"/>
		<result property="geoCd"			column="GEO_CD"			javaType="EZDTStringItem"/>
		<result property="dsInsdCtyLimitFlg"	column="DS_INSD_CTY_LIMIT_FLG"	javaType="EZDTStringItem"/>
	</resultMap>

<!-- QC#9192 add Start -->
    <statement id="getTaxAreaId" parameterClass="Map" resultClass="Map">
        SELECT
            TA.TAX_AREA_ID
        FROM
            TAX_AREA TA
        WHERE 
            TA.GLBL_CMPY_CD = #glblCmpyCd#
        <isNotNull property="ctyAddr">
        AND TA.CTY_ADDR     = #ctyAddr#
        </isNotNull>
        <isNull property="ctyAddr">
        AND TA.CTY_ADDR    IS NULL
        </isNull>
        <isNotNull property="cntyPk">
        AND TA.CNTY_PK      = #cntyPk#
        </isNotNull>
        <isNull property="cntyPk">
        AND TA.CNTY_PK     IS NULL
        </isNull>
        AND TA.ST_CD        = #stCd#
        AND TA.EZCANCELFLAG = '0'
        AND ROWNUM          = 1
    </statement>
<!-- QC#9192 add End -->
<!-- QC#6604 add Start -->
    <statement id="getRoundingAdjustAmount" parameterClass="Map" resultClass="Map">
        SELECT
             OPCB.PRC_DTL_GRP_CD
            ,OPCB.CALC_PRC_AMT_RATE
        FROM
            ORD_PRC_CALC_BASE   OPCB
        WHERE
            OPCB.GLBL_CMPY_CD           = #glblCmpyCd#
        AND OPCB.CPO_ORD_NUM            = #cpoOrdNum#
        AND OPCB.CPO_DTL_LINE_NUM       = #cpoDtlLineNum#
        AND OPCB.CPO_DTL_LINE_SUB_NUM   = #cpoDtlLineSubNum#
        AND OPCB.PRC_DTL_GRP_CD         = 'RND0'
        AND OPCB.EZCANCELFLAG           = '0'
        AND OPCB.PRC_COND_MAN_DEL_FLG   = 'N'
        AND OPCB.PRC_RULE_APPLY_FLG     = 'Y'

        AND NOT EXISTS(
            SELECT
                'X'
            FROM
                SHPG_PLN    SPL
            WHERE
                SPL.GLBL_CMPY_CD        = OPCB.GLBL_CMPY_CD
            AND SPL.SHPG_PLN_NUM       != #shpgPlnNum#
            AND SPL.TRX_HDR_NUM         = OPCB.CPO_ORD_NUM
            AND SPL.TRX_LINE_NUM        = OPCB.CPO_DTL_LINE_NUM
            AND SPL.TRX_LINE_SUB_NUM    = OPCB.CPO_DTL_LINE_SUB_NUM
            AND SPL.REV_RECOG_FLG       = 'N'
            AND SPL.SHPG_STS_CD         NOT IN ('90', '99')
            AND SPL.EZCANCELFLAG        = '0'
        )
    </statement>
<!-- QC#6604 add End -->
<!-- QC#12892 add Start -->
    <statement id="getOriginalInvtyLocCd" parameterClass="Map" resultClass="Map">
        SELECT
             SP.SO_NUM
            ,IB.SHIP_FROM_INVTY_LOC_CD

            ,I.CPO_ORD_NUM
            ,IL.CPO_DTL_LINE_NUM
            ,IL.CPO_DTL_LINE_SUB_NUM
            
        FROM
             CPO        C
            ,CPO_DTL    CD
            ,SHPG_PLN   SP
            ,INV_LINE   IL
            ,INV_BOL    IB
            ,INV        I
        WHERE
              C.GLBL_CMPY_CD           = #glblCmpyCd#
          AND C.CPO_ORD_NUM            = #cpoOrdNum#
          AND C.EZCANCELFLAG           = '0'

          AND C.GLBL_CMPY_CD           = CD.GLBL_CMPY_CD
          AND C.CPO_ORD_NUM            = CD.CPO_ORD_NUM 
          AND CD.CPO_DTL_LINE_NUM       = #cpoDtlLineNum#
          AND CD.CPO_DTL_LINE_SUB_NUM   = #cpoDtlLineSubNum#
          AND CD.EZCANCELFLAG           = '0'

          AND C.GLBL_CMPY_CD              = SP.GLBL_CMPY_CD
          AND C.ORD_SRC_REF_NUM           = SP.TRX_HDR_NUM
          AND CD.ORD_SRC_REF_LINE_NUM      = SP.TRX_LINE_NUM
          AND CD.ORD_SRC_REF_LINE_SUB_NUM  = SP.TRX_LINE_SUB_NUM
          AND CD.ORIG_INV_NUM              = SP.INV_NUM
          AND SP.EZCANCELFLAG              = '0'

          AND SP.GLBL_CMPY_CD           = IL.GLBL_CMPY_CD
          AND SP.SHPG_PLN_NUM           = IL.SHPG_PLN_NUM
          AND IL.EZCANCELFLAG           = '0'

          AND IL.GLBL_CMPY_CD           = IB.GLBL_CMPY_CD
          AND IL.INV_NUM                = IB.INV_NUM
          AND IL.INV_BOL_LINE_NUM       = IB.INV_BOL_LINE_NUM
          AND IB.EZCANCELFLAG           = '0'

          AND IB.GLBL_CMPY_CD           = I.GLBL_CMPY_CD
          AND IB.INV_NUM                = I.INV_NUM
          AND I.EZCANCELFLAG            = '0'
    </statement>
<!-- QC#12892 add End -->
<!-- QC#15624 add Start -->
    <statement id="getBillOnlyLineCatgCd" parameterClass="Map" resultClass="String">
        SELECT
             OLVS.DS_ORD_LINE_CATG_CD
        FROM
             ORD_LINE_VAL_SET    OLVS
        WHERE
                OLVS.GLBL_CMPY_CD           = #glblCmpyCd#
            AND OLVS.ORD_LINE_CTX_TP_CD     = #ordLineCtxTpCdBillOnly#
            AND OLVS.EZCANCELFLAG           = '0'
    </statement>
<!-- QC#15624 add End -->
<!-- QC#21841 add Start -->
    <statement id="getCalcBaseForCharges" parameterClass="Map" resultClass="Map">
        SELECT
             OPCB.PRC_DTL_GRP_CD
            ,(OPCB.UNIT_PRC_AMT * SP.ORD_QTY) + NVL(OPCB2.CALC_PRC_AMT_RATE, 0) AS CALC_PRC_AMT_RATE
            ,OPCB.UNIT_PRC_AMT
            ,PDG.CHRG_MDSE_CD
        FROM
             SHPG_PLN            SP
            ,ORD_PRC_CALC_BASE   OPCB
            ,PRC_DTL_GRP         PDG
            ,(
                SELECT
                      SP2.GLBL_CMPY_CD
                     ,SP2.SHPG_PLN_NUM
                     ,OPCB2.CALC_PRC_AMT_RATE
                     ,SP2.EZCANCELFLAG
                     ,OPCB2.SPEC_COND_PRC_PK
                FROM
                    SHPG_PLN            SP2
                   ,ORD_PRC_CALC_BASE   OPCB2
                 WHERE
                     SP2.GLBL_CMPY_CD             = #glblCmpyCd#
                 AND SP2.EZCANCELFLAG             = '0'
                 AND SP2.SHPG_PLN_NUM             = #shpgPlnNum#
                 AND OPCB2.GLBL_CMPY_CD           = SP2.GLBL_CMPY_CD 
                 AND OPCB2.EZCANCELFLAG           = SP2.EZCANCELFLAG
                 AND OPCB2.CPO_ORD_NUM            = SP2.TRX_HDR_NUM
                 AND OPCB2.CPO_DTL_LINE_NUM       = SP2.TRX_LINE_NUM
                 AND OPCB2.CPO_DTL_LINE_SUB_NUM   = SP2.TRX_LINE_SUB_NUM
                 AND OPCB2.PRC_DTL_GRP_CD         IN
                     <iterate property="prcDtlGrpCdRnd" var="prcDtlGrpCd[]" open="(" close=")" conjunction=",">
                         #prcDtlGrpCd[]#
                     </iterate>
                 AND NOT EXISTS(
                     SELECT
                         'X'
                     FROM
                         SHPG_PLN    SPL
                     WHERE
                         SPL.GLBL_CMPY_CD        = OPCB2.GLBL_CMPY_CD
                     AND SPL.SHPG_PLN_NUM       != #shpgPlnNum#
                     AND SPL.TRX_HDR_NUM         = OPCB2.CPO_ORD_NUM
                     AND SPL.TRX_LINE_NUM        = OPCB2.CPO_DTL_LINE_NUM
                     AND SPL.TRX_LINE_SUB_NUM    = OPCB2.CPO_DTL_LINE_SUB_NUM
                     AND SPL.REV_RECOG_FLG       = 'N'
                     AND SPL.SHPG_STS_CD         NOT IN ('90', '99')
                     AND SPL.EZCANCELFLAG        = '0'
                 )
            ) OPCB2
        WHERE
            SP.GLBL_CMPY_CD             = #glblCmpyCd#
        AND SP.EZCANCELFLAG             = '0'
        AND SP.SHPG_PLN_NUM             = #shpgPlnNum#
        AND SP.GLBL_CMPY_CD             = OPCB.GLBL_CMPY_CD
        AND SP.EZCANCELFLAG             = OPCB.EZCANCELFLAG
        AND SP.TRX_HDR_NUM              = OPCB.CPO_ORD_NUM
        AND SP.TRX_LINE_NUM             = OPCB.CPO_DTL_LINE_NUM
        AND SP.TRX_LINE_SUB_NUM         = OPCB.CPO_DTL_LINE_SUB_NUM
        AND OPCB.PRC_DTL_GRP_CD         IN
             <iterate property="prcDtlGrpCdList" var="prcDtlGrpCd[]" open="(" close=")" conjunction=",">
                 #prcDtlGrpCd[]#
             </iterate>
        AND OPCB.PRC_COND_MAN_DEL_FLG   = #delFlg#
        AND OPCB.PRC_RULE_APPLY_FLG     = #applyFlg#
        AND OPCB.GLBL_CMPY_CD           = PDG.GLBL_CMPY_CD
        AND OPCB.EZCANCELFLAG           = PDG.EZCANCELFLAG
        AND OPCB.PRC_DTL_GRP_CD         = PDG.PRC_DTL_GRP_CD
        AND SP.GLBL_CMPY_CD             = OPCB2.GLBL_CMPY_CD(+)
        AND SP.EZCANCELFLAG             = OPCB2.EZCANCELFLAG(+)
        AND SP.SHPG_PLN_NUM             = OPCB2.SHPG_PLN_NUM(+)
        AND OPCB.SPEC_COND_PRC_PK       = OPCB2.SPEC_COND_PRC_PK(+)
        ORDER BY OPCB.ORD_PRC_CALC_BASE_PK
    </statement>
<!-- QC#21841 add End -->

<!-- QC#27954 add Start -->
    <statement id="getOrdCatgBizCtx" parameterClass="Map" resultClass="Map">
        SELECT
             OCBC.ORD_CATG_CTX_TP_CD        AS ORD_CATG_CTX_TP_CD
           , OCBC.DS_ORD_CATG_CD            AS DS_ORD_CATG_CD
           , OCBC.DS_ORD_TP_CD              AS DS_ORD_TP_CD
           , OCBC.DS_ORD_RSN_CD             AS DS_ORD_RSN_CD
           , OCBC.FIRST_BIZ_CTX_ATTRB_TXT   AS FIRST_BIZ_CTX_ATTRB_TXT
        FROM
             ORD_CATG_BIZ_CTX    OCBC
        WHERE
                OCBC.GLBL_CMPY_CD           = #glblCmpyCd#
            AND OCBC.ORD_CATG_CTX_TP_CD     = #OrdCatgCtxTpCd#
            AND OCBC.DS_ORD_CATG_CD         = #dsOrdCatgCd#
            AND OCBC.EZCANCELFLAG           = '0'
        ORDER BY OCBC.DS_ORD_TP_CD NULLS LAST
               , OCBC.DS_ORD_RSN_CD NULLS LAST
    </statement>
<!-- QC#27954 add End -->
<!-- QC#50780 Add Start -->
    <statement id="getDsContrDtlPK" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            DCD.DS_CONTR_DTL_PK
        FROM
            DS_CONTR_DTL DCD
            ,DS_CONTR DC
            ,CPO C
            ,CPO_DTL CD
            ,SVC_MACH_MSTR SMM
        WHERE
                DCD.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCD.EZCANCELFLAG = '0'
            AND DCD.BILL_WITH_EQUIP_FLG = #billWithEquipFlg#
        
            AND C.GLBL_CMPY_CD = DCD.GLBL_CMPY_CD
            AND C.EZCANCELFLAG = DCD.EZCANCELFLAG
            AND C.CPO_ORD_NUM = #cpoOrdNum#
            AND C.ORD_SRC_REF_NUM = DCD.CPO_ORD_NUM
        
            AND C.GLBL_CMPY_CD = CD.GLBL_CMPY_CD
            AND C.EZCANCELFLAG = CD.EZCANCELFLAG
            AND C.CPO_ORD_NUM = CD.CPO_ORD_NUM
            AND CD.CPO_DTL_LINE_NUM = #cpoDtlLineNum#
            AND CD.CPO_DTL_LINE_SUB_NUM = #cpoDtlLineSubNum#
            AND CD.MDSE_CD = DCD.SVC_PGM_MDSE_CD
        
            AND CD.GLBL_CMPY_CD = DC.GLBL_CMPY_CD
            AND CD.EZCANCELFLAG = DC.EZCANCELFLAG
            AND CD.DS_CONTR_NUM = DC.DS_CONTR_NUM
        
            AND DC.DS_CONTR_PK = DCD.DS_CONTR_PK
        
            AND CD.GLBL_CMPY_CD = SMM.GLBL_CMPY_CD
            AND CD.EZCANCELFLAG = SMM.EZCANCELFLAG
            AND CD.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK
        
            AND SMM.CPO_DTL_LINE_NUM = DCD.CPO_DTL_LINE_NUM
            AND SMM.CPO_DTL_LINE_SUB_NUM = DCD.CPO_DTL_LINE_SUB_NUM
            AND SMM.SVC_MACH_MSTR_PK = DCD.SVC_MACH_MSTR_PK
        
        ORDER BY
            DCD.DS_CONTR_CRAT_TP_CD
    </statement>
<!-- QC#50780 Add End -->

<!-- CSA ADD END -->
</sqlMap>
