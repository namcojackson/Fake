<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NFAB015001">

<!-- #################### Type Alias #################### -->

<!-- #################### Statement #################### -->

   	<statement id="getIntfcTrxPtrn" parameterClass="Map" resultClass="Map">
        SELECT AARI.SYS_SRC_CD AS SYS_SRC_CD,
               AARI.TRX_CD     AS TRX_CD,
               AARI.TRX_RSN_CD AS TRX_RSN_CD
          FROM AJE_AR_RECLS_INTFC AARI
         WHERE AARI.EZCANCELFLAG    = '0'
           AND AARI.GLBL_CMPY_CD    = #glblCmpyCd#
           AND AARI.PROC_DT         = #procDt#
           AND AARI.AR_TRX_NUM      = '*'
           AND NOT EXISTS (
                           SELECT 1
                             FROM AJE_INTFC_CTRL      AIC
                            WHERE AIC.EZCANCELFLAG    = '0'
                              AND AIC.GLBL_CMPY_CD    = #glblCmpyCd#
                              AND AIC.AJE_INTFC_TP_CD = #ajeIntfcTpCd#
                              AND AIC.JRNL_CPLT_FLG   = #jrnlCpltFlg#
                              AND AIC.GLBL_CMPY_CD    = AARI.GLBL_CMPY_CD
                              AND AIC.AJE_INTFC_PK    = AARI.AJE_AR_RECLS_INTFC_PK
                          )
         GROUP BY  AARI.SYS_SRC_CD
                  ,AARI.TRX_CD
                  ,AARI.TRX_RSN_CD
         ORDER BY  AARI.TRX_CD
                  ,AARI.TRX_RSN_CD
                  ,AARI.SYS_SRC_CD
    </statement>

    <statement id="getAjeArReclsIntfcNotJrnlized" parameterClass="Map" resultClass="Map">
        SELECT
                AARI.GLBL_CMPY_CD                   AS GLBL_CMPY_CD
               ,AARI.AJE_AR_RECLS_INTFC_PK          AS AJE_AR_RECLS_INTFC_PK
               ,AARI.PROC_DT                        AS PROC_DT
               ,AARI.GL_DT                          AS GL_DT
               ,AARI.SYS_SRC_CD                     AS SYS_SRC_CD
               ,SS.SYS_SRC_NM                       AS SYS_SRC_NM
               ,AARI.TRX_CD                         AS TRX_CD
               ,TRX.TRX_NM                          AS TRX_NM
               ,AARI.TRX_RSN_CD                     AS TRX_RSN_CD
               ,TRX_RSN.TRX_RSN_NM                  AS TRX_RSN_NM

               ,CCY.ACCT_ARTH_TP_CD                 AS ACCT_ARTH_TP_CD
               ,CCY.ORCL_CCY_CD                     AS ORCL_CCY_CD
               ,AARI.DEAL_RMNG_BAL_GRS_AMT          AS DEAL_RECLS_AMT
               ,AARI.DEAL_CCY_CD                    AS DEAL_CCY_CD
               ,AARI.FUNC_RMNG_BAL_GRS_AMT          AS FUNC_RECLS_AMT
               ,AARI.FUNC_CCY_CD                    AS FUNC_CCY_CD

               ,AARI.COA_ACCT_CD                    AS COA_ACCT_CD
               ,AARI.COA_AFFL_CD                    AS COA_AFFL_CD

               -- AT CUST-ACCT
               , AARI.COA_BR_CD                     AS "CUST-ACCT_BR_CD"
               , AARI.COA_CC_CD                     AS "CUST-ACCT_CC_CD"
               , AARI.COA_ACCT_CD                   AS "CUST-ACCT_ACCT_CD"
               , AARI.COA_PROD_CD                   AS "CUST-ACCT_PROD_CD"
               , AARI.COA_CH_CD                     AS "CUST-ACCT_CH_CD"
               , AARI.COA_AFFL_CD                   AS "CUST-ACCT_AFFL_CD"
               , AARI.COA_PROJ_CD                   AS "CUST-ACCT_PROJ_CD"
               , AARI.COA_EXTN_CD                   AS "CUST-ACCT_EXTN_CD"

               -- AT LINK
               , AARI.COA_BR_CD                     AS "LINK_BR_CD"
               , AARI.COA_CC_CD                     AS "LINK_CC_CD"
               , AARI.COA_ACCT_CD                   AS "LINK_ACCT_CD"
               , AARI.COA_PROD_CD                   AS "LINK_PROD_CD"
               , AARI.COA_CH_CD                     AS "LINK_CH_CD"
               , AARI.COA_AFFL_CD                   AS "LINK_AFFL_CD"
               , AARI.COA_PROJ_CD                   AS "LINK_PROJ_CD"
               , AARI.COA_EXTN_CD                   AS "LINK_EXTN_CD"

          FROM  AJE_AR_RECLS_INTFC      AARI
               ,SYS_SRC                 SS
               ,TRX                     TRX
               ,TRX_RSN                 TRX_RSN
               ,CCY                     CCY
         WHERE 
               AARI.GLBL_CMPY_CD        = #glblCmpyCd#
           AND AARI.PROC_DT             = #procDt#
           AND AARI.EZCANCELFLAG        = '0'

           AND AARI.GLBL_CMPY_CD        = SS.GLBL_CMPY_CD
           AND AARI.SYS_SRC_CD          = SS.SYS_SRC_CD
           AND SS.EZCANCELFLAG          = '0'

           AND AARI.GLBL_CMPY_CD        = TRX.GLBL_CMPY_CD
           AND AARI.TRX_CD              = TRX.TRX_CD
           AND TRX.EZCANCELFLAG         = '0'

           AND AARI.GLBL_CMPY_CD        = TRX_RSN.GLBL_CMPY_CD
           AND AARI.TRX_CD              = TRX_RSN.TRX_CD
           AND AARI.TRX_RSN_CD          = TRX_RSN.TRX_RSN_CD
           AND TRX_RSN.EZCANCELFLAG     = '0'

           AND AARI.GLBL_CMPY_CD        = CCY.GLBL_CMPY_CD
           AND AARI.DEAL_CCY_CD         = CCY.CCY_CD
           AND CCY.EZCANCELFLAG         = '0'

           AND NOT EXISTS (
                    SELECT
                            1
                      FROM
                            AJE_INTFC_CTRL      AIC
                     WHERE
                            AIC.EZCANCELFLAG    = '0'
                        AND AIC.GLBL_CMPY_CD    = #glblCmpyCd#
                        AND AIC.AJE_INTFC_TP_CD = #ajeIntfcTpCd#
                        AND AIC.JRNL_CPLT_FLG   = #jrnlCpltFlg#
                        AND AIC.GLBL_CMPY_CD    = AARI.GLBL_CMPY_CD
                        AND AIC.AJE_INTFC_PK    = AARI.AJE_AR_RECLS_INTFC_PK
           )
         ORDER BY
            AARI.AJE_AR_RECLS_INTFC_PK
    </statement>

</sqlMap>
