<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NWZC045001">

	<!-- ==== Type Aliases ==== -->
	<typeAlias 	alias="MdseStructureData" 	type="com.canon.cusa.s21.api.NWZ.NWZC045001.MdseStructureData"/>
	<typeAlias 	alias="CustomerData" 		type="com.canon.cusa.s21.api.NWZ.NWZC045001.CustomerData"/>

	<!-- ==== Result Mapping ==== -->
	<resultMap 	id="result.MdseStructureData" 		class="MdseStructureData">
		<result property="zerothProdCtrlCd"			column="ZEROTH_PROD_CTRL_CD" 	javaType="String"/>
		<result property="firstProdCtrlCd" 	 		column="FIRST_PROD_CTRL_CD" 	javaType="String"/>
		<result property="scdProdCtrlCd"  			column="SCD_PROD_CTRL_CD" 		javaType="String"/>
	</resultMap>
	
	<resultMap 	id="result.CustomerData" 			class="CustomerData">
		<result property="billToCustCd"				column="BILL_TO_CUST_CD" 		javaType="String"/>
		<result property="sellToCustCd" 	 		column="SELL_TO_CUST_CD" 		javaType="String"/>
	</resultMap>
	
	<!-- ==== Statement ==== -->
	<statement id="getMdseStructureData" parameterClass="Map" resultMap="result.MdseStructureData">
		SELECT DISTINCT
				ZEROTH_PROD_CTRL_CD
				<isNotNull property="firstProdCtrlCd">
			   ,FIRST_PROD_CTRL_CD
			   </isNotNull>
			   <isNotNull property="scdProdCtrlCd">
			   ,FIRST_PROD_CTRL_CD
			   ,SCD_PROD_CTRL_CD
			   </isNotNull>
		FROM
   			 	MDSE_STRU
		WHERE
				GLBL_CMPY_CD 		= #glblCmpyCd#
			AND MDSE_STRU_TP_CD		= #mdseStruTp#
			<isNotNull property="zerothProdCtrlCd">
			AND	ZEROTH_PROD_CTRL_CD	= #zerothProdCtrlCd#
			</isNotNull>
			<isNotNull property="firstProdCtrlCd">
			AND	FIRST_PROD_CTRL_CD 	= #firstProdCtrlCd#
			</isNotNull>
			<isNotNull property="scdProdCtrlCd">
			AND	SCD_PROD_CTRL_CD 	= #scdProdCtrlCd#
			</isNotNull>
			AND EZCANCELFLAG 		= '0'
	</statement>

	<statement id="getCustomerDataByShipToCustCd" parameterClass="Map" resultMap="result.CustomerData">
		SELECT
				BILL_TO_CUST_CD
			   ,SELL_TO_CUST_CD
		FROM
				SHIP_TO_CUST 
		WHERE
			    GLBL_CMPY_CD    = #glblCmpyCd#
			AND SHIP_TO_CUST_CD = #shipToCustCd#
			AND RGTN_STS_CD  	= #rgtnStsCd#
			AND EZCANCELFLAG    = '0'
	</statement>
	
	<statement id="getCustomerDataBySellToCustCd" parameterClass="Map" resultMap="result.CustomerData">
		SELECT
			 	BILL_TO_CUST_CD
			   ,SELL_TO_CUST_CD
		FROM
			SELL_TO_CUST 
		WHERE
			    GLBL_CMPY_CD    = #glblCmpyCd#
			AND SELL_TO_CUST_CD = #sellToCustCd#
			AND RGTN_STS_CD  	= #rgtnStsCd#
			AND EZCANCELFLAG    = '0'
	</statement>
	
	<statement id="getCustomerDataByBillToCustCd" parameterClass="Map" resultMap="result.CustomerData">
		SELECT
			 	BILL_TO_CUST_CD
		FROM
				BILL_TO_CUST 
		WHERE
			    GLBL_CMPY_CD    = #glblCmpyCd#
			AND BILL_TO_CUST_CD = #billToCustCd#
			AND RGTN_STS_CD  	= #rgtnStsCd#
			AND EZCANCELFLAG    = '0'
	</statement>
	
	<statement id="getCustomerPaymentTermData" 	parameterClass="Map" resultClass="Map">
		SELECT 
				PMT_TERM_CD
			   ,CASH_DISC_TERM_CD
			   ,PMT_TERM_CASH_DISC_CD
		FROM
				CUST_PMT_TERM
		WHERE
				GLBL_CMPY_CD = #glblCmpyCd#
			<isNotNull property="AND0">
			AND 
			(
			</isNotNull>
				<isNotNull property="zerothProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 0 AND PROD_CTRL_MDSE_CD = #zerothProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR0">OR</isNotNull>
				<isNotNull property="firstProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 1 AND PROD_CTRL_MDSE_CD = #firstProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR1">OR</isNotNull>
				<isNotNull property="scdProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 2 AND PROD_CTRL_MDSE_CD = #scdProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR2">OR</isNotNull>
				<isNotNull property="thirdProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 3 AND PROD_CTRL_MDSE_CD = #thirdProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR3">OR</isNotNull>
				<isNotNull property="frthProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 4 AND PROD_CTRL_MDSE_CD = #frthProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR4">OR</isNotNull>
				<isNotNull property="fifthProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 5 AND PROD_CTRL_MDSE_CD = #fifthProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR5">OR</isNotNull>
				<isNotNull property="sixthProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 6 AND PROD_CTRL_MDSE_CD = #sixthProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR6">OR</isNotNull>
				<isNotNull property="svnthProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 7 AND PROD_CTRL_MDSE_CD = #svnthProdCtrlCd#)
				</isNotNull>
				<isNotNull property="prodCtrlFlg">OR</isNotNull>
				<isNotNull property="mdseCd">
				(ASG_PROD_CTRL_LAYER_NUM = 99 AND PROD_CTRL_MDSE_CD = #mdseCd#)
				</isNotNull>
			<isNotNull property="AND0">
			)
			</isNotNull>
			<isNotNull property="AND1">
			AND
			(
			</isNotNull>
				<isNotNull property="billToCustCd">
				(ASG_LOC_ROLE_LAYER_NUM = 1 AND CUST_CD = #billToCustCd#)
				</isNotNull>
				<isNotNull property="OR100">OR</isNotNull>
				<isNotNull property="sellToCustCd">
				(ASG_LOC_ROLE_LAYER_NUM = 2 AND CUST_CD = #sellToCustCd#)
				</isNotNull>
			<isNotNull property="AND1">
			)
			</isNotNull>
			AND EZCANCELFLAG = '0'
		ORDER BY
				ASG_LOC_ROLE_LAYER_NUM DESC
			   ,ASG_PROD_CTRL_LAYER_NUM DESC
	</statement>


	<statement id="getCustomerPaymentTermDataByMdse" 	parameterClass="Map" resultClass="Map">
		SELECT 
				PMT_TERM_CD
			   ,CASH_DISC_TERM_CD
			   ,PMT_TERM_CASH_DISC_CD
		FROM
				CUST_PMT_TERM
		WHERE
				GLBL_CMPY_CD = #glblCmpyCd#
			<isNotNull property="AND0">
			AND 
			(
			</isNotNull>
				<isNotNull property="zerothProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 0 AND PROD_CTRL_MDSE_CD = #zerothProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR0">OR</isNotNull>
				<isNotNull property="firstProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 1 AND PROD_CTRL_MDSE_CD = #firstProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR1">OR</isNotNull>
				<isNotNull property="scdProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 2 AND PROD_CTRL_MDSE_CD = #scdProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR2">OR</isNotNull>
				<isNotNull property="thirdProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 3 AND PROD_CTRL_MDSE_CD = #thirdProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR3">OR</isNotNull>
				<isNotNull property="frthProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 4 AND PROD_CTRL_MDSE_CD = #frthProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR4">OR</isNotNull>
				<isNotNull property="fifthProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 5 AND PROD_CTRL_MDSE_CD = #fifthProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR5">OR</isNotNull>
				<isNotNull property="sixthProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 6 AND PROD_CTRL_MDSE_CD = #sixthProdCtrlCd#)
				</isNotNull>
				<isNotNull property="OR6">OR</isNotNull>
				<isNotNull property="svnthProdCtrlCd">
				(ASG_PROD_CTRL_LAYER_NUM = 7 AND PROD_CTRL_MDSE_CD = #svnthProdCtrlCd#)
				</isNotNull>
				<isNotNull property="prodCtrlFlg">OR</isNotNull>
				<isNotNull property="mdseCd">
				(ASG_PROD_CTRL_LAYER_NUM = 99 AND PROD_CTRL_MDSE_CD = #mdseCd#)
				</isNotNull>
			<isNotNull property="AND0">
			)
			</isNotNull>
			AND (ASG_LOC_ROLE_LAYER_NUM = 1 AND CUST_CD = #custCd#)
			AND EZCANCELFLAG = '0'
		ORDER BY
				ASG_LOC_ROLE_LAYER_NUM DESC
			   ,ASG_PROD_CTRL_LAYER_NUM DESC
	</statement>
	
	<statement id="getAltPayerData"	parameterClass="Map" resultClass="Map">
		SELECT
				FL_PLN_CMPY_FLG
		FROM
				ALT_PAYER 
		WHERE
			    GLBL_CMPY_CD    = #glblCmpyCd#
			AND BILL_TO_CUST_CD = #billToCustCd#
			AND SELL_TO_CUST_CD = #sellToCustCd#
			AND EZCANCELFLAG    = '0'
	</statement>	
</sqlMap>
