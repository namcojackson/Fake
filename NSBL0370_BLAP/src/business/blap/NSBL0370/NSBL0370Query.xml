<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSBL0370Query">
    <typeAlias alias="NSBL0370_ASMsg"  type="business.blap.NSBL0370.NSBL0370_ASMsg"/>
    <statement id="getSearchData" parameterClass="Map" resultMap="result.getSearchData">
            SELECT
                 A.TOT_IN_PROC_TASK_CNT         AS TOT_IN_PROC_TASK_CNT
                 ,A.PRT_WAIT_TASK_CNT           AS PRT_WAIT_TASK_CNT
                 ,A.SPCL_WAIT_TASK_CNT          AS SPCL_WAIT_TASK_CNT
                 ,A.OTH_OPEN_TASK_CNT           AS OTH_OPEN_TASK_CNT
                 ,A.CUST_TASK_CNT               AS CUST_TASK_CNT
                 ,A.ESCL_TASK_CNT               AS ESCL_TASK_CNT
                 ,A.CRAT_TASK_CNT               AS CRAT_TASK_CNT
                 ,A.CRAT_TASK_PER_TECH_RATE     AS CRAT_TASK_PER_TECH_RATE
                 ,A.AFT_HOUR_TASK_CNT           AS AFT_HOUR_TASK_CNT
                 ,A.AFT_HOUR_TASK_PER_TECH_RATE AS AFT_HOUR_TASK_PER_TECH_RATE
                 ,A.CLO_TASK_CNT                AS CLO_TASK_CNT
                 ,A.CLO_TASK_PER_TECH_RATE      AS CLO_TASK_PER_TECH_RATE
                 ,A.PRT_FAIL_CNT                AS PRT_FAIL_CNT
                 ,A.POST_ENTRY_TASK_CNT         AS POST_ENTRY_TASK_CNT
                 ,A.AVAL_TECH_CNT               AS AVAL_TECH_CNT
                 ,A.RSP_TM_CUST_TASK_RATE       AS RSP_TM_CUST_TASK_RATE
                 ,A.RSP_TM_ALL_TASK_RATE        AS RSP_TM_ALL_TASK_RATE
                 ,A.ORG_LAYER_NUM               AS ORG_LAYER_NUM
                 ,A.SNAP_SHOT_DT_TM_TS          AS SNAP_SHOT_DT_TM_TS
                 ,CASE
                    WHEN A.ORG_LAYER_NUM = #layerNum1# THEN A.FIRST_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum2# THEN A.SCD_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum3# THEN A.THIRD_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum4# THEN A.FRTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum5# THEN A.FIFTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum6# THEN A.SIXTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum7# THEN A.SVNTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum8# THEN A.EIGHTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum9# THEN A.NINTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum10# THEN A.TENTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum11# THEN A.ELVTH_ORG_CD END AS FIRST_ORG_CD
                 ,CASE
                    WHEN A.ORG_LAYER_NUM = #layerNum1# THEN A.FIRST_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum2# THEN A.SCD_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum3# THEN A.THIRD_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum4# THEN A.FRTH_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum5# THEN A.FIFTH_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum6# THEN A.SIXTH_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum7# THEN A.SVNTH_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum8# THEN A.EIGHTH_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum9# THEN A.NINTH_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum10# THEN A.TENTH_ORG_NM 
                    WHEN A.ORG_LAYER_NUM = #layerNum11# THEN A.ELVTH_ORG_NM END AS ORG_NM
            FROM 
                <isNotNull property="dlyRpt">
                SVC_TASK_DLY_RPT A 
                </isNotNull>
                <isNotNull property="histRpt">
                SVC_TASK_HIST_RPT A
                </isNotNull>
            WHERE
                A.GLBL_CMPY_CD              = #glblCmpyCd#
                AND A.CRAT_DT               = #cratDt#
                AND A.ORG_LAYER_NUM = 
                CASE WHEN FIRST_ORG_CD      = #orgCd# then #layerNum1#
                     WHEN SCD_ORG_CD        = #orgCd# then #layerNum2#
                     WHEN THIRD_ORG_CD      = #orgCd# then #layerNum3#
                     WHEN FRTH_ORG_CD       = #orgCd# then #layerNum4#
                     WHEN FIFTH_ORG_CD      = #orgCd# then #layerNum5#
                     WHEN SIXTH_ORG_CD      = #orgCd# then #layerNum6#
                     WHEN SVNTH_ORG_CD      = #orgCd# then #layerNum7#
                     WHEN EIGHTH_ORG_CD     = #orgCd# then #layerNum8#
                     WHEN NINTH_ORG_CD      = #orgCd# then #layerNum9#
                     WHEN TENTH_ORG_CD      = #orgCd# then #layerNum10#
                     WHEN ELVTH_ORG_CD      = #orgCd# then #layerNum11# END
                <isNotNull property="ltstFlg">
                AND A.SVC_TASK_LTST_FLG     = #ltstFlg#
                </isNotNull>
                AND A.EZCANCELFLAG          = '0'
<!-- START 2017/09/25 M.Naito [QC#21297, ADD] -->
            ORDER BY
                A.SNAP_SHOT_DT_TM_TS
<!-- END 2017/09/25 M.Naito [QC#21297, ADD] -->
    </statement>
    <resultMap id="result.getSearchData"            class="NSBL0370_ASMsg">
        <result property="totInProcTaskCnt_A"       column="TOT_IN_PROC_TASK_CNT"         javaType="EZDSBigDecimalItem" />
        <result property="prtWaitTaskCnt_A"         column="PRT_WAIT_TASK_CNT"            javaType="EZDSBigDecimalItem" />
        <result property="spclWaitTaskCnt_A"        column="SPCL_WAIT_TASK_CNT"           javaType="EZDSBigDecimalItem" />
        <result property="othOpenTaskCnt_A"         column="OTH_OPEN_TASK_CNT"            javaType="EZDSBigDecimalItem" />
        <result property="custTaskCnt_A"            column="CUST_TASK_CNT"                javaType="EZDSBigDecimalItem" />
        <result property="esclTaskCnt_A"            column="ESCL_TASK_CNT"                javaType="EZDSBigDecimalItem" />
        <result property="cratTaskCnt_A"            column="CRAT_TASK_CNT"                javaType="EZDSBigDecimalItem" />
        <result property="cratTaskPerTechRate_A"    column="CRAT_TASK_PER_TECH_RATE"      javaType="EZDSBigDecimalItem" />
        <result property="aftHourTaskCnt_A"         column="AFT_HOUR_TASK_CNT"            javaType="EZDSBigDecimalItem" />
        <result property="aftHourTaskPerTechRate_A" column="AFT_HOUR_TASK_PER_TECH_RATE"  javaType="EZDSBigDecimalItem" />
        <result property="cloTaskCnt_A"             column="CLO_TASK_CNT"                 javaType="EZDSBigDecimalItem" />
        <result property="cloTaskPerTechRate_A"     column="CLO_TASK_PER_TECH_RATE"       javaType="EZDSBigDecimalItem" />
        <result property="prtFailCnt_A"             column="PRT_FAIL_CNT"                 javaType="EZDSBigDecimalItem" />
        <result property="postEntryTaskCnt_A"       column="POST_ENTRY_TASK_CNT"          javaType="EZDSBigDecimalItem" />
        <result property="avalTechCnt_A"            column="AVAL_TECH_CNT"                javaType="EZDSBigDecimalItem" />
        <result property="rspTmCustTaskRate_A"      column="RSP_TM_CUST_TASK_RATE"        javaType="EZDSBigDecimalItem" />
        <result property="rspTmAllTaskRate_A"       column="RSP_TM_ALL_TASK_RATE"         javaType="EZDSBigDecimalItem" />
        <result property="orgLayerNum_A"            column="ORG_LAYER_NUM"                javaType="EZDSBigDecimalItem" />
        <result property="orgCd_A"                  column="FIRST_ORG_CD"                 javaType="EZDSStringItem" />
        <result property="orgDescTxt_A"             column="ORG_NM"                       javaType="EZDSStringItem" />
        <result property="snapShotDtTmTs_A"         column="SNAP_SHOT_DT_TM_TS"           javaType="EZDSStringItem" />
    </resultMap>
</sqlMap>
