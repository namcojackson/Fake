<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NLBL3100Query">

    <typeAlias alias="NLBL3100_ASMsg"      type="business.blap.NLBL3100.NLBL3100_ASMsg"/>

    <statement id="getCoordinatorInfo" parameterClass="Map" resultMap="result.getCoordinatorInfo">
        SELECT
               CASE
                   WHEN SCA_R.RTL_WH_CD IS NOT NULL THEN SCA_R.RTL_WH_CD
                   ELSE SCA.RTL_WH_CD
               END RTL_WH_CD
              ,RW.RTL_WH_NM                                      AS RTL_WH_NM
              ,SCA_R.MGR_PSN_CD                                  AS MGR_PSN_CD
              ,(P_MGR.PSN_FIRST_NM || ' ' || P_MGR.PSN_LAST_NM)  AS MGR_PSN_NM
              ,SCA_R.SUPV_PSN_CD                                 AS SUPV_PSN_CD
              ,(P_SUP.PSN_FIRST_NM || ' ' || P_SUP.PSN_LAST_NM)  AS SUP_PSN_NM
              ,CASE
                   WHEN SCA_R.SCHD_COORD_PSN_CD IS NOT NULL THEN SCA_R.SCHD_COORD_PSN_CD
                   ELSE SCA.SCHD_COORD_PSN_CD
               END SCHD_COORD_PSN_CD
              ,(P_CRD.PSN_FIRST_NM || ' ' || P_CRD.PSN_LAST_NM)  AS CRD_PSN_NM
              ,SCA.ST_CD                                         AS ST_CD
              ,SCA.EFF_FROM_DT                                   AS EFF_FROM_DT
              ,SCA.EFF_THRU_DT                                   AS EFF_THRU_DT
              ,SCA.CARR_CD                                       AS CARR_CD
              ,V.LOC_NM                                          AS LOC_NM
              ,SCA.CARR_CTAC_EML_ADDR                            AS CARR_CTAC_EML_ADDR
              ,SCA.CARR_CTAC_TEL_NUM                             AS CARR_CTAC_TEL_NUM
          FROM
               SCHD_COORD_ASG_RELN SCA_R
              ,SCHD_COORD_ASG SCA
              ,VND V
              ,S21_PSN P_CRD
              ,S21_PSN P_MGR
              ,S21_PSN P_SUP
              ,RTL_WH RW
         WHERE
               SCA_R.GLBL_CMPY_CD       = #cMsg.glblCmpyCd_G1#
           AND SCA_R.EZCANCELFLAG       = '0'
           AND SCA_R.GLBL_CMPY_CD       = SCA.GLBL_CMPY_CD(+)
           AND SCA_R.SCHD_COORD_PSN_CD  = SCA.SCHD_COORD_PSN_CD(+)
           AND SCA_R.RTL_WH_CD          = SCA.RTL_WH_CD(+)
           AND SCA.EZCANCELFLAG(+)      = '0'
           AND SCA.GLBL_CMPY_CD         = V.GLBL_CMPY_CD(+)
           AND SCA.CARR_CD              = V.VND_CD(+)
           AND V.EZCANCELFLAG(+)        = '0'
           AND SCA_R.GLBL_CMPY_CD       = P_MGR.GLBL_CMPY_CD(+)
           AND SCA_R.MGR_PSN_CD         = P_MGR.PSN_CD(+)
           AND P_MGR.EZCANCELFLAG(+)    = '0'
           AND SCA_R.GLBL_CMPY_CD       = P_SUP.GLBL_CMPY_CD(+)
           AND SCA_R.SUPV_PSN_CD        = P_SUP.PSN_CD(+)
           AND P_SUP.EZCANCELFLAG(+)    = '0'
           AND SCA_R.GLBL_CMPY_CD       = P_CRD.GLBL_CMPY_CD(+)
           AND SCA_R.SCHD_COORD_PSN_CD  = P_CRD.PSN_CD(+)
           AND P_CRD.EZCANCELFLAG(+)    = '0'
           AND SCA_R.GLBL_CMPY_CD = RW.GLBL_CMPY_CD(+)
           AND SCA_R.RTL_WH_CD = RW.RTL_WH_CD(+)
           AND RW.EZCANCELFLAG(+) = '0'
               <isNotNull property="cMsg.schdCoordPsnCd_H1">
           AND SCA_R.SCHD_COORD_PSN_CD LIKE #schdCoordPsnCd_Like#
               </isNotNull>
               <isNotNull property="cMsg.rtlWhCd_H1">
           AND SCA_R.RTL_WH_CD LIKE #rtlWhCd_Like#
               </isNotNull>
               <isNotNull property="cMsg.mgrPsnCd_H1">
           AND SCA_R.MGR_PSN_CD(+) LIKE #mgrPsnCd_Like#
               </isNotNull>
               <isNotNull property="cMsg.supvPsnCd_H1">
           AND SCA_R.SUPV_PSN_CD(+) LIKE #supvPsnCd_Like#
               </isNotNull>
               <isNotNull property="cMsg.effFromDt_H1">
           AND #cMsg.effFromDt_H1# BETWEEN SCA.EFF_FROM_DT AND NVL(SCA.EFF_THRU_DT, '99991231')
               </isNotNull>
               <isNotNull property="cMsg.effThruDt_H1">
           AND #cMsg.effThruDt_H1# BETWEEN SCA.EFF_FROM_DT AND NVL(SCA.EFF_THRU_DT, '99991231')
               </isNotNull>
               <isNotNull property="cMsg.stCd_H1">
           AND SCA.ST_CD LIKE #stCd_H1_Like#
               </isNotNull>
               <isNotNull property="cMsg.carrCd_H1">
           AND SCA.CARR_CD LIKE #carrCd_Like#
               </isNotNull>
               <isNotNull property="cMsg.xxPsnNm_H4">
           AND V.LOC_NM LIKE #xxPsnNm_H4_Like#
               </isNotNull>
               <isNotNull property="cMsg.xxPsnNm_H1">
           AND UPPER((P_CRD.PSN_FIRST_NM || ' ' || P_CRD.PSN_LAST_NM)) LIKE UPPER(#xxPsnNm_H1_Like#)
               </isNotNull>
               <isNotNull property="cMsg.xxPsnNm_H2">
           AND UPPER((P_MGR.PSN_FIRST_NM || ' ' || P_MGR.PSN_LAST_NM)) LIKE UPPER(#xxPsnNm_H2_Like#)
               </isNotNull>
               <isNotNull property="cMsg.xxPsnNm_H3">
           AND UPPER((P_SUP.PSN_FIRST_NM || ' ' || P_SUP.PSN_LAST_NM)) LIKE UPPER(#xxPsnNm_H3_Like#)
               </isNotNull>
               <isNotNull property="cMsg.rtlWhNm_H1">
           AND RW.RTL_WH_NM LIKE #rtlWhNm_Like#
               </isNotNull>
         ORDER BY
               SCA_R.RTL_WH_CD
              ,SCA_R.MGR_PSN_CD
              ,SCA_R.SUPV_PSN_CD
              ,SCA_R.SCHD_COORD_PSN_CD
    </statement>

    <resultMap id="result.getCoordinatorInfo" class="NLBL3100_ASMsg">
        <result property="rtlWhCd_A1"           column="RTL_WH_CD"                  javaType="EZDSStringItem"/>
        <result property="rtlWhNm_A1"           column="RTL_WH_NM"                  javaType="EZDSStringItem"/>
        <result property="mgrPsnCd_A1"          column="MGR_PSN_CD"                 javaType="EZDSStringItem"/>
        <result property="xxPsnNm_A2"           column="MGR_PSN_NM"                 javaType="EZDSStringItem"/>
        <result property="supvPsnCd_A1"         column="SUPV_PSN_CD"                javaType="EZDSStringItem"/>
        <result property="xxPsnNm_A3"           column="SUP_PSN_NM"                 javaType="EZDSStringItem"/>
        <result property="schdCoordPsnCd_A1"    column="SCHD_COORD_PSN_CD"          javaType="EZDSStringItem"/>
        <result property="xxPsnNm_A1"           column="CRD_PSN_NM"                 javaType="EZDSStringItem"/>
        <result property="stCd_A1"              column="ST_CD"                      javaType="EZDSStringItem"/>
        <result property="effFromDt_A1"         column="EFF_FROM_DT"                javaType="EZDSStringItem"/>
        <result property="effThruDt_A1"         column="EFF_THRU_DT"                javaType="EZDSStringItem"/>
        <result property="carrCd_A1"            column="CARR_CD"                    javaType="EZDSStringItem"/>
        <result property="locNm_A1"             column="LOC_NM"                     javaType="EZDSStringItem"/>
        <result property="carrCtacEmlAddr_A1"   column="CARR_CTAC_EML_ADDR"         javaType="EZDSStringItem"/>
        <result property="carrCtacTelNum_A1"    column="CARR_CTAC_TEL_NUM"          javaType="EZDSStringItem"/>
    </resultMap>

</sqlMap>
