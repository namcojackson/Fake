<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWZC164001">

    <!-- #################### Statement #################### --> 

    <statement id="getWfTarget" parameterClass="Map" resultClass="Map">
        <!-- 2017/04/13 S21_NA#18207 Mod Start -->
        SELECT
             H.HLD_PK
            ,HR.HLD_RSN_CD
            ,H.HLD_DT
            ,H.HLD_QTY
            ,C.CPO_ORD_NUM
            ,H.CPO_DTL_LINE_NUM
            ,H.CPO_DTL_LINE_SUB_NUM
            ,H.SHPG_PLN_NUM
            ,HR.ORD_PROC_NODE_CD
            ,OTP.VLD_APVL_NODE_PRFL_CD
            ,OTP.CR_APVL_NODE_PRFL_CD
            ,OTP.PRFT_APVL_NODE_PRFL_CD
            ,OTP.SPLY_ABUSE_NODE_PRFL_CD
            ,OPN.ORD_PROC_NODE_NM
            ,OPVA.ORD_PROC_NODE_PRFL_NM AS ORD_PROC_NODE_PRFL_NM_VA
            ,OPCA.ORD_PROC_NODE_PRFL_NM AS ORD_PROC_NODE_PRFL_NM_CA
            ,OPPA.ORD_PROC_NODE_PRFL_NM AS ORD_PROC_NODE_PRFL_NM_PA
            ,OPSA.ORD_PROC_NODE_PRFL_NM AS ORD_PROC_NODE_PRFL_NM_SA
            ,OPBA.ORD_PROC_NODE_PRFL_NM AS ORD_PROC_NODE_PRFL_NM_BA
            ,HR.HLD_RSN_NM
            <!-- add start 2023/04/25 QC#61337 -->
            ,OTP.MAN_PRC_NODE_PRFL_CD   AS MAN_PRC_NODE_PRFL_CD
            ,OPMA.ORD_PROC_NODE_PRFL_NM AS ORD_PROC_NODE_PRFL_NM_MA
            <!-- add end 2023/04/25 QC#61337 -->
        FROM
             CPO                 C
            ,DS_HLD_CTRL_ORD_TP  COT
            ,ORD_PROC_NODE       OPN
            ,HLD_RSN             HR
            ,HLD                 H
            ,DS_ORD_TP_PROC_DFN  OTP
            ,ORD_PROC_NODE_PRFL  OPVA
            ,ORD_PROC_NODE_PRFL  OPCA
            ,ORD_PROC_NODE_PRFL  OPPA
            ,ORD_PROC_NODE_PRFL  OPSA
            ,ORD_PROC_NODE_PRFL  OPBA
            <!-- add start 2023/04/25 QC#61337 -->
            ,ORD_PROC_NODE_PRFL  OPMA
            <!-- add end 2023/04/25 QC#61337 -->
        WHERE
                C.GLBL_CMPY_CD        = #glblCmpyCd#
            AND C.CPO_ORD_NUM         = #cpoOrdNum#
            AND C.EZCANCELFLAG        = '0'

            AND COT.GLBL_CMPY_CD       = C.GLBL_CMPY_CD
            AND COT.APPLY_DS_ORD_TP_CD = C.DS_ORD_TP_CD
            AND COT.EZCANCELFLAG       = '0'

            AND COT.GLBL_CMPY_CD       = HR.GLBL_CMPY_CD
            AND COT.HLD_RSN_CD         = HR.HLD_RSN_CD
            AND HR.ORD_PROC_NODE_CD   IS NOT NULL
            AND HR.HLD_EFF_FROM_DT   &lt;= #slsDt#
            AND (HR.HLD_EFF_TO_DT    &gt;= #slsDt#
                 OR HR.HLD_EFF_TO_DT       IS NULL
                )
            AND HR.EZCANCELFLAG       = '0'

            AND HR.GLBL_CMPY_CD       = OPN.GLBL_CMPY_CD
            AND HR.ORD_PROC_NODE_CD   = OPN.ORD_PROC_NODE_CD
            AND OPN.HLD_APPLY_AVAL_FLG = #hldApplyAvalFlg#
            AND OPN.EZCANCELFLAG       = '0'

            AND HR.GLBL_CMPY_CD        = H.GLBL_CMPY_CD(+)
            AND H.CPO_ORD_NUM(+)       = C.CPO_ORD_NUM
            AND H.REL_FLG(+)           = #relFlg#
            AND HR.HLD_RSN_CD          = H.HLD_RSN_CD(+)
            AND H.EZCANCELFLAG(+)      = '0'

            AND C.GLBL_CMPY_CD           = OTP.GLBL_CMPY_CD
            AND C.DS_ORD_TP_CD           = OTP.DS_ORD_TP_CD
            AND OTP.EZCANCELFLAG          = '0'

            AND OTP.GLBL_CMPY_CD          = OPVA.GLBL_CMPY_CD(+)
            AND OTP.VLD_APVL_NODE_PRFL_CD = OPVA.ORD_PROC_NODE_PRFL_CD(+)
            AND OPVA.EZCANCELFLAG(+)      = '0'

            AND OTP.GLBL_CMPY_CD          = OPCA.GLBL_CMPY_CD(+)
            AND OTP.CR_APVL_NODE_PRFL_CD  = OPCA.ORD_PROC_NODE_PRFL_CD(+)
            AND OPCA.EZCANCELFLAG(+)      = '0'

            AND OTP.GLBL_CMPY_CD           = OPPA.GLBL_CMPY_CD(+)
            AND OTP.PRFT_APVL_NODE_PRFL_CD = OPPA.ORD_PROC_NODE_PRFL_CD(+)
            AND OPPA.EZCANCELFLAG(+)       = '0'

            AND OTP.GLBL_CMPY_CD            = OPSA.GLBL_CMPY_CD(+)
            AND OTP.SPLY_ABUSE_NODE_PRFL_CD = OPSA.ORD_PROC_NODE_PRFL_CD(+)
            AND OPSA.EZCANCELFLAG(+)        = '0'

            AND OTP.GLBL_CMPY_CD              = OPBA.GLBL_CMPY_CD(+)
            AND OPBA.ORD_PROC_NODE_PRFL_CD(+) = '80'
            AND OPBA.EZCANCELFLAG(+)          = '0'

            <!-- add start 2023/04/25 QC#61337 -->
            AND OTP.GLBL_CMPY_CD            = OPMA.GLBL_CMPY_CD(+)
            AND OTP.MAN_PRC_NODE_PRFL_CD    = OPMA.ORD_PROC_NODE_PRFL_CD(+)
            AND OPMA.EZCANCELFLAG(+)        = '0' -->
            <!-- add end 2023/04/25 QC#61337 -->

        ORDER BY
             WF_HLD_SORT_NUM
            ,ORD_PROC_NODE_CD
            ,HLD_RSN_CD
            ,CPO_DTL_LINE_NUM
            ,CPO_DTL_LINE_SUB_NUM
        <!-- 2017/04/13 S21_NA#18207 Mod End -->
    </statement>

    <statement id="getValdApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM
           ,DAC.DS_ACCT_NM
           <!-- 2018/05/09 QC#20149 Add Start -->
           ,DAC.SELL_TO_CUST_CD
           <!-- 2018/05/09 QC#20149 Add End -->
           ,DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM
                                AS CATG_RSN
           ,T.COA_EXTN_CD || '. ' || CE.COA_EXTN_NM || '/' || T.COA_BR_CD || ', ' || CB.COA_BR_NM
                                AS BUS_UNIT_BR
           <!-- 2016/09/16 S21_NA#14402 Mod Start -->
           <!-- ,C.ENT_CPO_TOT_DEAL_NET_AMT -->
           ,(
<!-- QC#16155 Mod Start -->
             SELECT
                 SUM(COST_AMT)
             FROM
                 (
                  SELECT
                      ROUND(M.THIS_MTH_TOT_STD_COST_AMT * NVL(SWH.MDSE_INVTY_COST_PCT, 100) / 100, CCY.AFT_DECL_PNT_DIGIT_NUM) AS COST_AMT
                  FROM
                      CPO_DTL CD
                      ,SWH SWH
                      ,MDSE M
                      ,CCY CCY
                  WHERE
                      CD.GLBL_CMPY_CD         = #glblCmpyCd#
                  AND CD.CPO_ORD_NUM          = #cpoOrdNum#
                  AND CD.EZCANCELFLAG         = '0'

                  AND CD.EZCANCELFLAG         = '0'
                  AND CD.GLBL_CMPY_CD         = SWH.GLBL_CMPY_CD(+)
                  AND CD.RTL_SWH_CD           = SWH.RTL_SWH_CD(+)
                  AND SWH.EZCANCELFLAG(+)     = '0'

                  AND CD.GLBL_CMPY_CD         = M.GLBL_CMPY_CD
                  AND CD.MDSE_CD              = M.MDSE_CD
                  AND M.EZCANCELFLAG          = '0'

                  AND M.GLBL_CMPY_CD          = CCY.GLBL_CMPY_CD
                  AND M.COST_CCY_CD           = CCY.CCY_CD
                  AND CCY.EZCANCELFLAG        = '0'

                  UNION ALL

                  SELECT
                      ROUND(M.THIS_MTH_TOT_STD_COST_AMT * NVL(SWH.MDSE_INVTY_COST_PCT, 100) / 100, CCY.AFT_DECL_PNT_DIGIT_NUM) AS COST_AMT
                  FROM
                      CPO_DTL CD
                      ,SWH SWH
                      ,ORD_TAKE_MDSE OTM
                      ,MDSE M
                      ,CCY CCY
                  WHERE
                      CD.GLBL_CMPY_CD         = #glblCmpyCd#
                  AND CD.CPO_ORD_NUM          = #cpoOrdNum#
                  AND CD.EZCANCELFLAG         = '0'

                  AND CD.EZCANCELFLAG        = '0'
                  AND CD.GLBL_CMPY_CD          = SWH.GLBL_CMPY_CD(+)
                  AND CD.RTL_SWH_CD           = SWH.RTL_SWH_CD(+)
                  AND SWH.EZCANCELFLAG(+)     = '0'

                  AND CD.GLBL_CMPY_CD         = OTM.GLBL_CMPY_CD
                  AND CD.MDSE_CD              = OTM.ORD_TAKE_MDSE_CD
                  AND OTM.EZCANCELFLAG          = '0'

                  AND OTM.GLBL_CMPY_CD         = M.GLBL_CMPY_CD
                  AND OTM.MDSE_CD              = M.MDSE_CD
                  AND M.EZCANCELFLAG          = '0'

                  AND M.GLBL_CMPY_CD          = CCY.GLBL_CMPY_CD
                  AND M.COST_CCY_CD           = CCY.CCY_CD
                  AND CCY.EZCANCELFLAG        = '0'
                 )
<!-- QC#16155 Mod End -->
            ) AS THIS_MTH_TOT_STD_COST_AMT
           <!-- 2016/09/16 S21_NA#14402 Mod End -->
        FROM
            CPO          C
           ,SELL_TO_CUST DAC
           ,DS_ORD_CATG  DOC
           ,DS_ORD_TP    DOT
           ,TOC          T
           ,COA_EXTN     CE
           ,COA_BR       CB
        WHERE
                C.GLBL_CMPY_CD      = #glblCmpyCd#
            AND C.CPO_ORD_NUM       = #cpoOrdNum#
            AND C.EZCANCELFLAG      = '0'

            AND C.GLBL_CMPY_CD      = DAC.GLBL_CMPY_CD(+)
            AND C.SELL_TO_CUST_CD   = DAC.SELL_TO_CUST_CD(+)
            AND DAC.EZCANCELFLAG(+) = '0'

            AND C.GLBL_CMPY_CD      = DOC.GLBL_CMPY_CD(+)
            AND C.DS_ORD_CATG_CD    = DOC.DS_ORD_CATG_CD(+)
            AND DOC.EZCANCELFLAG(+) = '0'

            AND C.GLBL_CMPY_CD      = DOT.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD      = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+) = '0'

            AND C.GLBL_CMPY_CD      = T.GLBL_CMPY_CD(+)
            AND C.SLS_REP_TOC_CD    = T.TOC_CD(+)
            AND T.EZCANCELFLAG(+)   = '0'

            AND T.GLBL_CMPY_CD      = CE.GLBL_CMPY_CD(+)
            AND T.COA_EXTN_CD       = CE.COA_EXTN_CD(+)
            AND CE.EZCANCELFLAG(+)  = '0'

            AND T.GLBL_CMPY_CD      = CB.GLBL_CMPY_CD(+)
            AND T.COA_BR_CD         = CB.COA_BR_CD(+)
            AND CB.EZCANCELFLAG(+)  = '0'
    </statement>

    <statement id="getValdApvlLineData" parameterClass="Map" resultClass="Map">
        SELECT
             DCC.CONFIG_CATG_CD
            ,CC.CONFIG_CATG_NM
            ,NVL(M.T_MDL_NM, 'NONE')    AS MDL_NM
            <!-- Mod Start 2016/12/08 M.Ohno S21_NA#16308 -->
            -- ,SUM(CD.ORD_QTY) AS ORD_QTY
            ,COUNT(DCC.DS_CPO_CONFIG_PK) AS ORD_QTY
            <!-- Mod End   2016/12/08 M.Ohno S21_NA#16308 -->
        FROM
            DS_CPO_CONFIG  DCC
            ,MDL_NM         M
            ,CONFIG_CATG    CC
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.EZCANCELFLAG         = '0'

           <!-- Del Start 2016/12/08 M.Ohno S21_NA#16308 -->
           <!--  
            AND DCC.GLBL_CMPY_CD         = DCD.GLBL_CMPY_CD
            AND DCC.CPO_ORD_NUM          = DCD.CPO_ORD_NUM
            AND DCC.DS_ORD_POSN_NUM      = DCD.DS_ORD_POSN_NUM
            AND DCD.EZCANCELFLAG         = '0'

            AND DCD.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
            AND DCD.CPO_ORD_NUM          = CD.CPO_ORD_NUM
            AND DCD.CPO_DTL_LINE_NUM     = CD.CPO_DTL_LINE_NUM
            AND DCD.CPO_DTL_LINE_SUB_NUM = CD.CPO_DTL_LINE_SUB_NUM
            AND CD.EZCANCELFLAG          = '0' -->
            <!-- Del End   2016/12/08 M.Ohno S21_NA#16308 -->

            AND DCC.GLBL_CMPY_CD         = M.T_GLBL_CMPY_CD(+)
            AND DCC.MDL_ID               = M.T_MDL_ID(+)
            AND M.EZCANCELFLAG(+)        = '0'

            AND DCC.GLBL_CMPY_CD         = CC.GLBL_CMPY_CD
            AND DCC.CONFIG_CATG_CD       = CC.CONFIG_CATG_CD
            AND CC.EZCANCELFLAG          = '0'
            <!-- Add Start 2016/12/08 M.Ohno S21_NA#16308 -->
            AND EXISTS(
                        SELECT
                            '1'
                        FROM
                            CPO_DTL CD
                        WHERE
                                DCC.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
                            AND DCC.CPO_ORD_NUM          = CD.CPO_ORD_NUM
                            AND DCC.DS_CPO_CONFIG_PK     = CD.DS_CPO_CONFIG_PK
                            AND CD.EZCANCELFLAG         = '0'
                
                            AND CD.ORD_LINE_STS_CD       &lt;&gt; #ordLineStsCancel#
                            AND CD.EZCANCELFLAG          = '0'
                       )
             <!-- Add End   2016/12/08 M.Ohno S21_NA#16308 -->
        GROUP BY
             DCC.CONFIG_CATG_CD
            ,CC.CONFIG_CATG_NM
            ,M.T_MDL_NM

        UNION
        SELECT
             DCC.CONFIG_CATG_CD
            ,CC.CONFIG_CATG_NM
            ,NVL(M.T_MDL_NM, 'NONE')  AS MDL_NM
            <!-- Mod Start 2016/12/08 M.Ohno S21_NA#16308 -->
            <!-- ,SUM(DCRD.ORD_QTY)             AS ORD_QTY -->
            ,COUNT(DCC.DS_CPO_CONFIG_PK) AS ORD_QTY
            <!-- Mod End   2016/12/08 M.Ohno S21_NA#16308 -->
        FROM
             DS_CPO_CONFIG   DCC
            <!-- ,DS_CPO_RTRN_DTL DCRD Del 2016/12/08 M.Ohno S21_NA#16308 -->
            ,MDL_NM          M
            ,CONFIG_CATG     CC
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.EZCANCELFLAG         = '0'

            <!-- Del Start 2016/12/08 M.Ohno S21_NA#16308 -->
            <!--  AND DCC.GLBL_CMPY_CD         = DCRD.GLBL_CMPY_CD
            AND DCC.CPO_ORD_NUM          = DCRD.CPO_ORD_NUM
            AND DCC.DS_ORD_POSN_NUM      = DCRD.DS_ORD_POSN_NUM
            AND DCRD.EZCANCELFLAG        = '0' -->
            <!--Del End   2016/12/08 M.Ohno S21_NA#16308 -->

            AND DCC.GLBL_CMPY_CD         = M.T_GLBL_CMPY_CD(+)
            AND DCC.MDL_ID               = M.T_MDL_ID(+)
            AND M.EZCANCELFLAG(+)        = '0'

            AND DCC.GLBL_CMPY_CD         = CC.GLBL_CMPY_CD
            AND DCC.CONFIG_CATG_CD       = CC.CONFIG_CATG_CD
            AND CC.EZCANCELFLAG          = '0'

            <!-- Add Start 2016/12/08 M.Ohno S21_NA#16308 -->
            AND EXISTS (
                            SELECT
                                '1'
                            FROM
                                DS_CPO_RTRN_DTL DCRD
                            WHERE
                                    DCC.GLBL_CMPY_CD         = DCRD.GLBL_CMPY_CD
                                AND DCC.CPO_ORD_NUM          = DCRD.CPO_ORD_NUM
                                AND DCC.DS_CPO_CONFIG_PK     = DCRD.DS_CPO_CONFIG_PK
                                AND DCRD.RTRN_LINE_STS_CD    &lt;&gt; #rtrnLineStsCancel#
                                AND DCRD.EZCANCELFLAG        = '0'
                        )
        GROUP BY
             DCC.CONFIG_CATG_CD
            ,CC.CONFIG_CATG_NM
            ,M.T_MDL_NM
    </statement>

    <statement id="getPrftApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
             C.CPO_ORD_NUM
            ,DAC.DS_ACCT_NM
            <!-- 2018/05/09 QC#20149 Add Start -->
            ,DAC.SELL_TO_CUST_CD
            <!-- 2018/05/09 QC#20149 Add End -->
            ,DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM
                                            AS CATG_RSN
            ,T.COA_EXTN_CD || '. ' || CE.COA_EXTN_NM || '/' || T.COA_BR_CD || ', ' || CB.COA_BR_NM
                                            AS BUS_UNIT_BR
            ,C.NEGO_DEAL_AMT
            ,C.DS_ORD_CATG_CD
            ,C.DS_ORD_TP_CD
            ,T.COA_EXTN_CD
            ,T.COA_BR_CD
            ,C.DS_ORD_RSN_CD
            ,C.PRC_BASE_DT
            ,C.PRC_CALC_DT
            ,C.CSMP_CONTR_NUM
            ,C.DLR_REF_NUM
            ,C.SELL_TO_CUST_CD
            ,C.BILL_TO_CUST_CD
            ,OTP.LINE_BIZ_TP_CD
            ,DOC.DS_ORD_CATG_NM
            ,DOT.DS_ORD_TP_NM
        FROM
             CPO                 C
            ,SELL_TO_CUST        DAC
            ,DS_ORD_CATG         DOC
            ,DS_ORD_TP           DOT
            ,DS_ORD_TP_PROC_DFN  OTP
            ,TOC                 T
            ,COA_EXTN            CE
            ,COA_BR              CB

        WHERE
                C.GLBL_CMPY_CD         = #glblCmpyCd#
            AND C.CPO_ORD_NUM          = #cpoOrdNum#
            AND C.EZCANCELFLAG         = '0'

            AND C.GLBL_CMPY_CD         = DAC.GLBL_CMPY_CD (+)
            AND C.SELL_TO_CUST_CD      = DAC.SELL_TO_CUST_CD (+)
            AND DAC.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = DOC.GLBL_CMPY_CD (+)
            AND C.DS_ORD_CATG_CD       = DOC.DS_ORD_CATG_CD (+)
            AND DOC.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = DOT.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD         = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = OTP.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD         = OTP.DS_ORD_TP_CD (+)
            AND OTP.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = T.GLBL_CMPY_CD (+)
            AND C.SLS_REP_TOC_CD       = T.TOC_CD (+)
            AND T.EZCANCELFLAG(+)      = '0'

            AND T.GLBL_CMPY_CD         = CE.GLBL_CMPY_CD (+)
            AND T.COA_EXTN_CD          = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG(+)     = '0'

            AND T.GLBL_CMPY_CD         = CB.GLBL_CMPY_CD (+)
            AND T.COA_BR_CD            = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG(+)     = '0'
    </statement>

    <statement id="getPrftApvlLineData" parameterClass="Map" resultClass="Map">
        SELECT
                  V.*
            FROM
                ( 
                 SELECT
                      C.GLBL_CMPY_CD
                    , C.ORD_HDR_STS_CD
                    , LC.DS_ORD_LINE_DRCTN_CD
                    , C.DS_ORD_CATG_CD
                    , C.DS_ORD_TP_CD
                    , C.DS_ORD_RSN_CD
                    , C.PRC_BASE_DT
                    , C.PRC_CALC_DT
                    , C.NEGO_DEAL_AMT
                    , C.CSMP_CONTR_NUM
                    , C.DLR_REF_NUM
                    , CD.CPO_DTL_LINE_NUM           TRX_LINE_NUM
                    , CD.CPO_DTL_LINE_SUB_NUM       TRX_LINE_SUB_NUM
                    , CD.DS_ORD_POSN_NUM
                    , CD.DS_CPO_LINE_NUM
                    , CD.DS_CPO_LINE_SUB_NUM
                    , CD.MDSE_CD
                    , CD.RTL_WH_CD
                    , CD.RTL_SWH_CD
                    , CD.DS_ORD_LINE_CATG_CD
                    , CD.ORD_QTY
                    , CD.CUST_UOM_CD
                    , CD.REF_CPO_DTL_LINE_NUM
                    , CD.REF_CPO_DTL_LINE_SUB_NUM
                    , CD.FL_PRC_LIST_CD
                    , CD.FUNC_PRC_LIST_PRC_AMT
                    , CD.ENT_FUNC_NET_UNIT_PRC_AMT  FUNC_NET_UNIT_PRC_AMT
                    , CD.CPO_DTL_FUNC_NET_AMT       FUNC_NET_AMT
                    , CD.FUNC_MAN_FL_ADJ_AMT
                    , CD.FUNC_SVC_COST_TRNSF_AMT
                    , CD.FUNC_MAN_REP_REV_ADJ_AMT
                    , CD.FUNC_SVC_REV_TRNSF_AMT
                    , DCC.CONFIG_CATG_CD
                    , #ordPrftTrxCatgOutBound#      ORD_PRFT_TRX_CATG_CD
                    , CD.CSMP_PRC_LIST_CD
                    , CD.CPO_DTL_FUNC_SLS_AMT
                    , CD.ORD_CUST_UOM_QTY
                    , CD.CSMP_CONTR_NUM            DTL_CSMP_CONTR_NUM
                    , CD.DLR_REF_NUM               DTL_DLR_REF_NUM
                    , CD.PRC_CATG_CD
                    --
                    , CD.ORD_LINE_STS_CD            LINE_STS_CD
                    , C.BILL_TO_CUST_CD
                    , C.SELL_TO_CUST_CD
                    , CD.SHIP_TO_CUST_CD
                    , DCC.BILL_TO_CUST_ACCT_CD
                    , DCC.BILL_TO_CUST_LOC_CD
                    , DCC.SHIP_TO_CUST_ACCT_CD
                    , DCC.SHIP_TO_CUST_LOC_CD
                    --
                    , M.THIS_MTH_TOT_STD_COST_AMT
                FROM
                    CPO                 C
                    , DS_CPO_CONFIG     DCC
                    , CPO_DTL           CD
                    , DS_ORD_LINE_CATG  LC
                    , (SELECT
                           M.GLBL_CMPY_CD
                          ,M.MDSE_CD
                          ,M.THIS_MTH_TOT_STD_COST_AMT
                          ,M.EZCANCELFLAG
                       FROM
                           MDSE M
                       WHERE
                           M.GLBL_CMPY_CD     = #glblCmpyCd#
                           AND M.EZCANCELFLAG = '0'
                       UNION ALL
                       SELECT
                           M.GLBL_CMPY_CD
                          ,OTM.ORD_TAKE_MDSE_CD AS MDSE_CD
                          ,M.THIS_MTH_TOT_STD_COST_AMT
                          ,M.EZCANCELFLAG
                       FROM
                           MDSE M
                          ,ORD_TAKE_MDSE OTM
                       WHERE
                           M.GLBL_CMPY_CD       = #glblCmpyCd#
                           AND M.EZCANCELFLAG   = '0'
                           AND M.GLBL_CMPY_CD   = OTM.GLBL_CMPY_CD
                           AND M.MDSE_CD        = OTM.MDSE_CD
                           AND OTM.EZCANCELFLAG = '0'
                      ) M
                WHERE
                    C.GLBL_CMPY_CD              = #glblCmpyCd#
                    AND C.CPO_ORD_NUM           = #trxHdrNum#
                    AND C.EZCANCELFLAG          = '0'
                    AND DCC.GLBL_CMPY_CD        = CD.GLBL_CMPY_CD
                    AND DCC.CPO_ORD_NUM         = CD.CPO_ORD_NUM
                    AND DCC.DS_ORD_POSN_NUM     = CD.DS_ORD_POSN_NUM
                    AND DCC.CONFIG_CATG_CD      = #outBound#
                    AND DCC.EZCANCELFLAG        = '0'
                    AND C.GLBL_CMPY_CD          = CD.GLBL_CMPY_CD
                    AND C.CPO_ORD_NUM           = CD.CPO_ORD_NUM
                    AND CD.CPO_DTL_CANC_FLG     = 'N'
                    AND CD.SET_MDSE_CD         IS NULL
                    AND CD.EZCANCELFLAG         = '0'
                    AND CD.GLBL_CMPY_CD        = LC.GLBL_CMPY_CD
                    AND CD.DS_ORD_LINE_CATG_CD = LC.DS_ORD_LINE_CATG_CD
                    AND LC.EZCANCELFLAG         = '0'
                    --
                    AND CD.GLBL_CMPY_CD         = M.GLBL_CMPY_CD
                    AND CD.MDSE_CD              = M.MDSE_CD
                    AND M.EZCANCELFLAG          = '0'
            UNION ALL 
            SELECT
                      C.GLBL_CMPY_CD
                    , C.ORD_HDR_STS_CD
                    , LC.DS_ORD_LINE_DRCTN_CD
                    , C.DS_ORD_CATG_CD
                    , C.DS_ORD_TP_CD
                    , C.DS_ORD_RSN_CD
                    , C.PRC_BASE_DT
                    , C.PRC_CALC_DT
                    , C.NEGO_DEAL_AMT
                    , C.CSMP_CONTR_NUM
                    , C.DLR_REF_NUM
                    , DCRD.DS_CPO_RTRN_LINE_NUM         TRX_LINE_NUM
                    , DCRD.DS_CPO_RTRN_LINE_SUB_NUM     TRX_LINE_SUB_NUM
                    , DCRD.DS_ORD_POSN_NUM
                    , DCRD.DS_CPO_LINE_NUM
                    , DCRD.DS_CPO_LINE_SUB_NUM
                    , DCRD.MDSE_CD
                    , DCRD.RTL_WH_CD
                    , DCRD.RTL_SWH_CD
                    , DCRD.DS_ORD_LINE_CATG_CD
                    , DCRD.ORD_QTY
                    , DCRD.CUST_UOM_CD
                    , DCRD.REF_CPO_DTL_LINE_NUM
                    , DCRD.REF_CPO_DTL_LINE_SUB_NUM
                    , DCRD.FL_PRC_LIST_CD
                    , DCRD.FUNC_PRC_LIST_PRC_AMT
                    , DCRD.ENT_FUNC_NET_UNIT_PRC_AMT    FUNC_NET_UNIT_PRC_AMT
                    , DCRD.CPO_DTL_FUNC_NET_AMT         FUNC_NET_AMT
                    , DCRD.FUNC_MAN_FL_ADJ_AMT
                    , DCRD.FUNC_SVC_COST_TRNSF_AMT
                    , DCRD.FUNC_MAN_REP_REV_ADJ_AMT
                    , DCRD.FUNC_SVC_REV_TRNSF_AMT
                    , DCC.CONFIG_CATG_CD
                    , #ordPrftTrxCatgInBound#           ORD_PRFT_TRX_CATG_CD
                    , DCRD.CSMP_PRC_LIST_CD
                    , DCRD.CPO_DTL_FUNC_SLS_AMT
                    , DCRD.ORD_CUST_UOM_QTY
                    , DCRD.CSMP_CONTR_NUM               DTL_CSMP_CONTR_NUM
                    , DCRD.DLR_REF_NUM                  DTL_DLR_REF_NUM
                    , DCRD.PRC_CATG_CD
                    --
                    , DCRD.RTRN_LINE_STS_CD             LINE_STS_CD
                    , C.BILL_TO_CUST_CD
                    , C.SELL_TO_CUST_CD
                    , DCRD.SHIP_TO_CUST_CD
                    , DCC.BILL_TO_CUST_ACCT_CD
                    , DCC.BILL_TO_CUST_LOC_CD
                    , DCC.SHIP_TO_CUST_ACCT_CD
                    , DCC.SHIP_TO_CUST_LOC_CD
                    --
                    , M.THIS_MTH_TOT_STD_COST_AMT
                FROM
                    CPO C
                    , DS_CPO_CONFIG    DCC
                    , DS_CPO_RTRN_DTL  DCRD
                    , DS_ORD_LINE_CATG LC
<!-- QC#16155 Mod Start -->
                    , MDSE             M
<!--                , (SELECT
                           M.GLBL_CMPY_CD
                          ,M.MDSE_CD
                          ,M.THIS_MTH_TOT_STD_COST_AMT
                          ,M.EZCANCELFLAG
                       FROM
                           MDSE M
                       WHERE
                           M.GLBL_CMPY_CD     = #glblCmpyCd#
                           AND M.EZCANCELFLAG = '0'
                       UNION ALL
                       SELECT
                           M.GLBL_CMPY_CD
                          ,OTM.ORD_TAKE_MDSE_CD AS MDSE_CD
                          ,M.THIS_MTH_TOT_STD_COST_AMT
                          ,M.EZCANCELFLAG
                       FROM
                           MDSE M
                          ,ORD_TAKE_MDSE OTM
                       WHERE
                           M.GLBL_CMPY_CD       = #glblCmpyCd#
                           AND M.EZCANCELFLAG   = '0'
                           AND M.GLBL_CMPY_CD   = OTM.GLBL_CMPY_CD
                           AND M.MDSE_CD        = OTM.MDSE_CD
                           AND OTM.EZCANCELFLAG = '0'
                      ) M  -->
<!-- QC#16155 Mod End -->
                WHERE
                    C.GLBL_CMPY_CD               = #glblCmpyCd#
                    AND C.CPO_ORD_NUM            = #trxHdrNum#
                    AND C.EZCANCELFLAG           = '0'
                    AND DCC.GLBL_CMPY_CD         = DCRD.GLBL_CMPY_CD
                    AND DCC.CPO_ORD_NUM          = DCRD.CPO_ORD_NUM
                    AND DCC.DS_ORD_POSN_NUM      = DCRD.DS_ORD_POSN_NUM
                    AND DCC.CONFIG_CATG_CD       = #inBound#
                    AND DCC.EZCANCELFLAG         = '0'
                    AND C.GLBL_CMPY_CD           = DCRD.GLBL_CMPY_CD
                    AND C.CPO_ORD_NUM            = DCRD.CPO_ORD_NUM
                    AND DCRD.CPO_DTL_CANC_FLG    = 'N'
                    AND DCRD.SET_MDSE_CD        IS NULL
                    AND DCRD.EZCANCELFLAG        = '0'
                    AND DCRD.GLBL_CMPY_CD        = LC.GLBL_CMPY_CD
                    AND DCRD.DS_ORD_LINE_CATG_CD = LC.DS_ORD_LINE_CATG_CD
                    AND LC.EZCANCELFLAG          = '0'
                    --
                    AND DCRD.GLBL_CMPY_CD       = M.GLBL_CMPY_CD
                    AND DCRD.MDSE_CD            = M.MDSE_CD
                    AND M.EZCANCELFLAG          = '0'
                 ) V
                , ORD_PRFT_TRX_CATG TC 
            WHERE
                TC.GLBL_CMPY_CD             = #glblCmpyCd#
                AND TC.ORD_PRFT_TRX_CATG_CD = V.ORD_PRFT_TRX_CATG_CD
                AND TC.EZCANCELFLAG         = '0'
                AND NOT EXISTS( -- 2016/03/30 S21_NA6292
                               SELECT
                                   '1'
                               FROM
                                   DS_ORD_TP_PROC_DFN      PD
                                 , ORD_PRFT_LINE_CATG_RULE LCR
                               WHERE 
                                   PD.GLBL_CMPY_CD  = V.GLBL_CMPY_CD
                               AND PD.DS_ORD_TP_CD  = V.DS_ORD_TP_CD
                               AND PD.EFF_FROM_DT   &lt;= #slsDt#
                               AND ( PD.EFF_THRU_DT &gt;= #slsDt# OR PD.EFF_THRU_DT IS NULL )
                               AND PD.ACTV_FLG      = 'Y'
                               AND PD.EZCANCELFLAG  = '0'
                               AND PD.GLBL_CMPY_CD  = LCR.GLBL_CMPY_CD
                               AND LCR.ORD_PROC_NODE_PRFL_CD = PD.PRFT_APVL_NODE_PRFL_CD
                               AND LCR.DS_ORD_LINE_CATG_CD   = V.DS_ORD_LINE_CATG_CD
                               AND LCR.EFF_FROM_DT   &lt;= #slsDt#
                               AND ( LCR.EFF_THRU_DT &gt;= #slsDt# OR LCR.EFF_THRU_DT IS NULL )
                               AND LCR.ACTV_FLG     = 'Y'
                               AND LCR.EZCANCELFLAG = '0'
                    )
                AND NOT EXISTS( -- 2016/03/30 S21_NA6292
                               SELECT
                                   '1'
                               FROM
                                   DS_ORD_TP_PROC_DFN      PD
                                 , ORD_PRFT_WH_RULE        WHR
                               WHERE 
                                   PD.GLBL_CMPY_CD  = V.GLBL_CMPY_CD
                               AND PD.DS_ORD_TP_CD  = V.DS_ORD_TP_CD
                               AND PD.EFF_FROM_DT   &lt;= #slsDt#
                               AND ( PD.EFF_THRU_DT &gt;= #slsDt# OR PD.EFF_THRU_DT IS NULL )
                               AND PD.ACTV_FLG      = 'Y'
                               AND PD.EZCANCELFLAG  = '0'
                               AND PD.GLBL_CMPY_CD  = WHR.GLBL_CMPY_CD
                               AND WHR.ORD_PROC_NODE_PRFL_CD = PD.PRFT_APVL_NODE_PRFL_CD
                               AND WHR.RTL_WH_CD    = V.RTL_WH_CD
                               AND NVL (WHR.RTL_SWH_CD, '1') = NVL (V.RTL_SWH_CD, '1')
                               AND WHR.EFF_FROM_DT   &lt;= #slsDt#
                               AND ( WHR.EFF_THRU_DT &gt;= #slsDt# OR WHR.EFF_THRU_DT IS NULL )
                               AND WHR.ACTV_FLG     = 'Y'
                               AND WHR.EZCANCELFLAG = '0'
                    )
            ORDER BY
                TC.ORD_PRFT_TRX_CATG_SORT_NUM
              , V.TRX_LINE_NUM
              , V.TRX_LINE_SUB_NUM
<!-- QC#10321-17 UPD E N D -->
    </statement>

    <statement id="getSplyAbuseYieldApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM
            ,C.CPO_ORD_TS
            ,C.SELL_TO_CUST_CD
            ,DAC.DS_ACCT_NM
            ,DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM
                                            AS CATG_RSN
            ,C.ENT_CPO_TOT_DEAL_NET_AMT
            ,OHS.ORD_HDR_STS_NM
            ,SSL.SHPG_SVC_LVL_NM
            ,CSL.CARR_SVC_LVL_NM
            ,C.ADD_SHIP_TO_LOC_NM
            ,C.ADD_SHIP_TO_FIRST_LINE_ADDR
            ,C.ADD_SHIP_TO_SCD_LINE_ADDR
            ,C.ADD_SHIP_TO_THIRD_LINE_ADDR
            ,C.ADD_SHIP_TO_FRTH_LINE_ADDR
            ,C.ADD_SHIP_TO_CTY_ADDR || ', ' || C.ADD_SHIP_TO_ST_CD
                                            AS ADD_SHIP_TO_CTY_ST
            ,C.ADD_SHIP_TO_POST_CD
        FROM
             CPO           C
            ,SELL_TO_CUST  DAC
            ,DS_ORD_TP     DOT
            ,DS_ORD_CATG   DOC
            ,ORD_HDR_STS   OHS
            ,SHPG_SVC_LVL  SSL
            ,CARR_SVC_LVL  CSL
        WHERE
                C.GLBL_CMPY_CD         = #glblCmpyCd#
            AND C.CPO_ORD_NUM          = #cpoOrdNum#
            AND C.EZCANCELFLAG         = '0'

            AND C.GLBL_CMPY_CD         = DAC.GLBL_CMPY_CD (+)
            AND C.SELL_TO_CUST_CD      = DAC.SELL_TO_CUST_CD (+)
            AND DAC.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD        = DOC.GLBL_CMPY_CD (+)
            AND C.DS_ORD_CATG_CD      = DOC.DS_ORD_CATG_CD (+)
            AND DOC.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD        = DOT.GLBL_CMPY_CD
            AND C.DS_ORD_TP_CD        = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = OHS.GLBL_CMPY_CD (+)
            AND C.ORD_HDR_STS_CD       = OHS.ORD_HDR_STS_CD (+)
            AND OHS.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = SSL.GLBL_CMPY_CD (+)
            AND C.ADD_SHPG_SVC_LVL_CD  = SSL.SHPG_SVC_LVL_CD (+)
            AND SSL.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD        = CSL.GLBL_CMPY_CD (+)
            AND C.CARR_SVC_LVL_CD     = CSL.CARR_SVC_LVL_CD (+)
            AND CSL.EZCANCELFLAG(+)    = '0'
    </statement>

    <statement id="getSplyAbuseYieldApvlLineData" parameterClass="Map" resultClass="Map">
        SELECT
             CONCAT(CD.DS_ORD_POSN_NUM, '.')
              || CONCAT(CD.DS_CPO_LINE_NUM, DECODE(CD.DS_CPO_LINE_SUB_NUM, NULL, '', '.'))
              || CD.DS_CPO_LINE_SUB_NUM         AS LINE_NUM
            ,CD.MDSE_CD || ' ' || CD.MDSE_NM     AS MDSE
        FROM
             CPO_DTL       CD
            ,ALL_MDSE_V    M
        WHERE
                CD.GLBL_CMPY_CD          = #glblCmpyCd#
            AND CD.CPO_ORD_NUM           = #cpoOrdNum#
            AND CD.EZCANCELFLAG          = '0'

            AND CD.GLBL_CMPY_CD          = M.GLBL_CMPY_CD
            AND CD.MDSE_CD               = M.MDSE_CD
            AND M.IMG_SPLY_YIELD_CNT    IS NULL
            AND M.EZCANCELFLAG           = '0'
    </statement>

    <statement id="getSplyAbusePndOrdApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
             C.CPO_ORD_NUM                  AS CPO_ORD_NUM
            ,C.CPO_ORD_TS                   AS CPO_ORD_TS
            ,C.SELL_TO_CUST_CD              AS SELL_TO_CUST_CD
            ,DAC.DS_ACCT_NM                 AS DS_ACCT_NM
            ,DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM
                                            AS CATG_RSN
            ,C.ENT_CPO_TOT_DEAL_NET_AMT     AS ENT_CPO_TOT_DEAL_NET_AMT
            ,OHS.ORD_HDR_STS_NM             AS ORD_HDR_STS_NM
            ,SSL.SHPG_SVC_LVL_NM            AS SHPG_SVC_LVL_NM
            ,CSL.CARR_SVC_LVL_NM            AS CARR_SVC_LVL_NM
            ,C.ADD_SHIP_TO_LOC_NM           AS ADD_SHIP_TO_LOC_NM
            ,C.ADD_SHIP_TO_FIRST_LINE_ADDR  AS ADD_SHIP_TO_FIRST_LINE_ADDR
            ,C.ADD_SHIP_TO_SCD_LINE_ADDR    AS ADD_SHIP_TO_SCD_LINE_ADDR
            ,C.ADD_SHIP_TO_THIRD_LINE_ADDR  AS ADD_SHIP_TO_THIRD_LINE_ADDR
            ,C.ADD_SHIP_TO_FRTH_LINE_ADDR   AS ADD_SHIP_TO_FRTH_LINE_ADDR
            ,C.ADD_SHIP_TO_CTY_ADDR || ', ' || C.ADD_SHIP_TO_ST_CD
                                            AS ADD_SHIP_TO_CTY_ST
            ,C.ADD_SHIP_TO_POST_CD          AS ADD_SHIP_TO_POST_CD
        FROM
             CPO             C
            ,SELL_TO_CUST    DAC
            ,DS_ORD_CATG     DOC
            ,DS_ORD_TP       DOT
            ,ORD_HDR_STS     OHS
            ,SHPG_SVC_LVL    SSL
            ,CARR_SVC_LVL    CSL
        WHERE
                C.GLBL_CMPY_CD          = #glblCmpyCd#
            AND C.CPO_ORD_NUM           = #cpoOrdNum#
            AND C.EZCANCELFLAG          = '0'

            AND C.GLBL_CMPY_CD          = DAC.GLBL_CMPY_CD (+)
            AND C.SELL_TO_CUST_CD       = DAC.SELL_TO_CUST_CD (+)
            AND DAC.EZCANCELFLAG(+)     = '0'

            AND C.GLBL_CMPY_CD         = DOC.GLBL_CMPY_CD (+)
            AND C.DS_ORD_CATG_CD       = DOC.DS_ORD_CATG_CD (+)
            AND DOC.EZCANCELFLAG(+)     = '0'

            AND C.GLBL_CMPY_CD         = DOT.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD         = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+)     = '0'

            AND C.GLBL_CMPY_CD          = OHS.GLBL_CMPY_CD (+)
            AND C.ORD_HDR_STS_CD        = OHS.ORD_HDR_STS_CD (+)
            AND OHS.EZCANCELFLAG(+)     = '0'

            AND C.GLBL_CMPY_CD          = SSL.GLBL_CMPY_CD (+)
            AND C.ADD_SHPG_SVC_LVL_CD   = SSL.SHPG_SVC_LVL_CD (+)
            AND SSL.EZCANCELFLAG(+)     = '0'

            AND C.GLBL_CMPY_CD         = CSL.GLBL_CMPY_CD (+)
            AND C.CARR_SVC_LVL_CD      = CSL.CARR_SVC_LVL_CD (+)
            AND CSL.EZCANCELFLAG(+)     = '0'
    </statement>

    <statement id="getSplyAbusePndOrdApvlLineData" parameterClass="Map" resultClass="Map">
        SELECT
             <!-- START 2018/08/21 M.Naito [QC#27252, MOD] -->
             <!-- CD.SER_NUM                        AS SER_NUM -->
             SMM.SER_NUM                        AS SER_NUM
             <!-- END 2018/08/21 M.Naito [QC#27252, MOD] -->
            ,CD.CPO_ORD_NUM                    AS CPO_ORD_NUM
            ,CONCAT(CD.DS_ORD_POSN_NUM, '.')
              || CONCAT(CD.DS_CPO_LINE_NUM, DECODE(CD.DS_CPO_LINE_SUB_NUM, NULL, '', '.'))
              || CD.DS_CPO_LINE_SUB_NUM        AS LINE_NUM
            ,CD.MDSE_CD || ' ' || CD.MDSE_NM    AS MDSE
        FROM
             CPO                   C
            ,ORD_CATG_BIZ_CTX      OCBC
            ,CPO_DTL               CD
            <!-- START 2018/08/21 M.Naito [QC#27252, ADD] -->
            ,SVC_MACH_MSTR         SMM
            <!-- END 2018/08/21 M.Naito [QC#27252, ADD] -->
        WHERE
                C.GLBL_CMPY_CD           = #glblCmpyCd#
            AND C.CPO_ORD_NUM           != #cpoOrdNum#
            AND C.ORD_HDR_STS_CD         = '10'
            AND C.EZCANCELFLAG           = '0'

            AND C.GLBL_CMPY_CD          = OCBC.GLBL_CMPY_CD
            AND C.DS_ORD_CATG_CD        = OCBC.DS_ORD_CATG_CD
            AND OCBC.ORD_CATG_CTX_TP_CD  = #ordCatgCtxTp#
            AND (C.DS_ORD_TP_CD         = OCBC.DS_ORD_TP_CD OR OCBC.DS_ORD_TP_CD IS NULL)
            AND OCBC.EZCANCELFLAG        = '0'

            AND C.GLBL_CMPY_CD           = CD.GLBL_CMPY_CD
            AND C.CPO_ORD_NUM            = CD.CPO_ORD_NUM
            AND CD.EZCANCELFLAG          = '0'

            <!-- START 2018/08/21 M.Naito [QC#27252, ADD] -->
            AND CD.GLBL_CMPY_CD          = SMM.GLBL_CMPY_CD(+)
            AND CD.SVC_MACH_MSTR_PK      = SMM.SVC_MACH_MSTR_PK(+)
            AND SMM.EZCANCELFLAG(+)      = '0'
            <!-- END 2018/08/21 M.Naito [QC#27252, ADD] -->
            AND EXISTS (
                    SELECT '1'
                    FROM
                          CPO A
                        , CPO_DTL C
                    WHERE
                            A.GLBL_CMPY_CD      = #glblCmpyCd#
                        AND A.CPO_ORD_NUM       = #cpoOrdNum#
                        AND A.EZCANCELFLAG      = '0'

                        AND A.GLBL_CMPY_CD      = C.GLBL_CMPY_CD
                        AND A.CPO_ORD_NUM       = C.CPO_ORD_NUM
                        AND C.EZCANCELFLAG      = '0'
<!-- 2016/10/06 CSA Defect#12898 Mod Start -->
                        AND (    C.SVC_MACH_MSTR_PK       = CD.SVC_MACH_MSTR_PK
                             OR (    C.SVC_MACH_MSTR_PK   IS NULL
                                 AND CD.SVC_MACH_MSTR_PK IS NULL
                                 AND C.DS_CONTR_NUM       = CD.DS_CONTR_NUM)
                            )
<!-- 2016/10/06 CSA Defect#12898 Mod End -->
            )
    </statement>

    <statement id="getSplyAbuseContrStsApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM
          , C.CPO_ORD_TS
          , C.ENT_CPO_TOT_DEAL_NET_AMT
          , DAC.DS_ACCT_NM
          , C.SELL_TO_CUST_CD
          , CCR.CR_LIMIT_AMT 
        FROM
            CPO             C
          , SELL_TO_CUST    DAC
          , CUST_CR_PRFL    CCR 
        WHERE
                C.GLBL_CMPY_CD    = #glblCmpyCd#
            AND C.CPO_ORD_NUM     = #cpoOrdNum#
            AND C.EZCANCELFLAG    = '0'

            AND C.GLBL_CMPY_CD    = DAC.GLBL_CMPY_CD(+)
            AND C.SELL_TO_CUST_CD = DAC.SELL_TO_CUST_CD(+)
            AND DAC.EZCANCELFLAG(+) = '0'

            AND C.GLBL_CMPY_CD    = CCR.GLBL_CMPY_CD(+)
            AND C.BILL_TO_CUST_CD = CCR.BILL_TO_CUST_CD(+)
            AND CCR.EZCANCELFLAG(+) = '0'
    </statement>

    <statement id="getSplyAbuseContrStsApvlLineData" parameterClass="Map" resultClass="Map">
        SELECT
          <!-- START 2018/08/21 M.Naito [QC#27252, MOD] -->
          <!-- DCD.SER_NUM -->
            SMM.SER_NUM
          , DCD.DS_CONTR_NUM
          <!-- , DCDS.DS_CONTR_DTL_STS_NM -->
          , DCDSV.DS_CONTR_CTRL_STS_NM AS DS_CONTR_DTL_STS_NM
            <!-- END 2018/08/21 M.Naito [QC#27252, MOD] --> 
        FROM
            CPO_DTL          DCD
          , DS_CONTR            DC
          , DS_CONTR_DTL        DCND
          <!-- START 2018/08/21 M.Naito [QC#27252, MOD] -->
          <!-- , DS_CONTR_DTL_STS    DCDS -->
          , SVC_MACH_MSTR       SMM
          , DS_CONTR_DTL_STS_V  DCDSV
          <!-- END 2018/08/21 M.Naito [QC#27252, MOD] -->
        WHERE
                DCD.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCD.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCD.EZCANCELFLAG         = '0'

            AND DCD.GLBL_CMPY_CD         = DC.GLBL_CMPY_CD
            AND DCD.DS_CONTR_NUM         = DC.DS_CONTR_NUM
            AND DC.EZCANCELFLAG          = '0'

            AND DC.GLBL_CMPY_CD          = DCND.GLBL_CMPY_CD
            AND DC.DS_CONTR_PK           = DCND.DS_CONTR_PK
<!-- 2016/10/06 CSA Defect#12898 Mod Start -->
            AND (    DCD.SVC_MACH_MSTR_PK      = DCND.SVC_MACH_MSTR_PK
                 OR (    DCD.SVC_MACH_MSTR_PK  IS NULL
                     AND DCND.SVC_MACH_MSTR_PK IS NULL)
                )
<!-- 2016/10/06 CSA Defect#12898 Mod End -->
            AND DCND.EZCANCELFLAG        = '0'

            <!-- START 2018/08/21 M.Naito [QC#27252, MOD] -->
            <!-- AND DCND.GLBL_CMPY_CD        = DCDS.GLBL_CMPY_CD -->
            <!-- AND DCND.DS_CONTR_DTL_STS_CD = DCDS.DS_CONTR_DTL_STS_CD -->
            <!-- AND DCDS.EZCANCELFLAG        = '0' -->
            AND DCND.GLBL_CMPY_CD        = DCDSV.GLBL_CMPY_CD
            AND DCND.DS_CONTR_DTL_PK     = DCDSV.DS_CONTR_DTL_PK
            AND DCDSV.EZCANCELFLAG       = '0'
            AND DCD.GLBL_CMPY_CD         = SMM.GLBL_CMPY_CD(+)
            AND DCD.SVC_MACH_MSTR_PK     = SMM.SVC_MACH_MSTR_PK(+)
            AND SMM.EZCANCELFLAG(+)      = '0'
            <!-- END 2018/08/21 M.Naito [QC#27252, MOD] -->
    </statement>

    <statement id="getSplyAbuseSuplyEnfApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM
          , C.CPO_ORD_TS
          , C.ENT_CPO_TOT_DEAL_NET_AMT
          , DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM   AS CATG_RSN
          , OHS.ORD_HDR_STS_NM
          , SSL.SHPG_SVC_LVL_NM
          , CSL.CARR_SVC_LVL_NM
          , C.SELL_TO_CUST_CD
          , DAC.DS_ACCT_NM
          , C.ADD_SHIP_TO_LOC_NM
          , C.ADD_SHIP_TO_FIRST_LINE_ADDR
          , C.ADD_SHIP_TO_SCD_LINE_ADDR
          , C.ADD_SHIP_TO_THIRD_LINE_ADDR
          , C.ADD_SHIP_TO_FRTH_LINE_ADDR
          , C.ADD_SHIP_TO_CTY_ADDR || ', ' || C.ADD_SHIP_TO_ST_CD AS ADD_SHIP_TO_CTY_ST
          , C.ADD_SHIP_TO_POST_CD 
        FROM
            CPO C
          , SELL_TO_CUST DAC
          , DS_ORD_CATG DOC
          , DS_ORD_TP DOT
          , ORD_HDR_STS OHS
          , SHPG_SVC_LVL SSL
          , CARR_SVC_LVL CSL 
        WHERE
                C.GLBL_CMPY_CD        = #glblCmpyCd#
            AND C.CPO_ORD_NUM         = #cpoOrdNum#
            AND C.EZCANCELFLAG        = '0' 

            AND C.GLBL_CMPY_CD        = DAC.GLBL_CMPY_CD(+)
            AND C.SELL_TO_CUST_CD     = DAC.SELL_TO_CUST_CD(+)
            AND DAC.EZCANCELFLAG(+)   = '0' 

            AND C.GLBL_CMPY_CD       = DOC.GLBL_CMPY_CD(+)
            AND C.DS_ORD_CATG_CD     = DOC.DS_ORD_CATG_CD(+)
            AND DOC.EZCANCELFLAG(+)   = '0' 

            AND C.GLBL_CMPY_CD       = DOT.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD       = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+)   = '0'

            AND C.GLBL_CMPY_CD        = OHS.GLBL_CMPY_CD(+)
            AND C.ORD_HDR_STS_CD      = OHS.ORD_HDR_STS_CD(+)
            AND OHS.EZCANCELFLAG(+)   = '0' 

            AND C.GLBL_CMPY_CD        = SSL.GLBL_CMPY_CD(+)
            AND C.ADD_SHPG_SVC_LVL_CD = SSL.SHPG_SVC_LVL_CD(+)
            AND SSL.EZCANCELFLAG(+)   = '0' 

            AND C.GLBL_CMPY_CD       = CSL.GLBL_CMPY_CD(+)
            AND C.CARR_SVC_LVL_CD    = CSL.CARR_SVC_LVL_CD(+)
            AND CSL.EZCANCELFLAG(+)   = '0'
    </statement>

<!-- START 2018/09/25 [QC#28318,MOD] -->
    <statement id="getSplyAbuseSuplyEnfApvlLineData" parameterClass="Map" resultClass="Map">
        SELECT
<!--        SUM(DATD.TRGT_ORD_QTY)                  AS TOTAL_TONERS_QTY   -->
<!--      , SUM(DATD.TRGT_ORD_QTY - DATD.SHIP_QTY)  AS TOTAL_ALLOWED_QTY  -->
<!--      , SUM(DATD.SHIP_QTY)                      AS TOTAL_USED_QTY     -->
            DC.DS_CONTR_PK                          AS DS_CONTR_PK
          , SSAS.BW_USED_QTY + SSAS.COLOR_USED_QTY  AS TOTAL_USED_QTY
        FROM
            CPO_DTL             DCD
          , DS_CONTR            DC
          , DS_CONTR_DTL        DCDT
<!--      , DS_ACPO_TRGT_DTL    DATD   -->
<!--      , DS_ACPO             DA     -->
<!--      , SVC_MACH_MSTR       SMM     2016/10/06 CSA Defect#12898 Del -->
          , SVC_SPLY_ABUSE_STAGE SSAS
        WHERE
                DCD.GLBL_CMPY_CD      = #glblCmpyCd#
            AND DCD.CPO_ORD_NUM       = #cpoOrdNum#
            AND DCD.EZCANCELFLAG      = '0'

            AND DCD.GLBL_CMPY_CD      = DC.GLBL_CMPY_CD
            AND DCD.DS_CONTR_NUM      = DC.DS_CONTR_NUM
            AND DC.EZCANCELFLAG       = '0'

            AND DC.GLBL_CMPY_CD       = DCDT.GLBL_CMPY_CD
            AND DC.DS_CONTR_PK        = DCDT.DS_CONTR_PK
            AND DCDT.EZCANCELFLAG     = '0'

<!-- 2016/10/06 CSA Defect#12898 Del Start -->
<!--
            AND DCDT.GLBL_CMPY_CD     = SMM.GLBL_CMPY_CD
            AND DCDT.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK
            AND DCD.SER_NUM           = SMM.SER_NUM       2016/03/23 S21_NA5896 Del
            AND SMM.EZCANCELFLAG      = '0'
-->
<!-- 2016/10/06 CSA Defect#12898 Del End -->
<!--
            AND DCDT.GLBL_CMPY_CD     = DA.GLBL_CMPY_CD
            AND DCDT.DS_CONTR_DTL_PK  = DA.DS_CONTR_DTL_PK
            AND DA.EZCANCELFLAG       = '0'

            AND DA.GLBL_CMPY_CD       = DATD.GLBL_CMPY_CD
            AND DA.DS_ACPO_NUM        = DATD.DS_ACPO_NUM
            AND DATD.EZCANCELFLAG     = '0'
-->
            AND DC.GLBL_CMPY_CD       = SSAS.GLBL_CMPY_CD
            AND DC.DS_CONTR_PK        = SSAS.DS_CONTR_PK
            AND SSAS.FRZ_FLG          = 'N'
            AND SSAS.EZCANCELFLAG     = '0'

<!-- 2016/10/06 CSA Defect#12898 Add Start -->
            AND (   EXISTS (
                        SELECT '1'
                        FROM
                            SVC_MACH_MSTR SMM
                        WHERE
                                SMM.GLBL_CMPY_CD      = DCDT.GLBL_CMPY_CD
                            AND SMM.SVC_MACH_MSTR_PK  = DCDT.SVC_MACH_MSTR_PK
                            AND SMM.EZCANCELFLAG      = '0')
                 OR DCDT.SVC_MACH_MSTR_PK IS NULL
                )
<!-- 2016/10/06 CSA Defect#12898 Add End -->

        GROUP BY
<!--            DCD.CPO_ORD_NUM    -->
                DC.DS_CONTR_PK
              , SSAS.BW_USED_QTY
              , SSAS.COLOR_USED_QTY

    </statement>
<!-- END 2018/09/25 [QC#28318,MOD] -->

<!-- START 2018/09/25 [QC#28318,ADD] -->
    <statement id="geSvcTermCondAttrbInfo" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                 STCA.SVC_TERM_COND_ATTRB_PK
        FROM
                 SVC_TERM_COND_ATTRB STCA
        WHERE
             STCA.GLBL_CMPY_CD                    = #glblCmpyCd#
             AND STCA.SVC_TERM_COND_ATTRB_NM      = #capBwOrgAttrbNm#
             AND STCA.EFF_FROM_DT             &lt;= #salseDate#
             AND (STCA.EFF_THRU_DT            &gt;= #salseDate#
              OR  STCA.EFF_THRU_DT            IS NULL)
             AND STCA.EZCANCELFLAG                = '0'
    </statement>

    <statement id="getSvcTermCondInfoForMach" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                 SUM(TO_NUMBER(STC.SVC_TERM_ATTRB_MAP_VAL_CD))
        FROM
                 SVC_TERM_COND STC
        WHERE
             STC.GLBL_CMPY_CD                     = #glblCmpyCd#
             AND STC.DS_CONTR_PK                  = #dsContrPk#
             AND STC.DS_CONTR_DTL_PK              IS NOT NULL
             AND STC.SVC_TERM_COND_ATTRB_PK       = #svcTermCondAttrbPk#
             AND STC.SVC_TERM_ATTRB_MAP_VAL_CD    IS NOT NULL
             AND STC.EZCANCELFLAG                 = '0'
        GROUP BY
                 STC.DS_CONTR_PK
    </statement>

    <statement id="getSvcTermCondInfoForContr" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                 TO_NUMBER(STC.SVC_TERM_ATTRB_MAP_VAL_CD)
        FROM
                 SVC_TERM_COND STC
        WHERE
             STC.GLBL_CMPY_CD                     = #glblCmpyCd#
             AND STC.DS_CONTR_PK                  = #dsContrPk#
             AND STC.DS_CONTR_DTL_PK              IS NULL
             AND STC.SVC_TERM_COND_ATTRB_PK       = #svcTermCondAttrbPk#
             AND STC.SVC_TERM_ATTRB_MAP_VAL_CD    IS NOT NULL
             AND STC.EZCANCELFLAG                 = '0'
    </statement>
<!-- END 2018/09/25 [QC#28318,ADD] -->

    <statement id="getCreditApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM
          , C.CPO_ORD_TS
          , C.BILL_TO_CUST_CD
          , C.SLS_REP_TOC_CD
          , C.BILL_TO_CUST_ACCT_CD
          , BTC.LOC_NM
          , DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM    AS CATG_RSN
          , T.COA_EXTN_CD || '. ' || CE.COA_EXTN_NM || '/' || T.COA_BR_CD || ', ' || CB.COA_BR_NM
                                                             AS BUS_UNIT_BR
<!-- QC#13477 mod
          , C.ENT_CPO_TOT_DEAL_NET_AMT
 -->
<!-- QC#16995 mod
          , C.LINE_DEAL_SUB_TOT_AMT
 -->
          , C.ORD_TOT_DEAL_SUB_TOT_AMT
          , NVL(DACP.CR_LIMIT_AMT, 0)         AS CR_LIMIT_AMT
<!-- 2017/08/04 S21_NA#15606 Mod Start -->
<!-- QC#10321 Mod Start -->
<!--           , (SELECT -->
<!--                  (MAX(DCD.DS_CONTR_NUM) || ',' || NVL(MAX(DCN.CONTR_VRSN_EFF_THRU_DT), '99991231')) AS CONTR_INFO -->
<!--              FROM -->
<!--                  CPO_DTL  DCD -->
<!--                , DS_CONTR    DCN -->
<!--              WHERE -->
<!--                     DCD.GLBL_CMPY_CD  = #glblCmpyCd# -->
<!--                 AND DCD.CPO_ORD_NUM   = #cpoOrdNum# -->
<!--                 AND DCD.EZCANCELFLAG  = '0' -->

<!--                 AND DCD.GLBL_CMPY_CD  = DCN.GLBL_CMPY_CD -->
<!--                 AND DCD.DS_CONTR_NUM  = DCN.DS_CONTR_NUM -->
<!--                 AND DCN.EZCANCELFLAG  = '0' -->
<!--           ) AS CONTR_INFO -->
<!-- QC#10321 Mod End -->
          , (SELECT
                 MAX(DCD.DS_CONTR_NUM) AS CONTR_NUM
             FROM
                 CPO_DTL  DCD
               , DS_CONTR    DCN
             WHERE
                    DCD.GLBL_CMPY_CD  = #glblCmpyCd#
                AND DCD.CPO_ORD_NUM   = #cpoOrdNum#
                AND DCD.EZCANCELFLAG  = '0'

                AND DCD.GLBL_CMPY_CD  = DCN.GLBL_CMPY_CD
                AND DCD.DS_CONTR_NUM  = DCN.DS_CONTR_NUM
                AND DCN.EZCANCELFLAG  = '0'
          ) AS CONTR_NUM
          , NVL(CRC_A.GRACE_PER_DAYS_AOT, 0) AS GRACE_PER_DAYS_AOT
<!-- 2017/08/04 S21_NA#15606 Mod End -->
          , DACP.DS_ACCT_NUM
          
          , DACP.CUST_HARD_HLD_FLG        <!-- Hard Hold Flag -->
          , DCAS.DS_CLT_ACCT_STS_DESC_TXT <!-- Account Status -->
          , C.LINE_DEAL_NET_AMT           <!-- Sub Total -->
          , C.LINE_DEAL_TAX_AMT           <!-- Tax -->
          , C.LINE_DEAL_SUB_TOT_AMT       <!-- Amount -->
          , NVL(CRC_B.CONTR_GRACE_PER_DAYS_AOT, 0) AS CONTR_GRACE_PER_DAYS_AOT <!-- Contract Grace Period -->
<!-- START 2018/07/24 Y.Matsui [QC#26798,ADD] -->
          , C.DS_ORD_CATG_CD
          , C.DS_ORD_TP_CD
          , C.CUST_ISS_PO_NUM
          , C.PMT_TERM_CASH_DISC_DESC_TXT AS PMT_TERM_CASH_DISC_DESC_TXT_O
          , (SELECT
                 PTCD.PMT_TERM_CASH_DISC_DESC_TXT
             FROM
                 PMT_TERM_CASH_DISC PTCD
             WHERE
                    PTCD.GLBL_CMPY_CD          = DACP.GLBL_CMPY_CD
                AND PTCD.PMT_TERM_CASH_DISC_CD = DACP.PMT_TERM_CASH_DISC_CD
                AND PTCD.EZCANCELFLAG          = '0'
          ) AS PMT_TERM_CASH_DISC_DESC_TXT_A
<!-- END   2018/07/24 Y.Matsui [QC#26798,ADD] -->
        FROM
            CPO_V        C
          , BILL_TO_CUST    BTC
          , DS_ORD_CATG     DOC
          , DS_ORD_TP       DOT
          , TOC             T
          , COA_BR          CB
          , COA_EXTN        CE
          , DS_ACCT_CR_PRFL DACP
<!-- 2017/08/04 S21_NA#15606 Mod Start -->
          , CR_RISK_CLS     CRC_A
<!-- 2017/08/04 S21_NA#15606 Mod End -->
          , SELL_TO_CUST    DAC
          , DS_CLT_ACCT_STS DCAS
          , CONTR_CR_RISK_CLS     CRC_B
        WHERE
                C.GLBL_CMPY_CD           = #glblCmpyCd#
            AND C.CPO_ORD_NUM            = #cpoOrdNum#
            AND C.EZCANCELFLAG           = '0'

            AND C.GLBL_CMPY_CD           = BTC.GLBL_CMPY_CD (+)
            AND C.BILL_TO_CUST_CD        = BTC.BILL_TO_CUST_CD (+)
            AND BTC.RGTN_STS_CD          = #rgtnStsCd#
            AND BTC.EZCANCELFLAG(+)      = '0'

            AND C.GLBL_CMPY_CD          = DOC.GLBL_CMPY_CD (+)
            AND C.DS_ORD_CATG_CD        = DOC.DS_ORD_CATG_CD (+)
            AND DOC.EZCANCELFLAG(+)      = '0'

            AND C.GLBL_CMPY_CD          = DOT.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD          = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+)      = '0'

            AND C.GLBL_CMPY_CD          = T.GLBL_CMPY_CD (+)
            AND C.SLS_REP_TOC_CD        = T.TOC_CD (+)
            AND T.EZCANCELFLAG(+)        = '0'

            AND T.GLBL_CMPY_CD           = CB.GLBL_CMPY_CD (+)
            AND T.COA_BR_CD              = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG(+)       = '0'

            AND T.GLBL_CMPY_CD           = CE.GLBL_CMPY_CD (+)
            AND T.COA_EXTN_CD            = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG(+)       = '0'

            AND C.GLBL_CMPY_CD          = DACP.GLBL_CMPY_CD (+)
            AND C.BILL_TO_CUST_ACCT_CD  = DACP.DS_ACCT_NUM (+)
            AND DACP.EZCANCELFLAG(+)     = '0'

<!-- 2017/08/04 S21_NA#15606 Mod Start -->
            AND DACP.GLBL_CMPY_CD        = CRC_A.GLBL_CMPY_CD(+)
            AND DACP.CR_RISK_CLS_CD      = CRC_A.CR_RISK_CLS_CD(+)
            AND CRC_A.EZCANCELFLAG(+)    = '0'
<!-- 2017/08/04 S21_NA#15606 Mod End -->
            AND C.SELL_TO_CUST_CD        = DAC.SELL_TO_CUST_CD(+)
            AND C.GLBL_CMPY_CD           = DAC.GLBL_CMPY_CD(+)
            AND DAC.EZCANCELFLAG(+)      = '0'

            AND DAC.DS_CLT_ACCT_STS_CD   = DCAS.DS_CLT_ACCT_STS_CD(+)
            AND C.GLBL_CMPY_CD           = DCAS.GLBL_CMPY_CD(+)
            AND DCAS.EZCANCELFLAG(+)     = '0'

            AND DACP.GLBL_CMPY_CD        = CRC_B.GLBL_CMPY_CD(+)
            AND DACP.CONTR_CR_RISK_CLS_CD      = CRC_B.CONTR_CR_RISK_CLS_CD(+)
            AND CRC_B.EZCANCELFLAG(+)    = '0'
    </statement>

    <statement id="getCreditApvlArData" parameterClass="Map" resultClass="Map">
        SELECT
            SUM(ATB.DEAL_RMNG_BAL_GRS_AMT)          AS ACCT_OPEN_AR_AMT
<!-- START 2018/07/24 Y.Matsui [QC#26798,MOD] -->
          , NVL(TO_DATE(#slsDt#, 'YYYYMMDD') - TO_DATE(MIN(
                CASE
                    <!-- START 2021/10/18 F.Deola [QC#59060,MOD] -->
                    <!-- WHEN TO_CHAR(TO_DATE(INV_DUE_DT,'YYYYMMDD') + #gracePerDaysAot# ,'YYYYMMDD') &lt;= #slsDt# -->
                    WHEN TO_CHAR(TO_DATE(INV_DUE_DT,'YYYYMMDD') ,'YYYYMMDD') &lt;= #slsDt#
                    <!-- END 2021/10/18 F.Deola [QC#59060,MOD] -->
                     AND ATB.DEAL_RMNG_BAL_GRS_AMT    != 0
                     <!-- START 2019/01/15 H.Ikeda [QC#29913,ADD] -->
                     <!-- Start 2023/2/20 S.Nakatani [QC#61168, MOD]-->
                     <!-- AND (ATB.AR_TRX_TP_CD = #arTrxTpInv# OR ATB.AR_TRX_TP_CD = #arTrxTpDed#) -->
                     AND ATB.AR_TRX_TP_CD = #arTrxTpInv#
                     <!-- End 2023/2/20 S.Nakatani [QC#61168, MOD]-->
                     <!-- END   2019/01/15 H.Ikeda [QC#29913,ADD] -->
                    THEN INV_DUE_DT
                    ELSE NULL
                END
          ), 'YYYYMMDD'), 0)    AS ACCT_PAST_DUE_BY
<!-- END   2018/07/24 Y.Matsui [QC#26798,MOD] -->
          , SUM(
                CASE
                    <!-- START 2021/10/18 F.Deola [QC#59060,MOD] -->
                    <!-- WHEN TO_CHAR(TO_DATE(INV_DUE_DT,'YYYYMMDD') + #gracePerDaysAot# ,'YYYYMMDD') &lt;= #slsDt# -->
                    WHEN TO_CHAR(TO_DATE(INV_DUE_DT,'YYYYMMDD') ,'YYYYMMDD') &lt;= #slsDt#
                    <!-- END 2021/10/18 F.Deola [QC#59060,MOD] -->
                     <!-- START 2019/01/15 H.Ikeda [QC#29913,MOD] -->
                     <!-- AND ATB.AR_TRX_TP_CD   &lt;&gt; #arTrxTpCrm# -->
                     AND (ATB.AR_TRX_TP_CD = #arTrxTpInv# OR ATB.AR_TRX_TP_CD = #arTrxTpDed#)
                     <!-- END   2019/01/15 H.Ikeda [QC#29913,MOD] -->
                    THEN ATB.DEAL_RMNG_BAL_GRS_AMT
                    ELSE 0
                END
          )                 AS ACCT_PAST_DUE_AMT
        FROM
            AR_TRX_BAL ATB
        WHERE
              ATB.GLBL_CMPY_CD           = #glblCmpyCd#
          AND ATB.AR_CASH_APPLY_STS_CD  IN (#arCashApplyStsUnapplied#, #arCashApplyStsPartial#)
          AND ATB.AR_TRX_TP_CD           &lt;&gt; #arTrxTpRcp#
          AND ATB.EZCANCELFLAG           = '0'
          AND ATB.BILL_TO_CUST_ACCT_CD = #billToCustAcctCd#
   </statement>

    <statement id="aggrigateBuyoutAmount"  parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SUM(CD.ENT_CPO_DTL_DEAL_NET_AMT) AS CHK_RQST_TOT_AMT
        FROM
            HLD         H
          , CPO_DTL     CD
        WHERE
                H.GLBL_CMPY_CD            = #glblCmpyCd#
            AND H.CPO_ORD_NUM             = #cpoOrdNum#
            AND H.HLD_RSN_CD              = #hldRsnCd#
            AND H.EZCANCELFLAG            = '0'

            AND H.GLBL_CMPY_CD            = CD.GLBL_CMPY_CD
            AND H.CPO_ORD_NUM             = CD.CPO_ORD_NUM
            AND H.CPO_DTL_LINE_NUM        = CD.CPO_DTL_LINE_NUM
            AND H.CPO_DTL_LINE_SUB_NUM    = CD.CPO_DTL_LINE_SUB_NUM
            AND CD.EZCANCELFLAG           = '0'
    </statement>

    <statement id="getByotApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM
          , C.CPO_ORD_TS
          , DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM   AS CATG_RSN
          , T.COA_EXTN_CD || '. ' || CE.COA_EXTN_NM || '/' || T.COA_BR_CD || ', ' || CB.COA_BR_NM
                                                            AS BUS_UNIT_BR
          , DAC.DS_ACCT_NM
          <!-- 2018/05/09 QC#20149 Add Start -->
          , DAC.SELL_TO_CUST_CD
          <!-- 2018/05/09 QC#20149 Add End -->
          , CONCAT(CD.DS_ORD_POSN_NUM, '.')
             || CONCAT(CD.DS_CPO_LINE_NUM, DECODE(CD.DS_CPO_LINE_SUB_NUM, NULL, '', '.'))
             || CD.DS_CPO_LINE_SUB_NUM      AS LINE_NUM
          , CD.ENT_CPO_DTL_DEAL_NET_AMT
          , ZONE_TBL.ORG_NM
          , ZONE_TBL.ORG_NM || '/' || NVL(CB.COA_BR_NM, '')     AS ZONE_BRANCH
          , CD.MDSE_CD
        FROM
            CPO             C
          , DS_ORD_CATG     DOC
          , DS_ORD_TP       DOT
          , TOC             T
          , COA_BR          CB
          , COA_EXTN        CE
          , SELL_TO_CUST    DAC
          , CPO_DTL         CD
          , (SELECT
                  A.TOC_CD
                  , CASE 
                    WHEN B.ATTR = A.FIRST_ORG_TIER_CD  THEN A.FIRST_ORG_NM 
                    WHEN B.ATTR = A.SCD_ORG_TIER_CD    THEN A.SCD_ORG_NM 
                    WHEN B.ATTR = A.THIRD_ORG_TIER_CD  THEN A.THIRD_ORG_NM 
                    WHEN B.ATTR = A.FRTH_ORG_TIER_CD   THEN A.FRTH_ORG_NM 
                    WHEN B.ATTR = A.FIFTH_ORG_TIER_CD  THEN A.FIFTH_ORG_NM 
                    WHEN B.ATTR = A.SIXTH_ORG_TIER_CD  THEN A.SIXTH_ORG_NM 
                    WHEN B.ATTR = A.SVNTH_ORG_TIER_CD  THEN A.SVNTH_ORG_NM 
                    WHEN B.ATTR = A.EIGHTH_ORG_TIER_CD THEN A.EIGHTH_ORG_NM 
                    WHEN B.ATTR = A.NINTH_ORG_TIER_CD  THEN A.NINTH_ORG_NM 
                    WHEN B.ATTR = A.TENTH_ORG_TIER_CD  THEN A.TENTH_ORG_NM 
                    WHEN B.ATTR = A.ELVTH_ORG_TIER_CD  THEN A.ELVTH_ORG_NM 
                    END     AS ORG_NM
             FROM
                S21_ORG A
                , (SELECT
                      ORG_TIER_CD ATTR
                   FROM
                      ORG_HRCH_STRU_DFN
                   WHERE
                          GLBL_CMPY_CD    = #glblCmpyCd#
                      AND ORG_STRU_TP_CD  = 'BOS'
                      AND BIZ_AREA_ORG_CD = '1'
                      AND EZCANCELFLAG    = '0'
                  ) B
             WHERE
                    1 = 1 
                AND B.ATTR IN (
                        SELECT
                            HRCH.ORG_TIER_CD 
                        FROM
                            ORG_HRCH_STRU_DFN   HRCH
                          , STRU_DFN            DFN
                          , ORG_STRU_TP         OS
                          , BIZ_AREA_ORG        BA 
                        WHERE
                              HRCH.GLBL_CMPY_CD     = #glblCmpyCd#
                          AND HRCH.EZCANCELFLAG     = '0' 

                          AND HRCH.GLBL_CMPY_CD     = DFN.GLBL_CMPY_CD
                          AND HRCH.STRU_DFN_CD      = DFN.STRU_DFN_CD 
                          AND DFN.ZN_FLG            = 'Y'
                          AND DFN.EZCANCELFLAG      = '0' 

                          AND HRCH.GLBL_CMPY_CD     = BA.GLBL_CMPY_CD
                          AND HRCH.BIZ_AREA_ORG_CD  = BA.BIZ_AREA_ORG_CD
                          AND BA.SLS_FLG            = 'Y' 
                          AND BA.EZCANCELFLAG       = '0' 
 
                          AND BA.GLBL_CMPY_CD       = OS.GLBL_CMPY_CD
                          AND BA.ORG_STRU_TP_CD     = OS.ORG_STRU_TP_CD 
                          AND OS.TRTY_STRU_FLG      = 'N' 
                          AND OS.EZCANCELFLAG       = '0' 
                  )
              ) ZONE_TBL 
        WHERE
                C.GLBL_CMPY_CD            = #glblCmpyCd#
            AND C.CPO_ORD_NUM             = #cpoOrdNum#
            AND C.EZCANCELFLAG            = '0'

            AND C.GLBL_CMPY_CD           = DOC.GLBL_CMPY_CD (+)
            AND C.DS_ORD_CATG_CD         = DOC.DS_ORD_CATG_CD (+)
            AND DOC.EZCANCELFLAG(+)       = '0'

            AND C.GLBL_CMPY_CD           = DOT.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD           = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+)       = '0'

            AND C.GLBL_CMPY_CD           = T.GLBL_CMPY_CD (+)
            AND C.SLS_REP_TOC_CD         = T.TOC_CD (+)
            AND T.EZCANCELFLAG(+)         = '0'

            AND T.GLBL_CMPY_CD            = CB.GLBL_CMPY_CD (+)
            AND T.COA_BR_CD               = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG(+)        = '0'

            AND T.GLBL_CMPY_CD            = CE.GLBL_CMPY_CD (+)
            AND T.COA_EXTN_CD             = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG(+)        = '0'

            AND C.GLBL_CMPY_CD            = DAC.GLBL_CMPY_CD(+)
            AND C.SELL_TO_CUST_CD         = DAC.SELL_TO_CUST_CD(+)
            AND C.EZCANCELFLAG(+)         = '0' 

            AND C.GLBL_CMPY_CD            = CD.GLBL_CMPY_CD
            AND C.CPO_ORD_NUM             = CD.CPO_ORD_NUM
            AND CD.CPO_DTL_LINE_NUM       = #cpoDtlLineNum#
            AND CD.CPO_DTL_LINE_SUB_NUM   = #cpoDtlLineSubNum#
            AND CD.EZCANCELFLAG           = '0' 

            AND C.SLS_REP_TOC_CD         = ZONE_TBL.TOC_CD(+)
    </statement>

    <statement id="getByotApvlLineData" parameterClass="Map" resultClass="Map">
        SELECT
            CONCAT(CD.DS_ORD_POSN_NUM, '.')
              || CONCAT(CD.DS_CPO_LINE_NUM, DECODE(CD.DS_CPO_LINE_SUB_NUM, NULL, '', '.'))
              || CD.DS_CPO_LINE_SUB_NUM        AS LINE_NUM
          , CD.MDSE_CD
          , CD.MDSE_NM
          , CD.ENT_CPO_DTL_DEAL_NET_AMT 
        FROM
            HLD         H
          , CPO_DTL     CD
        WHERE
              H.GLBL_CMPY_CD            = #glblCmpyCd#
          AND H.CPO_ORD_NUM             = #cpoOrdNum#
          AND H.CPO_DTL_LINE_NUM        = #cpoDtlLineNum#
          AND H.CPO_DTL_LINE_SUB_NUM    = #cpoDtlLineSubNum#
          AND H.HLD_RSN_CD              = #hldRsnCd#
          AND H.REL_FLG                 = #relFlgOff#
          AND H.EZCANCELFLAG            = '0'

          AND H.GLBL_CMPY_CD            = CD.GLBL_CMPY_CD 
          AND H.CPO_ORD_NUM             = CD.CPO_ORD_NUM 
          AND H.CPO_DTL_LINE_NUM        = CD.CPO_DTL_LINE_NUM 
          AND H.CPO_DTL_LINE_SUB_NUM    = CD.CPO_DTL_LINE_SUB_NUM 
          AND CD.EZCANCELFLAG           = '0' 
    </statement>

    <!-- 2016/10/11 QC#14974 ADD START -->
    <statement id="getOrdPrft" parameterClass="Map" resultClass="Map">
        SELECT
            OP.ALT_GRS_PRFT_PCT
           ,OP.GRS_PRFT_PCT
           ,OP.TOT_FUNC_FINAL_FL_AMT
           ,OP.TOT_FUNC_REP_REV_AMT
        FROM
            ORD_PRFT OP
        WHERE
            OP.GLBL_CMPY_CD     = #glblCmpyCd#
            AND OP.TRX_HDR_NUM  = #trxHdrNum#
            AND OP.EZCANCELFLAG = '0'
            AND NOT EXISTS (
                            SELECT
                                1
                            FROM
                                ORD_PRFT OP2
                            WHERE
                                OP.GLBL_CMPY_CD          = OP2.GLBL_CMPY_CD
                                AND OP.TRX_HDR_NUM       = OP2.TRX_HDR_NUM
                                AND OP.ORD_PRFT_VRSN_NUM &lt; OP2.ORD_PRFT_VRSN_NUM
                                AND OP2.EZCANCELFLAG     = '0'
                           )
    </statement>
    <!-- 2016/10/11 QC#14974 ADD E N D -->

    <!-- START 2018/07/24 Y.Matsui [QC#26798,ADD] -->
    <statement id="getLocalPoReqFlg" parameterClass="Map" resultClass="String">
        SELECT
            DS_PO_REQ_FLG
        FROM
            (
             SELECT
                 DCTR.DS_PO_REQ_FLG
             FROM
                 BILL_TO_CUST     BTC
                ,DS_CUST_TRX_RULE DCTR
             WHERE
                 BTC.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND BTC.BILL_TO_CUST_CD = #billToCustCd#
                 AND BTC.EZCANCELFLAG    = '0'

                 AND BTC.GLBL_CMPY_CD       = DCTR.GLBL_CMPY_CD
                 AND BTC.LOC_NUM            = DCTR.LOC_NUM
                 AND DCTR.DS_TRX_RULE_TP_CD = #dsTrxRuleTpCd#
                 AND DCTR.EZCANCELFLAG      = '0'
            )
        WHERE
            ROWNUM = 1
    </statement>
    <!-- END   2018/07/24 Y.Matsui [QC#26798,ADD] -->
    <!-- START 2019/02/05 E.Kameishi [QC#30163,ADD] -->
    <statement id="getCreditHoldRsn" parameterClass="Map" resultClass="Map">
        SELECT
             H.HLD_PK
            ,HR.HLD_RSN_CD
            ,HR.HLD_RSN_NM
        FROM
             CPO                 C
            ,DS_HLD_CTRL_ORD_TP  COT
            ,ORD_PROC_NODE       OPN
            ,HLD_RSN             HR
            ,HLD                 H
            ,DS_ORD_TP_PROC_DFN  OTP
        WHERE
                C.GLBL_CMPY_CD         = #glblCmpyCd#
            AND C.CPO_ORD_NUM          = #cpoOrdNum#
            AND C.EZCANCELFLAG         = '0'
            AND COT.GLBL_CMPY_CD       = C.GLBL_CMPY_CD
            AND COT.APPLY_DS_ORD_TP_CD = C.DS_ORD_TP_CD
            AND COT.EZCANCELFLAG       = '0'
            AND COT.GLBL_CMPY_CD       = HR.GLBL_CMPY_CD
            AND COT.HLD_RSN_CD         = HR.HLD_RSN_CD
            AND HR.ORD_PROC_NODE_CD    IS NOT NULL
            AND HR.HLD_EFF_FROM_DT     &lt;= #slsDt#
            AND (HR.HLD_EFF_TO_DT      &gt;= #slsDt#
                 OR HR.HLD_EFF_TO_DT       IS NULL
                )
            AND HR.EZCANCELFLAG        = '0'
            AND HR.HLD_TP_CD           = #creditHld#
            AND HR.ORD_PROC_NODE_CD    = #creditApproval#
            AND HR.GLBL_CMPY_CD        = OPN.GLBL_CMPY_CD
            AND HR.ORD_PROC_NODE_CD    = OPN.ORD_PROC_NODE_CD
            AND OPN.HLD_APPLY_AVAL_FLG = #hldApplyAvalFlg#
            AND OPN.EZCANCELFLAG       = '0'
            AND HR.GLBL_CMPY_CD        = H.GLBL_CMPY_CD(+)
            AND H.CPO_ORD_NUM(+)       = C.CPO_ORD_NUM
            AND H.REL_FLG(+)           = #relFlg#
            AND HR.HLD_RSN_CD          = H.HLD_RSN_CD(+)
            AND H.EZCANCELFLAG(+)      = '0'
            AND H.HLD_PK               IS NOT NULL
            AND C.GLBL_CMPY_CD         = OTP.GLBL_CMPY_CD
            AND C.DS_ORD_TP_CD         = OTP.DS_ORD_TP_CD
            AND OTP.EZCANCELFLAG       = '0'
        ORDER BY
             WF_HLD_SORT_NUM
    </statement>
    <!-- END 2019/02/05 E.Kameishi [QC#30163,ADD] -->


    <!-- add start 2023/04/25 QC#61337 -->
    <statement id="getManPrcApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
             C.CPO_ORD_NUM
            ,C.SELL_TO_CUST_CD
            ,C.ORD_TOT_DEAL_SUB_TOT_AMT
            ,C.ORD_TOT_DEAL_CHRG_AMT
            ,C.DS_ORD_CATG_CD
            ,C.DS_ORD_TP_CD
            ,C.LINE_BIZ_TP_CD
            ,C.SELL_TO_CUST_CD
            ,C.CPO_SRC_TP_CD
            ,C.CUST_ISS_PO_NUM
            ,C.DS_PMT_METH_CD
            ,C.SPCL_HDLG_TP_CD
            ,C.COA_BR_CD
            ,DAC.DS_ACCT_NM
            ,DOC.DS_ORD_CATG_NM
            ,DOT.DS_ORD_TP_NM
            ,DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM
                                            AS CATG_RSN
            ,T.COA_EXTN_CD || '. ' || CE.COA_EXTN_NM || '/' || T.COA_BR_CD || ', ' || CB.COA_BR_NM
                                            AS BUS_UNIT_BR
        FROM
             CPO_V               C
            ,SELL_TO_CUST        DAC
            ,DS_ORD_CATG         DOC
            ,DS_ORD_TP           DOT
            ,DS_ORD_TP_PROC_DFN  OTP
            ,TOC                 T
            ,COA_EXTN            CE
            ,COA_BR              CB
        WHERE
                C.GLBL_CMPY_CD         = #glblCmpyCd#
            AND C.CPO_ORD_NUM          = #cpoOrdNum#
            AND C.EZCANCELFLAG         = '0'

            AND C.GLBL_CMPY_CD         = DAC.GLBL_CMPY_CD (+)
            AND C.SELL_TO_CUST_CD      = DAC.SELL_TO_CUST_CD (+)
            AND DAC.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = DOC.GLBL_CMPY_CD (+)
            AND C.DS_ORD_CATG_CD       = DOC.DS_ORD_CATG_CD (+)
            AND DOC.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = DOT.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD         = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = OTP.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD         = OTP.DS_ORD_TP_CD (+)
            AND OTP.EZCANCELFLAG(+)    = '0'

            AND C.GLBL_CMPY_CD         = T.GLBL_CMPY_CD (+)
            AND C.SLS_REP_TOC_CD       = T.TOC_CD (+)
            AND T.EZCANCELFLAG(+)      = '0'

            AND T.GLBL_CMPY_CD         = CE.GLBL_CMPY_CD (+)
            AND T.COA_EXTN_CD          = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG(+)     = '0'

            AND T.GLBL_CMPY_CD         = CB.GLBL_CMPY_CD (+)
            AND T.COA_BR_CD            = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG(+)     = '0'
    </statement>

    <statement id="getManPrcApvlLineData" parameterClass="Map" resultClass="Map">
        SELECT
             CD.CPO_ORD_NUM
            ,CD.CPO_DTL_LINE_NUM
            ,CD.CPO_DTL_LINE_SUB_NUM
            ,CD.DPLY_LINE_NUM
            ,CD.MDSE_CD
            ,CD.MDSE_NM
            ,CD.PRC_BASE_DT
            ,CD.PRC_CATG_CD
            ,CD.CCY_CD
            ,CD.MDSE_CD
            ,CD.CUST_UOM_CD
            ,CD.DS_ORD_LINE_CATG_CD
            ,CD.ORD_QTY
            ,CD.ORD_CUST_UOM_QTY
            ,CD.FRT_COND_CD
            ,CD.SHPG_SVC_LVL_CD
            ,CD.FRT_CHRG_TO_CD
            ,CD.FRT_CHRG_METH_CD
            ,CD.CPO_DTL_DEAL_NET_AMT
            ,CF.DS_ORD_POSN_NUM
            ,CF.BILL_TO_CUST_ACCT_CD
            ,CF.BILL_TO_CUST_LOC_CD
            ,CF.SHIP_TO_CUST_ACCT_CD
            ,CF.SHIP_TO_CUST_LOC_CD
            ,CF.MDL_ID
            ,CF.SHIP_TO_CTY_ADDR
            ,CF.SHIP_TO_ST_CD
            ,CF.SHIP_TO_CTRY_CD
            ,CF.SHIP_TO_POST_CD
            ,CASE WHEN EXISTS (
                      SELECT
                          1
                      FROM
                          ORD_PRC_CALC_BASE A
                      WHERE
                              A.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
                          AND A.CPO_ORD_NUM          = CD.CPO_ORD_NUM
                          AND A.CPO_DTL_LINE_NUM     = CD.CPO_DTL_LINE_NUM
                          AND A.CPO_DTL_LINE_SUB_NUM = CD.CPO_DTL_LINE_SUB_NUM
                          AND A.EZCANCELFLAG         = 0
                          AND (
                                  (A.PRC_COND_TP_CD      = #prcCondTpManualPrice#)
                               OR
                                  (    A.PRC_DTL_GRP_CD  = #prcDtlGrpBasePrice#
                                   AND (   A.PRC_COND_MAN_ENTRY_FLG = 'Y'
                                        OR A.PRC_COND_MAN_ADD_FLG   = 'Y'
                                        OR A.PRC_COND_MAN_DEL_FLG   = 'Y')
                                  )
                              )
                      )
                  THEN 'Y' ELSE 'N'
             END MAN_PRC_CHNG_FLG
            ,CASE WHEN EXISTS (
                      SELECT
                          1
                      FROM
                          ORD_PRC_CALC_BASE A
                      WHERE
                              A.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
                          AND A.CPO_ORD_NUM          = CD.CPO_ORD_NUM
                          AND A.EZCANCELFLAG         = 0
                          <iterate property="prcDtlGrpCdList" var="prcDtlGrpCd[]" open="AND A.PRC_DTL_GRP_CD IN (" close=")" conjunction=",">
                             #prcDtlGrpCd[]#
                          </iterate>
                          AND (   A.PRC_COND_MAN_ENTRY_FLG = 'Y'
                               OR A.PRC_COND_MAN_ADD_FLG   = 'Y'
                               OR A.PRC_COND_MAN_DEL_FLG   = 'Y')
                      )
                  THEN 'Y' ELSE 'N'
             END MAN_CHRG_CHNG_FLG
        FROM
             CPO_DTL_V CD
            ,DS_CPO_CONFIG CF
        WHERE
                CD.GLBL_CMPY_CD    = #glblCmpyCd#
            AND CD.CPO_ORD_NUM     = #cpoOrdNum#
            AND CD.EZCANCELFLAG    = '0'
            AND CD.GLBL_CMPY_CD    = CF.GLBL_CMPY_CD
            AND CD.CPO_ORD_NUM     = CF.CPO_ORD_NUM
            AND CD.DS_ORD_POSN_NUM = CF.DS_ORD_POSN_NUM
            AND CF.EZCANCELFLAG    = '0'
        ORDER BY
             CD.CPO_ORD_NUM
            ,CD.CPO_DTL_LINE_NUM
            ,CD.CPO_DTL_LINE_SUB_NUM
    </statement>
    <!-- add end 2023/04/25 QC#61337 -->

    <!-- START 2023/09/13 S.Fujita [QC#61783,ADD] -->
    <statement id="getManPrcApvlTxtData" parameterClass="Map" resultClass="Map">
        SELECT
            SUBSTR(SQ.SPLY_QUOTE_CMNT_TXT, 0, 400) AS SPLY_QUOTE_CMNT_TXT
        FROM
            CPO C
           ,SPLY_QUOTE SQ
        WHERE
                C.GLBL_CMPY_CD    = #glblCmpyCd#
            AND C.CPO_ORD_NUM     = #cpoOrdNum#
            AND C.EZCANCELFLAG    = '0'
            AND C.CPO_SRC_TP_CD   = #ordSrcSupplyQuote#
            AND C.GLBL_CMPY_CD    = SQ.GLBL_CMPY_CD
            AND C.ORD_SRC_REF_NUM = SQ.SPLY_QUOTE_NUM
            AND SQ.EZCANCELFLAG   = '0'
            AND C.DS_CPO_CRAT_TS  = C.DS_CPO_UPD_TS
    </statement>
    <!-- END 2023/09/13 S.Fujita [QC#61783,ADD] -->

</sqlMap>