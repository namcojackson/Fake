<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NFBB119001">
   <statement id="getUpdateTargetData" parameterClass="Map" resultClass="Map">
   <!-- START 2018/03/19 T.Kikuhara [QC#20316,MOD] -->
     SELECT DISTINCT
            INLINE1.AP_VND_CD
           ,INLINE1.AP_VND_INV_NUM
           ,INLINE1.AP_VND_INV_SQ_NUM
           ,INLINE2.AP_PMT_CHK_NUM
           ,INLINE2.ARCS_PMT_STS_CD
           ,INLINE2.PMT_DT
            <!-- QC#21650 Upd Start -->
           ,INLINE2.AP_INV_AMT
            <!-- QC#21650 Upd End -->
           ,INLINE2.ARCS_PMT_METH_CD
       FROM
            CM_INV_ACCT_DIST INLINE1
           ,AP_INV_PMT INLINE2
           ,CM_AP_INV_HDR INLINE3
      WHERE
            INLINE1.EZCANCELFLAG = 0
        AND INLINE2.EZCANCELFLAG = 0
        AND INLINE3.EZCANCELFLAG = 0
        AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
        AND INLINE1.GLBL_CMPY_CD = INLINE2.GLBL_CMPY_CD
        AND INLINE1.GLBL_CMPY_CD = INLINE3.GLBL_CMPY_CD
        <!-- START 2018/01/26 T.Tokutomi [QC#18685,MOD] -->
        <!--       AND SUBSTR(INLINE2.EZUPTIME, 0 , 8) &gt;= #targetDate#  -->
        AND INLINE3.ACCT_INV_STS_CD IN
        <iterate property="acctInvStsCd" var="acctInvStsCdIn[]" open="(" close=")" conjunction=",">
            #acctInvStsCdIn[]#
        </iterate>
        <!-- END 2018/01/26 T.Tokutomi [QC#18685,MOD] -->
        AND INLINE2.ARCS_PMT_STS_CD IN
        <iterate property="arcsPmtStsCdList" var="arcsPmtStsCdIn[]" open="(" close=")" conjunction=",">
            #arcsPmtStsCdIn[]#
        </iterate>
        AND INLINE1.AP_VND_CD = INLINE2.AP_VND_CD
        AND INLINE1.AP_VND_INV_NUM = INLINE2.AP_VND_INV_NUM
        AND INLINE1.AP_VND_INV_SQ_NUM = INLINE2.AP_VND_INV_SQ_NUM
        AND INLINE1.AP_VND_CD = INLINE3.AP_VND_CD
        AND INLINE1.AP_VND_INV_NUM = INLINE3.AP_VND_INV_NUM
        AND INLINE1.AP_VND_INV_SQ_NUM = INLINE3.AP_VND_INV_SQ_NUM
   <!-- END 2018/03/19 T.Kikuhara [QC#20316,MOD] -->
   </statement>
</sqlMap> 