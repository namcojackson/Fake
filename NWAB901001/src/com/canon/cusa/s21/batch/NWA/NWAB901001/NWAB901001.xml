<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NWAB901001">

    <statement id="deleteWrkTbl" parameterClass="Map">
    	TRUNCATE TABLE OM_PURGE_ORD_TRGT_WRK
    </statement>

    <statement id="getBaseSQLList" parameterClass="Map">
        SELECT
            COND.ARC_COND_NM             AS SRC_TABLE_NM
           ,COND.SRC_RETEN_NUM_TP_CD     AS SRC_RETEN_NUM_TP_CD
           ,COND.SRC_RETEN_NUM           AS SRC_RETEN_NUM
           ,COND.SRC_SCHM_NM             AS SRC_SCHM_NM
           ,COND.ARC_COND_REF_TXT_02     AS BASE_SQL
        FROM
            ARC_COND COND
        WHERE
            COND.GLBL_CMPY_CD           = #glblCmpyCd#
        AND COND.ARC_COND_GRP_ID        = #pgId#
        <isNotNull property="trxSrcTpCd">
        AND COND.ARC_COND_REF_TXT_01    = #trxSrcTpCd#
        </isNotNull>
        AND COND.EZCANCELFLAG           = '0'
        ORDER BY
            ARC_COND_SORT_NUM
    </statement>

    <statement id="searchPurgeData" parameterClass="String">
     	$execSql$   
    </statement>

    <statement id="insertWrkTbl" parameterClass="Map">
    	INSERT INTO OM_PURGE_ORD_TRGT_WRK(
				EZTABLEID
				,EZCANCELFLAG
				,EZINTIME
				,EZINTIMEZONE
				,EZINCOMPANYCODE
				,EZINUSERID
				,EZINAPLID
				,EZUPTIME
				,EZUPTIMEZONE
				,EZUPCOMPANYCODE
				,EZUPUSERID
				,EZUPAPLID
				,GLBL_CMPY_CD
				,OM_PURGE_ORD_TRGT_WRK_PK
				,CPO_ORD_NUM
				,SHPG_PLN_NUM
				,PO_ORD_NUM
				,SO_NUM
			)
		VALUES(
			'OM_PURGE_ORD_TRGT_WRK'
			,'0'
			,#ezInTime#
			,#ezInTimeZone#
			,#ezInCompanyCode#
			,#ezInUserID#
			,#ezInAplID#
			,#ezUpTime#
			,#ezUpTimeZone#
			,#ezUpCompanyCode#
			,#ezUpUserID#
			,#ezUpAplID#
    		,#glblCmpyCd#
    		,OM_PURGE_ORD_TRGT_WRK_SQ.NEXTVAL
    		,#cpoOrdNum#
    		,#shpgPlnNum#
    		,#poOrdNum#
    		,#soNum#
    	)
    </statement>

</sqlMap>
