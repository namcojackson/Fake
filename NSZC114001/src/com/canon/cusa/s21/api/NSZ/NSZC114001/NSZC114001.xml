<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<sqlMap namespace="NSZC114001">
    <statement id="getInvInfo" parameterClass="Map" resultClass="Map">
        SELECT
             A.SELL_TO_CUST_CD
            ,A.SELL_TO_LOC_NM
            ,B.DS_CONTR_NUM
            ,D.SVC_CONTR_BR_DESC_TXT
        FROM
             INV            A
            ,SVC_INV        B
            ,SVC_MACH_MSTR  C
            ,SVC_CONTR_BR   D
        WHERE
                A.GLBL_CMPY_CD      = #glblCmpyCd#
            AND A.INV_NUM           = #invNum#
            AND A.EZCANCELFLAG      = '0'
            AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD (+)
            AND A.INV_NUM           = B.SVC_INV_NUM (+)
            AND B.EZCANCELFLAG (+)  = '0'
            AND B.GLBL_CMPY_CD      = C.GLBL_CMPY_CD (+)
            AND B.SVC_MACH_MSTR_PK  = C.SVC_MACH_MSTR_PK (+)
            AND C.EZCANCELFLAG (+)  = '0'
            AND C.GLBL_CMPY_CD      = D.GLBL_CMPY_CD (+)
            AND C.FLD_SVC_BR_CD     = D.SVC_CONTR_BR_CD (+)
            AND D.EZCANCELFLAG (+)  = '0'
    </statement>

    <statement id="countPoReq" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             COUNT(A.DS_CUST_TRX_RULE_PK) AS COUNT
        FROM
             DS_CUST_TRX_RULE   A
            ,BILL_TO_CUST       B
        WHERE
                A.GLBL_CMPY_CD       = #glblCmpyCd#
            AND A.DS_ACCT_NUM        = #dsAcctNum#
            AND A.DS_TRX_RULE_TP_CD  = #dsTrxRuleTpContract#
            AND A.DS_PO_REQ_FLG      = 'Y'
            AND A.EZCANCELFLAG       = '0'
            AND A.GLBL_CMPY_CD       = B.GLBL_CMPY_CD
            AND A.DS_ACCT_NUM        = B.SELL_TO_CUST_CD
            AND B.RGTN_STS_CD        = #rgtnStsP20#
            AND B.EZCANCELFLAG       = '0'
    </statement>
</sqlMap>
