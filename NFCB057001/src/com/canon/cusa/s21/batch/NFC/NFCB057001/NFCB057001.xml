<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NFCB057001">
    <statement id="getArStmtDt" parameterClass="Map" resultClass="String">
    SELECT
           ARSC.AR_STMT_DT
      FROM
           AR_STMT_CTRL      ARSC
          ,AR_STMT_ISS_CYCLE ASIC
     WHERE
           ASIC.GLBL_CMPY_CD         = #glblCmpyCd#
       AND ASIC.EZCANCELFLAG         = '0'
       AND ASIC.AR_STMT_ISS_ACTV_FLG = #actvFlgY#
       AND ASIC.GLBL_CMPY_CD         = ARSC.GLBL_CMPY_CD
       AND ASIC.AR_STMT_ISS_CYCLE_CD = ARSC.AR_STMT_ISS_CYCLE_CD
       AND ARSC.EZCANCELFLAG         = '0'
       AND TO_CHAR(TO_DATE(ARSC.AR_STMT_DT, 'YYYYMMDD') - ASIC.AR_DAYS_PRI_STMT_CRAT_NUM, 'YYYYMMDD') = #arAcctDt#
       AND ARSC.AR_STMT_STS_CD       = #arStmtStsCd#  
    </statement>

    <statement id="getEIPResultChk" parameterClass="Map" resultClass="Map">
    SELECT
        ER.EIP_RPT_RQST_PK
       ,ER.RPT_TTL_NM
       ,ER.RPT_RQST_STS_TXT
    FROM
        EIP_RPT_RQST ER
    WHERE
        ER.EZCANCELFLAG = '0'
    AND ER.GLBL_CMPY_CD = #glblCmpyCd#
    AND (ER.RPT_RQST_STS_TXT &lt;&gt; 'SUCCESS'
    OR ER.RPT_RQST_STS_TXT IS NULL)
    <!-- AND ER.RPT_RQST_STS_TXT = 'SUCCESS' -->
    AND ER.EIP_RPT_PROC_LOG_PK = #eipRptProcLogPk#
    </statement>

  <statement id="getEIPRptRqstPk" parameterClass="Map" resultClass="Map">
    SELECT
        ASI.EIP_RPT_RQST_PK
    FROM
        AR_STMT_INFO ASI
    WHERE
        ASI.EZCANCELFLAG = '0'
    AND ASI.GLBL_CMPY_CD = #glblCmpyCd#
    AND ASI.EIP_RPT_PROC_LOG_PK = #eipRptProcLogPk#
    </statement>

   <statement id="getSuccessEIPRptRqstPk" parameterClass="Map" resultClass="Map">
    SELECT
        ASI.EIP_RPT_RQST_PK
       ,ASI.STMT_SQ_PK
    FROM
        AR_STMT_INFO ASI
      , EIP_RPT_RQST ERR
    WHERE
        ASI.EZCANCELFLAG = '0'
    AND ASI.GLBL_CMPY_CD = #glblCmpyCd#
    AND ASI.EIP_RPT_PROC_LOG_PK = #eipRptProcLogPk#
    AND ASI.GLBL_CMPY_CD        = ERR.GLBL_CMPY_CD
    AND ASI.EIP_RPT_RQST_PK     = ERR.EIP_RPT_RQST_PK
    AND ERR.EZCANCELFLAG        = '0'
    AND ERR.RPT_RQST_STS_TXT    = 'SUCCESS'
    AND ASI.RPT_PRINT_OTPT_FLG  = 'Y'
    AND ASI.RPT_OTPT_CPLT_FLG   = #rptOtptCpltFlg#
    AND ASI.RPT_PRINT_RQST_CPLT_FLG = #rtPrintRqstCpltFlg#
    ORDER BY 
        ASI.STMT_SQ_PK
    </statement>

   <statement id="getEipRptProcLogPk" parameterClass="Map" resultClass="BigDecimal">
    SELECT
        MAX(ASI.EIP_RPT_PROC_LOG_PK) EIP_RPT_PROC_LOG_PK
    FROM
        AR_STMT_INFO ASI
    WHERE
        ASI.EZCANCELFLAG  = '0'
    AND ASI.GLBL_CMPY_CD  = #glblCmpyCd#
    AND ASI.STMT_PRINT_DT = #stmtPrintDt#
    AND ASI.RPT_PRINT_OTPT_FLG  = 'Y'
    </statement>

    <!-- START 2022/01/26 G.Delgado [QC#56682, ADD] -->
    <statement id="getEipRptRqstPkListToPrintComplete" parameterClass="Map" resultClass="Map">
    SELECT
        ASI.EIP_RPT_RQST_PK
    FROM
        AR_STMT_INFO ASI
    WHERE
        ASI.GLBL_CMPY_CD        = #glblCmpyCd#
    AND ASI.EIP_RPT_PROC_LOG_PK = #eipRptProcLogPk#
    AND NOT (
            ASI.RPT_EML_OTPT_FLG        = #rptEmlOtptFlg#
        AND ASI.RPT_PRINT_OTPT_FLG      = #rptPrintOtptFlg#
        AND ASI.RPT_OTPT_CPLT_FLG       = #rptOtptCpltFlg#
        AND ASI.RPT_PRINT_RQST_CPLT_FLG = #rptPrintRqstCpltFlg#
    )
    AND ASI.EZCANCELFLAG        = '0'
    GROUP BY
        ASI.EIP_RPT_RQST_PK
    ORDER BY
        ASI.EIP_RPT_RQST_PK
    </statement>
    <!-- END 2022/01/26 G.Delgado [QC#56682, ADD] -->

</sqlMap>
