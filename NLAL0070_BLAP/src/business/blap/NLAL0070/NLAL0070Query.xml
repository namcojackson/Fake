<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NLAL0070Query">

    <!-- *********************************************************** -->
    <!-- ********** Bean Definition ******************************** -->
    <!-- *********************************************************** -->
    <typeAlias alias="NLAL0070_ASMsg"    type="business.blap.NLAL0070.NLAL0070_ASMsg"/>
    <typeAlias alias="NLAL0070_BSMsg"    type="business.blap.NLAL0070.NLAL0070_BSMsg"/>
    <typeAlias alias="NLAL0070_CSMsg"    type="business.blap.NLAL0070.NLAL0070_CSMsg"/>
    <typeAlias alias="NLAL0070_DSMsg"    type="business.blap.NLAL0070.NLAL0070_DSMsg"/>
    <typeAlias alias="NLAL0070_GSMsg"    type="business.blap.NLAL0070.NLAL0070_GSMsg"/>
    <typeAlias alias="NLAL0070_HSMsg"    type="business.blap.NLAL0070.NLAL0070_HSMsg"/>
    
    <statement id="getScheduleList" parameterClass="Map" resultClass="Map">
     SELECT 
          WS_HDR.WH_SCHD_REF_KEY_NUM_SQ                    WH_SCHD_REF_KEY_NUM_SQ
         ,WS_HDR.INVTY_LOC_CD                              INVTY_LOC_CD
         ,WS_HDR.RWS_REF_NUM                               RWS_REF_NUM
         ,WS_HDR.IMPT_CNTNR_LOT_NUM                        IMPT_CNTNR_LOT_NUM
         ,WS_HDR.ASN_NUM                                   ASN_NUM
         ,WS_HDR.LGSC_DELY_TP_CD                           LGSC_DELY_TP_CD
         ,WS_HDR.LGSC_DELY_TP_NM                           LGSC_DELY_TP_NM
         ,WS_HDR.WH_IN_PRTY_FLG                            WH_IN_PRTY_FLG
         ,WS_HDR.INBD_VIS_EVENT_CD                         INBD_VIS_EVENT_CD
         ,IVE.INBD_VIS_EVENT_DESC_TXT                      INBD_VIS_EVENT_NM
         ,WS_HDR.IMPT_TRM_CD                               IMPT_TRM_CD
         ,WS_HDR.IMPT_TRM_ETA_DT                           IMPT_TRM_ETA_DT
         ,WS_HDR.LTST_WH_IN_ETA_DT                         LTST_WH_IN_ETA_DT
         ,WS_HDR.TEMP_WH_IN_ETA_DT                         TEMP_WH_IN_ETA_DT
         ,WS_HDR.SCHD_WH_IN_ETA_DT                         SCHD_WH_IN_ETA_DT
         ,WS_HDR.FINAL_WH_IN_ETA_DT                        FINAL_WH_IN_ETA_DT
         ,WS_HDR.RAIL_AVAL_DT                              RAIL_AVAL_DT
         ,WS_HDR.APPT_TM_TXT                               APPT_TM_TXT
         ,WS_HDR.APPT_DRYG_CARR_CD                         APPT_DRYG_CARR_CD
         ,WS_HDR.MDSE_CD                                   MDSE_CD
         ,MDSE.MDSE_DESC_SHORT_TXT                         MDSE_DESC_SHORT_TXT
         ,WS_QTY.REQ_STK_IN_QTY                            REQ_STK_IN_QTY
         ,DECODE(MSP.DMN_PKG_APVL_STS_CD,'SU','','NG')     MASTER_FLG
         ,WS_HDR.CARR_CD                                   CARR_CD
         ,VND.LOC_NM                                       LOC_NM
         ,WS_HDR.IMPT_INV_VESL_NM                          IMPT_INV_VESL_NM
         ,WS_HDR.IMPT_INV_BOL_NUM                          IMPT_INV_BOL_NUM
         ,WS_HDR.RWS_REF_NUM_A2                            RWS_REF_NUM_A2
         ,WS_HDR.RWS_STS_CD                                RWS_STS_CD
         ,WS_HDR.SCE_ORD_TP_CD                             SCE_ORD_TP_CD
         ,WS_HDR.SCHD_TP_CD                                SCHD_TP_CD
         ,WS_HDR.SCHD_TP_NM                                SCHD_TP_NM
         ,WS_HDR.ORG_WH_IN_ETA_DT                          ORG_WH_IN_ETA_DT
         ,TRM.IMPT_TRM_NM                                  IMPT_TRM_NM
         ,(
               SELECT
                    WS.INVTY_LOC_CD
               FROM
                    WH_SCHD  WS
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                    AND  WS.WH_SCHD_REF_KEY_NUM_SQ      =  WS_HDR.WH_SCHD_REF_KEY_NUM_SQ
                    AND  WS.INVTY_LOC_CD               !=  WS_HDR.INVTY_LOC_CD
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    <isEqual property="asnNotRcvFlg" compareValue="N">
                         AND  WS.ASN_NOT_RCV_FLG        =  #asnNotRcvFlg#
                    </isEqual>
                    AND  ROWNUM                      &lt;  2
          )     AS  MULTI_WH_CD
         ,WS_HDR.SCHD_DT                                   SCHD_DT
         ,WS_HDR.FINAL_DT                                  FINAL_DT
         ,WS_HDR.WH_SCHD_CMNT_TXT                          WH_SCHD_CMNT_TXT
         ,WS_HDR.EZUPTIME                                  EZUPTIME
         ,WS_HDR.IMPT_INV_LCL_FLG                          IMPT_INV_LCL_FLG
         ,WS_HDR.IMPT_INV_NUM                              IMPT_INV_NUM
         ,WS_HDR.IMPT_INV_CNSGN_CD                         IMPT_INV_CNSGN_CD
         ,WS_HDR.IMPT_CNTNR_NUM                            IMPT_CNTNR_NUM
         ,WS_HDR.INLND_SHPG_METH_CD                        INLND_SHPG_METH_CD
         ,WS_HDR.SHPG_METH_TP_CD                           SHPG_METH_TP_CD
         ,IIL.IMPT_TRM_TO_WH_DAYS_AOT                      IMPT_TRM_TO_WH_DAYS_AOT
     FROM
          (
               SELECT
                    WS.GLBL_CMPY_CD                        GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                        INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ              WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT                    ORG_WH_IN_ETA_DT
                   ,MAX(WS.RWS_REF_NUM)                    RWS_REF_NUM
                   ,MAX(WS.IMPT_CNTNR_LOT_NUM)             IMPT_CNTNR_LOT_NUM
                   ,MAX(WS.ASN_NUM)                        ASN_NUM
                   ,MAX(WS.LGSC_DELY_TP_CD)                LGSC_DELY_TP_CD
                   ,MAX(LD.LGSC_DELY_TP_NM)                LGSC_DELY_TP_NM
                   ,MAX(WS.WH_IN_PRTY_FLG)                 WH_IN_PRTY_FLG
                   ,MAX(WS.INBD_VIS_EVENT_CD)              INBD_VIS_EVENT_CD
                   ,MAX(WS.IMPT_TRM_CD)                    IMPT_TRM_CD
                   ,MAX(WS.IMPT_TRM_ETA_DT)                IMPT_TRM_ETA_DT
                   ,MAX(WS.LTST_WH_IN_ETA_DT)              LTST_WH_IN_ETA_DT
                   ,MAX(WS.TEMP_WH_IN_ETA_DT)              TEMP_WH_IN_ETA_DT
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)              SCHD_WH_IN_ETA_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)             FINAL_WH_IN_ETA_DT
                   ,MAX(WS.RAIL_AVAL_DT)                   RAIL_AVAL_DT
                   ,MAX(WS.APPT_TM_TXT)                    APPT_TM_TXT
                   ,MAX(WS.APPT_DRYG_CARR_CD)              APPT_DRYG_CARR_CD
                   ,MIN(WS.MDSE_CD)                        MDSE_CD
                   ,MAX(WS.CARR_CD)                        CARR_CD
                   ,MAX(WS.IMPT_INV_VESL_NM)               IMPT_INV_VESL_NM
                   ,MAX(WS.IMPT_INV_BOL_NUM)               IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN MAX(RH.RWS_NUM) IS NOT NULL 
                        THEN MAX(WS.RWS_REF_NUM) 
                        ELSE NULL
                    END                                    RWS_REF_NUM_A2
                   ,MAX(WS.SCE_ORD_TP_CD)                  SCE_ORD_TP_CD
                   ,MIN(NVL(RH.RWS_STS_CD,'00'))           RWS_STS_CD
                   ,MAX(WS.SCHD_TP_CD)                     SCHD_TP_CD
                   ,MAX(ST.SCHD_TP_NM)                     SCHD_TP_NM
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)              SCHD_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)             FINAL_DT
                   ,MAX(WS.WH_SCHD_CMNT_TXT)               WH_SCHD_CMNT_TXT
                   ,MAX(
                       TO_CHAR(NEW_TIME(
                            TO_TIMESTAMP(WS.EZUPTIME, 'YYYYMMDDHH24MISSFF3')
                           ,WS.EZUPTIMEZONE
                           ,'GMT')
                       ,'YYYYMMDDHH24MISS'
                    ) || SUBSTR(WS.EZUPTIME, 15, 3))       EZUPTIME
                   ,MAX(II.IMPT_INV_LCL_FLG)               IMPT_INV_LCL_FLG
                   ,MAX(WS.IMPT_INV_NUM)                   IMPT_INV_NUM
                   ,MAX(II.IMPT_INV_CNSGN_CD)              IMPT_INV_CNSGN_CD
                   ,''                                     IMPT_CNTNR_NUM
                   ,''                                     INLND_SHPG_METH_CD
                   ,MAX(IISM.SHPG_METH_TP_CD)              SHPG_METH_TP_CD
               FROM 
                    WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,IMPT_INV_SHPG_METH   IISM
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    <isNotNull property="locRoleTp">
                    AND WS.INVTY_LOC_CD IN(
                        SELECT
                            B.INVTY_LOC_CD
                        FROM
                            LOC_USG         A
                            ,DS_INVTY_LOC_V B
                        WHERE
                            A.GLBL_CMPY_CD       = #glblCmpyCd#
                            AND A.EZCANCELFLAG   = '0'
                            <iterate property="locRoleTp" var="elem[]" open="AND A.LOC_ROLE_TP_CD IN (" close=")" conjunction=",">
                                #elem[]#
                            </iterate>
                            AND A.GLBL_CMPY_CD   = B.GLBL_CMPY_CD
                            AND A.PTY_LOC_PK     = B.PTY_LOC_PK
                            AND B.EZCANCELFLAG   = '0'
                            AND B.RGTN_STS_CD    = #rgtnStsCd#
                            <iterate property="dataSecurityWh" var="elem[]" open="AND B.INVTY_LOC_CD IN (" close=")" conjunction=",">
                                #elem[]#
                            </iterate>
                        <isNull property="dataSecurityWh">
                        UNION ALL
                        SELECT
                            C.INVTY_LOC_CD
                        FROM
                            DS_INVTY_LOC_V C
                        WHERE
                            C.GLBL_CMPY_CD       = #glblCmpyCd#
                            AND C.EZCANCELFLAG   = '0'
                            AND C.WH_SYS_TP_CD   = #whSysTpCd#
                        </isNull>
                        )
                    </isNotNull>
                    <iterate property="invtyLocCd" var="elem[]" open="AND WS.INVTY_LOC_CD IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    <isEqual property="asnNotRcvFlg" compareValue="N">
                         AND  WS.ASN_NOT_RCV_FLG        =  #asnNotRcvFlg#
                    </isEqual>
                    AND  WS.SCE_ORD_TP_CD              IN (#sceOrdTpCd01#
                                                          ,#sceOrdTpCd02#)
                    <isNotNull property="rwsRefNum">
                         AND  WS.RWS_REF_NUM         LIKE  #rwsRefNum#
                    </isNotNull>
                    <isNotNull property="mdseCd">
                         AND  WS.MDSE_CD                =  #mdseCd#
                    </isNotNull>
                    <isNotNull property="schdTpCd">
                         AND  WS.SCHD_TP_CD             =  #schdTpCd#
                    </isNotNull>
                    <isNotNull property="imptInvNum">
                         AND  WS.IMPT_INV_NUM        LIKE  #imptInvNum#
                    </isNotNull>
                    <isNotNull property="carrCd">
                         AND  WS.CARR_CD                =  #carrCd#
                    </isNotNull>
                    AND  WS.EZCANCELFLAG                =  '0'
                    AND  WS.GLBL_CMPY_CD                =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG      =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                =  '0'
                    AND  II.GLBL_CMPY_CD                =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD       =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG              =  '0'
                    AND  WS.RWS_REF_NUM                 =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD             =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                  =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)             =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT
               UNION
               SELECT
                    WS.GLBL_CMPY_CD                                           GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                                           INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ                                 WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT                                       ORG_WH_IN_ETA_DT
                   ,MAX(WS.RWS_REF_NUM)                                       RWS_REF_NUM
                   ,MAX(WS.IMPT_CNTNR_LOT_NUM)                                IMPT_CNTNR_LOT_NUM
                   ,MAX(WS.ASN_NUM)                                           ASN_NUM
                   ,MAX(WS.LGSC_DELY_TP_CD)                                   LGSC_DELY_TP_CD
                   ,MAX(LD.LGSC_DELY_TP_NM)                                   LGSC_DELY_TP_NM
                   ,MAX(WS.WH_IN_PRTY_FLG)                                    WH_IN_PRTY_FLG
                   ,MAX(WS.INBD_VIS_EVENT_CD)                                 INBD_VIS_EVENT_CD
                   ,MAX(WS.IMPT_TRM_CD)                                       IMPT_TRM_CD
                   ,MAX(WS.IMPT_TRM_ETA_DT)                                   IMPT_TRM_ETA_DT
                   ,MAX(WS.LTST_WH_IN_ETA_DT)                                 LTST_WH_IN_ETA_DT
                   ,MAX(WS.TEMP_WH_IN_ETA_DT)                                 TEMP_WH_IN_ETA_DT
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)                                 SCHD_WH_IN_ETA_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)                                FINAL_WH_IN_ETA_DT
                   ,MAX(WS.RAIL_AVAL_DT)                                      RAIL_AVAL_DT
                   ,MAX(WS.APPT_TM_TXT)                                       APPT_TM_TXT
                   ,MAX(WS.APPT_DRYG_CARR_CD)                                 APPT_DRYG_CARR_CD
                   ,MIN(WS.MDSE_CD)                                           MDSE_CD
                   ,MAX(WS.CARR_CD)                                           CARR_CD
                   ,MAX(WS.IMPT_INV_VESL_NM)                                  IMPT_INV_VESL_NM
                   ,MAX(WS.IMPT_INV_BOL_NUM)                                  IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN MAX(RH.RWS_NUM) IS NOT NULL 
                        THEN MAX(WS.RWS_REF_NUM) 
                        ELSE NULL
                    END                                                       RWS_REF_NUM_A2
                   ,MAX(WS.SCE_ORD_TP_CD)                                     SCE_ORD_TP_CD
                   ,MIN(NVL(RH.RWS_STS_CD,'00'))                              RWS_STS_CD
                   ,MAX(WS.SCHD_TP_CD)                                        SCHD_TP_CD
                   ,MAX(ST.SCHD_TP_NM)                                        SCHD_TP_NM
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)                                 SCHD_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)                                FINAL_DT
                   ,MAX(WS.WH_SCHD_CMNT_TXT)                                  WH_SCHD_CMNT_TXT
                   ,MAX(
                       TO_CHAR(NEW_TIME(
                            TO_TIMESTAMP(WS.EZUPTIME, 'YYYYMMDDHH24MISSFF3')
                           ,WS.EZUPTIMEZONE
                           ,'GMT')
                       ,'YYYYMMDDHH24MISS'
                    ) || SUBSTR(WS.EZUPTIME, 15, 3))                          EZUPTIME
                   ,MAX(II.IMPT_INV_LCL_FLG)                                  IMPT_INV_LCL_FLG
                   ,MAX(WS.IMPT_INV_NUM)                                      IMPT_INV_NUM
                   ,MAX(II.IMPT_INV_CNSGN_CD)                                 IMPT_INV_CNSGN_CD
                   ,MAX(LS.IMPT_CNTNR_NUM)                                    IMPT_CNTNR_NUM
                   ,MAX(NVL(TC.INLND_SHPG_METH_CD,LS.INLND_SHPG_METH_CD))     INLND_SHPG_METH_CD
                   ,MAX(IISM.SHPG_METH_TP_CD)                                 SHPG_METH_TP_CD
               FROM 
                    WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,LGSC_SCP_ORD_DTL     LS
                   ,IMPT_INV_SHPG_METH   IISM
                   ,TRUCK_CNTNR          TC
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    <isNotNull property="locRoleTp">
                    AND WS.INVTY_LOC_CD IN(
                        SELECT
                            B.INVTY_LOC_CD
                        FROM
                            LOC_USG         A
                            ,DS_INVTY_LOC_V B
                        WHERE
                            A.GLBL_CMPY_CD       = #glblCmpyCd#
                            AND A.EZCANCELFLAG   = '0'
                            <iterate property="locRoleTp" var="elem[]" open="AND A.LOC_ROLE_TP_CD IN (" close=")" conjunction=",">
                                #elem[]#
                            </iterate>
                            AND A.GLBL_CMPY_CD   = B.GLBL_CMPY_CD
                            AND A.PTY_LOC_PK     = B.PTY_LOC_PK
                            AND B.EZCANCELFLAG   = '0'
                            AND B.RGTN_STS_CD    = #rgtnStsCd#
                            <iterate property="dataSecurityWh" var="elem[]" open="AND B.INVTY_LOC_CD IN (" close=")" conjunction=",">
                                #elem[]#
                            </iterate>
                        <isNull property="dataSecurityWh">
                        UNION ALL
                        SELECT
                            C.INVTY_LOC_CD
                        FROM
                            DS_INVTY_LOC_V C
                        WHERE
                            C.GLBL_CMPY_CD       = #glblCmpyCd#
                            AND C.EZCANCELFLAG   = '0'
                            AND C.WH_SYS_TP_CD   = #whSysTpCd#
                        </isNull>
                        )
                    </isNotNull>
                    <iterate property="invtyLocCd" var="elem[]" open="AND WS.INVTY_LOC_CD IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    <isEqual property="asnNotRcvFlg" compareValue="N">
                         AND  WS.ASN_NOT_RCV_FLG        =  #asnNotRcvFlg#
                    </isEqual>
                    AND  WS.SCE_ORD_TP_CD              IN (#sceOrdTpCd03#)
                    <isNotNull property="rwsRefNum">
                         AND  WS.RWS_REF_NUM         LIKE  #rwsRefNum#
                    </isNotNull>
                    <isNotNull property="mdseCd">
                         AND  WS.MDSE_CD                =  #mdseCd#
                    </isNotNull>
                    <isNotNull property="schdTpCd">
                         AND  WS.SCHD_TP_CD             =  #schdTpCd#
                    </isNotNull>
                    <isNotNull property="imptInvNum">
                         AND  WS.IMPT_INV_NUM        LIKE  #imptInvNum#
                    </isNotNull>
                    <isNotNull property="carrCd">
                         AND  WS.CARR_CD                =  #carrCd#
                    </isNotNull>
                    AND  WS.EZCANCELFLAG                =  '0'
                    AND  WS.GLBL_CMPY_CD                =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG      =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                =  '0'
                    AND  II.GLBL_CMPY_CD                =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD       =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG              =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LS.GLBL_CMPY_CD
                    AND  WS.IMPT_PACK_SLP_STS_PK        =  LS.IMPT_PACK_SLP_STS_PK
                    AND  LS.EZCANCELFLAG                =  '0'
                    AND  WS.RWS_REF_NUM                 =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD             =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                  =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)             =  '0'
                    AND  LS.GLBL_CMPY_CD                =  TC.GLBL_CMPY_CD(+)
                    AND  LS.TRUCK_CNTNR_PK              =  TC.TRUCK_CNTNR_PK(+)
                    AND  TC.EZCANCELFLAG(+)             =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT
               UNION
               SELECT
                    WS.GLBL_CMPY_CD                                           GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                                           INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ                                 WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT                                       ORG_WH_IN_ETA_DT
                   ,MAX(WS.RWS_REF_NUM)                                       RWS_REF_NUM
                   ,MAX(WS.IMPT_CNTNR_LOT_NUM)                                IMPT_CNTNR_LOT_NUM
                   ,MAX(WS.ASN_NUM)                                           ASN_NUM
                   ,MAX(WS.LGSC_DELY_TP_CD)                                   LGSC_DELY_TP_CD
                   ,MAX(LD.LGSC_DELY_TP_NM)                                   LGSC_DELY_TP_NM
                   ,MAX(WS.WH_IN_PRTY_FLG)                                    WH_IN_PRTY_FLG
                   ,MAX(WS.INBD_VIS_EVENT_CD)                                 INBD_VIS_EVENT_CD
                   ,MAX(WS.IMPT_TRM_CD)                                       IMPT_TRM_CD
                   ,MAX(WS.IMPT_TRM_ETA_DT)                                   IMPT_TRM_ETA_DT
                   ,MAX(WS.LTST_WH_IN_ETA_DT)                                 LTST_WH_IN_ETA_DT
                   ,MAX(WS.TEMP_WH_IN_ETA_DT)                                 TEMP_WH_IN_ETA_DT
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)                                 SCHD_WH_IN_ETA_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)                                FINAL_WH_IN_ETA_DT
                   ,MAX(WS.RAIL_AVAL_DT)                                      RAIL_AVAL_DT
                   ,MAX(WS.APPT_TM_TXT)                                       APPT_TM_TXT
                   ,MAX(WS.APPT_DRYG_CARR_CD)                                 APPT_DRYG_CARR_CD
                   ,MIN(WS.MDSE_CD)                                           MDSE_CD
                   ,MAX(WS.CARR_CD)                                           CARR_CD
                   ,MAX(WS.IMPT_INV_VESL_NM)                                  IMPT_INV_VESL_NM
                   ,MAX(WS.IMPT_INV_BOL_NUM)                                  IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN MAX(RH.RWS_NUM) IS NOT NULL 
                        THEN MAX(WS.RWS_REF_NUM) 
                        ELSE NULL
                    END                                                       RWS_REF_NUM_A2
                   ,MAX(WS.SCE_ORD_TP_CD)                                     SCE_ORD_TP_CD
                   ,MIN(NVL(RH.RWS_STS_CD,'00'))                              RWS_STS_CD
                   ,MAX(WS.SCHD_TP_CD)                                        SCHD_TP_CD
                   ,MAX(ST.SCHD_TP_NM)                                        SCHD_TP_NM
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)                                 SCHD_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)                                FINAL_DT
                   ,MAX(WS.WH_SCHD_CMNT_TXT)                                  WH_SCHD_CMNT_TXT
                   ,MAX(
                       TO_CHAR(NEW_TIME(
                            TO_TIMESTAMP(WS.EZUPTIME, 'YYYYMMDDHH24MISSFF3')
                           ,WS.EZUPTIMEZONE
                           ,'GMT')
                       ,'YYYYMMDDHH24MISS'
                    ) || SUBSTR(WS.EZUPTIME, 15, 3))                          EZUPTIME
                   ,MAX(II.IMPT_INV_LCL_FLG)                                  IMPT_INV_LCL_FLG
                   ,MAX(II.IMPT_INV_NUM)                                      IMPT_INV_NUM
                   ,MAX(II.IMPT_INV_CNSGN_CD)                                 IMPT_INV_CNSGN_CD
                   ,MAX(WS.RWS_REF_NUM)                                       IMPT_CNTNR_NUM
                   ,MAX(LS_ISM.INLND_SHPG_METH_CD)                            INLND_SHPG_METH_CD
                   ,MAX(NVL(IISM.SHPG_METH_TP_CD,LS_ISM.SHPG_METH_TP_CD))     SHPG_METH_TP_CD
               FROM 
                    (
                         SELECT
                              LS.GLBL_CMPY_CD                GLBL_CMPY_CD
                             ,LS.IMPT_PACK_SLP_STS_PK        IMPT_PACK_SLP_STS_PK
                             ,ISM.INLND_SHPG_METH_CD         INLND_SHPG_METH_CD
                             ,ISM.SHPG_METH_TP_CD            SHPG_METH_TP_CD
                         FROM
                              LGSC_SCP_ORD_DTL  LS
                             ,INLND_SHPG_METH   ISM
                         WHERE
                                   LS.GLBL_CMPY_CD        =  ISM.GLBL_CMPY_CD
                              AND  LS.INLND_SHPG_METH_CD  =  ISM.INLND_SHPG_METH_CD
                              AND  LS.EZCANCELFLAG        =  '0'
                              AND  ISM.EZCANCELFLAG       =  '0'
                    )  LS_ISM
                   ,WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,IMPT_INV_SHPG_METH   IISM
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    <iterate property="invtyLocCd" var="elem[]" open="AND WS.INVTY_LOC_CD IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    <isEqual property="asnNotRcvFlg" compareValue="N">
                         AND  WS.ASN_NOT_RCV_FLG        =  #asnNotRcvFlg#
                    </isEqual>
                    AND  WS.SCE_ORD_TP_CD              IN (#sceOrdTpCd04#
                                                          ,#sceOrdTpCd05#)
                    <isNotNull property="rwsRefNum">
                         AND  WS.RWS_REF_NUM         LIKE  #rwsRefNum#
                    </isNotNull>
                    <isNotNull property="mdseCd">
                         AND  WS.MDSE_CD                =  #mdseCd#
                    </isNotNull>
                    <isNotNull property="schdTpCd">
                         AND  WS.SCHD_TP_CD             =  #schdTpCd#
                    </isNotNull>
                    <isNotNull property="imptInvNum">
                         AND  WS.IMPT_INV_NUM        LIKE  #imptInvNum#
                    </isNotNull>
                    <isNotNull property="carrCd">
                         AND  WS.CARR_CD                =  #carrCd#
                    </isNotNull>
                    AND  WS.EZCANCELFLAG                =  '0'
                    AND  WS.GLBL_CMPY_CD                =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG      =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                =  '0'
                    AND  II.GLBL_CMPY_CD                =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD       =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG              =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LS_ISM.GLBL_CMPY_CD(+)
                    AND  WS.IMPT_PACK_SLP_STS_PK        =  LS_ISM.IMPT_PACK_SLP_STS_PK(+)
                    AND  WS.IMPT_CNTNR_LOT_NUM          =  RH.IMPT_CNTNR_LOT_NUM(+)
                    AND  WS.RWS_REF_NUM                 =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD             =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                  =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)             =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT
               UNION
               SELECT 
                    WS.GLBL_CMPY_CD                        GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                        INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ              WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT                    ORG_WH_IN_ETA_DT
                   ,MAX(WS.RWS_REF_NUM)                    RWS_REF_NUM
                   ,MAX(WS.IMPT_CNTNR_LOT_NUM)             IMPT_CNTNR_LOT_NUM
                   ,MAX(WS.ASN_NUM)                        ASN_NUM
                   ,MAX(WS.LGSC_DELY_TP_CD)                LGSC_DELY_TP_CD
                   ,MAX(LD.LGSC_DELY_TP_NM)                LGSC_DELY_TP_NM
                   ,MAX(WS.WH_IN_PRTY_FLG)                 WH_IN_PRTY_FLG
                   ,MAX(WS.INBD_VIS_EVENT_CD)              INBD_VIS_EVENT_CD
                   ,MAX(WS.IMPT_TRM_CD)                    IMPT_TRM_CD
                   ,MAX(WS.IMPT_TRM_ETA_DT)                IMPT_TRM_ETA_DT
                   ,MAX(WS.LTST_WH_IN_ETA_DT)              LTST_WH_IN_ETA_DT
                   ,MAX(WS.TEMP_WH_IN_ETA_DT)              TEMP_WH_IN_ETA_DT
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)              SCHD_WH_IN_ETA_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)             FINAL_WH_IN_ETA_DT
                   ,MAX(WS.RAIL_AVAL_DT)                   RAIL_AVAL_DT
                   ,MAX(WS.APPT_TM_TXT)                    APPT_TM_TXT
                   ,MAX(WS.APPT_DRYG_CARR_CD)              APPT_DRYG_CARR_CD
                   ,MIN(WS.MDSE_CD)                        MDSE_CD
                   ,MAX(WS.CARR_CD)                        CARR_CD
                   ,MAX(WS.IMPT_INV_VESL_NM)               IMPT_INV_VESL_NM
                   ,MAX(WS.IMPT_INV_BOL_NUM)               IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN MAX(RH.RWS_NUM) IS NOT NULL 
                        THEN MAX(WS.RWS_REF_NUM) 
                        ELSE NULL
                    END                                    RWS_REF_NUM_A2
                   ,MAX(WS.SCE_ORD_TP_CD)                  SCE_ORD_TP_CD
                   ,MIN(NVL(RH.RWS_STS_CD,'00'))           RWS_STS_CD
                   ,MAX(WS.SCHD_TP_CD)                     SCHD_TP_CD
                   ,MAX(ST.SCHD_TP_NM)                     SCHD_TP_NM
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)              SCHD_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)             FINAL_DT
                   ,MAX(WS.WH_SCHD_CMNT_TXT)               WH_SCHD_CMNT_TXT
                   ,MAX(
                       TO_CHAR(NEW_TIME(
                            TO_TIMESTAMP(WS.EZUPTIME, 'YYYYMMDDHH24MISSFF3')
                           ,WS.EZUPTIMEZONE
                           ,'GMT')
                       ,'YYYYMMDDHH24MISS'
                    ) || SUBSTR(WS.EZUPTIME, 15, 3))       EZUPTIME
                   ,MAX(II.IMPT_INV_LCL_FLG)               IMPT_INV_LCL_FLG
                   ,MAX(II.IMPT_INV_NUM)                   IMPT_INV_NUM
                   ,MAX(II.IMPT_INV_CNSGN_CD)              IMPT_INV_CNSGN_CD
                   ,''                                     IMPT_CNTNR_NUM
                   ,''                                     INLND_SHPG_METH_CD
                   ,''                                     SHPG_METH_TP_CD
               FROM 
                    WH_SCHD           WS
                   ,RWS_HDR           RH
                   ,LGSC_DELY_TP      LD
                   ,SCHD_TP           ST
                   ,IMPT_INV          II
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    <iterate property="invtyLocCd" var="elem[]" open="AND WS.INVTY_LOC_CD IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.INBD_SRC_TP_CD              =  #inbdSrcTpCd01#
                    <isEqual property="asnNotRcvFlg" compareValue="N">
                         AND  WS.ASN_NOT_RCV_FLG        =  #asnNotRcvFlg#
                    </isEqual>
                    <isNotNull property="rwsRefNum">
                         AND  WS.RWS_REF_NUM         LIKE  #rwsRefNum#
                    </isNotNull>
                    <isNotNull property="mdseCd">
                         AND  WS.MDSE_CD                =  #mdseCd#
                    </isNotNull>
                    <isNotNull property="schdTpCd">
                         AND  WS.SCHD_TP_CD             =  #schdTpCd#
                    </isNotNull>
                    <isNotNull property="imptInvNum">
                         AND  WS.IMPT_INV_NUM        LIKE  #imptInvNum#
                    </isNotNull>
                    <isNotNull property="carrCd">
                         AND  WS.CARR_CD                =  #carrCd#
                    </isNotNull>
                    AND  WS.EZCANCELFLAG                =  '0'
                    AND  WS.GLBL_CMPY_CD                =  II.GLBL_CMPY_CD(+)
                    AND  WS.IMPT_INV_NUM                =  II.IMPT_INV_NUM(+)
                    AND  II.IMPT_INV_ACTV_VRSN_FLG(+)   =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG(+)             =  '0'
                    AND  WS.PO_RCV_NUM                  =  RH.TRX_ORD_NUM(+)
                    AND  WS.GLBL_CMPY_CD                =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD             =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                  =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)             =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT
          )     WS_HDR
         ,(
               SELECT
                    WS.GLBL_CMPY_CD                        GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                        INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ              WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.MDSE_CD                             MDSE_CD
                   ,SUM(WS.REQ_STK_IN_QTY)                 REQ_STK_IN_QTY
               FROM 
                    WH_SCHD WS
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    <iterate property="invtyLocCd" var="elem[]" open="AND WS.INVTY_LOC_CD IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    <isEqual property="asnNotRcvFlg" compareValue="N">
                         AND  WS.ASN_NOT_RCV_FLG        =  #asnNotRcvFlg#
                    </isEqual>
                    <isNotNull property="scheTpCd">
                         AND  WS.SCHD_TP_CD             =  #scheTpCd#
                    </isNotNull>
                    AND  WS.EZCANCELFLAG                =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.MDSE_CD
          )     WS_QTY
         ,ALL_MDSE_V      MDSE
         ,MDSE_STORE_PKG  MSP
         ,VND             VND
         ,INBD_VIS_EVENT  IVE
         ,IMPT_TRM        TRM
         ,IMPT_INV_LT     IIL
     WHERE
              WS_HDR.GLBL_CMPY_CD            =  WS_QTY.GLBL_CMPY_CD
         AND  WS_HDR.INVTY_LOC_CD            =  WS_QTY.INVTY_LOC_CD
         AND  WS_HDR.WH_SCHD_REF_KEY_NUM_SQ  =  WS_QTY.WH_SCHD_REF_KEY_NUM_SQ
         AND  WS_HDR.MDSE_CD                 =  WS_QTY.MDSE_CD
         AND  WS_HDR.RWS_STS_CD             IN  (#rwsStsCd01#,#rwsStsCd02#,#rwsStsCd03#)
         <isEqual property="whInPrtyFlg" compareValue="Y">
              AND  WS_HDR.WH_IN_PRTY_FLG       =  #whInPrtyFlg#
         </isEqual>
         <isEqual property="imptInvLclFlg" compareValue="N">
              AND (
                        WS_HDR.IMPT_INV_LCL_FLG     =  #imptInvLclFlg#
                   OR   WS_HDR.IMPT_INV_LCL_FLG    IS  NULL
                  )
         </isEqual>
         AND  WS_HDR.GLBL_CMPY_CD            =  MDSE.GLBL_CMPY_CD(+)
         AND  WS_HDR.MDSE_CD                 =  MDSE.MDSE_CD(+)
         AND  MDSE.EZCANCELFLAG(+)           =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  MSP.GLBL_CMPY_CD(+)
         AND  WS_HDR.MDSE_CD                 =  MSP.MDSE_CD(+)
         AND  MSP.PKG_UOM_CD(+)              =  'EA'
         AND  MSP.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  VND.GLBL_CMPY_CD(+)
         AND  WS_HDR.CARR_CD                 =  VND.VND_CD(+)
         AND  VND.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  IVE.GLBL_CMPY_CD(+)
         AND  WS_HDR.INBD_VIS_EVENT_CD       =  IVE.INBD_VIS_EVENT_CD(+)
         AND  IVE.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  TRM.GLBL_CMPY_CD(+)
         AND  WS_HDR.IMPT_TRM_CD             =  TRM.IMPT_TRM_CD(+)
         AND  TRM.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  IIL.GLBL_CMPY_CD(+)
         AND  WS_HDR.INVTY_LOC_CD            =  IIL.INVTY_LOC_CD(+)
         AND  WS_HDR.IMPT_TRM_CD             =  IIL.IMPT_TRM_CD(+)
         AND  WS_HDR.SHPG_METH_TP_CD         =  IIL.SHPG_METH_TP_CD(+)
         AND  WS_HDR.IMPT_TRM_ETA_DT   BETWEEN  IIL.EFF_FROM_DT(+)  AND  NVL(IIL.EFF_THRU_DT(+), '99991231')
         AND  IIL.EZCANCELFLAG(+)            =  '0'
     ORDER BY
          INVTY_LOC_CD
         ,LTST_WH_IN_ETA_DT
         ,RWS_REF_NUM
         ,IMPT_CNTNR_LOT_NUM
         ,ASN_NUM
         ,ORG_WH_IN_ETA_DT
    </statement>

    <statement id="getSummaryList" parameterClass="Map" resultMap="result.getSummaryList">
		WITH WS_EVENT_MIN AS(
		    SELECT
		         WS.GLBL_CMPY_CD
		        ,WS.INVTY_LOC_CD
		        ,WS.SCHD_TP_CD
		        ,WS.IMPT_PACK_SLP_STS_PK
		        ,Count(WS.WH_SCHD_REF_KEY_NUM_SQ) AS WH_SCHD_REF_KEY_NUM_SQ
		        ,WS.PLT_QTY
		        ,WS.CSE_QTY
		        ,MIN(WS.INBD_VIS_EVENT_CD) AS INBD_VIS_EVENT_CD
		    FROM
		        WH_SCHD WS
		    WHERE
		            WS.GLBL_CMPY_CD     = #glblCmpyCd#
		        AND WS.EZCANCELFLAG     = '0'
            <isNotNull property="locRoleTp">
                AND WS.INVTY_LOC_CD IN(
                    SELECT
                        B.INVTY_LOC_CD
                    FROM
                        LOC_USG         A
                        ,DS_INVTY_LOC_V B
                    WHERE
                        A.GLBL_CMPY_CD       = #glblCmpyCd#
                        AND A.EZCANCELFLAG   = '0'
                        <iterate property="locRoleTp" var="elem[]" open="AND A.LOC_ROLE_TP_CD IN (" close=")" conjunction=",">
                            #elem[]#
                        </iterate>
                        AND A.GLBL_CMPY_CD   = B.GLBL_CMPY_CD
                        AND A.PTY_LOC_PK     = B.PTY_LOC_PK
                        AND B.EZCANCELFLAG   = '0'
                        AND B.RGTN_STS_CD    = #rgtnStsCd#
                        <iterate property="dataSecurityWh" var="elem[]" open="AND B.INVTY_LOC_CD IN (" close=")" conjunction=",">
                            #elem[]#
                        </iterate>
                    <isNull property="dataSecurityWh">
                    UNION ALL
                    SELECT
                        C.INVTY_LOC_CD
                    FROM
                        DS_INVTY_LOC_V C
                    WHERE
                        C.GLBL_CMPY_CD       = #glblCmpyCd#
                        AND C.EZCANCELFLAG   = '0'
                        AND C.WH_SYS_TP_CD   = #whSysTpCd#
                    </isNull>
                    )
            </isNotNull>
			<iterate property="invtyLocCd" var="elem[]" open="AND WS.INVTY_LOC_CD IN(" close=")" conjunction=",">
				#elem[]#
			</iterate>
		        AND WS.LTST_REC_FLG     = #ltstRecFlg#
		        AND WS.WH_CHNG_RQST_FLG = #whChngRqstFlg#
			<isNotNull property="scheTpCd">
			    AND WS.SCHD_TP_CD       = #scheTpCd#
			</isNotNull>
			<isEqual property="asnNotRcvFlg" compareValue="N">
			    AND WS.ASN_NOT_RCV_FLG  = #asnNotRcvFlg#
			</isEqual>
		        AND WS.REQ_STK_IN_QTY   > 0
		        AND NOT EXISTS
		            (
		            SELECT
		                'X'
		            FROM
		                RWS_HDR RH
		                ,RWS_DTL RD
		            WHERE
		                    RH.EZCANCELFLAG = '0'
		                AND RD.EZCANCELFLAG = '0'
		                AND RH.RWS_STS_CD IN (#rwsStsCd01#,#rwsStsCd02#)
		                AND RH.GLBL_CMPY_CD = WS.GLBL_CMPY_CD
		                AND RH.GLBL_CMPY_CD = RD.GLBL_CMPY_CD
		                AND RH.RWS_NUM      = RD.RWS_NUM
		                AND (
		                        (   WS.INBD_SRC_TP_CD IN (#inbdSrcTpCd01#,#inbdSrcTpCd02#,#inbdSrcTpCd03#,#inbdSrcTpCd04#) 
		                        AND RH.RWS_REF_NUM = WS.RWS_REF_NUM 
		                        AND RH.WH_CD = WS.INVTY_LOC_CD)
		                     OR 
		                        (   WS.INBD_SRC_TP_CD IN (#inbdSrcTpCd05#) 
		                        AND RH.TRX_ORD_NUM = WS.PO_RCV_NUM 
		                        AND RD.TRX_LINE_NUM = WS.PO_RCV_LINE_NUM)
		                    )
		            )
		    GROUP BY
		         WS.GLBL_CMPY_CD
		        ,WS.INVTY_LOC_CD
		        ,WS.SCHD_TP_CD
		        ,WS.IMPT_PACK_SLP_STS_PK
		        ,WS.PLT_QTY
		        ,WS.CSE_QTY
		) ,WS_DT_MAX AS(
		    SELECT
		         WS.IMPT_PACK_SLP_STS_PK
		        ,WS.INBD_VIS_EVENT_CD
		        ,MAX(WS.LTST_WH_IN_ETA_DT) AS LTST_WH_IN_ETA_DT
		    FROM
		        WH_SCHD WS
		    WHERE
		            WS.GLBL_CMPY_CD     = #glblCmpyCd#
		        AND WS.EZCANCELFLAG     = '0'
            <isNotNull property="locRoleTp">
                AND WS.INVTY_LOC_CD IN(
                    SELECT
                        B.INVTY_LOC_CD
                    FROM
                        LOC_USG         A
                        ,DS_INVTY_LOC_V B
                    WHERE
                        A.GLBL_CMPY_CD       = #glblCmpyCd#
                        AND A.EZCANCELFLAG   = '0'
                        <iterate property="locRoleTp" var="elem[]" open="AND A.LOC_ROLE_TP_CD IN (" close=")" conjunction=",">
                            #elem[]#
                        </iterate>
                        AND A.GLBL_CMPY_CD   = B.GLBL_CMPY_CD
                        AND A.PTY_LOC_PK     = B.PTY_LOC_PK
                        AND B.EZCANCELFLAG   = '0'
                        AND B.RGTN_STS_CD    = #rgtnStsCd#
                        <iterate property="dataSecurityWh" var="elem[]" open="AND B.INVTY_LOC_CD IN (" close=")" conjunction=",">
                            #elem[]#
                        </iterate>
                    <isNull property="dataSecurityWh">
                    UNION ALL
                    SELECT
                        C.INVTY_LOC_CD
                    FROM
                        DS_INVTY_LOC_V C
                    WHERE
                        C.GLBL_CMPY_CD       = #glblCmpyCd#
                        AND C.EZCANCELFLAG   = '0'
                        AND C.WH_SYS_TP_CD   = #whSysTpCd#
                    </isNull>
                    )
            </isNotNull>
			<iterate property="invtyLocCd" var="elem[]" open="AND WS.INVTY_LOC_CD IN(" close=")" conjunction=",">
				#elem[]#
			</iterate>
		        AND WS.LTST_REC_FLG     = #ltstRecFlg#
		        AND WS.WH_CHNG_RQST_FLG = #whChngRqstFlg#
			<isNotNull property="scheTpCd">
			    AND WS.SCHD_TP_CD       = #scheTpCd#
			</isNotNull>
			<isEqual property="asnNotRcvFlg" compareValue="N">
			    AND WS.ASN_NOT_RCV_FLG  = #asnNotRcvFlg#
			</isEqual>
		        AND WS.REQ_STK_IN_QTY   >= 0
		    GROUP BY
		        WS.IMPT_PACK_SLP_STS_PK
		        ,WS.INBD_VIS_EVENT_CD
		)
		SELECT
		     WS_EVENT_MIN.GLBL_CMPY_CD                           AS GLBL_CMPY_CD
		    ,WS_EVENT_MIN.INVTY_LOC_CD                           AS INVTY_LOC_CD
		    ,WS_EVENT_MIN.SCHD_TP_CD                             AS SCHD_TP_CD
		    ,ST.SCHD_TP_NM                                       AS SCHD_TP_NM
		    ,WS_DT_MAX.LTST_WH_IN_ETA_DT                         AS LTST_WH_IN_ETA_DT
		    ,COUNT(DISTINCT WS_EVENT_MIN.WH_SCHD_REF_KEY_NUM_SQ) AS RWS_QTY
		    ,SUM(WS_EVENT_MIN.PLT_QTY)                           AS PLT_QTY
		    ,SUM(WS_EVENT_MIN.CSE_QTY)                           AS CSE_QTY
		FROM
		     WS_EVENT_MIN
		    ,WS_DT_MAX
		    ,SCHD_TP ST
		WHERE
		        WS_DT_MAX.LTST_WH_IN_ETA_DT       BETWEEN #whEtaStart# AND #whEtaEnd#
		    AND WS_EVENT_MIN.IMPT_PACK_SLP_STS_PK = WS_DT_MAX.IMPT_PACK_SLP_STS_PK
		    AND WS_EVENT_MIN.INBD_VIS_EVENT_CD    = WS_DT_MAX.INBD_VIS_EVENT_CD
		    AND WS_EVENT_MIN.GLBL_CMPY_CD         = ST.GLBL_CMPY_CD(+)
		    AND WS_EVENT_MIN.SCHD_TP_CD           = ST.SCHD_TP_CD(+)
		    AND ST.EZCANCELFLAG(+)                = '0'
		GROUP BY
		     WS_EVENT_MIN.GLBL_CMPY_CD
		    ,WS_EVENT_MIN.INVTY_LOC_CD
		    ,WS_EVENT_MIN.SCHD_TP_CD
		    ,WS_DT_MAX.LTST_WH_IN_ETA_DT
		    ,ST.SCHD_TP_NM
		ORDER BY
		     WS_EVENT_MIN.INVTY_LOC_CD
		    ,WS_EVENT_MIN.SCHD_TP_CD
    </statement>
    <resultMap id="result.getSummaryList" class="NLAL0070_BSMsg">
        <result property="invtyLocCd_B1"               column="INVTY_LOC_CD"             javaType="EZDSStringItem"/>
        <result property="schdTpCd_B1"                 column="SCHD_TP_CD"               javaType="EZDSStringItem"/>
        <result property="schdTpNm_B1"                 column="SCHD_TP_NM"               javaType="EZDSStringItem"/>
        <result property="ltstWhInEtaDt_B1"            column="LTST_WH_IN_ETA_DT"        javaType="EZDSDateItem"/>
        <result property="rwsQty_BZ"                   column="RWS_QTY"                  javaType="EZDSStringItem"/>
        <result property="pltQty_BZ"                   column="PLT_QTY"                  javaType="EZDSStringItem"/>
        <result property="cseQty_BZ"                   column="CSE_QTY"                  javaType="EZDSStringItem"/>
    </resultMap>
    
    <statement id="getPullDownListCarrier" parameterClass="Map" resultMap="result.getPullDownListCarrier">
     SELECT
          VND.VND_CD   CARR_CD
         ,VND.LOC_NM   CARR_NM
     FROM
          VND          VND
         ,VND_TP_RELN  VTR
     WHERE
               VND.GLBL_CMPY_CD  =  #cMsg.glblCmpyCd_BK#
          AND  VND.RGTN_STS_CD   =  #rgtnStsCd#
          AND  VND.EZCANCELFLAG  =  '0'
          AND  VND.GLBL_CMPY_CD  =  VTR.GLBL_CMPY_CD
          AND  VND.VND_CD        =  VTR.VND_CD
          <iterate property="vndTpCd" var="elem[]" open="AND VTR.VND_TP_CD IN (" close=")" conjunction=",">
               #elem[]#
          </iterate>
          AND  VTR.EZCANCELFLAG  =  '0'
     ORDER BY
                VND.VND_CD ASC
    </statement>
    
    <resultMap id="result.getPullDownListCarrier" class="NLAL0070_CSMsg">
            <result property="carrCd_C1"           column="CARR_CD"          javaType="EZDSStringItem"/>
            <result property="carrNm_C1"           column="CARR_NM"          javaType="EZDSStringItem"/>
    </resultMap>
    

    <statement id="getApptCarrDrygList" parameterClass="Map" resultMap="result.getApptCarrDrygList">
     SELECT
          VND.VND_CD   APPTDRYGCARRCD_D1
         ,VND.LOC_NM   LOCNM_D1
     FROM
          VND          VND
         ,VND_TP_RELN  VTR
     WHERE
               VND.GLBL_CMPY_CD  =  #cMsg.glblCmpyCd_BK#
          AND  VND.RGTN_STS_CD   =  #rgtnStsCd#
          AND  VND.EZCANCELFLAG  =  '0'
          AND  VND.GLBL_CMPY_CD  =  VTR.GLBL_CMPY_CD
          AND  VND.VND_CD        =  VTR.VND_CD
          AND  VTR.VND_TP_CD     =  #vndTpCd#
          AND  VTR.EZCANCELFLAG  =  '0'
     ORDER BY
                VND.VND_CD ASC
    </statement>
    
    <resultMap id="result.getApptCarrDrygList" class="NLAL0070_DSMsg">
            <result property="apptDrygCarrCd_D1"           column="APPTDRYGCARRCD_D1"       javaType="EZDSStringItem"/>
            <result property="locNm_D1"                    column="LOCNM_D1"                javaType="EZDSStringItem"/>
    </resultMap>
    
    <statement id="getWhScheduleDownloadListForMdse" parameterClass="Map">
     SELECT 
          WS_HDR.WH_SCHD_REF_KEY_NUM_SQ                    WH_SCHD_REF_KEY_NUM_SQ
         ,WS_HDR.INVTY_LOC_CD                              INVTY_LOC_CD
         ,WS_HDR.RWS_REF_NUM                               RWS_REF_NUM
         ,WS_HDR.IMPT_CNTNR_LOT_NUM                        IMPT_CNTNR_LOT_NUM
         ,WS_HDR.ASN_NUM                                   ASN_NUM
         ,WS_HDR.LGSC_DELY_TP_CD                           LGSC_DELY_TP_CD
         ,WS_HDR.LGSC_DELY_TP_NM                           LGSC_DELY_TP_NM
         ,WS_HDR.WH_IN_PRTY_FLG                            WH_IN_PRTY_FLG
         ,WS_HDR.INBD_VIS_EVENT_CD                         INBD_VIS_EVENT_CD
         ,IVE.INBD_VIS_EVENT_DESC_TXT                      INBD_VIS_EVENT_NM
         ,WS_HDR.IMPT_TRM_CD                               IMPT_TRM_CD
         ,WS_HDR.IMPT_TRM_ETA_DT                           IMPT_TRM_ETA_DT
         ,WS_HDR.LTST_WH_IN_ETA_DT                         LTST_WH_IN_ETA_DT
         ,WS_HDR.TEMP_WH_IN_ETA_DT                         TEMP_WH_IN_ETA_DT
         ,WS_HDR.SCHD_WH_IN_ETA_DT                         SCHD_WH_IN_ETA_DT
         ,WS_HDR.FINAL_WH_IN_ETA_DT                        FINAL_WH_IN_ETA_DT
         ,WS_HDR.RAIL_AVAL_DT                              RAIL_AVAL_DT
         ,WS_HDR.APPT_TM_TXT                               APPT_TM_TXT
         ,WS_HDR.APPT_DRYG_CARR_CD                         APPT_DRYG_CARR_CD
         ,WS_HDR.MDSE_CD                                   MDSE_CD
         ,MDSE.MDSE_DESC_SHORT_TXT                         MDSE_DESC_SHORT_TXT
         ,SUM(WS_HDR.REQ_STK_IN_QTY)                       REQ_STK_IN_QTY
         ,DECODE(MSP.DMN_PKG_APVL_STS_CD,'SU','','NG')     MASTER_FLG
         ,WS_HDR.CARR_CD                                   CARR_CD
         ,VND.LOC_NM                                       LOC_NM
         ,WS_HDR.IMPT_INV_VESL_NM                          IMPT_INV_VESL_NM
         ,WS_HDR.IMPT_INV_BOL_NUM                          IMPT_INV_BOL_NUM
         ,WS_HDR.RWS_REF_NUM_E2                            RWS_REF_NUM_E2
         ,WS_HDR.RWS_STS_CD                                RWS_STS_CD
         ,WS_HDR.SCE_ORD_TP_CD                             SCE_ORD_TP_CD
         ,WS_HDR.SCHD_TP_CD                                SCHD_TP_CD
         ,WS_HDR.SCHD_TP_NM                                SCHD_TP_NM
         ,WS_HDR.ORG_WH_IN_ETA_DT                          ORG_WH_IN_ETA_DT
         ,TRM.IMPT_TRM_NM                                  IMPT_TRM_NM
         ,(
               SELECT
                    WS.INVTY_LOC_CD
               FROM
                    WH_SCHD  WS
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                    AND  WS.WH_SCHD_REF_KEY_NUM_SQ      =  WS_HDR.WH_SCHD_REF_KEY_NUM_SQ
                    AND  WS.INVTY_LOC_CD               !=  WS_HDR.INVTY_LOC_CD
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    AND  ROWNUM                      &lt;  2
          )     AS  MULTI_WH_CD
         ,WS_HDR.WH_SCHD_CMNT_TXT                          WH_SCHD_CMNT_TXT
         ,WS_HDR.IMPT_INV_NUM                              IMPT_INV_NUM
         ,WS_HDR.IMPT_CNTNR_NUM                            IMPT_CNTNR_NUM
         ,WS_HDR.IMPT_INV_CNSGN_CD                         IMPT_INV_CNSGN_CD
         ,WS_HDR.INLND_SHPG_METH_CD                        INLND_SHPG_METH_CD
         ,IIL.IMPT_TRM_TO_WH_DAYS_AOT                      IMPT_TRM_TO_WH_DAYS_AOT
     FROM
          (
               SELECT
                    WS.GLBL_CMPY_CD                        GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                        INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ              WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.RWS_REF_NUM                         RWS_REF_NUM
                   ,WS.IMPT_CNTNR_LOT_NUM                  IMPT_CNTNR_LOT_NUM
                   ,WS.ASN_NUM                             ASN_NUM
                   ,LD.LGSC_DELY_TP_CD                     LGSC_DELY_TP_CD
                   ,LD.LGSC_DELY_TP_NM                     LGSC_DELY_TP_NM
                   ,WS.WH_IN_PRTY_FLG                      WH_IN_PRTY_FLG
                   ,WS.INBD_VIS_EVENT_CD                   INBD_VIS_EVENT_CD
                   ,WS.IMPT_TRM_CD                         IMPT_TRM_CD
                   ,WS.IMPT_TRM_ETA_DT                     IMPT_TRM_ETA_DT
                   ,WS.LTST_WH_IN_ETA_DT                   LTST_WH_IN_ETA_DT
                   ,WS.TEMP_WH_IN_ETA_DT                   TEMP_WH_IN_ETA_DT
                   ,WS.SCHD_WH_IN_ETA_DT                   SCHD_WH_IN_ETA_DT
                   ,WS.FINAL_WH_IN_ETA_DT                  FINAL_WH_IN_ETA_DT
                   ,WS.RAIL_AVAL_DT                        RAIL_AVAL_DT
                   ,WS.APPT_TM_TXT                         APPT_TM_TXT
                   ,WS.APPT_DRYG_CARR_CD                   APPT_DRYG_CARR_CD
                   ,WS.MDSE_CD                             MDSE_CD
                   ,WS.CARR_CD                             CARR_CD
                   ,WS.IMPT_INV_VESL_NM                    IMPT_INV_VESL_NM
                   ,WS.IMPT_INV_BOL_NUM                    IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN RH.RWS_NUM IS NOT NULL 
                        THEN WS.RWS_REF_NUM 
                        ELSE NULL
                    END                                    RWS_REF_NUM_E2
                   ,WS.SCE_ORD_TP_CD                       SCE_ORD_TP_CD
                   ,NVL(RH.RWS_STS_CD,'00')                RWS_STS_CD
                   ,WS.SCHD_TP_CD                          SCHD_TP_CD
                   ,ST.SCHD_TP_NM                          SCHD_TP_NM
                   ,WS.WH_SCHD_CMNT_TXT                    WH_SCHD_CMNT_TXT
                   ,WS.ORG_WH_IN_ETA_DT                    ORG_WH_IN_ETA_DT
                   ,WS.REQ_STK_IN_QTY                      REQ_STK_IN_QTY
                   ,II.IMPT_INV_LCL_FLG                    IMPT_INV_LCL_FLG
                   ,II.IMPT_INV_CNSGN_CD                   IMPT_INV_CNSGN_CD
                   ,WS.IMPT_INV_NUM                        IMPT_INV_NUM
                   ,''                                     IMPT_CNTNR_NUM
                   ,''                                     INLND_SHPG_METH_CD
                   ,IISM.SHPG_METH_TP_CD                   SHPG_METH_TP_CD
               FROM 
                    WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,IMPT_INV_SHPG_METH   IISM
               WHERE
                         WS.GLBL_CMPY_CD                   =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                   =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.LTST_REC_FLG                   =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG               =  #whChngRqstFlg#
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.SCE_ORD_TP_CD                 IN (#sceOrdTpCd01#
                                                             ,#sceOrdTpCd02#)
                    <iterate property="rwsRefNumList" var="elem[]" open="AND  WS.RWS_REF_NUM IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.EZCANCELFLAG                   =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                   =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG         =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                   =  '0'
                    AND  II.GLBL_CMPY_CD                   =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD          =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG                 =  '0'
                    AND  WS.IMPT_CNTNR_LOT_NUM             =  RH.IMPT_CNTNR_LOT_NUM(+)
                    AND  WS.RWS_REF_NUM                    =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                   =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                   =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)                =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD                =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)                =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                     =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)                =  '0'
               UNION ALL
               SELECT
                    WS.GLBL_CMPY_CD                                           GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                                           INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ                                 WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.RWS_REF_NUM                                            RWS_REF_NUM
                   ,WS.IMPT_CNTNR_LOT_NUM                                     IMPT_CNTNR_LOT_NUM
                   ,WS.ASN_NUM                                                ASN_NUM
                   ,LD.LGSC_DELY_TP_CD                                        LGSC_DELY_TP_CD
                   ,LD.LGSC_DELY_TP_NM                                        LGSC_DELY_TP_NM
                   ,WS.WH_IN_PRTY_FLG                                         WH_IN_PRTY_FLG
                   ,WS.INBD_VIS_EVENT_CD                                      INBD_VIS_EVENT_CD
                   ,WS.IMPT_TRM_CD                                            IMPT_TRM_CD
                   ,WS.IMPT_TRM_ETA_DT                                        IMPT_TRM_ETA_DT
                   ,WS.LTST_WH_IN_ETA_DT                                      LTST_WH_IN_ETA_DT
                   ,WS.TEMP_WH_IN_ETA_DT                                      TEMP_WH_IN_ETA_DT
                   ,WS.SCHD_WH_IN_ETA_DT                                      SCHD_WH_IN_ETA_DT
                   ,WS.FINAL_WH_IN_ETA_DT                                     FINAL_WH_IN_ETA_DT
                   ,WS.RAIL_AVAL_DT                                           RAIL_AVAL_DT
                   ,WS.APPT_TM_TXT                                            APPT_TM_TXT
                   ,WS.APPT_DRYG_CARR_CD                                      APPT_DRYG_CARR_CD
                   ,WS.MDSE_CD                                                MDSE_CD
                   ,WS.CARR_CD                                                CARR_CD
                   ,WS.IMPT_INV_VESL_NM                                       IMPT_INV_VESL_NM
                   ,WS.IMPT_INV_BOL_NUM                                       IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN RH.RWS_NUM IS NOT NULL 
                        THEN WS.RWS_REF_NUM 
                        ELSE NULL
                    END                                                       RWS_REF_NUM_E2
                   ,WS.SCE_ORD_TP_CD                                          SCE_ORD_TP_CD
                   ,NVL(RH.RWS_STS_CD,'00')                                   RWS_STS_CD
                   ,WS.SCHD_TP_CD                                             SCHD_TP_CD
                   ,ST.SCHD_TP_NM                                             SCHD_TP_NM
                   ,WS.WH_SCHD_CMNT_TXT                                       WH_SCHD_CMNT_TXT
                   ,WS.ORG_WH_IN_ETA_DT                                       ORG_WH_IN_ETA_DT
                   ,WS.REQ_STK_IN_QTY                                         REQ_STK_IN_QTY
                   ,II.IMPT_INV_LCL_FLG                                       IMPT_INV_LCL_FLG
                   ,II.IMPT_INV_CNSGN_CD                                      IMPT_INV_CNSGN_CD
                   ,WS.IMPT_INV_NUM                                           IMPT_INV_NUM
                   ,WS.RWS_REF_NUM                                            IMPT_CNTNR_NUM
                   ,NVL(TC.INLND_SHPG_METH_CD,LS.INLND_SHPG_METH_CD)          INLND_SHPG_METH_CD
                   ,IISM.SHPG_METH_TP_CD                                      SHPG_METH_TP_CD
               FROM
                    WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,LGSC_SCP_ORD_DTL     LS
                   ,IMPT_INV_SHPG_METH   IISM
                   ,TRUCK_CNTNR          TC
               WHERE
                         WS.GLBL_CMPY_CD                   =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                   =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.LTST_REC_FLG                   =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG               =  #whChngRqstFlg#
                    AND  WS.LTST_WH_IN_ETA_DT        BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.SCE_ORD_TP_CD                 IN (#sceOrdTpCd03#)
                    <iterate property="rwsRefNumList" var="elem[]" open="AND  WS.RWS_REF_NUM IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.EZCANCELFLAG                   =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                   =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG         =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                   =  '0'
                    AND  II.GLBL_CMPY_CD                   =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD          =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG                 =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  LS.GLBL_CMPY_CD
                    AND  WS.IMPT_PACK_SLP_STS_PK           =  LS.IMPT_PACK_SLP_STS_PK
                    AND  LS.EZCANCELFLAG                   =  '0'
                    AND  WS.IMPT_CNTNR_LOT_NUM             =  RH.IMPT_CNTNR_LOT_NUM(+)
                    AND  WS.RWS_REF_NUM                    =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                   =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                   =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)                =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD                =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)                =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                     =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)                =  '0'
                    AND  LS.GLBL_CMPY_CD                   =  TC.GLBL_CMPY_CD(+)
                    AND  LS.TRUCK_CNTNR_PK                 =  TC.TRUCK_CNTNR_PK(+)
                    AND  TC.EZCANCELFLAG(+)                =  '0'
               UNION ALL               
               SELECT
                    WS.GLBL_CMPY_CD                                           GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                                           INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ                                 WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.RWS_REF_NUM                                            RWS_REF_NUM
                   ,WS.IMPT_CNTNR_LOT_NUM                                     IMPT_CNTNR_LOT_NUM
                   ,WS.ASN_NUM                                                ASN_NUM
                   ,LD.LGSC_DELY_TP_CD                                        LGSC_DELY_TP_CD
                   ,LD.LGSC_DELY_TP_NM                                        LGSC_DELY_TP_NM
                   ,WS.WH_IN_PRTY_FLG                                         WH_IN_PRTY_FLG
                   ,WS.INBD_VIS_EVENT_CD                                      INBD_VIS_EVENT_CD
                   ,WS.IMPT_TRM_CD                                            IMPT_TRM_CD
                   ,WS.IMPT_TRM_ETA_DT                                        IMPT_TRM_ETA_DT
                   ,WS.LTST_WH_IN_ETA_DT                                      LTST_WH_IN_ETA_DT
                   ,WS.TEMP_WH_IN_ETA_DT                                      TEMP_WH_IN_ETA_DT
                   ,WS.SCHD_WH_IN_ETA_DT                                      SCHD_WH_IN_ETA_DT
                   ,WS.FINAL_WH_IN_ETA_DT                                     FINAL_WH_IN_ETA_DT
                   ,WS.RAIL_AVAL_DT                                           RAIL_AVAL_DT
                   ,WS.APPT_TM_TXT                                            APPT_TM_TXT
                   ,WS.APPT_DRYG_CARR_CD                                      APPT_DRYG_CARR_CD
                   ,WS.MDSE_CD                                                MDSE_CD
                   ,WS.CARR_CD                                                CARR_CD
                   ,WS.IMPT_INV_VESL_NM                                       IMPT_INV_VESL_NM
                   ,WS.IMPT_INV_BOL_NUM                                       IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN RH.RWS_NUM IS NOT NULL 
                        THEN WS.RWS_REF_NUM 
                        ELSE NULL
                    END                                                       RWS_REF_NUM_E2
                   ,WS.SCE_ORD_TP_CD                                          SCE_ORD_TP_CD
                   ,NVL(RH.RWS_STS_CD,'00')                                   RWS_STS_CD
                   ,WS.SCHD_TP_CD                                             SCHD_TP_CD
                   ,ST.SCHD_TP_NM                                             SCHD_TP_NM
                   ,WS.WH_SCHD_CMNT_TXT                                       WH_SCHD_CMNT_TXT
                   ,WS.ORG_WH_IN_ETA_DT                                       ORG_WH_IN_ETA_DT
                   ,WS.REQ_STK_IN_QTY                                         REQ_STK_IN_QTY
                   ,II.IMPT_INV_LCL_FLG                                       IMPT_INV_LCL_FLG
                   ,II.IMPT_INV_CNSGN_CD                                      IMPT_INV_CNSGN_CD
                   ,WS.IMPT_INV_NUM                                           IMPT_INV_NUM
                   ,WS.RWS_REF_NUM                                            IMPT_CNTNR_NUM
                   ,LS_ISM.INLND_SHPG_METH_CD                                 INLND_SHPG_METH_CD
                   ,NVL(IISM.SHPG_METH_TP_CD,LS_ISM.SHPG_METH_TP_CD)          SHPG_METH_TP_CD
               FROM 
                    (
                         SELECT
                              LS.GLBL_CMPY_CD              GLBL_CMPY_CD
                             ,LS.IMPT_PACK_SLP_STS_PK      IMPT_PACK_SLP_STS_PK
                             ,ISM.INLND_SHPG_METH_CD       INLND_SHPG_METH_CD
                             ,ISM.SHPG_METH_TP_CD          SHPG_METH_TP_CD
                         FROM
                              LGSC_SCP_ORD_DTL  LS
                             ,INLND_SHPG_METH   ISM
                         WHERE
                                   LS.GLBL_CMPY_CD         =  ISM.GLBL_CMPY_CD
                              AND  LS.INLND_SHPG_METH_CD   =  ISM.INLND_SHPG_METH_CD
                              AND  LS.EZCANCELFLAG         =  '0'
                              AND  ISM.EZCANCELFLAG        =  '0'
                    )  LS_ISM
                   ,WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,IMPT_INV_SHPG_METH   IISM
               WHERE
                         WS.GLBL_CMPY_CD                   =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                   =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.LTST_REC_FLG                   =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG               =  #whChngRqstFlg#
                    AND  WS.LTST_WH_IN_ETA_DT        BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.SCE_ORD_TP_CD                 IN (#sceOrdTpCd04#
                                                             ,#sceOrdTpCd05#)
                    <iterate property="rwsRefNumList" var="elem[]" open="AND  WS.RWS_REF_NUM IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.EZCANCELFLAG                   =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                   =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG         =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                   =  '0'
                    AND  II.GLBL_CMPY_CD                   =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD          =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG                 =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  LS_ISM.GLBL_CMPY_CD(+)
                    AND  WS.IMPT_PACK_SLP_STS_PK           =  LS_ISM.IMPT_PACK_SLP_STS_PK(+)
                    AND  WS.RWS_REF_NUM                    =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                   =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                   =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)                =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD                =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)                =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                     =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)                =  '0'
               UNION ALL
               SELECT 
                    WS.GLBL_CMPY_CD                        GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                        INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ              WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.RWS_REF_NUM                         RWS_REF_NUM
                   ,WS.IMPT_CNTNR_LOT_NUM                  IMPT_CNTNR_LOT_NUM
                   ,WS.ASN_NUM                             ASN_NUM
                   ,LD.LGSC_DELY_TP_CD                     LGSC_DELY_TP_CD
                   ,LD.LGSC_DELY_TP_NM                     LGSC_DELY_TP_NM
                   ,WS.WH_IN_PRTY_FLG                      WH_IN_PRTY_FLG
                   ,WS.INBD_VIS_EVENT_CD                   INBD_VIS_EVENT_CD
                   ,WS.IMPT_TRM_CD                         IMPT_TRM_CD
                   ,WS.IMPT_TRM_ETA_DT                     IMPT_TRM_ETA_DT
                   ,WS.LTST_WH_IN_ETA_DT                   LTST_WH_IN_ETA_DT
                   ,WS.TEMP_WH_IN_ETA_DT                   TEMP_WH_IN_ETA_DT
                   ,WS.SCHD_WH_IN_ETA_DT                   SCHD_WH_IN_ETA_DT
                   ,WS.FINAL_WH_IN_ETA_DT                  FINAL_WH_IN_ETA_DT
                   ,WS.RAIL_AVAL_DT                        RAIL_AVAL_DT
                   ,WS.APPT_TM_TXT                         APPT_TM_TXT
                   ,WS.APPT_DRYG_CARR_CD                   APPT_DRYG_CARR_CD
                   ,WS.MDSE_CD                             MDSE_CD
                   ,WS.CARR_CD                             CARR_CD
                   ,WS.IMPT_INV_VESL_NM                    IMPT_INV_VESL_NM
                   ,WS.IMPT_INV_BOL_NUM                    IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN RH.RWS_NUM IS NOT NULL 
                        THEN WS.RWS_REF_NUM
                        ELSE NULL
                    END                                    RWS_REF_NUM_E2
                   ,WS.SCE_ORD_TP_CD                       SCE_ORD_TP_CD
                   ,NVL(RH.RWS_STS_CD,'00')                RWS_STS_CD
                   ,WS.SCHD_TP_CD                          SCHD_TP_CD
                   ,ST.SCHD_TP_NM                          SCHD_TP_NM
                   ,WS.WH_SCHD_CMNT_TXT                    WH_SCHD_CMNT_TXT
                   ,WS.ORG_WH_IN_ETA_DT                    ORG_WH_IN_ETA_DT
                   ,WS.REQ_STK_IN_QTY                      REQ_STK_IN_QTY
                   ,II.IMPT_INV_LCL_FLG                    IMPT_INV_LCL_FLG
                   ,II.IMPT_INV_CNSGN_CD                   IMPT_INV_CNSGN_CD
                   ,II.IMPT_INV_NUM                        IMPT_INV_NUM
                   ,''                                     IMPT_CNTNR_NUM
                   ,''                                     INLND_SHPG_METH_CD
                   ,''                                     SHPG_METH_TP_CD
               FROM 
                    WH_SCHD       WS
                   ,RWS_HDR       RH
                   ,LGSC_DELY_TP  LD
                   ,SCHD_TP       ST
                   ,IMPT_INV      II
               WHERE
                         WS.GLBL_CMPY_CD                   =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                   =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.LTST_REC_FLG                   =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG               =  #whChngRqstFlg#
                    AND  WS.LTST_WH_IN_ETA_DT        BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.INBD_SRC_TP_CD                 =  #inbdSrcTpCd01#
                    <iterate property="rwsRefNumList" var="elem[]" open="AND  WS.RWS_REF_NUM IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.EZCANCELFLAG                   =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  II.GLBL_CMPY_CD(+)
                    AND  WS.IMPT_INV_NUM                   =  II.IMPT_INV_NUM(+)
                    AND  II.IMPT_INV_ACTV_VRSN_FLG(+)      =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG(+)                =  '0'
                    AND  WS.PO_RCV_NUM                     =  RH.TRX_ORD_NUM(+)
                    AND  WS.GLBL_CMPY_CD                   =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)                =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD                =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)                =  '0'
                    AND  WS.GLBL_CMPY_CD                   =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                     =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)                =  '0'
          )     WS_HDR
         ,ALL_MDSE_V      MDSE
         ,MDSE_STORE_PKG  MSP
         ,VND             VND
         ,INBD_VIS_EVENT  IVE
         ,IMPT_TRM        TRM
         ,IMPT_INV_LT     IIL
     WHERE
              WS_HDR.RWS_STS_CD             IN  (#rwsStsCd01#,#rwsStsCd02#,#rwsStsCd03#)
         AND  WS_HDR.GLBL_CMPY_CD            =  MDSE.GLBL_CMPY_CD(+)
         AND  WS_HDR.MDSE_CD                 =  MDSE.MDSE_CD(+)
         AND  MDSE.EZCANCELFLAG(+)           =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  MSP.GLBL_CMPY_CD(+)
         AND  WS_HDR.MDSE_CD                 =  MSP.MDSE_CD(+)
         AND  MSP.PKG_UOM_CD(+)              =  'EA'
         AND  MSP.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  VND.GLBL_CMPY_CD(+)
         AND  WS_HDR.CARR_CD                 =  VND.VND_CD(+)
         AND  VND.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  IVE.GLBL_CMPY_CD(+)
         AND  WS_HDR.INBD_VIS_EVENT_CD       =  IVE.INBD_VIS_EVENT_CD(+)
         AND  IVE.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  TRM.GLBL_CMPY_CD(+)
         AND  WS_HDR.IMPT_TRM_CD             =  TRM.IMPT_TRM_CD(+)
         AND  TRM.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  IIL.GLBL_CMPY_CD(+)
         AND  WS_HDR.INVTY_LOC_CD            =  IIL.INVTY_LOC_CD(+)
         AND  WS_HDR.IMPT_TRM_CD             =  IIL.IMPT_TRM_CD(+)
         AND  WS_HDR.SHPG_METH_TP_CD         =  IIL.SHPG_METH_TP_CD(+)
         AND  WS_HDR.IMPT_TRM_ETA_DT   BETWEEN  IIL.EFF_FROM_DT(+)  AND  NVL(IIL.EFF_THRU_DT(+), '99991231')
         AND  IIL.EZCANCELFLAG(+)            =  '0'
     GROUP BY
          WS_HDR.WH_SCHD_REF_KEY_NUM_SQ
         ,WS_HDR.INVTY_LOC_CD
         ,WS_HDR.RWS_REF_NUM
         ,WS_HDR.IMPT_CNTNR_LOT_NUM
         ,WS_HDR.ASN_NUM
         ,WS_HDR.LGSC_DELY_TP_CD
         ,WS_HDR.LGSC_DELY_TP_NM
         ,WS_HDR.WH_IN_PRTY_FLG
         ,WS_HDR.INBD_VIS_EVENT_CD
         ,IVE.INBD_VIS_EVENT_DESC_TXT
         ,WS_HDR.IMPT_TRM_CD
         ,WS_HDR.IMPT_TRM_ETA_DT
         ,WS_HDR.LTST_WH_IN_ETA_DT
         ,WS_HDR.TEMP_WH_IN_ETA_DT
         ,WS_HDR.SCHD_WH_IN_ETA_DT
         ,WS_HDR.FINAL_WH_IN_ETA_DT
         ,WS_HDR.RAIL_AVAL_DT
         ,WS_HDR.APPT_TM_TXT
         ,WS_HDR.APPT_DRYG_CARR_CD
         ,WS_HDR.MDSE_CD
         ,MDSE.MDSE_DESC_SHORT_TXT
         ,MSP.DMN_PKG_APVL_STS_CD
         ,WS_HDR.CARR_CD
         ,VND.LOC_NM
         ,WS_HDR.IMPT_INV_VESL_NM
         ,WS_HDR.IMPT_INV_BOL_NUM
         ,WS_HDR.RWS_REF_NUM_E2
         ,WS_HDR.RWS_STS_CD
         ,WS_HDR.SCE_ORD_TP_CD
         ,WS_HDR.SCHD_TP_CD
         ,WS_HDR.SCHD_TP_NM
         ,WS_HDR.ORG_WH_IN_ETA_DT
         ,TRM.IMPT_TRM_NM
         ,WS_HDR.WH_SCHD_REF_KEY_NUM_SQ
         ,WS_HDR.INVTY_LOC_CD
         ,WS_HDR.WH_SCHD_CMNT_TXT
         ,WS_HDR.IMPT_INV_NUM
         ,WS_HDR.IMPT_CNTNR_NUM
         ,WS_HDR.IMPT_INV_CNSGN_CD
         ,WS_HDR.INLND_SHPG_METH_CD
         ,IIL.IMPT_TRM_TO_WH_DAYS_AOT
     ORDER BY
          INVTY_LOC_CD
         ,LTST_WH_IN_ETA_DT
         ,RWS_REF_NUM
         ,IMPT_CNTNR_LOT_NUM
         ,ASN_NUM
    </statement>
    
    <statement id="getWhScheduleDownloadListForCntnrInv" parameterClass="Map">
     SELECT
          WS_HDR.WH_SCHD_REF_KEY_NUM_SQ                    WH_SCHD_REF_KEY_NUM_SQ
         ,WS_HDR.INVTY_LOC_CD                              INVTY_LOC_CD
         ,WS_HDR.RWS_REF_NUM                               RWS_REF_NUM
         ,WS_HDR.IMPT_CNTNR_LOT_NUM                        IMPT_CNTNR_LOT_NUM
         ,WS_HDR.ASN_NUM                                   ASN_NUM
         ,WS_HDR.LGSC_DELY_TP_CD                           LGSC_DELY_TP_CD
         ,WS_HDR.LGSC_DELY_TP_NM                           LGSC_DELY_TP_NM
         ,WS_HDR.WH_IN_PRTY_FLG                            WH_IN_PRTY_FLG
         ,WS_HDR.INBD_VIS_EVENT_CD                         INBD_VIS_EVENT_CD
         ,IVE.INBD_VIS_EVENT_DESC_TXT                      INBD_VIS_EVENT_NM
         ,WS_HDR.IMPT_TRM_CD                               IMPT_TRM_CD
         ,WS_HDR.IMPT_TRM_ETA_DT                           IMPT_TRM_ETA_DT
         ,WS_HDR.LTST_WH_IN_ETA_DT                         LTST_WH_IN_ETA_DT
         ,WS_HDR.TEMP_WH_IN_ETA_DT                         TEMP_WH_IN_ETA_DT
         ,WS_HDR.SCHD_WH_IN_ETA_DT                         SCHD_WH_IN_ETA_DT
         ,WS_HDR.FINAL_WH_IN_ETA_DT                        FINAL_WH_IN_ETA_DT
         ,WS_HDR.RAIL_AVAL_DT                              RAIL_AVAL_DT
         ,WS_HDR.APPT_TM_TXT                               APPT_TM_TXT
         ,WS_HDR.APPT_DRYG_CARR_CD                         APPT_DRYG_CARR_CD
         ,WS_HDR.MDSE_CD                                   MDSE_CD
         ,MDSE.MDSE_DESC_SHORT_TXT                         MDSE_DESC_SHORT_TXT
         ,SUM(WS_QTY.REQ_STK_IN_QTY)                       REQ_STK_IN_QTY
         ,DECODE(MSP.DMN_PKG_APVL_STS_CD,'SU','','NG')     MASTER_FLG
         ,WS_HDR.CARR_CD                                   CARR_CD
         ,VND.LOC_NM                                       LOC_NM
         ,WS_HDR.IMPT_INV_VESL_NM                          IMPT_INV_VESL_NM
         ,WS_HDR.IMPT_INV_BOL_NUM                          IMPT_INV_BOL_NUM
         ,WS_HDR.RWS_REF_NUM_I2                            RWS_REF_NUM_I2
         ,WS_HDR.RWS_STS_CD                                RWS_STS_CD
         ,WS_HDR.SCE_ORD_TP_CD                             SCE_ORD_TP_CD
         ,WS_HDR.SCHD_TP_CD                                SCHD_TP_CD
         ,WS_HDR.SCHD_TP_NM                                SCHD_TP_NM
         ,WS_HDR.ORG_WH_IN_ETA_DT                          ORG_WH_IN_ETA_DT
         ,TRM.IMPT_TRM_NM                                  IMPT_TRM_NM
         ,(
               SELECT
                    WS.INVTY_LOC_CD
               FROM
                    WH_SCHD  WS
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                    AND  WS.WH_SCHD_REF_KEY_NUM_SQ      =  WS_HDR.WH_SCHD_REF_KEY_NUM_SQ
                    AND  WS.INVTY_LOC_CD               !=  WS_HDR.INVTY_LOC_CD
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    AND  ROWNUM                      &lt;  2
          )     AS  MULTI_WH_CD
         ,WS_HDR.WH_SCHD_CMNT_TXT                          WH_SCHD_CMNT_TXT
         ,WS_HDR.EZUPTIME                                  EZUPTIME
         ,WS_HDR.EZUPTIMEZONE                              EZUPTIMEZONE
         ,WS_HDR.IMPT_INV_LCL_FLG                          IMPT_INV_LCL_FLG
         ,WS_HDR.IMPT_INV_NUM                              IMPT_INV_NUM
         ,WS_HDR.IMPT_INV_CNSGN_CD                         IMPT_INV_CNSGN_CD
         ,WS_HDR.IMPT_CNTNR_NUM                            IMPT_CNTNR_NUM
         ,WS_HDR.INLND_SHPG_METH_CD                        INLND_SHPG_METH_CD
         ,IIL.IMPT_TRM_TO_WH_DAYS_AOT                      IMPT_TRM_TO_WH_DAYS_AOT
     FROM
          (
               SELECT
                    WS.GLBL_CMPY_CD                        GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                        INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ              WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT                    ORG_WH_IN_ETA_DT
                   ,MAX(WS.RWS_REF_NUM)                    RWS_REF_NUM
                   ,MAX(WS.IMPT_CNTNR_LOT_NUM)             IMPT_CNTNR_LOT_NUM
                   ,MAX(WS.ASN_NUM)                        ASN_NUM
                   ,MAX(WS.LGSC_DELY_TP_CD)                LGSC_DELY_TP_CD
                   ,MAX(LD.LGSC_DELY_TP_NM)                LGSC_DELY_TP_NM
                   ,MAX(WS.WH_IN_PRTY_FLG)                 WH_IN_PRTY_FLG
                   ,MAX(WS.INBD_VIS_EVENT_CD)              INBD_VIS_EVENT_CD
                   ,MAX(WS.IMPT_TRM_CD)                    IMPT_TRM_CD
                   ,MAX(WS.IMPT_TRM_ETA_DT)                IMPT_TRM_ETA_DT
                   ,MAX(WS.LTST_WH_IN_ETA_DT)              LTST_WH_IN_ETA_DT
                   ,MAX(WS.TEMP_WH_IN_ETA_DT)              TEMP_WH_IN_ETA_DT
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)              SCHD_WH_IN_ETA_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)             FINAL_WH_IN_ETA_DT
                   ,MAX(WS.RAIL_AVAL_DT)                   RAIL_AVAL_DT
                   ,MAX(WS.APPT_TM_TXT)                    APPT_TM_TXT
                   ,MAX(WS.APPT_DRYG_CARR_CD)              APPT_DRYG_CARR_CD
                   ,MIN(WS.MDSE_CD)                        MDSE_CD
                   ,MAX(WS.CARR_CD)                        CARR_CD
                   ,MAX(WS.IMPT_INV_VESL_NM)               IMPT_INV_VESL_NM
                   ,MAX(WS.IMPT_INV_BOL_NUM)               IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN MAX(RH.RWS_NUM) IS NOT NULL 
                        THEN MAX(WS.RWS_REF_NUM) 
                        ELSE NULL
                    END                                    RWS_REF_NUM_I2
                   ,MAX(WS.SCE_ORD_TP_CD)                  SCE_ORD_TP_CD
                   ,MIN(NVL(RH.RWS_STS_CD,'00'))           RWS_STS_CD
                   ,MAX(WS.SCHD_TP_CD)                     SCHD_TP_CD
                   ,MAX(ST.SCHD_TP_NM)                     SCHD_TP_NM
                   ,MAX(WS.WH_SCHD_CMNT_TXT)               WH_SCHD_CMNT_TXT
                   ,MAX(WS.EZUPTIME)                       EZUPTIME
                   ,MAX(WS.EZUPTIMEZONE)                   EZUPTIMEZONE
                   ,MAX(II.IMPT_INV_LCL_FLG)               IMPT_INV_LCL_FLG
                   ,WS.IMPT_INV_NUM                        IMPT_INV_NUM
                   ,MAX(II.IMPT_INV_CNSGN_CD)              IMPT_INV_CNSGN_CD
                   ,''                                     IMPT_CNTNR_NUM
                   ,''                                     INLND_SHPG_METH_CD
                   ,MAX(IISM.SHPG_METH_TP_CD)              SHPG_METH_TP_CD
               FROM 
                    WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,IMPT_INV_SHPG_METH   IISM
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.SCE_ORD_TP_CD              IN (#sceOrdTpCd01#
                                                          ,#sceOrdTpCd02#)
                    <iterate property="rwsRefNumList" var="elem[]" open="AND  WS.RWS_REF_NUM IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.EZCANCELFLAG                =  '0'
                    AND  WS.GLBL_CMPY_CD                =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG      =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                =  '0'
                    AND  II.GLBL_CMPY_CD                =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD       =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG              =  '0'
                    AND  WS.RWS_REF_NUM                 =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD             =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                  =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)             =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT
                   ,WS.IMPT_INV_NUM
               UNION
               SELECT
                    WS.GLBL_CMPY_CD                                           GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                                           INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ                                 WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT                                       ORG_WH_IN_ETA_DT
                   ,MAX(WS.RWS_REF_NUM)                                       RWS_REF_NUM
                   ,MAX(WS.IMPT_CNTNR_LOT_NUM)                                IMPT_CNTNR_LOT_NUM
                   ,MAX(WS.ASN_NUM)                                           ASN_NUM
                   ,MAX(WS.LGSC_DELY_TP_CD)                                   LGSC_DELY_TP_CD
                   ,MAX(LD.LGSC_DELY_TP_NM)                                   LGSC_DELY_TP_NM
                   ,MAX(WS.WH_IN_PRTY_FLG)                                    WH_IN_PRTY_FLG
                   ,MAX(WS.INBD_VIS_EVENT_CD)                                 INBD_VIS_EVENT_CD
                   ,MAX(WS.IMPT_TRM_CD)                                       IMPT_TRM_CD
                   ,MAX(WS.IMPT_TRM_ETA_DT)                                   IMPT_TRM_ETA_DT
                   ,MAX(WS.LTST_WH_IN_ETA_DT)                                 LTST_WH_IN_ETA_DT
                   ,MAX(WS.TEMP_WH_IN_ETA_DT)                                 TEMP_WH_IN_ETA_DT
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)                                 SCHD_WH_IN_ETA_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)                                FINAL_WH_IN_ETA_DT
                   ,MAX(WS.RAIL_AVAL_DT)                                      RAIL_AVAL_DT
                   ,MAX(WS.APPT_TM_TXT)                                       APPT_TM_TXT
                   ,MAX(WS.APPT_DRYG_CARR_CD)                                 APPT_DRYG_CARR_CD
                   ,MIN(WS.MDSE_CD)                                           MDSE_CD
                   ,MAX(WS.CARR_CD)                                           CARR_CD
                   ,MAX(WS.IMPT_INV_VESL_NM)                                  IMPT_INV_VESL_NM
                   ,MAX(WS.IMPT_INV_BOL_NUM)                                  IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN MAX(RH.RWS_NUM) IS NOT NULL 
                        THEN MAX(WS.RWS_REF_NUM) 
                        ELSE NULL
                    END                                                       RWS_REF_NUM_I2
                   ,MAX(WS.SCE_ORD_TP_CD)                                     SCE_ORD_TP_CD
                   ,MIN(NVL(RH.RWS_STS_CD,'00'))                              RWS_STS_CD
                   ,MAX(WS.SCHD_TP_CD)                                        SCHD_TP_CD
                   ,MAX(ST.SCHD_TP_NM)                                        SCHD_TP_NM
                   ,MAX(WS.WH_SCHD_CMNT_TXT)                                  WH_SCHD_CMNT_TXT
                   ,MAX(WS.EZUPTIME)                                          EZUPTIME
                   ,MAX(WS.EZUPTIMEZONE)                                      EZUPTIMEZONE
                   ,MAX(II.IMPT_INV_LCL_FLG)                                  IMPT_INV_LCL_FLG
                   ,WS.IMPT_INV_NUM                                           IMPT_INV_NUM
                   ,MAX(II.IMPT_INV_CNSGN_CD)                                 IMPT_INV_CNSGN_CD
                   ,MAX(LS.IMPT_CNTNR_NUM)                                    IMPT_CNTNR_NUM
                   ,MAX(NVL(TC.INLND_SHPG_METH_CD,LS.INLND_SHPG_METH_CD))     INLND_SHPG_METH_CD
                   ,MAX(IISM.SHPG_METH_TP_CD)                                 SHPG_METH_TP_CD
               FROM 
                    WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,LGSC_SCP_ORD_DTL     LS
                   ,IMPT_INV_SHPG_METH   IISM
                   ,TRUCK_CNTNR          TC
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.SCE_ORD_TP_CD              IN (#sceOrdTpCd03#)
                    <iterate property="rwsRefNumList" var="elem[]" open="AND  WS.RWS_REF_NUM IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.EZCANCELFLAG                =  '0'
                    AND  WS.GLBL_CMPY_CD                =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG      =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                =  '0'
                    AND  II.GLBL_CMPY_CD                =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD       =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG              =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LS.GLBL_CMPY_CD
                    AND  WS.IMPT_PACK_SLP_STS_PK        =  LS.IMPT_PACK_SLP_STS_PK
                    AND  LS.EZCANCELFLAG                =  '0'
                    AND  WS.RWS_REF_NUM                 =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD             =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                  =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)             =  '0'
                    AND  LS.GLBL_CMPY_CD                =  TC.GLBL_CMPY_CD(+)
                    AND  LS.TRUCK_CNTNR_PK              =  TC.TRUCK_CNTNR_PK(+)
                    AND  TC.EZCANCELFLAG(+)             =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT
                   ,WS.IMPT_INV_NUM
               UNION
               SELECT
                    WS.GLBL_CMPY_CD                                           GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                                           INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ                                 WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT                                       ORG_WH_IN_ETA_DT
                   ,MAX(WS.RWS_REF_NUM)                                       RWS_REF_NUM
                   ,MAX(WS.IMPT_CNTNR_LOT_NUM)                                IMPT_CNTNR_LOT_NUM
                   ,MAX(WS.ASN_NUM)                                           ASN_NUM
                   ,MAX(WS.LGSC_DELY_TP_CD)                                   LGSC_DELY_TP_CD
                   ,MAX(LD.LGSC_DELY_TP_NM)                                   LGSC_DELY_TP_NM
                   ,MAX(WS.WH_IN_PRTY_FLG)                                    WH_IN_PRTY_FLG
                   ,MAX(WS.INBD_VIS_EVENT_CD)                                 INBD_VIS_EVENT_CD
                   ,MAX(WS.IMPT_TRM_CD)                                       IMPT_TRM_CD
                   ,MAX(WS.IMPT_TRM_ETA_DT)                                   IMPT_TRM_ETA_DT
                   ,MAX(WS.LTST_WH_IN_ETA_DT)                                 LTST_WH_IN_ETA_DT
                   ,MAX(WS.TEMP_WH_IN_ETA_DT)                                 TEMP_WH_IN_ETA_DT
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)                                 SCHD_WH_IN_ETA_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)                                FINAL_WH_IN_ETA_DT
                   ,MAX(WS.RAIL_AVAL_DT)                                      RAIL_AVAL_DT
                   ,MAX(WS.APPT_TM_TXT)                                       APPT_TM_TXT
                   ,MAX(WS.APPT_DRYG_CARR_CD)                                 APPT_DRYG_CARR_CD
                   ,MIN(WS.MDSE_CD)                                           MDSE_CD
                   ,MAX(WS.CARR_CD)                                           CARR_CD
                   ,MAX(WS.IMPT_INV_VESL_NM)                                  IMPT_INV_VESL_NM
                   ,MAX(WS.IMPT_INV_BOL_NUM)                                  IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN MAX(RH.RWS_NUM) IS NOT NULL 
                        THEN MAX(WS.RWS_REF_NUM) 
                        ELSE NULL
                    END                                                       RWS_REF_NUM_I2
                   ,MAX(WS.SCE_ORD_TP_CD)                                     SCE_ORD_TP_CD
                   ,MIN(NVL(RH.RWS_STS_CD,'00'))                              RWS_STS_CD
                   ,MAX(WS.SCHD_TP_CD)                                        SCHD_TP_CD
                   ,MAX(ST.SCHD_TP_NM)                                        SCHD_TP_NM
                   ,MAX(WS.WH_SCHD_CMNT_TXT)                                  WH_SCHD_CMNT_TXT
                   ,MAX(WS.EZUPTIME)                                          EZUPTIME
                   ,MAX(WS.EZUPTIMEZONE)                                      EZUPTIMEZONE
                   ,MAX(II.IMPT_INV_LCL_FLG)                                  IMPT_INV_LCL_FLG
                   ,II.IMPT_INV_NUM                                           IMPT_INV_NUM
                   ,MAX(II.IMPT_INV_CNSGN_CD)                                 IMPT_INV_CNSGN_CD
                   ,MAX(WS.RWS_REF_NUM)                                       IMPT_CNTNR_NUM
                   ,MAX(LS_ISM.INLND_SHPG_METH_CD)                            INLND_SHPG_METH_CD
                   ,MAX(NVL(IISM.SHPG_METH_TP_CD,LS_ISM.SHPG_METH_TP_CD))     SHPG_METH_TP_CD
               FROM 
                    (
                         SELECT
                              LS.GLBL_CMPY_CD                GLBL_CMPY_CD
                             ,LS.IMPT_PACK_SLP_STS_PK        IMPT_PACK_SLP_STS_PK
                             ,ISM.INLND_SHPG_METH_CD         INLND_SHPG_METH_CD
                             ,ISM.SHPG_METH_TP_CD            SHPG_METH_TP_CD
                         FROM
                              LGSC_SCP_ORD_DTL  LS
                             ,INLND_SHPG_METH   ISM
                         WHERE
                                   LS.GLBL_CMPY_CD        =  ISM.GLBL_CMPY_CD
                              AND  LS.INLND_SHPG_METH_CD  =  ISM.INLND_SHPG_METH_CD
                              AND  LS.EZCANCELFLAG        =  '0'
                              AND  ISM.EZCANCELFLAG       =  '0'
                    )  LS_ISM
                   ,WH_SCHD              WS
                   ,RWS_HDR              RH
                   ,LGSC_DELY_TP         LD
                   ,SCHD_TP              ST
                   ,IMPT_INV             II
                   ,IMPT_INV_SHPG_METH   IISM
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.SCE_ORD_TP_CD              IN (#sceOrdTpCd04#
                                                          ,#sceOrdTpCd05#)
                    <iterate property="rwsRefNumList" var="elem[]" open="AND  WS.RWS_REF_NUM IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.EZCANCELFLAG                =  '0'
                    AND  WS.GLBL_CMPY_CD                =  II.GLBL_CMPY_CD
                    AND  WS.IMPT_INV_NUM                =  II.IMPT_INV_NUM
                    AND  II.IMPT_INV_ACTV_VRSN_FLG      =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG                =  '0'
                    AND  II.GLBL_CMPY_CD                =  IISM.GLBL_CMPY_CD
                    AND  II.IMPT_INV_SHPG_METH_CD       =  IISM.IMPT_INV_SHPG_METH_CD
                    AND  IISM.EZCANCELFLAG              =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LS_ISM.GLBL_CMPY_CD(+)
                    AND  WS.IMPT_PACK_SLP_STS_PK        =  LS_ISM.IMPT_PACK_SLP_STS_PK(+)
                    AND  WS.IMPT_CNTNR_LOT_NUM          =  RH.IMPT_CNTNR_LOT_NUM(+)
                    AND  WS.RWS_REF_NUM                 =  RH.RWS_REF_NUM(+)
                    AND  WS.INVTY_LOC_CD                =  RH.WH_CD(+)
                    AND  WS.GLBL_CMPY_CD                =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD             =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                  =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)             =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT
                   ,II.IMPT_INV_NUM
               UNION
               SELECT 
                    WS.GLBL_CMPY_CD                        GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                        INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ              WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT                    ORG_WH_IN_ETA_DT
                   ,MAX(WS.RWS_REF_NUM)                    RWS_REF_NUM
                   ,MAX(WS.IMPT_CNTNR_LOT_NUM)             IMPT_CNTNR_LOT_NUM
                   ,MAX(WS.ASN_NUM)                        ASN_NUM
                   ,MAX(WS.LGSC_DELY_TP_CD)                LGSC_DELY_TP_CD
                   ,MAX(LD.LGSC_DELY_TP_NM)                LGSC_DELY_TP_NM
                   ,MAX(WS.WH_IN_PRTY_FLG)                 WH_IN_PRTY_FLG
                   ,MAX(WS.INBD_VIS_EVENT_CD)              INBD_VIS_EVENT_CD
                   ,MAX(WS.IMPT_TRM_CD)                    IMPT_TRM_CD
                   ,MAX(WS.IMPT_TRM_ETA_DT)                IMPT_TRM_ETA_DT
                   ,MAX(WS.LTST_WH_IN_ETA_DT)              LTST_WH_IN_ETA_DT
                   ,MAX(WS.TEMP_WH_IN_ETA_DT)              TEMP_WH_IN_ETA_DT
                   ,MAX(WS.SCHD_WH_IN_ETA_DT)              SCHD_WH_IN_ETA_DT
                   ,MAX(WS.FINAL_WH_IN_ETA_DT)             FINAL_WH_IN_ETA_DT
                   ,MAX(WS.RAIL_AVAL_DT)                   RAIL_AVAL_DT
                   ,MAX(WS.APPT_TM_TXT)                    APPT_TM_TXT
                   ,MAX(WS.APPT_DRYG_CARR_CD)              APPT_DRYG_CARR_CD
                   ,MIN(WS.MDSE_CD)                        MDSE_CD
                   ,MAX(WS.CARR_CD)                        CARR_CD
                   ,MAX(WS.IMPT_INV_VESL_NM)               IMPT_INV_VESL_NM
                   ,MAX(WS.IMPT_INV_BOL_NUM)               IMPT_INV_BOL_NUM
                   ,CASE 
                        WHEN MAX(RH.RWS_NUM) IS NOT NULL 
                        THEN MAX(WS.RWS_REF_NUM) 
                        ELSE NULL
                    END                                    RWS_REF_NUM_I2
                   ,MAX(WS.SCE_ORD_TP_CD)                  SCE_ORD_TP_CD
                   ,MIN(NVL(RH.RWS_STS_CD,'00'))           RWS_STS_CD
                   ,MAX(WS.SCHD_TP_CD)                     SCHD_TP_CD
                   ,MAX(ST.SCHD_TP_NM)                     SCHD_TP_NM
                   ,MAX(WS.WH_SCHD_CMNT_TXT)               WH_SCHD_CMNT_TXT
                   ,MAX(WS.EZUPTIME)                       EZUPTIME
                   ,MAX(WS.EZUPTIMEZONE)                   EZUPTIMEZONE
                   ,MAX(II.IMPT_INV_LCL_FLG)               IMPT_INV_LCL_FLG
                   ,II.IMPT_INV_NUM                        IMPT_INV_NUM
                   ,MAX(II.IMPT_INV_CNSGN_CD)              IMPT_INV_CNSGN_CD
                   ,''                                     IMPT_CNTNR_NUM
                   ,''                                     INLND_SHPG_METH_CD
                   ,''                                     SHPG_METH_TP_CD
               FROM 
                    WH_SCHD       WS
                   ,RWS_HDR       RH
                   ,LGSC_DELY_TP  LD
                   ,SCHD_TP       ST
                   ,IMPT_INV      II
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.INBD_SRC_TP_CD              =  #inbdSrcTpCd01#
                    <iterate property="rwsRefNumList" var="elem[]" open="AND  WS.RWS_REF_NUM IN(" close=")" conjunction=",">
                         #elem[]#
                    </iterate>
                    AND  WS.EZCANCELFLAG                =  '0'
                    AND  WS.GLBL_CMPY_CD                =  II.GLBL_CMPY_CD(+)
                    AND  WS.IMPT_INV_NUM                =  II.IMPT_INV_NUM(+)
                    AND  II.IMPT_INV_ACTV_VRSN_FLG(+)   =  #imptInvActvVrsnFlg#
                    AND  II.EZCANCELFLAG(+)             =  '0'
                    AND  WS.PO_RCV_NUM                  =  RH.TRX_ORD_NUM(+)
                    AND  WS.GLBL_CMPY_CD                =  RH.GLBL_CMPY_CD(+)
                    AND  RH.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  LD.GLBL_CMPY_CD(+)
                    AND  WS.LGSC_DELY_TP_CD             =  LD.LGSC_DELY_TP_CD(+)
                    AND  LD.EZCANCELFLAG(+)             =  '0'
                    AND  WS.GLBL_CMPY_CD                =  ST.GLBL_CMPY_CD(+)
                    AND  WS.SCHD_TP_CD                  =  ST.SCHD_TP_CD(+)
                    AND  ST.EZCANCELFLAG(+)             =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.ORG_WH_IN_ETA_DT
                   ,II.IMPT_INV_NUM
          )     WS_HDR
         ,(
               SELECT
                    WS.GLBL_CMPY_CD                        GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD                        INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ              WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.MDSE_CD                             MDSE_CD
                   ,SUM(WS.REQ_STK_IN_QTY)                 REQ_STK_IN_QTY
               FROM 
                    WH_SCHD WS
               WHERE
                         WS.GLBL_CMPY_CD                =  #glblCmpyCd#
                 <isNotNull property="invtyLocCd">
                    AND  WS.INVTY_LOC_CD                =  #invtyLocCd#
                 </isNotNull>
                    AND  WS.WH_CHNG_RQST_FLG            =  #whChngRqstFlg#
                    AND  WS.LTST_REC_FLG                =  #ltstRecFlg#
                    AND  WS.LTST_WH_IN_ETA_DT     BETWEEN  #whEtaStart#  AND  #whEtaEnd#
                    AND  WS.EZCANCELFLAG                =  '0'
               GROUP BY
                    WS.GLBL_CMPY_CD
                   ,WS.INVTY_LOC_CD
                   ,WS.WH_SCHD_REF_KEY_NUM_SQ
                   ,WS.MDSE_CD
          )     WS_QTY
         ,ALL_MDSE_V      MDSE
         ,MDSE_STORE_PKG  MSP
         ,VND             VND
         ,INBD_VIS_EVENT  IVE
         ,IMPT_TRM        TRM
         ,IMPT_INV_LT     IIL
     WHERE
              WS_HDR.GLBL_CMPY_CD            =  WS_QTY.GLBL_CMPY_CD
         AND  WS_HDR.INVTY_LOC_CD            =  WS_QTY.INVTY_LOC_CD
         AND  WS_HDR.WH_SCHD_REF_KEY_NUM_SQ  =  WS_QTY.WH_SCHD_REF_KEY_NUM_SQ
         AND  WS_HDR.MDSE_CD                 =  WS_QTY.MDSE_CD
         AND  WS_HDR.RWS_STS_CD             IN  (#rwsStsCd01#,#rwsStsCd02#,#rwsStsCd03#)
         AND  WS_HDR.GLBL_CMPY_CD            =  MDSE.GLBL_CMPY_CD(+)
         AND  WS_HDR.MDSE_CD                 =  MDSE.MDSE_CD(+)
         AND  MDSE.EZCANCELFLAG(+)           =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  MSP.GLBL_CMPY_CD(+)
         AND  WS_HDR.MDSE_CD                 =  MSP.MDSE_CD(+)
         AND  MSP.PKG_UOM_CD(+)              =  'EA'
         AND  MSP.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  VND.GLBL_CMPY_CD(+)
         AND  WS_HDR.CARR_CD                 =  VND.VND_CD(+)
         AND  VND.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  IVE.GLBL_CMPY_CD(+)
         AND  WS_HDR.INBD_VIS_EVENT_CD       =  IVE.INBD_VIS_EVENT_CD(+)
         AND  IVE.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  TRM.GLBL_CMPY_CD(+)
         AND  WS_HDR.IMPT_TRM_CD             =  TRM.IMPT_TRM_CD(+)
         AND  TRM.EZCANCELFLAG(+)            =  '0'
         AND  WS_HDR.GLBL_CMPY_CD            =  IIL.GLBL_CMPY_CD(+)
         AND  WS_HDR.INVTY_LOC_CD            =  IIL.INVTY_LOC_CD(+)
         AND  WS_HDR.IMPT_TRM_CD             =  IIL.IMPT_TRM_CD(+)
         AND  WS_HDR.SHPG_METH_TP_CD         =  IIL.SHPG_METH_TP_CD(+)
         AND  WS_HDR.IMPT_TRM_ETA_DT   BETWEEN  IIL.EFF_FROM_DT(+)  AND  NVL(IIL.EFF_THRU_DT(+), '99991231')
         AND  IIL.EZCANCELFLAG(+)            =  '0'
     GROUP BY
          WS_HDR.WH_SCHD_REF_KEY_NUM_SQ
         ,WS_HDR.INVTY_LOC_CD
         ,WS_HDR.RWS_REF_NUM
         ,WS_HDR.IMPT_CNTNR_LOT_NUM
         ,WS_HDR.ASN_NUM
         ,WS_HDR.LGSC_DELY_TP_CD
         ,WS_HDR.LGSC_DELY_TP_NM
         ,WS_HDR.WH_IN_PRTY_FLG
         ,WS_HDR.INBD_VIS_EVENT_CD
         ,IVE.INBD_VIS_EVENT_DESC_TXT
         ,WS_HDR.IMPT_TRM_CD
         ,WS_HDR.IMPT_TRM_ETA_DT
         ,WS_HDR.LTST_WH_IN_ETA_DT
         ,WS_HDR.TEMP_WH_IN_ETA_DT
         ,WS_HDR.SCHD_WH_IN_ETA_DT
         ,WS_HDR.FINAL_WH_IN_ETA_DT
         ,WS_HDR.RAIL_AVAL_DT
         ,WS_HDR.APPT_TM_TXT
         ,WS_HDR.APPT_DRYG_CARR_CD
         ,WS_HDR.MDSE_CD
         ,MDSE.MDSE_DESC_SHORT_TXT
         ,MSP.DMN_PKG_APVL_STS_CD
         ,WS_HDR.CARR_CD
         ,VND.LOC_NM
         ,WS_HDR.IMPT_INV_VESL_NM
         ,WS_HDR.IMPT_INV_BOL_NUM
         ,WS_HDR.RWS_REF_NUM_I2
         ,WS_HDR.RWS_STS_CD
         ,WS_HDR.SCE_ORD_TP_CD
         ,WS_HDR.SCHD_TP_CD
         ,WS_HDR.SCHD_TP_NM
         ,WS_HDR.ORG_WH_IN_ETA_DT
         ,TRM.IMPT_TRM_NM
         ,WS_HDR.WH_SCHD_REF_KEY_NUM_SQ
         ,WS_HDR.INVTY_LOC_CD
         ,WS_HDR.WH_SCHD_CMNT_TXT
         ,WS_HDR.EZUPTIME
         ,WS_HDR.EZUPTIMEZONE
         ,WS_HDR.IMPT_INV_LCL_FLG
         ,WS_HDR.IMPT_INV_NUM
         ,WS_HDR.IMPT_INV_CNSGN_CD
         ,WS_HDR.IMPT_CNTNR_NUM
         ,WS_HDR.INLND_SHPG_METH_CD
         ,IIL.IMPT_TRM_TO_WH_DAYS_AOT
     ORDER BY
          INVTY_LOC_CD
         ,LTST_WH_IN_ETA_DT
         ,RWS_REF_NUM
         ,IMPT_CNTNR_LOT_NUM
         ,ASN_NUM
         ,ORG_WH_IN_ETA_DT
    </statement>

    <statement id="getSummaryDownloadList" parameterClass="Map">
     SELECT
          WS.GLBL_CMPY_CD                             GLBL_CMPY_CD
          ,WS.INVTY_LOC_CD                            INVTY_LOC_CD
          ,ST.SCHD_TP_NM                              SCHD_TP_NM
          ,WS.LTST_WH_IN_ETA_DT                       LTST_WH_IN_ETA_DT
          ,COUNT(DISTINCT WS.WH_SCHD_REF_KEY_NUM_SQ)  RWS_QTY
          ,SUM(WS.PLT_QTY)                            PLT_QTY
          ,SUM(WS.CSE_QTY)                            CSE_QTY
     FROM 
          WH_SCHD  WS
         ,SCHD_TP  ST
     WHERE
               WS.GLBL_CMPY_CD             =  #glblCmpyCd#
          <isNotNull property="locRoleTp">
          AND WS.INVTY_LOC_CD IN(
              SELECT
                  B.INVTY_LOC_CD
              FROM
                  LOC_USG         A
                  ,DS_INVTY_LOC_V B
              WHERE
                  A.GLBL_CMPY_CD       = #glblCmpyCd#
                  AND A.EZCANCELFLAG   = '0'
                  <iterate property="locRoleTp" var="elem[]" open="AND A.LOC_ROLE_TP_CD IN (" close=")" conjunction=",">
                      #elem[]#
                  </iterate>
                  AND A.GLBL_CMPY_CD   = B.GLBL_CMPY_CD
                  AND A.PTY_LOC_PK     = B.PTY_LOC_PK
                  AND B.EZCANCELFLAG   = '0'
                  AND B.RGTN_STS_CD    = #rgtnStsCd#
                  <iterate property="dataSecurityWh" var="elem[]" open="AND B.INVTY_LOC_CD IN (" close=")" conjunction=",">
                      #elem[]#
                  </iterate>
              <isNull property="dataSecurityWh">
              UNION ALL
              SELECT
                  C.INVTY_LOC_CD
              FROM
                  DS_INVTY_LOC_V C
              WHERE
                  C.GLBL_CMPY_CD       = #glblCmpyCd#
                  AND C.EZCANCELFLAG   = '0'
                  AND C.WH_SYS_TP_CD   = #whSysTpCd#
              </isNull>
              )
          </isNotNull>
          <iterate property="invtyLocCd" var="elem[]" open="AND WS.INVTY_LOC_CD IN(" close=")" conjunction=",">
               #elem[]#
          </iterate>
          AND  WS.LTST_WH_IN_ETA_DT  BETWEEN  #whEtaStart#  AND  #whEtaEnd#
          AND  WS.LTST_REC_FLG             =  #ltstRecFlg#
          AND  WS.WH_CHNG_RQST_FLG         =  #whChngRqstFlg#
          <isNotNull property="scheTpCd">
               AND  WS.SCHD_TP_CD          =  #scheTpCd#
          </isNotNull>
          <isEqual property="asnNotRcvFlg" compareValue="N">
               AND  WS.ASN_NOT_RCV_FLG     =  #asnNotRcvFlg#
          </isEqual>
          AND  NOT EXISTS(
                              SELECT 
                                   'X' 
                              FROM 
                                   RWS_HDR RH
                                  ,RWS_DTL RD
                              WHERE
                                        RH.EZCANCELFLAG  =  '0'
                                   AND  RD.EZCANCELFLAG  =  '0'
                                   AND  RH.RWS_STS_CD   IN  (#rwsStsCd01#,#rwsStsCd02#)
                                   AND  RH.GLBL_CMPY_CD  =  RD.GLBL_CMPY_CD
                                   AND  RH.RWS_NUM       =  RD.RWS_NUM
                                   AND  (
                                              (     WS.INBD_SRC_TP_CD       IN  (#inbdSrcTpCd01#
                                                                                ,#inbdSrcTpCd02#
                                                                                ,#inbdSrcTpCd03#
                                                                                ,#inbdSrcTpCd04#)
                                               AND  RH.RWS_REF_NUM           =  WS.RWS_REF_NUM
                                               AND  RH.WH_CD                 =  WS.INVTY_LOC_CD
                                              )
                                        OR
                                              (
                                                    WS.INBD_SRC_TP_CD       IN  (#inbdSrcTpCd05#)
                                               AND  RH.TRX_ORD_NUM           =  WS.PO_RCV_NUM
                                               AND  RD.TRX_LINE_NUM          =  WS.PO_RCV_LINE_NUM
                                              )
                                        )
               )
          AND  WS.GLBL_CMPY_CD             =  ST.GLBL_CMPY_CD(+)
          AND  WS.SCHD_TP_CD               =  ST.SCHD_TP_CD(+)
          AND  WS.EZCANCELFLAG(+)          =  '0'
     GROUP BY
          WS.GLBL_CMPY_CD
         ,WS.INVTY_LOC_CD
         ,ST.SCHD_TP_NM
         ,WS.LTST_WH_IN_ETA_DT
    </statement>
    
    <statement id="getInfoListToConnectInbdVisForImport" parameterClass="Map" resultMap="result.getInfoListToConnectInbdVisForImport">
     SELECT
          INV.IMPT_INV_NUM                        IMPT_INV_NUM
         ,INV.IMPT_INV_CLS_CD                     IMPT_INV_CLS_CD
         ,INV.IMPT_INV_VER_NUM                    IMPT_INV_VER_NUM
         ,INV.IMPT_INV_SLP_CLS_CD                 IMPT_INV_SLP_CLS_CD
         ,IDO.IMPT_INV_DO_NUM                     IMPT_INV_DO_NUM
         ,IDO.IMPT_DO_CLS_CD                      IMPT_DO_CLS_CD
         ,IPS.IMPT_PACK_SLP_NUM                   IMPT_PACK_SLP_NUM
         ,IPS.IMPT_PACK_SLP_LINE_NUM              IMPT_PACK_SLP_LINE_NUM
         ,IPS.IMPT_CNTNR_LOT_NUM                  IMPT_CNTNR_LOT_NUM
         ,IPS.IMPT_CNTNR_NUM                      IMPT_CNTNR_NUM
         ,IPSS.IMPT_PACK_SLP_DTL_LINE_NUM         IMPT_PACK_SLP_DTL_LINE_NUM
         ,IPSS.MDSE_CD                            MDSE_CD
         ,RWS.RWS_NUM                             RWS_NUM
         ,RWS.RWS_REF_NUM                         RWS_REF_NUM
         ,NVL(RWS.RWS_STS_CD,'00')                RWS_STS_CD
         ,WS.TRUCK_CNTNR_PK                       TRUCK_CNTNR_PK
         ,WS.SCE_ORD_TP_CD                        SCE_ORD_TP_CD
     FROM
          IMPT_INV           INV
         ,IMPT_INV_DO        IDO
         ,WH_SCHD            WS
         ,IMPT_PACK_SLP      IPS
         ,IMPT_PACK_SLP_STS  IPSS
         ,(
               SELECT
                    RDTL.GLBL_CMPY_CD             GLBL_CMPY_CD
                   ,RDTL.IMPT_PACK_SLP_STS_PK     IMPT_PACK_SLP_STS_PK
                   ,RDTL.RWS_NUM                  RWS_NUM
                   ,RHDR.RWS_REF_NUM              RWS_REF_NUM
                   ,NVL(RHDR.RWS_STS_CD,'00')     RWS_STS_CD
               FROM
                    RWS_DTL  RDTL
                   ,RWS_HDR  RHDR
               WHERE
                         RDTL.GLBL_CMPY_CD  =  RHDR.GLBL_CMPY_CD
                    AND  RDTL.RWS_NUM       =  RHDR.RWS_NUM
                    AND  RDTL.EZCANCELFLAG  =  '0'
                    AND  RHDR.EZCANCELFLAG  =  '0'
           )   RWS
     WHERE
               WS.GLBL_CMPY_CD             =  #glblCmpyCd#
          AND  WS.WH_SCHD_PK               =  #whSchdPk#
          AND  WS.EZCANCELFLAG             =  '0'
          AND  WS.GLBL_CMPY_CD             =  IPSS.GLBL_CMPY_CD
          AND  WS.IMPT_PACK_SLP_STS_PK     =  IPSS.IMPT_PACK_SLP_STS_PK
          AND  IPSS.EZCANCELFLAG           =  '0'
          AND  IPSS.GLBL_CMPY_CD           =  INV.GLBL_CMPY_CD
          AND  IPSS.IMPT_INV_PK            =  INV.IMPT_INV_PK
          AND  INV.EZCANCELFLAG            =  '0'
          AND  IPSS.GLBL_CMPY_CD           =  IDO.GLBL_CMPY_CD
          AND  IPSS.IMPT_INV_DO_PK         =  IDO.IMPT_INV_DO_PK
          AND  IDO.EZCANCELFLAG            =  '0'
          AND  IPSS.GLBL_CMPY_CD           =  IPS.GLBL_CMPY_CD
          AND  IPSS.IMPT_PACK_SLP_PK       =  IPS.IMPT_PACK_SLP_PK
          AND  IPS.EZCANCELFLAG            =  '0'
          AND  IPSS.GLBL_CMPY_CD           =  RWS.GLBL_CMPY_CD(+)
          AND  IPSS.IMPT_PACK_SLP_STS_PK   =  RWS.IMPT_PACK_SLP_STS_PK(+)
          AND  RWS.RWS_STS_CD(+)          !=  #rwsStsCd#
         <isNotNull property="rwsRefNum">
          AND  RWS.RWS_REF_NUM             = #rwsRefNum#
          </isNotNull>
    </statement>
    <resultMap id="result.getInfoListToConnectInbdVisForImport" class="NLAL0070_GSMsg">
        <result property="imptInvNum_G1"                column="IMPT_INV_NUM"                   javaType="EZDSStringItem"/>
        <result property="imptInvClsCd_G1"              column="IMPT_INV_CLS_CD"                javaType="EZDSStringItem"/>
        <result property="imptInvVerNum_G1"             column="IMPT_INV_VER_NUM"               javaType="EZDSStringItem"/>
        <result property="imptInvSlpClsCd_G1"           column="IMPT_INV_SLP_CLS_CD"            javaType="EZDSStringItem"/>
        <result property="imptInvDoNum_G1"              column="IMPT_INV_DO_NUM"                javaType="EZDSStringItem"/>
        <result property="imptDoClsCd_G1"               column="IMPT_DO_CLS_CD"                 javaType="EZDSStringItem"/>
        <result property="imptPackSlpNum_G1"            column="IMPT_PACK_SLP_NUM"              javaType="EZDSStringItem"/>
        <result property="imptPackSlpLineNum_G1"        column="IMPT_PACK_SLP_LINE_NUM"         javaType="EZDSStringItem"/>
        <result property="imptCntnrLotNum_G1"           column="IMPT_CNTNR_LOT_NUM"             javaType="EZDSStringItem"/>
        <result property="imptCntnrNum_G1"              column="IMPT_CNTNR_NUM"                 javaType="EZDSStringItem"/>
        <result property="imptPackSlpDtlLineNum_G1"     column="IMPT_PACK_SLP_DTL_LINE_NUM"     javaType="EZDSStringItem"/>
        <result property="mdseCd_G1"                    column="MDSE_CD"                        javaType="EZDSStringItem"/>
        <result property="rwsNum_G1"                    column="RWS_NUM"                        javaType="EZDSStringItem"/>
        <result property="rwsRefNum_G1"                 column="RWS_REF_NUM"                    javaType="EZDSStringItem"/>
        <result property="rwsStsCd_G1"                  column="RWS_STS_CD"                     javaType="EZDSStringItem"/>
        <result property="truckCntnrPk_G1"              column="TRUCK_CNTNR_PK"                 javaType="EZDSStringItem"/>
        <result property="sceOrdTpCd_G1"                column="SCE_ORD_TP_CD"                  javaType="EZDSStringItem"/>
    </resultMap>    

    <statement id="getInfoListToConnectInbdVisForDomestic" parameterClass="Map" resultMap="result.getInfoListToConnectInbdVisForDomestic">
     SELECT
          WS.PO_RCV_NUM                        PO_RCV_NUM
         ,WS.PO_RCV_LINE_NUM                   PO_RCV_LINE_NUM
         ,RHDR.RWS_NUM                         RWS_NUM
         ,RHDR.RWS_REF_NUM                     RWS_REF_NUM
         ,NVL(RHDR.RWS_STS_CD,'00')            RWS_STS_CD
     FROM
          WH_SCHD  WS
         ,RWS_HDR  RHDR
     WHERE
               WS.GLBL_CMPY_CD             =  #glblCmpyCd#
          AND  WS.WH_SCHD_PK               =  #whSchdPk#
          AND  WS.EZCANCELFLAG             =  '0'
          AND  WS.GLBL_CMPY_CD             =  RHDR.GLBL_CMPY_CD(+)
          AND  WS.PO_RCV_NUM               =  RHDR.TRX_ORD_NUM(+)
          AND  RHDR.EZCANCELFLAG(+)        =  '0'
    </statement>
    <resultMap id="result.getInfoListToConnectInbdVisForDomestic" class="NLAL0070_HSMsg">
        <result property="poRcvNum_H1"         column="PO_RCV_NUM"          javaType="EZDSStringItem"/>
        <result property="poRcvLineNum_H1"     column="PO_RCV_LINE_NUM"     javaType="EZDSStringItem"/>
        <result property="rwsNum_H1"           column="RWS_NUM"             javaType="EZDSStringItem"/>
        <result property="rwsRefNum_H1"        column="RWS_REF_NUM"         javaType="EZDSStringItem"/>
        <result property="rwsStsCd_H1"         column="RWS_STS_CD"          javaType="EZDSStringItem"/>
    </resultMap>

</sqlMap>
