<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWXC014001">

    <statement id="selectDsAcctCust" parameterClass="Map" resultClass="Map">
        SELECT
             S.DS_ACCT_NM
            ,S.DS_CUST_SIC_CD
            ,S.LOC_NUM
            ,S.DS_ACCT_CLS_CD
            ,S.DS_ACCT_TP_CD
            ,S.DS_ACCT_DLR_CD
            ,DAGA.DS_ACCT_GRP_CD
            ,S.COA_CH_CD
        FROM
             SELL_TO_CUST S
            ,( SELECT
                  GLBL_CMPY_CD
                , EZCANCELFLAG
                , DS_ACCT_NUM
                , DS_ACCT_GRP_CD
               FROM DS_ACCT_GRP_ASG DAGA
               WHERE
                    DAGA.GLBL_CMPY_CD = #glblCmpyCd#
                AND DAGA.EZCANCELFLAG = '0'
                AND DAGA.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (DAGA.EFF_THRU_DT &gt;= #prcBaseDt# OR DAGA.EFF_THRU_DT IS NULL )
            ) DAGA
        WHERE
            S.GLBL_CMPY_CD = #glblCmpyCd#
        AND S.EZCANCELFLAG = '0'
        AND S.SELL_TO_CUST_CD = #dsAcctNum#
        AND S.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (S.EFF_THRU_DT &gt;= #prcBaseDt# OR S.EFF_THRU_DT IS NULL )
        AND S.GLBL_CMPY_CD = DAGA.GLBL_CMPY_CD(+)
        AND S.EZCANCELFLAG = DAGA.EZCANCELFLAG(+)
        AND S.SELL_TO_CUST_CD = DAGA.DS_ACCT_NUM(+)
    </statement>

    <statement id="selectMdse" parameterClass="Map" resultClass="Map">

        SELECT
             M2.ORD_TAKE_MDSE_CD
            ,M2.MDSE_NM
            ,M2.ZEROTH_PROD_CTRL_CD
            ,M2.FIRST_PROD_CTRL_CD
            ,M2.SCD_PROD_CTRL_CD
            ,M2.THIRD_PROD_CTRL_CD
            ,M2.FRTH_PROD_CTRL_CD
            ,M2.FIFTH_PROD_CTRL_CD
            <!-- 2018/04/24 QC#22569 add start -->
            ,M2.SLS_MAT_GRP_CD_01
            ,M2.SLS_MAT_GRP_CD_02
            ,M2.SLS_MAT_GRP_CD_03
            <!-- 2018/04/24 QC#22569 add end -->
            ,M2.MDSE_ITEM_TP_CD
            ,M2.MDSE_ITEM_CLS_TP_CD
            ,M2.COA_MDSE_TP_CD
            ,M2.COA_PROD_CD
            ,M2.MKT_MDL_CD
            ,M2.MKT_MDL_SEG_CD
            ,MSP.PKG_UOM_CD
        FROM
            (  SELECT
                    OTM.ORD_TAKE_MDSE_CD
                   ,M.MDSE_NM
                   ,M.ZEROTH_PROD_CTRL_CD
                   ,M.FIRST_PROD_CTRL_CD
                   ,M.SCD_PROD_CTRL_CD
                   ,M.THIRD_PROD_CTRL_CD
                   ,M.FRTH_PROD_CTRL_CD
                   ,M.FIFTH_PROD_CTRL_CD
                   <!-- 2018/04/24 QC#22569 add start -->
                   ,M.SLS_MAT_GRP_CD_01
                   ,M.SLS_MAT_GRP_CD_02
                   ,M.SLS_MAT_GRP_CD_03
                   <!-- 2018/04/24 QC#22569 add end -->
                   ,M.COA_PROD_CD
                   ,M.GLBL_CMPY_CD
                   ,M.EZCANCELFLAG
                   ,M.MDSE_CD
                   ,M.MDSE_ITEM_TP_CD
                   ,M.MDSE_ITEM_CLS_TP_CD
                   ,M.COA_MDSE_TP_CD
                   ,M.MKT_MDL_CD
                   ,M.MKT_MDL_SEG_CD
               FROM
                    ORD_TAKE_MDSE OTM
                   ,MDSE M
               WHERE
                   OTM.GLBL_CMPY_CD = #glblCmpyCd#
               AND OTM.EZCANCELFLAG = '0'
               AND OTM.ORD_TAKE_MDSE_CD = SUBSTR(#mdseCd#, 0, 8)
               AND OTM.GLBL_CMPY_CD = M.GLBL_CMPY_CD
               AND OTM.EZCANCELFLAG = M.EZCANCELFLAG
               AND OTM.MDSE_CD = M.MDSE_CD
             UNION ALL
               SELECT
                    NULL AS ORD_TAKE_MDSE_CD
                   ,M.MDSE_NM
                   ,M.ZEROTH_PROD_CTRL_CD
                   ,M.FIRST_PROD_CTRL_CD
                   ,M.SCD_PROD_CTRL_CD
                   ,M.THIRD_PROD_CTRL_CD
                   ,M.FRTH_PROD_CTRL_CD
                   ,M.FIFTH_PROD_CTRL_CD
                   <!-- 2018/04/24 QC#22569 add start -->
                   ,M.SLS_MAT_GRP_CD_01
                   ,M.SLS_MAT_GRP_CD_02
                   ,M.SLS_MAT_GRP_CD_03
                   <!-- 2018/04/24 QC#22569 add end -->
                   ,M.COA_PROD_CD
                   ,M.GLBL_CMPY_CD
                   ,M.EZCANCELFLAG
                   ,M.MDSE_CD
                   ,M.MDSE_ITEM_TP_CD
                   ,M.MDSE_ITEM_CLS_TP_CD
                   ,M.COA_MDSE_TP_CD
                   ,M.MKT_MDL_CD
                   ,M.MKT_MDL_SEG_CD
               FROM
                    MDSE M
               WHERE
                   M.GLBL_CMPY_CD = #glblCmpyCd#
               AND M.EZCANCELFLAG = '0'
               AND M.MDSE_CD = #mdseCd#
            ) M2
            ,MDSE_STORE_PKG MSP
            ,SVC_ALLOC_TP SAT
        WHERE
            M2.GLBL_CMPY_CD = MSP.GLBL_CMPY_CD(+)
        AND M2.EZCANCELFLAG = MSP.EZCANCELFLAG(+)
        AND M2.MDSE_CD = MSP.MDSE_CD(+)
        AND MSP.PRIM_PKG_UOM_FLG(+) = #primPkgUomFlg#
    </statement>

    <statement id="selectPrcGrp" parameterClass="Map" resultClass="BigDecimal">
            SELECT 
                <!-- Add Start 2018/12/05 QC#29410 -->
                <isEqual property="prcGrpTpCd" compareValue="02">
                /*+ LEADING(A B) USE_NL(B) */
                </isEqual>
                <!-- Add End 2018/12/05 QC#29410 -->
                A.PRC_GRP_PK 
            FROM
                PRC_GRP A
                ,(
                SELECT
                     DTL.PRC_GRP_PK
                    ,DTL.GLBL_CMPY_CD
                    ,DTL.EZCANCELFLAG
                    ,COUNT(DISTINCT DTL.PRC_GRP_TRGT_ATTRB_CD)   AS CNT1
                    ,COUNT(DISTINCT DTL.PRC_GRP_TRGT_ATTRB_CD_2) AS CNT2
                FROM (
                    SELECT
                         B.PRC_GRP_PK
                        ,B.GLBL_CMPY_CD
                        ,B.EZCANCELFLAG
                        ,B.PRC_GRP_TRGT_ATTRB_CD
                        ,CASE B.PRC_GRP_TRGT_ATTRB_CD
                              <isNotNull property="mdseCd">
                              WHEN #prcGrpTrgtAttrbCd_01#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #mdseCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #mdseCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#mdseCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #mdseCd# LIKE B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsAcctNum">
                              WHEN #prcGrpTrgtAttrbCd_14#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum# LIKE B.PRC_GRP_FROM_TXT || '%'  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="mdseItemTpCd">
                              WHEN #prcGrpTrgtAttrbCd_02#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #mdseItemTpCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #mdseItemTpCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#mdseItemTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #mdseItemTpCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="mdseItemClsTpCd">
                              WHEN #prcGrpTrgtAttrbCd_03#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #mdseItemClsTpCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #mdseItemClsTpCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#mdseItemClsTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #mdseItemClsTpCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="coaMdseTpCd">
                              WHEN #prcGrpTrgtAttrbCd_04#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaMdseTpCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaMdseTpCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaMdseTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaMdseTpCd# LIKE B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="coaProdCd">
                              WHEN #prcGrpTrgtAttrbCd_05#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaProdCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaProdCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaProdCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaProdCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="mktMdlCd">
                              WHEN #prcGrpTrgtAttrbCd_06#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #mktMdlCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #mktMdlCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#mktMdlCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #mktMdlCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="firstProdCtrlCd">
                              WHEN #prcGrpTrgtAttrbCd_07#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #firstProdCtrlCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #firstProdCtrlCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#firstProdCtrlCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #firstProdCtrlCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="scdProdCtrlCd">
                              WHEN #prcGrpTrgtAttrbCd_08#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #scdProdCtrlCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #scdProdCtrlCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#scdProdCtrlCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #scdProdCtrlCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="thirdProdCtrlCd">
                              WHEN #prcGrpTrgtAttrbCd_09#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #thirdProdCtrlCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #thirdProdCtrlCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#thirdProdCtrlCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #thirdProdCtrlCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="frthProdCtrlCd">
                              WHEN #prcGrpTrgtAttrbCd_10#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #frthProdCtrlCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #frthProdCtrlCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#frthProdCtrlCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #frthProdCtrlCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="fifthProdCtrlCd">
                              WHEN #prcGrpTrgtAttrbCd_11#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #fifthProdCtrlCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #fifthProdCtrlCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#fifthProdCtrlCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #fifthProdCtrlCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsAcctNm">
                              WHEN #prcGrpTrgtAttrbCd_15#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm# LIKE B.PRC_GRP_FROM_TXT || '%'  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsCustSicCd">
                              WHEN #prcGrpTrgtAttrbCd_16#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="locNum">
                              WHEN #prcGrpTrgtAttrbCd_17#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsAcctClsCd">
                              WHEN #prcGrpTrgtAttrbCd_18#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsAcctTpCd">
                              WHEN #prcGrpTrgtAttrbCd_19#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsAcctDlrCd">
                              WHEN #prcGrpTrgtAttrbCd_20#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="csmpNum">
                              WHEN #prcGrpTrgtAttrbCd_21#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #csmpNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #csmpNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#csmpNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #csmpNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dlrRefNum">
                              WHEN #prcGrpTrgtAttrbCd_22#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dlrRefNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dlrRefNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dlrRefNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dlrRefNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="prcContrNum">
                              WHEN #prcGrpTrgtAttrbCd_24#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #prcContrNum# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #prcContrNum# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#prcContrNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #prcContrNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsOrdCatgCd">
                              WHEN #prcGrpTrgtAttrbCd_25#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsOrdCatgCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsOrdCatgCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsOrdCatgCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsOrdCatgCd# LIKE B.PRC_GRP_FROM_TXT || '%'  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsOrdTpCd">
                              WHEN #prcGrpTrgtAttrbCd_26#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsOrdTpCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsOrdTpCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsOrdTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsOrdTpCd# LIKE B.PRC_GRP_FROM_TXT || '%'  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <isNotNull property="dsOrdLineCatgCd">
                              WHEN #prcGrpTrgtAttrbCd_27#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsOrdLineCatgCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsOrdLineCatgCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsOrdLineCatgCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsOrdLineCatgCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <!-- QC#18789 add start -->
                              <isNotNull property="coaChCd">
                              WHEN #prcGrpTrgtAttrbCd_28#  THEN
                                  CASE
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd# = B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd# != B.PRC_GRP_FROM_TXT  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN B.PRC_GRP_TRGT_ATTRB_CD
                                      ELSE NULL
                                  END
                              </isNotNull>
                              <!-- QC#18789 add end -->
                              WHEN NULL THEN NULL
                              ELSE NULL 
                         END PRC_GRP_TRGT_ATTRB_CD_2
                    FROM
                        PRC_GRP_DTL B
                    WHERE
                        B.GLBL_CMPY_CD     = #glblCmpyCd#
                        AND B.EFF_FROM_DT  &lt;= #prcBaseDt#
                        AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                        AND B.EZCANCELFLAG = '0'
                    ) DTL
                    GROUP BY
                         DTL.PRC_GRP_PK
                        ,DTL.GLBL_CMPY_CD
                        ,DTL.EZCANCELFLAG
                ) B
            WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.EZCANCELFLAG  = '0'
            AND A.PRC_GRP_TP_CD = #prcGrpTpCd#
            AND A.ACTV_FLG      = #actvFlg#
            AND A.EFF_FROM_DT   &lt;= #prcBaseDt#
            AND (A.EFF_THRU_DT  &gt;= #prcBaseDt# OR A.EFF_THRU_DT IS NULL)
            AND A.GLBL_CMPY_CD  = B.GLBL_CMPY_CD
            AND A.PRC_GRP_PK    = B.PRC_GRP_PK
            AND B.EZCANCELFLAG  = '0'
            AND B.CNT1          = B.CNT2
            <!-- Add Start 2018/07/05 QC#26197 -->
            <isEqual property="prcGrpTpCd" compareValue="02">
            AND (
                EXISTS ( 
                    SELECT
                    <!-- Add Start 2018/11/28 QC#29410 -->
                     /*+ INDEX(PAD PRC_ADJ_DTL_I5) LEADING(PAD PRH_A) USE_NL(PRH_A) */
                    <!-- Add End 2018/11/28 QC#29410 -->
                            1 
                    FROM
                          PRC_ADJ_DTL  PAD
                        , PRC_RULE_HDR PRH_A 
                    WHERE
                            PAD.GLBL_CMPY_CD              = #glblCmpyCd# 
                        AND PAD.EZCANCELFLAG              = '0' 
                        AND PAD.PRC_RULE_COND_FROM_TXT_57 = TO_CHAR(B.PRC_GRP_PK) 
                        AND PAD.GLBL_CMPY_CD              = PRH_A.GLBL_CMPY_CD 
                        AND PAD.PRC_RULE_HDR_PK           = PRH_A.PRC_RULE_HDR_PK 
                        AND PAD.EZCANCELFLAG              = PRH_A.EZCANCELFLAG 
                        AND PRH_A.EFF_FROM_DT             &lt;= #prcBaseDt# 
                        AND (PRH_A.EFF_THRU_DT            &gt;= #prcBaseDt# OR PRH_A.EFF_THRU_DT IS NULL) 
                        AND PRH_A.ACTV_FLG                = #actvFlg#
                ) 
                OR EXISTS ( 
                    SELECT
                    <!-- Add Start 2018/11/28 QC#29410 -->
                     /*+ INDEX(PRTC PRC_RULE_TRX_COND_I3) LEADING(PRTC PRH_T) USE_NL(PRH_T) */
                    <!-- Add End 2018/11/28 QC#29410 -->
                            1 
                    FROM
                          PRC_RULE_TRX_COND PRTC
                        , PRC_RULE_HDR      PRH_T 
                    WHERE
                            PRTC.GLBL_CMPY_CD           = #glblCmpyCd# 
                        AND PRTC.EZCANCELFLAG           = '0' 
                        AND PRTC.PRC_RULE_ATTRB_CD      = #prcRuleAttrb57# 
                        AND PRTC.PRC_RULE_COND_FROM_TXT = TO_CHAR(B.PRC_GRP_PK) 
                        AND PRTC.GLBL_CMPY_CD           = PRH_T.GLBL_CMPY_CD 
                        AND PRTC.PRC_RULE_HDR_PK        = PRH_T.PRC_RULE_HDR_PK 
                        AND PRTC.EZCANCELFLAG           = PRH_T.EZCANCELFLAG 
                        AND PRH_T.EFF_FROM_DT           &lt;= #prcBaseDt# 
                        AND (PRH_T.EFF_THRU_DT          &gt;= #prcBaseDt# OR PRH_T.EFF_THRU_DT IS NULL) 
                        AND PRH_T.ACTV_FLG              = #actvFlg#
                )
            )
            </isEqual>
            <!-- Add End 2018/07/05 QC#26197 -->
    </statement>


    <statement id="selectFrtZone" parameterClass="Map" resultClass="BigDecimal">
        WITH PRC_GRP_V AS (
            SELECT A.GLBL_CMPY_CD
                  ,A.PRC_GRP_PK 
            FROM PRC_GRP A
            WHERE
                A.GLBL_CMPY_CD = #glblCmpyCd#
            AND A.EZCANCELFLAG = '0'
            AND A.PRC_GRP_TP_CD = #prcGrpTpCd#
            AND A.ACTV_FLG = #actvFlg#
            AND A.EFF_FROM_DT &lt;= #prcBaseDt#
            AND (A.EFF_THRU_DT &gt;= #prcBaseDt# OR A.EFF_THRU_DT IS NULL)
            AND (
                SELECT COUNT(DISTINCT PRC_GRP_TRGT_ATTRB_CD) FROM PRC_GRP_DTL B
                WHERE
                    A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
                AND A.EZCANCELFLAG = B.EZCANCELFLAG
                AND A.PRC_GRP_PK = B.PRC_GRP_PK
                AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
            ) = ( 
                SELECT COUNT(DISTINCT PRC_GRP_TRGT_ATTRB_CD) FROM PRC_GRP_DTL B
                WHERE
                    A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
                AND A.EZCANCELFLAG = B.EZCANCELFLAG
                AND A.PRC_GRP_PK = B.PRC_GRP_PK
                AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
                AND
                (
                    CASE B.PRC_GRP_TRGT_ATTRB_CD
                        <isNotNull property="dsAcctNum">
                        WHEN #prcGrpTrgtAttrbCd_14#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="dsAcctNm">
                        WHEN #prcGrpTrgtAttrbCd_15#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctNm# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctNm# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctNm# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctNm# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="dsCustSicCd">
                        WHEN #prcGrpTrgtAttrbCd_16#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsCustSicCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsCustSicCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsCustSicCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsCustSicCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="locNum">
                        WHEN #prcGrpTrgtAttrbCd_17#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #locNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #locNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#locNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #locNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="dsAcctClsCd">
                        WHEN #prcGrpTrgtAttrbCd_18#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctClsCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctClsCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctClsCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctClsCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="dsAcctTpCd">
                        WHEN #prcGrpTrgtAttrbCd_19#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctTpCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctTpCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctTpCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctTpCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="dsAcctDlrCd">
                        WHEN #prcGrpTrgtAttrbCd_20#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dsAcctDlrCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dsAcctDlrCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dsAcctDlrCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dsAcctDlrCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="csmpNum">
                        WHEN #prcGrpTrgtAttrbCd_21#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #csmpNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #csmpNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#csmpNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #csmpNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="dlrRefNum">
                        WHEN #prcGrpTrgtAttrbCd_22#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #dlrRefNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #dlrRefNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#dlrRefNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #dlrRefNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <isNotNull property="prcContrNum">
                        WHEN #prcGrpTrgtAttrbCd_24#  THEN
                            CASE
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #prcContrNum# = B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #prcContrNum# != B.PRC_GRP_FROM_TXT  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#prcContrNum# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #prcContrNum# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                ELSE 0
                            END
                        </isNotNull>
                        <!-- QC#18789 add start -->
                        <isNotNull property="coaChCd">
                         WHEN #prcGrpTrgtAttrbCd_28#  THEN
                             CASE
                                 WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd01# AND #coaChCd# = B.PRC_GRP_FROM_TXT  THEN 1
                                 WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd02# AND #coaChCd# != B.PRC_GRP_FROM_TXT  THEN 1
                                 WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd03# AND (#coaChCd# BETWEEN B.PRC_GRP_FROM_TXT AND B.PRC_GRP_THRU_TXT)  THEN 1
                                 WHEN B.PRC_GRP_OP_CD = #prcGrpOpCd04# AND #coaChCd# LIKE B.PRC_GRP_FROM_TXT || '%' THEN 1
                                 ELSE 0
                             END
                         </isNotNull>
                         <!-- QC#18789 add end -->
                    WHEN NULL THEN 0
                    END
                ) = 1
            )
            AND EXISTS (
                SELECT 1 FROM PRC_GRP_DTL B
                WHERE
                    A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
                AND A.EZCANCELFLAG = B.EZCANCELFLAG
                AND A.PRC_GRP_PK = B.PRC_GRP_PK
                AND B.EFF_FROM_DT &lt;= #prcBaseDt#
                AND (B.EFF_THRU_DT &gt;= #prcBaseDt# OR B.EFF_THRU_DT IS NULL)
            )
        )
        SELECT
            FZ.FRT_ZONE_NUM
        FROM FRT_ZONE FZ
        WHERE 
            FZ.GLBL_CMPY_CD = #glblCmpyCd#
        AND FZ.EZCANCELFLAG = '0'
        AND FZ.LINE_BIZ_TP_CD = #lineBizTpCd#
        AND (FZ.DS_ACCT_NUM = #shipAcctNum# OR FZ.DS_ACCT_NUM IS NULL)
        AND (FZ.SHIP_TO_ST_CD = #shipToStCd# OR FZ.SHIP_TO_ST_CD IS NULL)
        AND (FZ.SHIP_TO_CTRY_CD = #shipToCtryCd# OR FZ.SHIP_TO_CTRY_CD IS NULL) 
        AND (FZ.SHIP_TO_FROM_POST_CD &lt;= #shipToPostCd# OR FZ.SHIP_TO_FROM_POST_CD IS NULL)
        AND (FZ.SHIP_TO_THRU_POST_CD &gt;= #shipToPostCd# OR FZ.SHIP_TO_THRU_POST_CD IS NULL)
        AND FZ.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (FZ.EFF_THRU_DT &gt;= #prcBaseDt# OR FZ.EFF_THRU_DT IS NULL)
        AND (FZ.PRC_GRP_PK IS NULL OR EXISTS(
                SELECT PRC_GRP_PK FROM PRC_GRP_V WPG  
                WHERE FZ.GLBL_CMPY_CD  = WPG.GLBL_CMPY_CD
                AND   FZ.PRC_GRP_PK = WPG.PRC_GRP_PK
            ))
    </statement>

    <statement id="selectPrcRule" parameterClass="Map" resultClass="Map">
        WITH PRC_RULE_TRX_COND_V AS (
            SELECT
    <!-- 2018/11/28 QC#29410 add start -->
     /*+ LEADING(PRH PRTC) USE_NL(PRTC) */
    <!-- 2018/11/28 QC#29410 add end -->
                PRTC.PRC_RULE_TRX_COND_PK
               ,PRTC.PRC_RULE_HDR_PK
            FROM
                PRC_RULE_HDR      PRH
               ,PRC_RULE_TRX_COND PRTC
            WHERE
                PRH.GLBL_CMPY_CD          = #glblCmpyCd#
            AND PRH.LINE_BIZ_TP_CD        = #lineBizTpCd# 
            AND PRH.PRC_RULE_TRX_CATG_CD  = #prcRuleTrxCatgCd#
            AND PRH.APPLY_AUTO_FLG        = #applyAutoFlg#
            AND PRH.DEL_FLG               = #delFlg#
            AND PRH.ACTV_FLG              = #activeFlg#
            AND PRH.EFF_FROM_DT           &lt;= #prcBaseDt#
            AND (PRH.EFF_THRU_DT          &gt;= #prcBaseDt# OR PRH.EFF_THRU_DT IS NULL)
            AND PRH.EZCANCELFLAG          = '0'
            AND PRH.GLBL_CMPY_CD          = PRTC.GLBL_CMPY_CD
            AND PRH.PRC_RULE_HDR_PK       = PRTC.PRC_RULE_HDR_PK
            AND PRTC.PRC_RULE_TRX_CATG_CD = #prcRuleTrxCatgCd#
            AND PRTC.EFF_FROM_DT          &lt;= #prcBaseDt#
            AND (PRTC.EFF_THRU_DT         &gt;= #prcBaseDt# OR PRTC.EFF_THRU_DT IS NULL)
            AND PRTC.EZCANCELFLAG         = '0'
            AND ( CASE PRTC.PRC_RULE_ATTRB_CD
                  <isNotNull property="prcRuleAttrb10">
                      <isNotNull property="mdseCd">
                      WHEN #prcRuleAttrb10# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #mdseCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #mdseCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb10">
                      <isNotNull property="ordTakeMdseCd">
                      WHEN #prcRuleAttrb10# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #ordTakeMdseCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #ordTakeMdseCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb54">
                      <isNotNull property="dsAcctNum">
                      WHEN #prcRuleAttrb54# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsAcctNum# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsAcctNum# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb53">
                      <isNotNull property="customerPrcGrp">
                      WHEN #prcRuleAttrb53# THEN
                          CASE
                              WHEN PRC_RULE_COND_FROM_TXT IN
                                       <iterate property="customerPrcGrp" var="customerPrcGrpPk[]" open="(" close=")" conjunction=",">
                                       #customerPrcGrpPk[]#
                                       </iterate>
                              THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb27">
                      <isNotNull property="mktMdlCd">
                      WHEN #prcRuleAttrb27# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #mktMdlCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #mktMdlCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb11">
                      <isNotNull property="dsOrdCatgCd">
                      WHEN #prcRuleAttrb11# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsOrdCatgCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsOrdCatgCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb26">
                      <isNotNull property="lineQty">
                      WHEN #prcRuleAttrb26# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND TO_NUMBER(PRC_RULE_COND_FROM_TXT) = #lineQty# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #lineQty# BETWEEN TO_NUMBER(PRC_RULE_COND_FROM_TXT) AND TO_NUMBER(PRC_RULE_COND_THRU_TXT) THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb12">
                      <isNotNull property="dsOrdTpCd">
                      WHEN #prcRuleAttrb12# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsOrdTpCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsOrdTpCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb01">
                      <isNotNull property="coaChCdSH">
                      WHEN #prcRuleAttrb01# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #coaChCdSH# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #coaChCdSH# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb02">
                      <isNotNull property="customerPrcGrpSH">
                      WHEN #prcRuleAttrb02# THEN
                          CASE
                              WHEN PRC_RULE_COND_FROM_TXT IN
                                       <iterate property="customerPrcGrpSH" var="customerPrcGrpSHPK[]" open="(" close=")" conjunction=",">
                                           #customerPrcGrpSHPK[]#
                                       </iterate>
                              THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb03">
                      <isNotNull property="dsAcctNumSH">
                      WHEN #prcRuleAttrb03# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsAcctNumSH# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsAcctNumSH# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb04">
                      <isNotNull property="csmpNum">
                      WHEN #prcRuleAttrb04# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #csmpNum# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #csmpNum# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb05">
                      <isNotNull property="materialPrcGrp">
                      WHEN #prcRuleAttrb05# THEN
                          CASE
                              WHEN PRC_RULE_COND_FROM_TXT IN
                                       <iterate property="materialPrcGrp" var="materialPrcGrpPk[]" open="(" close=")" conjunction=",">
                                           #materialPrcGrpPk[]#
                                       </iterate>
                              THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb06">
                      <isNotNull property="zerothProdCtrlCd">
                      WHEN #prcRuleAttrb06# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #zerothProdCtrlCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #zerothProdCtrlCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb07">
                      <isNotNull property="firstProdCtrlCd">
                      WHEN #prcRuleAttrb07# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #firstProdCtrlCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #firstProdCtrlCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb08">
                      <isNotNull property="coaMdseTpCd">
                      WHEN #prcRuleAttrb08# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #coaMdseTpCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #coaMdseTpCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb09">
                      <isNotNull property="coaProdCd">
                      WHEN #prcRuleAttrb09# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #coaProdCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #coaProdCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb13">
                      <isNotNull property="lineBizTpCd">
                          <isNotNull property="lineBizTpCdAll">
                          WHEN #prcRuleAttrb13# THEN
                              CASE
                                  WHEN PRC_RULE_COND_FROM_TXT IS NOT NULL THEN 1
                                  ELSE 0
                              END
                          </isNotNull>
                          <isNull property="lineBizTpCdAll">
                          WHEN #prcRuleAttrb13# THEN
                              CASE
                                  WHEN PRC_RULE_COND_FROM_TXT = #lineBizTpCd# THEN 1
                                  ELSE 0
                              END
                          </isNull>
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb14">
                      <isNotNull property="transactionPrcGrp">
                      WHEN #prcRuleAttrb14# THEN
                          CASE
                              WHEN PRC_RULE_COND_FROM_TXT IN
                                  <iterate property="transactionPrcGrp" var="transactionPrcGrpPk[]" open="(" close=")" conjunction=",">
                                      #transactionPrcGrpPk[]#
                                  </iterate>
                              THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb15">
                      <isNotNull property="xxTotUnitNetWt">
                      WHEN #prcRuleAttrb15# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND TO_NUMBER(PRC_RULE_COND_FROM_TXT) = #xxTotUnitNetWt# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #xxTotUnitNetWt# BETWEEN TO_NUMBER(PRC_RULE_COND_FROM_TXT) AND TO_NUMBER(PRC_RULE_COND_THRU_TXT) THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb16">
                      <isNotNull property="dsAcctNumBL">
                      WHEN #prcRuleAttrb16# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsAcctNumBL# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsAcctNumBL# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb17">
                      <isNotNull property="coaChCdBL">
                      WHEN #prcRuleAttrb17# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #coaChCdBL# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #coaChCdBL# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb18">
                      <isNotNull property="dsAcctClsCdBL">
                      WHEN #prcRuleAttrb18# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsAcctClsCdBL# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsAcctClsCdBL# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb19">
                      <isNotNull property="coaBrCd">
                      WHEN #prcRuleAttrb19# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #coaBrCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #coaBrCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb20">
                      <isNotNull property="svcCallTpCd">
                      WHEN #prcRuleAttrb20# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #svcCallTpCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #svcCallTpCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb21">
                      <isNotNull property="svcCallIncdtDt">
                      WHEN #prcRuleAttrb21# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #svcCallIncdtDt# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #svcCallIncdtDt# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb22">
                      <isNotNull property="custIssPoNum">
                      WHEN #prcRuleAttrb22# THEN
                          CASE
                              <!-- 2019/04/04 QC#30756 Mod Start -->
                              <!-- WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #custIssPoNum# THEN 1 -->
                              <!-- WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #custIssPoNum# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1 -->
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND UPPER(PRC_RULE_COND_FROM_TXT) = UPPER(#custIssPoNum#) THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND UPPER(#custIssPoNum#) BETWEEN UPPER(PRC_RULE_COND_FROM_TXT) AND UPPER(PRC_RULE_COND_THRU_TXT) THEN 1
                              <!-- 2019/04/04 QC#30756 Mod End -->
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb23">
                      <isNotNull property="customerPrcGrpBL">
                      WHEN #prcRuleAttrb23# THEN
                          CASE
                              WHEN PRC_RULE_COND_FROM_TXT IN
                                  <iterate property="customerPrcGrpBL" var="customerPrcGrpBLPk[]" open="(" close=")" conjunction=",">
                                      #customerPrcGrpBLPk[]#
                                  </iterate>
                              THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb24">
                      <isNotNull property="entCpoDtlDealSlsAmt">
                      WHEN #prcRuleAttrb24# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND TO_NUMBER(PRC_RULE_COND_FROM_TXT) = TO_NUMBER(#entCpoDtlDealSlsAmt#) THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND TO_NUMBER(#entCpoDtlDealSlsAmt#) BETWEEN TO_NUMBER(PRC_RULE_COND_FROM_TXT) AND TO_NUMBER(PRC_RULE_COND_THRU_TXT) THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb25">
                      <isNotNull property="dsOrdLineCatgCd">
                      WHEN #prcRuleAttrb25# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsOrdLineCatgCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsOrdLineCatgCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb28">
                      <isNotNull property="mktMdlSegCd">
                      WHEN #prcRuleAttrb28# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #mktMdlSegCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #mktMdlSegCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb29">
                      <isNotNull property="cpoSrcTpCd">
                      WHEN #prcRuleAttrb29# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #cpoSrcTpCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #cpoSrcTpCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb30">
                      <isNotNull property="xxTotAmt">
                      WHEN #prcRuleAttrb30# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND TO_NUMBER(PRC_RULE_COND_FROM_TXT) = #xxTotAmt# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #xxTotAmt# BETWEEN TO_NUMBER(PRC_RULE_COND_FROM_TXT) AND TO_NUMBER(PRC_RULE_COND_THRU_TXT) THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb31">
                      <isNotNull property="dsPmtMethCd">
                      WHEN #prcRuleAttrb31# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsPmtMethCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsPmtMethCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb32">
                      <isNotNull property="prcCatgCd">
                      WHEN #prcRuleAttrb32# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #prcCatgCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #prcCatgCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb33">
                      <isNotNull property="prcBaseDt">
                      WHEN #prcRuleAttrb33# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #prcBaseDt# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #prcBaseDt# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb34">
                      <isNotNull property="scdProdCtrlCd">
                      WHEN #prcRuleAttrb34# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #scdProdCtrlCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #scdProdCtrlCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb35">
                      <isNotNull property="thirdProdCtrlCd">
                      WHEN #prcRuleAttrb35# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #thirdProdCtrlCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #thirdProdCtrlCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb36">
                      <isNotNull property="frthProdCtrlCd">
                      WHEN #prcRuleAttrb36# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #frthProdCtrlCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #frthProdCtrlCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb37">
                      <isNotNull property="orgRqstDelyDt">
                      WHEN #prcRuleAttrb37# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #orgRqstDelyDt# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #orgRqstDelyDt# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb38">
                      <isNotNull property="rtrnRsnCd">
                      WHEN #prcRuleAttrb38# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #rtrnRsnCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #rtrnRsnCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb39">
                      <isNotNull property="shpgSvcLvlCd">
                      WHEN #prcRuleAttrb39# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #shpgSvcLvlCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #shpgSvcLvlCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb40">
                      <isNotNull property="mdlId">
                      WHEN #prcRuleAttrb40# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND TO_NUMBER(PRC_RULE_COND_FROM_TXT) = #mdlId# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #mdlId# BETWEEN TO_NUMBER(PRC_RULE_COND_FROM_TXT) AND TO_NUMBER(PRC_RULE_COND_THRU_TXT) THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb41">
                      <isNotNull property="prcSvcZoneCd">
                      WHEN #prcRuleAttrb41# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #prcSvcZoneCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #prcSvcZoneCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb42">
                      <isNotNull property="dsAcctClsCdSH">
                      WHEN #prcRuleAttrb42# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsAcctClsCdSH# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsAcctClsCdSH# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb44">
                      <isNotNull property="spclHdlgTpCd">
                      WHEN #prcRuleAttrb44# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #spclHdlgTpCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #spclHdlgTpCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb45">
                      <isNotNull property="totQty">
                      WHEN #prcRuleAttrb45# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND TO_NUMBER(PRC_RULE_COND_FROM_TXT) = #totQty# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #totQty# BETWEEN TO_NUMBER(PRC_RULE_COND_FROM_TXT) AND TO_NUMBER(PRC_RULE_COND_THRU_TXT) THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb46">
                      <isNotNull property="coaExtnCd">
                      WHEN #prcRuleAttrb46# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #coaExtnCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #coaExtnCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb48">
                      <isNotNull property="frtTerm">
                      WHEN #prcRuleAttrb48# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #frtTerm# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #frtTerm# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb49">
                      <isNotNull property="frtZone">
                      WHEN #prcRuleAttrb49# THEN
                          CASE
                              WHEN PRC_RULE_COND_FROM_TXT IN 
                                  <iterate property="frtZone" var="frtZonePk[]" open="(" close=")" conjunction=",">
                                      #frtZonePk[]#
                                  </iterate>
                              THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb55">
                      <isNotNull property="coaChCd">
                      WHEN #prcRuleAttrb55# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #coaChCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #coaChCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb56">
                      <isNotNull property="dsAcctClsCd">
                      WHEN #prcRuleAttrb56# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #dsAcctClsCd# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #dsAcctClsCd# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb57">
                      <isNotNull property="materialPrcGrpqtyBreak">
                      WHEN #prcRuleAttrb57# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #materialPrcGrpqtyBreak# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #materialPrcGrpqtyBreak# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb58">
                      <isNotNull property="lineQtyQtyBleak">
                      WHEN #prcRuleAttrb58# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #lineQtyQtyBleak# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #lineQtyQtyBleak# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <!-- 2018/04/24 QC#22569 add start -->
                  <isNotNull property="prcRuleAttrb59">
                      <isNotNull property="slsMatGrpCd_01">
                      WHEN #prcRuleAttrb59# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #slsMatGrpCd_01# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #slsMatGrpCd_01# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb60">
                      <isNotNull property="slsMatGrpCd_02">
                      WHEN #prcRuleAttrb60# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #slsMatGrpCd_02# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #slsMatGrpCd_02# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <isNotNull property="prcRuleAttrb61">
                      <isNotNull property="slsMatGrpCd_03">
                      WHEN #prcRuleAttrb61# THEN
                          CASE
                              WHEN PRC_RULE_COND_THRU_TXT IS NULL AND PRC_RULE_COND_FROM_TXT = #slsMatGrpCd_03# THEN 1
                              WHEN PRC_RULE_COND_THRU_TXT IS NOT NULL AND #slsMatGrpCd_03# BETWEEN PRC_RULE_COND_FROM_TXT AND PRC_RULE_COND_THRU_TXT THEN 1
                              ELSE 0
                          END
                      </isNotNull>
                  </isNotNull>
                  <!-- 2018/04/24 QC#22569 add end -->
                  ELSE 0 END
                ) = 1
        )  --WITH
        SELECT
        <!-- 2018/11/28 QC#29410 add start -->
         /*+ USE_NL(PRD) USE_NL(PF) USE_NL(SCP) LEADING(PRH PRD PRCH SCP PF) */
        <!-- 2018/11/28 QC#29410 add end -->
             PRH.PRC_RULE_CATG_CD      -- CATEGORY
            ,PRH.PRC_RULE_HDR_PK       -- RULE KEY
            ,PRH.DEF_RULE_PRCD_NUM     -- DEFAULT PRECEDENCE
            ,PRD.PRC_RULE_DTL_PK       -- RULE DETAIL KEY
            ,PRCH.PRC_RULE_COND_GRP_CD -- CONDITION GROUP CODE (A, B)
            ,PRD.PRC_RULE_DTL_CHRG_NM  -- CHARGE NAME (MANUAL ENTRY)
            ,PRD.PRC_RULE_MOD_TP_CD    -- MODIFY (CHARGES, SELL PRICE)
            ,PRD.PRC_RULE_ADJ_TP_CD    -- ADJUST (SET PRICE, ADD CHARGE, DISCOUNT, SURCHARGE)
            ,PRD.PRC_RULE_ADJ_LVL_CD   -- LEVEL (HEADER , LINE)
            ,PRD.PRC_FMLA_PK           -- FORMULA
            ,PRD.PRC_RULE_DTL_RATE     -- PERCENT
            ,PRD.PRC_RULE_DTL_TXT      -- VALUE
            ,PRD.PRC_RULE_ATTRB_CD     -- ATTRB (50:FORMURA, 51:PERCENT,52:AMOUNT)
            ,SCP.SPEC_COND_PRC_PK      -- SPEC CONDTION PRICE PK
            ,PF.PRC_FMLA_TP_CD         -- FORMULA TYPE
            ,PF.PRC_FMLA_NUM           -- FORMULA TEXT
            ,PF.PRC_FUNC_TP_CD         -- FORMULA FUNC TYPE CODE
        FROM
             PRC_RULE_HDR PRH
            ,PRC_RULE_DTL PRD
            ,PRC_RULE_COND_HDR PRCH
            ,SPEC_COND_PRC SCP
            ,(
                SELECT 
                    GLBL_CMPY_CD
                   ,EZCANCELFLAG
                   ,PRC_FMLA_PK
                   ,PRC_FMLA_TP_CD
                   ,PRC_FMLA_NUM
                   ,PRC_FUNC_TP_CD
                FROM PRC_FMLA
                WHERE
                    GLBL_CMPY_CD = #glblCmpyCd#
                AND EZCANCELFLAG = '0'
                AND EFF_FROM_DT &lt;= #prcBaseDt#
                AND (EFF_THRU_DT &gt;= #prcBaseDt# OR EFF_THRU_DT IS NULL)
                AND ACTV_FLG = #activeFlg#
            ) PF
        WHERE
            PRH.GLBL_CMPY_CD = #glblCmpyCd#
        AND PRH.EZCANCELFLAG = '0'
        AND PRH.LINE_BIZ_TP_CD = #lineBizTpCd#
        AND PRH.PRC_RULE_TRX_CATG_CD = #prcRuleTrxCatgCd#
        AND PRH.APPLY_AUTO_FLG = #applyAutoFlg#
        AND PRH.DEL_FLG = #delFlg#
        AND PRH.ACTV_FLG = #activeFlg#
        AND PRH.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PRH.EFF_THRU_DT &gt;= #prcBaseDt# OR PRH.EFF_THRU_DT IS NULL)

        AND PRH.GLBL_CMPY_CD = PRD.GLBL_CMPY_CD
        AND PRH.EZCANCELFLAG = PRD.EZCANCELFLAG
        AND PRH.PRC_RULE_HDR_PK = PRD.PRC_RULE_HDR_PK
        <isEqual property="prcRuleAdjLvlCd" compareValue="01">
        AND PRD.PRC_RULE_ADJ_LVL_CD = #prcRuleAdjLvlCd#
        </isEqual>
        <isEqual property="prcRuleAdjLvlCd" compareValue="02">
        AND PRD.PRC_RULE_ADJ_LVL_CD = #prcRuleAdjLvlCd#
        </isEqual>
        <isNotNull property="prcRuleModTpCd">
        AND PRD.PRC_RULE_MOD_TP_CD = #prcRuleModTpCd#
        </isNotNull>
        AND PRD.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PRD.EFF_THRU_DT &gt;= #prcBaseDt# OR PRD.EFF_THRU_DT IS NULL)

        AND PRD.GLBL_CMPY_CD = PRCH.GLBL_CMPY_CD
        AND PRD.EZCANCELFLAG = PRCH.EZCANCELFLAG
        AND PRD.PRC_RULE_COND_HDR_PK = PRCH.PRC_RULE_COND_HDR_PK
        AND PRD.PRC_RULE_HDR_PK = PRCH.PRC_RULE_HDR_PK
        AND PRCH.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PRCH.EFF_THRU_DT &gt;= #prcBaseDt# OR PRCH.EFF_THRU_DT IS NULL)

        AND PRD.GLBL_CMPY_CD = SCP.GLBL_CMPY_CD
        AND PRD.EZCANCELFLAG = SCP.EZCANCELFLAG
        AND PRD.PRC_RULE_DTL_PK = SCP.PRC_RULE_DTL_PK

        AND PRD.GLBL_CMPY_CD = PF.GLBL_CMPY_CD(+)
        AND PRD.EZCANCELFLAG = PF.EZCANCELFLAG(+)
        AND PRD.PRC_FMLA_PK = PF.PRC_FMLA_PK(+)

        AND (
            (PRCH.PRC_RULE_OP_TP_CD = #prcRuleOpTpAnd#
                AND EXISTS (
                    SELECT 1
                    FROM
                    (
                        SELECT 
                               DTL.GLBL_CMPY_CD
                              ,DTL.EZCANCELFLAG
                              ,DTL.PRC_RULE_COND_HDR_PK
                              ,COUNT(DTL.PRC_RULE_TRX_COND_PK) CNT1
                              ,COUNT(V.PRC_RULE_TRX_COND_PK)   CNT2
                        FROM   PRC_RULE_COND_HDR HDR
                              ,PRC_RULE_COND_DTL DTL
                              ,PRC_RULE_TRX_COND_V V
                        WHERE  HDR.GLBL_CMPY_CD = DTL.GLBL_CMPY_CD
                        AND    HDR.EZCANCELFLAG = DTL.EZCANCELFLAG
                        AND    HDR.PRC_RULE_COND_HDR_PK = DTL.PRC_RULE_COND_HDR_PK
                        AND    HDR.PRC_RULE_HDR_PK = V.PRC_RULE_HDR_PK(+)
                        AND    DTL.PRC_RULE_TRX_COND_PK = V.PRC_RULE_TRX_COND_PK(+)
                        GROUP BY
                               DTL.GLBL_CMPY_CD
                              ,DTL.EZCANCELFLAG
                              ,DTL.PRC_RULE_COND_HDR_PK
                    ) COND
                    WHERE COND.GLBL_CMPY_CD = PRCH.GLBL_CMPY_CD
                    AND   COND.EZCANCELFLAG = PRCH.EZCANCELFLAG
                    AND   COND.PRC_RULE_COND_HDR_PK = PRCH.PRC_RULE_COND_HDR_PK
                    AND   COND.CNT1 = COND.CNT2
                )
             )
          OR 
            (PRCH.PRC_RULE_OP_TP_CD = #prcRuleOpTpOr#
                AND EXISTS (
                    SELECT 1
                    FROM
                    (
                        SELECT 
                               DTL.GLBL_CMPY_CD
                              ,DTL.EZCANCELFLAG
                              ,DTL.PRC_RULE_COND_HDR_PK
                        FROM   PRC_RULE_TRX_COND_V V
                              ,PRC_RULE_COND_DTL DTL
                        WHERE V.PRC_RULE_TRX_COND_PK    = DTL.PRC_RULE_TRX_COND_PK
                        AND   DTL.GLBL_CMPY_CD          = #glblCmpyCd#
                        AND   DTL.EZCANCELFLAG          = '0'
                    ) COND
                    WHERE COND.GLBL_CMPY_CD = PRCH.GLBL_CMPY_CD
                    AND   COND.EZCANCELFLAG = PRCH.EZCANCELFLAG
                    AND   COND.PRC_RULE_COND_HDR_PK = PRCH.PRC_RULE_COND_HDR_PK
                )
            )
        )
        UNION ALL
        SELECT
        <!-- 2018/11/28 QC#29410 add start -->
         /*+ LEADING(PAD PRH PAC PRA SCP PF) INDEX(PAD PRC_ADJ_DTL_I3) USE_NL(PRA) INDEX(PRA PRC_RULE_ATTRB_PK) */
        <!-- 2018/11/28 QC#29410 add end -->
             PRH.PRC_RULE_CATG_CD      -- CATEGORY
            ,PRH.PRC_RULE_HDR_PK       -- RULE KEY
            ,PRH.DEF_RULE_PRCD_NUM     -- DEFAULT PRECEDENCE
            ,PAD.PRC_RULE_DTL_PK       -- RULE DETAIL KEY
            ,NULL AS PRC_RULE_COND_GRP_CD -- CONDITION GROUP CODE (A, B)
            ,PAD.PRC_RULE_DTL_CHRG_NM  -- CHARGE NAME (MANUAL ENTRY)
            ,PRH.PRC_RULE_MOD_TP_CD    -- MODIFY (CHARGES, SELL PRICE)
            ,PRH.PRC_RULE_ADJ_TP_CD    -- ADJUST (SET PRICE, ADD CHARGE, DISCOUNT, SURCHARGE)
            ,PRH.PRC_RULE_ADJ_LVL_CD   -- LEVEL (HEADER , LINE)
            ,PAD.PRC_FMLA_PK           -- FORMULA
            ,PAD.PRC_RULE_DTL_RATE     -- PERCENT
            ,PAD.PRC_RULE_DTL_TXT      -- VALUE
            ,PAC.PRC_RULE_ATTRB_CD     -- ATTRB (50:FORMURA, 51:PERCENT,52:AMOUNT)
            ,SCP.SPEC_COND_PRC_PK      -- SPEC CONDTION PRICE PK
            ,PF.PRC_FMLA_TP_CD         -- FORMULA TYPE
            ,PF.PRC_FMLA_NUM           -- FORMULA TEXT
            ,PF.PRC_FUNC_TP_CD         -- FORMULA FUNC TYPE CODE
        FROM
             PRC_RULE_HDR PRH
            ,PRC_ADJ_DTL PAD
            ,PRC_ADJ_COND PAC
            ,PRC_RULE_ATTRB PRA
            ,SPEC_COND_PRC SCP
            ,(
                SELECT 
                    GLBL_CMPY_CD
                   ,EZCANCELFLAG
                   ,PRC_FMLA_PK
                   ,PRC_FMLA_TP_CD
                   ,PRC_FMLA_NUM
                   ,PRC_FUNC_TP_CD
                FROM PRC_FMLA
                WHERE
                    GLBL_CMPY_CD = #glblCmpyCd#
                AND EZCANCELFLAG = '0'
                AND EFF_FROM_DT &lt;= #prcBaseDt#
                AND (EFF_THRU_DT &gt;= #prcBaseDt# OR EFF_THRU_DT IS NULL)
                AND ACTV_FLG = #activeFlg#
            ) PF
        WHERE
            PRH.GLBL_CMPY_CD = #glblCmpyCd#
        AND PRH.EZCANCELFLAG = '0'
        AND PRH.LINE_BIZ_TP_CD = #lineBizTpCd#
        AND PRH.PRC_RULE_TRX_CATG_CD = #prcRuleTrxCatgCd#
        AND PRH.APPLY_AUTO_FLG = #applyAutoFlg#
        AND PRH.DEL_FLG = #delFlg#
        AND PRH.ACTV_FLG = #activeFlg#
        AND PRH.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PRH.EFF_THRU_DT &gt;= #prcBaseDt# OR PRH.EFF_THRU_DT IS NULL)

        AND PRH.GLBL_CMPY_CD        = PAC.GLBL_CMPY_CD 
        AND PRH.PRC_RULE_HDR_PK     = PAC.PRC_RULE_HDR_PK 
        AND PRH.EZCANCELFLAG        = PAC.EZCANCELFLAG

        AND PAC.GLBL_CMPY_CD        = PRA.GLBL_CMPY_CD 
        AND PAC.PRC_RULE_ATTRB_CD   = PRA.PRC_RULE_ATTRB_CD 
        AND PAC.EZCANCELFLAG        = PRA.EZCANCELFLAG
        AND PRA.MOD_FLD_FLG         = #modFlgFlg#

        AND PRH.GLBL_CMPY_CD = PAD.GLBL_CMPY_CD
        AND PRH.EZCANCELFLAG = PAD.EZCANCELFLAG
        AND PRH.PRC_RULE_HDR_PK = PAD.PRC_RULE_HDR_PK
        <isEqual property="prcRuleAdjLvlCd" compareValue="01">
        AND PRH.PRC_RULE_ADJ_LVL_CD = #prcRuleAdjLvlCd#
        </isEqual>
        <isEqual property="prcRuleAdjLvlCd" compareValue="02">
        AND PRH.PRC_RULE_ADJ_LVL_CD = #prcRuleAdjLvlCd#
        </isEqual>
        <isNotNull property="prcRuleModTpCd">
        AND PRH.PRC_RULE_MOD_TP_CD = #prcRuleModTpCd#
        </isNotNull>
        AND PAD.EFF_FROM_DT &lt;= #prcBaseDt#
        AND (PAD.EFF_THRU_DT &gt;= #prcBaseDt# OR PAD.EFF_THRU_DT IS NULL)

        AND PAD.GLBL_CMPY_CD = SCP.GLBL_CMPY_CD
        AND PAD.EZCANCELFLAG = SCP.EZCANCELFLAG
        AND PAD.PRC_RULE_DTL_PK = SCP.PRC_RULE_DTL_PK

        AND PAD.GLBL_CMPY_CD = PF.GLBL_CMPY_CD(+)
        AND PAD.EZCANCELFLAG = PF.EZCANCELFLAG(+)
        AND PAD.PRC_FMLA_PK = PF.PRC_FMLA_PK(+)

        AND ( PAD.PRC_RULE_COND_FROM_TXT_04 = #csmpNum# OR PAD.PRC_RULE_COND_FROM_TXT_04 = #wildCard# )
        <isNotNull property="materialPrcGrp">
        AND ( PRC_RULE_COND_FROM_TXT_05 IN
             <iterate property="materialPrcGrp" var="materialPrcGrpPk[]" open="(" close=")" conjunction=",">
                 #materialPrcGrpPk[]#
             </iterate>
            OR PRC_RULE_COND_FROM_TXT_05 = #wildCard# )
        </isNotNull>
        <isNull property="materialPrcGrp">
        AND ( PRC_RULE_COND_FROM_TXT_05 = #wildCard# )
        </isNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_06 = #zerothProdCtrlCd# OR PAD.PRC_RULE_COND_FROM_TXT_06 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_07 = #firstProdCtrlCd# OR PAD.PRC_RULE_COND_FROM_TXT_07 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_08 = #coaMdseTpCd# OR PAD.PRC_RULE_COND_FROM_TXT_08 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_09 = #coaProdCd# OR PAD.PRC_RULE_COND_FROM_TXT_09 = #wildCard# )
        <isNotNull property="ordTakeMdseCd">
        AND ( PAD.PRC_RULE_COND_FROM_TXT_10 = #ordTakeMdseCd# OR PAD.PRC_RULE_COND_FROM_TXT_10 = #wildCard# )
        </isNotNull>
        <isNull property="ordTakeMdseCd">
        AND ( PAD.PRC_RULE_COND_FROM_TXT_10 = #mdseCd# OR PAD.PRC_RULE_COND_FROM_TXT_10 = #wildCard# )
        </isNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_11 = #dsOrdCatgCd# OR PAD.PRC_RULE_COND_FROM_TXT_11 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_12 = #dsOrdTpCd# OR PAD.PRC_RULE_COND_FROM_TXT_12 = #wildCard# )
        <isNull property="lineBizTpCdAll">
        AND ( PAD.PRC_RULE_COND_FROM_TXT_13 = #lineBizTpCd# OR PAD.PRC_RULE_COND_FROM_TXT_13 = #wildCard# )
        </isNull>
        <isNotNull property="transactionPrcGrp">
        AND ( PAD.PRC_RULE_COND_FROM_TXT_14 IN
             <iterate property="transactionPrcGrp" var="transactionPrcGrpPk[]" open="(" close=")" conjunction=",">
                 #transactionPrcGrpPk[]#
             </iterate>
            OR PAD.PRC_RULE_COND_FROM_TXT_14 = #wildCard# )
        </isNotNull>
        <isNull property="transactionPrcGrp">
        AND ( PRC_RULE_COND_FROM_TXT_14 = #wildCard# )
        </isNull>
        <isNotNull property="xxTotUnitNetWt">
        AND #xxTotUnitNetWt# BETWEEN TO_NUMBER(DECODE(PAD.PRC_RULE_COND_FROM_TXT_15, #wildCard#, -99999.9999, PAD.PRC_RULE_COND_FROM_TXT_15)) AND TO_NUMBER(DECODE(PAD.PRC_RULE_COND_THRU_TXT_15, #wildCard#, 99999.9999, PAD.PRC_RULE_COND_THRU_TXT_15))
        </isNotNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_16 = #dsAcctNumBL# OR PAD.PRC_RULE_COND_FROM_TXT_16 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_17 = #coaChCdBL# OR PAD.PRC_RULE_COND_FROM_TXT_17 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_18 = #dsAcctClsCdBL# OR PAD.PRC_RULE_COND_FROM_TXT_18 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_19 = #coaBrCd# OR PAD.PRC_RULE_COND_FROM_TXT_19 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_20 = #svcCallTpCd# OR PAD.PRC_RULE_COND_FROM_TXT_20 = #wildCard# )
        AND ( #svcCallIncdtDt# BETWEEN PAD.PRC_RULE_COND_FROM_TXT_21 AND PAD.PRC_RULE_COND_THRU_TXT_21 OR PRC_RULE_COND_FROM_TXT_21 = #wildCard# )
        <!-- 2019/04/04 QC#30756 Mod Start -->
        <!-- AND ( #custIssPoNum# BETWEEN PAD.PRC_RULE_COND_FROM_TXT_22 AND PAD.PRC_RULE_COND_THRU_TXT_22 OR PRC_RULE_COND_FROM_TXT_22 = #wildCard# ) -->
        AND ( UPPER(#custIssPoNum#) BETWEEN UPPER(PAD.PRC_RULE_COND_FROM_TXT_22) AND UPPER(PAD.PRC_RULE_COND_THRU_TXT_22) OR PRC_RULE_COND_FROM_TXT_22 = #wildCard# )
        <!-- 2019/04/04 QC#30756 Mod End -->
        <isNotNull property="entCpoDtlDealSlsAmt">
        AND #entCpoDtlDealSlsAmt# BETWEEN TO_NUMBER(DECODE(PAD.PRC_RULE_COND_FROM_TXT_24, #wildCard#, -999999999999999.9999, PAD.PRC_RULE_COND_FROM_TXT_24)) AND TO_NUMBER(DECODE(PAD.PRC_RULE_COND_THRU_TXT_24, #wildCard#, 999999999999999.9999, PAD.PRC_RULE_COND_THRU_TXT_24))
        </isNotNull>
        <isNull property="entCpoDtlDealSlsAmt">
        AND ( PRC_RULE_COND_FROM_TXT_24 = #wildCard# )
        </isNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_25 = #dsOrdLineCatgCd# OR PAD.PRC_RULE_COND_FROM_TXT_25 = #wildCard# )
        <isNotNull property="lineQty">
        AND #lineQty# BETWEEN TO_NUMBER(DECODE(PAD.PRC_RULE_COND_FROM_TXT_26, #wildCard#, -9999999999, PAD.PRC_RULE_COND_FROM_TXT_26)) AND TO_NUMBER(DECODE(PAD.PRC_RULE_COND_THRU_TXT_26, #wildCard#, 9999999999, PAD.PRC_RULE_COND_THRU_TXT_26))
        </isNotNull>
        <isNull property="lineQty">
        AND ( PRC_RULE_COND_FROM_TXT_26 = #wildCard# )
        </isNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_27 = #mktMdlCd# OR PAD.PRC_RULE_COND_FROM_TXT_27 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_28 = #mktMdlSegCd# OR PAD.PRC_RULE_COND_FROM_TXT_28 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_29 = #cpoSrcTpCd# OR PAD.PRC_RULE_COND_FROM_TXT_29 = #wildCard# )
        <isNotNull property="xxTotAmt">
        AND #xxTotAmt# BETWEEN TO_NUMBER(DECODE(PAD.PRC_RULE_COND_FROM_TXT_30, #wildCard#, -999999999999999.9999, PAD.PRC_RULE_COND_FROM_TXT_30)) AND TO_NUMBER(DECODE(PAD.PRC_RULE_COND_THRU_TXT_30, #wildCard#, 999999999999999.9999, PAD.PRC_RULE_COND_THRU_TXT_30))
        </isNotNull>
        <isNull property="xxTotAmt">
        AND ( PRC_RULE_COND_FROM_TXT_30 = #wildCard# )
        </isNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_31 = #dsPmtMethCd# OR PAD.PRC_RULE_COND_FROM_TXT_31 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_32 = #prcCatgCd# OR PAD.PRC_RULE_COND_FROM_TXT_32 = #wildCard# )
        AND ( #prcBaseDt# BETWEEN PAD.PRC_RULE_COND_FROM_TXT_33 AND PAD.PRC_RULE_COND_THRU_TXT_33 OR PRC_RULE_COND_FROM_TXT_33 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_34 = #scdProdCtrlCd# OR PAD.PRC_RULE_COND_FROM_TXT_34 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_35 = #thirdProdCtrlCd# OR PAD.PRC_RULE_COND_FROM_TXT_35 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_36 = #thirdProdCtrlCd# OR PAD.PRC_RULE_COND_FROM_TXT_36 = #wildCard# )
        AND ( #orgRqstDelyDt# BETWEEN PAD.PRC_RULE_COND_FROM_TXT_37 AND PAD.PRC_RULE_COND_THRU_TXT_37 OR PRC_RULE_COND_FROM_TXT_37 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_38 = #rtrnRsnCd# OR PAD.PRC_RULE_COND_FROM_TXT_38 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_39 = #shpgSvcLvlCd# OR PAD.PRC_RULE_COND_FROM_TXT_39 = #wildCard# )
        <isNotNull property="mdlId">
        AND ( PAD.PRC_RULE_COND_FROM_TXT_40 = TO_CHAR(#mdlId#) OR PAD.PRC_RULE_COND_FROM_TXT_40 = #wildCard# )
        </isNotNull>
        <isNull property="mdlId">
        AND ( PRC_RULE_COND_FROM_TXT_40 = #wildCard# )
        </isNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_41 = #prcSvcZoneCd# OR PAD.PRC_RULE_COND_FROM_TXT_41 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_42 = #dsAcctClsCdSH# OR PAD.PRC_RULE_COND_FROM_TXT_42 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_44 = #spclHdlgTpCd# OR PAD.PRC_RULE_COND_FROM_TXT_44 = #wildCard# )
        <isNotNull property="totQty">
       AND #totQty# BETWEEN TO_NUMBER(DECODE(PAD.PRC_RULE_COND_FROM_TXT_45, #wildCard#, -9999999999, PAD.PRC_RULE_COND_FROM_TXT_45)) AND TO_NUMBER(DECODE(PAD.PRC_RULE_COND_THRU_TXT_45, #wildCard#, 9999999999, PAD.PRC_RULE_COND_THRU_TXT_45))
       </isNotNull>
        <isNull property="totQty">
        AND ( PRC_RULE_COND_FROM_TXT_45 = #wildCard# )
        </isNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_46 = #coaExtnCd# OR PAD.PRC_RULE_COND_FROM_TXT_46 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_48 = #frtTerm# OR PAD.PRC_RULE_COND_FROM_TXT_48 = #wildCard# )
        <isNotNull property="frtZone">
        AND ( PAD.PRC_RULE_COND_FROM_TXT_49 IN
             <iterate property="frtZone" var="frtZonePk[]" open="(" close=")" conjunction=",">
                 #frtZonePk[]#
             </iterate>
            OR PAD.PRC_RULE_COND_FROM_TXT_49 = #wildCard# )
        </isNotNull>
        <isNull property="frtZone">
        AND ( PRC_RULE_COND_FROM_TXT_49 = #wildCard# )
        </isNull>
        <isNotNull property="customerPrcGrp">
        AND ( PAD.PRC_RULE_COND_FROM_TXT_53 IN
             <iterate property="customerPrcGrp" var="customerPrcGrpPk[]" open="(" close=")" conjunction=",">
                 #customerPrcGrpPk[]#
             </iterate>
            OR PAD.PRC_RULE_COND_FROM_TXT_53 = #wildCard# )
        </isNotNull>
        <isNull property="customerPrcGrp">
        AND ( PRC_RULE_COND_FROM_TXT_53 = #wildCard# )
        </isNull>
        AND ( PAD.PRC_RULE_COND_FROM_TXT_54 = #dsAcctNum# OR PAD.PRC_RULE_COND_FROM_TXT_54 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_55 = #coaChCd# OR PAD.PRC_RULE_COND_FROM_TXT_55 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_56 = #dsAcctClsCd# OR PAD.PRC_RULE_COND_FROM_TXT_56 = #wildCard# )
        <isNotNull property="materialPrcGrpqtyBreak">
        AND ( PAD.PRC_RULE_COND_FROM_TXT_57 = #materialPrcGrpqtyBreak# OR PAD.PRC_RULE_COND_FROM_TXT_57 = #wildCard# )
        </isNotNull>
        <isNull property="materialPrcGrpqtyBreak">
        AND ( PRC_RULE_COND_FROM_TXT_57 = #wildCard# )
        </isNull>
        <isNotNull property="lineQtyQtyBleak">
        AND #lineQtyQtyBleak# BETWEEN TO_NUMBER(DECODE(PAD.PRC_RULE_COND_FROM_TXT_58, #wildCard#, -9999999999, PAD.PRC_RULE_COND_FROM_TXT_58)) AND TO_NUMBER(DECODE(PAD.PRC_RULE_COND_THRU_TXT_58, #wildCard#, 9999999999, PAD.PRC_RULE_COND_THRU_TXT_58))
        </isNotNull>
        <isNull property="lineQtyQtyBleak">
        AND ( PRC_RULE_COND_FROM_TXT_58 = #wildCard# )
        </isNull>
        <!-- 2018/04/24 QC#22569 add start -->
        AND ( PAD.PRC_RULE_COND_FROM_TXT_59 = #slsMatGrpCd_01# OR PAD.PRC_RULE_COND_FROM_TXT_59 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_60 = #slsMatGrpCd_02# OR PAD.PRC_RULE_COND_FROM_TXT_60 = #wildCard# )
        AND ( PAD.PRC_RULE_COND_FROM_TXT_61 = #slsMatGrpCd_03# OR PAD.PRC_RULE_COND_FROM_TXT_61 = #wildCard# )
        <!-- 2018/04/24 QC#22569 add end -->
        ORDER BY PRC_RULE_CATG_CD
                ,PRC_RULE_HDR_PK
                ,PRC_RULE_DTL_PK
    </statement>

    <statement id="selectPrcRulePrcd" parameterClass="Map" resultClass="Map">
        SELECT
             PRP.PRC_RULE_PRCD_PK                                   -- GROUP NUM
            ,PRP.PRC_PRCD_ACT_TP_CD                                 -- ACTION TYPE
            ,NVL(PRPD.PRC_RULE_PRCD_SQ_NUM, 0) PRC_RULE_PRCD_SQ_NUM -- PRECEDENCE SEQ
            ,PRPD.PRC_RULE_HDR_PK                                   -- PRECEDENCE RULE KEY
        FROM
             PRC_RULE_PRCD_DTL PRPD
            ,PRC_RULE_PRCD PRP
        WHERE
            PRPD.GLBL_CMPY_CD = #glblCmpyCd#
        AND PRPD.EZCANCELFLAG = '0'
        AND PRPD.PRC_RULE_HDR_PK IN
        <iterate property="prcRuleHdrPkList" var="prcRuleHdrPk[]" open="(" close=")" conjunction=",">
            #prcRuleHdrPk[]#
        </iterate>
        AND PRPD.GLBL_CMPY_CD = PRP.GLBL_CMPY_CD
        AND PRPD.EZCANCELFLAG = PRP.EZCANCELFLAG
        AND PRPD.PRC_RULE_PRCD_PK = PRP.PRC_RULE_PRCD_PK
        AND PRP.ACTV_FLG = #actvFlg#
        ORDER BY
            PRC_RULE_PRCD_GRP_NUM
           ,PRC_RULE_PRCD_SQ_NUM
           ,PRC_RULE_HDR_PK
    </statement>

    <statement id="getRuleAttrbCdList" parameterClass="Map" resultClass="String">
        SELECT
            PRTC.PRC_RULE_ATTRB_CD
        FROM
            PRC_RULE_TRX_COND PRTC
        WHERE
            PRTC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PRTC.PRC_RULE_TRX_CATG_CD = #prcRuleTrxCatgCd#
            AND PRTC.EZCANCELFLAG         = '0'
        GROUP BY
            PRTC.PRC_RULE_ATTRB_CD
        ORDER BY
            PRTC.PRC_RULE_ATTRB_CD
    </statement>
</sqlMap>
