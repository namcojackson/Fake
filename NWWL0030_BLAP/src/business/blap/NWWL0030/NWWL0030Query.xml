<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWWL0030Query">

<statement id="getNtfyHist" parameterClass="Map" resultClass="Map">
    SELECT
        NTFY_HDR_ID
        ,NTFY_HDR_NM
        ,NTFY_HDR_DESC_TXT
        ,NTFY_BIZ_AREA_TP_DESC_TXT
        ,NTFY_SUB_AREA_TP_DESC_TXT
        ,NTFY_RUN_JOB_ID
        ,NTFY_RUN_TS
    FROM
        (
        SELECT DISTINCT
            NSEI.NTFY_HDR_ID
            ,NSEI.NTFY_HDR_NM
            ,NSEI.NTFY_HDR_DESC_TXT
            ,NBAT.NTFY_BIZ_AREA_TP_DESC_TXT
            ,NSAT.NTFY_SUB_AREA_TP_DESC_TXT
            ,NSEI.NTFY_RUN_JOB_ID
            ,NSEI.NTFY_RUN_TS
        FROM
            NTFY_SEND_EML_INFO NSEI
            ,NTFY_BIZ_AREA_TP NBAT
            ,NTFY_SUB_AREA_TP NSAT
        WHERE
                NSEI.GLBL_CMPY_CD = #glblCmpyCd#
            AND NSEI.EZCANCELFLAG = '0'
            <isNotNull property="ntfyRunJobId">
                AND NSEI.NTFY_RUN_JOB_ID = #ntfyRunJobId#
            </isNotNull>
            <isNotNull property="effFromDt">
                AND SUBSTR(NSEI.NTFY_RUN_TS,1,8) &gt;= #effFromDt#
            </isNotNull>
            <isNotNull property="effThruDt">
                AND SUBSTR(NSEI.NTFY_RUN_TS,1,8) &lt;= #effThruDt#
            </isNotNull>
            <isNotNull property="ntfyHdrNm">
                AND NSEI.NTFY_HDR_NM    LIKE #ntfyHdrNm#
            </isNotNull>
            <isNotNull property="ntfyHdrDescTxt">
                AND NSEI.NTFY_HDR_DESC_TXT LIKE #ntfyHdrDescTxt#
            </isNotNull>
            <isNotNull property="ntfyBizAreaTpCd">
                AND NSEI.NTFY_BIZ_AREA_TP_CD = #ntfyBizAreaTpCd#
            </isNotNull>
            <isNotNull property="ntfySubAreaTpCd">
                AND NSEI.NTFY_SUB_AREA_TP_CD = #ntfySubAreaTpCd#
            </isNotNull>
        
            AND NSEI.GLBL_CMPY_CD        = NBAT.GLBL_CMPY_CD (+)
            AND NSEI.EZCANCELFLAG        = NBAT.EZCANCELFLAG (+)
            AND NSEI.NTFY_BIZ_AREA_TP_CD = NBAT.NTFY_BIZ_AREA_TP_CD (+)
        
            AND NSEI.GLBL_CMPY_CD        = NSAT.GLBL_CMPY_CD (+)
            AND NSEI.EZCANCELFLAG        = NSAT.EZCANCELFLAG (+)
            AND NSEI.NTFY_SUB_AREA_TP_CD = NSAT.NTFY_SUB_AREA_TP_CD (+)
        ORDER BY
            NSEI.NTFY_HDR_ID
            ,NSEI.NTFY_RUN_JOB_ID
        ) V
    WHERE
        ROWNUM &lt;= #rowNum#
</statement>

<statement id="getActRslt" parameterClass="Map" resultClass="Map">
    SELECT
        NTFY_HDR_ID
        ,NTFY_RUN_JOB_ID
        ,NTFY_ACT_ID
        ,NTFY_ACT_NM
        ,NTFY_ACT_DTL_HIST_ID
    FROM
        (
        SELECT DISTINCT
            NSEI.NTFY_HDR_ID
            ,NSEI.NTFY_RUN_JOB_ID
            ,NSEI.NTFY_ACT_ID
            ,NSEI.NTFY_ACT_NM
            ,NSEI.NTFY_ACT_DTL_HIST_ID
        FROM
            NTFY_SEND_EML_INFO NSEI
        WHERE
                NSEI.GLBL_CMPY_CD = #glblCmpyCd#
            AND NSEI.EZCANCELFLAG = '0'
            AND NSEI.NTFY_HDR_ID  = #ntfyHdrId#
            AND NSEI.NTFY_RUN_JOB_ID = #ntfyRunJobId#
        ORDER BY
            NSEI.NTFY_ACT_ID
        ) V
    WHERE
        ROWNUM &lt;= #rowNum#
</statement>

<statement id="getNtfyActDtl" parameterClass="Map" resultClass="Map">
    SELECT
        NAT.NTFY_ACT_TP_DESC_TXT
        ,NTOT.NTFY_OTPT_TP_DESC_TXT
        ,NSEI.NTFY_EML_RPY_TO_ADDR
        ,NSEI.NTFY_EML_TO_ADDR
        ,NSEI.NTFY_EML_CC_ADDR
        ,NSEI.NTFY_EML_BCC_ADDR
        ,NSEI.NTFY_DIST_LIST_NM_LIST_TXT
        ,NSEI.NTFY_EML_SUBJ_TXT
        ,NSEI.NTFY_EML_BODY_CLOD
    FROM
        NTFY_SEND_EML_INFO NSEI
        ,NTFY_ACT_TP NAT
        ,NTFY_OTPT_TP NTOT
    WHERE
            NSEI.GLBL_CMPY_CD = #glblCmpyCd#
        AND NSEI.EZCANCELFLAG = '0'
        AND NSEI.NTFY_ACT_DTL_HIST_ID = #ntfyActDtlHistId#
    
        AND NSEI.GLBL_CMPY_CD = NAT.GLBL_CMPY_CD (+)
        AND NSEI.EZCANCELFLAG = NAT.EZCANCELFLAG (+)
        AND NSEI.NTFY_ACT_TP_CD = NAT.NTFY_ACT_TP_CD (+)
        
        AND NSEI.GLBL_CMPY_CD = NTOT.GLBL_CMPY_CD (+)
        AND NSEI.EZCANCELFLAG = NTOT.EZCANCELFLAG (+)
        AND NSEI.NTFY_OTPT_TP_CD = NTOT.NTFY_OTPT_TP_CD (+)
</statement>
</sqlMap>
