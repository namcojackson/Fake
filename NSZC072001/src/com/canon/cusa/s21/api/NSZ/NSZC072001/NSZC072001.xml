<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<sqlMap namespace="NSZC072001">
    <statement id="getMachineInfo" parameterClass="Map" resultClass="Map">
        SELECT
            A.MACH_VLD_ADDR_RTRN_FLG
            ,A.SER_NUM
            ,A.MACH_VLD_STS_TXT
            ,A.LOC_NM
            ,A.ADDL_LOC_NM
            ,A.FIRST_LINE_ADDR
            ,A.SCD_LINE_ADDR
            ,A.THIRD_LINE_ADDR
            ,A.FRTH_LINE_ADDR
            ,A.CTY_ADDR
            ,A.ST_CD
            ,A.POST_CD
            ,A.CTRY_CD
            ,A.T_MDL_NM
        FROM
            (
            SELECT
                 SMMS.MACH_VLD_ADDR_RTRN_FLG  AS MACH_VLD_ADDR_RTRN_FLG
                ,SMM.SER_NUM                  AS SER_NUM
                ,SMMS.MACH_VLD_STS_TXT        AS MACH_VLD_STS_TXT
                ,STC.LOC_NM                   AS LOC_NM
                ,STC.ADDL_LOC_NM              AS ADDL_LOC_NM
                ,STC.FIRST_LINE_ADDR          AS FIRST_LINE_ADDR
                ,STC.SCD_LINE_ADDR            AS SCD_LINE_ADDR
                ,STC.THIRD_LINE_ADDR          AS THIRD_LINE_ADDR
                ,STC.FRTH_LINE_ADDR           AS FRTH_LINE_ADDR
                ,STC.CTY_ADDR                 AS CTY_ADDR
                ,STC.ST_CD                    AS ST_CD
                ,STC.POST_CD                  AS POST_CD
                ,STC.CTRY_CD                  AS CTRY_CD
                ,MN.T_MDL_NM                  AS T_MDL_NM
            FROM
                 SVC_MACH_MSTR         SMM
                ,SVC_MACH_MSTR_STS     SMMS
                ,SHIP_TO_CUST          STC
                ,SVC_CONFIG_MSTR       SCM
                ,MDL_NM                MN
            WHERE
                    SMM.GLBL_CMPY_CD          =    #glblCmpyCd#
                AND SMM.SER_NUM               LIKE #serNum# || '%'
                <!-- START 2019/03/04 K.Kitachi [QC#30545, ADD] -->
                AND SMM.SVC_MACH_TP_CD        =    #svcMachTpCd#
                <!-- END 2019/03/04 K.Kitachi [QC#30545, ADD] -->
                AND SMM.GLBL_CMPY_CD          =    SMMS.GLBL_CMPY_CD
                AND SMM.SVC_MACH_MSTR_STS_CD  =    SMMS.SVC_MACH_MSTR_STS_CD
                AND SMM.GLBL_CMPY_CD          =    STC.GLBL_CMPY_CD
                AND SMM.CUR_LOC_NUM           =    STC.SHIP_TO_CUST_CD
                AND STC.EFF_FROM_DT          &lt;= #slsDt#
<!-- START 2016/11/01 N.Arai [QC#15706, MOD] -->
                AND NVL(STC.EFF_THRU_DT,#slsDt#)    &gt;= #slsDt#
<!-- END 2016/11/01 N.Arai [QC#15706, MOD] -->
                AND SMM.GLBL_CMPY_CD          =    SCM.GLBL_CMPY_CD
                AND SMM.SVC_CONFIG_MSTR_PK    =    SCM.SVC_CONFIG_MSTR_PK
                AND SCM.GLBL_CMPY_CD          =    MN.T_GLBL_CMPY_CD
                AND SCM.MDL_ID                =    MN.T_MDL_ID
                AND SMM.EZCANCELFLAG          =    '0'
                AND SMMS.EZCANCELFLAG         =    '0'
                AND STC.EZCANCELFLAG          =    '0'
                AND SCM.EZCANCELFLAG          =    '0'
                AND MN.EZCANCELFLAG           =    '0'
            ORDER BY SER_NUM
            ) A
        <isNotNull property="rowNum">
        WHERE ROWNUM &lt;= #rowNum#
        </isNotNull>
    </statement>
</sqlMap>
