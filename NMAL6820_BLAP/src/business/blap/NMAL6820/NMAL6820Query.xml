<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NMAL6820Query">

    <typeAlias alias="NMAL6820CMsg"      type="business.blap.NMAL6820.NMAL6820CMsg"/>
    <typeAlias alias="NMAL6820SMsg"      type="business.blap.NMAL6820.NMAL6820SMsg"/>
    <typeAlias alias="NMAL6820_ASMsg"    type="business.blap.NMAL6820.NMAL6820_ASMsg"/>
    <typeAlias alias="NMAL6820_CSMsg"    type="business.blap.NMAL6820.NMAL6820_CSMsg"/>

    <statement id="getWhCatgPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               RWC.RTL_WH_CATG_CD
              ,RWC.RTL_WH_CATG_DESC_TXT AS RTL_WH_CATG_NM
              ,RWC.LOC_TP_CD
              ,RWC.WH_OWNR_CD
              ,RWC.WH_SYS_TP_CD
          FROM
               RTL_WH_CATG RWC
         WHERE
               1=1
           AND RWC.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND RWC.EZCANCELFLAG  = '0'
         ORDER BY
               RWC.RTL_WH_CATG_SORT_NUM
    </statement>

    <statement id="getInvtyAcctPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               IA.INVTY_ACCT_CD
              ,IA.INVTY_ACCT_DESC_TXT AS INVTY_ACCT_NM
          FROM
               RTL_WH_LOC_ROLE_PTRN RW_LRP
               ,INVTY_ACCT IA
         WHERE
               1=1
           AND RW_LRP.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND RW_LRP.RTL_WH_CATG_CD  = #cMsg.rtlWhCatgCd_H1#
           AND RW_LRP.EZCANCELFLAG  = '0'
           AND RW_LRP.GLBL_CMPY_CD  = IA.GLBL_CMPY_CD
           AND RW_LRP.INVTY_ACCT_CD  = IA.INVTY_ACCT_CD
           AND IA.EZCANCELFLAG  = '0'
         GROUP BY
               IA.INVTY_ACCT_CD
              ,IA.INVTY_ACCT_DESC_TXT
              ,IA.INVTY_ACCT_SORT_NUM
         ORDER BY
               IA.INVTY_ACCT_SORT_NUM
    </statement>

    <statement id="getInvtyOwnrPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               IO.INVTY_OWNR_CD
              ,IO.INVTY_OWNR_DESC_TXT AS INVTY_OWNR_NM
          FROM
               RTL_WH_LOC_ROLE_PTRN RW_LRP
               ,INVTY_OWNR IO
         WHERE
               1=1
           AND RW_LRP.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND RW_LRP.RTL_WH_CATG_CD  = #cMsg.rtlWhCatgCd_H1#
           AND RW_LRP.EZCANCELFLAG  = '0'
           AND RW_LRP.GLBL_CMPY_CD  = IO.GLBL_CMPY_CD
           AND RW_LRP.INVTY_OWNR_CD  = IO.INVTY_OWNR_CD
           AND IO.EZCANCELFLAG  = '0'
         GROUP BY
               IO.INVTY_OWNR_CD
              ,IO.INVTY_OWNR_DESC_TXT
              ,IO.INVTY_OWNR_SORT_NUM
         ORDER BY
               IO.INVTY_OWNR_SORT_NUM
    </statement>

    <statement id="getWhOwnPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               WO.WH_OWNR_CD
              ,WO.WH_OWNR_DESC_TXT AS WH_OWNR_NM
          FROM
               WH_OWNR WO
         WHERE
               1=1
           AND WO.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND WO.EZCANCELFLAG  = '0'
         ORDER BY
               WO.WH_OWNR_SORT_NUM
    </statement>

    <statement id="getWhSysTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               WST.WH_SYS_TP_CD
              ,WST.WH_SYS_TP_DESC_TXT AS WH_SYS_TP_NM
          FROM
               WH_SYS_TP WST
         WHERE
               1=1
           AND WST.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND WST.EZCANCELFLAG  = '0'
         ORDER BY
               WST.WH_SYS_TP_SORT_NUM
    </statement>

    <statement id="getReSetupWhOwnPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               WO.WH_OWNR_CD
              ,WO.WH_OWNR_DESC_TXT AS WH_OWNR_NM
          FROM
               WH_OWNR WO
               ,RTL_WH_CATG RWC
         WHERE
               1=1
           AND RWC.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND RWC.RTL_WH_CATG_CD = #cMsg.rtlWhCatgCd_H1#
           AND RWC.EZCANCELFLAG  = '0'
           AND RWC.GLBL_CMPY_CD  = WO.GLBL_CMPY_CD
           AND RWC.WH_OWNR_CD  = WO.WH_OWNR_CD
           AND WO.EZCANCELFLAG  = '0'
           AND ROWNUM = 1
         GROUP BY
               WO.WH_OWNR_CD
              ,WO.WH_OWNR_DESC_TXT
              ,WO.WH_OWNR_SORT_NUM
         ORDER BY
               WO.WH_OWNR_SORT_NUM
    </statement>

    <statement id="getReSetupWhSysTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               WST.WH_SYS_TP_CD
              ,WST.WH_SYS_TP_DESC_TXT AS WH_SYS_TP_NM
          FROM
               WH_SYS_TP WST
               ,RTL_WH_CATG RWC
         WHERE
               1=1
           AND RWC.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND RWC.RTL_WH_CATG_CD = #cMsg.rtlWhCatgCd_H1#
           AND RWC.EZCANCELFLAG  = '0'
           AND RWC.GLBL_CMPY_CD  = WST.GLBL_CMPY_CD
           AND RWC.WH_SYS_TP_CD  = WST.WH_SYS_TP_CD
           AND WST.EZCANCELFLAG  = '0'
         GROUP BY
               WST.WH_SYS_TP_CD
              ,WST.WH_SYS_TP_DESC_TXT
              ,WST.WH_SYS_TP_SORT_NUM
         ORDER BY
               WST.WH_SYS_TP_SORT_NUM
    </statement>

    <statement id="getPoRcptRteTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               PRRT.PO_RCPT_RTE_TP_CD
              ,PRRT.PO_RCPT_RTE_TP_DESC_TXT AS PO_RCPT_RTE_TP_NM
          FROM
               PO_RCPT_RTE_TP PRRT
         WHERE
               1=1
           AND PRRT.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND PRRT.EZCANCELFLAG  = '0'
         ORDER BY
               PRRT.PO_RCPT_RTE_TP_SORT_NUM
    </statement>

    <statement id="getRmaRcptRteTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               RRRT.RMA_RCPT_RTE_TP_CD
              ,RRRT.RMA_RCPT_RTE_TP_DESC_TXT AS RMA_RCPT_RTE_TP_NM
          FROM
               RMA_RCPT_RTE_TP RRRT
         WHERE
               1=1
           AND RRRT.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND RRRT.EZCANCELFLAG  = '0'
         ORDER BY
               RRRT.RMA_RCPT_RTE_TP_SORT_NUM
    </statement>

    <statement id="getShipToCntyPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               C.CNTY_PK AS SHIP_TO_CNTY_PK
              ,C.CNTY_NM AS SHIP_TO_CNTY_NM
          FROM
               CNTY C
         WHERE
               1=1
           AND C.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND C.EZCANCELFLAG  = '0'
         ORDER BY
               C.CNTY_PK
    </statement>

    <statement id="getShipToCtryPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               C.CTRY_CD AS SHIP_TO_CTRY_CD
              ,C.CTRY_DESC_TXT AS SHIP_TO_CTRY_NM
          FROM
               CTRY C
         WHERE
               1=1
           AND C.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND C.CTRY_VIS_FLG  = #flgOn#
           AND C.EZCANCELFLAG  = '0'
         ORDER BY
               C.CTRY_SORT_NUM
    </statement>

    <statement id="getRtrnToCntyPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               C.CNTY_PK AS RTRN_TO_CNTY_PK
              ,C.CNTY_NM AS RTRN_TO_CNTY_NM
          FROM
               CNTY C
         WHERE
               1=1
           AND C.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND C.EZCANCELFLAG  = '0'
         ORDER BY
               C.CNTY_PK
    </statement>

    <statement id="getRtrnToCtryPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               C.CTRY_CD AS RTRN_TO_CTRY_CD
              ,C.CTRY_DESC_TXT AS RTRN_TO_CTRY_NM
          FROM
               CTRY C
         WHERE
               1=1
           AND C.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND C.CTRY_VIS_FLG  = #flgOn#
           AND C.EZCANCELFLAG  = '0'
         ORDER BY
               C.CTRY_SORT_NUM
    </statement>
            
    <statement id="getPlnItemInsrcPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               PII.PLN_ITEM_INSRC_CD AS PLN_ITEM_INSRC_CD
              ,PII.PLN_ITEM_INSRC_DESC_TXT AS PLN_ITEM_INSRC_NM
          FROM
               PLN_ITEM_INSRC PII
         WHERE
               1=1
           AND PII.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND PII.EZCANCELFLAG  = '0'
         ORDER BY
               PII.PLN_ITEM_INSRC_SORT_NUM
    </statement>

    <statement id="getSrcZnPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               SZ.SRC_ZN_CD
              ,SZ.SRC_ZN_DESC_TXT AS SRC_ZN_NM
          FROM
               SRC_ZN SZ
         WHERE
               1=1
           AND SZ.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND SZ.EZCANCELFLAG  = '0'
         ORDER BY
               SZ.SRC_ZN_SORT_NUM
    </statement>

    <statement id="getDefSrcProcrTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               PT.PROCR_TP_CD AS DEF_SRC_PROCR_TP_CD
              ,PT.PROCR_TP_DESC_TXT AS DEF_SRC_PROCR_TP_NM
          FROM
               PROCR_TP PT
         WHERE
               1=1
           AND PT.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND PT.TECH_MAN_RQST_FLG  = #flgOn#
           AND PT.EZCANCELFLAG  = '0'
         ORDER BY
               PT.PROCR_TP_SORT_NUM
    </statement>

    <statement id="getTchEmrProcrTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               PT.PROCR_TP_CD AS TCH_EMR_PROCR_TP_CD
              ,PT.PROCR_TP_DESC_TXT AS TCH_EMR_PROCR_TP_NM
          FROM
               PROCR_TP PT
         WHERE
               1=1
           AND PT.GLBL_CMPY_CD       = #cMsg.glblCmpyCd_G1#
           AND PT.TECH_MAN_RQST_FLG  = #flgOn#
           AND PT.EZCANCELFLAG       = '0'
         ORDER BY
               PT.PROCR_TP_SORT_NUM
    </statement>

    <statement id="getRtrnToDefSrcProcrTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               PT.PROCR_TP_CD AS DEF_RTRN_TO_PROCR_TP_CD
              ,PT.PROCR_TP_DESC_TXT AS DEF_RTRN_TO_PROCR_TP_NM
          FROM
               PROCR_TP PT
         WHERE
               1=1
           AND PT.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND PT.TECH_MAN_RQST_FLG  = #flgOn#
           AND PT.EZCANCELFLAG  = '0'
         ORDER BY
               PT.PROCR_TP_SORT_NUM
    </statement>

    <statement id="getRtlWh" parameterClass="Map" resultMap="result.getRtlWh">
        SELECT
                W.RTL_WH_CD                            AS RTL_WH_CD
              , W.RTL_WH_NM                            AS RTL_WH_NM
              , W.RTL_WH_DESC_TXT                      AS RTL_WH_DESC_TXT
              , W.RTL_WH_CATG_CD                       AS RTL_WH_CATG_CD
              , NVL(W.WH_MGR_PSN_CD, W.TECH_TOC_CD)    AS OWNR_CD
              , CASE
                    WHEN W.WH_MGR_PSN_CD IS NULL THEN PT.FULL_PSN_NM
                    ELSE P.FULL_PSN_NM
                END                                    AS OWNR_NM
              , W.ALT_PSN_CD                           AS ALT_OWNR_CD
              , PA.FULL_PSN_NM                         AS ALT_OWNR_NM
              , W.TEL_NUM                              AS TEL_NUM
              , W.FAX_NUM                              AS FAX_NUM
              , IA.INVTY_ACCT_CD                       AS INVTY_ACCT_CD
              , W.INVTY_OWNR_CD                        AS INVTY_OWNR_CD
              , W.WH_OWNR_CD                           AS WH_OWNR_CD
              , W.WH_SYS_TP_CD                         AS WH_SYS_TP_CD
              , W.WMS_WH_CD                            AS WMS_WH_CD
              , W.PHYS_WH_CD                           AS PHYS_WH_CD
              , W.AUTO_SO_DROP_FLG                     AS AUTO_SO_DROP_FLG
              , W.FIRST_REF_CMNT_TXT                   AS FIRST_REF_CMNT_TXT
              , W.EFF_FROM_DT                          AS EFF_FROM_DT
              , W.EFF_THRU_DT                          AS EFF_THRU_DT
              , W.WH_START_TM                          AS WH_START_TM
              , W.WH_END_TM                            AS WH_END_TM
              , W.WH_CUT_OFF_TM                        AS WH_CUT_OFF_TM
              <!-- START 2020/09/17 J.Evangelista [QC#57659,ADD] -->
              , W.FEDEX_CUT_OFF_TM                     AS FEDEX_CUT_OFF_TM
              , W.UPS_CUT_OFF_TM                       AS UPS_CUT_OFF_TM              
              <!-- END   2020/09/17 J.Evangelista [QC#57659,ADD] -->
              , W.TM_ZONE_CD                           AS TM_ZONE_CD
              , W.GEO_CD                               AS GEO_CD
              , W.PRF_CARR_CD                          AS CARR_CD
              , OCV.CARR_NM                            AS CARR_NM
              , W.COA_BR_CD                            AS COA_BR_CD
              , CB.COA_BR_NM                           AS COA_BR_NM
              , W.LOC_TP_CD                            AS LOC_TP_CD
              , CASE
                    WHEN W.SHIP_TO_CUST_CD IS NULL THEN 'N'
                    ELSE 'Y'
                END                                       SHIP_TO_SET_FLG
              , W.SHIP_TO_CUST_CD                      AS SHIP_TO_CUST_CD
              , STCS.LOC_NUM                           AS SHIP_TO_LOC_NUM
              , STC1.SELL_TO_CUST_CD                   AS SELL_TO_CUST_CD
              , STC1.DS_ACCT_NM                        AS DS_ACCT_NM
              , PLWS.DS_LOC_NM                         AS SHIP_TO_LOC_NM
              , W.ADDL_LOC_NM                          AS ADDL_LOC_NM
              , W.FIRST_LINE_ADDR                      AS FIRST_LINE_ADDR
              , W.SCD_LINE_ADDR                        AS SCD_LINE_ADDR
              , W.THIRD_LINE_ADDR                      AS THIRD_LINE_ADDR
              , W.FRTH_LINE_ADDR                       AS FRTH_LINE_ADDR
              , W.CTY_ADDR                             AS CTY_ADDR
              , W.CNTY_PK                              AS CNTY_PK
              , W.ST_CD                                AS ST_CD
              , W.PROV_NM                              AS PROV_NM
              , W.POST_CD                              AS POST_CD
              , W.CTRY_CD                              AS CTRY_CD
              , W.PO_RCPT_RTE_TP_CD                    AS PO_RCPT_RTE_TP_CD
              , W.RMA_RCPT_RTE_TP_CD                   AS RMA_RCPT_RTE_TP_CD
              , VSXS.VND_LOC_CD                        AS VND_LOC_CD
              , CASE
                    WHEN W.RTRN_TO_CUST_CD IS NULL THEN 'N'
                    ELSE 'Y'
                END                                       RTRN_TO_SET_FLG
              , W.RTRN_TO_CUST_CD                      AS RTRN_TO_CUST_CD
              , STCR.LOC_NUM                           AS RTRN_TO_LOC_NUM
              , STC2.SELL_TO_CUST_CD                   AS RTRN_TO_DS_ACCT_NUM
              , STC2.DS_ACCT_NM                        AS RTRN_TO_DS_ACCT_NM
              , PLWR.DS_LOC_NM                         AS RTRN_TO_LOC_NM
              , W.RTRN_TO_ADDL_LOC_NM                  AS RTRN_TO_ADDL_LOC_NM
              , W.RTRN_TO_FIRST_LINE_ADDR              AS RTRN_TO_FIRST_LINE_ADDR
              , W.RTRN_TO_SCD_LINE_ADDR                AS RTRN_TO_SCD_LINE_ADDR
              , W.RTRN_TO_THIRD_LINE_ADDR              AS RTRN_TO_THIRD_LINE_ADDR
              , W.RTRN_TO_FRTH_LINE_ADDR               AS RTRN_TO_FRTH_LINE_ADDR
              , W.RTRN_TO_CTY_ADDR                     AS RTRN_TO_CTY_ADDR
              , W.RTRN_TO_CNTY_PK                      AS RTRN_TO_CNTY_PK
              , W.RTRN_TO_ST_CD                        AS RTRN_TO_ST_CD
              , W.RTRN_TO_PROV_NM                      AS RTRN_TO_PROV_NM
              , W.RTRN_TO_POST_CD                      AS RTRN_TO_POST_CD
              , W.RTRN_TO_CTRY_CD                      AS RTRN_TO_CTRY_CD
              , W.RTRN_TO_TEL_NUM                      AS RTRN_TO_TEL_NUM
              , W.RTRN_TO_FAX_NUM                      AS RTRN_TO_FAX_NUM
              , VSXR.VND_LOC_CD                        AS RTRN_TO_VND_LOC_CD
              , W.PLN_ITEM_INSRC_CD                    AS PLN_ITEM_INSRC_CD
              , W.SRC_ZN_CD                            AS SRC_ZN_CD
              , W.DEF_SRC_PROCR_TP_CD                  AS DEF_SRC_PROCR_TP_CD
              , W.DEF_SRC_RTL_WH_CD                    AS DEF_SRC_RTL_WH_CD
              , W.DEF_SRC_RTL_SWH_CD                   AS DEF_SRC_RTL_SWH_CD
              , CASE
                    WHEN W.DEF_SRC_PROCR_TP_CD = #procrTp_Supplier# THEN PV_DS.PRNT_VND_NM
                    ELSE W_DS.RTL_WH_NM
                END                                    AS DEF_SRC_RTL_WH_NM
              , CASE
                    WHEN W.DEF_SRC_PROCR_TP_CD = #procrTp_Supplier# THEN V_DS.LOC_NM
                    ELSE SW_DS.RTL_SWH_NM
                END                                    AS DEF_SRC_RTL_SWH_NM
              , SW_DS.INVTY_LOC_CD                     AS DEF_SRC_INVTY_LOC_CD
              , W.EMER_SRC_PROCR_TP_CD                 AS EMER_SRC_PROCR_TP_CD
              , W.EMER_SRC_RTL_WH_CD                   AS EMER_SRC_RTL_WH_CD
              , W.EMER_SRC_RTL_SWH_CD                  AS EMER_SRC_RTL_SWH_CD
              , CASE
                    WHEN W.EMER_SRC_PROCR_TP_CD = #procrTp_Supplier# THEN PV_DE.PRNT_VND_NM
                    ELSE W_DE.RTL_WH_NM
                END                                    AS EMER_SRC_RTL_WH_NM
              , CASE
                    WHEN W.EMER_SRC_PROCR_TP_CD = #procrTp_Supplier# THEN V_DE.LOC_NM
                    ELSE SW_DE.RTL_SWH_NM
                END                                    AS EMER_SRC_RTL_SWH_NM
              , SW_DE.INVTY_LOC_CD                     AS EMER_SRC_INVTY_LOC_CD
              , W.DEF_RTRN_TO_PROCR_TP_CD              AS DEF_RTRN_TO_PROCR_TP_CD
              , W.DEF_RTRN_TO_RTL_WH_CD                AS DEF_RTRN_TO_RTL_WH_CD
              , W.DEF_RTRN_TO_RTL_SWH_CD               AS DEF_RTRN_TO_RTL_SWH_CD
              , CASE
                    WHEN W.DEF_RTRN_TO_PROCR_TP_CD = #procrTp_Supplier# THEN PV_DR.PRNT_VND_NM
                    ELSE W_DR.RTL_WH_NM
                END                                    AS DEF_RTRN_TO_RTL_WH_NM
              , CASE
                    WHEN W.DEF_RTRN_TO_PROCR_TP_CD = #procrTp_Supplier# THEN V_DR.LOC_NM
                    ELSE SW_DR.RTL_SWH_NM
                END                                    AS DEF_RTRN_TO_RTL_SWH_NM
              , SW_DR.INVTY_LOC_CD                     AS DEF_RTRN_TO_INVTY_LOC_CD
              , W.GND_SVC_LVL_CD                       AS GND_SVC_LVL_CD
              , W.FIRST_OVNGT_SVC_LVL_CD               AS FIRST_OVNGT_SVC_LVL_CD
              , W.SCD_OVNGT_SVC_LVL_CD                 AS SCD_OVNGT_SVC_LVL_CD
              , W.EZUPTIME                             AS EZUPTIME
              , W.EZUPTIMEZONE                         AS EZUPTIMEZONE
              , W.PRNT_VND_CD                          AS PRNT_VND_CD
              , W.VND_CD                               AS VND_CD
              , W.TECH_MBL_MSG_ADDR
          FROM
               RTL_WH            W
             , S21_PSN_V         P
             , S21_PSN_V         PT
             , S21_PSN_V         PA
             , INVTY_ACCT        IA
             , OTBD_CARR_V       OCV
             , RTL_WH            W_DS
             , RTL_SWH           SW_DS
             , RTL_WH            W_DE
             , RTL_SWH           SW_DE
             , RTL_WH            W_DR
             , RTL_SWH           SW_DR
             , COA_BR            CB
             , SHIP_TO_CUST      STCS
             , SELL_TO_CUST      STC1
             , PTY_LOC_WRK       PLWS
             , SHIP_TO_CUST      STCR
             , SELL_TO_CUST      STC2
             , PTY_LOC_WRK       PLWR
             , VND_SHIP_TO_XREF  VSXS
             , VND_SHIP_TO_XREF  VSXR
             , PRNT_VND          PV_DS
             , VND               V_DS
             , PRNT_VND          PV_DE
             , VND               V_DE
             , PRNT_VND          PV_DR
             , VND               V_DR
         WHERE
               W.GLBL_CMPY_CD                = P.GLBL_CMPY_CD(+)
           AND W.WH_MGR_PSN_CD               = P.PSN_CD(+)
           AND W.GLBL_CMPY_CD                = PT.GLBL_CMPY_CD(+)
           AND W.TECH_TOC_CD                 = PT.PSN_CD(+)
           AND W.GLBL_CMPY_CD                = PA.GLBL_CMPY_CD(+)
           AND W.ALT_PSN_CD                  = PA.PSN_CD(+)
           AND W.GLBL_CMPY_CD                = IA.GLBL_CMPY_CD(+)
           AND W.INVTY_ACCT_CD               = IA.INVTY_ACCT_CD(+)
           AND W.GLBL_CMPY_CD                = OCV.GLBL_CMPY_CD(+)
           AND W.PRF_CARR_CD                 = OCV.CARR_CD(+)
           AND W.GLBL_CMPY_CD                = W_DS.GLBL_CMPY_CD(+)
           AND W.DEF_SRC_RTL_WH_CD           = W_DS.RTL_WH_CD(+)
           AND W.GLBL_CMPY_CD                = SW_DS.GLBL_CMPY_CD(+)
           AND W.DEF_SRC_RTL_WH_CD           = SW_DS.RTL_WH_CD(+)
           AND W.DEF_SRC_RTL_SWH_CD          = SW_DS.RTL_SWH_CD(+)
           AND W.GLBL_CMPY_CD                = W_DE.GLBL_CMPY_CD(+)
           AND W.EMER_SRC_RTL_WH_CD          = W_DE.RTL_WH_CD(+)
           AND W.GLBL_CMPY_CD                = SW_DE.GLBL_CMPY_CD(+)
           AND W.EMER_SRC_RTL_WH_CD          = SW_DE.RTL_WH_CD(+)
           AND W.EMER_SRC_RTL_SWH_CD         = SW_DE.RTL_SWH_CD(+)
           AND W.GLBL_CMPY_CD                = W_DR.GLBL_CMPY_CD(+)
           AND W.DEF_RTRN_TO_RTL_WH_CD       = W_DR.RTL_WH_CD(+)
           AND W.GLBL_CMPY_CD                = SW_DR.GLBL_CMPY_CD(+)
           AND W.DEF_RTRN_TO_RTL_WH_CD       = SW_DR.RTL_WH_CD(+)
           AND W.DEF_RTRN_TO_RTL_SWH_CD      = SW_DR.RTL_SWH_CD(+)
           AND W.GLBL_CMPY_CD                = CB.GLBL_CMPY_CD(+)
           AND W.COA_BR_CD                   = CB.COA_BR_CD(+)
           AND W.GLBL_CMPY_CD                = STCS.GLBL_CMPY_CD(+)
           AND W.SHIP_TO_CUST_CD             = STCS.SHIP_TO_CUST_CD(+)
           AND STCS.GLBL_CMPY_CD             = STC1.GLBL_CMPY_CD(+)
           AND STCS.SELL_TO_CUST_CD          = STC1.SELL_TO_CUST_CD(+)
           AND STCS.GLBL_CMPY_CD             = PLWS.GLBL_CMPY_CD(+)
           AND STCS.PTY_LOC_PK               = PLWS.PTY_LOC_PK(+)
           AND W.GLBL_CMPY_CD                = VSXS.GLBL_CMPY_CD(+)
           AND W.RTL_WH_CD                   = VSXS.RTL_WH_CD(+)
           AND VSXS.VND_XREF_TP_CD(+)        = #vndXrefTp_CSA_TO_CUSA#
           AND W.GLBL_CMPY_CD                = STCR.GLBL_CMPY_CD(+)
           AND W.RTRN_TO_CUST_CD             = STCR.SHIP_TO_CUST_CD(+)
           AND STCR.GLBL_CMPY_CD             = STC2.GLBL_CMPY_CD(+)
           AND STCR.SELL_TO_CUST_CD          = STC2.SELL_TO_CUST_CD(+)
           AND STCR.GLBL_CMPY_CD             = PLWR.GLBL_CMPY_CD(+)
           AND STCR.PTY_LOC_PK               = PLWR.PTY_LOC_PK(+)
           AND W.GLBL_CMPY_CD                = VSXR.GLBL_CMPY_CD(+)
           AND W.RTL_WH_CD                   = VSXR.RTL_WH_CD(+)
           AND VSXR.VND_XREF_TP_CD(+)        = #vndXrefTp_CSA_TO_CUSA_RETURN_TO#
           AND W.GLBL_CMPY_CD                = PV_DS.GLBL_CMPY_CD(+)
           AND W.DEF_SRC_RTL_WH_CD           = PV_DS.PRNT_VND_CD(+)
           AND W.GLBL_CMPY_CD                = V_DS.GLBL_CMPY_CD(+)
           AND W.DEF_SRC_RTL_SWH_CD          = V_DS.VND_CD(+)
           AND W.GLBL_CMPY_CD                = PV_DE.GLBL_CMPY_CD(+)
           AND W.EMER_SRC_RTL_WH_CD          = PV_DE.PRNT_VND_CD(+)
           AND W.GLBL_CMPY_CD                = V_DE.GLBL_CMPY_CD(+)
           AND W.EMER_SRC_RTL_SWH_CD         = V_DE.VND_CD(+)
           AND W.GLBL_CMPY_CD                = PV_DR.GLBL_CMPY_CD(+)
           AND W.DEF_RTRN_TO_RTL_WH_CD       = PV_DR.PRNT_VND_CD(+)
           AND W.GLBL_CMPY_CD                = V_DR.GLBL_CMPY_CD(+)
           AND W.DEF_RTRN_TO_RTL_SWH_CD      = V_DR.VND_CD(+)
           AND W.EZCANCELFLAG                = '0'
           AND P.EZCANCELFLAG(+)             = '0'
           AND PT.EZCANCELFLAG(+)            = '0'
           AND PA.EZCANCELFLAG(+)            = '0'
           AND IA.EZCANCELFLAG(+)            = '0'
           AND OCV.EZCANCELFLAG(+)           = '0'
           AND W_DS.EZCANCELFLAG(+)          = '0'
           AND SW_DS.EZCANCELFLAG(+)         = '0'
           AND W_DE.EZCANCELFLAG(+)          = '0'
           AND SW_DE.EZCANCELFLAG(+)         = '0'
           AND W_DR.EZCANCELFLAG(+)          = '0'
           AND SW_DR.EZCANCELFLAG(+)         = '0'
           AND CB.EZCANCELFLAG(+)            = '0'
           AND STCS.EZCANCELFLAG(+)          = '0'
           AND STC1.EZCANCELFLAG(+)          = '0'
           AND PLWS.EZCANCELFLAG(+)          = '0'
           AND STCR.EZCANCELFLAG(+)          = '0'
           AND STC2.EZCANCELFLAG(+)          = '0'
           AND PLWR.EZCANCELFLAG(+)          = '0'
           AND VSXS.EZCANCELFLAG(+)          = '0'
           AND VSXR.EZCANCELFLAG(+)          = '0'
           AND PV_DS.EZCANCELFLAG(+)         = '0'
           AND V_DS.EZCANCELFLAG(+)          = '0'
           AND PV_DE.EZCANCELFLAG(+)         = '0'
           AND V_DE.EZCANCELFLAG(+)          = '0'
           AND PV_DR.EZCANCELFLAG(+)         = '0'
           AND V_DR.EZCANCELFLAG(+)          = '0'
           AND W.GLBL_CMPY_CD                = #cMsg.glblCmpyCd_G1#
           AND W.RTL_WH_CD                   = #cMsg.rtlWhCd_H1#
    </statement>

    <resultMap id="result.getRtlWh" class="NMAL6820SMsg">
        <result property="rtlWhCd_H1"                 column="RTL_WH_CD"                  javaType="EZDSStringItem"/>
        <result property="rtlWhNm_H1"                 column="RTL_WH_NM"                  javaType="EZDSStringItem"/>
        <result property="rtlWhDescTxt_H1"            column="RTL_WH_DESC_TXT"            javaType="EZDSStringItem"/>
        <result property="rtlWhCatgCd_H1"             column="RTL_WH_CATG_CD"             javaType="EZDSStringItem"/>
        <result property="whMgrPsnCd_H1"              column="OWNR_CD"                    javaType="EZDSStringItem"/>
        <result property="fullPsnNm_H1"               column="OWNR_NM"                    javaType="EZDSStringItem"/>
        <result property="altPsnCd_H1"                column="ALT_OWNR_CD"                javaType="EZDSStringItem"/>
        <result property="fullPsnNm_H2"               column="ALT_OWNR_NM"                javaType="EZDSStringItem"/>
        <result property="telNum_H1"                  column="TEL_NUM"                    javaType="EZDSStringItem"/>
        <result property="faxNum_H1"                  column="FAX_NUM"                    javaType="EZDSStringItem"/>
        <result property="invtyAcctCd_H1"             column="INVTY_ACCT_CD"              javaType="EZDSStringItem"/>
        <result property="invtyOwnrCd_H1"             column="INVTY_OWNR_CD"              javaType="EZDSStringItem"/>
        <result property="whOwnrCd_H1"                column="WH_OWNR_CD"                 javaType="EZDSStringItem"/>
        <result property="whSysTpCd_H1"               column="WH_SYS_TP_CD"               javaType="EZDSStringItem"/>
        <result property="wmsWhCd_H1"                 column="WMS_WH_CD"                  javaType="EZDSStringItem"/>
        <result property="physWhCd_H1"                column="PHYS_WH_CD"                 javaType="EZDSStringItem"/>
        <result property="autoSoDropFlg_H1"           column="AUTO_SO_DROP_FLG"           javaType="EZDSStringItem"/>
        <result property="firstRefCmntTxt_H1"         column="FIRST_REF_CMNT_TXT"         javaType="EZDSStringItem"/>
        <result property="effFromDt_H1"               column="EFF_FROM_DT"                javaType="EZDSStringItem"/>
        <result property="effThruDt_H1"               column="EFF_THRU_DT"                javaType="EZDSStringItem"/>
        <result property="whStartTm_H1"               column="WH_START_TM"                javaType="EZDSStringItem"/>
        <result property="whEndTm_H1"                 column="WH_END_TM"                  javaType="EZDSStringItem"/>
        <result property="whCutOffTm_H1"              column="WH_CUT_OFF_TM"              javaType="EZDSStringItem"/>
        <!-- START 2020/09/17 J.Evangelista [QC#57659,ADD] -->
        <result property="fedexCutOffTm_H1"           column="FEDEX_CUT_OFF_TM"           javaType="EZDSStringItem"/>
        <result property="upsCutOffTm_H1"             column="UPS_CUT_OFF_TM"             javaType="EZDSStringItem"/>
        <!-- END   2020/09/17 J.Evangelista [QC#57659,ADD] -->
        <result property="tmZoneCd_H1"                column="TM_ZONE_CD"                 javaType="EZDSStringItem"/>
        <result property="geoCd_H1"                   column="GEO_CD"                     javaType="EZDSStringItem"/>
        <result property="geoCd_BK"                   column="GEO_CD"                     javaType="EZDSStringItem"/>
        <result property="carrCd_H1"                  column="CARR_CD"                    javaType="EZDSStringItem"/>
        <result property="carrNm_H1"                  column="CARR_NM"                    javaType="EZDSStringItem"/>
        <result property="coaBrCd_H1"                 column="COA_BR_CD"                  javaType="EZDSStringItem"/>
        <result property="coaBrNm_H1"                 column="COA_BR_NM"                  javaType="EZDSStringItem"/>
        <result property="locTpCd_H1"                 column="LOC_TP_CD"                  javaType="EZDSStringItem"/>
        <result property="xxSetFlg_S1"                column="SHIP_TO_SET_FLG"            javaType="EZDSStringItem"/>
        <result property="locNum_S1"                  column="SHIP_TO_LOC_NUM"            javaType="EZDSStringItem"/>
        <result property="dsAcctNum_S1"               column="DS_ACCT_NUM"                javaType="EZDSStringItem"/>
        <result property="dsAcctNm_S1"                column="DS_ACCT_NM"                 javaType="EZDSStringItem"/>
        <result property="dsLocNm_S1"                 column="SHIP_TO_LOC_NM"             javaType="EZDSStringItem"/>
        <result property="addlLocNm_S1"               column="ADDL_LOC_NM"                javaType="EZDSStringItem"/>
        <result property="firstLineAddr_S1"           column="FIRST_LINE_ADDR"            javaType="EZDSStringItem"/>
        <result property="scdLineAddr_S1"             column="SCD_LINE_ADDR"              javaType="EZDSStringItem"/>
        <result property="thirdLineAddr_S1"           column="THIRD_LINE_ADDR"            javaType="EZDSStringItem"/>
        <result property="frthLineAddr_S1"            column="FRTH_LINE_ADDR"             javaType="EZDSStringItem"/>
        <result property="ctyAddr_S1"                 column="CTY_ADDR"                   javaType="EZDSStringItem"/>
        <result property="cntyPk_S1"                  column="CNTY_PK"                    javaType="EZDSBigDecimalItem"/>
        <result property="stCd_S1"                    column="ST_CD"                      javaType="EZDSStringItem"/>
        <result property="provNm_S1"                  column="PROV_NM"                    javaType="EZDSStringItem"/>
        <result property="postCd_S1"                  column="POST_CD"                    javaType="EZDSStringItem"/>
        <result property="ctryCd_S1"                  column="CTRY_CD"                    javaType="EZDSStringItem"/>
        <result property="poRcptRteTpCd_S1"           column="PO_RCPT_RTE_TP_CD"          javaType="EZDSStringItem"/>
        <result property="rmaRcptRteTpCd_S1"          column="RMA_RCPT_RTE_TP_CD"         javaType="EZDSStringItem"/>
        <result property="vndLocCd_S1"                column="VND_LOC_CD"                 javaType="EZDSStringItem"/>
        <result property="xxSetFlg_R1"                column="RTRN_TO_SET_FLG"            javaType="EZDSStringItem"/>
        <result property="locNum_R1"                  column="RTRN_TO_LOC_NUM"            javaType="EZDSStringItem"/>
        <result property="dsAcctNum_R1"               column="RTRN_TO_DS_ACCT_NUM"        javaType="EZDSStringItem"/>
        <result property="dsAcctNm_R1"                column="RTRN_TO_DS_ACCT_NM"         javaType="EZDSStringItem"/>
        <result property="dsLocNm_R1"                 column="RTRN_TO_LOC_NM"             javaType="EZDSStringItem"/>
        <result property="rtrnToAddlLocNm_R1"         column="RTRN_TO_ADDL_LOC_NM"        javaType="EZDSStringItem"/>
        <result property="rtrnToFirstLineAddr_R1"     column="RTRN_TO_FIRST_LINE_ADDR"    javaType="EZDSStringItem"/>
        <result property="rtrnToScdLineAddr_R1"       column="RTRN_TO_SCD_LINE_ADDR"      javaType="EZDSStringItem"/>
        <result property="rtrnToThirdLineAddr_R1"     column="RTRN_TO_THIRD_LINE_ADDR"    javaType="EZDSStringItem"/>
        <result property="rtrnToFrthLineAddr_R1"      column="RTRN_TO_FRTH_LINE_ADDR"     javaType="EZDSStringItem"/>
        <result property="rtrnToCtyAddr_R1"           column="RTRN_TO_CTY_ADDR"           javaType="EZDSStringItem"/>
        <result property="cntyPk_R1"                  column="RTRN_TO_CNTY_PK"            javaType="EZDSBigDecimalItem"/>
        <result property="rtrnToStCd_R1"              column="RTRN_TO_ST_CD"              javaType="EZDSStringItem"/>
        <result property="rtrnToProvNm_R1"            column="RTRN_TO_PROV_NM"            javaType="EZDSStringItem"/>
        <result property="rtrnToPostCd_R1"            column="RTRN_TO_POST_CD"            javaType="EZDSStringItem"/>
        <result property="ctryCd_R1"                  column="RTRN_TO_CTRY_CD"            javaType="EZDSStringItem"/>
        <result property="vndLocCd_R1"                column="RTRN_TO_VND_LOC_CD"         javaType="EZDSStringItem"/>
        <result property="plnItemInsrcCd_S1"          column="PLN_ITEM_INSRC_CD"          javaType="EZDSStringItem"/>
        <result property="srcZnCd_S1"                 column="SRC_ZN_CD"                  javaType="EZDSStringItem"/>
        <result property="procrTpCd_S1"               column="DEF_SRC_PROCR_TP_CD"        javaType="EZDSStringItem"/>
        <result property="prntVndNm_SD"               column="DEF_SRC_RTL_WH_NM"          javaType="EZDSStringItem"/>
        <result property="vndNm_SD"                   column="DEF_SRC_RTL_SWH_NM"         javaType="EZDSStringItem"/>
        <result property="procrTpCd_E1"               column="EMER_SRC_PROCR_TP_CD"       javaType="EZDSStringItem"/>
        <result property="prntVndNm_SE"               column="EMER_SRC_RTL_WH_NM"         javaType="EZDSStringItem"/>
        <result property="vndNm_SE"                   column="EMER_SRC_RTL_SWH_NM"        javaType="EZDSStringItem"/>
        <result property="procrTpCd_R1"               column="DEF_RTRN_TO_PROCR_TP_CD"    javaType="EZDSStringItem"/>
        <result property="prntVndNm_SR"               column="DEF_RTRN_TO_RTL_WH_NM"      javaType="EZDSStringItem"/>
        <result property="vndNm_SR"                   column="DEF_RTRN_TO_RTL_SWH_NM"     javaType="EZDSStringItem"/>
        <result property="ezUpTime_G1"                column="EZUPTIME"                   javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_G1"            column="EZUPTIMEZONE"               javaType="EZDSStringItem"/>
        <result property="prntVndCd"                  column="PRNT_VND_CD"                javaType="EZDSStringItem"/>
        <result property="vndCd"                      column="VND_CD"                     javaType="EZDSStringItem"/>
        <result property="techMblMsgAddr"             column="TECH_MBL_MSG_ADDR"          javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="countRtlWhByWmsWhCd" parameterClass="Map" resultMap="Integer">
        SELECT
            COUNT(*) CNT
        FROM
            RTL_WH
        WHERE
            GLBL_CMPY_CD    = #glblCmpyCd#
        AND RTL_WH_CD      != #rtlWhCd#
        AND INVTY_OWNR_CD   = #invtyOwnrCd#
        AND WMS_WH_CD       = #wmsWhCd#
        AND EZCANCELFLAG    = '0'
    </statement>

    <statement id="countRtlWhByPhysWhCd" parameterClass="Map" resultMap="Integer">
        SELECT
            COUNT(*) CNT
        FROM
            RTL_WH
        WHERE
            GLBL_CMPY_CD    = #glblCmpyCd#
        AND RTL_WH_CD      != #rtlWhCd#
        AND INVTY_OWNR_CD   = #invtyOwnrCd#
        AND PHYS_WH_CD      = #physWhCd#
        AND EZCANCELFLAG    = '0'
    </statement>

    <statement id="getRtlSwh" parameterClass="Map" resultMap="result.getRtlSwh">
        SELECT
                RELN.RTL_SWH_CD                                   AS RTL_SWH_CD
              , NVL(RSW.RTL_SWH_NM, RELN.RTL_SWH_NM)              AS RTL_SWH_NM
              , NVL(RSW.RTL_SWH_DESC_TXT, RELN.RTL_SWH_DESC_TXT)  AS RTL_SWH_DESC_TXT
              , RSW.PRTY_LOC_FLG                                  AS PRTY_LOC_FLG
              , RSW.RTL_SWH_DSBL_FLG                              AS RTL_SWH_DSBL_FLG
              , RSW.MRP_ENBL_FLG                                  AS MRP_ENBL_FLG
              , RW.INVTY_OWNR_CD || RELN.RTL_SWH_CD               AS PKG_CD
              , RSW.DEF_SRC_PROCR_TP_CD                           AS PROCR_TP_CD_OF_SRC
              , RSW.DEF_SRC_RTL_WH_CD                             AS RTL_WH_CD_OF_SRC
              , RSW.DEF_SRC_RTL_SWH_CD                            AS RTL_SWH_CD_OF_SRC
              , CASE
                    WHEN RSW.DEF_SRC_PROCR_TP_CD = #procrTp_Supplier# THEN PV_S.PRNT_VND_NM
                    ELSE RW_S.RTL_WH_NM
                END                                               AS RTL_WH_NM_OF_SRC
              , CASE
                    WHEN RSW.DEF_SRC_PROCR_TP_CD = #procrTp_Supplier# THEN V_S.LOC_NM
                    ELSE RSW_S.RTL_SWH_NM
                END                                               AS RTL_SWH_NM_OF_SRC
              , RSW.DEF_RTRN_TO_PROCR_TP_CD                       AS PROCR_TP_CD_OF_RTRN
              , RSW.DEF_RTRN_TO_RTL_WH_CD                         AS RTL_WH_CD_OF_RTRN
              , RSW.DEF_RTRN_TO_RTL_SWH_CD                        AS RTL_SWH_CD_OF_RTRN
              , CASE
                    WHEN RSW.DEF_RTRN_TO_PROCR_TP_CD = #procrTp_Supplier# THEN PV_R.PRNT_VND_NM
                    ELSE RW_R.RTL_WH_NM
                END                                               AS RTL_WH_NM_OF_RTRN
              , CASE
                    WHEN RSW.DEF_RTRN_TO_PROCR_TP_CD = #procrTp_Supplier# THEN V_R.LOC_NM
                    ELSE RSW_R.RTL_SWH_NM
                END                                               AS RTL_SWH_NM_OF_RTRN
              , CASE
                    WHEN RSW.RTL_SWH_CD IS NULL THEN #swhDsblFlgY#
                    ELSE #swhDsblFlgN#
                END                                               AS XX_MODE
              , RELN.RTL_SWH_MND_FLG                              AS RTL_SWH_MND_FLG
              , RSW.INVTY_LOC_CD                                  AS INVTY_LOC_CD
              , RELN.RTL_WH_CATG_CD                               AS RTL_WH_CATG_CD
              , RSW.EFF_FROM_DT                                   AS EFF_FROM_DT
              , RSW.EFF_THRU_DT                                   AS EFF_THRU_DT
              , RELN.RTL_SWH_SORT_NUM                             AS RTL_SWH_SORT_NUM
         FROM
                RTL_WH                RW
              , RTL_WH_CATG_SWH_RELN  RELN
              , RTL_SWH               RSW
              , RTL_WH                RW_S
              , RTL_SWH               RSW_S
              , RTL_WH                RW_R
              , RTL_SWH               RSW_R
              , PRNT_VND              PV_S
              , VND                   V_S
              , PRNT_VND              PV_R
              , VND                   V_R
         WHERE
                RW.GLBL_CMPY_CD                = RELN.GLBL_CMPY_CD(+)
            AND RW.RTL_WH_CATG_CD              = RELN.RTL_WH_CATG_CD(+)
            AND RELN.GLBL_CMPY_CD              = RSW.GLBL_CMPY_CD(+)
            AND RELN.RTL_WH_CATG_CD            = RSW.RTL_WH_CATG_CD(+)
            AND RELN.RTL_SWH_CD                = RSW.RTL_SWH_CD(+)
            AND RSW.GLBL_CMPY_CD               = RW_S.GLBL_CMPY_CD(+)
            AND RSW.DEF_SRC_RTL_WH_CD          = RW_S.RTL_WH_CD(+)
            AND RSW.GLBL_CMPY_CD               = RSW_S.GLBL_CMPY_CD(+)
            AND RSW.DEF_SRC_RTL_WH_CD          = RSW_S.RTL_WH_CD(+)
            AND RSW.DEF_SRC_RTL_SWH_CD         = RSW_S.RTL_SWH_CD(+)
            AND RSW.GLBL_CMPY_CD               = RW_R.GLBL_CMPY_CD(+)
            AND RSW.DEF_RTRN_TO_RTL_WH_CD      = RW_R.RTL_WH_CD(+)
            AND RSW.GLBL_CMPY_CD               = RSW_R.GLBL_CMPY_CD(+)
            AND RSW.DEF_RTRN_TO_RTL_WH_CD      = RSW_R.RTL_WH_CD(+)
            AND RSW.DEF_RTRN_TO_RTL_SWH_CD     = RSW_R.RTL_SWH_CD(+)
            AND RSW.GLBL_CMPY_CD               = PV_S.GLBL_CMPY_CD(+)
            AND RSW.DEF_SRC_RTL_WH_CD          = PV_S.PRNT_VND_CD(+)
            AND RSW.GLBL_CMPY_CD               = V_S.GLBL_CMPY_CD(+)
            AND RSW.DEF_SRC_RTL_SWH_CD         = V_S.VND_CD(+)
            AND RSW.GLBL_CMPY_CD               = PV_R.GLBL_CMPY_CD(+)
            AND RSW.DEF_RTRN_TO_RTL_WH_CD      = PV_R.PRNT_VND_CD(+)
            AND RSW.GLBL_CMPY_CD               = V_R.GLBL_CMPY_CD(+)
            AND RSW.DEF_RTRN_TO_RTL_SWH_CD     = V_R.VND_CD(+)
            AND RW.EZCANCELFLAG                = '0'
            AND RELN.EZCANCELFLAG(+)           = '0'
            AND RSW.EZCANCELFLAG(+)            = '0'
            AND RW_S.EZCANCELFLAG(+)           = '0'
            AND RSW_S.EZCANCELFLAG(+)          = '0'
            AND RW_R.EZCANCELFLAG(+)           = '0'
            AND RSW_R.EZCANCELFLAG(+)          = '0'
            AND PV_S.EZCANCELFLAG(+)           = '0'
            AND V_S.EZCANCELFLAG(+)            = '0'
            AND PV_R.EZCANCELFLAG(+)           = '0'
            AND V_R.EZCANCELFLAG(+)            = '0'
            AND RELN.GLBL_CMPY_CD              = #cMsg.glblCmpyCd_G1#
            AND RELN.RTL_SWH_DSBL_FLG          = #swhDsblFlgN#
            AND RW.RTL_WH_CD                   = #cMsg.rtlWhCd_H1#
            AND RSW.RTL_WH_CD(+)               = #cMsg.rtlWhCd_H1#
    ORDER BY
        RTL_WH_CATG_CD
        , RTL_SWH_SORT_NUM
        , RTL_SWH_CD
    </statement>

    <resultMap id="result.getRtlSwh" class="NMAL6820_ASMsg">
        <result property="rtlSwhCd_A1"          column="RTL_SWH_CD"                 javaType="EZDSStringItem"/>
        <result property="rtlSwhNm_A1"          column="RTL_SWH_NM"                 javaType="EZDSStringItem"/>
        <result property="rtlSwhDescTxt_A1"     column="RTL_SWH_DESC_TXT"           javaType="EZDSStringItem"/>
        <result property="xxChkBox_P1"          column="PRTY_LOC_FLG"               javaType="EZDSStringItem"/>
        <result property="xxChkBox_D1"          column="RTL_SWH_DSBL_FLG"           javaType="EZDSStringItem"/>
        <result property="xxChkBox_M1"          column="MRP_ENBL_FLG"               javaType="EZDSStringItem"/>
        <result property="xxScrItem8Txt_A1"     column="PKG_CD"                     javaType="EZDSStringItem"/>
        <result property="procrTpCd_A1"         column="PROCR_TP_CD_OF_SRC"         javaType="EZDSStringItem"/>
        <result property="prntVndNm_AS"         column="RTL_WH_NM_OF_SRC"           javaType="EZDSStringItem"/>
        <result property="vndNm_AS"             column="RTL_SWH_NM_OF_SRC"          javaType="EZDSStringItem"/>
        <result property="procrTpCd_A2"         column="PROCR_TP_CD_OF_RTRN"        javaType="EZDSStringItem"/>
        <result property="prntVndNm_AR"         column="RTL_WH_NM_OF_RTRN"          javaType="EZDSStringItem"/>
        <result property="vndNm_AR"             column="RTL_SWH_NM_OF_RTRN"         javaType="EZDSStringItem"/>
        <result property="xxModeCd_A1"          column="XX_MODE"                    javaType="EZDSStringItem"/>
        <result property="rtlSwhMndFlg_A1"      column="RTL_SWH_MND_FLG"            javaType="EZDSStringItem"/>
        <result property="invtyLocCd_A1"        column="INVTY_LOC_CD"               javaType="EZDSStringItem"/>
        <result property="rtlWhCatgCd_A1"       column="RTL_WH_CATG_CD"             javaType="EZDSStringItem"/>
        <result property="effFromDt_S1"         column="EFF_FROM_DT"                javaType="EZDSStringItem"/>
        <result property="effThruDt_S1"         column="EFF_THRU_DT"                javaType="EZDSStringItem"/>

    </resultMap>

    <statement id="getSwhWhCatgRel" parameterClass="Map" resultMap="result.getSwhWhCatgRel">
        SELECT
               RELN.RTL_SWH_CD              AS RTL_SWH_CD
              ,RELN.RTL_SWH_NM              AS RTL_SWH_NM
              ,RELN.PRTY_LOC_FLG            AS PRTY_LOC_FLG
              ,RELN.RTL_SWH_DSBL_FLG        AS RTL_SWH_DSBL_FLG
              ,RELN.MRP_ENBL_FLG            AS MRP_ENBL_FLG
              ,RELN.RTL_SWH_DESC_TXT        AS RTL_SWH_DESC_TXT
              ,RELN.RTL_SWH_MND_FLG         AS RTL_SWH_MND_FLG
              ,RELN.RTL_WH_CATG_CD          AS RTL_WH_CATG_CD
              ,#ProcrTp_Supplier#           AS PROCR_TP_CD_OF_SRC
              ,#ProcrTp_Supplier#           AS PROCR_TP_CD_OF_RTRN
          FROM RTL_WH_CATG_SWH_RELN RELN
         WHERE 1=1
           AND RELN.EZCANCELFLAG = '0'
           AND RELN.RTL_SWH_DSBL_FLG = #swhDsblFlgN#
           AND RELN.GLBL_CMPY_CD = #cMsg.glblCmpyCd_G1#
         ORDER BY
               RELN.RTL_WH_CATG_CD
              ,RELN.RTL_SWH_SORT_NUM
              ,RELN.RTL_SWH_CD
    </statement>

    <resultMap id="result.getSwhWhCatgRel" class="NMAL6820_CSMsg">
        <result property="rtlSwhCd_C1"          column="RTL_SWH_CD"                 javaType="EZDSStringItem"/>
        <result property="rtlSwhNm_C1"          column="RTL_SWH_NM"                 javaType="EZDSStringItem"/>
        <result property="xxChkBox_CP"          column="PRTY_LOC_FLG"               javaType="EZDSStringItem"/>
        <result property="xxChkBox_CD"          column="RTL_SWH_DSBL_FLG"           javaType="EZDSStringItem"/>
        <result property="xxChkBox_CM"          column="MRP_ENBL_FLG"               javaType="EZDSStringItem"/>
        <result property="rtlSwhDescTxt_C1"     column="RTL_SWH_DESC_TXT"           javaType="EZDSStringItem"/>
        <result property="rtlSwhMndFlg_C1"      column="RTL_SWH_MND_FLG"            javaType="EZDSStringItem"/>
        <result property="rtlWhCatgCd_C1"       column="RTL_WH_CATG_CD"             javaType="EZDSStringItem"/>
        <result property="procrTpCd_C1"         column="PROCR_TP_CD_OF_SRC"         javaType="EZDSStringItem"/>
        <result property="procrTpCd_C2"         column="PROCR_TP_CD_OF_RTRN"        javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getMgrNm" parameterClass="Map" resultMap="result.NMAL6820CMsg">
        SELECT
                 P.FULL_PSN_NM AS OWNR_NM
        FROM
                 S21_PSN_V P
        WHERE
                P.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
            AND P.PSN_CD        = #cMsg.whMgrPsnCd_H1#
            AND P.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getAltOwnrNm" parameterClass="Map" resultMap="result.NMAL6820CMsg">
        SELECT
               P.FULL_PSN_NM AS ALT_OWNR_NM
          FROM
               S21_PSN_V P
         WHERE
               1=1
           AND P.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_G1#
           AND P.PSN_CD        = #cMsg.altPsnCd_H1#
           AND P.EZCANCELFLAG  = '0'
    </statement>

    <resultMap id="result.NMAL6820CMsg" class="NMAL6820CMsg">
        <result property="fullPsnNm_H1"           column="TECH_NM"                   javaType="EZDSStringItem"/>
        <result property="fullPsnNm_H1"           column="OWNR_NM"                   javaType="EZDSStringItem"/>
        <result property="fullPsnNm_H2"           column="ALT_OWNR_NM"               javaType="EZDSStringItem"/>
        <result property="locTpCd_H1"             column="LOC_TP_CD"                 javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getInvtyMstr" parameterClass="Map" resultClass="Integer">
        SELECT
               count(*)
          FROM
               INVTY I
         WHERE
               1=1
           AND I.GLBL_CMPY_CD  = #glblCmpyCd#
           AND I.INVTY_LOC_CD  = #invtyLocCd#
           AND I.INVTY_QTY     > 0
           AND I.EZCANCELFLAG  = '0'
           AND ROWNUM          =  1
    </statement>

    <statement id="getImportInvoiceConsigneeByPartyCode" parameterClass="Map" resultClass="Map">
        SELECT
               A.IMPT_INV_CNSGN_CD
          FROM
               IMPT_INV_CNSGN A
         WHERE
               1=1
           AND A.IMPT_INV_CNSGN_CD   = #ptyCd#
           AND A.GLBL_CMPY_CD        = #globalCompanyCode#
           AND A.EZCANCELFLAG        = '0'
    </statement>

    <!-- Searches WH and Sub WH. -->
    <statement id="searchWhSwh" parameterClass="Map" resultClass="Map">
        SELECT
                RW.RTL_WH_CD
              , RW.RTL_WH_NM
              , RSW.RTL_SWH_CD
              , RSW.RTL_SWH_NM
        FROM
                RTL_SWH RSW
              , RTL_WH RW
        WHERE
                RSW.GLBL_CMPY_CD     = #glblCmpyCd#
            AND RSW.RTL_SWH_NM       = #rtlSwhNm#
            AND RSW.EZCANCELFLAG     = '0'
            AND RSW.GLBL_CMPY_CD     = RW.GLBL_CMPY_CD
            AND RSW.RTL_WH_CD        = RW.RTL_WH_CD
            AND RW.RTL_WH_NM         = #rtlWhNm#
            AND RW.EZCANCELFLAG      = '0'
    </statement>

    <statement id="searchSupplier" parameterClass="Map" resultClass="Map">
        SELECT
                PV.PRNT_VND_CD
              , V.VND_CD
        FROM
                PRNT_VND    PV
              , VND         V
              , VND_TP_RELN VTR
        WHERE
                PV.GLBL_CMPY_CD      = #glblCmpyCd#
            AND PV.GLBL_CMPY_CD      = V.GLBL_CMPY_CD
            AND PV.PRNT_VND_PK       = V.PRNT_VND_PK
            AND V.GLBL_CMPY_CD       = VTR.GLBL_CMPY_CD
            AND V.VND_CD             = VTR.VND_CD
            AND (    PV.INAC_DT      IS NULL
                  OR PV.INAC_DT      > TO_CHAR (SYSDATE, 'YYYYMMDD')
                )
            AND VTR.VND_TP_CD        = #vndTp_Supplier#
            AND V.RGTN_STS_CD        = #rgtnSts_ReadyForOrderTaking#
            AND V.EFF_THRU_DT        >= TO_CHAR (SYSDATE, 'YYYYMMDD')
            AND PV.PRNT_VND_NM       = #prntVndNm#
            AND V.LOC_NM             = #vndNm#
            AND PV.EZCANCELFLAG      = '0'
            AND V.EZCANCELFLAG       = '0'
            AND VTR.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getPR" parameterClass="Map" resultClass="Integer">
        SELECT
                count(*)
         FROM
                PRCH_REQ_DTL PRD
         WHERE
                PRD.GLBL_CMPY_CD                   = #glblCmpyCd#
            AND PRD.EZCANCELFLAG                   = '0'
            AND PRD.DEST_RTL_WH_CD                 = #rtlWhCd#
            AND PRD.PRCH_REQ_LINE_STS_CD    &lt;&gt; #prchReqLineSts_Cancelled#
            AND ROWNUM                             = 1
    </statement>

    <statement id="getPO" parameterClass="Map" resultClass="Integer">
        SELECT
                count(*)
         FROM
                PO P
         WHERE
                P.GLBL_CMPY_CD                    = #glblCmpyCd#
            AND P.EZCANCELFLAG                    = '0'
            AND P.DEST_RTL_WH_CD                  = #rtlWhCd#
            AND P.PO_HDR_STS_CD            &lt;&gt; #poHdrSts_Cancelled#
            AND ROWNUM                             = 1
    </statement>

    <statement id="getRWS" parameterClass="Map" resultClass="Integer">
        SELECT
                count(*)
         FROM
                RWS_HDR RH
         WHERE
                RH.GLBL_CMPY_CD                    = #glblCmpyCd#
            AND RH.EZCANCELFLAG                    = '0'
            AND RH.WH_CD                           = #rtlWhCd#
            AND RH.RWS_STS_CD               &lt;&gt; #rwsSts_Cancelled#
            AND ROWNUM                             = 1
    </statement>

    <statement id="getInvty" parameterClass="Map" resultClass="Integer">
        SELECT
                count(*)
         FROM
                INVTY I
         WHERE
                I.GLBL_CMPY_CD                     = #glblCmpyCd#
            AND I.EZCANCELFLAG                     = '0'
            AND I.INVTY_LOC_CD                  LIKE #rtlWhCd# || '%'
            AND I.INVTY_QTY                        > 0
            AND ROWNUM                             = 1
    </statement>

    <statement id="getDefDsAcctInfo" parameterClass="Map" resultClass="Map">
        SELECT
               WDC.DS_ACCT_NUM
             , STC.DS_ACCT_NM
          FROM 
               WH_DEF_CUST  WDC
             , SELL_TO_CUST STC
         WHERE
               WDC.GLBL_CMPY_CD    = STC.GLBL_CMPY_CD(+)
           AND WDC.DS_ACCT_NUM     = STC.SELL_TO_CUST_CD(+)
           AND WDC.GLBL_CMPY_CD    = #glblCmpyCd#
           AND WDC.EZCANCELFLAG    = '0'
           AND STC.EZCANCELFLAG(+) = '0'
           AND ROWNUM              = 1
    </statement>

    <statement id="getShipToCustInfo" parameterClass="Map" resultClass="Map">
        SELECT
                STC.SHIP_TO_CUST_CD         AS SHIP_TO_CUST_CD
              , STCS.SELL_TO_CUST_CD        AS SELL_TO_CUST_CD
              , STCS.DS_ACCT_NM             AS DS_ACCT_NM
              , PLW.DS_LOC_NM               AS DS_LOC_NM
              , STC.ADDL_LOC_NM             AS ADDL_LOC_NM
              , STC.FIRST_LINE_ADDR         AS FIRST_LINE_ADDR
              , STC.SCD_LINE_ADDR           AS SCD_LINE_ADDR
              , STC.THIRD_LINE_ADDR         AS THIRD_LINE_ADDR
              , STC.FRTH_LINE_ADDR          AS FRTH_LINE_ADDR
              , STC.CTY_ADDR                AS CTY_ADDR
              , STC.CNTY_PK                 AS CNTY_PK
              , STC.ST_CD                   AS ST_CD
              , STC.PROV_NM                 AS PROV_NM
              , STC.POST_CD                 AS POST_CD
              , STC.CTRY_CD                 AS CTRY_CD
              , CASE WHEN EXISTS (SELECT '1'
                                   FROM WH_DEF_CUST WDC
                                  WHERE WDC.GLBL_CMPY_CD = STC.GLBL_CMPY_CD
                                    AND WDC.DS_ACCT_NUM  = STC.SELL_TO_CUST_CD
                                    AND WDC.EZCANCELFLAG = '0')
                     THEN 'Y'
                     ELSE 'N'
                END                         AS WH_DEF_CUST_EXIST_FLG
              , CNT.CNTY_NM                 AS CNTY_NM
          FROM
               SHIP_TO_CUST      STC
             , SELL_TO_CUST      STCS
             , PTY_LOC_WRK       PLW
             , CNTY              CNT
         WHERE
               STC.GLBL_CMPY_CD             = STCS.GLBL_CMPY_CD(+)
           AND STC.SELL_TO_CUST_CD          = STCS.SELL_TO_CUST_CD(+)
           AND STC.GLBL_CMPY_CD             = PLW.GLBL_CMPY_CD(+)
           AND STC.PTY_LOC_PK               = PLW.PTY_LOC_PK(+)
           AND STC.EZCANCELFLAG             = '0'
           AND STCS.EZCANCELFLAG(+)         = '0'
           AND PLW.EZCANCELFLAG(+)          = '0'
           AND STC.GLBL_CMPY_CD             = #glblCmpyCd#
           AND STC.LOC_NUM                  = #locNum#
           AND STC.CNTY_PK                  = CNT.CNTY_PK(+)
    </statement>

    <statement id="getSuffixForRtrnTo" parameterClass="Map" resultClass="String">
        SELECT
               VCC.VAR_CHAR_CONST_VAL
          FROM 
               VAR_CHAR_CONST  VCC
         WHERE
               VCC.GLBL_CMPY_CD        = #glblCmpyCd#
           AND VCC.VAR_CHAR_CONST_NM   = #varCharConstNm#
           AND VCC.EZCANCELFLAG        = '0'
    </statement>


    <statement id="getShipToCustCdByLocNum" parameterClass="Map" resultClass="Map">
        SELECT
               STC.SHIP_TO_CUST_CD
          FROM
               SHIP_TO_CUST        STC
         WHERE
           AND STC.GLBL_CMPY_CD    = #glblCmpyCd#
           AND STC.LOC_NUM         = #locNum#
           AND STC.EZCANCELFLAG    = '0'
    </statement>
    <statement id="getAddrByPost" parameterClass="Map" resultClass="Map">
    SELECT DISTINCT
           P.CTY_ADDR
         , P.ST_CD
         , P.POST_CD
         , C.CNTY_NM
         , C.CNTY_PK
      FROM 
           POST P
         , CNTY_POST_RELN R
         , CNTY C
     WHERE 
           P.EZCANCELFLAG = '0'
       AND P.GLBL_CMPY_CD = #glblCmpyCd#
       AND P.POST_CD = #postCd#
       AND R.EZCANCELFLAG(+) = '0'
       AND R.GLBL_CMPY_CD(+) = P.GLBL_CMPY_CD
       AND R.POST_PK(+) = P.POST_PK
       AND C.EZCANCELFLAG(+) = '0'
       AND C.GLBL_CMPY_CD(+) = R.GLBL_CMPY_CD
       AND C.CNTY_PK(+) = R.CNTY_PK 
     ORDER BY
           P.CTY_ADDR
         , P.ST_CD
         , P.POST_CD
         , C.CNTY_NM
    </statement>
    <statement id ="getAddrInfo" parameterClass="Map" resultClass="BigDecimal">
    SELECT
           C.CNTY_PK
      FROM
           CNTY C
     WHERE
           C.GLBL_CMPY_CD = #glblCmpyCd#
       AND C.CNTY_NM      = #cntyNm#
       AND C.ST_CD        = #stCd#
       AND C.EZCANCELFLAG = '0'
    </statement>
        <statement id ="getCntyNm" parameterClass="Map" resultClass="String">
    SELECT
           C.CNTY_NM
      FROM
           CNTY C
     WHERE
           C.GLBL_CMPY_CD = #glblCmpyCd#
       AND C.CNTY_PK      = #cntyPk#
       AND C.EZCANCELFLAG = '0'
    </statement>
    <statement id="getPrtVndNm" parameterClass="Map" resultClass="String">
        SELECT
            PV.PRNT_VND_NM
        FROM
            PRNT_VND PV
        WHERE
            PV.GLBL_CMPY_CD =  #glblCmpyCd#
        AND PV.PRNT_VND_CD  =  #prntVndCd#
        AND (PV.INAC_DT IS NULL 
              OR PV.INAC_DT > #salesDate#)
        AND PV.EZCANCELFLAG = '0'
    </statement>

    <statement id="getVndNm" parameterClass="Map" resultClass="String">
        SELECT
            V.LOC_NM
        FROM
            VND V
        WHERE
            V.GLBL_CMPY_CD = #glblCmpyCd#
        AND V.VND_CD       = #vndCd#
        AND V.RGTN_STS_CD  = #rgtnStsCd#
        AND NVL(V.EFF_THRU_DT, '99991231') &gt;= #salesDate#
        AND V.EZCANCELFLAG = '0'
    </statement>

    <statement id="getVendorInfo" parameterClass="Map" resultClass="Map">
        SELECT
             VND.VND_CD
            ,VND.LOC_NM
            ,VND.DEAL_CCY_CD
            ,VND.VND_PMT_TERM_DESC_TXT
            ,PV.PRNT_VND_CD
            ,PV.PRNT_VND_NM
        FROM
             VND      VND
            ,PRNT_VND PV
        WHERE
                VND.GLBL_CMPY_CD = #glblCmpyCd#
            AND VND.VND_CD       = #vndCd#
            AND VND.RGTN_STS_CD  = #rgtnStsCd#
            AND VND.GLBL_CMPY_CD = PV.GLBL_CMPY_CD
            AND VND.PRNT_VND_PK  = PV.PRNT_VND_PK
            AND VND.EZCANCELFLAG = '0'
            AND PV.EZCANCELFLAG  = '0'
    </statement>

    <!-- QC#21852 Add SQL  -->
    <statement id="getStCdList" parameterClass="Map" resultClass="String">
        SELECT
             S.ST_CD
        FROM
             ST      S
        WHERE
                S.GLBL_CMPY_CD = #glblCmpyCd#
            AND S.EZCANCELFLAG = '0'
        ORDER BY 
            S.ST_SORT_NUM ASC
    </statement>

    <!-- QC#21852 Add SQL  -->
    <statement id="getShpgModeCdList" parameterClass="Map" resultClass="String">
        SELECT
             SM.SHPG_MODE_CD
        FROM
             SHPG_MODE      SM
        WHERE
                SM.GLBL_CMPY_CD = #glblCmpyCd#
            AND SM.EZCANCELFLAG = '0'
    </statement>

    <!-- QC#21852 Add SQL  -->
    <statement id="getShpgSvcLvlCdList" parameterClass="Map" resultClass="String">
        SELECT
             SSL.SHPG_SVC_LVL_CD
        FROM
             SHPG_SVC_LVL      SSL
        WHERE
                SSL.GLBL_CMPY_CD = #glblCmpyCd#
            AND SSL.EZCANCELFLAG = '0'
        ORDER BY
            SSL.SHPG_SVC_LVL_SORT_NUM
    </statement>
</sqlMap>
