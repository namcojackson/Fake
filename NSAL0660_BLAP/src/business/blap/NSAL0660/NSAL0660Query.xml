<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAL0660Query">
    <typeAlias alias="NSAL0660_ASMsg" type="business.blap.NSAL0660.NSAL0660_ASMsg"/>

    <statement id="getContrInfo" parameterClass="Map" resultMap="result.getContrInfo">
        SELECT
             DCH.DS_CONTR_PK                    DS_CONTR_PK
            ,DCH.DS_CONTR_CATG_CD               DS_CONTR_CATG_CD
            ,DCH.DS_CONTR_NUM                   DS_CONTR_NUM
            ,TRIM(DCC.DS_CONTR_CATG_ABBR_NM
                || '-' || DCH.DS_CONTR_NUM)  AS XX_SCR_ITEM_34_TXT
            ,STC.DS_ACCT_NM                     DS_ACCT_NM
            ,TRIM(BTC.FIRST_LINE_ADDR 
                || ' ' || BTC.CTY_ADDR
                || ' ' || BTC.ST_CD
                || ' ' || BTC.POST_CD)       AS BILL_TO_ADDR
            ,DCH.CONTR_VRSN_EFF_FROM_DT         CONTR_VRSN_EFF_FROM_DT
            ,DCH.CONTR_VRSN_EFF_THRU_DT         CONTR_VRSN_EFF_THRU_DT
            ,DCS.DS_CONTR_CTRL_STS_NM           DS_CONTR_CTRL_STS_NM
        FROM
             DS_CONTR       DCH
            ,SELL_TO_CUST   STC
            ,BILL_TO_CUST   BTC
            ,DS_CONTR_STS_V DCS
            ,DS_CONTR_CATG  DCC
        WHERE
                DCH.GLBL_CMPY_CD        = #glblCmpyCd#
            <iterate property="dsContrPkList" var="dsContrPk[]" open="AND DCH.DS_CONTR_PK IN (" close=")" conjunction=",">
                #dsContrPk[]#
            </iterate>
            AND DCH.EZCANCELFLAG        = '0'
            AND DCH.GLBL_CMPY_CD        = STC.GLBL_CMPY_CD
            AND DCH.DS_ACCT_NUM         = STC.SELL_TO_CUST_CD
            AND STC.EZCANCELFLAG        = '0'
            AND DCH.GLBL_CMPY_CD        = BTC.GLBL_CMPY_CD
            AND DCH.ALT_PAYER_CUST_CD   = BTC.BILL_TO_CUST_CD
            AND BTC.EZCANCELFLAG        = '0'
            AND DCH.GLBL_CMPY_CD        = DCS.GLBL_CMPY_CD
            AND DCH.DS_CONTR_PK         = DCS.DS_CONTR_PK
            AND DCS.EZCANCELFLAG        = '0'
            AND DCH.GLBL_CMPY_CD        = DCC.GLBL_CMPY_CD
            AND DCH.DS_CONTR_CATG_CD    = DCC.DS_CONTR_CATG_CD
            AND DCC.EZCANCELFLAG        = '0'
        ORDER BY
             DCH.DS_CONTR_CATG_CD
            ,DCH.DS_CONTR_NUM
    </statement>
    <resultMap id="result.getContrInfo" class="NSAL0660_ASMsg">
        <result property="dsContrPk_A1" column="DS_CONTR_PK"  javaType="EZDSBigDecimalItem" />
        <result property="xxScrItem34Txt_A1" column="XX_SCR_ITEM_34_TXT"  javaType="EZDSStringItem" />
        <result property="dsAcctNm_A1" column="DS_ACCT_NM"  javaType="EZDSStringItem" />
        <result property="xxFirstScdCtyStAddr_A1" column="BILL_TO_ADDR"  javaType="EZDSStringItem" />
        <result property="contrVrsnEffFromDt_A1" column="CONTR_VRSN_EFF_FROM_DT"  javaType="EZDSDateItem" />
        <result property="contrVrsnEffThruDt_A1" column="CONTR_VRSN_EFF_THRU_DT"  javaType="EZDSDateItem" />
        <result property="dsContrCtrlStsNm_A1" column="DS_CONTR_CTRL_STS_NM"  javaType="EZDSStringItem" />
    </resultMap>
</sqlMap>
