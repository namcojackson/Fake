<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWWL0040Query">
    <statement id="searchNtfyHdr" resultClass="BigDecimal" parameterClass="Map">
        SELECT
            NH.NTFY_HDR_PK
        FROM
            NTFY_HDR NH
        WHERE
                NH.GLBL_CMPY_CD               = #glblCmpyCd#
            AND NH.EZCANCELFLAG               = '0'
            <isNotNull property="ntfyHdrNm">
                AND UPPER(NH.NTFY_HDR_NM)                LIKE UPPER(#ntfyHdrNm#)
            </isNotNull>
            <isNotNull property="ntfyHdrDescTxt">
                AND UPPER(NH.NTFY_HDR_DESC_TXT)          LIKE UPPER(#ntfyHdrDescTxt#)
            </isNotNull>
            <isNotNull property="ntfyBizAreaTpCd">
                AND NH.NTFY_BIZ_AREA_TP_CD        = #ntfyBizAreaTpCd#
            </isNotNull>
            <isNotNull property="ntfySubAreaTpCd">
                AND NH.NTFY_SUB_AREA_TP_CD        = #ntfySubAreaTpCd#
            </isNotNull>
            <isNotNull property="effFromDt">
                AND NH.EFF_FROM_DT            &gt;= #effFromDt#
            </isNotNull>
            <isNotNull property="effThruDt">
                AND NVL(NH.EFF_THRU_DT,#maxDt#) &lt;= #effThruDt#
            </isNotNull>
            <isNotNull property="ntfyHdActvFlg">
                AND NH.NTFY_HDR_ACTV_FLG          = 'Y'
                AND NH.EFF_FROM_DT              &lt;= #slsDt#
                AND NVL(NH.EFF_THRU_DT,#maxDt#) &gt;= #slsDt#
            </isNotNull>
    </statement>
    
    <statement id="searchDistList" resultClass="Map" parameterClass="Map">
        SELECT
            NTFY_DIST_LIST_ID
            ,NTFY_DIST_LIST_NM
            ,NTFY_DIST_LIST_DESC_TXT
            ,NTFY_BIZ_AREA_TP_DESC_TXT
            ,NTFY_SUB_AREA_TP_DESC_TXT
            ,EFF_FROM_DT
            ,EFF_THRU_DT
        FROM
            (
            SELECT DISTINCT
                NDL.NTFY_DIST_LIST_ID
                ,NDL.NTFY_DIST_LIST_NM
                ,NDL.NTFY_DIST_LIST_DESC_TXT
                ,NBAT.NTFY_BIZ_AREA_TP_DESC_TXT
                ,NSAT.NTFY_SUB_AREA_TP_DESC_TXT
                ,NDL.EFF_FROM_DT
                ,NDL.EFF_THRU_DT
            FROM
                NTFY_DIST_LIST NDL
                <isNotNull property="hdrPk">
                ,NTFY_ACT_DTL NAD
                ,NTFY_DIST_RELN NDR
                </isNotNull>
                ,NTFY_BIZ_AREA_TP NBAT
                ,NTFY_SUB_AREA_TP NSAT
            WHERE
                <isNotNull property="hdrPk">
                    NAD.GLBL_CMPY_CD = #glblCmpyCd#
                AND NAD.EZCANCELFLAG = '0'
                
                    <iterate property="hdrPk" var="elem[]" open="AND (" close=")" conjunction="OR">
                            NAD.NTFY_HDR_PK = #elem[]#
                    </iterate>
                
            
                AND NAD.GLBL_CMPY_CD    = NDR.GLBL_CMPY_CD
                AND NAD.EZCANCELFLAG    = NDR.EZCANCELFLAG
                AND NAD.NTFY_ACT_DTL_PK = NDR.NTFY_ACT_DTL_PK
                
                AND NDR.NTFY_DIST_LIST_PK            = NDL.NTFY_DIST_LIST_PK
                AND
                </isNotNull>
                    NDL.GLBL_CMPY_CD                 = #glblCmpyCd#
                AND NDL.EZCANCELFLAG                 = '0'
                
                <isNotNull property="ntfyDistListNm">
                    AND UPPER(NDL.NTFY_DIST_LIST_NM)            LIKE UPPER(#ntfyDistListNm#)
                </isNotNull>
                <isNotNull property="ntfyDistListDescTxt">
                    AND UPPER(NDL.NTFY_DIST_LIST_DESC_TXT)      LIKE UPPER(#ntfyDistListDescTxt#)
                </isNotNull>
                <isNotNull property="ntfyBizAreaTpCd">
                    AND NDL.NTFY_BIZ_AREA_TP_CD          = #ntfyBizAreaTpCd#
                </isNotNull>
                <isNotNull property="ntfySubAreaTpCd">
                    AND NDL.NTFY_SUB_AREA_TP_CD          = #ntfySubAreaTpCd#
                </isNotNull>
                <isNotNull property="effFromDt">
                    AND NDL.EFF_FROM_DT              &gt;= #effFromDt#
                </isNotNull>
                <isNotNull property="effThruDt">
                    AND NVL(NDL.EFF_THRU_DT,#maxDt#) &lt;= #effThruDt#
                </isNotNull>
                <isNotNull property="ntfyDistListActvFlg">
                    AND NDL.NTFY_DIST_LIST_ACTV_FLG      = 'Y'
                    AND NDL.EFF_FROM_DT              &lt;= #slsDt#
                    AND NVL(NDL.EFF_THRU_DT,#maxDt#) &gt;= #slsDt#
                </isNotNull>
                
                AND NDL.GLBL_CMPY_CD        = NBAT.GLBL_CMPY_CD (+)
                AND NDL.EZCANCELFLAG        = NBAT.EZCANCELFLAG (+)
                AND NDL.NTFY_BIZ_AREA_TP_CD = NBAT.NTFY_BIZ_AREA_TP_CD (+)
            
                AND NDL.GLBL_CMPY_CD        = NSAT.GLBL_CMPY_CD (+)
                AND NDL.EZCANCELFLAG        = NSAT.EZCANCELFLAG (+)
                AND NDL.NTFY_SUB_AREA_TP_CD = NSAT.NTFY_SUB_AREA_TP_CD (+)
            ) R
        WHERE
             ROWNUM &lt;= #rowNum#
    </statement>

</sqlMap>
