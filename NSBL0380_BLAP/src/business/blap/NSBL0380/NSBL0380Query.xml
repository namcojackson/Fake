<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSBL0380Query">
        <typeAlias alias="NSBL0380_ASMsg" type="business.blap.NSBL0380.NSBL0380_ASMsg"/>
        <statement id="getSrchLayerNum" parameterClass="Map" resultMap="result.getSrchLayerNum">
            SELECT
                  A.ORG_LAYER_NUM               AS ORG_LAYER_NUM
                 ,CASE
                    WHEN A.ORG_LAYER_NUM = #layerNum1# THEN A.FIRST_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum2# THEN A.SCD_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum3# THEN A.THIRD_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum4# THEN A.FRTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum5# THEN A.FIFTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum6# THEN A.SIXTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum7# THEN A.SVNTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum8# THEN A.EIGHTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum9# THEN A.NINTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum10# THEN A.TENTH_ORG_CD
                    WHEN A.ORG_LAYER_NUM = #layerNum11# THEN A.ELVTH_ORG_CD END AS ORG_CD
            FROM
                SVC_TASK_HIST_RPT A
            WHERE
                    A.GLBL_CMPY_CD            = #glblCmpyCd#
                AND A.CRAT_DT             &gt;= #xxSumYrMthStartDay# 
                AND A.CRAT_DT             &lt;= #xxSumYrMthEndDay#
                AND A.ORG_LAYER_NUM = 
                CASE WHEN A.FIRST_ORG_CD      = #orgCd# then #layerNum1#
                     WHEN A.SCD_ORG_CD        = #orgCd# then #layerNum2#
                     WHEN A.THIRD_ORG_CD      = #orgCd# then #layerNum3#
                     WHEN A.FRTH_ORG_CD       = #orgCd# then #layerNum4#
                     WHEN A.FIFTH_ORG_CD      = #orgCd# then #layerNum5#
                     WHEN A.SIXTH_ORG_CD      = #orgCd# then #layerNum6#
                     WHEN A.SVNTH_ORG_CD      = #orgCd# then #layerNum7#
                     WHEN A.EIGHTH_ORG_CD     = #orgCd# then #layerNum8#
                     WHEN A.NINTH_ORG_CD      = #orgCd# then #layerNum9#
                     WHEN A.TENTH_ORG_CD      = #orgCd# then #layerNum10#
                     WHEN A.ELVTH_ORG_CD      = #orgCd# then #layerNum11# END
                AND A.SVC_TASK_LTST_FLG       = #svcTaskLtstFlg#
                AND A.EZCANCELFLAG            = '0'
                AND ROWNUM                    = 1
    </statement>
    <resultMap id="result.getSrchLayerNum"            class="NSBL0380_ASMsg">
        <result property="orgLayerNum_A"            column="ORG_LAYER_NUM"                javaType="EZDSBigDecimalItem" />
        <result property="orgCd_A"                  column="ORG_CD"                       javaType="EZDSStringItem" />
    </resultMap>
    
        <statement id="getSrchDtl" parameterClass="Map" resultMap="result.getSrchDtl">
            SELECT
                  CRAT_DT                        AS  CRAT_DT
                 ,TOT_IN_PROC_TASK_CNT           AS  TOT_IN_PROC_TASK_CNT
                 ,PRT_WAIT_TASK_CNT              AS  PRT_WAIT_TASK_CNT
                 ,SPCL_WAIT_TASK_CNT             AS  SPCL_WAIT_TASK_CNT
                 ,OTH_OPEN_TASK_CNT              AS  OTH_OPEN_TASK_CNT
                 ,CUST_TASK_CNT                  AS  CUST_TASK_CNT
                 ,ESCL_TASK_CNT                  AS  ESCL_TASK_CNT
                 ,CRAT_TASK_CNT                  AS  CRAT_TASK_CNT
                 ,CRAT_TASK_PER_TECH_RATE        AS  CRAT_TASK_PER_TECH_RATE
                 ,AFT_HOUR_TASK_CNT              AS  AFT_HOUR_TASK_CNT
                 ,AFT_HOUR_TASK_PER_TECH_RATE    AS  AFT_HOUR_TASK_PER_TECH_RATE
                 ,CLO_TASK_CNT                   AS  CLO_TASK_CNT
                 ,CLO_TASK_PER_TECH_RATE         AS  CLO_TASK_PER_TECH_RATE
                 ,PRT_FAIL_CNT                   AS  PRT_FAIL_CNT
                 ,POST_ENTRY_TASK_CNT            AS  POST_ENTRY_TASK_CNT
                 ,AVAL_TECH_CNT                  AS  AVAL_TECH_CNT
                 ,RSP_TM_CUST_TASK_RATE          AS  RSP_TM_CUST_TASK_RATE
                 ,RSP_TM_ALL_TASK_RATE           AS  RSP_TM_ALL_TASK_RATE
                 ,AFT_HOUR_AVAL_TECH_CNT         AS  AFT_HOUR_AVAL_TECH_CNT
                 ,CLO_CUST_TASK_CNT              AS  CLO_CUST_TASK_CNT
                 ,CLO_ALL_TASK_CNT               AS  CLO_ALL_TASK_CNT
                 ,ORG_LAYER_NUM                  AS  ORG_LAYER_NUM
                 ,ORG_CD                         AS  ORG_CD
                 ,CUST_TASK_TOT_RSP_AOT          AS  CUST_TASK_TOT_RSP_AOT
                 ,ALL_TASK_TOT_RSP_AOT           AS  ALL_TASK_TOT_RSP_AOT
            FROM (
                SELECT
                     A.CRAT_DT                     AS CRAT_DT
                    ,A.TOT_IN_PROC_TASK_CNT        AS TOT_IN_PROC_TASK_CNT
                    ,A.PRT_WAIT_TASK_CNT           AS PRT_WAIT_TASK_CNT
                    ,A.SPCL_WAIT_TASK_CNT          AS SPCL_WAIT_TASK_CNT
                    ,A.OTH_OPEN_TASK_CNT           AS OTH_OPEN_TASK_CNT
                    ,A.CUST_TASK_CNT               AS CUST_TASK_CNT
                    ,A.ESCL_TASK_CNT               AS ESCL_TASK_CNT
                    ,A.CRAT_TASK_CNT               AS CRAT_TASK_CNT
                    ,A.CRAT_TASK_PER_TECH_RATE     AS CRAT_TASK_PER_TECH_RATE
                    ,A.AFT_HOUR_TASK_CNT           AS AFT_HOUR_TASK_CNT
                    ,A.AFT_HOUR_TASK_PER_TECH_RATE AS AFT_HOUR_TASK_PER_TECH_RATE
                    ,A.CLO_TASK_CNT                AS CLO_TASK_CNT
                    ,A.CLO_TASK_PER_TECH_RATE      AS CLO_TASK_PER_TECH_RATE
                    ,A.PRT_FAIL_CNT                AS PRT_FAIL_CNT
                    ,A.POST_ENTRY_TASK_CNT         AS POST_ENTRY_TASK_CNT
                    ,A.AVAL_TECH_CNT               AS AVAL_TECH_CNT
                    ,A.RSP_TM_CUST_TASK_RATE       AS RSP_TM_CUST_TASK_RATE
                    ,A.RSP_TM_ALL_TASK_RATE        AS RSP_TM_ALL_TASK_RATE
                    ,A.AFT_HOUR_AVAL_TECH_CNT      AS AFT_HOUR_AVAL_TECH_CNT
                    ,A.CLO_CUST_TASK_CNT           AS CLO_CUST_TASK_CNT
                    ,A.CLO_ALL_TASK_CNT            AS CLO_ALL_TASK_CNT
                    ,A.ORG_LAYER_NUM               AS ORG_LAYER_NUM
                    ,A.CUST_TASK_TOT_RSP_AOT       AS CUST_TASK_TOT_RSP_AOT
                    ,A.ALL_TASK_TOT_RSP_AOT        AS ALL_TASK_TOT_RSP_AOT
                    ,CASE
                        WHEN A.ORG_LAYER_NUM = #layerNum1# THEN A.FIRST_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum2# THEN A.SCD_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum3# THEN A.THIRD_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum4# THEN A.FRTH_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum5# THEN A.FIFTH_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum6# THEN A.SIXTH_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum7# THEN A.SVNTH_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum8# THEN A.EIGHTH_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum9# THEN A.NINTH_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum10# THEN A.TENTH_ORG_CD
                        WHEN A.ORG_LAYER_NUM = #layerNum11# THEN A.ELVTH_ORG_CD END AS ORG_CD
                FROM
                    SVC_TASK_HIST_RPT A
                WHERE
                        A.GLBL_CMPY_CD      = #glblCmpyCd#
                    AND A.CRAT_DT       &gt;= #xxSumYrMthStartDay# 
                    AND A.CRAT_DT       &lt;= #xxSumYrMthEndDay#
                    AND A.ORG_LAYER_NUM     = #orgLayerNum#
                    <isNotNull property="firstOrgCd">
                    AND A.FIRST_ORG_CD      = #orgCd#
                    </isNotNull>
                    <isNotNull property="scdOrgCd">
                    AND A.SCD_ORG_CD        = #orgCd#
                    </isNotNull>
                    <isNotNull property="thirdOrgCd">
                    AND A.THIRD_ORG_CD      = #orgCd#
                    </isNotNull>
                    <isNotNull property="frthOrgCd">
                    AND A.FRTH_ORG_CD       = #orgCd#
                    </isNotNull>
                    <isNotNull property="fifthOrgCd">
                    AND A.FIFTH_ORG_CD      = #orgCd#
                    </isNotNull>
                    <isNotNull property="sixthOrgCd">
                    AND A.SIXTH_ORG_CD      = #orgCd#
                    </isNotNull>
                    <isNotNull property="svnthOrgCd">
                    AND A.SVNTH_ORG_CD      = #orgCd#
                    </isNotNull>
                    <isNotNull property="eightOrgCd">
                    AND A.EIGHTH_ORG_CD     = #orgCd#
                    </isNotNull>
                    <isNotNull property="ninthOrgCd">
                    AND A.NINTH_ORG_CD      = #orgCd#
                    </isNotNull>
                    <isNotNull property="tenthOrgCd">
                    AND A.TENTH_ORG_CD      = #orgCd#
                    </isNotNull>
                    <isNotNull property="elvthOrgCd">
                    AND A.ELVTH_ORG_CD      = #orgCd#
                    </isNotNull>
                    AND A.SVC_TASK_LTST_FLG = #svcTaskLtstFlg#
                    AND A.EZCANCELFLAG      = '0'
                ORDER BY
                     A.CRAT_DT ASC
            )
            WHERE
                ROWNUM        &lt;= #limitCnt#
    </statement>
    <resultMap id="result.getSrchDtl"       class="NSBL0380_ASMsg">
        <result property="cratDt_A"                 column="CRAT_DT"                      javaType="EZDSDateItem" />
        <result property="totInProcTaskCnt_A"       column="TOT_IN_PROC_TASK_CNT"         javaType="EZDSBigDecimalItem" />
        <result property="prtWaitTaskCnt_A"         column="PRT_WAIT_TASK_CNT"            javaType="EZDSBigDecimalItem" />
        <result property="spclWaitTaskCnt_A"        column="SPCL_WAIT_TASK_CNT"           javaType="EZDSBigDecimalItem" />
        <result property="othOpenTaskCnt_A"         column="OTH_OPEN_TASK_CNT"            javaType="EZDSBigDecimalItem" />
        <result property="custTaskCnt_A"            column="CUST_TASK_CNT"                javaType="EZDSBigDecimalItem" />
        <result property="esclTaskCnt_A"            column="ESCL_TASK_CNT"                javaType="EZDSBigDecimalItem" />
        <result property="cratTaskCnt_A"            column="CRAT_TASK_CNT"                javaType="EZDSBigDecimalItem" />
        <result property="cratTaskPerTechRate_A"    column="CRAT_TASK_PER_TECH_RATE"      javaType="EZDSBigDecimalItem" />
        <result property="aftHourTaskCnt_A"         column="AFT_HOUR_TASK_CNT"            javaType="EZDSBigDecimalItem" />
        <result property="aftHourTaskPerTechRate_A" column="AFT_HOUR_TASK_PER_TECH_RATE"  javaType="EZDSBigDecimalItem" />
        <result property="cloTaskCnt_A"             column="CLO_TASK_CNT"                 javaType="EZDSBigDecimalItem" />
        <result property="cloTaskPerTechRate_A"     column="CLO_TASK_PER_TECH_RATE"       javaType="EZDSBigDecimalItem" />
        <result property="prtFailCnt_A"             column="PRT_FAIL_CNT"                 javaType="EZDSBigDecimalItem" />
        <result property="postEntryTaskCnt_A"       column="POST_ENTRY_TASK_CNT"          javaType="EZDSBigDecimalItem" />
        <result property="avalTechCnt_A"            column="AVAL_TECH_CNT"                javaType="EZDSBigDecimalItem" />
        <result property="rspTmCustTaskRate_A"      column="RSP_TM_CUST_TASK_RATE"        javaType="EZDSBigDecimalItem" />
        <result property="rspTmAllTaskRate_A"       column="RSP_TM_ALL_TASK_RATE"         javaType="EZDSBigDecimalItem" />
        <result property="aftHourAvalTechCnt_A"     column="AFT_HOUR_AVAL_TECH_CNT"       javaType="EZDSBigDecimalItem" />
        <result property="cloCustTaskCnt_A"         column="CLO_CUST_TASK_CNT"            javaType="EZDSBigDecimalItem" />
        <result property="cloAllTaskCnt_A"          column="CLO_ALL_TASK_CNT"             javaType="EZDSBigDecimalItem" />
        <result property="orgLayerNum_A"            column="ORG_LAYER_NUM"                javaType="EZDSBigDecimalItem" />
        <result property="orgCd_A"                  column="ORG_CD"                       javaType="EZDSStringItem" />
        <result property="custTaskTotRspAot_A"      column="CUST_TASK_TOT_RSP_AOT"        javaType="EZDSBigDecimalItem" />
        <result property="allTaskTotRspAot_A"       column="ALL_TASK_TOT_RSP_AOT"         javaType="EZDSBigDecimalItem" />
    </resultMap>
</sqlMap>
