<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NMAL2510Query">

    <typeAlias alias="NMAL2510SMsg"		type="business.blap.NMAL2510.NMAL2510SMsg"/>
    <typeAlias alias="NMAL2510_ASMsg"	type="business.blap.NMAL2510.NMAL2510_ASMsg"/>
    <typeAlias alias="NMAL2510_BSMsg"	type="business.blap.NMAL2510.NMAL2510_BSMsg"/>
    <typeAlias alias="NMAL2510_CSMsg"	type="business.blap.NMAL2510.NMAL2510_CSMsg"/>
    <typeAlias alias="NMAL2510_TSMsg"   type="business.blap.NMAL2510.NMAL2510_TSMsg"/>

    <resultMap id="result.getPerson"  class="NMAL2510SMsg">
        <result property="psnNum_H1"         column="PSN_NUM"             javaType="EZDSStringItem"/>
        <result property="psnFirstNm_H1"     column="PSN_FIRST_NM"        javaType="EZDSStringItem"/>
        <result property="psnTpCd_P1"        column="PSN_TP_CD"           javaType="EZDSStringItem"/>
        <result property="psnLastNm_H1"      column="PSN_LAST_NM"         javaType="EZDSStringItem"/>
        <result property="psnCd_H1"          column="PSN_CD"              javaType="EZDSStringItem"/>
        <result property="hrPsnCmpyNm_H1"    column="HR_PSN_CMPY_NM"      javaType="EZDSStringItem"/>
        <result property="effFromDt_H1"      column="EFF_FROM_DT"         javaType="EZDCDateItem"/>
        <result property="jobTtlCd_H1"       column="JOB_TTL_CD"          javaType="EZDSStringItem"/>
        <result property="hrTtlNm_H1"        column="HR_TTL_NM"           javaType="EZDSStringItem"/>
        <result property="effThruDt_H1"      column="EFF_THRU_DT"         javaType="EZDCDateItem"/>
        <result property="hrSupvId_H1"       column="HR_SUPV_ID"          javaType="EZDSStringItem"/>
        <result property="hrSupvNm_H1"       column="HR_SUPV_NM"          javaType="EZDSStringItem"/>
        <result property="workTelNum_H1"     column="WORK_TEL_NUM"        javaType="EZDSStringItem"/>
        <result property="emlAddr_H1"        column="EML_ADDR"            javaType="EZDSStringItem"/>
        <result property="cellTelNum_H1"     column="CELL_TEL_NUM"        javaType="EZDSStringItem"/>
        <!-- QC#10364 -->
        <result property="hrPsnIntfcLocCd_H1"     column="HR_PSN_INTFC_LOC_CD"        javaType="EZDSStringItem"/>
        <result property="lineBizTpCd_P1"    column="LINE_BIZ_TP_CD"      javaType="EZDSStringItem"/>
        <result property="firstLineAddr_H1"  column="FIRST_LINE_ADDR"    javaType="EZDSStringItem"/>
        <result property="scdLineAddr_H1"    column="SCD_LINE_ADDR"      javaType="EZDSStringItem"/>
        <result property="thirdLineAddr_H1"  column="THIRD_LINE_ADDR"    javaType="EZDSStringItem"/>
        <result property="frthLineAddr_H1"   column="FRTH_LINE_ADDR"     javaType="EZDSStringItem"/>
        <result property="ctyAddr_H1"        column="CTY_ADDR"           javaType="EZDSStringItem"/>
        <result property="cntyPk_H1"         column="CNTY_PK"            javaType="EZDCBigDecimalItem"/>
        <result property="cntyNm_H1"         column="CNTY_NM"            javaType="EZDSStringItem"/>
        <result property="provNm_H1"         column="PROV_NM"            javaType="EZDSStringItem"/>
        <result property="stCd_H1"           column="ST_CD"              javaType="EZDSStringItem"/>
        <result property="postCd_H1"         column="POST_CD"            javaType="EZDSStringItem"/>
        <result property="ctryCd_H1"         column="CTRY_CD"            javaType="EZDSStringItem"/>
        <result property="xxAllLineAddr_H1"  column="XX_ALL_LINE_ADDR"    javaType="EZDSStringItem"/>
        <result property="geoCd_C1"              column="GEO_CD"                 javaType="EZDSStringItem"/>
        <result property="dsInsdCtyLimitFlg_C1"  column="DS_INSD_CTY_LIMIT_FLG"  javaType="EZDSStringItem"/>
        <result property="coaCmpyCd_H1"       column="COA_CMPY_CD"            javaType="EZDSStringItem"/>
        <result property="coaExtnCd_H1"       column="COA_EXTN_CD"            javaType="EZDSStringItem"/>
        <result property="coaBrCd_H1"         column="COA_BR_CD"              javaType="EZDSStringItem"/>
        <result property="coaCcCd_H1"         column="COA_CC_CD"              javaType="EZDSStringItem"/>
        <result property="moveOrdLimitAmt_D1"  column="MOVE_ORD_LIMIT_AMT"    javaType="EZDCBigDecimalItem"/>
        <result property="tmZoneCd_P1"         column="TM_ZONE_CD"            javaType="EZDSStringItem"/>
        <result property="costPerHourAmt_D1"   column="COST_PER_HOUR_AMT"     javaType="EZDCBigDecimalItem"/>
        <result property="ctacPsnPk_D1"        column="CTAC_PSN_PK"           javaType="EZDCBigDecimalItem"/>
        <result property="xxPsnNm_D1"          column="XX_PSN_NM"             javaType="EZDSStringItem"/>
        <result property="ezUpTime_H1"         column="EZUPTIME"              javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_H1"     column="EZUPTIMEZONE"          javaType="EZDSStringItem"/>
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    </resultMap>

    <resultMap id="result.getOrganization"  class="NMAL2510_ASMsg">
        <result property="bizAreaOrgCd_P2"      column="BIZ_AREA_ORG_CD"           javaType="EZDSStringItem"/>
        <result property="orgFuncRoleTpCd_P2"   column="ORG_FUNC_ROLE_TP_CD"       javaType="EZDSStringItem"/>
        <result property="orgCd_A2"             column="ORG_CD"                    javaType="EZDSStringItem"/>
        <result property="effFromDt_A2"         column="EFF_FROM_DT_ASG"           javaType="EZDCDateItem"/>
        <result property="effThruDt_A2"         column="EFF_THRU_DT_ASG"           javaType="EZDCDateItem"/>
        <result property="effFromDt_A3"         column="EFF_FROM_DT_ORG"           javaType="EZDCDateItem"/>
        <result property="effThruDt_A3"         column="EFF_THRU_DT_ORG"           javaType="EZDCDateItem"/>
        <result property="orgNm_A2"             column="ORG_NM"                    javaType="EZDSStringItem"/>
        <result property="orgChngRqstPk_A2"     column="ORG_CHNG_RQST_PK"          javaType="EZDCBigDecimalItem"/>
        <result property="tocCd_A2"             column="TOC_CD"                    javaType="EZDSStringItem"/>
        <result property="orgStruTpCd_A2"       column="ORG_STRU_TP_CD"            javaType="EZDSStringItem"/>
        <result property="gnrnTpCd_A2"          column="GNRN_TP_CD"                javaType="EZDSStringItem"/>
        <result property="ezUpTime_A3"          column="EZUPTIME_RELN"             javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_A3"      column="EZUPTIMEZONE_RELN"         javaType="EZDSStringItem"/>
        <result property="ezUpTime_A4"          column="EZUPTIME_RQST"             javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_A4"      column="EZUPTIMEZONE_RQST"         javaType="EZDSStringItem"/>
        <result property="ezUpTime_A5"          column="EZUPTIME_ASG"              javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_A5"      column="EZUPTIMEZONE_ASG"          javaType="EZDSStringItem"/>
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs_A1"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm_A1"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs_A1"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm_A1"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm_A1"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    </resultMap>
    
    <resultMap id="result.getOrganizationHierarchy"  class="NMAL2510_TSMsg">
        <result property="orgNm_1"              column="FIRST_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_2"              column="SCD_ORG_NM"             javaType="EZDSStringItem"/>
        <result property="orgNm_3"              column="THIRD_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_4"              column="FRTH_ORG_NM"            javaType="EZDSStringItem"/>
        <result property="orgNm_5"              column="FIFTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_6"              column="SIXTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_7"              column="SVNTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_8"              column="EIGHTH_ORG_NM"          javaType="EZDSStringItem"/>
        <result property="orgNm_9"              column="NINTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_10"             column="TENTH_ORG_NM"           javaType="EZDSStringItem"/>
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs_T"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm_T"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs_T"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm_T"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm_T"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    </resultMap>
    
    <resultMap id="result.getTerritory"  class="NMAL2510_BSMsg">
        <result property="bizAreaOrgCd_P3"         column="BIZ_AREA_ORG_CD"       javaType="EZDSStringItem"/>
        <result property="orgCd_B2"                column="ORG_CD"                javaType="EZDSStringItem"/>
        <result property="orgNm_B2"                column="ORG_NM"                javaType="EZDSStringItem"/>
        <result property="acctTeamRoleTpCd_P3"     column="ACCT_TEAM_ROLE_TP_CD"  javaType="EZDSStringItem"/>
        <result property="orgDescTxt_B2"           column="ORG_DESC_TXT"          javaType="EZDSStringItem"/>
        <result property="effFromDt_B2"            column="EFF_FROM_DT_RELN"      javaType="EZDCDateItem"/>
        <result property="effThruDt_B2"            column="EFF_THRU_DT_RELN"      javaType="EZDCDateItem"/>
        <result property="effFromDt_B3"            column="EFF_FROM_DT_TRTY"      javaType="EZDCDateItem"/>
        <result property="effThruDt_B3"            column="EFF_THRU_DT_TRTY"      javaType="EZDCDateItem"/>
        <result property="ezUpTime_B3"             column="EZUPTIME"              javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_B3"         column="EZUPTIMEZONE"          javaType="EZDSStringItem"/>
        <result property="orgStruTpCd_B2"          column="ORG_STRU_TP_CD"        javaType="EZDSStringItem"/>
        <result property="orgFuncRoleTpCd_B2"      column="ORG_FUNC_ROLE_TP_CD"   javaType="EZDSStringItem"/>
        <result property="gnrnTpCd_B2"             column="GNRN_TP_CD"            javaType="EZDSStringItem"/>
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs_B1"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm_B1"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs_B1"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm_B1"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm_B1"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    </resultMap>
    
    <resultMap id="result.getRevenue"  class="NMAL2510_CSMsg">
        <result property="revAcctTpCd_P1"       column="REV_ACCT_TP_CD"         javaType="EZDSStringItem"/>
        <result property="coaCmpyCd_C2"         column="COA_CMPY_CD"            javaType="EZDSStringItem"/>
        <result property="coaExtnCd_C2"         column="COA_EXTN_CD"            javaType="EZDSStringItem"/>
        <result property="coaBrCd_C2"           column="COA_BR_CD"              javaType="EZDSStringItem"/>
        <result property="coaCcCd_C2"           column="COA_CC_CD"              javaType="EZDSStringItem"/>
        <result property="effFromDt_C2"         column="EFF_FROM_DT"            javaType="EZDCDateItem"/>
        <result property="effThruDt_C2"         column="EFF_THRU_DT"            javaType="EZDCDateItem"/>
        <result property="xxChkBox_C3"          column="MAN_ENTRY_FLG"          javaType="EZDSStringItem"/>
        <result property="ezUpTime_C3"          column="EZUPTIME"               javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_C3"      column="EZUPTIMEZONE"           javaType="EZDSStringItem"/>
        <result property="gnrnTpCd_C2"          column="GNRN_TP_CD"             javaType="EZDSStringItem"/>
        <result property="revCoaFlg_C2"         column="REV_COA_FLG"            javaType="EZDSStringItem"/>
        <!-- START 2019/02/13 Hd.Sugawara [QC#29668,ADD] -->
        <result property="tocRgtnReqFlg_C2"     column="TOC_RGTN_REQ_FLG"       javaType="EZDSStringItem"/>
        <!-- END 2019/02/13 Hd.Sugawara [QC#29668,ADD] -->
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        <result property="xxRecHistCratTs_C1"    column="XX_REC_HIST_CRAT_TS"     javaType="EZDSStringItem" />
        <result property="xxRecHistCratByNm_C1"  column="XX_REC_HIST_CRAT_BY_NM"  javaType="EZDSStringItem" />
        <result property="xxRecHistUpdTs_C1"     column="XX_REC_HIST_UPD_TS"      javaType="EZDSStringItem" />
        <result property="xxRecHistUpdByNm_C1"   column="XX_REC_HIST_UPD_BY_NM"   javaType="EZDSStringItem" />
        <result property="xxRecHistTblNm_C1"     column="XX_REC_HIST_TBL_NM"      javaType="EZDSStringItem" />
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    </resultMap>

    <statement id="getPsnTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TP.PSN_TP_CD
              ,TP.PSN_TP_NM
          FROM
               PSN_TP TP
         WHERE
               TP.GLBL_CMPY_CD  = #globalCmpyCd#
           AND TP.EZCANCELFLAG  = '0'
         ORDER BY
               TP.PSN_TP_SORT_NUM
    </statement>
    
    <statement id="getLineBizTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TP.LINE_BIZ_TP_CD
              ,TP.LINE_BIZ_TP_NM
          FROM
               LINE_BIZ_TP TP
         WHERE
               TP.GLBL_CMPY_CD  = #globalCmpyCd#
           AND TP.EZCANCELFLAG  = '0'
         ORDER BY
               TP.LINE_BIZ_TP_SORT_NUM
    </statement>
    
    <statement id="getTrtyGrpTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TP.TRTY_GRP_TP_CD
              ,TP.TRTY_GRP_TP_NM
          FROM
               TRTY_GRP_TP TP
         WHERE
               TP.GLBL_CMPY_CD  = #globalCmpyCd#
           AND TP.EZCANCELFLAG  = '0'
         ORDER BY
               TP.TRTY_GRP_TP_SORT_NUM
    </statement>

    <statement id="getBizAreaOrgPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               ORG.BIZ_AREA_ORG_CD
              ,ORG.BIZ_AREA_ORG_NM
          FROM
               BIZ_AREA_ORG ORG
              ,ORG_STRU_TP STRU
         WHERE
               ORG.GLBL_CMPY_CD   = #globalCmpyCd#
           AND ORG.EZCANCELFLAG   = '0'
           AND STRU.GLBL_CMPY_CD  = #globalCmpyCd#
           AND STRU.EZCANCELFLAG  = '0'
           AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
           AND TRTY_STRU_FLG = #trtyStruFlg#
         ORDER BY
               ORG.BIZ_AREA_ORG_SORT_NUM
    </statement>

    <statement id="getOrgFuncRoleTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               FUNC.ORG_FUNC_ROLE_TP_CD
              ,FUNC.ORG_FUNC_ROLE_TP_NM
          FROM
               ORG_FUNC_ROLE_TP FUNC
         WHERE
               FUNC.GLBL_CMPY_CD  = #globalCmpyCd#
           AND FUNC.EZCANCELFLAG  = '0'
         ORDER BY
               FUNC.ORG_FUNC_ROLE_TP_SORT_NUM
    </statement>
    
    <statement id="getOrgFuncRoleTpWithBusinessAreaPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               FUNC.ORG_FUNC_ROLE_TP_CD
              ,FUNC.ORG_FUNC_ROLE_TP_NM
          FROM
               ORG_FUNC_ROLE_TP FUNC
              ,BIZ_AREA_ORG BIZ
         WHERE
               FUNC.GLBL_CMPY_CD  = #globalCmpyCd#
           AND FUNC.EZCANCELFLAG  = '0'
           AND BIZ.GLBL_CMPY_CD  = #globalCmpyCd#
           AND BIZ.EZCANCELFLAG  = '0'
           AND FUNC.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
           AND BIZ.BIZ_AREA_ORG_CD = #bizAreaOrgCd#
           <!-- Add Start 2017/10/06 H.Ikeda QC#21352 -->
           AND FUNC.ACTV_FLG = 'Y'
           <!-- Add End   2017/10/06 H.Ikeda QC#21352 -->
         ORDER BY
               FUNC.ORG_FUNC_ROLE_TP_SORT_NUM
    </statement>
    
    <statement id="getAcctTeamRoleTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TP.ACCT_TEAM_ROLE_TP_CD
              ,TP.ACCT_TEAM_ROLE_TP_NM
          FROM
               ACCT_TEAM_ROLE_TP TP
         WHERE
               TP.GLBL_CMPY_CD  = #globalCmpyCd#
           AND TP.EZCANCELFLAG  = '0'
         ORDER BY
               TP.ACCT_TEAM_ROLE_TP_SORT_NUM
    </statement>
    
    <statement id="getRevAcctTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TP.REV_ACCT_TP_CD
              ,TP.REV_ACCT_TP_NM
          FROM
               REV_ACCT_TP TP
         WHERE
               TP.GLBL_CMPY_CD  = #globalCmpyCd#
           AND TP.EZCANCELFLAG  = '0'
         ORDER BY
               TP.REV_ACCT_TP_SORT_NUM
    </statement>
    
    <statement id="getTmZonePulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               ZONE.TM_ZONE_CD
              ,ZONE.TM_ZONE_NM
          FROM
               TM_ZONE ZONE
         WHERE
               ZONE.GLBL_CMPY_CD  = #globalCmpyCd#
           AND ZONE.EZCANCELFLAG  = '0'
         ORDER BY
               ZONE.TM_ZONE_SORT_NUM
    </statement>
    
    <statement id="getPerson" parameterClass="Map" resultMap="result.getPerson">

    SELECT
      PSN.PSN_NUM
     ,PSN.PSN_FIRST_NM
     ,PSN.PSN_TP_CD
     ,PSN.PSN_LAST_NM
     ,PSN.PSN_CD
     ,PSN.HR_PSN_CMPY_NM
     ,PSN.EFF_FROM_DT
     ,PSN.JOB_TTL_CD
     ,PSN.HR_TTL_NM
     ,PSN.EFF_THRU_DT
     ,PSN.HR_SUPV_ID
     ,PSN.HR_SUPV_NM
     ,PSN.WORK_TEL_NUM
     ,PSN.EML_ADDR
     ,PSN.CELL_TEL_NUM
     <!-- QC#10364 -->
     ,PSN.HR_PSN_INTFC_LOC_CD
     ,PSN.LINE_BIZ_TP_CD
     ,PSN.FIRST_LINE_ADDR
     ,PSN.SCD_LINE_ADDR
     ,PSN.THIRD_LINE_ADDR
     ,PSN.FRTH_LINE_ADDR
     ,PSN.CTY_ADDR
     ,PSN.CNTY_PK
     ,CNTY.CNTY_NM
     ,PSN.PROV_NM
     ,PSN.ST_CD
     ,PSN.POST_CD
     ,PSN.CTRY_CD
     ,(
      NVL(PSN.FIRST_LINE_ADDR,'') || ' ' ||
      NVL(PSN.SCD_LINE_ADDR,'') || ' ' ||
      NVL(PSN.THIRD_LINE_ADDR,'') || ' ' ||
      NVL(PSN.FRTH_LINE_ADDR,'') || ' ' ||
      NVL(PSN.CTY_ADDR,'') || ', ' ||
      NVL(CNTY.CNTY_NM,'') || ', ' ||
      NVL(PSN.PROV_NM,'') || ', ' ||
      NVL(PSN.ST_CD,'') || ', ' ||
      NVL(PSN.POST_CD,'') || ', ' ||
      NVL(PSN.CTRY_CD,'')
     ) AS XX_ALL_LINE_ADDR
     ,PSN.GEO_CD
     ,PSN.DS_INSD_CTY_LIMIT_FLG
     ,PSN.MOVE_ORD_LIMIT_AMT
     ,PSN.TM_ZONE_CD
     ,PSN.COST_PER_HOUR_AMT
     ,CTAC.CTAC_PSN_PK
     <!-- QC#14596
     ,NVL(CTAC.CTAC_PSN_FIRST_NM,' ') || ' ' || NVL(CTAC.CTAC_PSN_FIRST_NM,' ') AS XX_PSN_NM
      -->
     ,NVL(CTAC.CTAC_PSN_FIRST_NM,' ') || ' ' || NVL(CTAC.CTAC_PSN_LAST_NM,' ') AS XX_PSN_NM
     ,PSN.EZUPTIME
     ,PSN.EZUPTIMEZONE
     <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
     , PSN.EZINTIME             AS XX_REC_HIST_CRAT_TS
     , PSN.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
     , PSN.EZUPTIME             AS XX_REC_HIST_UPD_TS
     , PSN.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
     , 'S21_PSN'                AS XX_REC_HIST_TBL_NM
     <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    FROM
      S21_PSN PSN
     ,CNTY CNTY
     ,CTAC_PSN CTAC
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND PSN.GLBL_CMPY_CD = CNTY.GLBL_CMPY_CD(+)
    AND PSN.CNTY_PK = CNTY.CNTY_PK(+)
    AND PSN.GLBL_CMPY_CD = CTAC.GLBL_CMPY_CD(+)
    AND PSN.CTAC_PSN_PK = CTAC.CTAC_PSN_PK(+)
    <isNotNull property="cMsg.psnNum_H1">
    AND PSN.PSN_NUM = #cMsg.psnNum_H1#
    </isNotNull>
<!-- QC#2423 2016/01/16 Del Start -->
<!--
    <isNotNull property="cMsg.psnFirstNm_H1">
    AND PSN.PSN_FIRST_NM LIKE #cMsg.psnFirstNm_H1#
    </isNotNull>
    <isNotNull property="cMsg.psnTpCd_P1">
    AND PSN.PSN_TP_CD = #cMsg.psnTpCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.psnLastNm_H1">
    AND PSN.PSN_LAST_NM LIKE #cMsg.psnLastNm_H1#
    </isNotNull>
    <isNotNull property="cMsg.psnCd_H1">
    AND PSN.PSN_CD = #cMsg.psnCd_H1#
    </isNotNull>
    <isNotNull property="cMsg.hrPsnCmpyNm_H1">
    <isNotEqual property="cMsg.hrPsnCmpyNm_H1" compareValue="Canon Solutions America, Inc.">
    AND PSN.HR_PSN_CMPY_NM = #cMsg.hrPsnCmpyNm_H1#
    </isNotEqual>
    </isNotNull>
    <isNotNull property="cMsg.effFromDt_H1">
    AND PSN.EFF_FROM_DT &lt;= #cMsg.effFromDt_H1#
    </isNotNull>
    <isNotNull property="cMsg.jobTtlCd_H1">
    AND PSN.JOB_TTL_CD = #cMsg.jobTtlCd_H1#
    </isNotNull>
    <isNotNull property="cMsg.hrTtlNm_H1">
    AND PSN.HR_TTL_NM = #cMsg.hrTtlNm_H1#
    </isNotNull>
    <isNotNull property="cMsg.effThruDt_H1">
    AND PSN.EFF_THRU_DT = #cMsg.effThruDt_H1#
    </isNotNull>
    <isNotNull property="cMsg.hrSupvId_H1">
    AND PSN.HR_SUPV_ID = #cMsg.hrSupvId_H1#
    </isNotNull>
    <isNotNull property="cMsg.hrSupvNm_H1">
    AND PSN.HR_SUPV_NM = #cMsg.hrSupvNm_H1#
    </isNotNull>
    <isNotNull property="cMsg.workTelNum_H1">
    AND PSN.WORK_TEL_NUM = #cMsg.workTelNum_H1#
    </isNotNull>
    <isNotNull property="cMsg.emlAddr_H1">
    AND PSN.EML_ADDR = #cMsg.emlAddr_H1#
    </isNotNull>
    <isNotNull property="cMsg.cellTelNum_H1">
    AND PSN.CELL_TEL_NUM = #cMsg.cellTelNum_H1#
    </isNotNull>
    <isNotNull property="cMsg.lineBizTpCd_P1">
    AND PSN.LINE_BIZ_TP_CD = #cMsg.lineBizTpCd_P1#
    </isNotNull>
-->
<!-- QC#2423 2016/01/16 Del End -->
    </statement>

    <statement id="getOrganization" parameterClass="Map" resultMap="result.getOrganization">
    SELECT
        BIZ.BIZ_AREA_ORG_CD
       ,RQST.ORG_FUNC_ROLE_TP_CD
       ,RELN.ORG_CD
       ,ASG.EFF_FROM_DT AS EFF_FROM_DT_ASG
       ,ASG.EFF_THRU_DT AS EFF_THRU_DT_ASG
       ,ORG.EFF_FROM_DT AS EFF_FROM_DT_ORG
       ,ORG.EFF_THRU_DT AS EFF_THRU_DT_ORG
       ,ORG.ORG_NM
       ,ORG.ORG_STRU_TP_CD
       ,RQST.ORG_CHNG_RQST_PK
       ,ASG.TOC_CD
       ,RELN.EZUPTIME AS EZUPTIME_RELN
       ,RELN.EZUPTIMEZONE AS EZUPTIMEZONE_RELN
       ,RQST.EZUPTIME AS EZUPTIME_RQST
       ,RQST.EZUPTIMEZONE AS EZUPTIMEZONE_RQST
       ,ASG.EZUPTIME AS EZUPTIME_ASG
       ,ASG.EZUPTIMEZONE AS EZUPTIMEZONE_ASG
       ,ASG.GNRN_TP_CD AS GNRN_TP_CD
       <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
       , ASG.EZINTIME             AS XX_REC_HIST_CRAT_TS
       , ASG.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
       , ASG.EZUPTIME             AS XX_REC_HIST_UPD_TS
       , ASG.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
       , 'ORG_FUNC_ASG'           AS XX_REC_HIST_TBL_NM
       <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    FROM
        S21_PSN PSN
       ,ORG_FUNC_ASG ASG
       ,ORG_TOC_CHNG_RQST RQST
       ,TOC_ORG_STRU_RELN RELN
       ,DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
       ,BIZ_AREA_ORG BIZ
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND ASG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ASG.EZCANCELFLAG = '0'
    AND RQST.GLBL_CMPY_CD = #glblCmpyCd#
    AND RQST.EZCANCELFLAG = '0'
    AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
    AND RELN.EZCANCELFLAG = '0'
    AND ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND BIZ.GLBL_CMPY_CD = #glblCmpyCd#
    AND BIZ.EZCANCELFLAG = '0'
    AND PSN.PSN_CD = #cMsg.psnCd_H1#
    AND PSN.PSN_CD = ASG.PSN_CD
    AND ASG.TOC_CD = RQST.TOC_CD
    AND RQST.TOC_CD = RELN.TOC_CD
    AND RQST.ORG_CD = RELN.ORG_CD
    AND ORG.ORG_CD = RELN.ORG_CD
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'N'
    AND ORG.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
    AND ORG.ORG_STRU_TP_CD = BIZ.ORG_STRU_TP_CD
<!--
    AND ASG.GNRN_TP_CD != #gnrnTpDelete#
    AND ASG.GNRN_TP_CD != #gnrnTpTerminated#
 -->
    <!-- 2018/03/28 QC#21410 add start -->
    AND ASG.GNRN_TP_CD != #gnrnTpDelete#
    AND ASG.GNRN_TP_CD != #gnrnTpTerminated#
    <!-- 2018/03/28 QC#21410 add end -->
    <!-- 2018/03/28 QC#21410 mod start -->
    <isNotEqual property="showAllAssignments" compareValue='Y'>
    <!-- 2018/03/28 QC#21410 mod start -->
    <!-- AND (RELN.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL) -->
    AND ASG.GNRN_TP_CD != #gnrnTpPast#
    </isNotEqual>
    <!-- 2018/03/28 QC#21410 mod end -->
    AND ROWNUM &lt;= #rowNum#
    ORDER BY
        RELN.ORG_CD
       ,RELN.EFF_FROM_DT
    </statement>

    <statement id="getOrganizationHierarchy" parameterClass="Map" resultMap="result.getOrganizationHierarchy">
    WITH WRK AS(
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,RELN.PRNT_ORG_CD
            <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
	        , RELN.EZINTIME             AS XX_REC_HIST_CRAT_TS
	        , RELN.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
	        , RELN.EZUPTIME             AS XX_REC_HIST_UPD_TS
	        , RELN.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
	        , 'DS_ORG_RELN'             AS XX_REC_HIST_TBL_NM
	        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
        FROM
            DS_ORG_UNIT ORG
            ,DS_ORG_RELN RELN
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        AND RELN.GNRN_TP_CD IN (#gnrnTpCd_Current#, #gnrnTpCd_Future#)
        AND ORG.GNRN_TP_CD  IN (#gnrnTpCd_Current#, #gnrnTpCd_Future#)
        UNION ALL
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.ORG_CD AS PRNT_ORG_CD
            <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
	        , ORG.EZINTIME             AS XX_REC_HIST_CRAT_TS
	        , ORG.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
	        , ORG.EZUPTIME             AS XX_REC_HIST_UPD_TS
	        , ORG.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
	        , 'ORG_STRU_TP'            AS XX_REC_HIST_TBL_NM
	        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
        FROM
            DS_ORG_UNIT ORG
           ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG ='N'
        AND ORG.ORG_TIER_CD = '0'
        <isNotNull property="bizAreaOrgCd">
        AND ORG.FIRST_ORG_CD = #bizAreaOrgCd#
        </isNotNull>
    )

    ,ORG1 AS(SELECT * FROM WRK)
    ,ORG2 AS(SELECT * FROM WRK)
    ,ORG3 AS(SELECT * FROM WRK)
    ,ORG4 AS(SELECT * FROM WRK)
    ,ORG5 AS(SELECT * FROM WRK)
    ,ORG6 AS(SELECT * FROM WRK)
    ,ORG7 AS(SELECT * FROM WRK)
    ,ORG8 AS(SELECT * FROM WRK)
    ,ORG9 AS(SELECT * FROM WRK)
    ,ORG10 AS(SELECT * FROM WRK)

    ,HIERARCHY AS(
    SELECT
         ORG1.ORG_CD
        ,ORG1.ORG_NM
        ,ORG1.ORG_TIER_CD
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        , ORG1.XX_REC_HIST_CRAT_TS            AS XX_REC_HIST_CRAT_TS
        , ORG1.XX_REC_HIST_CRAT_BY_NM         AS XX_REC_HIST_CRAT_BY_NM
        , ORG1.XX_REC_HIST_UPD_TS             AS XX_REC_HIST_UPD_TS
        , ORG1.XX_REC_HIST_UPD_BY_NM          AS XX_REC_HIST_UPD_BY_NM
        , ORG1.XX_REC_HIST_TBL_NM             AS XX_REC_HIST_TBL_NM
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
        --FIRST
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier1# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier1# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier1# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier1# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier1# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier1# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier1# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier1# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier1# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier1# THEN ORG10.ORG_NM
        END AS FIRST_ORG_NM
        --SCD
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier2# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier2# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier2# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier2# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier2# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier2# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier2# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier2# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier2# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier2# THEN ORG10.ORG_NM
        END AS SCD_ORG_NM
        --THIRD          
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier3# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier3# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier3# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier3# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier3# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier3# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier3# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier3# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier3# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier3# THEN ORG10.ORG_NM
        END AS THIRD_ORG_NM
        --FRTH         
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier4# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier4# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier4# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier4# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier4# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier4# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier4# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier4# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier4# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier4# THEN ORG10.ORG_NM
        END AS FRTH_ORG_NM
        --FIFTH        
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier5# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier5# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier5# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier5# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier5# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier5# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier5# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier5# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier5# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier5# THEN ORG10.ORG_NM
        END AS FIFTH_ORG_NM
        --SIXTH        
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier6# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier6# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier6# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier6# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier6# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier6# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier6# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier6# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier6# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier6# THEN ORG10.ORG_NM
        END AS SIXTH_ORG_NM
        --SVNTH        
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier7# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier7# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier7# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier7# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier7# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier7# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier7# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier7# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier7# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier7# THEN ORG10.ORG_NM
        END AS SVNTH_ORG_NM
        --EIGHTH        
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier8# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier8# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier8# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier8# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier8# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier8# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier8# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier8# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier8# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier8# THEN ORG10.ORG_NM
        END AS EIGHTH_ORG_NM
        --NINTH        
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier9# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier9# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier9# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier9# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier9# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier9# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier9# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier9# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier9# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier9# THEN ORG10.ORG_NM
        END AS NINTH_ORG_NM
        --TENTH
        ,CASE
            WHEN ORG1.ORG_TIER_CD = #ortTier10# THEN ORG1.ORG_NM
            WHEN ORG2.ORG_TIER_CD = #ortTier10# THEN ORG2.ORG_NM
            WHEN ORG3.ORG_TIER_CD = #ortTier10# THEN ORG3.ORG_NM
            WHEN ORG4.ORG_TIER_CD = #ortTier10# THEN ORG4.ORG_NM
            WHEN ORG5.ORG_TIER_CD = #ortTier10# THEN ORG5.ORG_NM
            WHEN ORG6.ORG_TIER_CD = #ortTier10# THEN ORG6.ORG_NM
            WHEN ORG7.ORG_TIER_CD = #ortTier10# THEN ORG7.ORG_NM
            WHEN ORG8.ORG_TIER_CD = #ortTier10# THEN ORG8.ORG_NM
            WHEN ORG9.ORG_TIER_CD = #ortTier10# THEN ORG9.ORG_NM
            WHEN ORG10.ORG_TIER_CD = #ortTier10# THEN ORG10.ORG_NM
        END AS TENTH_ORG_NM
    FROM
         ORG1
        ,ORG2
        ,ORG3
        ,ORG4
        ,ORG5
        ,ORG6
        ,ORG7
        ,ORG8
        ,ORG9
        ,ORG10
    WHERE
        ORG1.PRNT_ORG_CD = ORG2.ORG_CD
    AND ORG2.PRNT_ORG_CD = ORG3.ORG_CD
    AND ORG3.PRNT_ORG_CD = ORG4.ORG_CD
    AND ORG4.PRNT_ORG_CD = ORG5.ORG_CD
    AND ORG5.PRNT_ORG_CD = ORG6.ORG_CD
    AND ORG6.PRNT_ORG_CD = ORG7.ORG_CD
    AND ORG7.PRNT_ORG_CD = ORG8.ORG_CD
    AND ORG8.PRNT_ORG_CD = ORG9.ORG_CD
    AND ORG9.PRNT_ORG_CD = ORG10.ORG_CD
)

    SELECT 
         FIRST_ORG_NM
        ,SCD_ORG_NM
        ,THIRD_ORG_NM
        ,FRTH_ORG_NM
        ,FIFTH_ORG_NM
        ,SIXTH_ORG_NM
        ,SVNTH_ORG_NM
        ,EIGHTH_ORG_NM
        ,NINTH_ORG_NM
        ,TENTH_ORG_NM
        <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        , XX_REC_HIST_CRAT_TS            AS XX_REC_HIST_CRAT_TS
        , XX_REC_HIST_CRAT_BY_NM         AS XX_REC_HIST_CRAT_BY_NM
        , XX_REC_HIST_UPD_TS             AS XX_REC_HIST_UPD_TS
        , XX_REC_HIST_UPD_BY_NM          AS XX_REC_HIST_UPD_BY_NM
        , XX_REC_HIST_TBL_NM             AS XX_REC_HIST_TBL_NM
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    FROM 
        HIERARCHY  H
    WHERE
        H.ORG_TIER_CD > 0
    <isNotNull property="orgCd">
    AND H.ORG_CD = #orgCd#
    </isNotNull>
    <isNotNull property="orgNm">
    AND H.ORG_NM = #orgNm#
    </isNotNull>
    AND ROWNUM = 1
    </statement>
    
    <statement id="getTerritory" parameterClass="Map" resultMap="result.getTerritory">
    SELECT
        BIZ.BIZ_AREA_ORG_CD
       ,RELN.ORG_CD
       ,ORG.ORG_NM
       ,RELN.ACCT_TEAM_ROLE_TP_CD
       ,ORG.ORG_DESC_TXT
       ,RELN.EFF_FROM_DT AS EFF_FROM_DT_RELN
       ,RELN.EFF_THRU_DT AS EFF_THRU_DT_RELN
       ,ORG.EFF_FROM_DT AS EFF_FROM_DT_TRTY
       ,ORG.EFF_THRU_DT AS EFF_THRU_DT_TRTY
       ,RELN.EZUPTIME
       ,RELN.EZUPTIMEZONE
       ,ORG.ORG_STRU_TP_CD
       ,RELN.ORG_FUNC_ROLE_TP_CD
       ,RELN.GNRN_TP_CD AS GNRN_TP_CD
       <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        , RELN.EZINTIME             AS XX_REC_HIST_CRAT_TS
        , RELN.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
        , RELN.EZUPTIME             AS XX_REC_HIST_UPD_TS
        , RELN.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
        , 'DS_ORG_RESRC_RELN'       AS XX_REC_HIST_TBL_NM
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    FROM
        S21_PSN PSN
       ,DS_ORG_RESRC_RELN RELN
       ,DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
       ,BIZ_AREA_ORG BIZ
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
    AND RELN.EZCANCELFLAG = '0'
    AND ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND BIZ.GLBL_CMPY_CD = #glblCmpyCd#
    AND BIZ.EZCANCELFLAG = '0'
    AND PSN.PSN_CD = #cMsg.psnCd_H1#
    AND PSN.PSN_CD = RELN.PSN_CD
    AND RELN.ORG_CD = ORG.ORG_CD
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'Y'
    AND BIZ.BIZ_AREA_ORG_CD = ORG.FIRST_ORG_CD
    AND BIZ.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
<!--
    AND RELN.GNRN_TP_CD != #gnrnTpDelete#
    AND RELN.GNRN_TP_CD != #gnrnTpTerminated#
  -->
    <!-- 2018/03/28 QC#21410 add start -->
    AND RELN.GNRN_TP_CD != #gnrnTpDelete#
    AND RELN.GNRN_TP_CD != #gnrnTpTerminated#
    <!-- 2018/03/28 QC#21410 add end -->
    <!-- 2018/03/28 QC#21410 mod start -->
    <isNotEqual property="showAllAssignments" compareValue='Y'>
    <!-- AND RELN.EFF_FROM_DT &lt;= #slsDt#
    AND (RELN.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL) -->
    AND RELN.GNRN_TP_CD != #gnrnTpPast#
    </isNotEqual>
    <!-- 2018/03/28 QC#21410 mod end -->
    AND ROWNUM &lt;= #rowNum#
    ORDER BY
        RELN.ORG_CD
       ,RELN.EFF_FROM_DT
    </statement>
    
    <statement id="getRevenue" parameterClass="Map" resultMap="result.getRevenue">
    SELECT
        REV.REV_ACCT_TP_CD
       ,REV.COA_CMPY_CD
       ,REV.COA_EXTN_CD
       ,REV.COA_BR_CD
       ,REV.COA_CC_CD
       ,REV.EFF_FROM_DT
       ,REV.EFF_THRU_DT
       ,REV.MAN_ENTRY_FLG
       ,REV.EZUPTIME
       ,REV.EZUPTIMEZONE
       ,TP.REV_COA_FLG
       <!-- START 2019/02/13 Hd.Sugawara [QC#29668,ADD] -->
       ,REV.TOC_RGTN_REQ_FLG
       <!-- END 2019/02/13 Hd.Sugawara [QC#29668,ADD] -->
       <!-- Add Start 2016/11/08 M.Ohno S21_NA#2680 -->
        , REV.EZINTIME             AS XX_REC_HIST_CRAT_TS
        , REV.EZINUSERID           AS XX_REC_HIST_CRAT_BY_NM
        , REV.EZUPTIME             AS XX_REC_HIST_UPD_TS
        , REV.EZUPUSERID           AS XX_REC_HIST_UPD_BY_NM
        , 'DS_ORG_RESRC_REV'       AS XX_REC_HIST_TBL_NM
        <!-- Add End   2016/11/08 M.Ohno S21_NA#2680 -->
    FROM
        DS_ORG_RESRC_REV REV
       ,REV_ACCT_TP TP
    WHERE
        REV.GLBL_CMPY_CD = #glblCmpyCd#
    AND REV.EZCANCELFLAG = '0'
    AND TP.GLBL_CMPY_CD = #glblCmpyCd#
    AND TP.EZCANCELFLAG = '0'
    AND REV.REV_ACCT_TP_CD = TP.REV_ACCT_TP_CD
    AND REV.PSN_CD = #cMsg.psnCd_H1#
    AND ROWNUM &lt;= #rowNum#
    ORDER BY
        TP.REV_ACCT_TP_SORT_NUM
       ,REV.EFF_FROM_DT DESC
       ,REV.EFF_THRU_DT DESC
    </statement>
    
    <statement id="checkSalesRoll" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*) CNT
    FROM
        ORG_FUNC_ROLE_TP ROLE
       ,BIZ_AREA_ORG AREA
       ,ORG_STRU_TP STRU
    WHERE
        ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.EZCANCELFLAG = '0'
    AND AREA.GLBL_CMPY_CD = #glblCmpyCd#
    AND AREA.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    
    AND ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
    
    AND AREA.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND AREA.SLS_FLG = 'Y'
    AND AREA.BIZ_AREA_ORG_CD = ROLE.FIRST_ORG_CD
    </statement>
    
     <statement id="checkActiveSalesRepRoll" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*) CNT
    FROM
        ORG_FUNC_ROLE_TP ROLE
       ,BIZ_AREA_ORG AREA
       ,ORG_STRU_TP STRU
    WHERE
        ROLE.GLBL_CMPY_CD        = #glblCmpyCd#
    AND ROLE.EZCANCELFLAG        = '0'
    AND AREA.GLBL_CMPY_CD        = #glblCmpyCd#
    AND AREA.EZCANCELFLAG        = '0'
    AND STRU.GLBL_CMPY_CD        = #glblCmpyCd#
    AND STRU.EZCANCELFLAG        = '0'
    AND ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
    AND AREA.ORG_STRU_TP_CD      = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG       = #flgOffN#
    AND AREA.SLS_FLG             = #flgOnY#
    AND AREA.BIZ_AREA_ORG_CD     = ROLE.FIRST_ORG_CD
    <!-- QC#3509
    AND ROLE.SLS_REP_FLG         = #flgOnY#
    AND ROLE.MGR_FLG             = #flgOffN#
    AND ROLE.ADMIN_FLG           = #flgOffN#
     -->
     AND ROLE.ACTV_FLG           = #flgOnY#
     AND ROLE.SLS_REP_FLG        = #flgOnY# <!-- QC#15140-3 MOD-->
    </statement>
    
    <statement id="checkBusinessAreaSales" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*) CNT
    FROM
        BIZ_AREA_ORG BIZ
       ,ORG_STRU_TP STRU
    WHERE
        BIZ.GLBL_CMPY_CD = #glblCmpyCd#
    AND BIZ.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND BIZ.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND BIZ.SLS_FLG = 'Y'
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND BIZ.BIZ_AREA_ORG_CD = #bizAreaOrgCd#
    </statement>

    <statement id="getHierachyDataforManualInput" parameterClass="Map" resultClass="Map">
    SELECT
        ORG.ORG_CD AS ORG_CD
       ,ORG.ORG_STRU_TP_CD AS ORG_STRU_TP_CD
       ,ORG.FIRST_ORG_CD AS FIRST_ORG_CD
    FROM
        DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD    = #glblCmpyCd#
    AND ORG.EZCANCELFLAG    = '0'
    AND ORG.GLBL_CMPY_CD    = STRU.GLBL_CMPY_CD
    AND STRU.EZCANCELFLAG   = '0'
    AND ORG.ORG_NM          = #orgNm#
    AND ORG.ORG_TIER_CD     &lt;&gt;ã€€#tierCd0#
    AND ORG.ORG_STRU_TP_CD  = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG  = #trtyStruFlg#
    AND ROWNUM = 1
    </statement>
    
    <statement id="getTerritoryDataforManualInput" parameterClass="Map" resultClass="Map">
    SELECT
        ORG.ORG_CD AS ORG_CD
       ,ORG.ORG_STRU_TP_CD AS ORG_STRU_TP_CD
       ,ORG.EFF_FROM_DT  <!-- 2018/03/29 S21_NA#23171 Add -->
       ,ORG.EFF_THRU_DT  <!-- 2018/03/29 S21_NA#23171 Add -->
    FROM
        DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.FIRST_ORG_CD = #bizAreaOrgCd#
    AND ORG.ORG_NM = #orgNm#
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND ROWNUM = 1
    </statement>
    
    <statement id="getOrganizationFunctionRoleTypeDataforManualInput" parameterClass="Map" resultClass="Map">
    SELECT
        RQST.ORG_FUNC_ROLE_TP_CD AS ORG_FUNC_ROLE_TP_CD
    FROM
        S21_PSN PSN
        ,ORG_FUNC_ASG ASG
        ,ORG_TOC_CHNG_RQST RQST
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND ASG.GLBL_CMPY_CD = #glblCmpyCd#
    AND RQST.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND ASG.EZCANCELFLAG = '0'
    AND RQST.EZCANCELFLAG = '0'
    AND PSN.PSN_CD = ASG.PSN_CD
    AND ASG.TOC_CD = RQST.TOC_CD
    AND ASG.GNRN_TP_CD IN (#gnrnTpCd_Current#, #gnrnTpCd_Future#)
    AND RQST.RGTN_STS_CD IN (#rgtnStsCd_ReadyForOrder#, #rgtnStsCd_Pending#)
    AND PSN.PSN_CD = #psnCd#
    AND ROWNUM = 1
    </statement>
    
    <statement id="checkActiveResourceRevenue" parameterClass="Map" resultClass="Map">
    SELECT
        REV.REV_ACCT_TP_CD AS REV_ACCT_TP_CD
    FROM
        DS_ORG_RESRC_REV REV
    WHERE
        REV.GLBL_CMPY_CD = #glblCmpyCd#
    AND REV.EZCANCELFLAG = '0'
    AND REV.PSN_CD = #psnCd#
    AND REV.EFF_FROM_DT &lt;= #slsDt#
    AND (REV.EFF_THRU_DT &gt;= #slsDt# OR REV.EFF_THRU_DT IS NULL)
    </statement>
    
    <statement id="getContractTypeCd" parameterClass="Map" resultClass="Map">
    SELECT
        CTAC.CTAC_TP_CD
    FROM
        CTAC_TP CTAC
    WHERE
        CTAC.GLBL_CMPY_CD = #glblCmpyCd#
    AND CTAC.EZCANCELFLAG = '0'
    AND CTAC.SPLY_IND_FLG = #splyIndFlg#
    ORDER BY
        CTAC.CTAC_TP_SORT_NUM
    </statement>
    
    <statement id="getThirdPtyTechFlg" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*)
    FROM
        ORG_FUNC_ROLE_TP ROLE
    WHERE
        ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
    AND ROLE.GLBL_CMPY_CD        = #glblCmpyCd#
    AND ROLE.THIRD_PTY_TECH_FLG  = #thirdPtyTechFlg#
    AND ROLE.EZCANCELFLAG        = '0'
    </statement>
    
    <statement id="getSplyIndFlg" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*)
    FROM
        CTAC_TP CTAC
    WHERE
        CTAC.GLBL_CMPY_CD = #glblCmpyCd#
    AND CTAC.EZCANCELFLAG = '0'
    AND CTAC.CTAC_TP_CD   = #ctacTpCd#
    AND CTAC.SPLY_IND_FLG = #splyIndFlg#
    </statement>
    
    <statement id="checkBusinessAreaRoll" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*)
    FROM
        BIZ_AREA_ORG BIZ
       ,ORG_FUNC_ROLE_TP ROLE
       ,ORG_STRU_TP STRU
    WHERE
        BIZ.GLBL_CMPY_CD = #glblCmpyCd#
    AND BIZ.EZCANCELFLAG = '0'
    AND ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND BIZ.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND BIZ.BIZ_AREA_ORG_CD = ROLE.FIRST_ORG_CD
    AND BIZ.BIZ_AREA_ORG_CD = #bizAreaOrgCd#
    AND ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
    </statement>

    <statement id="checkBusinessAreaOrg" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*)
    FROM
        BIZ_AREA_ORG BIZ
       ,DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
    WHERE
        BIZ.GLBL_CMPY_CD = #glblCmpyCd#
    AND BIZ.EZCANCELFLAG = '0'
    AND ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND BIZ.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND BIZ.BIZ_AREA_ORG_CD = ORG.FIRST_ORG_CD
    AND BIZ.BIZ_AREA_ORG_CD = #bizAreaOrgCd#
    AND ORG.ORG_CD = #orgCd#
    </statement>
    
    <statement id="getDefaultRevenue" parameterClass="Map" resultClass="Map">
    SELECT
        REV.COA_CMPY_CD
       ,REV.COA_EXTN_CD
       ,REV.COA_BR_CD
       ,REV.COA_CC_CD
    FROM
        DS_ORG_RESRC_REV REV
       ,REV_ACCT_TP TP
    WHERE
        REV.GLBL_CMPY_CD = #glblCmpyCd#
    AND REV.EZCANCELFLAG = '0'
    AND TP.GLBL_CMPY_CD = #glblCmpyCd#
    AND TP.EZCANCELFLAG = '0'
    AND REV.PSN_CD = #psnCd#
    AND REV.REV_ACCT_TP_CD = TP.REV_ACCT_TP_CD
    AND TP.REV_COA_FLG = #revCoaFlg#
    AND REV.EFF_FROM_DT &lt;= #slsDt#
    AND (REV.EFF_THRU_DT &gt;= #slsDt# OR REV.EFF_THRU_DT IS NULL)
    AND ROWNUM = 1
    </statement>

    <statement id="getDuplicatePsnNum" parameterClass="Map" resultClass="Integer">
    SELECT
        COUNT(*) CNT
    FROM
        S21_PSN PSN
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND PSN.PSN_NUM = #psnNum#
    </statement>

    <statement id="isManagerRole" parameterClass="Map" resultClass="Integer">
    SELECT
       COUNT(ROLE.ORG_FUNC_ROLE_TP_CD)
    FROM 
       ORG_FUNC_ROLE_TP ROLE
    WHERE
        ROLE.GLBL_CMPY_CD        =  #glblCmpyCd#
    AND ROLE.ORG_FUNC_ROLE_TP_CD =  #orgFuncRoleTpCd#
    AND ROLE.EZCANCELFLAG        =  0
    <!-- QC#15140-3 ADD START-->
    <isEqual property="condFlg" compareValue="Y">
        AND ROLE.MGR_FLG             =  #flgOnY#
    </isEqual>
    <isEqual property="condFlg" compareValue="N">
        AND ROLE.SLS_REP_FLG         =  #flgOnY#
    </isEqual>
    <!-- QC#15140-3 ADD END-->
    </statement>

<!-- QC#3859
    <statement id="countManagerInSameOrg" parameterClass="Map" resultClass="Integer">
    SELECT 
        COUNT(ROLE.ORG_FUNC_ROLE_TP_CD)
 -->
 	<statement id="getMgrCntByOrg" parameterClass="Map" resultClass="Map">
    SELECT DISTINCT 
        RELN.TOC_CD
      , RELN.EFF_FROM_DT
      , RELN.EFF_THRU_DT
    FROM
        TOC_ORG_STRU_RELN RELN
     ,  ORG_TOC_CHNG_RQST RQST
     ,  ORG_FUNC_ROLE_TP  ROLE
    WHERE
        RELN.ORG_CD              =  #orgCd#
    AND RELN.GLBL_CMPY_CD        =  #glblCmpyCd#
    <!-- QC#3859 -->
    AND (
        (RELN.EFF_FROM_DT &lt;=  #slsDt# AND NVL(RELN.EFF_THRU_DT, #maxEffThruDate#) &gt;= #slsDt#)
        OR
        RELN.EFF_FROM_DT &gt; #slsDt#
    )
    AND RELN.EZCANCELFLAG        =  0

    AND RELN.TOC_CD              =  RQST.TOC_CD
    AND RELN.ORG_CD              =  RQST.ORG_CD
    AND RELN.GLBL_CMPY_CD        =  RQST.GLBL_CMPY_CD
    AND RQST.RGTN_STS_CD         != #rgtnSts_Terminated#
    AND RQST.EZCANCELFLAG        =  0

    AND RQST.ORG_FUNC_ROLE_TP_CD =  ROLE.ORG_FUNC_ROLE_TP_CD
    AND RQST.GLBL_CMPY_CD        =  ROLE.GLBL_CMPY_CD
    AND ROLE.EZCANCELFLAG        =  0
    <!-- QC#15140-3 ADD START-->
    <isEqual property="condFlg" compareValue="Y">
        AND ROLE.MGR_FLG             =  #flgOnY#
    </isEqual>
    <isEqual property="condFlg" compareValue="N">
        AND ROLE.SLS_REP_FLG         =  #flgOnY#
    </isEqual>
    <!-- QC#15140-3 ADD END-->
    </statement>

    <statement id="isOrgCurrentOrFuture" parameterClass="Map" resultClass="Integer">
    SELECT 
        COUNT(D.ORG_CD)
    FROM
        DS_ORG_UNIT D
    WHERE
        D.ORG_CD                             = #orgCd#
    AND D.GLBL_CMPY_CD                       = #glblCmpyCd#
    AND D.GNRN_TP_CD                        IN (#gnrnTp_Future#, #gnrnTp_Current#)
    AND D.EZCANCELFLAG                       = 0
    </statement>

    <statement id="isTerritorySales" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*)
        FROM
            BIZ_AREA_ORG BAO
         ,  DS_ORG_UNIT  ORG
        WHERE
            ORG.ORG_CD          = #territoryId#
        AND ORG.GLBL_CMPY_CD    = #glblCmpyCd#
        AND ORG.EZCANCELFLAG    =  0

        AND ORG.FIRST_ORG_CD    = BAO.BIZ_AREA_ORG_CD
        AND ORG.GLBL_CMPY_CD    = BAO.GLBL_CMPY_CD
        AND BAO.SLS_FLG         = #slsFlg#
        AND BAO.ORG_STRU_TP_CD  = #orgStruTp_Territory#
        AND BAO.EZCANCELFLAG    =  0
    </statement>

    <statement id="isOrgFuncRoleSales" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(ROLE.ORG_FUNC_ROLE_TP_CD)
        FROM 
            ORG_FUNC_ROLE_TP  ROLE
        WHERE
            ROLE.ORG_FUNC_ROLE_TP_CD =  #roleTp#
        AND ROLE.GLBL_CMPY_CD        =  #glblCmpyCd#
        AND ROLE.ORG_STRU_TP_CD      =  #orgStruTp_BOS#
        AND ROLE.SLS_REP_FLG         =  #flgOnY#
        AND ROLE.EZCANCELFLAG        =  0
    </statement>

    <statement id="countSalesRepInTerritory" parameterClass="Map" resultClass="Integer">
        SELECT 
            COUNT(RESRC.PSN_CD)
        FROM
            DS_ORG_UNIT       UNIT
          , DS_ORG_RESRC_RELN RESRC
          , TRTY_GRP_TP       GRP
        WHERE
            UNIT.ORG_CD                          =  #territoryId#
        AND UNIT.GLBL_CMPY_CD                    =  #glblCmpyCd#
        AND UNIT.ORG_STRU_TP_CD                  =  #orgStruTp_Territory#
        AND (UNIT.GNRN_TP_CD = #gnrnTp_Current# OR UNIT.GNRN_TP_CD = #gnrnTp_Future#)
        AND UNIT.EZCANCELFLAG                    =  0

        AND UNIT.ORG_CD                          =  RESRC.ORG_CD
        AND UNIT.GLBL_CMPY_CD                    =  RESRC.GLBL_CMPY_CD
        AND (RESRC.GNRN_TP_CD = #gnrnTp_Current# OR RESRC.GNRN_TP_CD = #gnrnTp_Future#)
        <!-- 2018/03/29 S21_NA#23171 Del Start -->
        <!-- AND RESRC.EFF_FROM_DT                   &lt;=  #resrcAssignStartDt#
    <isNotNull property="resrcAssignEndDt">
        AND NVL(RESRC.EFF_THRU_DT, #maxEffDt#)  &gt;=  #resrcAssignEndDt#
    </isNotNull>  -->
        <!-- 2018/03/29 S21_NA#23171 Del End -->
        <!-- 2018/03/29 S21_NA#23171 Add Start -->
        AND (   (    ã€€(RESRC.EFF_FROM_DT              &lt;   #resrcAssignStartDt# 
                AND NVL(RESRC.EFF_THRU_DT, #maxEffDt#) &gt;   #resrcAssignStartDt#)
                OR   
                    ã€€ (RESRC.EFF_FROM_DT              &lt;   NVL(#resrcAssignEndDt#, #maxEffDt#) 
                AND NVL(RESRC.EFF_THRU_DT, #maxEffDt#) &gt;   NVL(#resrcAssignEndDt#, #maxEffDt#))
                )
                OR         (RESRC.EFF_FROM_DT              &gt;=  #resrcAssignStartDt# 
                AND NVL(RESRC.EFF_THRU_DT, #maxEffDt#) &lt;=  NVL(#resrcAssignEndDt#, #maxEffDt#))
            )
        <!-- 2018/03/29 S21_NA#23171 Add End -->
        
        AND RESRC.ACCT_TEAM_ROLE_TP_CD          IS  NULL
        AND RESRC.EZCANCELFLAG                   =  0
    <isNotNull property="psnCd">
        AND RESRC.PSN_CD                        !=  #psnCd#
    </isNotNull>

        AND UNIT.TRTY_GRP_TP_CD                  =  GRP.TRTY_GRP_TP_CD
        AND UNIT.GLBL_CMPY_CD                    =  GRP.GLBL_CMPY_CD
        AND GRP.NON_SLS_REP_FLG                  =  #flgOffN#
        AND GRP.EZCANCELFLAG                     =  0
    </statement>

    <statement id="getTopTierParentOrganization" parameterClass="Map" resultClass="String">
        WITH STRU AS
               (
                    SELECT
                        R.PRNT_ORG_CD
                      , U.ORG_TIER_CD
                    FROM
                        DS_ORG_RELN R
                      , DS_ORG_UNIT U
                    WHERE
                        R.GLBL_CMPY_CD                     =  #glblCmpyCd#
                    AND U.GLBL_CMPY_CD                     =  #glblCmpyCd#
                    AND R.EZCANCELFLAG                     =  0
                    AND U.EZCANCELFLAG                     =  0
                    AND R.ORG_CD                           =  U.ORG_CD
                    AND U.EFF_FROM_DT                  &lt;=  #slsDt#
                    AND NVL(U.EFF_THRU_DT, #maxEffDt#) &gt;=  #slsDt#

                    START WITH
                        R.ORG_CD                           =
                           ( SELECT 
                                 DR.ORG_CD
                             FROM
                                 DS_ORG_RELN DR
                             WHERE
                                 DR.GLBL_CMPY_CD                     =  #glblCmpyCd#
                             AND DR.EZCANCELFLAG                     =  0
                             AND DR.ORG_CD                           =  #orgCd#
                             AND DR.EFF_FROM_DT                  &lt;=  #slsDt#
                             AND NVL(DR.EFF_THRU_DT, #maxEffDt#) &gt;=  #slsDt#
                             AND DR.GNRN_TP_CD                      IN (#gnrnTp_Current#, #gnrnTp_Future#)
                           )
                    CONNECT BY NOCYCLE PRIOR
                        R.PRNT_ORG_CD                      =  R.ORG_CD
                    AND R.EZCANCELFLAG                     =  0
                    AND R.EFF_FROM_DT                  &lt;=  #slsDt#
                    AND NVL(R.EFF_THRU_DT, #maxEffDt#) &gt;=  #slsDt#
                    AND R.GNRN_TP_CD                      IN (#gnrnTp_Current#, #gnrnTp_Future#)
                )
        SELECT
            STRU.PRNT_ORG_CD
        FROM
            STRU
        WHERE
            STRU.ORG_TIER_CD  =
                    (
                        SELECT
                            MIN(STRU.ORG_TIER_CD)
                        FROM
                            STRU
                    )
    </statement>

</sqlMap>
