<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NWAL1840QueryForPricing">

    <statement id="getPrcCatgCd" parameterClass="Map" resultClass="String">
        SELECT
            PRC_CATG_CD
        FROM
            (
             SELECT 
                 PC.PRC_CATG_CD
             FROM
                 PRC_CATG PC
             WHERE
                 PC.GLBL_CMPY_CD     = #glblCmpyCd#
                 AND PC.PRC_CATG_NM  = #prcCatgNm#
                 AND PC.EZCANCELFLAG = '0'
             ORDER BY
                 PC.PRC_CATG_SORT_NUM
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getDsLineCatgCd" parameterClass="Map" resultClass="String">
        SELECT
            DOLC.DS_ORD_LINE_CATG_CD AS DS_ORD_LINE_CATG_CD
        FROM
             DS_ORD_LINE_PROC_DFN DOLPD
            ,DS_ORD_LINE_CATG     DOLC
        WHERE
                DOLPD.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND DOLPD.DS_ORD_TP_CD                 = #dsOrdTpCd#
            AND DOLPD.ACTV_FLG                     = 'Y'
            AND DOLPD.PRIM_LINE_CATG_FLG           = 'Y'
            AND DOLPD.EFF_FROM_DT                 &lt;= #slsDt#
            AND NVL(DOLPD.EFF_THRU_DT,'99991231') &gt;= #slsDt#
            AND DOLPD.EZCANCELFLAG                 = '0'
            AND DOLPD.GLBL_CMPY_CD                 = DOLC.GLBL_CMPY_CD
            AND DOLPD.DS_ORD_LINE_CATG_CD          = DOLC.DS_ORD_LINE_CATG_CD
            AND DOLC.DS_ORD_LINE_DRCTN_CD          = #dsOrdLineDrctnCd#
            AND DOLC.EZCANCELFLAG                  = '0'
    </statement>

</sqlMap>
