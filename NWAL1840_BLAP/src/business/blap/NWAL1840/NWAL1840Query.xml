<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NWAL1840Query">

    <statement id="getMachineInfo" parameterClass="Map"   resultClass="Map">
        SELECT
             DCD.SVC_CONFIG_MSTR_PK AS SVC_CONFIG_MSTR_PK
            ,SMM.SER_NUM            AS SER_NUM
            ,MN.T_MDL_NM            AS MDL_NM
            ,MN.T_MDL_ID            AS MDL_ID
        FROM
             DS_CONTR_DTL    DCD
            ,SVC_MACH_MSTR   SMM
            ,SVC_CONFIG_MSTR SCM
            ,MDL_NM          MN
        WHERE
            DCD.GLBL_CMPY_CD = #glblCmpyCd#
        AND
            DCD.EZCANCELFLAG = '0'
        AND
            DS_CONTR_PK = #dsContrPk#
        AND
            DS_CONTR_DTL_PK = #dsContrDtlPk#
        AND
            SMM.GLBL_CMPY_CD = DCD.GLBL_CMPY_CD
        AND
            SMM.EZCANCELFLAG = '0'
        AND
            SMM.SVC_MACH_MSTR_PK = DCD.SVC_MACH_MSTR_PK
        AND
            SCM.GLBL_CMPY_CD = SMM.GLBL_CMPY_CD
        AND
            SCM.EZCANCELFLAG = '0'
        AND
            SCM.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK
        AND
            MN.T_GLBL_CMPY_CD = SCM.GLBL_CMPY_CD
        AND
            MN.EZCANCELFLAG = '0'
        AND
            MN.T_MDL_ID = SCM.MDL_ID
    </statement>

    <statement id="getDsOrdCatgList" parameterClass="Map"   resultClass="Map">
        SELECT
            OC.DS_ORD_CATG_CD       AS DS_ORD_CATG_CD
           ,OC.DS_ORD_CATG_DESC_TXT AS DS_ORD_CATG_DESC_TXT
        FROM
            DS_ORD_CATG           OC
           ,DS_ORD_TP             OT
           ,AVAL_DS_ORD_TP_APP_ID AI
           ,DS_ORD_TP_PROC_DFN    OTPD
        WHERE
            OC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND OC.DS_ORD_CATG_DESC_TXT LIKE #dsOrdCatgDescTxt#
            AND OC.EZCANCELFLAG         = '0'

            AND OC.GLBL_CMPY_CD   = OT.GLBL_CMPY_CD
            AND OC.DS_ORD_CATG_CD = OT.DS_ORD_CATG_CD
            AND OT.EZCANCELFLAG   = '0'

            AND OT.GLBL_CMPY_CD = AI.GLBL_CMPY_CD
            AND OT.DS_ORD_TP_CD = AI.DS_ORD_TP_CD
            AND AI.BIZ_APP_ID   = #bizId#
            AND AI.EZCANCELFLAG = '0'

            AND OT.GLBL_CMPY_CD   = OTPD.GLBL_CMPY_CD
            AND OT.DS_ORD_TP_CD   = OTPD.DS_ORD_TP_CD
            AND OTPD.ACTV_FLG     = 'Y'
            AND OTPD.EZCANCELFLAG = '0'
        GROUP BY
            OC.DS_ORD_CATG_CD
           ,OC.DS_ORD_CATG_DESC_TXT
    </statement>

    <statement id ="getCtacPsnTpList" parameterClass="Map"  resultClass="Map">
        SELECT
             CT.CTAC_TP_CD
            ,CT.CTAC_TP_DESC_TXT
            ,CT.CTAC_CUST_REF_TP_CD     <!-- QC#16452 add -->
        FROM
            CTAC_TP              CT
        WHERE
            CT.EZCANCELFLAG       = '0'
            AND CT.GLBL_CMPY_CD   = #glblCmpyCd#
            AND CT.ACTV_FLG       = #actvFlg#
    </statement>

    <statement id="getDsOrdTpList" parameterClass="Map" resultClass="Map">
        SELECT 
             DOT.DS_ORD_TP_CD           AS DS_ORD_TP_CD
            ,DOT.DS_ORD_TP_DESC_TXT     AS DS_ORD_TP_DESC_TXT
        FROM
             AVAL_DS_ORD_TP_APP_ID  AD
            ,DS_ORD_TP              DOT
            ,DS_ORD_TP_PROC_DFN     DOTPD
        WHERE
                AD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND AD.BIZ_APP_ID       = #bizId#
            AND AD.EZCANCELFLAG     = '0'
            AND AD.GLBL_CMPY_CD     = DOT.GLBL_CMPY_CD
            AND AD.DS_ORD_TP_CD     = DOT.DS_ORD_TP_CD
            AND DOT.DS_ORD_CATG_CD  = #dsOrdCatgCd#
            AND DOT.EZCANCELFLAG    = '0'
            AND DOT.GLBL_CMPY_CD    = DOTPD.GLBL_CMPY_CD
            AND DOT.DS_ORD_TP_CD    = DOTPD.DS_ORD_TP_CD
            AND DOTPD.ACTV_FLG      = 'Y'
            AND DOTPD.EZCANCELFLAG  = '0'
        ORDER BY
            DOT.DS_ORD_TP_SORT_NUM
    </statement>

    <statement id="getCustAddlInfo" parameterClass="Map" resultClass="Map">
        SELECT
            PD.DEF_BILL_TO_CUST_ACCT_CD AS DEF_BILL_TO_CUST_ACCT_CD
           ,PD.DEF_BILL_TO_CUST_CD      AS DEF_BILL_TO_CUST_CD
           ,PD.LINE_BIZ_TP_CD           AS LINE_BIZ_TP_CD
           ,PD.DEF_SHPG_SVC_LVL_CD      AS DEF_SHPG_SVC_LVL_CD
           ,PD.DROP_SHIP_AVAL_FLG       AS DROP_SHIP_AVAL_FLG
           ,DAC.DS_ACCT_NM              AS DS_ACCT_NM
           ,(
             CASE WHEN BTC.FIRST_LINE_ADDR IS NOT NULL THEN
                 BTC.FIRST_LINE_ADDR || ' ' ||
                 BTC.SCD_LINE_ADDR   || ' ' ||
                 BTC.THIRD_LINE_ADDR || ' ' ||
                 BTC.FRTH_LINE_ADDR  || ' ' ||
                 BTC.CTY_ADDR        || ',' ||
                 BTC.ST_CD           || ' ' ||
                 BTC.POST_CD
              END                     ) AS BILL_TO_ADDR
           ,FC.FRT_COND_CD              AS FRT_COND_CD
           ,FC.FRT_COND_DESC_TXT        AS FRT_COND_DESC_TXT
           ,PC.PRC_CATG_CD              AS PRC_CATG_CD
           ,PC.PRC_CATG_NM              AS PRC_CATG_NM
           ,CSL.CARR_SVC_LVL_DESC_TXT   AS CARR_SVC_LVL_DESC_TXT
        FROM
            DS_ORD_TP_PROC_DFN PD
           ,SELL_TO_CUST       DAC
           ,BILL_TO_CUST       BTC
           ,FRT_COND           FC
           ,PRC_CATG           PC
           ,CARR_SVC_LVL       CSL
        WHERE
            PD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND PD.ACTV_FLG     = 'Y'
            AND PD.EFF_FROM_DT  &lt;= #effDt#
            AND NVL(PD.EFF_THRU_DT, '99991231') &gt;= #effDt#
            AND PD.EZCANCELFLAG = '0'

            AND PD.GLBL_CMPY_CD             = DAC.GLBL_CMPY_CD (+)
            AND PD.DEF_BILL_TO_CUST_ACCT_CD = DAC.SELL_TO_CUST_CD (+)
            AND DAC.EZCANCELFLAG (+)        = '0'

            AND PD.GLBL_CMPY_CD        = BTC.GLBL_CMPY_CD (+)
            AND PD.DEF_BILL_TO_CUST_CD = BTC.BILL_TO_CUST_CD (+)
            AND BTC.RGTN_STS_CD (+)    = #rgtnSts#
            AND BTC.EZCANCELFLAG (+)   = '0'

            AND PD.GLBL_CMPY_CD     = FC.GLBL_CMPY_CD (+)
            AND PD.FRT_COND_CD      = FC.FRT_COND_CD (+)
            AND FC.EZCANCELFLAG (+) = '0'

            AND PD.GLBL_CMPY_CD     = PC.GLBL_CMPY_CD (+)
            AND PD.DEF_PRC_CATG_CD  = PC.PRC_CATG_CD (+)
            AND PC.EZCANCELFLAG (+) = '0'

            AND PD.GLBL_CMPY_CD        = CSL.GLBL_CMPY_CD (+)
            AND PD.DEF_CARR_SVC_LVL_CD = CSL.CARR_SVC_LVL_CD (+)
            AND CSL.EZCANCELFLAG (+)   = '0'
    </statement>

    <statement id="getCarrSvcLvlCd" parameterClass="Map" resultClass="String">
        SELECT
            CARR_SVC_LVL_CD
        FROM
            (
             SELECT 
                 CSL.CARR_SVC_LVL_CD
             FROM
                 CARR_SVC_LVL CSL
             WHERE
                 CSL.GLBL_CMPY_CD              = #glblCmpyCd#
                 AND UPPER(CSL.CARR_SVC_LVL_DESC_TXT) = UPPER(#carrSvcLvlDescTxt#)
                 AND CSL.EZCANCELFLAG          = '0'
             ORDER BY
                 CSL.CARR_SVC_LVL_SORT_NUM
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getCarrSvcLvlTxt" parameterClass="Map" resultClass="String">
        SELECT
            CARR_SVC_LVL_DESC_TXT
        FROM
            (
             SELECT 
                 CSL.CARR_SVC_LVL_DESC_TXT
             FROM
                 SHPG_SVC_LVL_CARR_RELN SSLCR
                ,CARR_SVC_LVL           CSL
             WHERE
                 SSLCR.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND SSLCR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                 AND SSLCR.CARR_CD         = #carrCd#
                 AND SSLCR.EZCANCELFLAG    = '0'

                 AND SSLCR.GLBL_CMPY_CD    = CSL.GLBL_CMPY_CD
                 AND SSLCR.CARR_SVC_LVL_CD = CSL.CARR_SVC_LVL_CD
                 AND CSL.EZCANCELFLAG      = '0'
             ORDER BY
                 SSLCR.CARR_SVC_LVL_CD DESC
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getPmtTermCashDiscCd" parameterClass="Map" resultClass="String">
        SELECT
            PMT_TERM_CASH_DISC_CD
        FROM
            (
             SELECT
                 PTCD.PMT_TERM_CASH_DISC_CD
             FROM
                 PMT_TERM_CASH_DISC PTCD
             WHERE
                 PTCD.GLBL_CMPY_CD                    = #glblCmpyCd#
                 AND PTCD.PMT_TERM_CASH_DISC_DESC_TXT = #pmtTermCashDiscDescTxt#
                 AND PTCD.EZCANCELFLAG                = '0'
             ORDER BY
                 PTCD.PMT_TERM_CASH_DISC_SORT_NUM
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getPmtTermCashDiscCdForBillToCust" parameterClass="Map" resultClass="String">
        SELECT
            PMT_TERM_CASH_DISC_CD
        FROM
            (
             SELECT
                 CCP.PMT_TERM_CASH_DISC_CD
             FROM
                 CUST_CR_PRFL CCP
             WHERE
                 CCP.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND CCP.BILL_TO_CUST_CD = #billToCustCd#
                 AND CCP.EZCANCELFLAG    = '0'

             ORDER BY
                 CCP.BILL_TO_CUST_PK DESC
            )
        WHERE
            ROWNUM = 1
    </statement>
    <statement id="getShipToCustAddr" parameterClass="Map" resultClass="Map">
        SELECT
            SHIP_TO_CUST_CD
           ,SHIP_TO_ADDR
           ,LOC_NUM
           ,LOC_NM
           ,ADDL_LOC_NM
           ,FIRST_LINE_ADDR
           ,SCD_LINE_ADDR
           ,THIRD_LINE_ADDR
           ,FRTH_LINE_ADDR
           ,FIRST_REF_CMNT_TXT
           ,SCD_REF_CMNT_TXT
           ,CTY_ADDR
           ,ST_CD
           ,POST_CD
           ,PROV_NM
           ,CTRY_CD
           ,CNTY_NM
        FROM
            (
             SELECT
                 STC.SHIP_TO_CUST_CD    AS SHIP_TO_CUST_CD
                ,(
                  CASE WHEN STC.FIRST_LINE_ADDR IS NOT NULL THEN
                      STC.FIRST_LINE_ADDR || ' ' ||
                      STC.SCD_LINE_ADDR   || ' ' ||
                      STC.THIRD_LINE_ADDR || ' ' ||
                      STC.FRTH_LINE_ADDR  || ' ' ||
                      STC.CTY_ADDR        || ',' ||
                      STC.ST_CD           || ' ' ||
                      STC.POST_CD
                  END)                  AS SHIP_TO_ADDR
                ,STC.LOC_NUM            AS LOC_NUM
                ,STC.LOC_NM             AS LOC_NM
                ,STC.ADDL_LOC_NM        AS ADDL_LOC_NM
                ,STC.FIRST_LINE_ADDR    AS FIRST_LINE_ADDR
                ,STC.SCD_LINE_ADDR      AS SCD_LINE_ADDR
                ,STC.THIRD_LINE_ADDR    AS THIRD_LINE_ADDR
                ,STC.FRTH_LINE_ADDR     AS FRTH_LINE_ADDR
                ,STC.FIRST_REF_CMNT_TXT AS FIRST_REF_CMNT_TXT
                ,STC.SCD_REF_CMNT_TXT   AS SCD_REF_CMNT_TXT
                ,STC.CTY_ADDR           AS CTY_ADDR
                ,STC.ST_CD              AS ST_CD
                ,STC.POST_CD            AS POST_CD
                ,STC.PROV_NM            AS PROV_NM
                ,STC.CTRY_CD            AS CTRY_CD
                ,CNTY.CNTY_NM           AS CNTY_NM
             FROM
                 SHIP_TO_CUST STC
                ,CNTY         CNTY
             WHERE
                 STC.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
                 AND STC.RGTN_STS_CD     = #rgtnStsCd#
                 AND STC.EZCANCELFLAG    = '0'

                 AND STC.GLBL_CMPY_CD      = CNTY.GLBL_CMPY_CD (+)
                 AND STC.CNTY_PK           = CNTY.CNTY_PK (+)
                 AND CNTY.EZCANCELFLAG (+) = '0'
             ORDER BY
                 STC.SHIP_TO_CUST_PK DESC
            )
        WHERE
            ROWNUM = 1
    </statement>
    <statement id="getFrtCondCd" parameterClass="Map" resultClass="String">
        SELECT
            FRT_COND_CD
        FROM
            (
             SELECT 
                 FC.FRT_COND_CD
             FROM
                 FRT_COND FC
             WHERE
                 FC.GLBL_CMPY_CD          = #glblCmpyCd#
                 AND FC.FRT_COND_DESC_TXT = #frtCondDescTxt#
                 AND FC.EZCANCELFLAG      = '0'
             ORDER BY
                 FC.FRT_COND_SORT_NUM
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getFreightTermInfoList"  parameterClass="Map" resultClass="Map">
        <!-- 2018/10/26 QC#28870 Add Start -->
        SELECT * FROM (
            SELECT DISTINCT
                FC.FRT_COND_CD       AS FRT_COND_CD
               ,FC.FRT_COND_DESC_TXT AS FRT_COND_DESC_TXT
            FROM
                FRT_COND              FC
               ,FRT_COND_SVC_LVL_RELN FCSLR
            WHERE
                FC.GLBL_CMPY_CD          = #glblCmpyCd#
                AND FC.FRT_COND_DESC_TXT LIKE #frtCondDescTxt#
                AND FC.EZCANCELFLAG      = '0'

                AND FC.GLBL_CMPY_CD      = FCSLR.GLBL_CMPY_CD
                AND FC.FRT_COND_CD       = FCSLR.FRT_COND_CD
                AND FCSLR.LINE_BIZ_TP_CD = #lineBizTpCd#
                AND FCSLR.EZCANCELFLAG   = '0' ) FCS
        WHERE
            ROWNUM          &lt;= 2
        <!-- 2018/10/26 QC#28870 Add End -->
    </statement>

    <statement id="getSlsRepInfoList" parameterClass="Map" resultClass="Map">
        SELECT 
            SP.PSN_NUM           AS PSN_NUM      <!-- MOD S21_NA#7861 PSN_CD - PSN_NUM --> 
           ,TOC.TOC_CD           AS TOC_CD
           ,TOC.TOC_NM           AS TOC_NM
           ,CB.COA_BR_CD         AS COA_BR_CD
           ,CB.COA_BR_DESC_TXT   AS COA_BR_DESC_TXT
           ,CE.COA_EXTN_CD       AS COA_EXTN_CD
           ,CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT
           ,(CASE
                  WHEN CB.COA_BR_CD IS NOT NULL
                  THEN CB.COA_BR_CD || ':' || CB.COA_BR_DESC_TXT
             END) AS COA_BR_ITEM
           ,(CASE
                  WHEN CE.COA_EXTN_CD IS NOT NULL
                  THEN CE.COA_EXTN_CD || ':' || CE.COA_EXTN_DESC_TXT
             END) AS COA_EXTN_ITEM
        FROM 
            TOC              TOC
           ,ORG_FUNC_ROLE_TP OFRT
           ,BIZ_AREA_ORG     BA
           ,ORG_FUNC_ASG     OFA
           ,S21_PSN          SP
           ,COA_BR           CB
           ,COA_EXTN         CE
           ,S21_ORG          SO
        WHERE 
            TOC.GLBL_CMPY_CD     = #glblCmpyCd#
            <isNotNull property="slsRepTocNm">
                AND UPPER(TOC.TOC_NM)   LIKE  UPPER(#slsRepTocNm#)   <!-- S21_NA#13627 MOD -->
            </isNotNull>
            AND TOC.EZCANCELFLAG = '0'

            AND TOC.GLBL_CMPY_CD        = OFRT.GLBL_CMPY_CD
            AND TOC.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD
            AND OFRT.SLS_REP_FLG        = #slsRepFlg#
            AND OFRT.EZCANCELFLAG       = '0'

            AND TOC.GLBL_CMPY_CD    = SO.GLBL_CMPY_CD
            AND TOC.TOC_CD          = SO.TOC_CD
            AND SO.EZCANCELFLAG     = '0'
            AND SO.RGTN_STS_CD        &lt;&gt; #rgtnStsCd#

            AND OFRT.GLBL_CMPY_CD = BA.GLBL_CMPY_CD
            AND OFRT.FIRST_ORG_CD = BA.BIZ_AREA_ORG_CD
            AND BA.SLS_FLG        = #slsRepFlg#
            AND BA.ORG_STRU_TP_CD = #orgStruTpCd#
            AND BA.EZCANCELFLAG   = '0'

            AND TOC.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD
            AND TOC.TOC_CD       = OFA.TOC_CD
            AND OFA.EZCANCELFLAG = '0'

            AND OFA.GLBL_CMPY_CD = SP.GLBL_CMPY_CD
            AND OFA.PSN_CD       = SP.PSN_CD
            <isNotNull property="psnNum">        <!-- MOD S21_NA#7861 slsRepPsnCd - psnNum --> 
                AND SP.PSN_NUM    LIKE #psnNum#  <!-- MOD S21_NA#7861 slsRepPsnCd - psnNum --> 
            </isNotNull>
            AND SP.EFF_FROM_DT   &lt;= #slsDt#
            AND (SP.EFF_THRU_DT  &gt;= #slsDt# OR SP.EFF_THRU_DT IS NULL)
            AND SP.EZCANCELFLAG       = '0'

            AND TOC.GLBL_CMPY_CD    = CB.GLBL_CMPY_CD (+)
            AND TOC.COA_BR_CD       = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+) = '0'

            AND TOC.GLBL_CMPY_CD    = CE.GLBL_CMPY_CD (+)
            AND TOC.COA_EXTN_CD     = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+) = '0'
            AND ROWNUM          &lt;= 2  <!-- 2018/10/26 QC#28870 Add -->
    </statement>

    <statement id="getSlsRepInfo" parameterClass="Map" resultClass="Map">
        SELECT
            TOC.TOC_NM           AS TOC_NM
           ,CB.COA_BR_CD         AS COA_BR_CD
           ,CB.COA_BR_DESC_TXT   AS COA_BR_DESC_TXT
           ,CE.COA_EXTN_CD       AS COA_EXTN_CD
           ,CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT
           ,(CASE
                 WHEN CB.COA_BR_CD IS NOT NULL
                 THEN CB.COA_BR_CD || ':' || CB.COA_BR_DESC_TXT
             END) AS COA_BR_ITEM
           ,(CASE
                 WHEN CE.COA_EXTN_CD IS NOT NULL
                 THEN CE.COA_EXTN_CD || ':' || CE.COA_EXTN_DESC_TXT
             END) AS COA_EXTN_ITEM
            ,SP.PSN_NUM         AS PSN_NUM
        FROM
            TOC      TOC
           ,COA_BR   CB
           ,COA_EXTN CE
           ,ORG_FUNC_ASG OFA
           ,S21_PSN  SP
           ,S21_ORG SO
        WHERE
            TOC.GLBL_CMPY_CD     = #glblCmpyCd#
            AND TOC.TOC_CD       = #slsRepTocCd#
            AND TOC.EZCANCELFLAG = '0'

            AND TOC.GLBL_CMPY_CD    = SO.GLBL_CMPY_CD
            AND TOC.TOC_CD          = SO.TOC_CD
            AND SO.EZCANCELFLAG     = '0'
            AND SO.RGTN_STS_CD        &lt;&gt; #rgtnStsCd#

            AND TOC.GLBL_CMPY_CD    = CB.GLBL_CMPY_CD (+)
            AND TOC.COA_BR_CD       = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+) = '0'

            AND TOC.GLBL_CMPY_CD    = CE.GLBL_CMPY_CD (+)
            AND TOC.COA_EXTN_CD     = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+) = '0'

            AND TOC.GLBL_CMPY_CD    = OFA.GLBL_CMPY_CD (+)
            AND TOC.TOC_CD          = OFA.TOC_CD (+)
            AND OFA.EZCANCELFLAG (+) = '0'

            AND OFA.GLBL_CMPY_CD    = SP.GLBL_CMPY_CD (+)
            AND OFA.PSN_CD          = SP.PSN_CD (+)
            AND SP.EZCANCELFLAG (+) = '0'
    </statement>


    <statement id="getShipToInfo" parameterClass="Map" resultClass="Map"> 
        SELECT
            STC.SELL_TO_CUST_CD
           ,STC.LOC_NUM
        FROM
            SHIP_TO_CUST STC
        WHERE
            STC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
            AND STC.RGTN_STS_CD     = #rgtnSts#
            AND STC.EZCANCELFLAG    = '0'
            AND ROWNUM              = #rowNum#
    </statement>

    <statement id="getDefCust" parameterClass="Map" resultClass="Map"> 
        
        SELECT 
             SMM.OWNR_LOC_NUM            AS OWNR_LOC_NUM
            ,SMM.BILL_TO_LOC_NUM         AS BILL_TO_LOC_NUM
            ,SMM.CUR_LOC_ACCT_NUM        AS CUR_LOC_ACCT_NUM
            <!-- 2017/09/18 S21_NA#21190 Add Start -->
            ,SMM.CUR_LOC_NUM             AS CUR_LOC_NUM
            <!-- 2017/09/18 S21_NA#21190 Add End -->
        FROM  
             SVC_MACH_MSTR      SMM
            ,DS_CONTR_DTL       DCD
        WHERE
                SMM.GLBL_CMPY_CD        = #glblCmpyCd#
            AND SMM.SER_NUM             = #serNum#
            AND SMM.EZCANCELFLAG        = '0'
            
            AND SMM.GLBL_CMPY_CD        = DCD.GLBL_CMPY_CD
            AND SMM.SVC_MACH_MSTR_PK    = DCD.SVC_MACH_MSTR_PK
            AND DCD.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getDefSold" parameterClass="Map" resultClass="Map"> 
        
        SELECT 
             SMM.OWNR_LOC_NUM            AS OWNR_LOC_NUM
            ,DCD.BASE_BILL_TO_CUST_CD    AS BASE_BILL_TO_CUST_CD
        FROM  
             SVC_MACH_MSTR      SMM
            ,DS_CONTR_DTL       DCD
        WHERE
                SMM.GLBL_CMPY_CD        = #glblCmpyCd#
            AND SMM.SER_NUM  = #serNum#
            AND SMM.EZCANCELFLAG        = '0'
            
            AND SMM.GLBL_CMPY_CD        = DCD.GLBL_CMPY_CD
            AND SMM.SVC_MACH_MSTR_PK    = DCD.SVC_MACH_MSTR_PK
            AND DCD.EZCANCELFLAG        = '0'
    </statement>
    <statement id="getDefBill" parameterClass="Map" resultClass="Map"> 
            SELECT 
                DCD.BASE_BILL_TO_CUST_CD    AS BASE_BILL_TO_CUST_CD
            FROM
                DS_CONTR        DC
                ,DS_CONTR_DTL   DCD
            WHERE
                    DC.GLBL_CMPY_CD     = #glblCmpyCd#
                AND DC.DS_CONTR_NUM     = #contrNum#
                AND DC.EZCANCELFLAG     = '0'
                AND DC.GLBL_CMPY_CD     = #glblCmpyCd#
                AND DC.DS_CONTR_PK      = DCD.DS_CONTR_PK
                AND DC.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getShpgSvcLvlDataList" parameterClass="Map" resultClass="Map">
        SELECT 
            SSL.SHPG_SVC_LVL_CD
            ,SSL.SHPG_SVC_LVL_DESC_TXT
            ,SSL.SHPG_SVC_LVL_SORT_NUM
        FROM 
            SHPG_SVC_LVL            SSL
            ,FRT_COND_SVC_LVL_RELN  FCSLR
        WHERE
                SSL.GLBL_CMPY_CD        = #glblCmpyCd#
            AND SSL.GLBL_CMPY_CD        = FCSLR.GLBL_CMPY_CD
            AND SSL.SHPG_SVC_LVL_CD     = FCSLR.SHPG_SVC_LVL_CD
            AND FCSLR.LINE_BIZ_TP_CD    = #lineBizTpCd#
            <isNotNull property="frtCondCd">
                AND FCSLR.FRT_COND_CD   = #frtCondCd#
            </isNotNull>
            AND SSL.EZCANCELFLAG        = '0'
            AND FCSLR.EZCANCELFLAG      = '0'
        GROUP BY
            SSL.SHPG_SVC_LVL_CD
            ,SSL.SHPG_SVC_LVL_DESC_TXT
            ,SSL.SHPG_SVC_LVL_SORT_NUM
        ORDER BY
            SSL.SHPG_SVC_LVL_SORT_NUM
    </statement>
<!-- QC#16452 add Start -->
    <statement id="getBillToLocationNumber" parameterClass="Map" resultClass="String"> 
        SELECT
           BT.LOC_NUM
        FROM
            BILL_TO_CUST    BT
        WHERE
                BT.GLBL_CMPY_CD    = #glblCmpyCd#
            AND BT.BILL_TO_CUST_CD = #custCd#
            AND BT.RGTN_STS_CD     = #rgtnSts#
            AND BT.EZCANCELFLAG    = '0'
            AND ROWNUM            = #rowNum#
    </statement>

    <statement id="getShipToLocationNumber" parameterClass="Map" resultClass="String"> 
        SELECT
           ST.LOC_NUM
        FROM
            SHIP_TO_CUST    ST
        WHERE
                ST.GLBL_CMPY_CD    = #glblCmpyCd#
            AND ST.SHIP_TO_CUST_CD = #custCd#
            AND ST.RGTN_STS_CD     = #rgtnSts#
            AND ST.EZCANCELFLAG    = '0'
            AND ROWNUM            = #rowNum#
    </statement>
<!-- QC#16452 add End -->
    <statement id="getInPondWt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                  IN_POUND_WT
        FROM (
            SELECT
                      P.IN_POUND_WT 
                FROM
                      ALL_MDSE_V M
                    , MDSE_STORE_PKG P 
                WHERE
                    M.GLBL_CMPY_CD     = #glblCmpyCd#
                    AND M.MDSE_CD      = #mdseCd#
                    AND M.EZCANCELFLAG = '0' 
                    AND M.GLBL_CMPY_CD = P.GLBL_CMPY_CD 
                    AND M.MDSE_CD      = P.MDSE_CD 
                    AND P.EZCANCELFLAG = '0'
            UNION ALL
            SELECT
                      P.IN_POUND_WT 
                FROM
                      ALL_MDSE_V M
                    , ORD_TAKE_MDSE O
                    , MDSE_STORE_PKG P 
                WHERE
                    M.GLBL_CMPY_CD     = #glblCmpyCd#
                    AND M.MDSE_CD      = #mdseCd#
                    AND M.EZCANCELFLAG = '0' 
                    AND M.GLBL_CMPY_CD = O.GLBL_CMPY_CD 
                    AND M.MDSE_CD      = O.ORD_TAKE_MDSE_CD 
                    AND O.EZCANCELFLAG = '0'
                    AND O.GLBL_CMPY_CD = P.GLBL_CMPY_CD 
                    AND O.MDSE_CD      = P.MDSE_CD 
                    AND P.EZCANCELFLAG = '0'
        )
        WHERE ROWNUM = 1
    </statement>

</sqlMap>
