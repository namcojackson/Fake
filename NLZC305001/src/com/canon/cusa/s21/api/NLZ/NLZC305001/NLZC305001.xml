<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NLZC305001">

    <typeAlias alias="DS_ASSET_MSTRTMsg" type="business.db.DS_ASSET_MSTRTMsg"/>

    <statement id="getDsAssetMstrPk" parameterClass="Map" resultMap="result.DS_ASSET_MSTRTMsg">
        SELECT
                DAM.DS_ASSET_MSTR_PK
        FROM
                DS_ASSET_MSTR DAM
        WHERE
                DAM.GLBL_CMPY_CD   = #glblCmpyCd#
        AND     DAM.MDSE_CD        = #mdseCd#
        AND     DAM.SER_NUM        = #serNum#
        AND     DAM.ACTV_ASSET_FLG = #actvAssetFlgY#
        AND     DAM.ASSET_POST_FLG = #actvAssetFlgY#
        AND     DAM.EZCANCELFLAG   = '0'
        UNION
        SELECT
                DAM.DS_ASSET_MSTR_PK
        FROM
                DS_ASSET_MSTR DAM
        WHERE
                DAM.GLBL_CMPY_CD   = #glblCmpyCd#
        AND     DAM.MDSE_CD        = #mdseCd#
        AND     DAM.SER_NUM        = #serNum#
        AND     DAM.ACTV_ASSET_FLG = #actvAssetFlgN#
        AND     DAM.ASSET_POST_FLG = #actvAssetFlgN#
        AND     DAM.EZCANCELFLAG   = '0'
    </statement>

    <resultMap id="result.DS_ASSET_MSTRTMsg" class="DS_ASSET_MSTRTMsg">
        <result property="dsAssetMstrPk"   column="DS_ASSET_MSTR_PK"   javaType="EZDTBigDecimalItem"/>
    </resultMap>

    <statement id="getDefDepcMthNum" parameterClass="Map" resultClass="String">
        SELECT
                DEF_DEPC_MTH_NUM
        FROM
                ASSET_BOOK_CTRL
        WHERE
                GLBL_CMPY_CD       = #glblCmpyCd#
        AND     ASSET_TP_CD        = #assetTpCd#
        AND     EFF_FROM_DT    &lt;= #effFromDt#
        AND    (
                   EFF_THRU_DT &gt;= #effThruDt#
                OR EFF_THRU_DT IS NULL
               )
        AND     EZCANCELFLAG       = '0'
    </statement>

    <statement id="getParentAssetMstr" parameterClass="Map" resultClass="Map">
        SELECT
             DAM.DS_ASSET_MSTR_PK
            ,DAM.GLBL_CMPY_CD
            ,DAM.EZTABLEID
            ,DAM.EZCANCELFLAG
            ,DAM.EZINTIME
            ,DAM.EZINTIMEZONE
            ,DAM.EZINCOMPANYCODE
            ,DAM.EZINUSERID
            ,DAM.EZINAPLID
            ,DAM.EZUPTIME
            ,DAM.EZUPTIMEZONE
            ,DAM.EZUPCOMPANYCODE
            ,DAM.EZUPUSERID
            ,DAM.EZUPAPLID
            ,DAM.MDSE_CD
            ,DAM.SER_NUM
            ,DAM.ACTV_ASSET_FLG
            ,DAM.ASSET_TP_CD
            ,DAM.SVC_MACH_MSTR_PK
            ,DAM.SHPG_PLN_NUM
            ,DAM.INIT_BOOK_AMT
            ,DAM.ORIG_INIT_BOOK_AMT
            ,DAM.DEPC_MTH_NUM
            ,DAM.DEPC_START_DT
            ,DAM.DEPC_CNT
            ,DAM.CUR_VAL_AMT
            ,DAM.SLS_REP_TOC_CD
            ,DAM.FIRST_DEPC_YR_MTH
            ,DAM.LAST_DEPC_YR_MTH
            ,DAM.RSDL_VAL_AMT
            ,DAM.REV_RECOG_DT
            ,DAM.DEPC_STOP_DT
            ,DAM.DEPC_RE_START_DT
            ,DAM.INVTY_TRX_PK
            ,DAM.ORIG_INVTY_TRX_PK
            ,DAM.ASSET_STS_CD
            ,DAM.RTRN_WH_CD
            ,DAM.CPO_ORD_NUM
            ,DAM.CPO_DTL_LINE_NUM
            ,DAM.CPO_DTL_LINE_SUB_NUM
            ,DAM.DS_ORD_POSN_NUM
            ,DAM.SHIP_TO_CUST_ACCT_CD
            ,DAM.SHIP_TO_CUST_CD
            ,DAM.SELL_TO_CUST_CD
            ,DAM.SLD_TO_CUST_LOC_CD
            ,DAM.AP_VND_INV_NUM
            ,DAM.INV_DT
            ,DAM.MDSE_TP_CD
            ,DAM.PRNT_DS_ASSET_MSTR_PK
            ,DAM.VND_CD
            ,DAM.VND_NM
            ,DAM.PO_ORD_NUM
            ,DAM.DS_ASSET_DESC_TXT
            ,DAM.CONTR_EFF_FROM_DT
            ,DAM.MAN_ENTRY_FLG
            ,DAM.ASSET_TAG_NUM
            ,DAM.ORIG_STD_COST_AMT
            ,DAM.ORIG_CSMP_PRC_AMT
            ,DAM.ORIG_ORD_ADJ_AMT
            ,DAM.ASSET_COST_SPL_PCT
            ,DAM.BAT_CALC_CSMP_PRC_AMT
            ,DAM.BAT_CALC_ORD_PRC_AMT
            ,DAM.BAT_CALC_ASSET_ADJ_PRC_AMT
            ,DAM.BAT_CALC_INIT_BOOK_AMT
            ,DAM.ASSET_CALC_STS_CD
            ,DAM.BASE_CMPT_FLG
            ,DAM.ASSET_POST_FLG
            ,DAM.SVC_CONFIG_MSTR_PK
            ,DAM.ASG_DTL_CMNT_TXT
            ,DAM.FIN_DTL_CMNT_TXT
            ,DAM.FIRST_LINE_ADDR
            ,DAM.SCD_LINE_ADDR
            ,DAM.THIRD_LINE_ADDR
            ,DAM.FRTH_LINE_ADDR
            ,DAM.CTY_ADDR
            ,DAM.ST_CD
            ,DAM.POST_CD
            ,DAM.ASSET_LEASE_NUM
            ,DAM.LEASE_START_DT
            ,DAM.LEASE_END_DT
            ,DAM.PROC_MODE_CD
            ,DAM.TOT_ASSET_QTY
            ,DAM.EXP_COA_CMPY_CD
            ,DAM.EXP_COA_BR_CD
            ,DAM.EXP_COA_CC_CD
            ,DAM.EXP_COA_ACCT_CD
            ,DAM.EXP_COA_PROD_CD
            ,DAM.EXP_COA_CH_CD
            ,DAM.EXP_COA_AFFL_CD
            ,DAM.EXP_COA_PROJ_CD
            ,DAM.EXP_COA_EXTN_CD
            ,DAM.ASSET_COA_CMPY_CD
            ,DAM.ASSET_COA_BR_CD
            ,DAM.ASSET_COA_CC_CD
            ,DAM.ASSET_COA_ACCT_CD
            ,DAM.ASSET_COA_PROD_CD
            ,DAM.ASSET_COA_CH_CD
            ,DAM.ASSET_COA_AFFL_CD
            ,DAM.ASSET_COA_PROJ_CD
            ,DAM.ASSET_COA_EXTN_CD
            ,DAM.ASSET_RTIRE_RSN_CMNT_TXT
            ,DAM.LAST_BILL_DT
            ,DAM.BLLG_INV_NUM
            ,DAM.PRCD_FROM_SLS_AMT
            ,DAM.RMV_COST_AMT
            ,DAM.COA_MDSE_TP_CD
            ,DAM.DS_CONTR_NUM
            ,DAM.CONTR_EFF_THRU_DT
            ,DAM.CUST_ISS_PO_NUM
            ,DAM.DTL_CMNT_TXT
            ,DAM.AMT_CHNG_RSN_TP_CD
            ,DAM.ADJ_COA_ACCT_CD
        FROM
            DS_ASSET_MSTR DAM
        WHERE
            DAM.GLBL_CMPY_CD          = #glblCmpyCd#
        AND DAM.PRNT_DS_ASSET_MSTR_PK = #prntDsAssetMstrPk#
        <isNotNull property="actvAssetFlg">
        AND DAM.ACTV_ASSET_FLG        = #actvAssetFlg#
        </isNotNull>
        <isNotNull property="assetPostFlg">
        AND DAM.ASSET_POST_FLG        = #assetPostFlg#
        </isNotNull>
        AND DAM.EZCANCELFLAG          = '0'
    </statement>

    <statement id="getRtrnLineAddr" parameterClass="Map" resultClass="Map">
        SELECT
             RW.FIRST_LINE_ADDR
            ,RW.SCD_LINE_ADDR
            ,RW.THIRD_LINE_ADDR
            ,RW.FRTH_LINE_ADDR
            ,RW.CTY_ADDR
            ,RW.ST_CD
            ,RW.POST_CD
        FROM
             RTL_SWH RS
            ,RTL_WH  RW
        WHERE
            RS.GLBL_CMPY_CD = #glblCmpyCd#
        AND RS.INVTY_LOC_CD = #invtyLocCd#
        AND RS.EZCANCELFLAG = '0'
        AND RS.GLBL_CMPY_CD = RW.GLBL_CMPY_CD
        AND RS.RTL_WH_CD    = RW.RTL_WH_CD
        AND RW.EZCANCELFLAG = '0'
    </statement>

    <statement id="getInitCostCalucInfo" parameterClass="Map" resultClass="Map">
        SELECT
                DAM.DS_ASSET_MSTR_PK
               ,DAM.PRNT_DS_ASSET_MSTR_PK
               ,DAM.ORIG_STD_COST_AMT
               ,DAM.ORIG_CSMP_PRC_AMT
               ,DAM.ORIG_ORD_ADJ_AMT
               ,DAM.SVC_MACH_MSTR_PK
               ,DAM.CUR_VAL_AMT
               ,DAM.INIT_BOOK_AMT
               ,SMM.CPO_ORD_NUM
               ,SMM.CPO_DTL_LINE_NUM
               ,SMM.CPO_DTL_LINE_SUB_NUM
        FROM
                DS_ASSET_MSTR     DAM
               ,SVC_MACH_MSTR     SMM
        WHERE
                DAM.GLBL_CMPY_CD          = #glblCmpyCd#
        AND     DAM.PRNT_DS_ASSET_MSTR_PK = #prntDsAssetMstrPk#
        AND     DAM.ASSET_POST_FLG        = #assetPostFlg#
        AND     DAM.EZCANCELFLAG          = '0'
        AND     DAM.GLBL_CMPY_CD          = SMM.GLBL_CMPY_CD(+)
        AND     DAM.SVC_MACH_MSTR_PK      = SMM.SVC_MACH_MSTR_PK(+)
        AND     SMM.EZCANCELFLAG(+)       = '0'
    </statement>

    <statement id="getPerMthNum" parameterClass="Map" resultClass="String">
        SELECT
                TO_CHAR(SUM(DCD.TO_PER_MTH_NUM - DCD.FROM_PER_MTH_NUM + 1)) AS PER_MTH_NUM
        FROM
                DS_CONTR_DTL     DCD
        WHERE
                DCD.GLBL_CMPY_CD          = #glblCmpyCd#
        AND     DCD.CPO_ORD_NUM           = #cpoOrdNum#
        AND     DCD.CPO_DTL_LINE_NUM      = #cpoDtlLineNum#
        AND     DCD.CPO_DTL_LINE_SUB_NUM  = #cpoDtlLineSubNum#
        AND     DCD.EZCANCELFLAG(+)       = '0'
    <!-- START 2019/06/05 S.Yamamoto [QC#50717,ADD] -->
        AND     DCD.DS_CONTR_CRAT_TP_CD   = #dsContrCratTpCd#
    <!-- END   2019/06/05 S.Yamamoto [QC#50717,ADD] -->
    </statement>

    <statement id="getDsAssetPerMthNum" parameterClass="Map" resultClass="String">
        SELECT
                DEPC_MTH_NUM - DEPC_CNT AS PER_MTH_NUM
        FROM
                DS_ASSET_MSTR     DAM
        WHERE
                DAM.GLBL_CMPY_CD          = #glblCmpyCd#
        AND     DAM.DS_ASSET_MSTR_PK      = #dsAssetMstrPK#
        AND     DAM.EZCANCELFLAG(+)       = '0'
    </statement>

    <statement id="getParentVendorCode" parameterClass="Map" resultClass="String">
    <!-- START 2018/03/20 T.Kikuhara [QC#20316,MOD] -->
        SELECT
            CAIH.PRNT_VND_CD
        FROM
            CM_AP_INV_HDR CAIH
        WHERE
            CAIH.GLBL_CMPY_CD       = #glblCmpyCd#
        AND CAIH.AP_VND_INV_NUM     = #apVndInvNum#
        AND CAIH.EZCANCELFLAG       = '0'
        AND ROWNUM                  = 1
    <!-- END 2018/03/20 T.Kikuhara [QC#20316,MOD] -->
    </statement>

    <statement id="getAPInvoiceOrdInfo" parameterClass="Map" resultClass="Map">
        SELECT
             CAID.PO_NUM AS PO_ORD_NUM
            ,CAID.PO_ORD_DTL_LINE_NUM
            ,CAID.VND_CD
            ,CAID.AP_VND_INV_LINE_NUM
            ,SUBSTR(CAID.MDSE_DESC_SHORT_TXT,1,50) AS MDSE_DESC_SHORT_TXT
        FROM
            CM_AP_INV_DTL CAID
        WHERE
            CAID.GLBL_CMPY_CD         = #glblCmpyCd#
        AND CAID.AP_VND_INV_NUM       = #apVndInvNum#
        AND CAID.AP_VND_INV_SQ_NUM    = #apVndInvSqNum#
        AND CAID.AP_VND_INV_LINE_NUM  = #apVndInvLineNum#
        AND CAID.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getPOCoaSegments" parameterClass="Map" resultClass="Map">
        SELECT
             PA.COA_CMPY_CD
            ,PA.COA_BR_CD
            ,PA.COA_CC_CD
            ,PA.COA_ACCT_CD
            ,PA.COA_PROD_CD
            ,PA.COA_CH_CD
            ,PA.COA_AFFL_CD
            ,PA.COA_PROJ_CD
            ,PA.COA_EXTN_CD
        FROM
             PO_DTL  PD
            ,PO_ACCT PA
        WHERE
            PD.GLBL_CMPY_CD        = #glblCmpyCd#
        AND PD.PO_ORD_NUM          = #poOrdNum#
        AND PD.PO_ORD_DTL_LINE_NUM = #poOrdDtlLineNum#
        AND PD.GLBL_CMPY_CD        = PA.GLBL_CMPY_CD
        AND PD.PO_ORD_NUM          = PA.PO_ORD_NUM
        AND PD.PO_ORD_DTL_LINE_NUM = PA.PO_ORD_DTL_LINE_NUM
        AND PA.PO_ACCT_TP_CD       = #poAcctTpCd#
        AND PD.EZCANCELFLAG        = '0'
        AND PA.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getCoaAcctCd" parameterClass="Map" resultClass="Map">
        SELECT
                 ABC.DEPC_COA_ACCT_CD
                ,ABC.ASSET_COA_ACCT_CD
        FROM
                ASSET_BOOK_CTRL ABC
        WHERE
                ABC.GLBL_CMPY_CD       = #glblCmpyCd#
        AND     ABC.ASSET_TP_CD        = #assetTpCd#
        AND     ABC.EFF_FROM_DT    &lt;= #effFromDt#
        AND    (
                   ABC.EFF_THRU_DT &gt;= #effThruDt#
                OR ABC.EFF_THRU_DT IS NULL
               )
        AND     ABC.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getParentDsAssetMaster" parameterClass="Map" resultClass="Map">
        SELECT
                 ABC.DEPC_COA_ACCT_CD
                ,ABC.ASSET_COA_ACCT_CD
        FROM
                ASSET_BOOK_CTRL ABC
        WHERE
                ABC.GLBL_CMPY_CD       = #glblCmpyCd#
        AND     ABC.ASSET_TP_CD        = #assetTpCd#
        AND     ABC.EFF_FROM_DT    &lt;= #effFromDt#
        AND    (
                   ABC.EFF_THRU_DT &gt;= #effThruDt#
                OR ABC.EFF_THRU_DT IS NULL
               )
        AND     ABC.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getParentAssetMstrForMerge" parameterClass="Map" resultClass="Map">
        SELECT
             DAM.DS_ASSET_MSTR_PK
            ,DAM.GLBL_CMPY_CD
            ,DAM.EZTABLEID
            ,DAM.EZCANCELFLAG
            ,DAM.EZINTIME
            ,DAM.EZINTIMEZONE
            ,DAM.EZINCOMPANYCODE
            ,DAM.EZINUSERID
            ,DAM.EZINAPLID
            ,DAM.EZUPTIME
            ,DAM.EZUPTIMEZONE
            ,DAM.EZUPCOMPANYCODE
            ,DAM.EZUPUSERID
            ,DAM.EZUPAPLID
            ,DAM.MDSE_CD
            ,DAM.SER_NUM
            ,DAM.ACTV_ASSET_FLG
            ,DAM.ASSET_TP_CD
            ,DAM.SVC_MACH_MSTR_PK
            ,DAM.SHPG_PLN_NUM
            ,DAM.INIT_BOOK_AMT
            ,DAM.ORIG_INIT_BOOK_AMT
            ,DAM.DEPC_MTH_NUM
            ,DAM.DEPC_START_DT
            ,DAM.DEPC_CNT
            ,DAM.CUR_VAL_AMT
            ,DAM.SLS_REP_TOC_CD
            ,DAM.FIRST_DEPC_YR_MTH
            ,DAM.LAST_DEPC_YR_MTH
            ,DAM.RSDL_VAL_AMT
            ,DAM.REV_RECOG_DT
            ,DAM.DEPC_STOP_DT
            ,DAM.DEPC_RE_START_DT
            ,DAM.INVTY_TRX_PK
            ,DAM.ORIG_INVTY_TRX_PK
            ,DAM.ASSET_STS_CD
            ,DAM.RTRN_WH_CD
            ,DAM.CPO_ORD_NUM
            ,DAM.CPO_DTL_LINE_NUM
            ,DAM.CPO_DTL_LINE_SUB_NUM
            ,DAM.DS_ORD_POSN_NUM
            ,DAM.SHIP_TO_CUST_ACCT_CD
            ,DAM.SHIP_TO_CUST_CD
            ,DAM.SELL_TO_CUST_CD
            ,DAM.SLD_TO_CUST_LOC_CD
            ,DAM.AP_VND_INV_NUM
            ,DAM.INV_DT
            ,DAM.MDSE_TP_CD
            ,DAM.PRNT_DS_ASSET_MSTR_PK
            ,DAM.VND_CD
            ,DAM.VND_NM
            ,DAM.PO_ORD_NUM
            ,DAM.DS_ASSET_DESC_TXT
            ,DAM.CONTR_EFF_FROM_DT
            ,DAM.MAN_ENTRY_FLG
            ,DAM.ASSET_TAG_NUM
            ,DAM.ORIG_STD_COST_AMT
            ,DAM.ORIG_CSMP_PRC_AMT
            ,DAM.ORIG_ORD_ADJ_AMT
            ,DAM.ASSET_COST_SPL_PCT
            ,DAM.BAT_CALC_CSMP_PRC_AMT
            ,DAM.BAT_CALC_ORD_PRC_AMT
            ,DAM.BAT_CALC_ASSET_ADJ_PRC_AMT
            ,DAM.BAT_CALC_INIT_BOOK_AMT
            ,DAM.ASSET_CALC_STS_CD
            ,DAM.BASE_CMPT_FLG
            ,DAM.ASSET_POST_FLG
            ,DAM.SVC_CONFIG_MSTR_PK
            ,DAM.ASG_DTL_CMNT_TXT
            ,DAM.FIN_DTL_CMNT_TXT
            ,DAM.FIRST_LINE_ADDR
            ,DAM.SCD_LINE_ADDR
            ,DAM.THIRD_LINE_ADDR
            ,DAM.FRTH_LINE_ADDR
            ,DAM.CTY_ADDR
            ,DAM.ST_CD
            ,DAM.POST_CD
            ,DAM.ASSET_LEASE_NUM
            ,DAM.LEASE_START_DT
            ,DAM.LEASE_END_DT
            ,DAM.PROC_MODE_CD
            ,DAM.TOT_ASSET_QTY
            ,DAM.EXP_COA_CMPY_CD
            ,DAM.EXP_COA_BR_CD
            ,DAM.EXP_COA_CC_CD
            ,DAM.EXP_COA_ACCT_CD
            ,DAM.EXP_COA_PROD_CD
            ,DAM.EXP_COA_CH_CD
            ,DAM.EXP_COA_AFFL_CD
            ,DAM.EXP_COA_PROJ_CD
            ,DAM.EXP_COA_EXTN_CD
            ,DAM.ASSET_COA_CMPY_CD
            ,DAM.ASSET_COA_BR_CD
            ,DAM.ASSET_COA_CC_CD
            ,DAM.ASSET_COA_ACCT_CD
            ,DAM.ASSET_COA_PROD_CD
            ,DAM.ASSET_COA_CH_CD
            ,DAM.ASSET_COA_AFFL_CD
            ,DAM.ASSET_COA_PROJ_CD
            ,DAM.ASSET_COA_EXTN_CD
            ,DAM.ASSET_RTIRE_RSN_CMNT_TXT
            ,DAM.LAST_BILL_DT
            ,DAM.BLLG_INV_NUM
            ,DAM.PRCD_FROM_SLS_AMT
            ,DAM.RMV_COST_AMT
            ,DAM.COA_MDSE_TP_CD
            ,DAM.DS_CONTR_NUM
            ,DAM.CONTR_EFF_THRU_DT
            ,DAM.CUST_ISS_PO_NUM
            ,DAM.DTL_CMNT_TXT
            ,DAM.AMT_CHNG_RSN_TP_CD
            ,DAM.ADJ_COA_ACCT_CD
        FROM
            DS_ASSET_MSTR DAM
        WHERE
            DAM.GLBL_CMPY_CD          = #glblCmpyCd#
        AND DAM.PRNT_DS_ASSET_MSTR_PK = #prntDsAssetMstrPk#
        AND DAM.ACTV_ASSET_FLG        = #actvAssetFlgN#
        AND DAM.ASSET_POST_FLG        = #actvAssetFlgN#
        AND DAM.EZCANCELFLAG          = '0'
    </statement>

    <statement id="getLineAddr" parameterClass="Map" resultClass="Map">
    <!-- START 2018/03/20 T.Kikuhara [QC#20316,MOD] -->
        SELECT
             STC.SELL_TO_CUST_CD
            ,STC.SHIP_TO_CUST_CD
            ,STC.FIRST_LINE_ADDR
            ,STC.SCD_LINE_ADDR
            ,STC.THIRD_LINE_ADDR
            ,STC.FRTH_LINE_ADDR
            ,STC.CTY_ADDR
            ,STC.ST_CD
            ,STC.POST_CD
        FROM
             CM_AP_INV_HDR       CAIH
            ,PO_DTL              PD
            ,SHIP_TO_CUST        STC
        WHERE
            CAIH.GLBL_CMPY_CD   = #glblCmpyCd#
        AND CAIH.AP_VND_INV_NUM = #apVndInvNum#
        AND CAIH.EZCANCELFLAG   = '0'
        AND CAIH.GLBL_CMPY_CD   = PD.GLBL_CMPY_CD
        AND CAIH.PO_NUM         = PD.PO_ORD_NUM
        AND PD.EZCANCELFLAG     = '0'
        AND PD.GLBL_CMPY_CD     = STC.GLBL_CMPY_CD
        AND PD.SHIP_TO_CUST_CD  = STC.SHIP_TO_CUST_CD
        AND STC.EZCANCELFLAG    = '0'
        AND ROWNUM = 1
    <!-- END 2018/03/20 T.Kikuhara [QC#20316,MOD] -->
    </statement>
    <statement id="getCoaSegments" parameterClass="Map" resultClass="Map">
        SELECT
            BC.ASSET_TP_CD
          , BC.ASSET_COA_ACCT_CD
          , CASE WHEN CB.COA_BR_TP_CD = #newcore# THEN TDSS.COA_BR_CD ELSE #defBrNewcore#      END AS DEF_ASSET_COA_BR_CD
          , CASE WHEN CB.COA_BR_TP_CD = #newcore# THEN TDSS.COA_CC_CD ELSE LBT.ASSET_COA_CC_CD END AS DEF_ASSET_COA_CC_CD
          , TDSS.COA_EXTN_CD        AS DEF_EXP_COA_EXTN_CD
          , TDSS.COA_BR_CD          AS DEF_EXP_COA_BR_CD
          , TDSS.COA_CC_CD          AS DEF_EXP_COA_CC_CD
        FROM
            DS_ASSET_STGNG    DAS
           ,TOC_DLY_SNAP_SHOT TDSS
           ,COA_BR            CB
           ,ASSET_BOOK_CTRL   BC
           ,CPO                C
           ,DS_ORD_TP_PROC_DFN OTP
           ,LINE_BIZ_TP        LBT
        WHERE
            DAS.GLBL_CMPY_CD            = #glblCmpyCd#
        AND DAS.DS_ASSET_STGNG_PK       = #dsAssetStgngPk#
        AND DAS.EZCANCELFLAG            = '0'
        AND DAS.GLBL_CMPY_CD            = TDSS.GLBL_CMPY_CD
        AND DAS.SLS_REP_TOC_CD          = TDSS.TOC_CD
        AND TDSS.EZCANCELFLAG           = '0'
        AND TDSS.GLBL_CMPY_CD           = CB.GLBL_CMPY_CD
        AND TDSS.COA_BR_CD              = CB.COA_BR_CD
        AND CB.EZCANCELFLAG             = '0'
        AND DAS.GLBL_CMPY_CD            = C.GLBL_CMPY_CD
        AND DAS.CPO_ORD_NUM             = C.CPO_ORD_NUM
        AND C.EZCANCELFLAG              = '0'
        AND C.GLBL_CMPY_CD              = OTP.GLBL_CMPY_CD
        AND C.DS_ORD_TP_CD              = OTP.DS_ORD_TP_CD
        AND OTP.EZCANCELFLAG            = '0'
        AND OTP.GLBL_CMPY_CD            = LBT.GLBL_CMPY_CD
        AND OTP.LINE_BIZ_TP_CD          = LBT.LINE_BIZ_TP_CD
        AND LBT.EZCANCELFLAG            = '0'
        AND BC.GLBL_CMPY_CD             = TDSS.GLBL_CMPY_CD
        AND BC.ASSET_TP_CD              = #assetTpCd#
        AND BC.EFF_FROM_DT          &lt;= #slsDt#
        AND (
              BC.EFF_THRU_DT        &gt;= #slsDt#
           OR BC.EFF_THRU_DT IS NULL
            )
        AND BC.EZCANCELFLAG             = '0'
    </statement>

    <statement id="getDefaultCoaList" parameterClass="Map" resultClass="Map">
        SELECT 
              -- at CUST-ACCT
              AC.COA_CMPY_CD             AS "CUST-ACCT_CMPY_CD"
            , AC.COA_BR_CD               AS "CUST-ACCT_BR_CD"
            , AC.COA_CC_CD               AS "CUST-ACCT_CC_CD"
            , AC.COA_ACCT_CD             AS "CUST-ACCT_ACCT_CD"
            , AC.COA_CH_CD               AS "CUST-ACCT_CH_CD"
            , AC.COA_PROD_CD             AS "CUST-ACCT_PROD_CD"
            , AC.COA_AFFL_CD             AS "CUST-ACCT_AFFL_CD"
            , AC.COA_PROJ_CD             AS "CUST-ACCT_PROJ_CD"
            , AC.COA_EXTN_CD             AS "CUST-ACCT_EXTN_CD"

          FROM 
              SELL_TO_CUST         AC
         WHERE 
               AC.GLBL_CMPY_CD           = #glblCmpyCd#
           AND AC.SELL_TO_CUST_CD        = #sellToCustCd#
           AND AC.EZCANCELFLAG           = '0'
           AND ROWNUM = 1
    </statement>
    
    <statement id="getAmount" parameterClass="Map" resultClass="Map">
        SELECT NVL(SUM(DAM.INIT_BOOK_AMT), 0)   AS INIT_BOOK_AMT
             , NVL(SUM(DAM.CUR_VAL_AMT) , 0)    AS CUR_VAL_AMT 
        FROM DS_ASSET_MSTR DAM 
        WHERE 
             DAM.GLBL_CMPY_CD            = #glblCmpyCd#
        AND  DAM.PRNT_DS_ASSET_MSTR_PK   = #prntDsAssetMstrPk#
        AND  DAM.EZCANCELFLAG = '0'
    </statement>
</sqlMap>
