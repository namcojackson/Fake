<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="ZZVL0020Query">

	<typeAlias alias="ZZVL0020_CSMsg"	type="business.blap.ZZVL0020.ZZVL0020_CSMsg"/>
	
	<statement id="getRoleList" parameterClass="Map" resultMap="result.ZZVL0020_CSMsg">
		SELECT
				ROLE_NM
			,	ROLE_DESC_TXT
			,	SETTING_EXIST
		FROM
		(
			SELECT
					R.ROLE_NM	AS ROLE_NM
				,	R.ROLE_DESC_TXT	AS ROLE_DESC_TXT
				,	(CASE WHEN MP.UP_TAB_CD IS NOT NULL
						THEN 'Y' ELSE 'N' END) AS SETTING_EXIST
			FROM
				ROLE R
				, (	SELECT
						MP.UP_TAB_CD	AS UP_TAB_CD
					,	MP.USR_NM		AS USR_NM
					FROM
						MY_PROC MP
					WHERE
						MP.GLBL_CMPY_CD = #cMsg.glblCmpyCd_1#
						AND MP.EZCANCELFLAG = '0'
						AND MP.UP_TAB_OP_SORT_NUM = '0') MP
			WHERE
				R.GLBL_CMPY_CD  = #cMsg.glblCmpyCd_1#
				AND R.EZCANCELFLAG  = '0'
				<isNotNull property="cMsg.roleNm_1">
				AND R.ROLE_NM LIKE #cMsg.roleNm_1#
				</isNotNull>
				AND R.ROLE_NM = MP.USR_NM(+)
			ORDER BY
				R.ROLE_NM ASC
		)
		WHERE
			ROWNUM &lt;= #rowNum#
	</statement>
	
	<statement id="findProcessInfoData" parameterClass="Map" resultClass="Map">
        SELECT  MEN.MENU_PROC_NM           AS MENU_PROC_NM
               ,TAB.UP_TAB_CD              AS UP_TAB_CD
               ,TAB.UP_TAB_NM              AS UP_TAB_NM
               ,TAB.BIZ_APP_ID             AS BIZ_APP_ID
               ,TAB.BIZ_APP_NM             AS BIZ_APP_NM
               ,GRP.MENU_PROC_GRP_CD       AS MENU_PROC_GRP_CD
               ,MEN.MENU_PROC_ID           AS MENU_PROC_ID
               ,GRP.MENU_PROC_GRP_SORT_NUM AS MENU_PROC_GRP_SORT_NUM
               ,TAB.UP_TAB_OP_SORT_NUM     AS UP_TAB_OP_SORT_NUM
        FROM    UP_TAB          TAB
               ,UP_TAB_RELN     REL
               ,MENU_PROC       MEN
               ,MENU_PROC_RELN  RNM
               ,MENU_PROC_GRP   GRP
        WHERE   GRP.GLBL_CMPY_CD      = #GLBL_CMPY_CD#
          AND   GRP.EZCANCELFLAG      = '0'
          AND   RNM.GLBL_CMPY_CD_G0   = GRP.GLBL_CMPY_CD
          AND   RNM.MENU_PROC_GRP_CD  = GRP.MENU_PROC_GRP_CD
          AND   RNM.EZCANCELFLAG      = '0'         
          AND   MEN.GLBL_CMPY_CD      = RNM.GLBL_CMPY_CD_P0
          AND   MEN.MENU_PROC_ID      = RNM.MENU_PROC_ID
          AND   MEN.EZCANCELFLAG      = '0'
          AND   REL.GLBL_CMPY_CD_P0   = MEN.GLBL_CMPY_CD
          AND   REL.MENU_PROC_ID      = MEN.MENU_PROC_ID
          AND   REL.EZCANCELFLAG      = '0'
          AND   TAB.GLBL_CMPY_CD      = REL.GLBL_CMPY_CD_T0
          AND   TAB.UP_TAB_CD         = REL.UP_TAB_CD
          AND   TAB.MY_PROC_USBLE_FLG = 'Y'
          AND   TAB.EZCANCELFLAG      = '0'
        ORDER BY
                GRP.MENU_PROC_GRP_SORT_NUM
               ,MEN.MENU_PROC_ID
               ,REL.UP_TAB_SORT_NUM
               ,TAB.UP_TAB_OP_SORT_NUM
               ,TAB.UP_TAB_CD
    </statement>

    <statement id="findSharedMyProc" parameterClass="Map" resultClass="Map">
        SELECT  TAB.UP_TAB_CD          AS UP_TAB_CD
               ,TAB.UP_TAB_NM          AS UP_TAB_NM
               ,TAB.BIZ_APP_ID         AS BIZ_APP_ID
               ,TAB.BIZ_APP_NM         AS BIZ_APP_NM
               ,TAB.MY_PROC_USBLE_FLG  AS MY_PROC_USBLE_FLG
               ,MEN.MENU_PROC_NM       AS MENU_PROC_NM
        FROM
                MY_PROC         MYP
               ,UP_TAB          TAB
               ,UP_TAB_RELN     REL
               ,MENU_PROC       MEN
        WHERE
                MYP.GLBL_CMPY_CD      = #GLBL_CMPY_CD#
          AND   MYP.USR_CMPY_CD       = #USR_CMPY_CD#
          AND   MYP.USR_NM            = #ROLE_NM#
          AND   MYP.EZCANCELFLAG      = '0'
          AND   TAB.GLBL_CMPY_CD      = MYP.GLBL_CMPY_CD
          AND   TAB.UP_TAB_CD         = MYP.UP_TAB_CD
          AND   TAB.EZCANCELFLAG      = '0'
          AND   REL.GLBL_CMPY_CD_T0   = TAB.GLBL_CMPY_CD
          AND   REL.UP_TAB_CD         = TAB.UP_TAB_CD
          AND   REL.EZCANCELFLAG      = '0'
          AND   MEN.GLBL_CMPY_CD      = REL.GLBL_CMPY_CD_P0
          AND   MEN.MENU_PROC_ID      = REL.MENU_PROC_ID
          AND   MEN.EZCANCELFLAG      = '0'
        ORDER BY
                MYP.UP_TAB_OP_SORT_NUM
    </statement>
    
    <statement id="findRoleBizApp" parameterClass="Map" resultClass="Map">
        SELECT  DISTINCT  (RO.RESRC_OBJ_NM)
        FROM
                ROLE           R,
                APP            APP,
                RESRC_ROLE     RR,
                PROT_RESRC     PR,
                PROT_RESRC_OBJ PRO,
                RESRC_OBJ      RO,
                PMSN           PMSN,
                PMSN_TP        PMSN_TP,
                RESRC_CLS      RCLS
        WHERE
                R.ROLE_NM	          = #ROLE_NM#
          AND   R.GLBL_CMPY_CD        = #GLBL_CMPY_CD#
          AND   R.ROLE_ID             = RR.ROLE_ID
          AND   R.APP_ID              = APP.APP_ID
          AND   RR.PROT_RESRC_ID      = PR.PROT_RESRC_ID
          AND   PR.PROT_RESRC_ID      = PRO.PROT_RESRC_ID
          AND   PR.APP_ID             = APP.APP_ID
          AND   PRO.RESRC_OBJ_ID      = RO.RESRC_OBJ_ID
          AND   RO.APP_ID             = APP.APP_ID
          AND   PMSN.PMSN_ID          = PRO.PMSN_ID
          AND   PMSN.PMSN_TP_ID       = PMSN_TP.PMSN_TP_ID
          AND   RCLS.RESRC_CLS_ID     = RO.RESRC_CLS_ID
          AND   RCLS.RESRC_CLS_NM     = 'BIZ_APP'
          AND   R.EZCANCELFLAG        = '0'
          AND   RO.EZCANCELFLAG       = '0'
          AND   PR.EZCANCELFLAG       = '0'
          AND   PRO.EZCANCELFLAG      = '0'
    </statement>
	
	<resultMap id="result.ZZVL0020_CSMsg" class="ZZVL0020_CSMsg">
		<result property="roleNm_C"			column="ROLE_NM"		javaType="EZDSStringItem"/>
		<result property="roleDescTxt_C"	column="ROLE_DESC_TXT"	javaType="EZDSStringItem"/>
		<result property="xxSetFlg_C"		column="SETTING_EXIST"	javaType="EZDSStringItem"/>
	</resultMap>
	
</sqlMap>