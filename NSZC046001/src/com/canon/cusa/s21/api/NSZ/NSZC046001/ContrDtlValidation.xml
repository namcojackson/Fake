<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="ContrDtlValidation">
    <statement id="getMachMstrByAcc" parameterClass="Map" resultClass="java.math.BigDecimal">
        SELECT
            MACH.SVC_MACH_MSTR_PK
        FROM
            SVC_MACH_MSTR ACC
            ,SVC_MACH_MSTR MACH
        WHERE
                ACC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND ACC.EZCANCELFLAG        = '0'
            AND ACC.SVC_MACH_MSTR_PK    = #svcMachMstrPk#
            AND ACC.GLBL_CMPY_CD        = MACH.GLBL_CMPY_CD
            AND MACH.EZCANCELFLAG       = '0'
            AND ACC.SVC_CONFIG_MSTR_PK  = MACH.SVC_CONFIG_MSTR_PK
            AND MACH.SVC_MACH_TP_CD     = #machine#
    </statement>
    <statement id="getDsContrDtlStsV" parameterClass="Map" resultClass="Map">
        SELECT
             A.DS_CONTR_CTRL_STS_CD
            ,A.DS_CONTR_CTRL_STS_NM
        FROM
            DS_CONTR_DTL_STS_V A
        WHERE
            A.GLBL_CMPY_CD      = #glblCmpyCd#
        AND A.EZCANCELFLAG      = '0'
        AND A.DS_CONTR_DTL_PK   = #dsContrDtlPk#
    </statement>
    <!-- START 2017/06/14 N.Arai [QC#18930, MOD] -->
    <statement id="getDsContrDtlSts" parameterClass="Map" resultClass="Map">
        SELECT
             A.DS_CONTR_DTL_STS_CD
            ,B.DS_CONTR_DTL_STS_NM
        FROM
             DS_CONTR_DTL A
            ,DS_CONTR_DTL_STS B
        WHERE
            A.GLBL_CMPY_CD          = #glblCmpyCd#
        AND A.EZCANCELFLAG          = '0'
        AND A.DS_CONTR_DTL_PK       = #dsContrDtlPk#
        AND A.GLBL_CMPY_CD          = B.GLBL_CMPY_CD
        AND A.DS_CONTR_DTL_STS_CD   = B.DS_CONTR_DTL_STS_CD
        AND B.EZCANCELFLAG          = '0'
    </statement>
    <!-- END 2017/06/14 N.Arai [QC#18930, MOD] -->
    <statement id="checkDuplicateMachIncContract" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(A.DS_CONTR_DTL_PK) AS CNT
        FROM
            DS_CONTR_DTL A
        WHERE
            A.GLBL_CMPY_CD        = #glblCmpyCd#
        AND A.EZCANCELFLAG        = '0'
        AND A.DS_CONTR_PK         = #dsContrPk#
        AND A.SVC_MACH_MSTR_PK    = #svcMachMstrPk#
        AND A.DS_CONTR_DTL_STS_CD NOT IN (#canc#, #trmd#, #expd#)
    </statement>
    <statement id="checkParentMachineExistDBForAccessory" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(DCD.DS_CONTR_DTL_PK) CNT
        FROM
            DS_CONTR_DTL DCD
        WHERE 
            DCD.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCD.DS_CONTR_PK        = #dsContrPk#
            AND DCD.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
            AND DCD.DS_CONTR_DTL_TP_CD &lt;&gt; #accessories#
            AND DCD.EZCANCELFLAG       = '0'
    </statement>
</sqlMap>