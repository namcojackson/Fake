<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NPZC126001">
    <statement id="getRemanOrder" parameterClass="Map" resultClass="Map">
        SELECT
            R.RMNF_MAIN_UNIT_MDSE_CD
            ,R.RMNF_MAIN_UNIT_SER_NUM
            ,R.RMNF_MDL_ID
        FROM
            RMNF_ORD R
        WHERE
                R.GLBL_CMPY_CD    = #glblCmpyCd#
            AND R.RMNF_ORD_NUM    = #rmnfOrdNum#
<!--             AND R.RMNF_ORD_STS_CD = #rmnfOrdSts# -->
            <iterate property="rmnfOrdSts" var="elem[]" open="AND RMNF_ORD_STS_CD IN(" close=")" conjunction=",">
                #elem[]#
            </iterate>
            AND R.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getSO" parameterClass="Map" resultClass="Map">
        SELECT
            H.TRX_SRC_TP_CD
            ,H.SCE_ORD_TP_CD
            ,D.TRX_HDR_NUM
            ,D.TRX_LINE_NUM
            ,D.TRX_LINE_SUB_NUM
        FROM
            SHPG_ORD      H
            ,SHPG_ORD_DTL D
        WHERE
                H.GLBL_CMPY_CD  = #glblCmpyCd#
            AND H.SO_NUM        = #soNum#
            AND H.GLBL_CMPY_CD  = D.GLBL_CMPY_CD
            AND H.SO_NUM        = D.SO_NUM
            <isNotNull property="soSlpNum">
                AND D.SO_SLP_NUM    = #soSlpNum#
            </isNotNull>
            AND H.EZCANCELFLAG  = '0'
            AND D.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getPrtReqForCancel" parameterClass="Map" resultClass="Map">
        SELECT
            RMNF_PRT_REQ_PK
        FROM
            RMNF_PRT_REQ
        WHERE
            GLBL_CMPY_CD  = #glblCmpyCd#
        AND RMNF_ORD_NUM  = #rmnfOrdNum#
        AND SO_NUM        = #soNum#
        AND EZCANCELFLAG  = '0'
    </statement>

    <statement id="getRmnfToCmptMdseCd" parameterClass="Map" resultClass="String">
        SELECT 
            RD.RMNF_TO_CMPT_MDSE_CD
        FROM 
            RMNF_ORD     RO
           ,RMNF_ORD_DTL RD
        WHERE 1 = 1
        AND RO.GLBL_CMPY_CD           = #glblCmpyCd#
        AND RO.RMNF_ORD_NUM           = #rmnfOrdNum#
        AND RO.EZCANCELFLAG           = '0'
        AND RO.RMNF_ORD_NUM           = RD.RMNF_ORD_NUM
        AND RO.RMNF_MAIN_UNIT_MDSE_CD = RD.CMPT_MDSE_CD
        AND RO.GLBL_CMPY_CD           = RD.GLBL_CMPY_CD
        AND RD.EZCANCELFLAG           = '0'
    </statement>

    <statement id="getAssetRecovCostAmt" parameterClass="Map" resultClass="BigDecimal">
        SELECT 
            NVL (SUM(RU.ASSET_RECOV_COST_AMT) , 0) AS CAL_ASSET_RECOV_COST_AMT
        FROM 
            RMNF_USG  RU
        WHERE 1=1
        AND RU.EZCANCELFLAG  = '0'
        AND RU.GLBL_CMPY_CD  = #glblCmpyCd#
        AND RMNF_ORD_NUM     = #rmnfOrdNum#
    </statement>

    <statement id="getRmnfPrtUsgCostAmt" parameterClass="Map" resultClass="BigDecimal">
        SELECT 
            NVL (SUM( R.RMNF_PRT_QTY * M.THIS_MTH_TOT_STD_COST_AMT) , 0 ) AS CAL_RMNF_PRT_USG_COST_AMT
        FROM
            RMNF_USG R
           ,MDSE     M
        WHERE 1 = 1
        AND R.EZCANCELFLAG  = '0'
        AND R.GLBL_CMPY_CD  = #glblCmpyCd#
        AND R.MDSE_CD       = M.MDSE_CD
        AND R.RMNF_ORD_NUM  = #rmnfOrdNum#
         <isNotNull property="rmnfTaskNum" >
        AND R.RMNF_TASK_NUM = #rmnfTaskNum#
         </isNotNull>
        AND R.GLBL_CMPY_CD  = M.GLBL_CMPY_CD
        AND M.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getRmnTotLborCostAmt" parameterClass="Map" resultClass="BigDecimal">
        SELECT 
            NVL (SUM(RT.RMNF_COST_PER_HOUR_AMT * RT.RMNF_LBOR_AOT) , 0 ) AS CAL_RMNF_TOT_LBOR_COST_AMT
        FROM 
            RMNF_TASK RT
        WHERE 1=1
        AND RT.RMNF_ORD_NUM      = #rmnfOrdNum#
        AND RT.GLBL_CMPY_CD      = #glblCmpyCd#
         <isNotNull property="rmnfTaskNum" >
        AND RT.RMNF_TASK_NUM     = #rmnfTaskNum#
         </isNotNull>
        AND RT.RMNF_TASK_STS_CD != #cancel#
        AND RT.EZCANCELFLAG      = '0'
    </statement>
</sqlMap>