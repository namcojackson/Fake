<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL2200Query">

    <typeAlias alias="NWAL2200SMsg"    type="business.blap.NWAL2200.NWAL2200SMsg"/>
    <typeAlias alias="NWAL2200_ASMsg"  type="business.blap.NWAL2200.NWAL2200_ASMsg"/>

    <statement id="getOrdLineSrcDataList" parameterClass="Map" resultClass="Map">
        SELECT
             OLS.ORD_LINE_SRC_CD
            ,OLS.ORD_LINE_SRC_CATG_CD
            ,OLS.SRC_PRNT_VND_CD
            ,OLS.ORD_LINE_SRC_NM
            ,OLS.ORD_LINE_SRC_SORT_NUM
        FROM
            ORD_LINE_SRC OLS
        WHERE
            OLS.GLBL_CMPY_CD    = #glblCmpyCd#
            <isNotNull property="ordLineSrcCatgCd">
                AND OLS.ORD_LINE_SRC_CATG_CD = #ordLineSrcCatgCd#
            </isNotNull>
            <isNotNull property="srcPrntVndCd">
                AND OLS.SRC_PRNT_VND_CD      = #srcPrntVndCd#
            </isNotNull>
            AND OLS.EZCANCELFLAG = '0'
        ORDER BY
            OLS.ORD_LINE_SRC_SORT_NUM
    </statement>

    <statement id="getDsImptOrdViewInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DIOV.DS_IMPT_ORD_PK
            ,DIOV.CPO_SRC_TP_CD
            ,DIOV.CPO_SRC_TP_DESC_TXT
            ,DIOV.ORD_SRC_IMPT_TS
            ,DIOV.ORD_SRC_REF_NUM
            ,DIOV.IMPT_STS_CD
            ,DIOV.IMPT_STS_DESC_TXT
            ,DIO.CPO_ORD_NUM
            ,DIOV.SYS_SRC_CD
            ,DIOV.DS_ORD_CATG_CD
            ,DIOV.DS_ORD_CATG_DESC_TXT
            ,DIOV.DS_ORD_TP_CD
            ,DIOV.DS_ORD_TP_DESC_TXT
            ,DIOV.LINE_BIZ_TP_CD
            ,DIOV.DS_ORD_RSN_CD
            ,DIOV.DS_ORD_RSN_DESC_TXT
            ,DIOV.CPO_ORD_TP_CD
            ,DIOV.CUST_ISS_PO_NUM
            ,DIOV.CUST_ISS_PO_DT
            ,DIOV.BILL_TO_CUST_ACCT_CD
            ,DIOV.BILL_TO_CUST_ACCT_NM
            ,DIOV.BILL_TO_CUST_CD
            ,DIOV.BILL_TO_CUST_LOC_ADDR
            ,DIOV.SHIP_TO_CUST_ACCT_CD
            ,DIOV.SHIP_TO_CUST_ACCT_NM
            ,DIOV.SHIP_TO_CUST_CD
            ,DIOV.SHIP_TO_CUST_LOC_ADDR
            ,DIOV.DROP_SHIP_FLG
            ,DIOV.SHIP_TO_LOC_NM
            ,DIOV.SHIP_TO_ADDL_LOC_NM
            ,DIOV.SHIP_TO_FIRST_LINE_ADDR
            ,DIOV.SHIP_TO_SCD_LINE_ADDR
            ,DIOV.SHIP_TO_THIRD_LINE_ADDR
            ,DIOV.SHIP_TO_FRTH_LINE_ADDR
            ,DIOV.SHIP_TO_CTY_ADDR
            ,DIOV.SHIP_TO_ST_CD
            ,DIOV.SHIP_TO_PROV_NM
            ,DIOV.SHIP_TO_CNTY_NM
            ,DIOV.SHIP_TO_POST_CD
            ,DIOV.SHIP_TO_CTRY_CD
            ,DIOV.SHIP_TO_01_REF_CMNT_TXT
            ,DIOV.SHIP_TO_02_REF_CMNT_TXT
            ,DIOV.SELL_TO_CUST_CD
            ,DIOV.SOLD_TO_CUST_ACCT_NM
            ,DIOV.SOLD_TO_CUST_LOC_CD
            ,DIOV.SOLD_TO_CUST_LOC_ADDR
            ,DIOV.ADMIN_PSN_CD
            ,DIOV.RDD_DT
            ,DIOV.FRT_COND_CD
            ,DIOV.FRT_COND_DESC_TXT
            ,DIOV.SPCL_HDLG_TP_CD
            ,DIOV.SPCL_HDLG_TP_DESC_TXT
            ,DIOV.CARR_CD
            ,DIOV.CARR_SVC_LVL_CD
            ,DIOV.CARR_SVC_LVL_DESC_TXT
            ,DIOV.SHPG_SVC_LVL_CD
            ,DIOV.SHPG_SVC_LVL_DESC_TXT
            ,DIOV.FRT_CHRG_TO_CD
            ,DIOV.FRT_CHRG_METH_CD
            ,DIOV.CARR_ACCT_NUM
            ,DIOV.ADD_PMT_TERM_CASH_DISC_CD
            ,DIOV.PMT_TERM_CASH_DISC_DESC_TXT
            ,DIOV.DS_PMT_METH_CD
            ,DIOV.DS_PMT_METH_DESC_TXT
            ,DIOV.PRE_PMT_CHK_NUM
            ,DIOV.PRE_PMT_AMT
            ,DIOV.PRE_PMT_TP_CD
            ,DIOV.PRE_PMT_TP_DESC_TXT
            ,DIOV.PRC_BASE_DT
            ,DIOV.NEGO_DEAL_AMT
            ,DIOV.PRC_CATG_CD
            ,(
                SELECT
                    PRC_CATG_NM
                FROM
                    PRC_CATG PC
                WHERE
                        PC.GLBL_CMPY_CD    = DIOV.GLBL_CMPY_CD
                    AND PC.PRC_CATG_CD     = DIOV.PRC_CATG_CD
                    AND PC.EZCANCELFLAG    = DIOV.EZCANCELFLAG
             ) AS PRC_CATG_NM
            ,DIOV.FL_PRC_LIST_CD
            ,(
                SELECT
                    PRC_CATG_NM
                FROM
                    PRC_CATG PC
                WHERE
                        PC.GLBL_CMPY_CD    = DIOV.GLBL_CMPY_CD
                    AND PC.PRC_CATG_CD     = DIOV.FL_PRC_LIST_CD
                    AND PC.EZCANCELFLAG    = DIOV.EZCANCELFLAG
             ) AS FL_PRC_LIST_DESC_TXT
            ,DIOV.PRC_CONTR_NUM
            ,DIOV.CSMP_CONTR_NUM
            ,DIOV.DLR_REF_NUM
            ,DIOV.ORD_SGN_DT
            ,DIOV.AQU_NUM
            ,DIOV.SLS_REP_TOC_CD
            ,(
                SELECT
                    S21P.PSN_NUM
                FROM
                     ORG_FUNC_ASG OFA
                    ,S21_PSN S21P
                WHERE
                        OFA.GLBL_CMPY_CD    = DIOV.GLBL_CMPY_CD
                    AND OFA.TOC_CD          = DIOV.SLS_REP_TOC_CD
                    AND OFA.EZCANCELFLAG    = DIOV.EZCANCELFLAG
                    AND OFA.GLBL_CMPY_CD    = S21P.GLBL_CMPY_CD
                    AND OFA.EZCANCELFLAG    = S21P.EZCANCELFLAG
                    AND OFA.PSN_CD          = S21P.PSN_CD
                    AND ROWNUM              = 1
            ) AS SLS_REP_PSN_NUM
            ,DIOV.SLS_REP_TOC_NM
            ,DIOV.COA_BR_CD
            ,DIOV.COA_BR_DESC_TXT
            ,DIOV.COA_EXTN_CD
            ,DIOV.COA_EXTN_DESC_TXT
            ,DIOV.LOAN_PER_DAYS_AOT
            ,DIOV.LEASE_CMPY_PO_NUM
            ,DIOV.LEASE_PRCH_OPT_CD
            ,DIOV.LEASE_PRCH_OPT_DESC_TXT
            ,DIOV.LEASE_TERM_CD
            ,DIOV.LEASE_TERM_DESC_TXT
            ,DIOV.LEASE_PMT_FREQ_CD
            ,DIOV.LEASE_PMT_FREQ_DESC_TXT
            ,DIOV.LEASE_TERM_MTH_AOT
            ,DIOV.ORD_LOG_TP_CD
            ,DIOV.ORD_LOG_TP_DESC_TXT
            ,DIOV.CR_REBIL_RSN_CATG_CD
            ,DIOV.CR_REBIL_RSN_CATG_DESC_TXT
            ,DIOV.ORIG_ORD_NUM
            ,DIOV.SEND_INV_FLG
            ,DIOV.RE_BILL_PAIR_CPO_ORD_NUM
            ,DIOV.ORD_HDR_EDTBL_FLG
            ,DIOV.INV_CMNT_TXT
            ,DIO.DCLN_SVC_CD
            ,DIOV.EZUPTIME
            ,DIOV.EZUPTIMEZONE
            <!-- 2017/01/26 QC#17119 Add Start  -->
            ,DIOV.SHIP_TO_ACCT_NM 
            ,DIOV.BILL_TO_LOC_NM
            ,DIOV.BILL_TO_ADDL_LOC_NM
            ,DIOV.BILL_TO_PROV_NM
            ,DIOV.BILL_TO_CNTY_NM
            ,DIOV.BILL_TO_CTRY_CD
            ,DIOV.BILL_TO_ACCT_NM
            ,DIOV.SLD_TO_LOC_NM
            ,DIOV.SLD_TO_ADDL_LOC_NM
            ,DIOV.SLD_TO_PROV_NM
            ,DIOV.SLD_TO_CNTY_NM
            ,DIOV.SLD_TO_CTRY_CD
            ,DIOV.SLD_TO_ACCT_NM
            <!-- 2017/01/26 QC#17119 Add End  -->
            ,(
                 SELECT
                     NVL(SUM(DIOD.CPO_DTL_DEAL_NET_AMT), 0)
                 FROM
                     DS_IMPT_ORD_DTL DIOD
                 WHERE
                     DIO.GLBL_CMPY_CD = DIOD.GLBL_CMPY_CD
                 AND DIO.DS_IMPT_ORD_PK = DIOD.DS_IMPT_ORD_PK
                 AND DIOD.EZCANCELFLAG = '0'
             ) AS TOT_BASE_AMT_LN
            ,(
                 SELECT
                     NVL(SUM(DIORD.CPO_DTL_DEAL_NET_AMT), 0)
                 FROM
                     DS_IMPT_ORD_RTRN_DTL DIORD
                 WHERE
                     DIO.GLBL_CMPY_CD = DIORD.GLBL_CMPY_CD
                 AND DIO.DS_IMPT_ORD_PK = DIORD.DS_IMPT_ORD_PK
                 AND DIORD.EZCANCELFLAG = '0'
             ) AS TOT_BASE_AMT_RT
             <!-- 2018/01/29 S21_NA#23139 Mod Start -->
             ,(
                 SELECT
                     NVL(SUM(DISD.TOT_BASE_PRC_DEAL_AMT), 0)
                 FROM
                     DS_IMPT_SVC_DTL DISD
                 WHERE
                     DISD.GLBL_CMPY_CD = DIOV.GLBL_CMPY_CD
                 AND DIOV.DS_IMPT_ORD_PK = DISD.DS_IMPT_ORD_PK
                 AND DISD.BILL_WITH_EQUIP_FLG = 'Y'
                 AND DISD.EZCANCELFLAG = '0'
             ) AS TOT_BASE_AMT_SVC_PRC
             <!-- 
            ,(
                 SELECT
                     NVL(SUM(PRC.BASE_PRC_DEAL_AMT * (DISD.TO_PER_MTH_NUM - DISD.FROM_PER_MTH_NUM + 1)), 0)
                 FROM
                     DS_IMPT_SVC_PRC PRC
                 WHERE
                     PRC.GLBL_CMPY_CD = DISD.GLBL_CMPY_CD
                 AND PRC.DS_IMPT_SVC_DTL_PK IN(DISD.DS_IMPT_SVC_DTL_PK)
                 AND PRC.EZCANCELFLAG = '0'
             ) AS TOT_BASE_AMT_SVC_PRC
            ,(
                 SELECT
                     NVL(SUM(BASE.ADDL_BASE_PRC_DEAL_AMT * (DISD.TO_PER_MTH_NUM - DISD.FROM_PER_MTH_NUM + 1)), 0)
                 FROM
                     DS_IMPT_SVC_ADDL_BASE BASE
                 WHERE
                     BASE.GLBL_CMPY_CD = DISD.GLBL_CMPY_CD
                 AND BASE.DS_IMPT_SVC_DTL_PK IN(DISD.DS_IMPT_SVC_DTL_PK)
                 AND BASE.EZCANCELFLAG = '0'
             ) AS TOT_BASE_AMT_SVC_ADDL_BASE
            ,(
                 SELECT
                     NVL(SUM(CHRG.ADDL_CHRG_PRC_DEAL_AMT * (DISD.TO_PER_MTH_NUM - DISD.FROM_PER_MTH_NUM + 1)), 0)
                 FROM
                     DS_IMPT_SVC_ADDL_CHRG CHRG
                 WHERE
                     CHRG.GLBL_CMPY_CD = DISD.GLBL_CMPY_CD
                 AND CHRG.DS_IMPT_SVC_DTL_PK IN(DISD.DS_IMPT_SVC_DTL_PK)
                 AND CHRG.EZCANCELFLAG = '0'
             ) AS TOT_BASE_AMT_SVC_ADDL_CHRG -->
             <!-- 2018/01/29 S21_NA#23139 Mod End -->
        FROM
             DS_IMPT_ORD_V DIOV
            ,DS_IMPT_ORD DIO
            ,CPO DC
            <!-- ,DS_IMPT_SVC_DTL DISD  2018/01/29 S21_NA#23139 Del -->
        WHERE
                DIOV.GLBL_CMPY_CD    = #glblCmpyCd#
            <isNotNull property="ordSrcRefNum">
            AND DIOV.ORD_SRC_REF_NUM = #ordSrcRefNum#
            </isNotNull>
            <isNotNull property="dsImptOrdPk">
            AND DIOV.DS_IMPT_ORD_PK  = #dsImptOrdPk#
            </isNotNull>
            AND DIOV.EZCANCELFLAG    = '0'
            AND DIOV.EZCANCELFLAG    = DIO.EZCANCELFLAG
            AND DIOV.GLBL_CMPY_CD    = DIO.GLBL_CMPY_CD
            AND DIOV.DS_IMPT_ORD_PK  = DIO.DS_IMPT_ORD_PK
            AND DIO.GLBL_CMPY_CD     = DC.GLBL_CMPY_CD(+)
            AND DIO.ORD_SRC_REF_NUM  = DC.ORD_SRC_REF_NUM(+)
            AND DIO.CPO_ORD_NUM      = DC.CPO_ORD_NUM(+)
            AND DIO.EZCANCELFLAG     = DC.EZCANCELFLAG(+)
            <!-- 2018/01/29 S21_NA#23139 Del Start
            AND DIO.GLBL_CMPY_CD     = DISD.GLBL_CMPY_CD(+)
            AND DIO.DS_IMPT_ORD_PK   = DISD.DS_IMPT_ORD_PK(+)
            AND DIO.EZCANCELFLAG     = DISD.EZCANCELFLAG(+)
            AND DISD.BILL_WITH_EQUIP_FLG(+) = 'Y'
             2018/01/29 S21_NA#23139 Del End -->
            AND ROWNUM               = 1
    </statement>

    <statement id="getDsImptOrdConfigInfo" parameterClass="Map" resultClass="Map">
        <!-- Add Start 2017/09/19 QC#21118 -->
        SELECT
             DS_IMPT_ORD_CONFIG_PK
            ,DS_IMPT_ORD_PK
            ,DS_ORD_POSN_NUM
            ,CONFIG_CATG_CD
            ,CONFIG_TP_CD
            ,CONFIG_TP_DESC_TXT
            ,SVC_CONFIG_MSTR_PK
            ,MDL_ID
            ,T_MDL_NM
            ,ADDR_LB_TXT
            ,BILL_TO_CUST_ACCT_CD
            ,BILL_TO_CUST_LOC_CD
            ,BILL_TO_CUST_LOC_ADDR
            ,SHIP_TO_CUST_ACCT_CD
            ,SHIP_TO_CUST_LOC_CD
            ,DROP_SHIP_FLG
            ,DCLN_SVC_CD
            ,SHIP_TO_LOC_NM
            ,SHIP_TO_ADDL_LOC_NM
            ,SHIP_TO_FIRST_LINE_ADDR
            ,SHIP_TO_SCD_LINE_ADDR
            ,SHIP_TO_THIRD_LINE_ADDR
            ,SHIP_TO_FRTH_LINE_ADDR
            ,SHIP_TO_FIRST_REF_CMNT_TXT
            ,SHIP_TO_SCD_REF_CMNT_TXT
            ,SHIP_TO_CTY_ADDR
            ,SHIP_TO_ST_CD
            ,SHIP_TO_PROV_NM
            ,SHIP_TO_CNTY_NM
            ,SHIP_TO_POST_CD
            ,SHIP_TO_CTRY_CD
            ,SHIP_TO_CUST_LOC_ADD
            ,CONFIG_CRAT_TS
            ,SVC_SLN_SQ
            ,SVC_SLN_NM
            <!-- 2018/01/23 QC#18798 Add Start -->
            ,EMSD_IMPT_STS_CD
            <!-- 2018/01/23 QC#18798 Add End -->
            ,EZUPTIME
            ,EZUPTIMEZONE
        FROM (
            SELECT
                 DIOC.DS_IMPT_ORD_CONFIG_PK
                ,DIOC.DS_IMPT_ORD_PK
                ,DIOC.DS_ORD_POSN_NUM
                ,DIOC.CONFIG_CATG_CD
                ,DIOC.CONFIG_TP_CD
                ,CT.CONFIG_TP_DESC_TXT
                ,DIOC.SVC_CONFIG_MSTR_PK
                ,DIOC.MDL_ID
                ,MN.T_MDL_NM
                ,DIOC.ADDR_LB_TXT
                ,DIOC.BILL_TO_CUST_ACCT_CD
                ,DIOC.BILL_TO_CUST_LOC_CD
                , RPAD( 
                    BTC.FIRST_LINE_ADDR
                    , LENGTH(BTC.FIRST_LINE_ADDR) + 1
                ) || RPAD( 
                    BTC.SCD_LINE_ADDR
                    , LENGTH(BTC.SCD_LINE_ADDR) + 1
                ) || RPAD( 
                    BTC.THIRD_LINE_ADDR
                    , LENGTH(BTC.THIRD_LINE_ADDR) + 1
                ) || RPAD( 
                    BTC.FRTH_LINE_ADDR
                    , LENGTH(BTC.FRTH_LINE_ADDR) + 1
                ) || CONCAT(BTC.CTY_ADDR, ',') || RPAD(
                    BTC.ST_CD
                    , LENGTH(BTC.ST_CD) + 1
                ) || RPAD(
                    BTC.POST_CD
                    , LENGTH(BTC.POST_CD) + 1
                ) AS BILL_TO_CUST_LOC_ADDR 
                ,DIOC.SHIP_TO_CUST_ACCT_CD
                ,DIOC.SHIP_TO_CUST_LOC_CD
                ,DIOC.DROP_SHIP_FLG
                ,DIOC.DCLN_SVC_CD
                ,DIOC.SHIP_TO_LOC_NM
                ,DIOC.SHIP_TO_ADDL_LOC_NM
                ,DIOC.SHIP_TO_FIRST_LINE_ADDR
                ,DIOC.SHIP_TO_SCD_LINE_ADDR
                ,DIOC.SHIP_TO_THIRD_LINE_ADDR
                ,DIOC.SHIP_TO_FRTH_LINE_ADDR
                ,DIOC.SHIP_TO_FIRST_REF_CMNT_TXT
                ,DIOC.SHIP_TO_SCD_REF_CMNT_TXT
                ,DIOC.SHIP_TO_CTY_ADDR
                ,DIOC.SHIP_TO_ST_CD
                ,DIOC.SHIP_TO_PROV_NM
                ,DIOC.SHIP_TO_CNTY_NM
                ,DIOC.SHIP_TO_POST_CD
                ,DIOC.SHIP_TO_CTRY_CD
                , RPAD( 
                    DIOC.SHIP_TO_FIRST_LINE_ADDR
                    , LENGTH(DIOC.SHIP_TO_FIRST_LINE_ADDR) + 1
                ) || RPAD( 
                    DIOC.SHIP_TO_SCD_LINE_ADDR
                    , LENGTH(DIOC.SHIP_TO_SCD_LINE_ADDR) + 1
                ) || RPAD( 
                    DIOC.SHIP_TO_THIRD_LINE_ADDR
                    , LENGTH(DIOC.SHIP_TO_THIRD_LINE_ADDR) + 1
                ) || RPAD( 
                    DIOC.SHIP_TO_FRTH_LINE_ADDR
                    , LENGTH(DIOC.SHIP_TO_FRTH_LINE_ADDR) + 1
                ) || CONCAT(DIOC.SHIP_TO_CTY_ADDR, ',') || RPAD( 
                    DIOC.SHIP_TO_ST_CD
                    , LENGTH(DIOC.SHIP_TO_ST_CD) + 1
                ) || RPAD( 
                    DIOC.SHIP_TO_POST_CD
                    , LENGTH(DIOC.SHIP_TO_POST_CD) + 1
                ) AS SHIP_TO_CUST_LOC_ADD 
                ,DIOC.CONFIG_CRAT_TS
                ,DIOC.SVC_SLN_SQ
                ,DIOC.SVC_SLN_NM
                <!-- 2018/01/23 QC#18798 Add Start -->
                ,DIOC.EMSD_IMPT_STS_CD
                <!-- 2018/01/23 QC#18798 Add End -->
                ,DIOC.EZUPTIME
                ,DIOC.EZUPTIMEZONE
            FROM
                 DS_IMPT_ORD_CONFIG DIOC
                ,MDL_NM MN
                ,CONFIG_TP CT
                ,BILL_TO_CUST BTC 
            WHERE
                    DIOC.GLBL_CMPY_CD   = #glblCmpyCd#
                AND DIOC.DS_IMPT_ORD_PK = #dsImptOrdPk#
                AND DIOC.CONFIG_CATG_CD = #configCatgCd#
                AND DIOC.EZCANCELFLAG   = '0'
                AND DIOC.GLBL_CMPY_CD   = MN.T_GLBL_CMPY_CD(+)
                AND DIOC.MDL_ID         = MN.T_MDL_ID(+)
                AND DIOC.EZCANCELFLAG   = MN.EZCANCELFLAG(+)
                AND DIOC.GLBL_CMPY_CD   = CT.GLBL_CMPY_CD(+)
                AND DIOC.CONFIG_TP_CD   = CT.CONFIG_TP_CD(+)
                AND DIOC.EZCANCELFLAG   = CT.EZCANCELFLAG(+)
                AND DIOC.GLBL_CMPY_CD   = BTC.GLBL_CMPY_CD(+) 
                AND DIOC.BILL_TO_CUST_LOC_CD = BTC.BILL_TO_CUST_CD(+) 
                AND DIOC.EZCANCELFLAG   = BTC.EZCANCELFLAG(+) 
            ORDER BY
                LPAD(DIOC.DS_ORD_POSN_NUM, 4, '0')
        )
        WHERE
            ROWNUM &lt;= #rowNum#
        <!-- Mod End 2017/09/19 QC#21118 -->
    </statement>

    <statement id="getDsImptOrdDtlInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DS_IMPT_ORD_DTL_PK
            ,DS_IMPT_ORD_PK
            ,ORD_SRC_REF_LINE_NUM
            ,ORD_SRC_REF_LINE_SUB_NUM
            ,XX_SCR_ITEM_130_TXT
            ,MDSE_CD
            ,MDSE_NM
            ,COA_MDSE_TP_DESC_TXT
            ,COA_PROD_DESC_TXT
            ,ORIG_MDSE_CD
            ,ORIG_MDSE_NM
            ,SET_MDSE_CD
            ,DROP_SHIP_FLG
            ,SHIP_TO_CUST_CD
            ,SHIP_TO_LOC_NM
            ,SHIP_TO_ADDL_LOC_NM
            ,SHIP_TO_FIRST_LINE_ADDR
            ,SHIP_TO_SCD_LINE_ADDR
            ,SHIP_TO_THIRD_LINE_ADDR
            ,SHIP_TO_FRTH_LINE_ADDR
            ,SHIP_TO_FIRST_REF_CMNT_TXT
            ,SHIP_TO_SCD_REF_CMNT_TXT
            ,SHIP_TO_CTY_ADDR
            ,SHIP_TO_ST_CD
            ,SHIP_TO_PROV_NM
            ,SHIP_TO_CNTY_NM
            ,SHIP_TO_POST_CD
            ,SHIP_TO_CTRY_CD
            ,ORD_QTY
            ,ORD_CUST_UOM_QTY
            ,INVTY_LOC_CD
            ,PRC_CATG_CD
            ,PRC_CATG_NM
            ,FL_PRC_LIST_CD
            ,FL_PRC_LIST_DESC_TXT
            ,DEAL_PRC_LIST_PRC_AMT
            ,FUNC_PRC_LIST_PRC_AMT
            ,ENT_DEAL_NET_UNIT_PRC_AMT
            ,ENT_FUNC_NET_UNIT_PRC_AMT
            ,CPO_DTL_DEAL_NET_AMT
            ,CPO_DTL_DEAL_SLS_AMT
            ,CPO_DTL_FUNC_NET_AMT
            ,CPO_DTL_FUNC_SLS_AMT
            ,NVL(ENT_DEAL_NET_UNIT_PRC_AMT, 0) * NVL(ORD_QTY, 0) AS LINE_DEAL_SUB_TOT_AMT
            ,PRC_BASE_DT
            ,CCY_CD
            ,EXCH_RATE
            ,RDD_DT
            ,RSD_DT
            ,SHIP_CPLT_CD
            ,UOM_CPLT_FLG
            ,STK_STS_CD
            ,SLS_REP_OR_SLS_TEAM_TOC_CD
            ,CUST_MDSE_CD
            ,CUST_UOM_CD
            ,PKG_UOM_DESC_TXT
            ,EDI_STS_CD
            ,EDI_NUM
            ,EDI_SUB_NUM
            ,ORIG_CPO_ORD_NUM
            ,ORIG_INV_NUM
            ,SET_ITEM_SHIP_CPLT_FLG
            ,DS_ORD_POSN_NUM
            ,UNIT_NET_WT
            ,CONFIG_ITEM_FLG
            ,BASE_CMPT_FLG
            ,CUST_ISTL_FLG
            ,SVC_CONFIG_MSTR_PK
            ,SVC_MACH_MSTR_PK
            ,DS_CONTR_NUM
            ,DS_CONTR_SQ_NUM
            ,DS_IMPT_ORD_CONFIG_PK
            ,DS_ORD_LINE_CATG_CD
            ,ORD_LINE_SRC_CD
            ,RTL_WH_CD
            ,RTL_WH_NM
            ,RTL_SWH_CD
            ,RTL_SWH_NM
            ,SER_NUM
            ,REF_CPO_DTL_LINE_NUM
            ,REF_CPO_DTL_LINE_SUB_NUM
            ,DPLY_LINE_REF_NUM
            ,CR_REBIL_CD
            ,SPLY_TP_CD
            ,SPLY_NM
            ,SPLY_FIRST_ADDR
            ,SPLY_CTY_ADDR
            ,SPLY_ST_CD
            ,SPLY_POST_CD
            ,CSMP_CONTR_NUM
            ,DLR_REF_NUM
            ,CSMP_PRC_LIST_CD
            ,RNTL_TRMN_DT
            ,FIRST_BLLG_ATTRB_NM
            ,FIRST_BLLG_ATTRB_VAL_TXT
            ,SCD_BLLG_ATTRB_NM
            ,SCD_BLLG_ATTRB_VAL_TXT
            ,THIRD_BLLG_ATTRB_NM
            ,THIRD_BLLG_ATTRB_VAL_TXT
            ,FRTH_BLLG_ATTRB_NM
            ,FRTH_BLLG_ATTRB_VAL_TXT
            ,FIFTH_BLLG_ATTRB_NM
            ,FIFTH_BLLG_ATTRB_VAL_TXT
            ,SIXTH_BLLG_ATTRB_NM
            ,SIXTH_BLLG_ATTRB_VAL_TXT
            ,SBST_MDSE_CD
            ,SUPD_LOCK_FLG
            ,PRC_LIST_EQUIP_CONFIG_NUM
            ,IMPT_LINE_FLG
            ,FIN_ITEM_LINE_FLG
            ,EZUPTIME
            ,EZUPTIMEZONE
            ,MDSE_DESC_SHORT_TXT
            <!-- 2018/01/12 S21_NA#22372 Add Start -->
            ,FUNC_UNIT_FL_PRC_AMT
            <!-- 2018/01/12 S21_NA#22372 Add End -->
            <!-- 2019/10/04 S21_NA#51372 Add Start -->
            ,PRNT_VND_NM
            <!-- 2019/10/04 S21_NA#51372 Add End -->
        FROM (
            SELECT
                 DIOD.DS_IMPT_ORD_DTL_PK
                ,DIOD.DS_IMPT_ORD_PK
                ,DIOD.ORD_SRC_REF_LINE_NUM
                ,DIOD.ORD_SRC_REF_LINE_SUB_NUM
                ,CASE
                    WHEN ORD_SRC_REF_LINE_NUM IS NULL THEN NULL
                    WHEN ORD_SRC_REF_LINE_SUB_NUM IS NULL THEN ORD_SRC_REF_LINE_NUM
                    ELSE ORD_SRC_REF_LINE_NUM || '.' || ORD_SRC_REF_LINE_SUB_NUM
                 END AS XX_SCR_ITEM_130_TXT
                ,DIOD.MDSE_CD
                ,DIOD.MDSE_NM
                ,(
                    SELECT
                        CPJ.COA_PROJ_DESC_TXT
                    FROM
                         MDSE DMI
                        ,COA_PROJ CPJ
                        ,(
                            SELECT
                                 M.MDSE_CD
                                ,M.GLBL_CMPY_CD
                                ,M.EZCANCELFLAG
                            FROM
                                MDSE M
                            WHERE
                                    M.GLBL_CMPY_CD = DIOD.GLBL_CMPY_CD
                                AND M.EZCANCELFLAG = DIOD.EZCANCELFLAG
                                AND M.RGTN_STS_CD  = #rgtnStsCd#
                                AND M.MDSE_CD      = DIOD.MDSE_CD
                            UNION
                            SElECT
                                 OTM.MDSE_CD
                                ,OTM.GLBL_CMPY_CD
                                ,OTM.EZCANCELFLAG
                            FROM
                                 ORD_TAKE_MDSE OTM
                            WHERE
                                    OTM.GLBL_CMPY_CD       = DIOD.GLBL_CMPY_CD
                                AND OTM.EZCANCELFLAG       = DIOD.EZCANCELFLAG
                                AND OTM.ORD_TAKE_MDSE_CD   = DIOD.MDSE_CD
                          ) AMV
                    WHERE
                            AMV.MDSE_CD                   = DMI.MDSE_CD
                        AND AMV.GLBL_CMPY_CD              = DMI.GLBL_CMPY_CD
                        AND AMV.EZCANCELFLAG              = DMI.EZCANCELFLAG
                        AND DMI.COA_MDSE_TP_CD            = CPJ.COA_PROJ_CD
                        AND DMI.GLBL_CMPY_CD              = CPJ.GLBL_CMPY_CD
                        AND DMI.EZCANCELFLAG              = CPJ.EZCANCELFLAG
                        AND ROWNUM                        = 1
                    ) AS COA_MDSE_TP_DESC_TXT
                ,(
                    SELECT
                        CP.COA_PROD_DESC_TXT
                    FROM
                         ALL_MDSE_V AMV
                        ,COA_PROD CP
                    WHERE
                            AMV.MDSE_CD                   = DIOD.MDSE_CD
                        AND AMV.GLBL_CMPY_CD              = DIOD.GLBL_CMPY_CD
                        AND AMV.EZCANCELFLAG              = DIOD.EZCANCELFLAG
                        AND AMV.RGTN_STS_CD               = #rgtnStsCd#
                        AND AMV.COA_PROD_CD               = CP.COA_PROD_CD
                        AND AMV.GLBL_CMPY_CD              = CP.GLBL_CMPY_CD
                        AND AMV.EZCANCELFLAG              = CP.EZCANCELFLAG
                 ) AS COA_PROD_DESC_TXT
                ,DIOD.ORIG_MDSE_CD
                ,DIOD.ORIG_MDSE_NM
                ,DIOD.SET_MDSE_CD
                ,DIOD.DROP_SHIP_FLG
                ,DIOD.SHIP_TO_CUST_CD
                ,DIOD.SHIP_TO_LOC_NM
                ,DIOD.SHIP_TO_ADDL_LOC_NM
                ,DIOD.SHIP_TO_FIRST_LINE_ADDR
                ,DIOD.SHIP_TO_SCD_LINE_ADDR
                ,DIOD.SHIP_TO_THIRD_LINE_ADDR
                ,DIOD.SHIP_TO_FRTH_LINE_ADDR
                ,DIOD.SHIP_TO_FIRST_REF_CMNT_TXT
                ,DIOD.SHIP_TO_SCD_REF_CMNT_TXT
                ,DIOD.SHIP_TO_CTY_ADDR
                ,DIOD.SHIP_TO_ST_CD
                ,DIOD.SHIP_TO_PROV_NM
                ,DIOD.SHIP_TO_CNTY_NM
                ,DIOD.SHIP_TO_POST_CD
                ,DIOD.SHIP_TO_CTRY_CD
                ,DIOD.ORD_QTY
                ,DIOD.ORD_CUST_UOM_QTY
                ,DIOD.INVTY_LOC_CD
                ,DIOD.PRC_CATG_CD
                ,(
                    SELECT
                        PC.PRC_CATG_NM
                    FROM
                        PRC_CATG PC
                    WHERE
                            PC.GLBL_CMPY_CD = DIOD.GLBL_CMPY_CD
                        AND PC.PRC_CATG_CD  = DIOD.PRC_CATG_CD
                        AND PC.EZCANCELFLAG = DIOD.EZCANCELFLAG
                 ) AS PRC_CATG_NM
                ,DIOD.FL_PRC_LIST_CD
                ,(
                    SELECT
                        FPC.PRC_CATG_NM
                    FROM
                        PRC_CATG FPC
                    WHERE
                            FPC.GLBL_CMPY_CD = DIOD.GLBL_CMPY_CD
                        AND FPC.PRC_CATG_CD  = DIOD.FL_PRC_LIST_CD
                        AND FPC.EZCANCELFLAG = DIOD.EZCANCELFLAG
                 ) AS FL_PRC_LIST_DESC_TXT
                ,DIOD.DEAL_PRC_LIST_PRC_AMT
                ,DIOD.FUNC_PRC_LIST_PRC_AMT
                ,DIOD.ENT_DEAL_NET_UNIT_PRC_AMT
                ,DIOD.ENT_FUNC_NET_UNIT_PRC_AMT
                ,DIOD.CPO_DTL_DEAL_NET_AMT
                ,DIOD.CPO_DTL_DEAL_SLS_AMT
                ,DIOD.CPO_DTL_FUNC_NET_AMT
                ,DIOD.CPO_DTL_FUNC_SLS_AMT
                ,DIOD.PRC_BASE_DT
                ,DIOD.CCY_CD
                ,DIOD.EXCH_RATE
                ,DIOD.RDD_DT
                ,DIOD.RSD_DT
                ,DIOD.SHIP_CPLT_CD
                ,DIOD.UOM_CPLT_FLG
                ,DIOD.STK_STS_CD
                ,DIOD.SLS_REP_OR_SLS_TEAM_TOC_CD
                ,DIOD.CUST_MDSE_CD
                ,DIOD.CUST_UOM_CD
                ,(
                    SELECT
                        PKG_UOM_DESC_TXT
                    FROM (
                    SELECT
                         PU1.PKG_UOM_CD                                                                 AS PKG_UOM_CD
                        ,DECODE(PU2.PKG_UOM_DESC_TXT, NULL, PU1.PKG_UOM_DESC_TXT, PU2.PKG_UOM_DESC_TXT) AS PKG_UOM_DESC_TXT
                    FROM
                         MDSE_STORE_PKG    DMSP
                        ,PKG_UOM           PU1
                        ,PKG_UOM           PU2
                        ,(
                            SELECT
                                M.MDSE_CD
                            FROM
                                MDSE M
                            WHERE
                                    M.GLBL_CMPY_CD = DIOD.GLBL_CMPY_CD
                                AND M.EZCANCELFLAG = DIOD.EZCANCELFLAG
                                AND M.RGTN_STS_CD  = #rgtnStsCd#
                                AND M.MDSE_CD      = DIOD.MDSE_CD
                            UNION
                            SElECT
                                OTM.MDSE_CD
                            FROM
                                ORD_TAKE_MDSE OTM
                            WHERE
                                    OTM.GLBL_CMPY_CD       = DIOD.GLBL_CMPY_CD
                                AND OTM.EZCANCELFLAG       = DIOD.EZCANCELFLAG
                                AND OTM.ORD_TAKE_MDSE_CD   = DIOD.MDSE_CD
                          ) AMV
                    WHERE
                            DMSP.GLBL_CMPY_CD    = DIOD.GLBL_CMPY_CD
                        AND DMSP.MDSE_CD         = AMV.MDSE_CD
                        AND DMSP.EZCANCELFLAG    = '0'
                        AND PU1.EZCANCELFLAG     = '0'
                        AND DMSP.GLBL_CMPY_CD    = PU1.GLBL_CMPY_CD
                        AND DMSP.PKG_UOM_CD      = PU1.PKG_UOM_CD
                        AND PU1.EZCANCELFLAG     = '0'
                        AND DMSP.GLBL_CMPY_CD    = PU2.GLBL_CMPY_CD (+)
                        AND DMSP.BASE_PKG_UOM_CD = PU2.PKG_UOM_CD (+)
                        AND PU2.EZCANCELFLAG (+) = '0'
                   ) PKG_V
                   WHERE
                       DIOD.CUST_UOM_CD = PKG_V.PKG_UOM_CD
                   AND ROWNUM           = 1
                 ) AS PKG_UOM_DESC_TXT
                ,DIOD.EDI_STS_CD
                ,DIOD.EDI_NUM
                ,DIOD.EDI_SUB_NUM
                ,DIOD.ORIG_CPO_ORD_NUM
                ,DIOD.ORIG_INV_NUM
                ,DIOD.SET_ITEM_SHIP_CPLT_FLG
                ,DIOD.DS_ORD_POSN_NUM
                ,DIOD.UNIT_NET_WT
                ,DIOD.CONFIG_ITEM_FLG
                ,DIOD.BASE_CMPT_FLG
                ,DIOD.CUST_ISTL_FLG
                ,DIOD.SVC_CONFIG_MSTR_PK
                ,DIOD.SVC_MACH_MSTR_PK
                ,DIOD.DS_CONTR_NUM
                ,DIOD.DS_CONTR_SQ_NUM
                ,DIOD.DS_IMPT_ORD_CONFIG_PK
                ,DIOD.DS_ORD_LINE_CATG_CD
                ,DIOD.ORD_LINE_SRC_CD
                ,DIOD.RTL_WH_CD
                ,DECODE (RW.RTL_WH_NM, NULL, RW1.RTL_WH_NM, RW.RTL_WH_NM) AS RTL_WH_NM
                <!-- Add Start QC#58230 -->
                ,NVL(DIOD.RTL_SWH_CD, SWH.RTL_SWH_CD) AS RTL_SWH_CD
                ,NVL(RSW.RTL_SWH_NM, SWH.RTL_SWH_NM) AS RTL_SWH_NM
                <!-- Add End QC#58230 -->
                ,DIOD.SER_NUM
                ,DIOD.REF_CPO_DTL_LINE_NUM
                ,DIOD.REF_CPO_DTL_LINE_SUB_NUM
                ,DIOD.DPLY_LINE_REF_NUM
                ,DIOD.CR_REBIL_CD
                ,DIOD.SPLY_TP_CD
                ,DIOD.SPLY_NM
                ,DIOD.SPLY_FIRST_ADDR
                ,DIOD.SPLY_CTY_ADDR
                ,DIOD.SPLY_ST_CD
                ,DIOD.SPLY_POST_CD
                ,DIOD.CSMP_CONTR_NUM
                ,DIOD.DLR_REF_NUM
                ,DIOD.CSMP_PRC_LIST_CD
                ,DIOD.RNTL_TRMN_DT
                ,DIOD.FIRST_BLLG_ATTRB_NM
                ,DIOD.FIRST_BLLG_ATTRB_VAL_TXT
                ,DIOD.SCD_BLLG_ATTRB_NM
                ,DIOD.SCD_BLLG_ATTRB_VAL_TXT
                ,DIOD.THIRD_BLLG_ATTRB_NM
                ,DIOD.THIRD_BLLG_ATTRB_VAL_TXT
                ,DIOD.FRTH_BLLG_ATTRB_NM
                ,DIOD.FRTH_BLLG_ATTRB_VAL_TXT
                ,DIOD.FIFTH_BLLG_ATTRB_NM
                ,DIOD.FIFTH_BLLG_ATTRB_VAL_TXT
                ,DIOD.SIXTH_BLLG_ATTRB_NM
                ,DIOD.SIXTH_BLLG_ATTRB_VAL_TXT
                ,DIOD.SBST_MDSE_CD
                ,DIOD.SUPD_LOCK_FLG
                ,DIOD.PRC_LIST_EQUIP_CONFIG_NUM
                ,DIOD.IMPT_LINE_FLG
                ,DIOD.FIN_ITEM_LINE_FLG
                ,DIOD.EZUPTIME
                ,DIOD.EZUPTIMEZONE
                ,AMV.MDSE_DESC_SHORT_TXT
                <!-- 2018/01/12 S21_NA#22372 Add Start -->
                ,DIOD.FUNC_UNIT_FL_PRC_AMT
                <!-- 2018/01/12 S21_NA#22372 Add End -->
                <!-- 2019/10/04 S21_NA#51372 Add Start -->
                ,DIOD.PRNT_VND_NM
                <!-- 2019/10/04 S21_NA#51372 Add End -->
            FROM
                 DS_IMPT_ORD_DTL DIOD
                ,RTL_WH RW
                ,RTL_SWH RSW
                ,RTL_WH RW1                                             /* DUMMY WH*/
                ,ALL_MDSE_V AMV
                ,DS_IMPT_ORD DIO
                <!-- Add Start QC#58230 -->
                ,SWH SWH
                <!-- Add End QC#58230 -->
            WHERE
                    DIOD.GLBL_CMPY_CD   = #glblCmpyCd#
                AND DIOD.DS_IMPT_ORD_PK = #dsImptOrdPk#
                AND DIOD.EZCANCELFLAG   = '0'
                AND DIOD.GLBL_CMPY_CD   = RSW.GLBL_CMPY_CD(+)
                AND DIOD.RTL_WH_CD      = RSW.RTL_WH_CD(+)
                AND DIOD.RTL_SWH_CD     = RSW.RTL_SWH_CD(+)
                AND RSW.GLBL_CMPY_CD    = RW.GLBL_CMPY_CD(+)
                AND RSW.RTL_WH_CD       = RW.RTL_WH_CD(+)
                AND DIOD.GLBL_CMPY_CD   = RW1.GLBL_CMPY_CD(+)
                AND DIOD.RTL_WH_CD      = RW1.RTL_WH_CD(+)
                AND DIOD.GLBL_CMPY_CD   = AMV.GLBL_CMPY_CD(+)
                AND DIOD.MDSE_CD        = AMV.MDSE_CD(+)
                AND AMV.EZCANCELFLAG(+) = '0'
                AND DIO.EZCANCELFLAG    = '0'
                AND DIOD.GLBL_CMPY_CD   = DIO.GLBL_CMPY_CD
                AND DIOD.DS_IMPT_ORD_PK = DIO.DS_IMPT_ORD_PK
                <!-- Add Start QC#58230 -->
                AND DIOD.GLBL_CMPY_CD   = SWH.GLBL_CMPY_CD(+)
                AND DIOD.RTL_SWH_CD     = SWH.RTL_SWH_CD(+)
                AND SWH.EZCANCELFLAG(+) = '0'
                <!-- Add End QC#58230 -->
            ORDER BY
                 LPAD(DIOD.DS_ORD_POSN_NUM, 4, '0')
                 <!-- QC#17615 -->
                ,DECODE(DIOD.ORD_SRC_REF_LINE_SUB_NUM, NULL, 
                    DECODE(DIO.CPO_SRC_TP_CD, 'SO', LPAD(DIOD.ORD_SRC_REF_LINE_NUM, 50, '0'), LPAD(DIOD.ORD_SRC_REF_LINE_NUM, 50, 'Z')), 
                    LPAD(DIOD.ORD_SRC_REF_LINE_NUM, 50, '0')) <!-- 2017/01/30 QC#17297 Mod -->
                ,LPAD(DIOD.ORD_SRC_REF_LINE_SUB_NUM, 50, '0')
        )
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="getDsImptOrdRtrnDtlInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DS_IMPT_ORD_RTRN_DTL_PK
            ,DS_IMPT_ORD_PK
            ,ORD_SRC_REF_LINE_NUM
            ,ORD_SRC_REF_LINE_SUB_NUM
            ,XX_SCR_ITEM_130_TXT
            ,MDSE_CD
            ,MDSE_NM
            ,COA_MDSE_TP_DESC_TXT
            ,COA_PROD_DESC_TXT
            ,ORIG_MDSE_CD
            ,ORIG_MDSE_NM
            ,SET_MDSE_CD
            ,DROP_SHIP_FLG
            ,SHIP_TO_CUST_CD
            ,SHIP_TO_LOC_NM
            ,SHIP_TO_ADDL_LOC_NM
            ,SHIP_TO_FIRST_LINE_ADDR
            ,SHIP_TO_SCD_LINE_ADDR
            ,SHIP_TO_THIRD_LINE_ADDR
            ,SHIP_TO_FRTH_LINE_ADDR
            ,SHIP_TO_FIRST_REF_CMNT_TXT
            ,SHIP_TO_SCD_REF_CMNT_TXT
            ,SHIP_TO_CTY_ADDR
            ,SHIP_TO_ST_CD
            ,SHIP_TO_PROV_NM
            ,SHIP_TO_CNTY_NM
            ,SHIP_TO_POST_CD
            ,SHIP_TO_CTRY_CD
            ,ORD_QTY
            ,ORD_CUST_UOM_QTY
            ,INVTY_LOC_CD
            ,PRC_CATG_CD
            ,PRC_CATG_NM
            ,FL_PRC_LIST_CD
            ,FL_PRC_LIST_DESC_TXT
            ,DEAL_PRC_LIST_PRC_AMT
            ,FUNC_PRC_LIST_PRC_AMT
            ,ENT_DEAL_NET_UNIT_PRC_AMT
            ,ENT_FUNC_NET_UNIT_PRC_AMT
            ,CPO_DTL_DEAL_NET_AMT
            ,CPO_DTL_DEAL_SLS_AMT
            ,CPO_DTL_FUNC_NET_AMT
            ,CPO_DTL_FUNC_SLS_AMT
            ,NVL(ENT_DEAL_NET_UNIT_PRC_AMT, 0) * NVL(ORD_QTY, 0) AS LINE_DEAL_SUB_TOT_AMT
            ,PRC_BASE_DT
            ,CCY_CD
            ,EXCH_RATE
            ,RQST_PICK_UP_DT
            ,STK_STS_CD
            ,SLS_REP_OR_SLS_TEAM_TOC_CD
            ,CUST_MDSE_CD
            ,CUST_UOM_CD
            ,PKG_UOM_DESC_TXT
            ,ORIG_CPO_ORD_NUM
            ,ORIG_INV_NUM
            ,DS_ORD_POSN_NUM
            ,UNIT_NET_WT
            ,BASE_CMPT_FLG
            ,SVC_CONFIG_MSTR_PK
            ,SVC_MACH_MSTR_PK
            ,DS_CONTR_NUM
            ,DS_CONTR_SQ_NUM
            ,DS_IMPT_ORD_CONFIG_PK
            ,DS_CPO_LINE_CATG_CD
            ,ORD_LINE_SRC_CD
            ,RTL_WH_CD
            ,RTL_WH_NM
            ,RTL_SWH_CD
            ,RTL_SWH_NM
            ,SER_NUM
            ,REF_CPO_DTL_LINE_NUM
            ,REF_CPO_DTL_LINE_SUB_NUM
            ,DPLY_LINE_REF_NUM
            ,CSMP_CONTR_NUM
            ,DLR_REF_NUM
            ,CSMP_PRC_LIST_CD
            ,HDD_RMV_CD
            ,RTRN_RSN_CD
            ,FIRST_BLLG_ATTRB_NM
            ,FIRST_BLLG_ATTRB_VAL_TXT
            ,SCD_BLLG_ATTRB_NM
            ,SCD_BLLG_ATTRB_VAL_TXT
            ,THIRD_BLLG_ATTRB_NM
            ,THIRD_BLLG_ATTRB_VAL_TXT
            ,FRTH_BLLG_ATTRB_NM
            ,FRTH_BLLG_ATTRB_VAL_TXT
            ,FIFTH_BLLG_ATTRB_NM
            ,FIFTH_BLLG_ATTRB_VAL_TXT
            ,SIXTH_BLLG_ATTRB_NM
            ,SIXTH_BLLG_ATTRB_VAL_TXT
            ,EZUPTIME
            ,EZUPTIMEZONE
            ,MDSE_DESC_SHORT_TXT
            <!-- 2018/01/12 S21_NA#22372 Add Start -->
            ,FUNC_UNIT_FL_PRC_AMT
            <!-- 2018/01/12 S21_NA#22372 Add End -->
        FROM (
            SELECT
                 DIORD.DS_IMPT_ORD_RTRN_DTL_PK
                ,DIORD.DS_IMPT_ORD_PK
                ,DIORD.ORD_SRC_REF_LINE_NUM
                ,DIORD.ORD_SRC_REF_LINE_SUB_NUM
                ,CASE
                    WHEN ORD_SRC_REF_LINE_NUM IS NULL THEN NULL
                    WHEN ORD_SRC_REF_LINE_SUB_NUM IS NULL THEN ORD_SRC_REF_LINE_NUM
                    ELSE ORD_SRC_REF_LINE_NUM || '.' || ORD_SRC_REF_LINE_SUB_NUM
                 END AS XX_SCR_ITEM_130_TXT
                ,DIORD.MDSE_CD
                ,DIORD.MDSE_NM
                ,(
                    select
                        CPJ.COA_PROJ_DESC_TXT
                    from
                         MDSE DMI
                        ,COA_PROJ CPJ
                        ,(
                            SELECT
                                 M.MDSE_CD
                                ,M.GLBL_CMPY_CD
                                ,M.EZCANCELFLAG
                            FROM
                                MDSE M
                            WHERE
                                    M.GLBL_CMPY_CD = DIORD.GLBL_CMPY_CD
                                AND M.EZCANCELFLAG = DIORD.EZCANCELFLAG
                                AND M.RGTN_STS_CD  = #rgtnStsCd#
                                AND M.MDSE_CD      = DIORD.MDSE_CD
                            UNION
                            SElECT
                                 OTM.MDSE_CD
                                ,OTM.GLBL_CMPY_CD
                                ,OTM.EZCANCELFLAG
                            FROM
                                 ORD_TAKE_MDSE OTM
                            WHERE
                                    OTM.GLBL_CMPY_CD       = DIORD.GLBL_CMPY_CD
                                AND OTM.EZCANCELFLAG       = DIORD.EZCANCELFLAG
                                AND OTM.ORD_TAKE_MDSE_CD   = DIORD.MDSE_CD
                          ) AMV
                    WHERE
                            AMV.MDSE_CD                   = DMI.MDSE_CD
                        AND AMV.GLBL_CMPY_CD              = DMI.GLBL_CMPY_CD
                        AND AMV.EZCANCELFLAG              = DMI.EZCANCELFLAG
                        AND DMI.COA_MDSE_TP_CD            = CPJ.COA_PROJ_CD
                        AND DMI.GLBL_CMPY_CD              = CPJ.GLBL_CMPY_CD
                        AND DMI.EZCANCELFLAG              = CPJ.EZCANCELFLAG
                        AND ROWNUM                        = 1
                    ) AS COA_MDSE_TP_DESC_TXT
                ,(
                    select
                        CP.COA_PROD_DESC_TXT
                    from
                         ALL_MDSE_V AMV
                        ,COA_PROD CP
                    WHERE
                            AMV.MDSE_CD                   = DIORD.MDSE_CD
                        AND AMV.GLBL_CMPY_CD              = DIORD.GLBL_CMPY_CD
                        AND AMV.EZCANCELFLAG              = DIORD.EZCANCELFLAG
                        AND AMV.RGTN_STS_CD               = #rgtnStsCd#
                        AND AMV.COA_PROD_CD               = CP.COA_PROD_CD
                        AND AMV.GLBL_CMPY_CD              = CP.GLBL_CMPY_CD
                        AND AMV.EZCANCELFLAG              = CP.EZCANCELFLAG
                 ) AS COA_PROD_DESC_TXT
                ,DIORD.ORIG_MDSE_CD
                ,DIORD.ORIG_MDSE_NM
                ,DIORD.SET_MDSE_CD
                ,DIORD.DROP_SHIP_FLG
                ,DIORD.SHIP_TO_CUST_CD
                ,DIORD.SHIP_TO_LOC_NM
                ,DIORD.SHIP_TO_ADDL_LOC_NM
                ,DIORD.SHIP_TO_FIRST_LINE_ADDR
                ,DIORD.SHIP_TO_SCD_LINE_ADDR
                ,DIORD.SHIP_TO_THIRD_LINE_ADDR
                ,DIORD.SHIP_TO_FRTH_LINE_ADDR
                ,DIORD.SHIP_TO_FIRST_REF_CMNT_TXT
                ,DIORD.SHIP_TO_SCD_REF_CMNT_TXT
                ,DIORD.SHIP_TO_CTY_ADDR
                ,DIORD.SHIP_TO_ST_CD
                ,DIORD.SHIP_TO_PROV_NM
                ,DIORD.SHIP_TO_CNTY_NM
                ,DIORD.SHIP_TO_POST_CD
                ,DIORD.SHIP_TO_CTRY_CD
                ,DIORD.ORD_QTY
                ,DIORD.ORD_CUST_UOM_QTY
                ,DIORD.INVTY_LOC_CD
                ,DIORD.PRC_CATG_CD
                ,(
                    SELECT
                        PC.PRC_CATG_NM
                    FROM
                        PRC_CATG PC
                    WHERE
                            PC.GLBL_CMPY_CD = DIORD.GLBL_CMPY_CD
                        AND PC.PRC_CATG_CD  = DIORD.PRC_CATG_CD
                        AND PC.EZCANCELFLAG = DIORD.EZCANCELFLAG
                 ) AS PRC_CATG_NM
                ,DIORD.FL_PRC_LIST_CD
                ,(
                    SELECT
                        FPC.PRC_CATG_NM
                    FROM
                        PRC_CATG FPC
                    WHERE
                            FPC.GLBL_CMPY_CD = DIORD.GLBL_CMPY_CD
                        AND FPC.PRC_CATG_CD = DIORD.FL_PRC_LIST_CD
                        AND FPC.EZCANCELFLAG = DIORD.EZCANCELFLAG
                 ) AS FL_PRC_LIST_DESC_TXT
                ,DIORD.DEAL_PRC_LIST_PRC_AMT
                ,DIORD.FUNC_PRC_LIST_PRC_AMT
                ,DIORD.ENT_DEAL_NET_UNIT_PRC_AMT
                ,DIORD.ENT_FUNC_NET_UNIT_PRC_AMT
                ,DIORD.CPO_DTL_DEAL_NET_AMT
                ,DIORD.CPO_DTL_DEAL_SLS_AMT
                ,DIORD.CPO_DTL_FUNC_NET_AMT
                ,DIORD.CPO_DTL_FUNC_SLS_AMT
                ,DIORD.PRC_BASE_DT
                ,DIORD.CCY_CD
                ,DIORD.EXCH_RATE
                ,DIORD.RQST_PICK_UP_DT
                ,DIORD.STK_STS_CD
                ,DIORD.SLS_REP_OR_SLS_TEAM_TOC_CD
                ,DIORD.CUST_MDSE_CD
                ,DIORD.CUST_UOM_CD
                ,(
                    SELECT
                        PKG_UOM_DESC_TXT
                    FROM (
                    SELECT
                         PU1.PKG_UOM_CD                                                                 AS PKG_UOM_CD
                        ,DECODE(PU2.PKG_UOM_DESC_TXT, NULL, PU1.PKG_UOM_DESC_TXT, PU2.PKG_UOM_DESC_TXT) AS PKG_UOM_DESC_TXT
                    FROM
                         MDSE_STORE_PKG    DMSP
                        ,PKG_UOM           PU1
                        ,PKG_UOM           PU2
                        ,(
                            SELECT
                                M.MDSE_CD
                            FROM
                                MDSE M
                            WHERE
                                    M.GLBL_CMPY_CD = DIORD.GLBL_CMPY_CD
                                AND M.EZCANCELFLAG = DIORD.EZCANCELFLAG
                                AND M.RGTN_STS_CD  = #rgtnStsCd#
                                AND M.MDSE_CD      = DIORD.MDSE_CD
                            UNION
                            SElECT
                                OTM.MDSE_CD
                            FROM
                                ORD_TAKE_MDSE OTM
                            WHERE
                                    OTM.GLBL_CMPY_CD       = DIORD.GLBL_CMPY_CD
                                AND OTM.EZCANCELFLAG       = DIORD.EZCANCELFLAG
                                AND OTM.ORD_TAKE_MDSE_CD   = DIORD.MDSE_CD
                          ) AMV
                    WHERE
                            DMSP.GLBL_CMPY_CD    = DIORD.GLBL_CMPY_CD
                        AND DMSP.MDSE_CD         = AMV.MDSE_CD
                        AND DMSP.EZCANCELFLAG    = '0'
                        AND PU1.EZCANCELFLAG     = '0'
                        AND DMSP.GLBL_CMPY_CD    = PU1.GLBL_CMPY_CD
                        AND DMSP.PKG_UOM_CD      = PU1.PKG_UOM_CD
                        AND PU1.EZCANCELFLAG     = '0'
                        AND DMSP.GLBL_CMPY_CD    = PU2.GLBL_CMPY_CD (+)
                        AND DMSP.BASE_PKG_UOM_CD = PU2.PKG_UOM_CD (+)
                        AND PU2.EZCANCELFLAG (+) = '0'
                   ) PKG_V
                   WHERE
                          DIORD.CUST_UOM_CD = PKG_V.PKG_UOM_CD
                      AND ROWNUM            = 1
                 ) AS PKG_UOM_DESC_TXT
                ,DIORD.ORIG_CPO_ORD_NUM
                ,DIORD.ORIG_INV_NUM
                ,DIORD.DS_ORD_POSN_NUM
                ,DIORD.UNIT_NET_WT
                ,DIORD.BASE_CMPT_FLG
                ,DIORD.SVC_CONFIG_MSTR_PK
                ,DIORD.SVC_MACH_MSTR_PK
                ,DIORD.DS_CONTR_NUM
                ,DIORD.DS_CONTR_SQ_NUM
                ,DIORD.DS_IMPT_ORD_CONFIG_PK
                ,DIORD.DS_CPO_LINE_CATG_CD
                ,DIORD.ORD_LINE_SRC_CD
                ,DIORD.RTL_WH_CD
                ,DECODE (RW.RTL_WH_NM, NULL, RW1.RTL_WH_NM, RW.RTL_WH_NM) AS RTL_WH_NM
                ,DIORD.RTL_SWH_CD
                ,RSW.RTL_SWH_NM
                ,DIORD.SER_NUM
                ,DIORD.REF_CPO_DTL_LINE_NUM
                ,DIORD.REF_CPO_DTL_LINE_SUB_NUM
                ,DIORD.DPLY_LINE_REF_NUM
                ,DIORD.CSMP_CONTR_NUM
                ,DIORD.DLR_REF_NUM
                ,DIORD.CSMP_PRC_LIST_CD
                ,DIORD.HDD_RMV_CD
                ,DIORD.RTRN_RSN_CD
                ,DIORD.FIRST_BLLG_ATTRB_NM
                ,DIORD.FIRST_BLLG_ATTRB_VAL_TXT
                ,DIORD.SCD_BLLG_ATTRB_NM
                ,DIORD.SCD_BLLG_ATTRB_VAL_TXT
                ,DIORD.THIRD_BLLG_ATTRB_NM
                ,DIORD.THIRD_BLLG_ATTRB_VAL_TXT
                ,DIORD.FRTH_BLLG_ATTRB_NM
                ,DIORD.FRTH_BLLG_ATTRB_VAL_TXT
                ,DIORD.FIFTH_BLLG_ATTRB_NM
                ,DIORD.FIFTH_BLLG_ATTRB_VAL_TXT
                ,DIORD.SIXTH_BLLG_ATTRB_NM
                ,DIORD.SIXTH_BLLG_ATTRB_VAL_TXT
                ,DIORD.EZUPTIME
                ,DIORD.EZUPTIMEZONE
                ,AMV.MDSE_DESC_SHORT_TXT
                <!-- 2018/01/12 S21_NA#22372 Add Start -->
                ,DIORD.FUNC_UNIT_FL_PRC_AMT
                <!-- 2018/01/12 S21_NA#22372 Add End -->
            FROM
                 DS_IMPT_ORD_RTRN_DTL DIORD
                ,RTL_WH RW
                ,RTL_SWH RSW
                ,RTL_WH RW1                                             /* DUMMY WH*/
                ,ALL_MDSE_V AMV
            WHERE
                    DIORD.GLBL_CMPY_CD      = #glblCmpyCd#
                AND DIORD.DS_IMPT_ORD_PK    = #dsImptOrdPk#
                AND DIORD.EZCANCELFLAG      = '0'
                AND DIORD.GLBL_CMPY_CD      = RSW.GLBL_CMPY_CD(+)
                AND DIORD.RTL_WH_CD         = RSW.RTL_WH_CD(+)
                AND DIORD.RTL_SWH_CD        = RSW.RTL_SWH_CD(+)
                AND RSW.GLBL_CMPY_CD        = RW.GLBL_CMPY_CD(+)
                AND RSW.RTL_WH_CD           = RW.RTL_WH_CD(+)
                AND DIORD.GLBL_CMPY_CD      = RW1.GLBL_CMPY_CD(+)
                AND DIORD.RTL_WH_CD         = RW1.RTL_WH_CD(+)
                AND DIORD.GLBL_CMPY_CD      = AMV.GLBL_CMPY_CD(+)
                AND DIORD.MDSE_CD           = AMV.MDSE_CD(+)
                AND AMV.EZCANCELFLAG(+)     = '0'
            ORDER BY
                 LPAD(DIORD.DS_ORD_POSN_NUM, 4, '0')
                ,DECODE(DIORD.ORD_SRC_REF_LINE_SUB_NUM, NULL, LPAD(DIORD.ORD_SRC_REF_LINE_NUM, 50, 'Z'), LPAD(DIORD.ORD_SRC_REF_LINE_NUM, 50, '0')) <!-- 2017/01/30 QC#17297 Mod -->
                ,LPAD(DIORD.ORD_SRC_REF_LINE_SUB_NUM, 50, '0')
        )
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="getDsImptOrdSlsCrInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DS_IMPT_ORD_SLS_CR_PK
            ,DS_IMPT_ORD_PK
            ,DS_IMPT_ORD_CONFIG_PK
            ,DS_ORD_POSN_NUM
            ,CONFIG_CATG_CD
            ,SLS_REP_TOC_CD
            ,SLS_REP_ROLE_TP_CD
            ,SLS_REP_CR_PCT
            ,SLS_CR_QUOT_FLG
            ,EZUPTIME
            ,EZUPTIMEZONE
        FROM (
            <isNull property="configCatgCd">
            SELECT
                 DIOSC.DS_IMPT_ORD_SLS_CR_PK
                ,DIOSC.DS_IMPT_ORD_PK
                ,NULL AS DS_IMPT_ORD_CONFIG_PK
                ,NULL AS DS_ORD_POSN_NUM
                ,NULL AS CONFIG_CATG_CD
                ,DIOSC.SLS_REP_TOC_CD
                ,DIOSC.SLS_REP_ROLE_TP_CD
                ,DIOSC.SLS_REP_CR_PCT
                ,DIOSC.SLS_CR_QUOT_FLG
                ,DIOSC.EZUPTIME
                ,DIOSC.EZUPTIMEZONE
            FROM
                 DS_IMPT_ORD_SLS_CR DIOSC
            WHERE
                    DIOSC.GLBL_CMPY_CD              = #glblCmpyCd#
                AND DIOSC.DS_IMPT_ORD_PK            = #dsImptOrdPk#
                AND DIOSC.EZCANCELFLAG              = '0'
                AND DIOSC.DS_IMPT_ORD_PK            = #dsImptOrdPk#
                AND DIOSC.DS_IMPT_ORD_CONFIG_PK     IS NULL
            </isNull>
            <isNotNull property="configCatgCd">
            SELECT
                 DIOSC.DS_IMPT_ORD_SLS_CR_PK
                ,DIOSC.DS_IMPT_ORD_PK
                ,DIOSC.DS_IMPT_ORD_CONFIG_PK
                ,DIOC.DS_ORD_POSN_NUM
                ,DIOC.CONFIG_CATG_CD
                ,DIOSC.SLS_REP_TOC_CD
                ,DIOSC.SLS_REP_ROLE_TP_CD
                ,DIOSC.SLS_REP_CR_PCT
                ,DIOSC.SLS_CR_QUOT_FLG
                ,DIOSC.EZUPTIME
                ,DIOSC.EZUPTIMEZONE
            FROM
                 DS_IMPT_ORD_SLS_CR DIOSC
                ,DS_IMPT_ORD_CONFIG DIOC
            WHERE
                    DIOSC.GLBL_CMPY_CD              = #glblCmpyCd#
                AND DIOSC.DS_IMPT_ORD_PK            = #dsImptOrdPk#
                AND DIOSC.EZCANCELFLAG              = '0'
                AND DIOSC.GLBL_CMPY_CD              = DIOC.GLBL_CMPY_CD
                AND DIOSC.DS_IMPT_ORD_PK            = DIOC.DS_IMPT_ORD_PK
                AND DIOSC.EZCANCELFLAG              = DIOC.EZCANCELFLAG
                AND DIOSC.DS_IMPT_ORD_CONFIG_PK     = DIOC.DS_IMPT_ORD_CONFIG_PK
                AND DIOC.CONFIG_CATG_CD             = #configCatgCd#
            </isNotNull>
        )
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="getDsImptPrcCalcBaseInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DS_IMPT_PRC_CALC_BASE_PK
            ,DS_IMPT_ORD_DTL_PK
            ,DS_IMPT_RTRN_PRC_CALC_PK
            ,DS_IMPT_ORD_RTRN_DTL_PK
            ,CONFIG_CATG_CD
            ,ORD_SRC_REF_LINE_NUM
            ,ORD_SRC_REF_LINE_SUB_NUM
            ,DS_IMPT_ORD_PK
            ,PRC_COND_TP_CD
            ,PRC_COND_TP_DESC_TXT
            ,PRC_DTL_GRP_CD
            ,PRC_JRNL_GRP_CD
            ,PKG_UOM_CD
            ,PRC_COND_UNIT_CD
            ,PRC_CALC_METH_CD
            ,DS_MDSE_PRC_PK
            ,SPEC_COND_PRC_PK
            ,FRT_PER_WT_PK
            ,PRC_COND_MAN_ENTRY_FLG
            ,PRC_COND_MAN_ADD_FLG
            ,PRC_COND_MAN_DEL_FLG
            ,AUTO_PRC_AMT_RATE
            ,MAX_PRC_AMT_RATE
            ,MIN_PRC_AMT_RATE
            ,MAN_PRC_AMT_RATE
            ,CALC_PRC_AMT_RATE
            ,UNIT_PRC_AMT
            ,COA_ACCT_CD
            ,AUTO_PRC_CCY_CD
            ,PRC_RULE_APPLY_FLG
            ,PRC_RULE_PRCD_PK
            ,EZUPTIME
            ,EZUPTIMEZONE
        FROM (
                SELECT
                     DIPCB.DS_IMPT_PRC_CALC_BASE_PK
                    ,DIPCB.DS_IMPT_ORD_DTL_PK
                    ,NULL AS DS_IMPT_RTRN_PRC_CALC_PK
                    ,NULL AS DS_IMPT_ORD_RTRN_DTL_PK
                    ,'O'  AS CONFIG_CATG_CD
                    ,DIOD.ORD_SRC_REF_LINE_NUM
                    ,DIOD.ORD_SRC_REF_LINE_SUB_NUM
                    ,DIPCB.DS_IMPT_ORD_PK
                    ,DIPCB.PRC_COND_TP_CD
                    ,PCT.PRC_COND_TP_DESC_TXT
                    ,DIPCB.PRC_DTL_GRP_CD
                    ,DIPCB.PRC_JRNL_GRP_CD
                    ,DIPCB.PKG_UOM_CD
                    ,DIPCB.PRC_COND_UNIT_CD
                    ,DIPCB.PRC_CALC_METH_CD
                    ,DIPCB.DS_MDSE_PRC_PK
                    ,DIPCB.SPEC_COND_PRC_PK
                    ,DIPCB.FRT_PER_WT_PK
                    ,DIPCB.PRC_COND_MAN_ENTRY_FLG
                    ,DIPCB.PRC_COND_MAN_ADD_FLG
                    ,DIPCB.PRC_COND_MAN_DEL_FLG
                    ,DIPCB.AUTO_PRC_AMT_RATE
                    ,DIPCB.MAX_PRC_AMT_RATE
                    ,DIPCB.MIN_PRC_AMT_RATE
                    ,DIPCB.MAN_PRC_AMT_RATE
                    ,DIPCB.CALC_PRC_AMT_RATE
                    ,DIPCB.UNIT_PRC_AMT
                    ,DIPCB.COA_ACCT_CD
                    ,DIPCB.AUTO_PRC_CCY_CD
                    ,DIPCB.PRC_RULE_APPLY_FLG
                    ,DIPCB.PRC_RULE_PRCD_PK
                    ,DIPCB.EZUPTIME
                    ,DIPCB.EZUPTIMEZONE
                FROM
                     DS_IMPT_PRC_CALC_BASE DIPCB
                    ,DS_IMPT_ORD_DTL DIOD
                    ,PRC_COND_TP PCT
                WHERE
                        DIPCB.GLBL_CMPY_CD              = #glblCmpyCd#
                    AND DIPCB.DS_IMPT_ORD_PK            = #dsImptOrdPk#
                    AND DIPCB.EZCANCELFLAG              = '0'
                    AND DIPCB.GLBL_CMPY_CD              = DIOD.GLBL_CMPY_CD
                    AND DIPCB.DS_IMPT_ORD_PK            = DIOD.DS_IMPT_ORD_PK
                    AND DIPCB.EZCANCELFLAG              = DIOD.EZCANCELFLAG
                    AND DIPCB.DS_IMPT_ORD_DTL_PK        = DIOD.DS_IMPT_ORD_DTL_PK
                    AND DIPCB.GLBL_CMPY_CD              = PCT.GLBL_CMPY_CD(+)
                    AND DIPCB.EZCANCELFLAG              = PCT.EZCANCELFLAG(+)
                    AND DIPCB.PRC_COND_TP_CD            = PCT.PRC_COND_TP_CD(+)
            UNION ALL
                SELECT
                     NULL AS DS_IMPT_PRC_CALC_BASE_PK
                    ,NULL AS DS_IMPT_ORD_DTL_PK
                    ,DIRPC.DS_IMPT_RTRN_PRC_CALC_PK
                    ,DIRPC.DS_IMPT_ORD_RTRN_DTL_PK
                    ,'I'  AS CONFIG_CATG_CD
                    ,DIORD.ORD_SRC_REF_LINE_NUM
                    ,DIORD.ORD_SRC_REF_LINE_SUB_NUM
                    ,DIRPC.DS_IMPT_ORD_PK
                    ,DIRPC.PRC_COND_TP_CD
                    ,PCT.PRC_COND_TP_DESC_TXT
                    ,DIRPC.PRC_DTL_GRP_CD
                    ,DIRPC.PRC_JRNL_GRP_CD
                    ,DIRPC.PKG_UOM_CD
                    ,DIRPC.PRC_COND_UNIT_CD
                    ,DIRPC.PRC_CALC_METH_CD
                    ,DIRPC.DS_MDSE_PRC_PK
                    ,DIRPC.SPEC_COND_PRC_PK
                    ,DIRPC.FRT_PER_WT_PK
                    ,DIRPC.PRC_COND_MAN_ENTRY_FLG
                    ,DIRPC.PRC_COND_MAN_ADD_FLG
                    ,DIRPC.PRC_COND_MAN_DEL_FLG
                    ,DIRPC.AUTO_PRC_AMT_RATE
                    ,DIRPC.MAX_PRC_AMT_RATE
                    ,DIRPC.MIN_PRC_AMT_RATE
                    ,DIRPC.MAN_PRC_AMT_RATE
                    ,DIRPC.CALC_PRC_AMT_RATE
                    ,DIRPC.UNIT_PRC_AMT
                    ,DIRPC.COA_ACCT_CD
                    ,DIRPC.AUTO_PRC_CCY_CD
                    ,DIRPC.PRC_RULE_APPLY_FLG
                    ,DIRPC.PRC_RULE_PRCD_PK
                    ,DIRPC.EZUPTIME
                    ,DIRPC.EZUPTIMEZONE
                FROM
                     DS_IMPT_RTRN_PRC_CALC DIRPC
                    ,DS_IMPT_ORD_RTRN_DTL DIORD
                    ,PRC_COND_TP PCT
                WHERE
                        DIRPC.GLBL_CMPY_CD              = #glblCmpyCd#
                    AND DIRPC.DS_IMPT_ORD_PK            = #dsImptOrdPk#
                    AND DIRPC.EZCANCELFLAG              = '0'
                    AND DIRPC.GLBL_CMPY_CD              = DIORD.GLBL_CMPY_CD
                    AND DIRPC.DS_IMPT_ORD_PK            = DIORD.DS_IMPT_ORD_PK
                    AND DIRPC.EZCANCELFLAG              = DIORD.EZCANCELFLAG
                    AND DIRPC.DS_IMPT_ORD_RTRN_DTL_PK   = DIORD.DS_IMPT_ORD_RTRN_DTL_PK
                    AND DIRPC.GLBL_CMPY_CD              = PCT.GLBL_CMPY_CD(+)
                    AND DIRPC.EZCANCELFLAG              = PCT.EZCANCELFLAG(+)
                    AND DIRPC.PRC_COND_TP_CD            = PCT.PRC_COND_TP_CD(+)
        )
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="getDsImptOrdErrInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DS_IMPT_ORD_ERR_PK
            ,DS_IMPT_ORD_PK
            ,DS_IMPT_ORD_CONFIG_PK
            ,DS_ORD_POSN_NUM
            ,DS_IMPT_ORD_DTL_PK
            ,DS_IMPT_ORD_RTRN_DTL_PK
            ,DS_IMPT_SVC_DTL_PK
            ,DS_IMPT_SVC_LINE_NUM
            ,ORD_SRC_REF_LINE_NUM
            ,ORD_SRC_REF_LINE_SUB_NUM
            ,DS_IMPT_ORD_ERR_TXT
            ,DS_IMPT_ORD_ERR_MSG_ID
            ,SVC_CONFIG_MSTR_PK
            ,XX_SCR_ITEM_30_TXT
            ,CONFIG_CATG_CD
            ,EZUPTIME
            ,EZUPTIMEZONE
            ,SORT_ORDER
        FROM (
            SELECT
                 DIOE.DS_IMPT_ORD_ERR_PK
                ,DIOE.DS_IMPT_ORD_PK
                ,DIOE.DS_IMPT_ORD_CONFIG_PK
                ,NULL AS DS_ORD_POSN_NUM
                ,DIOE.DS_IMPT_ORD_DTL_PK
                ,DIOE.DS_IMPT_ORD_RTRN_DTL_PK
                ,NULL AS DS_IMPT_SVC_DTL_PK
                ,NULL AS DS_IMPT_SVC_LINE_NUM
                ,NULL AS ORD_SRC_REF_LINE_NUM
                ,NULL AS ORD_SRC_REF_LINE_SUB_NUM
                ,DIOE.DS_IMPT_ORD_ERR_TXT
                ,DIOE.DS_IMPT_ORD_ERR_MSG_ID
                ,NULL AS SVC_CONFIG_MSTR_PK
                ,CASE
                    WHEN DIOE.DS_IMPT_SVC_DTL_PK     IS NULL THEN 'Header'
                    ELSE                                          'Service'
                    END AS XX_SCR_ITEM_30_TXT
                ,NULL AS CONFIG_CATG_CD
                ,DIOE.EZUPTIME
                ,DIOE.EZUPTIMEZONE
                ,1 AS SORT_ORDER
                ,LPAD('0', 4, '0') AS SORT_ORDER_1
                ,LPAD('0', 50, '0') AS SORT_ORDER_2
                ,LPAD('0', 50, '0') AS SORT_ORDER_3
            FROM
                 DS_IMPT_ORD_ERR DIOE
            WHERE
                DIOE.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DIOE.DS_IMPT_ORD_PK         = #dsImptOrdPk#
            AND DIOE.EZCANCELFLAG           = '0'
            AND DIOE.DS_IMPT_ORD_CONFIG_PK  IS NULL
            AND (
                DIOE.DS_IMPT_SVC_DTL_PK     IS NULL
             OR DIOE.DS_IMPT_SVC_DTL_PK     = 0
                )
        UNION ALL
            SELECT
                 DIOE.DS_IMPT_ORD_ERR_PK
                ,DIOE.DS_IMPT_ORD_PK
                ,DIOE.DS_IMPT_ORD_CONFIG_PK
                ,DIOC.DS_ORD_POSN_NUM
                ,DIOE.DS_IMPT_ORD_DTL_PK
                ,DIOE.DS_IMPT_ORD_RTRN_DTL_PK
                ,NULL AS DS_IMPT_SVC_DTL_PK
                ,NULL AS DS_IMPT_SVC_LINE_NUM
                ,NULL AS ORD_SRC_REF_LINE_NUM
                ,NULL AS ORD_SRC_REF_LINE_SUB_NUM
                ,DIOE.DS_IMPT_ORD_ERR_TXT
                ,DIOE.DS_IMPT_ORD_ERR_MSG_ID
                ,DIOC.SVC_CONFIG_MSTR_PK
                ,'Config' AS XX_SCR_ITEM_30_TXT
                ,DIOC.CONFIG_CATG_CD
                ,DIOE.EZUPTIME
                ,DIOE.EZUPTIMEZONE
                ,2 AS SORT_ORDER
                ,LPAD(DIOC.DS_ORD_POSN_NUM, 4, '0') AS SORT_ORDER_1
                ,LPAD('0', 50, '0') AS SORT_ORDER_2
                ,LPAD('0', 50, '0') AS SORT_ORDER_3
            FROM
                 DS_IMPT_ORD_ERR DIOE
                ,DS_IMPT_ORD_CONFIG DIOC
            WHERE
                DIOE.GLBL_CMPY_CD               = #glblCmpyCd#
            AND DIOE.DS_IMPT_ORD_PK             = #dsImptOrdPk#
            AND DIOE.EZCANCELFLAG               = '0'
            AND DIOE.GLBL_CMPY_CD               = DIOC.GLBL_CMPY_CD
            AND DIOE.DS_IMPT_ORD_PK             = DIOC.DS_IMPT_ORD_PK
            AND DIOE.EZCANCELFLAG               = DIOC.EZCANCELFLAG
            AND DIOE.DS_IMPT_ORD_CONFIG_PK      = DIOC.DS_IMPT_ORD_CONFIG_PK
            AND DIOE.DS_IMPT_ORD_DTL_PK         IS NULL
            AND DIOE.DS_IMPT_ORD_RTRN_DTL_PK    IS NULL
        UNION ALL
            SELECT
                 DIOE.DS_IMPT_ORD_ERR_PK
                ,DIOE.DS_IMPT_ORD_PK
                ,DIOE.DS_IMPT_ORD_CONFIG_PK
                ,DIOD.DS_ORD_POSN_NUM
                ,DIOE.DS_IMPT_ORD_DTL_PK
                ,DIOE.DS_IMPT_ORD_RTRN_DTL_PK
                ,NULL AS DS_IMPT_SVC_DTL_PK
                ,NULL AS DS_IMPT_SVC_LINE_NUM
                ,DIOD.ORD_SRC_REF_LINE_NUM
                ,DIOD.ORD_SRC_REF_LINE_SUB_NUM
                ,DIOE.DS_IMPT_ORD_ERR_TXT
                ,DIOE.DS_IMPT_ORD_ERR_MSG_ID
                ,NULL AS SVC_CONFIG_MSTR_PK
                ,'Line' AS XX_SCR_ITEM_30_TXT
                ,NULL AS CONFIG_CATG_CD
                ,DIOE.EZUPTIME
                ,DIOE.EZUPTIMEZONE
                ,3 AS SORT_ORDER
                ,LPAD(DIOD.DS_ORD_POSN_NUM, 4, '0') AS SORT_ORDER_1
                ,LPAD(DIOD.ORD_SRC_REF_LINE_NUM, 50, '0') AS SORT_ORDER_2
                ,LPAD(DIOD.ORD_SRC_REF_LINE_SUB_NUM, 50, '0') AS SORT_ORDER_3
            FROM
                 DS_IMPT_ORD_ERR DIOE
                ,DS_IMPT_ORD_DTL DIOD
            WHERE
                DIOE.GLBL_CMPY_CD               = #glblCmpyCd#
            AND DIOE.DS_IMPT_ORD_PK             = #dsImptOrdPk#
            AND DIOE.EZCANCELFLAG               = '0'
            AND DIOE.GLBL_CMPY_CD               = DIOD.GLBL_CMPY_CD
            AND DIOE.DS_IMPT_ORD_PK             = DIOD.DS_IMPT_ORD_PK
            AND DIOE.EZCANCELFLAG               = DIOD.EZCANCELFLAG
            AND DIOE.DS_IMPT_ORD_CONFIG_PK      = DIOD.DS_IMPT_ORD_CONFIG_PK
            AND DIOE.DS_IMPT_ORD_DTL_PK         = DIOD.DS_IMPT_ORD_DTL_PK
        UNION ALL
            SELECT
                 DIOE.DS_IMPT_ORD_ERR_PK
                ,DIOE.DS_IMPT_ORD_PK
                ,DIOE.DS_IMPT_ORD_CONFIG_PK
                ,DIORD.DS_ORD_POSN_NUM
                ,DIOE.DS_IMPT_ORD_DTL_PK
                ,DIOE.DS_IMPT_ORD_RTRN_DTL_PK
                ,NULL AS DS_IMPT_SVC_DTL_PK
                ,NULL AS DS_IMPT_SVC_LINE_NUM
                ,DIORD.ORD_SRC_REF_LINE_NUM
                ,DIORD.ORD_SRC_REF_LINE_SUB_NUM
                ,DIOE.DS_IMPT_ORD_ERR_TXT
                ,DIOE.DS_IMPT_ORD_ERR_MSG_ID
                ,NULL AS SVC_CONFIG_MSTR_PK
                ,'RMA Line' AS XX_SCR_ITEM_30_TXT
                ,NULL AS CONFIG_CATG_CD
                ,DIOE.EZUPTIME
                ,DIOE.EZUPTIMEZONE
                ,4 AS SORT_ORDER
                ,LPAD(DIORD.DS_ORD_POSN_NUM, 4, '0') AS SORT_ORDER_1
                ,LPAD(DIORD.ORD_SRC_REF_LINE_NUM, 50, '0') AS SORT_ORDER_2
                ,LPAD(DIORD.ORD_SRC_REF_LINE_SUB_NUM, 50, '0') AS SORT_ORDER_3
            FROM
                 DS_IMPT_ORD_ERR DIOE
                ,DS_IMPT_ORD_RTRN_DTL DIORD
            WHERE
                DIOE.GLBL_CMPY_CD               = #glblCmpyCd#
            AND DIOE.DS_IMPT_ORD_PK             = #dsImptOrdPk#
            AND DIOE.EZCANCELFLAG               = '0'
            AND DIOE.GLBL_CMPY_CD               = DIORD.GLBL_CMPY_CD
            AND DIOE.DS_IMPT_ORD_PK             = DIORD.DS_IMPT_ORD_PK
            AND DIOE.EZCANCELFLAG               = DIORD.EZCANCELFLAG
            AND DIOE.DS_IMPT_ORD_CONFIG_PK      = DIORD.DS_IMPT_ORD_CONFIG_PK
            AND DIOE.DS_IMPT_ORD_RTRN_DTL_PK    = DIORD.DS_IMPT_ORD_RTRN_DTL_PK
        UNION ALL
            SELECT
                 DIOE.DS_IMPT_ORD_ERR_PK
                ,DIOE.DS_IMPT_ORD_PK
                ,DIOE.DS_IMPT_ORD_CONFIG_PK
                ,NULL AS DS_ORD_POSN_NUM
                ,DIOE.DS_IMPT_ORD_DTL_PK
                ,DIOE.DS_IMPT_ORD_RTRN_DTL_PK
                ,DIOE.DS_IMPT_SVC_DTL_PK
                ,DISD.DS_IMPT_SVC_LINE_NUM
                ,NULL AS ORD_SRC_REF_LINE_NUM
                ,NULL AS ORD_SRC_REF_LINE_SUB_NUM
                ,DIOE.DS_IMPT_ORD_ERR_TXT
                ,DIOE.DS_IMPT_ORD_ERR_MSG_ID
                ,NULL AS SVC_CONFIG_MSTR_PK
                ,'Service' AS XX_SCR_ITEM_30_TXT
                ,NULL AS CONFIG_CATG_CD
                ,DIOE.EZUPTIME
                ,DIOE.EZUPTIMEZONE
                ,5 AS SORT_ORDER
                ,LPAD(TO_CHAR(NVL(DISD.DS_IMPT_SVC_LINE_NUM, 0)), 50, '0') AS SORT_ORDER_1
                ,LPAD('0', 50, '0') AS SORT_ORDER_2
                ,LPAD('0', 50, '0') AS SORT_ORDER_3
            FROM
                 DS_IMPT_ORD_ERR DIOE
                ,DS_IMPT_SVC_DTL DISD
            WHERE
                DIOE.GLBL_CMPY_CD               = #glblCmpyCd#
            AND DIOE.DS_IMPT_ORD_PK             = #dsImptOrdPk#
            AND DIOE.EZCANCELFLAG               = '0'
            AND DIOE.GLBL_CMPY_CD               = DISD.GLBL_CMPY_CD
            AND DIOE.DS_IMPT_ORD_PK             = DISD.DS_IMPT_ORD_PK
            AND DIOE.EZCANCELFLAG               = DISD.EZCANCELFLAG
            AND DIOE.DS_IMPT_SVC_DTL_PK         = DISD.DS_IMPT_SVC_DTL_PK
        ORDER BY
            SORT_ORDER
           ,SORT_ORDER_1
           ,SORT_ORDER_2
           ,SORT_ORDER_3
           ,DS_IMPT_ORD_ERR_PK
        )
        WHERE
            ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="getSlsRepEmlAddr" parameterClass="Map" resultClass="Map">
        SELECT
            S21P.EML_ADDR
        FROM 
             DS_IMPT_ORD DIO
            ,ORG_FUNC_ASG OFA
            ,S21_PSN S21P
        WHERE 
                DIO.GLBL_CMPY_CD                    = #glblCmpyCd#
            AND DIO.EZCANCELFLAG                    = '0'
            AND DIO.DS_IMPT_ORD_PK                  = #dsImptOrdPk#
            AND DIO.GLBL_CMPY_CD                    = OFA.GLBL_CMPY_CD
            AND DIO.SLS_REP_TOC_CD                  = OFA.TOC_CD
            AND DIO.EZCANCELFLAG                    = OFA.EZCANCELFLAG
            AND OFA.GLBL_CMPY_CD                    = S21P.GLBL_CMPY_CD
            AND OFA.EZCANCELFLAG                    = S21P.EZCANCELFLAG
            AND OFA.PSN_CD                          = S21P.PSN_CD
            AND S21P.EFF_FROM_DT                    &lt;= #slsDt#
            AND (S21P.EFF_THRU_DT                   &gt;= #slsDt# OR S21P.EFF_THRU_DT IS NULL)
    </statement>

    <statement id="getSlsAdminEmlAddr" parameterClass="Map" resultClass="Map">
        SELECT
            S21PA.EML_ADDR
        FROM
            S21_PSN S21PA
        WHERE
                S21PA.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND S21PA.EZCANCELFLAG                  = '0'
            AND S21PA.EFF_FROM_DT                    &lt;= #slsDt#
            AND (S21PA.EFF_THRU_DT                   &gt;= #slsDt# OR S21PA.EFF_THRU_DT IS NULL)
            AND EXISTS (
                SELECT
                    1
                FROM 
                     DS_IMPT_ORD DIO
                    ,ORG_FUNC_ASG OFA
                    ,S21_PSN S21P
                WHERE 
                        DIO.GLBL_CMPY_CD                    = S21PA.GLBL_CMPY_CD
                    AND DIO.EZCANCELFLAG                    = S21PA.EZCANCELFLAG
                    AND DIO.DS_IMPT_ORD_PK                  = #dsImptOrdPk#
                    AND DIO.GLBL_CMPY_CD                    = OFA.GLBL_CMPY_CD
                    AND DIO.SLS_REP_TOC_CD                  = OFA.TOC_CD
                    AND DIO.EZCANCELFLAG                    = OFA.EZCANCELFLAG
                    AND OFA.GLBL_CMPY_CD                    = S21P.GLBL_CMPY_CD
                    AND OFA.EZCANCELFLAG                    = S21P.EZCANCELFLAG
                    AND OFA.PSN_CD                          = S21P.PSN_CD
                    AND S21P.PSN_CD                         = S21PA.PSN_CD
                    AND S21P.HR_SUPV_ID                     = S21PA.HR_SUPV_ID
                    AND S21P.EFF_FROM_DT                    &lt;= #slsDt#
                    AND (S21P.EFF_THRU_DT                   &gt;= #slsDt# OR S21P.EFF_THRU_DT IS NULL)
            )
    </statement>

    <statement id="getSlsRepBranchAdminEmlAddr" parameterClass="Map" resultClass="Map">
    </statement>

    <statement id="getDsOrdCatgCdList" parameterClass="Map" resultClass="Map">
        SELECT
            OC.DS_ORD_CATG_CD       AS DS_ORD_CATG_CD
           ,OC.DS_ORD_CATG_DESC_TXT AS DS_ORD_CATG_DESC_TXT
        FROM
            DS_ORD_CATG           OC
           ,DS_ORD_TP             OT
           ,AVAL_DS_ORD_TP_APP_ID AI
        WHERE
            OC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND OC.DS_ORD_CATG_DESC_TXT LIKE #dsOrdCatgDescTxt#
            AND OC.EZCANCELFLAG         = '0'

            AND OC.GLBL_CMPY_CD   = OT.GLBL_CMPY_CD
            AND OC.DS_ORD_CATG_CD = OT.DS_ORD_CATG_CD
            AND OT.EZCANCELFLAG   = '0'

            AND OT.GLBL_CMPY_CD = AI.GLBL_CMPY_CD
            AND OT.DS_ORD_TP_CD = AI.DS_ORD_TP_CD
            AND AI.BIZ_APP_ID   = #bizId#
            AND AI.EZCANCELFLAG = '0'
        GROUP BY
            OC.DS_ORD_CATG_CD
           ,OC.DS_ORD_CATG_DESC_TXT
    </statement>

    <statement id="getDsOrdTpCd" parameterClass="Map" resultClass="String">
        SELECT
            DS_ORD_TP_CD
        FROM
            (
             SELECT
                 OT.DS_ORD_TP_CD   AS DS_ORD_TP_CD
             FROM
                DS_ORD_CATG           OC
               ,DS_ORD_TP             OT
             WHERE
                 OC.GLBL_CMPY_CD       = #glblCmpyCd#
                 AND OC.DS_ORD_CATG_CD = #dsOrdCatgCd#
                 AND OC.EZCANCELFLAG   = '0'

                 AND OC.GLBL_CMPY_CD   = OT.GLBL_CMPY_CD
                 AND OC.DS_ORD_CATG_CD = OT.DS_ORD_CATG_CD
                 AND OT.EZCANCELFLAG   = '0'
             ORDER BY
                 OT.DS_ORD_TP_CD
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getCustAddlInfo" parameterClass="Map" resultClass="Map">
        SELECT
            PD.LINE_BIZ_TP_CD           AS LINE_BIZ_TP_CD
           ,PD.DEF_SHPG_SVC_LVL_CD      AS DEF_SHPG_SVC_LVL_CD
           ,FC.FRT_COND_DESC_TXT        AS FRT_COND_DESC_TXT
           ,PC.PRC_CATG_NM              AS PRC_CATG_NM
           ,CSL.CARR_SVC_LVL_DESC_TXT   AS CARR_SVC_LVL_DESC_TXT
        FROM
            DS_ORD_TP_PROC_DFN PD
           ,FRT_COND           FC
           ,PRC_CATG           PC
           ,CARR_SVC_LVL       CSL
        WHERE
            PD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND PD.ACTV_FLG     = 'Y'
            AND PD.EFF_FROM_DT  &lt;= #effDt#
            AND NVL(PD.EFF_THRU_DT, '99991231') &gt;= #effDt#
            AND PD.EZCANCELFLAG = '0'

            AND PD.GLBL_CMPY_CD     = FC.GLBL_CMPY_CD (+)
            AND PD.FRT_COND_CD      = FC.FRT_COND_CD (+)
            AND FC.EZCANCELFLAG (+) = '0'

            AND PD.GLBL_CMPY_CD     = PC.GLBL_CMPY_CD (+)
            AND PD.DEF_PRC_CATG_CD  = PC.PRC_CATG_CD (+)
            AND PC.EZCANCELFLAG (+) = '0'

            AND PD.GLBL_CMPY_CD        = CSL.GLBL_CMPY_CD (+)
            AND PD.DEF_CARR_SVC_LVL_CD = CSL.CARR_SVC_LVL_CD (+)
            AND CSL.EZCANCELFLAG (+)   = '0'
    </statement>

    <statement id="getPmtTermCashDiscCd" parameterClass="Map" resultClass="String">
        SELECT
            PMT_TERM_CASH_DISC_CD
        FROM
            (
             SELECT
                 CCP.PMT_TERM_CASH_DISC_CD
             FROM
                 CUST_CR_PRFL CCP
             WHERE
                 CCP.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND CCP.BILL_TO_CUST_CD = #billToCustCd#
                 AND CCP.EZCANCELFLAG    = '0'
             ORDER BY
                 CCP.BILL_TO_CUST_PK DESC
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getDsOrdTpList" parameterClass="Map" resultClass="Map">
        SELECT
            DOT.DS_ORD_TP_CD       AS DS_ORD_TP_CD
           ,DOT.DS_ORD_TP_DESC_TXT AS DS_ORD_TP_DESC_TXT
        FROM
            DS_ORD_TP DOT
        <!-- START 2021/03/02 J.Evangelista [QC#57824,ADD] -->
           ,DS_ORD_TP_PROC_DFN DOTPD
        <!--   END 2021/03/02 J.Evangelista [QC#57824,ADD] -->
        WHERE
            DOT.GLBL_CMPY_CD       = #glblCmpyCd#
            AND DOT.DS_ORD_CATG_CD = #dsOrdCatgCd#
            AND DOT.EZCANCELFLAG   = '0'
        <!-- START 2021/03/02 J.Evangelista [QC#57824,ADD] -->
            AND DOT.GLBL_CMPY_CD   = DOTPD.GLBL_CMPY_CD
            AND DOT.DS_ORD_TP_CD   = DOTPD.DS_ORD_TP_CD
            AND DOTPD.ACTV_FLG     = #actvFlg#
            AND DOTPD.EZCANCELFLAG = '0'
        <!--   END 2021/03/02 J.Evangelista [QC#57824,ADD] -->
        ORDER BY
            DOT.DS_ORD_TP_SORT_NUM
    </statement>

    <statement id="getDsOrdRsnList" parameterClass="Map" resultClass="Map">
        SELECT
            DOR.DS_ORD_RSN_CD       AS DS_ORD_RSN_CD
           ,DOR.DS_ORD_RSN_DESC_TXT AS DS_ORD_RSN_DESC_TXT
        FROM
            DS_ORD_TP_PROC_DFN PD
           ,DS_ORD_RSN DOR
        WHERE
            PD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND PD.ACTV_FLG     = 'Y'
            AND PD.EFF_FROM_DT  &lt;= #effDt#
            AND NVL(PD.EFF_THRU_DT, '99991231') &gt;= #effDt#
            AND PD.EZCANCELFLAG = '0'

            AND PD.GLBL_CMPY_CD      = DOR.GLBL_CMPY_CD
            AND PD.DS_ORD_RSN_GRP_CD = DOR.DS_ORD_RSN_GRP_CD
            AND DOR.EZCANCELFLAG     = '0'
        ORDER BY
            DOR.DS_ORD_RSN_SORT_NUM
    </statement>

    <statement id="getDsOrdLineCatgList" parameterClass="Map" resultClass="Map">
        SELECT
            PD.PRIM_LINE_CATG_FLG       AS PRIM_LINE_CATG_FLG
           ,C.DS_ORD_LINE_CATG_CD       AS DS_ORD_LINE_CATG_CD
           ,C.DS_ORD_LINE_CATG_DESC_TXT AS DS_ORD_LINE_CATG_DESC_TXT
        FROM
            DS_ORD_LINE_PROC_DFN PD
           ,DS_ORD_LINE_CATG C
        WHERE
            PD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND PD.ACTV_FLG     = 'Y'
            AND PD.EFF_FROM_DT  &lt;= #effDt#
            AND NVL(PD.EFF_THRU_DT, '99991231') &gt;= #effDt#
            AND PD.EZCANCELFLAG = '0'

            AND PD.GLBL_CMPY_CD        = C.GLBL_CMPY_CD
            AND PD.DS_ORD_LINE_CATG_CD = C.DS_ORD_LINE_CATG_CD
            AND C.DS_ORD_LINE_DRCTN_CD = #dsOrdLineDrctnCd#
            AND C.EZCANCELFLAG         = '0'
        ORDER BY
            C.DS_ORD_LINE_CATG_SORT_NUM
    </statement>

    <statement id="getBillToCustAddr" parameterClass="Map" resultClass="String">
        SELECT
            BILL_TO_ADDR
        FROM
            (
             SELECT
                 (
                  CASE WHEN BTC.FIRST_LINE_ADDR IS NOT NULL THEN
                      BTC.FIRST_LINE_ADDR || ' ' ||
                      BTC.SCD_LINE_ADDR   || ' ' ||
                      BTC.THIRD_LINE_ADDR || ' ' ||
                      BTC.FRTH_LINE_ADDR  || ' ' ||
                      BTC.CTY_ADDR        || ',' ||
                      BTC.ST_CD           || ' ' ||
                      BTC.POST_CD
                  END) AS BILL_TO_ADDR
             FROM
                 BILL_TO_CUST BTC
             WHERE
                 BTC.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND BTC.BILL_TO_CUST_CD = #billToCustCd#
                 AND BTC.RGTN_STS_CD     = #rgtnStsCd#
                 AND BTC.EZCANCELFLAG    = '0'
             ORDER BY
                 BTC.BILL_TO_CUST_PK DESC
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getShipToCustAddr" parameterClass="Map" resultClass="Map">
        SELECT
            SELL_TO_CUST_CD
           ,SHIP_TO_CUST_CD
           ,SHIP_TO_ADDR
           ,LOC_NM
           ,ADDL_LOC_NM
           ,FIRST_LINE_ADDR
           ,SCD_LINE_ADDR
           ,THIRD_LINE_ADDR
           ,FRTH_LINE_ADDR
           ,FIRST_REF_CMNT_TXT
           ,SCD_REF_CMNT_TXT
           ,CTY_ADDR
           ,ST_CD
           ,POST_CD
           ,PROV_NM
           ,CTRY_CD
           ,CNTY_NM
        FROM
            (
             SELECT
                  STC.SELL_TO_CUST_CD    AS SELL_TO_CUST_CD
                , STC.SHIP_TO_CUST_CD    AS SHIP_TO_CUST_CD
                ,(
                  CASE WHEN STC.FIRST_LINE_ADDR IS NOT NULL THEN
                      STC.FIRST_LINE_ADDR || ' ' ||
                      STC.SCD_LINE_ADDR   || ' ' ||
                      STC.THIRD_LINE_ADDR || ' ' ||
                      STC.FRTH_LINE_ADDR  || ' ' ||
                      STC.CTY_ADDR        || ',' ||
                      STC.ST_CD           || ' ' ||
                      STC.POST_CD
                  END)                  AS SHIP_TO_ADDR
                ,STC.LOC_NM             AS LOC_NM
                ,STC.ADDL_LOC_NM        AS ADDL_LOC_NM
                ,STC.FIRST_LINE_ADDR    AS FIRST_LINE_ADDR
                ,STC.SCD_LINE_ADDR      AS SCD_LINE_ADDR
                ,STC.THIRD_LINE_ADDR    AS THIRD_LINE_ADDR
                ,STC.FRTH_LINE_ADDR     AS FRTH_LINE_ADDR
                ,STC.FIRST_REF_CMNT_TXT AS FIRST_REF_CMNT_TXT
                ,STC.SCD_REF_CMNT_TXT   AS SCD_REF_CMNT_TXT
                ,STC.CTY_ADDR           AS CTY_ADDR
                ,STC.ST_CD              AS ST_CD
                ,STC.POST_CD            AS POST_CD
                ,STC.PROV_NM            AS PROV_NM
                ,STC.CTRY_CD            AS CTRY_CD
                ,CNTY.CNTY_NM           AS CNTY_NM
             FROM
                 SHIP_TO_CUST STC
                ,CNTY         CNTY
             WHERE
                 STC.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
                 AND STC.RGTN_STS_CD     = #rgtnStsCd#
                 AND STC.EZCANCELFLAG    = '0'

                 AND STC.GLBL_CMPY_CD      = CNTY.GLBL_CMPY_CD (+)
                 AND STC.CNTY_PK           = CNTY.CNTY_PK (+)
                 AND CNTY.EZCANCELFLAG (+) = '0'
             ORDER BY
                 STC.SHIP_TO_CUST_PK DESC
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getBillToCustInfoList" parameterClass="Map" resultClass="Map">
        SELECT
            BTC.BILL_TO_CUST_CD AS BILL_TO_CUST_CD
            ,(
              CASE WHEN BTC.FIRST_LINE_ADDR IS NOT NULL THEN
                  BTC.FIRST_LINE_ADDR || ' ' ||
                  BTC.SCD_LINE_ADDR   || ' ' ||
                  BTC.THIRD_LINE_ADDR || ' ' ||
                  BTC.FRTH_LINE_ADDR  || ' ' ||
                  BTC.CTY_ADDR        || ',' ||
                  BTC.ST_CD           || ' ' ||
                  BTC.POST_CD
              END)               AS BILL_TO_ADDR
            <!-- QC#30097 Mod Start -->
            ,(
              CASE WHEN BTC.FIRST_LINE_ADDR IS NOT NULL THEN
                     DECODE (BTC.FIRST_LINE_ADDR, NULL, '', CONCAT(BTC.FIRST_LINE_ADDR, CHR(13) || CHR(10)))
                  || DECODE (BTC.SCD_LINE_ADDR, NULL, '', CONCAT(BTC.SCD_LINE_ADDR, CHR(13) || CHR(10)))
                  || DECODE (BTC.THIRD_LINE_ADDR, NULL, '', CONCAT(BTC.THIRD_LINE_ADDR, CHR(13) || CHR(10)))
                  || DECODE (BTC.FRTH_LINE_ADDR, NULL, '', CONCAT(BTC.FRTH_LINE_ADDR, CHR(13) || CHR(10)))
                  || CONCAT (BTC.CTY_ADDR, ',')
                  || RPAD (BTC.ST_CD, LENGTH (BTC.ST_CD) + 1)
                  || BTC.POST_CD
              END)               AS ENT_BILL_TO_ADDR
            <!-- QC#30097 Mod End -->
            ,DAC.SELL_TO_CUST_CD AS DS_ACCT_NUM
            ,DAC.DS_ACCT_NM      AS DS_ACCT_NM
        FROM
            BILL_TO_CUST    BTC
           ,SELL_TO_CUST    DAC
        <!-- 2019/08/28 QC#53021 Add Start -->
           ,ACCT_LOC        AC
           ,PTY_LOC_WRK     PLW
        <!-- 2019/08/28 QC#53021 Add End -->
        WHERE
            BTC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND BTC.BILL_TO_CUST_CD LIKE #custCd#
            AND BTC.RGTN_STS_CD     = #rgtnStsCd#
            AND BTC.EZCANCELFLAG    = '0'
        <!-- 2019/08/28 QC#53021 Mod Start -->
            AND PLW.GLBL_CMPY_CD    = BTC.GLBL_CMPY_CD
            AND PLW.PTY_LOC_PK      = BTC.PTY_LOC_PK
            AND PLW.RGTN_STS_CD     = #rgtnStsCd#
            AND PLW.EZCANCELFLAG    = '0'
            AND AC.GLBL_CMPY_CD     = PLW.GLBL_CMPY_CD
            AND AC.LOC_NUM          = PLW.LOC_NUM
            AND AC.RGTN_STS_CD      = #rgtnStsCd#
            AND AC.EZCANCELFLAG     = '0'
            AND AC.GLBL_CMPY_CD     = DAC.GLBL_CMPY_CD
            AND AC.DS_ACCT_NUM      = DAC.SELL_TO_CUST_CD
        <!--     AND BTC.GLBL_CMPY_CD    = DAC.GLBL_CMPY_CD    -->
        <!--     AND BTC.SELL_TO_CUST_CD = DAC.SELL_TO_CUST_CD  -->
        <!-- 2019/08/28 QC#53021 Mod End -->
            AND DAC.RGTN_STS_CD     = #rgtnStsCd#
            AND DAC.EZCANCELFLAG    = '0'
            AND ROWNUM          &lt;= 2  <!-- 2018/03/12 S21_NA#24090 Add -->
    </statement>

    <statement id="getBillToCustInfo" parameterClass="Map" resultClass="Map">
        SELECT
            LOC_NM
           ,FIRST_LINE_ADDR
           ,CTY_ADDR
           ,ST_CD
           ,POST_CD
           ,SELL_TO_CUST_CD
        FROM
            (
             SELECT
                 BTC.LOC_NM           AS LOC_NM
                ,BTC.FIRST_LINE_ADDR  AS FIRST_LINE_ADDR
                ,BTC.CTY_ADDR         AS CTY_ADDR
                ,BTC.ST_CD            AS ST_CD
                ,BTC.POST_CD          AS POST_CD
                ,BTC.SELL_TO_CUST_CD  AS SELL_TO_CUST_CD
             FROM
                BILL_TO_CUST    BTC
                ,SELL_TO_CUST    DAC
                ,ACCT_LOC     AC
                ,PTY_LOC_WRK  PLW
             WHERE
                 BTC.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND BTC.BILL_TO_CUST_CD = #custCd#
                 AND BTC.RGTN_STS_CD     = #rgtnStsCd#
                 AND BTC.EZCANCELFLAG    = '0'
                 AND PLW.GLBL_CMPY_CD    = BTC.GLBL_CMPY_CD
                 AND PLW.PTY_LOC_PK      = BTC.PTY_LOC_PK
                 AND PLW.RGTN_STS_CD     = #rgtnStsCd#
                 AND PLW.EZCANCELFLAG    = '0'
                 AND AC.GLBL_CMPY_CD     = PLW.GLBL_CMPY_CD
                 AND AC.LOC_NUM          = PLW.LOC_NUM
                 AND AC.RGTN_STS_CD      = #rgtnStsCd#
                 AND AC.EZCANCELFLAG     = '0'
                 AND AC.GLBL_CMPY_CD     = DAC.GLBL_CMPY_CD
                 AND AC.DS_ACCT_NUM      = DAC.SELL_TO_CUST_CD
                 AND DAC.RGTN_STS_CD     = #rgtnStsCd#
                 AND DAC.EZCANCELFLAG    = '0'
             ORDER BY
                 BTC.BILL_TO_CUST_PK DESC
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getShipToCustInfoList" parameterClass="Map" resultClass="Map">
        SELECT
            STC.SHIP_TO_CUST_CD     AS SHIP_TO_CUST_CD
            ,(
              CASE WHEN STC.FIRST_LINE_ADDR IS NOT NULL THEN
                  STC.FIRST_LINE_ADDR || ' ' ||
                  STC.SCD_LINE_ADDR   || ' ' ||
                  STC.THIRD_LINE_ADDR || ' ' ||
                  STC.FRTH_LINE_ADDR  || ' ' ||
                  STC.CTY_ADDR        || ',' ||
                  STC.ST_CD           || ' ' ||
                  STC.POST_CD
              END)                  AS SHIP_TO_ADDR
            ,STC.ADDL_LOC_NM        AS ADDL_LOC_NM
            ,STC.FIRST_LINE_ADDR    AS FIRST_LINE_ADDR
            ,STC.SCD_LINE_ADDR      AS SCD_LINE_ADDR
            ,STC.THIRD_LINE_ADDR    AS THIRD_LINE_ADDR
            ,STC.FRTH_LINE_ADDR     AS FRTH_LINE_ADDR
            ,STC.FIRST_REF_CMNT_TXT AS FIRST_REF_CMNT_TXT
            ,STC.SCD_REF_CMNT_TXT   AS SCD_REF_CMNT_TXT
            ,STC.CTY_ADDR           AS CTY_ADDR
            ,STC.ST_CD              AS ST_CD
            ,STC.POST_CD            AS POST_CD
            ,STC.PROV_NM            AS PROV_NM
            ,STC.CTRY_CD            AS CTRY_CD
            ,DAC.SELL_TO_CUST_CD    AS DS_ACCT_NUM
            ,DAC.DS_ACCT_NM         AS DS_ACCT_NM
            ,CNTY.CNTY_NM           AS CNTY_NM
        FROM
            SHIP_TO_CUST STC
           ,SELL_TO_CUST DAC
           ,CNTY         CNTY
        <!-- 2019/08/28 QC#53021 Add Start -->
           ,ACCT_LOC     AC
           ,PTY_LOC_WRK  PLW
        <!-- 2019/08/28 QC#53021 Add End -->
        WHERE
            STC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD LIKE #shipToCustCd#
            AND STC.RGTN_STS_CD     = #rgtnStsCd#
            AND STC.EZCANCELFLAG    = '0'
        <!-- 2019/08/28 QC#53021 Mod Start -->
            AND PLW.GLBL_CMPY_CD    = STC.GLBL_CMPY_CD
            AND PLW.PTY_LOC_PK      = STC.PTY_LOC_PK
            AND PLW.RGTN_STS_CD     = #rgtnStsCd#
            AND PLW.EZCANCELFLAG    = '0'
            AND AC.GLBL_CMPY_CD     = PLW.GLBL_CMPY_CD
            AND AC.LOC_NUM          = PLW.LOC_NUM
            AND AC.RGTN_STS_CD      = #rgtnStsCd#
            AND AC.EZCANCELFLAG     = '0'
            AND AC.GLBL_CMPY_CD     = DAC.GLBL_CMPY_CD
            AND AC.DS_ACCT_NUM      = DAC.SELL_TO_CUST_CD
        <!-- AND STC.GLBL_CMPY_CD    = DAC.GLBL_CMPY_CD    -->
        <!-- AND STC.SELL_TO_CUST_CD = DAC.SELL_TO_CUST_CD -->
        <!-- 2019/08/28 QC#53021 Mod End -->
            AND DAC.RGTN_STS_CD     = #rgtnStsCd#
            AND DAC.EZCANCELFLAG    = '0'

            AND STC.GLBL_CMPY_CD      = CNTY.GLBL_CMPY_CD (+)
            AND STC.CNTY_PK           = CNTY.CNTY_PK (+)
            AND CNTY.EZCANCELFLAG (+) = '0'
            AND ROWNUM            &lt;= 2  <!-- 2018/03/12 S21_NA#24090 Add -->
    </statement>

    <statement id="getPrimSlsRepInfo" parameterClass="Map" resultClass="Map">
        SELECT
            TOC.TOC_NM           AS TOC_NM
           ,CB.COA_BR_CD         AS COA_BR_CD
           ,CB.COA_BR_DESC_TXT   AS COA_BR_DESC_TXT
           ,CE.COA_EXTN_CD       AS COA_EXTN_CD
           ,CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT
           ,(CASE
                  WHEN CB.COA_BR_CD IS NOT NULL
                  THEN CB.COA_BR_CD || ':' || CB.COA_BR_DESC_TXT
             END) AS COA_BR_ITEM
           ,(CASE
                  WHEN CE.COA_EXTN_CD IS NOT NULL
                  THEN CE.COA_EXTN_CD || ':' || CE.COA_EXTN_DESC_TXT
             END) AS COA_EXTN_ITEM
            <!--  ,OFA.PSN_CD         AS PSN_CD-->  <!-- ADD 2016/03/28 --> <!-- DEL 2016/05/12  -->   
             ,SP.PSN_NUM         AS PSN_NUM  <!-- ADD 2016/03/28 -->
        FROM
            TOC      TOC
           ,COA_BR   CB
           ,COA_EXTN CE
           ,ORG_FUNC_ASG OFA  <!-- ADD 2016/03/28 -->
           ,S21_PSN  SP       <!-- ADD 2016/05/12 -->
           ,S21_ORG  SO  <!-- 2016/10/21 S21_NA#14607 Add -->
        WHERE
            TOC.GLBL_CMPY_CD     = #glblCmpyCd#
            AND TOC.TOC_CD       = #primRepTocCd#
            AND TOC.EZCANCELFLAG = '0'

            AND TOC.GLBL_CMPY_CD    = CB.GLBL_CMPY_CD (+)
            AND TOC.COA_BR_CD       = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+) = '0'

            AND TOC.GLBL_CMPY_CD    = CE.GLBL_CMPY_CD (+)
            AND TOC.COA_EXTN_CD     = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+) = '0'

            <!-- ADD 2016/03/28 Start -->
            AND TOC.GLBL_CMPY_CD    = OFA.GLBL_CMPY_CD (+)
            AND TOC.TOC_CD          = OFA.TOC_CD (+)
            AND OFA.EZCANCELFLAG (+) = '0'
            <!-- ADD 2016/03/28 End -->
            
            <!-- ADD 2016/05/12 Start -->
            AND OFA.GLBL_CMPY_CD    = SP.GLBL_CMPY_CD (+)
            AND OFA.PSN_CD          = SP.PSN_CD (+)
            AND SP.EZCANCELFLAG (+) = '0'
            <!-- ADD 2016/05/12 End -->

            <!-- 2016/10/21 S21_NA#14607 Add Start -->
            AND TOC.GLBL_CMPY_CD    = SO.GLBL_CMPY_CD
            AND TOC.TOC_CD          = SO.TOC_CD
            AND SO.RGTN_STS_CD     != #rgtnStsCd#
            AND SO.EZCANCELFLAG     = '0'
            <!-- 2016/10/21 S21_NA#14607 Add Endt -->
    </statement>

    <statement id="getCarrSvcLvlDescTxt" parameterClass="Map" resultClass="String">
        SELECT
            CARR_SVC_LVL_DESC_TXT
        FROM
            (
             SELECT 
                 CSL.CARR_SVC_LVL_DESC_TXT
             FROM
                 SHPG_SVC_LVL_CARR_RELN SSLCR
                ,CARR_SVC_LVL           CSL
             WHERE
                 SSLCR.GLBL_CMPY_CD        = #glblCmpyCd#
                 AND SSLCR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                 AND SSLCR.CARR_CD         = #carrCd#
                 AND SSLCR.EZCANCELFLAG    = '0'

                 AND SSLCR.GLBL_CMPY_CD    = CSL.GLBL_CMPY_CD
                 AND SSLCR.CARR_SVC_LVL_CD = CSL.CARR_SVC_LVL_CD
                 AND CSL.EZCANCELFLAG      = '0'
             ORDER BY
                 SSLCR.CARR_SVC_LVL_CD DESC
            )
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="getWhInfo" parameterClass="Map" resultClass="Map">
        SELECT
            WH.RTL_WH_CD AS RTL_WH_CD
           ,WH.RTL_WH_NM AS RTL_WH_NM
        FROM
            DS_INVTY_LOC_V WH
        WHERE
            WH.GLBL_CMPY_CD         = #glblCmpyCd#
            AND WH.EFF_FROM_DT      <![CDATA[<=]]> #slsDt#
            AND NVL(WH.EFF_THRU_DT, '99991231') <![CDATA[>=]]> #slsDt#
            AND WH.EZCANCELFLAG     = '0'

            AND UPPER(WH.RTL_WH_NM) LIKE UPPER(#rtlWhNm#)
        GROUP BY
            WH.RTL_WH_CD
           ,WH.RTL_WH_NM
    </statement>

    <statement id="getWhInfoWithRsn" parameterClass="Map" resultClass="Map">
        SELECT
            WH.RTL_WH_CD AS RTL_WH_CD
           ,WH.RTL_WH_NM AS RTL_WH_NM
        FROM
            DS_ORD_TP_LOC_ROLE_RELN LRR
           ,LOC_USG                 LU
           ,DS_INVTY_LOC_V          WH
        WHERE
            LRR.GLBL_CMPY_CD     = #glblCmpyCd#
            AND LRR.DS_ORD_TP_CD = #dsOrdTpCd#
            AND LRR.EZCANCELFLAG = '0'

            AND LRR.GLBL_CMPY_CD   = LU.GLBL_CMPY_CD
            AND LRR.LOC_ROLE_TP_CD = LU.LOC_ROLE_TP_CD
            AND LU.EZCANCELFLAG    = '0'

            AND LU.GLBL_CMPY_CD = WH.GLBL_CMPY_CD
            AND LU.PTY_LOC_PK   = WH.PTY_LOC_PK
            AND WH.RGTN_STS_CD  = #rgtnStsCd#
            AND WH.EFF_FROM_DT  <![CDATA[<=]]> #slsDt#
            AND NVL(WH.EFF_THRU_DT, '99991231') <![CDATA[>=]]> #slsDt#
            AND WH.EZCANCELFLAG = '0'

            AND UPPER(WH.RTL_WH_NM) LIKE UPPER(#rtlWhNm#)
        GROUP BY
            WH.RTL_WH_CD
           ,WH.RTL_WH_NM
    </statement>

    <statement id="checkPriceCatgNm" parameterClass="Map" resultClass="Map">
        SELECT
            PC.PRC_CATG_CD
        FROM
            PRC_CATG PC
        WHERE
                PC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND UPPER(PC.PRC_CATG_NM)   = UPPER(#prcCatgNm#)
            AND PC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getSlsRepInfoList" parameterClass="Map" resultClass="Map">
        SELECT 
            SP.PSN_NUM           AS PSN_NUM
           ,TOC.TOC_CD           AS TOC_CD
           ,TOC.TOC_NM           AS TOC_NM
           ,CB.COA_BR_CD         AS COA_BR_CD
           ,CB.COA_BR_DESC_TXT   AS COA_BR_DESC_TXT
           ,CE.COA_EXTN_CD       AS COA_EXTN_CD
           ,CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT
           ,(CASE
                  WHEN CB.COA_BR_CD IS NOT NULL
                  THEN CB.COA_BR_CD || ':' || CB.COA_BR_DESC_TXT
             END) AS COA_BR_ITEM
           ,(CASE
                  WHEN CE.COA_EXTN_CD IS NOT NULL
                  THEN CE.COA_EXTN_CD || ':' || CE.COA_EXTN_DESC_TXT
             END) AS COA_EXTN_ITEM
        FROM 
            TOC              TOC
           ,ORG_FUNC_ROLE_TP OFRT
           ,BIZ_AREA_ORG     BA
           ,ORG_FUNC_ASG     OFA
           ,S21_PSN          SP
           ,COA_BR           CB
           ,COA_EXTN         CE
           ,S21_ORG  SO  <!-- 2016/10/21 S21_NA#14607 Add -->
        WHERE 
                TOC.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="slsRepTocNm">
            AND TOC.TOC_NM              = #slsRepTocNm#
            </isNotNull>
           AND TOC.EZCANCELFLAG        = '0'

            AND TOC.GLBL_CMPY_CD        = OFRT.GLBL_CMPY_CD
            AND TOC.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD
            AND OFRT.SLS_REP_FLG        = #slsRepFlg#
            AND OFRT.EZCANCELFLAG       = '0'

            AND OFRT.GLBL_CMPY_CD       = BA.GLBL_CMPY_CD
            AND OFRT.FIRST_ORG_CD       = BA.BIZ_AREA_ORG_CD
            AND BA.SLS_FLG              = #slsRepFlg#
            AND BA.ORG_STRU_TP_CD       = #orgStruTpCd#
            AND BA.EZCANCELFLAG         = '0'

            AND TOC.GLBL_CMPY_CD        = OFA.GLBL_CMPY_CD
            AND TOC.TOC_CD              = OFA.TOC_CD
            AND OFA.EZCANCELFLAG        = '0'

            AND OFA.GLBL_CMPY_CD        = SP.GLBL_CMPY_CD
            AND OFA.PSN_CD              = SP.PSN_CD
            <isNotNull property="slsRepPsnNum">
            AND SP.PSN_NUM              = #slsRepPsnNum#
            </isNotNull>
            AND SP.EFF_FROM_DT          &lt;= #slsDt#
            AND (SP.EFF_THRU_DT         &gt;= #slsDt# OR SP.EFF_THRU_DT IS NULL)
            AND SP.EZCANCELFLAG         = '0'

            AND TOC.GLBL_CMPY_CD        = CB.GLBL_CMPY_CD (+)
            AND TOC.COA_BR_CD           = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+)     = '0'

            AND TOC.GLBL_CMPY_CD        = CE.GLBL_CMPY_CD (+)
            AND TOC.COA_EXTN_CD         = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+)     = '0'
            <!-- 2016/10/21 S21_NA#14607 Add Start -->
            AND TOC.GLBL_CMPY_CD    = SO.GLBL_CMPY_CD
            AND TOC.TOC_CD          = SO.TOC_CD
            AND SO.RGTN_STS_CD     != #rgtnStsCd#
            AND SO.EZCANCELFLAG     = '0'
            <!-- 2016/10/21 S21_NA#14607 Add Endt -->
    </statement>

    <statement id="getMdseInfo" parameterClass="Map" resultClass="Map">
        SELECT
            MDSE.COA_PROD_CD         AS COA_PROD_CD
           ,CP.COA_PROD_DESC_TXT     AS COA_PROD_DESC_TXT
           ,CPJ.COA_PROJ_CD          AS COA_MDSE_TP_CD
           ,CPJ.COA_PROJ_DESC_TXT    AS COA_MDSE_TP_DESC_TXT
           ,DMSP.PKG_UOM_CD          AS PKG_UOM_CD
        FROM
            MDSE              MDSE
           ,COA_PROD          CP
           ,COA_PROJ          CPJ
           ,MDSE_STORE_PKG    DMSP
        WHERE
            MDSE.GLBL_CMPY_CD     = #glblCmpyCd#
            AND MDSE.MDSE_CD      = #mdseCd#
            AND MDSE.RGTN_STS_CD  = #rgtnStsCd#
            AND MDSE.EZCANCELFLAG = '0'

            AND MDSE.GLBL_CMPY_CD = CP.GLBL_CMPY_CD
            AND MDSE.COA_PROD_CD  = CP.COA_PROD_CD
            AND CP.EZCANCELFLAG   = '0'

            AND MDSE.GLBL_CMPY_CD   = CPJ.GLBL_CMPY_CD
            AND MDSE.COA_MDSE_TP_CD = CPJ.COA_PROJ_CD
            AND CPJ.EZCANCELFLAG    = '0'

            AND MDSE.GLBL_CMPY_CD = DMSP.GLBL_CMPY_CD
            AND MDSE.MDSE_CD      = DMSP.MDSE_CD
            <isEqual property="isCalledMdl" compareValue="true">
                AND DMSP.BASE_PKG_UOM_CD IS NOT NULL
            </isEqual>
            <isEqual property="isCalledMdl" compareValue="false">
                AND DMSP.PRIM_PKG_UOM_FLG = 'Y'
            </isEqual>
            AND DMSP.EZCANCELFLAG = '0'
    </statement>

    <statement id="isExistOrdCatg" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(OCBC.ORD_CATG_BIZ_CTX_PK)
        FROM
            ORD_CATG_BIZ_CTX OCBC
        WHERE
            OCBC.GLBL_CMPY_CD           = #glblCmpyCd#
            AND OCBC.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCd#
            AND OCBC.EZCANCELFLAG       = '0'
            AND (
                 (
                  OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                  AND OCBC.DS_ORD_TP_CD  IS NULL
                  AND OCBC.DS_ORD_RSN_CD IS NULL
                 )
                 <isNotNull property="dsOrdTpCd">
                 OR
                 (
                  OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                  AND OCBC.DS_ORD_TP_CD  = #dsOrdTpCd#
                  AND OCBC.DS_ORD_RSN_CD IS NULL
                 )
                 </isNotNull>
                 <isNotNull property="dsOrdTpCd">
                     <isNotNull property="dsOrdRsnCd">
                     OR
                     (
                      OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                      AND OCBC.DS_ORD_TP_CD  = #dsOrdTpCd#
                      AND OCBC.DS_ORD_RSN_CD = #dsOrdRsnCd#
                     )
                     </isNotNull>
                 </isNotNull>
                )
    </statement>

    <statement id="getBaseMdseCdFromMnfItemCd" parameterClass="Map" resultClass="String">
        SELECT
            MDSE.MDSE_CD
        FROM
            MDSE         MDSE
        WHERE
            MDSE.GLBL_CMPY_CD     = #glblCmpyCd#
            AND MDSE.MNF_ITEM_CD  = #mnfItemCd#
            AND MDSE.RGTN_STS_CD  = #rgtnStsCd#
            AND MDSE.EZCANCELFLAG = '0'
    </statement>

    <statement id="getCoaMdseTpList" parameterClass="Map" resultClass="String">
        SELECT
                  VS.COA_MDSE_TP_CD
            FROM
                MDSE_TP_VAL_SET VS
            WHERE
                VS.GLBL_CMPY_CD          = #glblCmpyCd#
                AND VS.MDSE_TP_CTX_TP_CD = #mainMach#
                AND VS.EZCANCELFLAG      = '0'
    </statement>
    <statement id="isExistWhWithDsOrdTp" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(WH.RTL_WH_CD)
        FROM
            DS_ORD_TP_LOC_ROLE_RELN              LRR
            ,LOC_USG                             LU
            ,DS_INVTY_LOC_V                      WH
        WHERE
                LRR.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND LRR.DS_ORD_TP_CD                 = #dsOrdTpCd#
            AND LRR.EZCANCELFLAG                 = '0'
            AND LRR.GLBL_CMPY_CD                 = LU.GLBL_CMPY_CD
            AND LRR.LOC_ROLE_TP_CD               = LU.LOC_ROLE_TP_CD
            AND LU.EZCANCELFLAG                  = '0'
            AND LU.GLBL_CMPY_CD                  = WH.GLBL_CMPY_CD
            AND LU.PTY_LOC_PK                    = WH.PTY_LOC_PK
            AND WH.RGTN_STS_CD                   = #rgtnStsReadyForOrderTaking#
            AND WH.EFF_FROM_DT                   <![CDATA[<=]]> #slsDt#
            AND NVL(WH.EFF_THRU_DT, '99991231')  <![CDATA[>=]]> #slsDt#
            AND UPPER(WH.RTL_WH_NM)              = UPPER(#rtlWhNm#)
            AND WH.EZCANCELFLAG                  = '0'
    </statement>

    <statement id="isExistWhWithOutDsOrdTp" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(WH.RTL_WH_CD)
        FROM
            DS_INVTY_LOC_V                       WH
        WHERE
                WH.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND WH.RGTN_STS_CD                   = #rgtnStsReadyForOrderTaking#
            AND WH.EFF_FROM_DT                   <![CDATA[<=]]> #slsDt#
            AND NVL(WH.EFF_THRU_DT, '99991231')  <![CDATA[>=]]> #slsDt#
            AND UPPER(WH.RTL_WH_NM)              = UPPER(#rtlWhNm#)
            AND WH.EZCANCELFLAG                  = '0'
    </statement>


	<!-- for CUSA retail  -->

    <statement id="getCsaOrdHdr" parameterClass="Map" resultClass="Map">
        SELECT
             COHV.RTL_DIV_CD
        FROM
            CSA_ORD_HDR_VIEW_SNAP COHV
        WHERE
                COHV.EZCANCELFLAG    = '0'
            AND COHV.GLBL_CMPY_CD    = #glblCmpyCd#
            AND COHV.CPO_ORD_NUM     = #cpoOrdNum#
            AND ROWNUM               = 1
    </statement>

    <statement id="getCsaOrdItem" parameterClass="Map" resultClass="Map">
        SELECT
             COIV.SHIP_TO_ADDR_TP_CD
            ,COIV.SVC_DLR_CD
            ,COIV.INSTL_CD
            ,COIV.ISTL_SUB_LOC_CD
            ,COIV.MACH_MDL_TP_CD
        FROM
            CSA_ORD_ITEM_VIEW_SNAP COIV
        WHERE
                COIV.EZCANCELFLAG    = '0'
            AND COIV.GLBL_CMPY_CD    = #glblCmpyCd#
            <isNotNull property="rcpoDtlSQ">
            AND COIV.RCPO_DTL_SQ     = #rcpoDtlSQ#
            </isNotNull>
            <isNotNull property="cpoOrdNum">
            AND COIV.CPO_ORD_NUM     = #cpoOrdNum#
            </isNotNull>
            <isNotNull property="instlCd">
            AND COIV.INSTL_CD        = #instlCd#
            </isNotNull>
            <isNotNull property="instlSubLocCd">
            AND COIV.ISTL_SUB_LOC_CD = #instlSubLocCd#
            </isNotNull>
        ORDER BY
             COIV.INSTL_CD
            ,COIV.ISTL_SUB_LOC_CD
            ,COIV.CPO_ORD_NUM
            ,COIV.RCPO_DTL_SQ
    </statement>

    <statement id="getFndgDlrCompAmt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             NVL(SUM(COIV.FNDG_DLR_COMP_AMT), 0)
        FROM
            CSA_ORD_ITEM_VIEW_SNAP COIV
        WHERE
                COIV.EZCANCELFLAG    = '0'
            AND COIV.GLBL_CMPY_CD    = #glblCmpyCd#
            <isNotNull property="rcpoDtlSQ">
            AND COIV.RCPO_DTL_SQ     = #rcpoDtlSQ#
            </isNotNull>
            <isNotNull property="cpoOrdNum">
            AND COIV.CPO_ORD_NUM     = #cpoOrdNum#
            </isNotNull>
            <isNotNull property="instlCd">
            AND COIV.INSTL_CD        = #instlCd#
            </isNotNull>
            <isNotNull property="instlSubLocCd">
            AND COIV.ISTL_SUB_LOC_CD = #instlSubLocCd#
            </isNotNull>
    </statement>

    <statement id="getDsImptOrdDelyInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DIODI.DS_IMPT_ORD_DELY_INFO_PK
        FROM
            DS_IMPT_ORD_DELY_INFO DIODI
        WHERE
                DIODI.EZCANCELFLAG    = '0'
            AND DIODI.GLBL_CMPY_CD    = #glblCmpyCd#
            AND DIODI.DS_IMPT_ORD_PK  = #dsImptOrdPk#
    </statement>


	<!--  for refresh -->
 
    <statement id="getSlsRepTocCdByNameAndResourceId" parameterClass="Map" resultClass="Map">
        SELECT
             SP.PSN_NUM           AS SLS_REP_PSN_NUM
            ,TOC.TOC_CD           AS SLS_REP_TOC_CD
            ,TOC.TOC_NM           AS SLS_REP_TOC_NM
            ,CB.COA_BR_CD         AS COA_BR_CD
            ,CB.COA_BR_DESC_TXT   AS COA_BR_DESC_TXT
            ,CE.COA_EXTN_CD       AS COA_EXTN_CD
            ,CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT
            ,(
             CASE
             WHEN CB.COA_BR_CD IS NOT NULL THEN
                 CB.COA_BR_CD || ':' || CB.COA_BR_DESC_TXT
             END
             )                    AS COA_BR_ITEM
            ,(
             CASE
             WHEN CE.COA_EXTN_CD IS NOT NULL THEN
                 CE.COA_EXTN_CD || ':' || CE.COA_EXTN_DESC_TXT
             END
             )                    AS COA_EXTN_ITEM
        FROM
             TOC              TOC
            ,ORG_FUNC_ROLE_TP OFRT
            ,BIZ_AREA_ORG     BA
            ,ORG_FUNC_ASG     OFA
            ,S21_PSN          SP
            ,COA_BR           CB
            ,COA_EXTN         CE
           ,S21_ORG  SO  <!-- 2016/10/21 S21_NA#14607 Add -->
        WHERE
                TOC.GLBL_CMPY_CD        =  #glblCmpyCd#
            <isNotNull property="slsRepTocNm">
            AND TOC.TOC_NM              =  #slsRepTocNm#
            </isNotNull>
            AND TOC.EZCANCELFLAG        =  '0'
            AND TOC.GLBL_CMPY_CD        =  OFRT.GLBL_CMPY_CD
            AND TOC.ORG_FUNC_ROLE_TP_CD =  OFRT.ORG_FUNC_ROLE_TP_CD
            AND OFRT.SLS_REP_FLG        =  #slsRepFlg#
            AND OFRT.EZCANCELFLAG       =  '0'
            AND OFRT.GLBL_CMPY_CD       =  BA.GLBL_CMPY_CD
            AND OFRT.FIRST_ORG_CD       =  BA.BIZ_AREA_ORG_CD
            AND BA.SLS_FLG              =  #slsRepFlg#
            AND BA.ORG_STRU_TP_CD       =  #orgStruTpCd#
            AND BA.EZCANCELFLAG         =  '0'
            AND TOC.GLBL_CMPY_CD        =  OFA.GLBL_CMPY_CD
            AND TOC.TOC_CD              =  OFA.TOC_CD
            AND OFA.EZCANCELFLAG        =  '0'
            AND OFA.GLBL_CMPY_CD        =  SP.GLBL_CMPY_CD
            AND OFA.PSN_CD              =  SP.PSN_CD
            <isNotNull property="slsRepPsnNum">
            AND SP.PSN_NUM              =  #slsRepPsnNum#
            </isNotNull>
            AND SP.EFF_FROM_DT          &lt;= #slsDt#
            AND (SP.EFF_THRU_DT         &gt;= #slsDt# OR SP.EFF_THRU_DT IS NULL)
            AND SP.EZCANCELFLAG         =  '0'
            AND TOC.GLBL_CMPY_CD        =  CB.GLBL_CMPY_CD (+)
            AND TOC.COA_BR_CD           =  CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+)     =  '0'
            AND TOC.GLBL_CMPY_CD        =  CE.GLBL_CMPY_CD (+)
            AND TOC.COA_EXTN_CD         =  CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+)     =  '0'

            <!-- 2016/10/21 S21_NA#14607 Add Start -->
            AND TOC.GLBL_CMPY_CD    = SO.GLBL_CMPY_CD
            AND TOC.TOC_CD          = SO.TOC_CD
            AND SO.RGTN_STS_CD     != #rgtnStsCd#
            AND SO.EZCANCELFLAG     = '0'
            <!-- 2016/10/21 S21_NA#14607 Add Endt -->
        ORDER BY
            TOC.TOC_CD
    </statement>
 
    <statement id="getFrtCondCdByName" parameterClass="Map" resultClass="Map">
        SELECT
            FC.FRT_COND_CD
        FROM
            FRT_COND FC
        WHERE
                FC.EZCANCELFLAG      = '0'
            AND FC.GLBL_CMPY_CD      = #glblCmpyCd#
            AND FC.FRT_COND_DESC_TXT = #frtCondDescTxt#
        ORDER BY
            FC.FRT_COND_SORT_NUM
    </statement>
 
    <statement id="getCarrSvcLvlCdByName" parameterClass="Map" resultClass="Map">
        SELECT
            CSL.CARR_SVC_LVL_CD
        FROM
            CARR_SVC_LVL CSL
        WHERE
                CSL.EZCANCELFLAG                 = '0'
            AND CSL.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND UPPER(CSL.CARR_SVC_LVL_DESC_TXT) = #carrSvcLvlDescTxt#
        ORDER BY
            CSL.CARR_SVC_LVL_SORT_NUM
    </statement>
 
    <statement id="getPmtTermCashDiscCdByName" parameterClass="Map" resultClass="Map">
        SELECT
            PTCD.PMT_TERM_CASH_DISC_CD
        FROM
            PMT_TERM_CASH_DISC PTCD
        WHERE
                PTCD.EZCANCELFLAG                = '0'
            AND PTCD.GLBL_CMPY_CD                = #glblCmpyCd#
            AND PTCD.PMT_TERM_CASH_DISC_DESC_TXT = #pmtTermCashDiscDescTxt#
        ORDER BY
            PTCD.PMT_TERM_CASH_DISC_SORT_NUM
    </statement>
 
    <statement id="getRtlWhCdByName" parameterClass="Map" resultClass="Map">
         SELECT 
             RW.RTL_WH_CD
         FROM
             RTL_WH RW
         WHERE
             RW.GLBL_CMPY_CD     = #glblCmpyCd#
             AND RW.RTL_WH_NM    = #rtlWhNm#
             AND RW.EZCANCELFLAG = '0'
         ORDER BY
             RW.RTL_WH_CD
    </statement>
 
    <statement id="getRtlSwhCdByName" parameterClass="Map" resultClass="Map">
         SELECT 
             RSW.RTL_SWH_CD
         FROM
             RTL_SWH RSW
         WHERE
             RSW.GLBL_CMPY_CD     = #glblCmpyCd#
             AND RSW.RTL_WH_CD    = #rtlWhCd#
             AND RSW.RTL_SWH_NM   = #rtlSwhNm#
             AND RSW.EZCANCELFLAG = '0'
         ORDER BY
             RSW.RTL_SWH_CD
    </statement>

    <statement id="getDsAcctProsCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                COUNT(DAP.DS_ACCT_PROS_PK)
            FROM
                 DS_ACCT_PROS DAP
            WHERE 
                    DAP.GLBL_CMPY_CD = #glblCmpyCd#
                AND DAP.DS_ACCT_NUM  = #dsAcctNum#
                AND DAP.EZCANCELFLAG = '0'
    </statement>

    <statement id="getItrlOrdProcFlg" parameterClass="Map" resultClass="String">
          SELECT 
                 PT.ITRL_ORD_PROC_FLG
          FROM  
                 DS_ORD_TP_PROC_DFN PD
                ,ORD_PROC_TP  PT
          WHERE 
                 PD.GLBL_CMPY_CD    = #glblCmpyCd#
             AND PD.DS_ORD_TP_CD    = #dsOrdTpCd#
             AND PD.EFF_FROM_DT     &lt;= #slsDt#
             AND (
                    PD.EFF_THRU_DT       &gt;= #slsDt#
                 OR PD.EFF_THRU_DT       IS NULL
                    )
             AND PD.ACTV_FLG        = 'Y'
             AND PD.EZCANCELFLAG    = '0'

             AND PD.GLBL_CMPY_CD    = PT.GLBL_CMPY_CD
             AND PD.ORD_PROC_TP_CD  = PT.ORD_PROC_TP_CD
             AND PT.EFF_FROM_DT     &lt;= #slsDt#
             AND (
                    PT.EFF_THRU_DT       &gt;= #slsDt#
                 OR PT.EFF_THRU_DT       IS NULL
                    )
            AND PT.ACTV_FLG        = 'Y'
            AND PT.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getFreightTermInfoList"  parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            FC.FRT_COND_CD       AS FRT_COND_CD
           ,FC.FRT_COND_DESC_TXT AS FRT_COND_DESC_TXT
        FROM
            FRT_COND              FC
           ,FRT_COND_SVC_LVL_RELN FCSLR
        WHERE
            FC.GLBL_CMPY_CD          = #glblCmpyCd#
            AND FC.FRT_COND_DESC_TXT LIKE #frtCondDescTxt#
            AND FC.EZCANCELFLAG      = '0'

            AND FC.GLBL_CMPY_CD      = FCSLR.GLBL_CMPY_CD
            AND FC.FRT_COND_CD       = FCSLR.FRT_COND_CD
            AND FCSLR.LINE_BIZ_TP_CD = #lineBizTpCd#
            AND FCSLR.EZCANCELFLAG   = '0'
    </statement>

    <statement id="getShpgSvcLvlDataList" parameterClass="Map" resultClass="Map">
        SELECT 
            SSL.SHPG_SVC_LVL_CD
            ,SSL.SHPG_SVC_LVL_DESC_TXT
            ,SSL.SHPG_SVC_LVL_SORT_NUM
        FROM 
            SHPG_SVC_LVL SSL
            ,FRT_COND_SVC_LVL_RELN FCSLR
        WHERE
                SSL.GLBL_CMPY_CD        = #glblCmpyCd#
            AND SSL.GLBL_CMPY_CD        = FCSLR.GLBL_CMPY_CD
            AND SSL.SHPG_SVC_LVL_CD     = FCSLR.SHPG_SVC_LVL_CD
            AND FCSLR.LINE_BIZ_TP_CD    = #lineBizTpCd#
            <isNotNull property="frtCondCd">
                AND FCSLR.FRT_COND_CD   = #frtCondCd#
            </isNotNull>
            AND SSL.EZCANCELFLAG = '0'
            AND FCSLR.EZCANCELFLAG = '0'
        GROUP BY
            SSL.SHPG_SVC_LVL_CD
            ,SSL.SHPG_SVC_LVL_DESC_TXT
            ,SSL.SHPG_SVC_LVL_SORT_NUM
        ORDER BY
            SSL.SHPG_SVC_LVL_SORT_NUM
    </statement>

    <statement id="getOrigCpoOrdNum" parameterClass="Map" resultClass="String">
        SELECT
		    DC.CPO_ORD_NUM
		FROM
		    CPO  DC
		WHERE
		        DC.GLBL_CMPY_CD    = #glblCmpyCd#
		    AND DC.DS_IMPT_ORD_PK  = #dsImptOrdPk#
		    AND DC.EZCANCELFLAG    = '0'
		<!-- 2018/01/23 QC#18798 Add Start-->
		ORDER BY
		    DC.CPO_ORD_NUM DESC
		<!-- 2018/01/23 QC#18798 Add End-->
    </statement>

	<statement id="getSvcMachMstrPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SM.SVC_MACH_MSTR_PK
        FROM
            SVC_MACH_MSTR  SM
        WHERE
                SM.GLBL_CMPY_CD = #glblCmpyCd#
            AND SM.EZCANCELFLAG = '0'
            AND SM.MDSE_CD      LIKE #mdseCd#
            AND SM.SER_NUM      = #serNum#
    </statement>

    <statement id="getTrnsfAmt" parameterClass="Map" resultClass="Map">
        SELECT 
                REF.DS_IMPT_ORD_DTL_PK
              , NVL(SUM(REF.DEAL_SVC_REV_TRNSF_AMT), 0)  AS SUM_DEAL_SVC_REV_TRNSF_AMT
              , NVL(SUM(REF.DEAL_SVC_COST_TRNSF_AMT), 0) AS SUM_DEAL_SVC_COST_TRNSF_AMT
        FROM 
                DS_IMPT_SVC_CONFIG_REF REF
        WHERE 
                REF.GLBL_CMPY_CD             = #glblCmpyCd#
            AND REF.DS_IMPT_ORD_DTL_PK       = #dsImptOrdDtlPk#
            AND REF.EZCANCELFLAG             = '0'
        GROUP BY
                REF.DS_IMPT_ORD_DTL_PK
    </statement>

<!-- 2017/11/28 QC#22782 add start -->
    <statement id="getOrigCpoOrdNumFromConfig" parameterClass="Map" resultClass="String">
        SELECT DISTINCT
            SMM.CPO_ORD_NUM
        FROM
            SVC_CONFIG_MSTR SCM
            , SVC_MACH_MSTR SMM
        WHERE
                SCM.GLBL_CMPY_CD             = #glblCmpyCd#
            <isNotNull property="svcConfigMstrPkList">
                AND SCM.SVC_CONFIG_MSTR_PK IN (
              <iterate property="svcConfigMstrPkList" var="svcConfigMstrPk[]" open="" close="" conjunction=",">
                  #svcConfigMstrPk[]#
              </iterate>
               )
            </isNotNull>
            AND SCM.EZCANCELFLAG             = '0'

            AND SCM.GLBL_CMPY_CD             = SMM.GLBL_CMPY_CD
            AND SCM.SVC_MACH_MSTR_PK         = SMM.SVC_MACH_MSTR_PK
            AND SCM.EZCANCELFLAG             = SMM.EZCANCELFLAG  
    </statement>
<!-- 2017/11/28 QC#22782 add end -->

    <!-- 2018/01/23 QC#18798 Add Start -->
    <statement id="getOrdCatgBizCtx" parameterClass="Map" resultClass="String">
        SELECT 
                #flgY#
          FROM
                ORD_CATG_BIZ_CTX OCBC
         WHERE
                OCBC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND OCBC.EZCANCELFLAG        = '0'
            AND OCBC.ORD_CATG_CTX_TP_CD  = #ordCatgCtxTpCd#
        <isNotNull property="dsOrdCatgCd">
            AND (OCBC.DS_ORD_CATG_CD = #dsOrdCatgCd# OR OCBC.DS_ORD_CATG_CD IS NULL)
        </isNotNull>
        <isNull property="dsOrdCatgCd">
            AND OCBC.DS_ORD_CATG_CD IS NULL
        </isNull>
        <isNotNull property="dsOrdTpCd">
            AND (OCBC.DS_ORD_TP_CD = #dsOrdTpCd# OR OCBC.DS_ORD_TP_CD IS NULL)
        </isNotNull>
        <isNull property="dsOrdTpCd">
            AND OCBC.DS_ORD_TP_CD IS NULL
        </isNull>
    </statement>

    <statement id="getSalesRepList" parameterClass="Map" resultClass="Map">
        SELECT 
            T.TOC_NM
            ,CE.COA_EXTN_CD
            ,CE.COA_EXTN_DESC_TXT
            ,CB.COA_BR_CD
            ,CB.COA_BR_DESC_TXT
            ,CC.COA_CC_CD
            ,CC.COA_CC_DESC_TXT
            ,T.TOC_CD
            ,SP.PSN_NUM
        FROM 
            TOC T
            ,COA_EXTN CE
            ,COA_BR   CB
            ,COA_CC   CC
            ,ORG_FUNC_ASG OFA
            ,S21_PSN SP
        WHERE 
                T.GLBL_CMPY_CD        = #glblCmpyCd#
            AND T.EZCANCELFLAG        = '0'
            <isNotNull property="slsRepTocCd">
            AND T.TOC_CD              = #slsRepTocCd#
            </isNotNull>
            AND T.GLBL_CMPY_CD        = OFA.GLBL_CMPY_CD
            AND T.TOC_CD              = OFA.TOC_CD
            AND OFA.EZCANCELFLAG      = '0'
            AND OFA.GLBL_CMPY_CD      = SP.GLBL_CMPY_CD
            AND OFA.PSN_CD            = SP.PSN_CD
            AND SP.EZCANCELFLAG       = '0'
            AND T.GLBL_CMPY_CD        = CE.GLBL_CMPY_CD (+)
            AND T.COA_EXTN_CD         = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+)   = '0'
            AND T.GLBL_CMPY_CD        = CB.GLBL_CMPY_CD (+)
            AND T.COA_BR_CD           = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+)   = '0'
            AND T.GLBL_CMPY_CD        = CC.GLBL_CMPY_CD (+)
            AND T.COA_CC_CD           = CC.COA_CC_CD (+)
            AND CC.EZCANCELFLAG (+)   = '0'
    </statement>

    <statement id="getOrdCatgBizCtxFstAttbTxt" parameterClass="Map" resultClass="String">
        SELECT 
                OCBC.FIRST_BIZ_CTX_ATTRB_TXT
          FROM
                ORD_CATG_BIZ_CTX OCBC
         WHERE
                OCBC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND OCBC.EZCANCELFLAG        = '0'
            AND OCBC.ORD_CATG_CTX_TP_CD  = #ordCatgCtxTpCd#
        <isNotNull property="dsOrdCatgCd">
            AND (OCBC.DS_ORD_CATG_CD = #dsOrdCatgCd# OR OCBC.DS_ORD_CATG_CD IS NULL)
        </isNotNull>
        <isNull property="dsOrdCatgCd">
            AND OCBC.DS_ORD_CATG_CD IS NULL
        </isNull>
        <isNotNull property="dsOrdTpCd">
            AND (OCBC.DS_ORD_TP_CD = #dsOrdTpCd# OR OCBC.DS_ORD_TP_CD IS NULL)
        </isNotNull>
        <isNull property="dsOrdTpCd">
            AND OCBC.DS_ORD_TP_CD IS NULL
        </isNull>
    </statement>

    <statement id="getRmaConfigPkList" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            DIOC.DS_IMPT_ORD_CONFIG_PK
        FROM
            DS_IMPT_ORD_CONFIG DIOC
        WHERE
                DIOC.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIOC.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIOC.EOPS_CONFIG_LTR_TXT IN (
                                            SELECT
                                                DIOC2.EOPS_CONFIG_LTR_TXT
                                            FROM
                                                DS_IMPT_ORD_CONFIG DIOC2
                                            WHERE
                                                    DIOC2.GLBL_CMPY_CD          = #glblCmpyCd#
                                                AND DIOC2.DS_IMPT_ORD_CONFIG_PK = #dsImptOrdConfigPk#
                                                AND DIOC2.EZCANCELFLAG          = '0'
                                            )
            AND DIOC.CONFIG_CATG_CD = #inbondConfigCatgCd#
            AND DIOC.EZCANCELFLAG = '0'
    </statement>
    <!-- 2018/01/23 QC#18798 Add End -->
    <!-- 2018/03/20 QC#24840 Add Start -->
    <statement id="getOrdCatgBizCtxScdAttbTxt" parameterClass="Map" resultClass="String">
        SELECT 
                OCBC.SCD_BIZ_CTX_ATTRB_TXT
          FROM
                ORD_CATG_BIZ_CTX OCBC
         WHERE
                OCBC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND OCBC.EZCANCELFLAG        = '0'
            AND OCBC.ORD_CATG_CTX_TP_CD  = #ordCatgCtxTpCd#
        <isNotNull property="dsOrdCatgCd">
            AND (OCBC.DS_ORD_CATG_CD = #dsOrdCatgCd# OR OCBC.DS_ORD_CATG_CD IS NULL)
        </isNotNull>
        <isNull property="dsOrdCatgCd">
            AND OCBC.DS_ORD_CATG_CD IS NULL
        </isNull>
        <isNotNull property="dsOrdTpCd">
            AND (OCBC.DS_ORD_TP_CD = #dsOrdTpCd# OR OCBC.DS_ORD_TP_CD IS NULL)
        </isNotNull>
        <isNull property="dsOrdTpCd">
            AND OCBC.DS_ORD_TP_CD IS NULL
        </isNull>
    </statement>
    <!-- 2018/03/20 QC#24840 Add End -->
    <!-- 2018/11/05 QC#27364 Add Start -->
    <statement id="getImptSvcForBand" parameterClass="Map" resultClass="Map">
        <!-- START 03/16/2023 A.Cullano [QC#61314, MOD] -->
        <!-- SELECT  --> 
        SELECT DISTINCT
        <!-- START 03/16/2023 A.Cullano [QC#61314, MOD] -->
              DISP.MAINT_PRC_CATG_CD
             ,DISP.MDL_ID
             ,DISP.PRC_MTR_PKG_PK
             ,DISD.PRC_SVC_PLN_TP_CD
             ,DISD.PRC_SVC_CONTR_TP_CD
             ,DISUP.BLLG_MTR_LB_CD
             ,DIST.SPLY_AGMT_PLN_SHORT_NM
             ,DISUP.DS_IMPT_SVC_USG_PRC_PK
             ,DISUP.EZUPTIME
             ,DISUP.EZUPTIMEZONE
        FROM DS_IMPT_ORD                DIO
            ,DS_IMPT_SVC_DTL            DISD
            ,DS_IMPT_SVC_PRC            DISP
            ,DS_IMPT_SVC_USG_PRC        DISUP
            ,DS_IMPT_SCHD_TMPL          DIST
            ,PRC_CATG                   PC
        WHERE 
                DIO.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DIO.DS_IMPT_ORD_PK       = #dsImptOrdPk#
            AND DIO.EZCANCELFLAG         = '0'
            AND DIO.GLBL_CMPY_CD         = DISD.GLBL_CMPY_CD
            AND DIO.DS_IMPT_ORD_PK       = DISD.DS_IMPT_ORD_PK
            AND DIO.EZCANCELFLAG         = DISD.EZCANCELFLAG
            AND DISD.GLBL_CMPY_CD        = DISP.GLBL_CMPY_CD
            AND DISD.DS_IMPT_SVC_DTL_PK  = DISP.DS_IMPT_SVC_DTL_PK
            AND DISD.EZCANCELFLAG        = DISP.EZCANCELFLAG
            AND DISP.GLBL_CMPY_CD        = DISUP.GLBL_CMPY_CD
            AND DISP.DS_IMPT_SVC_PRC_PK  = DISUP.DS_IMPT_SVC_PRC_PK
            AND DISP.EZCANCELFLAG        = DISUP.EZCANCELFLAG
            AND DISD.GLBL_CMPY_CD        = DIST.GLBL_CMPY_CD(+)
            AND DISD.DS_IMPT_SVC_DTL_PK  = DIST.DS_IMPT_SVC_DTL_PK(+)
            AND DISD.EZCANCELFLAG        = DIST.EZCANCELFLAG(+)
            AND DISP.GLBL_CMPY_CD        = PC.GLBL_CMPY_CD
            AND DISP.MAINT_PRC_CATG_CD   = PC.PRC_CATG_CD
            AND DISP.EZCANCELFLAG        = PC.EZCANCELFLAG
            AND DISUP.PRC_LIST_BAND_CD    IS NULL
    </statement>
    <statement id="getPrcListBandCdPrcBookMdseCd" parameterClass="Map" resultClass="Map">
        SELECT
             PLS.PRC_LIST_BAND_CD
            ,PLS.MDSE_CD
        FROM
            PRC_LIST_SVC PLS
        WHERE
                PLS.GLBL_CMPY_CD        = #glblCmpyCd#
            AND PLS.EZCANCELFLAG        = '0'
            AND PLS.PRC_CATG_CD         = #prcCatgCd#
            AND PLS.MDL_ID              = #mdlId#
            AND PLS.PRC_MTR_PKG_PK      = #prcMtrPkgPk#
            AND PLS.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTpCd#
            AND PLS.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
            AND PLS.BLLG_MTR_LB_CD      = #bllgMtrLbCd#
            AND PLS.EFF_FROM_DT         &lt;= #slsDt#
            AND (PLS.EFF_THRU_DT        IS NULL
                 OR PLS.EFF_THRU_DT     &gt;= #slsDt#)
            AND PLS.PRC_RATE_TP_CD      = #prcRateTp#
        UNION ALL
        SELECT
             PLST.PRC_LIST_BAND_CD
            ,PLST.MDSE_CD
        FROM
            PRC_LIST_SVC_TIER PLST
        WHERE
                PLST.GLBL_CMPY_CD        = #glblCmpyCd#
            AND PLST.EZCANCELFLAG        = '0'
            AND PLST.PRC_CATG_CD         = #prcCatgCd#
            AND PLST.MDL_ID              = #mdlId#
            AND PLST.PRC_MTR_PKG_PK      = #prcMtrPkgPk#
            AND PLST.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTpCd#
            AND PLST.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
            AND PLST.BLLG_MTR_LB_CD      = #bllgMtrLbCd#
            AND PLST.EFF_FROM_DT         &lt;= #slsDt#
            AND (PLST.EFF_THRU_DT        IS NULL
                OR PLST.EFF_THRU_DT      &gt;= #slsDt#)
        UNION ALL
        SELECT
             PLSP.PRC_LIST_BAND_CD
            ,PLSP.MDSE_CD
        FROM
            PRC_LIST_SPLY_PGM   PLSP
            , SPLY_AGMT_PLN     SAP
        WHERE
                PLSP.GLBL_CMPY_CD        = #glblCmpyCd#
            AND PLSP.EZCANCELFLAG        = '0'
            AND PLSP.PRC_CATG_CD         = #prcCatgCd#
            AND PLSP.MDL_ID              = #mdlId#
            AND PLSP.PRC_MTR_PKG_PK      = #prcMtrPkgPk#
            AND PLSP.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTpCd#
            AND PLSP.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#
            AND PLSP.BLLG_MTR_LB_CD      = #bllgMtrLbCd#
            AND PLSP.EFF_FROM_DT         &lt;= #slsDt#
            AND (PLSP.EFF_THRU_DT        IS NULL
                OR PLSP.EFF_THRU_DT      &gt;= #slsDt#)
                --
            AND PLSP.GLBL_CMPY_CD           = SAP.GLBL_CMPY_CD
            AND PLSP.SPLY_AGMT_PLN_PK       = SAP.SPLY_AGMT_PLN_PK
            <isNotNull property="splyAgmtPlnShortNm">
            AND SAP.SPLY_AGMT_PLN_SHORT_NM  = #splyAgmtPlnShortNm#
            </isNotNull>
            AND SAP.EZCANCELFLAG            = '0'
        ORDER BY
            PRC_LIST_BAND_CD ASC
    </statement>
    <!-- 2018/11/05 QC#27364 Add End -->
</sqlMap>
