<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NMAL6830Query">

    <statement id ="getCostTypeList" parameterClass="Map"  resultClass="Map">
        SELECT 
            T.MDSE_CST_UPD_TP_CD 
           ,T.MDSE_CST_UPD_TP_NM
        FROM 
            MDSE_CST_UPD_TP T
        WHERE 
            T.EZCANCELFLAG = '0'
        AND T.GLBL_CMPY_CD = #glblCmpyCd#
        AND T.MDSE_CST_UPD_TP_CD IN ('VU', 'EU', 'AP')
        <!-- TODO AND T.APVL_REQ_FLG = 'Y' --> 
        ORDER BY MDSE_CST_UPD_TP_SORT_NUM
    </statement>
    
    <typeAlias alias="NMAL6830_ASMsg"   type="business.blap.NMAL6830.NMAL6830_ASMsg"/>

    <resultMap id="result.getMdseUpdGroupList"    class="NMAL6830_ASMsg">
        <result property="mdseCstUpdGrpTxt_A1"   column="MDSE_CST_UPD_GRP_TXT"    javaType="EZDSStringItem"/>
        <result property="mdseCstUpdTpNm_A1"     column="MDSE_CST_UPD_TP_NM"      javaType="EZDSStringItem"/>
        <result property="mdseCstUpdTpCd_A1"     column="MDSE_CST_UPD_TP_CD"      javaType="EZDSStringItem"/>
        <result property="mdseCstUpdDescTxt_A1"  column="MDSE_CST_UPD_DESC_TXT"   javaType="EZDSStringItem"/>
        <result property="mdseCstUpdRefTxt_A1"   column="MDSE_CST_UPD_REF_TXT"    javaType="EZDSStringItem"/>
        <result property="mdseCstUpdRefId_A1"    column="MDSE_CST_UPD_REF_ID"     javaType="EZDSStringItem"/>
    </resultMap>
    <statement id="getMdseUpdGroupList" parameterClass="Map" resultMap="result.getMdseUpdGroupList">
        SELECT 
            TMP.MDSE_CST_UPD_GRP_TXT
           ,TMP.MDSE_CST_UPD_TP_CD
           ,TMP.MDSE_CST_UPD_TP_NM
           ,TMP.MDSE_CST_UPD_DESC_TXT
           ,TMP.MDSE_CST_UPD_REF_TXT
           ,TMP.MDSE_CST_UPD_REF_ID
        FROM (
        SELECT
            distinct 
            H.MDSE_CST_UPD_GRP_TXT
           ,H.MDSE_CST_UPD_TP_CD
           ,T.MDSE_CST_UPD_TP_NM
           ,H.MDSE_CST_UPD_DESC_TXT
           ,H.MDSE_CST_UPD_REF_TXT
           ,H.MDSE_CST_UPD_REF_ID
           ,H.MDSE_CST_UPD_CRAT_DT
        FROM
            MDSE_CST_UPD_HIST_HDR H
           ,MDSE_CST_UPD_HIST_DTL D
           ,MDSE_CST_UPD_TP T
        WHERE
            H.EZCANCELFLAG = '0'
        AND H.GLBL_CMPY_CD = 'ADB'
        AND H.EZCANCELFLAG = D.EZCANCELFLAG
        AND H.GLBL_CMPY_CD = D.GLBL_CMPY_CD
        AND H.MDSE_CST_UPD_HIST_HDR_PK = D.MDSE_CST_UPD_HIST_HDR_PK
        AND H.EZCANCELFLAG = T.EZCANCELFLAG (+)
        AND H.GLBL_CMPY_CD = T.GLBL_CMPY_CD (+)
        AND H.MDSE_CST_UPD_TP_CD = T.MDSE_CST_UPD_TP_CD (+)
        <isNotNull property="mdseCstUpdGrpTxt">
        AND H.MDSE_CST_UPD_GRP_TXT like #mdseCstUpdGrpTxt#
        </isNotNull>
        <isNotNull property="mdseCstUpdDescTxt">
        AND H.MDSE_CST_UPD_DESC_TXT like #mdseCstUpdDescTxt#
        </isNotNull>
        <isNotNull property="mdseCstUpdTpCd">
        AND H.MDSE_CST_UPD_TP_CD = #mdseCstUpdTpCd#
        </isNotNull>
        <isNotNull property="mdseCstUpdRefTxt">
        AND H.MDSE_CST_UPD_REF_TXT like #mdseCstUpdRefTxt#
        </isNotNull>
        <isNotNull property="mdseCstUpdRefId">
        AND H.MDSE_CST_UPD_REF_ID like #mdseCstUpdRefId#
        </isNotNull>
        <isNotNull property="mdseCstUpdStsCd">
        AND D.MDSE_CST_UPD_STS_CD = #mdseCstUpdStsCd#
        </isNotNull>
        ORDER BY H.MDSE_CST_UPD_CRAT_DT
        ) TMP
        WHERE
            ROWNUM &lt;= #rowNum#
        
    </statement>
</sqlMap>

