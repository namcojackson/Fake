<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB035001">
    <statement id="getHeaderUpldWrk" parameterClass="Map" resultClass="Map">
        SELECT
             IHUW.MDSE_CD                    AS MDSE_CD
            ,IHUW.UPLD_CSV_RQST_PK           AS UPLD_CSV_RQST_PK
            ,IHUW.UPLD_CSV_RQST_ROW_NUM      AS UPLD_CSV_RQST_ROW_NUM
            ,IHUW.COA_PROD_CD                AS COA_PROD_CD
            ,IHUW.COA_MDSE_TP_CD             AS COA_MDSE_TP_CD
            ,IHUW.MKT_MDL_CD                 AS MKT_MDL_CD
            ,IHUW.FRTH_PROD_CTRL_CD          AS FRTH_PROD_CTRL_CD
            ,IHUW.SLS_MAT_GRP_CD_01          AS SLS_MAT_GRP_CD_01
            ,IHUW.SLS_MAT_GRP_CD_02          AS SLS_MAT_GRP_CD_02
            ,IHUW.SLS_MAT_GRP_CD_03          AS SLS_MAT_GRP_CD_03
            ,IHUW.UPLD_CSV_RQST_CMNT_TXT     AS UPLD_CSV_RQST_CMNT_TXT
        FROM
            ITEM_HDR_UPLD_WRK IHUW
        WHERE
            IHUW.GLBL_CMPY_CD                = #glblCmpyCd#
            AND IHUW.UPLD_CSV_RQST_PK        = #upldCsvRqstPk#
            AND IHUW.EZCANCELFLAG            = '0'
        ORDER BY
            IHUW.UPLD_CSV_RQST_ROW_NUM
    </statement>
    
    <statement id ="getSlsMatGrp" parameterClass="Map"  resultClass="Map">
        SELECT 
            SMG.SLS_MAT_GRP_CD
           ,SMG.SLS_MAT_GRP_DESC_TXT
        FROM 
            SLS_MAT_GRP SMG
        WHERE 
            SMG.EZCANCELFLAG = '0'
        AND SMG.GLBL_CMPY_CD = #glblCmpyCd#
        AND SMG.SLS_MAT_GRP_CD = #slsMatGrpCd#
        AND SMG.SLS_MAT_GRP_SQ_NUM = #slsMatGrpSqNum#
    </statement>
    
    <statement id="getCoaAcct" parameterClass="Map" resultClass="Map">
            SELECT 
                B.COA_PROJ_ACCT_TP_CD
               ,B.COA_ACCT_CD
            FROM
                COA_PROJ_ACCT_TP A
               ,COA_PROJ_ACCT B
            WHERE 
                    A.INVTY_ACCT_FLG      = #invtyAcctFlgY#
                AND A.COA_PROJ_ACCT_TP_CD &lt;&gt; #projAcctTpCrRibl#
                AND A.GLBL_CMPY_CD        = #glblCmpyCd#
                AND A.EZCANCELFLAG        = '0'
                AND A.COA_PROJ_ACCT_TP_CD = B.COA_PROJ_ACCT_TP_CD
                AND A.GLBL_CMPY_CD        = B.GLBL_CMPY_CD
                AND A.EZCANCELFLAG        = B.EZCANCELFLAG
                AND B.COA_PROJ_CD         = #mdseTpCd#
            ORDER BY
                    B.COA_PROJ_ACCT_TP_CD
    </statement>
    
    <statement id="getInventoryCount" parameterClass="Map" resultClass="BigDecimal">
            SELECT 
                COUNT(*) AS COUNT
            FROM
                INVTY A
            WHERE 
                    A.GLBL_CMPY_CD     = #glblCmpyCd#
                AND A.EZCANCELFLAG     = '0'
                AND A.MDSE_CD          = #mdseCd#
                AND A.INVTY_QTY        &lt;&gt; 0
    </statement>

    <statement id ="getTransactionDataCPOAndPO" parameterClass="Map" resultClass="Integer">
        SELECT sum(CNT) from (
        SELECT
            count(*) CNT
        FROM 
            CPO_DTL C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND MDSE_CD = #mdseCd#
        <iterate property="ordLineStsCd" var="ordLineStsCd[]" open="AND ORD_LINE_STS_CD NOT IN (" close=" )" conjunction=",">
            #ordLineStsCd[]#
        </iterate>
        <isNotNull property="mdseCd8Digit">
        UNION
        SELECT
            count(*)
        FROM 
            CPO_DTL C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND MDSE_CD = #mdseCd8Digit#
        <iterate property="ordLineStsCd" var="ordLineStsCd[]" open="AND ORD_LINE_STS_CD NOT IN (" close=" )" conjunction=",">
            #ordLineStsCd[]#
        </iterate>
        </isNotNull>
        UNION
        SELECT
            count(*)
        FROM 
            DS_CPO_RTRN_DTL C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND MDSE_CD = #mdseCd#
        <iterate property="rtrnLineStsCd" var="rtrnLineStsCd[]" open="AND RTRN_LINE_STS_CD NOT IN (" close=" )" conjunction=",">
            #rtrnLineStsCd[]#
        </iterate>
        <isNotNull property="mdseCd8Digit">
        UNION
        SELECT
            count(*)
        FROM 
            DS_CPO_RTRN_DTL C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND MDSE_CD = #mdseCd8Digit#
        <iterate property="rtrnLineStsCd" var="rtrnLineStsCd[]" open="AND RTRN_LINE_STS_CD NOT IN (" close=" )" conjunction=",">
            #rtrnLineStsCd[]#
        </iterate>
        </isNotNull>
        UNION
        SELECT
            count(*)
        FROM 
            PO_DTL C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND MDSE_CD = #mdseCd#
        <iterate property="poStsCd" var="poStsCd[]" open="AND PO_STS_CD NOT IN (" close=" )" conjunction=",">
            #poStsCd[]#
        </iterate>
        <isNotNull property="mdseCd8Digit">
        UNION
        SELECT
            count(*)
        FROM 
            PO_DTL C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND MDSE_CD = #mdseCd8Digit#
        <iterate property="poStsCd" var="poStsCd[]" open="AND PO_STS_CD NOT IN (" close=" )" conjunction=",">
            #poStsCd[]#
        </iterate>
        </isNotNull>
        )
    </statement>
    
    <statement id ="getMdseTpValSet" parameterClass="Map"  resultClass="Map">
        SELECT 
            MTVS.MDSE_TP_VAL_SET_PK
        FROM 
            MDSE_TP_VAL_SET MTVS
        WHERE 
            MTVS.EZCANCELFLAG = '0'
        AND MTVS.GLBL_CMPY_CD = #glblCmpyCd#
        AND MTVS.MDSE_TP_CTX_TP_CD = #mdseTpCtxTpCd#
        AND MTVS.FIRST_BIZ_CTX_ATTRB_TXT = #mdseItemTpCd#
        AND MTVS.COA_MDSE_TP_CD = #coaMdseTpCd#
    </statement>
    
    <statement id ="getIntgProdCatgConvPriorityList" parameterClass="Map"  resultClass="Map">
        --All Value Set
        SELECT 
            '1' PRIORITY
           ,C.MDSE_ITEM_TP_CD
           ,C.COA_MDSE_TP_CD
           ,C.SW_LIC_CTRL_TP_CD
           ,C.SW_CATG_CD
           ,C.INTNT_CONN_SW_CTRL_FLG
           ,C.INTG_PROD_CATG_CD
           ,C.MDSE_TP_CD
           ,C.MDSE_CATG_CD
        FROM 
            INTG_PROD_CATG_CONV C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND C.MDSE_ITEM_TP_CD = #mdseItemTpCd#
        <isNotNull property="coaMdseTpCd">
        AND C.COA_MDSE_TP_CD = #coaMdseTpCd#
        </isNotNull>
        <isNull property="coaMdseTpCd">
        AND C.COA_MDSE_TP_CD IS NULL
        </isNull>
        <isNotNull property="swLicCtrlTpCd">
        AND C.SW_LIC_CTRL_TP_CD = #swLicCtrlTpCd#
        </isNotNull>
        <isNull property="swLicCtrlTpCd">
        AND C.SW_LIC_CTRL_TP_CD IS NULL
        </isNull>
        <isNotNull property="swCatgCd">
        AND C.SW_CATG_CD = #swCatgCd#
        </isNotNull>
        <isNull property="swCatgCd">
        AND C.SW_CATG_CD IS NULL
        </isNull>
        UNION
        --SW_CATG_CD ALL
        SELECT 
            '2' PRIORITY
           ,C.MDSE_ITEM_TP_CD
           ,C.COA_MDSE_TP_CD
           ,C.SW_LIC_CTRL_TP_CD
           ,C.SW_CATG_CD
           ,C.INTNT_CONN_SW_CTRL_FLG
           ,C.INTG_PROD_CATG_CD
           ,C.MDSE_TP_CD
           ,C.MDSE_CATG_CD
        FROM 
            INTG_PROD_CATG_CONV C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND C.MDSE_ITEM_TP_CD = #mdseItemTpCd#
        <isNotNull property="coaMdseTpCd">
        AND C.COA_MDSE_TP_CD = #coaMdseTpCd#
        </isNotNull>
        <isNull property="coaMdseTpCd">
        AND C.COA_MDSE_TP_CD IS NULL
        </isNull>
        <isNotNull property="swLicCtrlTpCd">
        AND C.SW_LIC_CTRL_TP_CD = #swLicCtrlTpCd#
        </isNotNull>
        <isNull property="swLicCtrlTpCd">
        AND C.SW_LIC_CTRL_TP_CD IS NULL
        </isNull>
        AND C.SW_CATG_CD = '*' 
        UNION 
        --SW_LIC_CTRL_TP_CD ALL
        SELECT 
            '3' PRIORITY
           ,C.MDSE_ITEM_TP_CD
           ,C.COA_MDSE_TP_CD
           ,C.SW_LIC_CTRL_TP_CD
           ,C.SW_CATG_CD
           ,C.INTNT_CONN_SW_CTRL_FLG
           ,C.INTG_PROD_CATG_CD
           ,C.MDSE_TP_CD
           ,C.MDSE_CATG_CD
        FROM 
            INTG_PROD_CATG_CONV C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND C.MDSE_ITEM_TP_CD = #mdseItemTpCd#
        <isNotNull property="coaMdseTpCd">
        AND C.COA_MDSE_TP_CD = #coaMdseTpCd#
        </isNotNull>
        <isNull property="coaMdseTpCd">
        AND C.COA_MDSE_TP_CD IS NULL
        </isNull>
        AND C.SW_LIC_CTRL_TP_CD = '*'
        <isNotNull property="swCatgCd">
        AND C.SW_CATG_CD = #swCatgCd#
        </isNotNull>
        <isNull property="swCatgCd">
        AND C.SW_CATG_CD IS NULL
        </isNull>
        UNION
        --SW_CATG_CD and SW_LIC_CTRL_TP_CD ALL
        SELECT 
            '4' PRIORITY
           ,C.MDSE_ITEM_TP_CD
           ,C.COA_MDSE_TP_CD
           ,C.SW_LIC_CTRL_TP_CD
           ,C.SW_CATG_CD
           ,C.INTNT_CONN_SW_CTRL_FLG
           ,C.INTG_PROD_CATG_CD
           ,C.MDSE_TP_CD
           ,C.MDSE_CATG_CD
        FROM 
            INTG_PROD_CATG_CONV C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND C.MDSE_ITEM_TP_CD = #mdseItemTpCd#
        <isNotNull property="coaMdseTpCd">
        AND C.COA_MDSE_TP_CD = #coaMdseTpCd#
        </isNotNull>
        <isNull property="coaMdseTpCd">
        AND C.COA_MDSE_TP_CD IS NULL
        </isNull>
        AND C.SW_LIC_CTRL_TP_CD = '*'
        AND C.SW_CATG_CD = '*' 
        UNION
        --COA_MDSE_TP_CD ALL, All Value Set
        SELECT 
            '5' PRIORITY
           ,C.MDSE_ITEM_TP_CD
           ,C.COA_MDSE_TP_CD
           ,C.SW_LIC_CTRL_TP_CD
           ,C.SW_CATG_CD
           ,C.INTNT_CONN_SW_CTRL_FLG
           ,C.INTG_PROD_CATG_CD
           ,C.MDSE_TP_CD
           ,C.MDSE_CATG_CD
        FROM 
            INTG_PROD_CATG_CONV C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND C.MDSE_ITEM_TP_CD = #mdseItemTpCd#
        AND C.COA_MDSE_TP_CD = '*'
        <isNotNull property="swLicCtrlTpCd">
        AND C.SW_LIC_CTRL_TP_CD = #swLicCtrlTpCd#
        </isNotNull>
        <isNull property="swLicCtrlTpCd">
        AND C.SW_LIC_CTRL_TP_CD IS NULL
        </isNull>
        <isNotNull property="swCatgCd">
        AND C.SW_CATG_CD = #swCatgCd#
        </isNotNull>
        <isNull property="swCatgCd">
        AND C.SW_CATG_CD IS NULL
        </isNull>
        UNION
        ---COA_MDSE_TP_CD ALL, SW_CATG_CD ALL
        SELECT 
            '6' PRIORITY
           ,C.MDSE_ITEM_TP_CD
           ,C.COA_MDSE_TP_CD
           ,C.SW_LIC_CTRL_TP_CD
           ,C.SW_CATG_CD
           ,C.INTNT_CONN_SW_CTRL_FLG
           ,C.INTG_PROD_CATG_CD
           ,C.MDSE_TP_CD
           ,C.MDSE_CATG_CD
        FROM 
            INTG_PROD_CATG_CONV C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND C.MDSE_ITEM_TP_CD = #mdseItemTpCd#
        AND C.COA_MDSE_TP_CD = '*'
        <isNotNull property="swLicCtrlTpCd">
        AND C.SW_LIC_CTRL_TP_CD = #swLicCtrlTpCd#
        </isNotNull>
        <isNull property="swLicCtrlTpCd">
        AND C.SW_LIC_CTRL_TP_CD IS NULL
        </isNull>
        AND C.SW_CATG_CD = '*' 
        UNION 
        ---COA_MDSE_TP_CD ALL, SW_LIC_CTRL_TP_CD ALL
        SELECT 
            '7' PRIORITY
           ,C.MDSE_ITEM_TP_CD
           ,C.COA_MDSE_TP_CD
           ,C.SW_LIC_CTRL_TP_CD
           ,C.SW_CATG_CD
           ,C.INTNT_CONN_SW_CTRL_FLG
           ,C.INTG_PROD_CATG_CD
           ,C.MDSE_TP_CD
           ,C.MDSE_CATG_CD
        FROM 
            INTG_PROD_CATG_CONV C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND C.MDSE_ITEM_TP_CD = #mdseItemTpCd#
        AND C.COA_MDSE_TP_CD = '*'
        AND C.SW_LIC_CTRL_TP_CD = '*'
        <isNotNull property="swCatgCd">
        AND C.SW_CATG_CD = #swCatgCd#
        </isNotNull>
        <isNull property="swCatgCd">
        AND C.SW_CATG_CD IS NULL
        </isNull>
        UNION
        ---COA_MDSE_TP_CD ALL, SW_CATG_CD and SW_LIC_CTRL_TP_CD ALL
        SELECT 
            '8' PRIORITY
           ,C.MDSE_ITEM_TP_CD
           ,C.COA_MDSE_TP_CD
           ,C.SW_LIC_CTRL_TP_CD
           ,C.SW_CATG_CD
           ,C.INTNT_CONN_SW_CTRL_FLG
           ,C.INTG_PROD_CATG_CD
           ,C.MDSE_TP_CD
           ,C.MDSE_CATG_CD
        FROM 
            INTG_PROD_CATG_CONV C
        WHERE
            C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = #glblCmpyCd#
        AND C.MDSE_ITEM_TP_CD = #mdseItemTpCd#
        AND C.COA_MDSE_TP_CD = '*'
        AND C.SW_LIC_CTRL_TP_CD = '*'
        AND C.SW_CATG_CD = '*' 
        ORDER BY
            1
    </statement>

    <statement id ="getProdCtrl" parameterClass="Map"  resultClass="Map">
        SELECT
            PC.PROD_CTRL_CD
            ,PC.PROD_CTRL_DESC_TXT
        FROM
            PROD_CTRL PC
        WHERE
                PC.GLBL_CMPY_CD = #glblCmpyCd#
            AND PC.EZCANCELFLAG = '0'
            AND PC.PROD_CTRL_CD = #prodCtrlCd#
            AND PC.MDSE_STRU_ELMNT_TP_CD = #mdseStruElmntTpCd#
    </statement>
</sqlMap>
