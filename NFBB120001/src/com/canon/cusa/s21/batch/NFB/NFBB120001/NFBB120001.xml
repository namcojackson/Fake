<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NFBB120001">

    <statement id="SELECT_IF_RECORD" parameterClass="Map">
        SELECT
            IF_300.ARCS_PMT_ID
        ,   IF_310.ARCS_PMT_SITE_ID                                AP_VND_CD --TODO
        ,   IF_310.ARCS_INV_NUM                                    AP_VND_INV_NUM
        ,   '00'                                                   AP_VND_INV_SQ_NUM
        ,   IF_300.ARCS_PMT_DOC_NUM                                AP_PMT_CHK_NUM
        ,   DECODE(IF_310.ARCS_INV_AMT,NULL,0,IF_310.ARCS_INV_AMT) AP_INV_AMT
        ,   IF_300.ARCS_PMT_DT                                     PMT_DT
        ,   IF_300.ARCS_PMT_STS_CD                                 ARCS_PMT_STS_CD
        ,   IF_310.ARCS_INV_SRC_TXT                                ARCS_INV_SRC_TXT
        ,   NVL(IF_310.ARCS_DISC_AMT, 0)                           AP_PMT_DISC_AMT
        ,   'N'                                                    CHK_STS_CD
        ,   NVL(IF_300.ARCS_PMT_AMT, 0)                            ARCS_PMT_AMT
        ,   IF_300.ARCS_PMT_METH_CD                                ARCS_PMT_METH_CD
        ,   IF_300.ARCS_CCY_CD                                     ARCS_CCY_CD
        ,   IF_300.ARCS_EXCH_RATE                                  ARCS_EXCH_RATE
        ,   IF_300.ARCS_EXCH_DT                                    ARCS_EXCH_DT
        ,   IF_300.ARCS_BANK_ACCT_CD                               ARCS_BANK_ACCT_CD
        FROM
            NFBI0300_01 IF_300
        ,   NFBI0310_01 IF_310
        WHERE
            IF_300.INTERFACE_ID      = #interfaceId_300#
        AND IF_310.INTERFACE_ID      = #interfaceId_310#
        AND IF_300.TRANSACTION_ID IN
            <iterate property="transactionIdList_300" var="transactionId_300[]" open="(" close=")" conjunction=",">
                #transactionId_300[]#
            </iterate>
        AND IF_310.TRANSACTION_ID IN
            <iterate property="transactionIdList_310" var="transactionId_310[]" open="(" close=")" conjunction=",">
                #transactionId_310[]#
            </iterate>
        AND IF_310.ARCS_INV_SRC_TXT IN
            <iterate property="arcsInvSrcTxt_310" var="arcsInvSrcTxt_310[]" open="(" close=")" conjunction=",">
                #arcsInvSrcTxt_310[]#
            </iterate>
        AND IF_300.ARCS_PMT_ID       = IF_310.ARCS_INV_PMT_ID
        AND IF_300.EZCANCELFLAG      = '0'
        AND IF_310.EZCANCELFLAG      = '0'
    <!-- START 2021/03/30 K.Suzuki [QC#57969,ADD] -->
        AND IF_310.ARCS_PMT_SITE_ID IS NOT NULL
    <!-- END   2021/03/30 K.Suzuki [QC#57969,ADD] -->
    </statement>

</sqlMap>
