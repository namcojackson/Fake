<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NPAB231001">

    <statement id="findIFData" parameterClass="Map" resultClass="Map">
        SELECT
            AMV.MDSE_CD
            ,FR_TPWRX.RTL_WH_CD  AS FR_RTL_WH_CD
            ,FR_TPWRX.RTL_SWH_CD AS FR_RTL_SWH_CD
            ,FR_WO.WH_OWNR_CD    AS FR_WH_OWNR_CD
            ,TO_TPWRX.RTL_WH_CD  AS TO_RTL_WH_CD
            ,TO_TPWRX.RTL_SWH_CD AS TO_RTL_SWH_CD
            ,TO_WO.WH_OWNR_CD    AS TO_WH_OWNR_CD
            ,TO_SHIP.SHIP_TO_CUST_CD
            ,TO_SHIP.FIRST_LINE_ADDR
            ,TO_SHIP.SCD_LINE_ADDR
            ,TO_SHIP.THIRD_LINE_ADDR
            ,TO_SHIP.FRTH_LINE_ADDR
            ,TO_PLW.LOC_NM
            ,TO_SHIP.ADDL_LOC_NM
            ,TO_SHIP.CTY_ADDR
            ,TO_SHIP.ST_CD
            ,TO_SHIP.PROV_NM
            ,TO_CNTY.CNTY_NM
            ,TO_SHIP.POST_CD
            ,TO_SHIP.CTRY_CD
            ,IF.PRCH_REQ_QTY
            ,IF.SHIP_FR_WH_RG_CD
            ,IF.SHIP_TO_WH_SITE_CD
            ,IF.SHIP_TO_WH_RG_CD
            ,IF.SHIP_TO_WH_RG_CD
            ,IF.MDSE_CD AS IF_MDSE_CD
            <!-- START 2022/07/05 F.Fadriquela [QC#60262 ADD] -->
            ,TO_RW.RTL_WH_CATG_CD AS TO_RTL_WH_CATG_CD
            ,TO_RW.TECH_TOC_CD    AS TO_TECH_TOC_CD
            ,TM.TECH_NM
            <!-- END 2022/07/05 F.Fadriquela [QC#60262 ADD] -->
        FROM
            NPAI2310_01         IF
            ,TRD_PTNR_WH_RG_XREF FR_TPWRX
            ,TRD_PTNR_WH_RG_XREF TO_TPWRX
            ,ALL_MDSE_V          AMV
            ,RTL_WH              FR_RW
            ,WH_OWNR             FR_WO
            ,RTL_WH              TO_RW
            ,WH_OWNR             TO_WO
            ,SHIP_TO_CUST        TO_SHIP
            ,CNTY                TO_CNTY
            ,PTY_LOC_WRK         TO_PLW
            <!-- START 2022/07/05 F.Fadriquela [QC#60262 ADD] -->
            ,TECH_MSTR           TM
            <!-- END 2022/07/05 F.Fadriquela [QC#60262 ADD] -->
        WHERE
            IF.INTERFACE_ID                           = #interfaceId#
        AND IF.TRANSACTION_ID                         = #transactionId#
        AND FR_TPWRX.GLBL_CMPY_CD(+)                  = #glblCmpyCd#
        AND IF.SHIP_FR_WH_RG_CD                       = FR_TPWRX.TRD_PTNR_WH_RG_NM(+)
        AND IF.SHIP_FR_WH_SITE_CD                     = FR_TPWRX.RTL_WH_CD(+)
        AND TO_TPWRX.GLBL_CMPY_CD(+)                  = #glblCmpyCd#
        AND IF.SHIP_TO_WH_RG_CD                       = TO_TPWRX.TRD_PTNR_WH_RG_NM(+)
        AND IF.SHIP_TO_WH_SITE_CD                     = TO_TPWRX.RTL_WH_CD(+)
        AND AMV.GLBL_CMPY_CD(+)                       = #glblCmpyCd#
        AND IF.MDSE_CD                                = AMV.MDSE_CD(+)
        AND FR_TPWRX.GLBL_CMPY_CD                     = FR_RW.GLBL_CMPY_CD(+)
        AND FR_TPWRX.RTL_WH_CD                        = FR_RW.RTL_WH_CD(+)
        AND FR_RW.GLBL_CMPY_CD                        = FR_WO.GLBL_CMPY_CD(+)
        AND FR_RW.WH_OWNR_CD                          = FR_WO.WH_OWNR_CD(+)
        AND TO_TPWRX.GLBL_CMPY_CD                     = TO_RW.GLBL_CMPY_CD(+)
        AND TO_TPWRX.RTL_WH_CD                        = TO_RW.RTL_WH_CD(+)
        AND TO_RW.GLBL_CMPY_CD                        = TO_WO.GLBL_CMPY_CD(+)
        AND TO_RW.WH_OWNR_CD                          = TO_WO.WH_OWNR_CD(+)
        AND TO_TPWRX.GLBL_CMPY_CD                     = TO_SHIP.GLBL_CMPY_CD(+)
        AND TO_TPWRX.RTL_WH_CD || TO_TPWRX.RTL_SWH_CD = TO_SHIP.SHIP_TO_CUST_CD(+)
        AND TO_SHIP.GLBL_CMPY_CD                      = TO_CNTY.GLBL_CMPY_CD(+)
        AND TO_SHIP.CNTY_PK                           = TO_CNTY.CNTY_PK(+)
        AND TO_SHIP.GLBL_CMPY_CD                      = TO_PLW.GLBL_CMPY_CD(+)
        AND TO_SHIP.PTY_LOC_PK                        = TO_PLW.PTY_LOC_PK(+)
        <!-- START 2022/07/05 F.Fadriquela [QC#60262 ADD] -->
        AND TM.TECH_TOC_CD(+)                         = TO_RW.TECH_TOC_CD
        AND TM.GLBL_CMPY_CD(+)                        = TO_RW.GLBL_CMPY_CD
        AND TM.EZCANCELFLAG(+)                        = '0'
        <!-- END 2022/07/05 F.Fadriquela [QC#60262 ADD] -->
        AND IF.EZCANCELFLAG(+)                        = '0'
        AND FR_TPWRX.EZCANCELFLAG(+)                  = '0'
        AND TO_TPWRX.EZCANCELFLAG(+)                  = '0'
        AND FR_RW.EZCANCELFLAG(+)                     = '0'
        AND FR_WO.EZCANCELFLAG(+)                     = '0'
        AND TO_SHIP.EZCANCELFLAG(+)                   = '0'
        AND TO_CNTY.EZCANCELFLAG(+)                   = '0'
        AND TO_PLW.EZCANCELFLAG(+)                    = '0'
        ORDER BY
            FR_TPWRX.RTL_WH_CD
            ,FR_TPWRX.RTL_SWH_CD
            ,TO_TPWRX.RTL_WH_CD
            ,TO_TPWRX.RTL_SWH_CD
            ,AMV.MDSE_CD
    </statement>

</sqlMap>
