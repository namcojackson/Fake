<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NPAL1400Query">
    <typeAlias alias="NPAL1400CMsg" type="business.blap.NPAL1400.NPAL1400CMsg" />
    <typeAlias alias="NPAL1400SMsg" type="business.blap.NPAL1400.NPAL1400SMsg" />
    <typeAlias alias="NPAL1400_ASMsg" type="business.blap.NPAL1400.NPAL1400_ASMsg" />

    <statement id="getSearchOptionPulldownList" parameterClass="Map"
        resultClass="Map">
        SELECT
            SSO.SRCH_OPT_PK
           ,SSO.SRCH_OPT_NM
        FROM
            SAVE_SRCH_OPT SSO
        WHERE
                SSO.GLBL_CMPY_CD = #glblCmpyCd#
            AND SSO.SRCH_OPT_APL_ID = #srchOptAplId#
            AND SSO.SRCH_OPT_USR_ID = #srchOptUsrId#
            AND SSO.EZCANCELFLAG = '0'
        ORDER BY
            SSO.SRCH_OPT_NM ASC
    </statement>
    <statement id="getRemanOrderStatusPulldownList" parameterClass="Map"
        resultClass="Map">
        SELECT
            ROS.RMNF_ORD_STS_CD
           ,ROS.RMNF_ORD_STS_DESC_TXT
        FROM
            RMNF_ORD_STS ROS
        WHERE
                ROS.GLBL_CMPY_CD = #glblCmpyCd#
            AND ROS.EZCANCELFLAG = '0'
        ORDER BY
            ROS.RMNF_ORD_STS_SORT_NUM ASC
    </statement>
    <statement id="search" parameterClass="Map" resultMap="result.NPAL1400_ASMsg">
        WITH TBL_A AS (
            SELECT
                 RO.RMNF_RTL_WH_CD
                ,RO.RMNF_RTL_SWH_CD
                ,RO.RMNF_ORD_NUM
                ,RO.RMNF_ORD_STS_CD
                ,RO.RMNF_MAIN_UNIT_SER_NUM
                ,RO.RMNF_MAIN_UNIT_MDSE_CD
                ,RO.OWNR_TECH_TOC_CD
                ,RO.RMNF_START_DT
                ,RO.RMNF_END_DT
                ,RO.RMNF_PRT_USG_COST_AMT
                ,RO.RMNF_TOT_LBOR_COST_AMT
                ,RO.RMNF_OTH_COST_AMT
                ,RO.RMNF_TOT_COST_AMT
                ,ROS.RMNF_ORD_STS_NM
                ,RW.RTL_WH_NM
                ,RS.RTL_SWH_NM
                ,DMI.MDSE_DESC_SHORT_TXT
                ,MN.T_MDL_NM
                ,TM.TECH_NM
            FROM 
                 RMNF_ORD     RO
                ,RMNF_ORD_STS ROS
                ,RTL_WH       RW
                ,RTL_SWH      RS
                ,MDSE         DMI
                ,TECH_MSTR    TM
                ,MDL_NM       MN
            WHERE
                    RO.GLBL_CMPY_CD           = #glblCmpyCd#
                AND RO.EZCANCELFLAG           = '0'
                AND RO.GLBL_CMPY_CD           = ROS.GLBL_CMPY_CD
                AND RO.RMNF_ORD_STS_CD        = ROS.RMNF_ORD_STS_CD
                AND ROS.EZCANCELFLAG          = '0'
                AND RO.GLBL_CMPY_CD           = RW.GLBL_CMPY_CD
                AND RO.RMNF_RTL_WH_CD         = RW.RTL_WH_CD
                AND RW.EZCANCELFLAG           = '0'
                AND RO.GLBL_CMPY_CD           = RS.GLBL_CMPY_CD
                AND RO.RMNF_RTL_WH_CD         = RS.RTL_WH_CD
                AND RO.RMNF_RTL_SWH_CD        = RS.RTL_SWH_CD
                AND RS.EZCANCELFLAG           = '0'
                AND RO.GLBL_CMPY_CD           = DMI.GLBL_CMPY_CD
                AND RO.RMNF_MAIN_UNIT_MDSE_CD = DMI.MDSE_CD
                AND DMI.EZCANCELFLAG          = '0'
                AND RO.RMNF_MDL_ID            = MN.T_MDL_ID(+)
                AND RO.GLBL_CMPY_CD           = MN.T_GLBL_CMPY_CD(+)
                AND MN.EZCANCELFLAG(+)        = '0'
                AND RO.GLBL_CMPY_CD           = TM.GLBL_CMPY_CD
                AND RO.OWNR_TECH_TOC_CD       = TM.TECH_TOC_CD
                AND TM.EZCANCELFLAG           = '0'
            <isNotNull property="cMsg.rtlWhCd">
                AND RO.RMNF_RTL_WH_CD         LIKE #cMsg.rtlWhCd#
            </isNotNull>
            <isNotNull property="cMsg.rtlSwhCd">
                AND RO.RMNF_RTL_SWH_CD        LIKE #cMsg.rtlSwhCd#
            </isNotNull>
            <isNotNull property="cMsg.rmnfOrdNum">
                AND RO.RMNF_ORD_NUM           = #cMsg.rmnfOrdNum#
            </isNotNull>
            <isNotNull property="cMsg.rmnfOrdStsCd_SL">
                AND RO.RMNF_ORD_STS_CD        = #cMsg.rmnfOrdStsCd_SL#
            </isNotNull>
            <isNotNull property="cMsg.rmnfMainUnitSerNum">
                AND RO.RMNF_MAIN_UNIT_SER_NUM = #cMsg.rmnfMainUnitSerNum#
            </isNotNull>
            <isNotNull property="cMsg.rmnfMainUnitMdseCd">
                AND RO.RMNF_MAIN_UNIT_MDSE_CD LIKE #cMsg.rmnfMainUnitMdseCd#
            </isNotNull>
            <isNotNull property="cMsg.techTocCd">
                AND RO.OWNR_TECH_TOC_CD       LIKE #cMsg.techTocCd#
            </isNotNull>
            <isNotNull property="cMsg.rmnfStartDt_FR">
                AND RO.RMNF_START_DT          &gt;= #cMsg.rmnfStartDt_FR#
            </isNotNull>
            <isNotNull property="cMsg.rmnfStartDt_TO">
                AND RO.RMNF_START_DT          &lt;= #cMsg.rmnfStartDt_TO#
            </isNotNull>
            <isNotNull property="cMsg.rmnfEndDt_FR">
                AND RO.RMNF_END_DT            &gt;= #cMsg.rmnfEndDt_FR#
            </isNotNull>
            <isNotNull property="cMsg.rmnfEndDt_TO">
                AND RO.RMNF_END_DT            &lt;= #cMsg.rmnfEndDt_TO#
            </isNotNull>
            <isNotNull property="cMsg.rtlWhNm">
                AND RW.RTL_WH_NM              LIKE #cMsg.rtlWhNm#
            </isNotNull>
            <isNotNull property="cMsg.rtlSwhNm">
                AND RS.RTL_SWH_NM             LIKE #cMsg.rtlSwhNm#
            </isNotNull>
            <isNotNull property="cMsg.mdseDescShortTxt">
                AND DMI.MDSE_DESC_SHORT_TXT   LIKE #cMsg.mdseDescShortTxt#
            </isNotNull>
            <isNotNull property="cMsg.t_MdlNm">
                AND MN.T_MDL_NM               LIKE #cMsg.t_MdlNm# 
            </isNotNull>
            <isNotNull property="cMsg.techNm">
                AND UPPER(TM.TECH_NM)         LIKE UPPER(#cMsg.techNm#)
            </isNotNull>
            ORDER BY
                 RO.RMNF_ORD_NUM ASC
        )
        SELECT
                 RMNF_RTL_WH_CD
                ,RMNF_RTL_SWH_CD
                ,RMNF_ORD_NUM
                ,RMNF_ORD_STS_CD
                ,RMNF_MAIN_UNIT_SER_NUM
                ,RMNF_MAIN_UNIT_MDSE_CD
                ,OWNR_TECH_TOC_CD
                ,RMNF_START_DT
                ,RMNF_END_DT
                ,RMNF_PRT_USG_COST_AMT
                ,RMNF_TOT_LBOR_COST_AMT
                ,RMNF_OTH_COST_AMT
                ,RMNF_TOT_COST_AMT
                ,RMNF_ORD_STS_NM
                ,RTL_WH_NM
                ,RTL_SWH_NM
                ,MDSE_DESC_SHORT_TXT
                ,T_MDL_NM
                ,TECH_NM
            FROM
                    TBL_A
            WHERE
                    ROWNUM <![CDATA[<=]]> #rowNum#
    </statement>
    <resultMap id="result.NPAL1400_ASMsg" class="NPAL1400_ASMsg">
        <result property="rmnfRtlWhCd_A1"        column="RMNF_RTL_WH_CD"         javaType="EZDBStringItem"/>
        <result property="rmnfRtlSwhCd_A1"       column="RMNF_RTL_SWH_CD"        javaType="EZDBStringItem"/>
        <result property="rmnfOrdNum_A1"         column="RMNF_ORD_NUM"           javaType="EZDBStringItem"/>
        <result property="rmnfOrdStsCd_A1"       column="RMNF_ORD_STS_CD"        javaType="EZDBStringItem"/>
        <result property="rmnfMainUnitSerNum_A1" column="RMNF_MAIN_UNIT_SER_NUM" javaType="EZDBStringItem"/>
        <result property="rmnfMainUnitMdseCd_A1" column="RMNF_MAIN_UNIT_MDSE_CD" javaType="EZDBStringItem"/>
        <result property="ownrTechTocCd_A1"      column="OWNR_TECH_TOC_CD"       javaType="EZDBStringItem"/>
        <result property="rmnfStartDt_A1"        column="RMNF_START_DT"          javaType="EZDSDateItem"/>
        <result property="rmnfEndDt_A1"          column="RMNF_END_DT"            javaType="EZDSDateItem"/>
        <result property="rmnfPrtUsgCostAmt_A1"  column="RMNF_PRT_USG_COST_AMT"  javaType="EZDSBigDecimalItem"/>
        <result property="rmnfTotLborCostAmt_A1" column="RMNF_TOT_LBOR_COST_AMT" javaType="EZDSBigDecimalItem"/>
        <result property="rmnfOthCostAmt_A1"     column="RMNF_OTH_COST_AMT"      javaType="EZDSBigDecimalItem"/>
        <result property="rmnfTotCostAmt_A1"     column="RMNF_TOT_COST_AMT"      javaType="EZDSBigDecimalItem"/>
        <result property="rmnfOrdStsDescTxt_A1"  column="RMNF_ORD_STS_NM"        javaType="EZDBStringItem"/>
        <result property="rtlWhNm_A1"            column="RTL_WH_NM"              javaType="EZDBStringItem"/>
        <result property="rtlSwhNm_A1"           column="RTL_SWH_NM"             javaType="EZDBStringItem"/>
        <result property="mdseDescShortTxt_A1"   column="MDSE_DESC_SHORT_TXT"    javaType="EZDBStringItem"/>
        <result property="t_MdlNm_A1"            column="T_MDL_NM"               javaType="EZDBStringItem"/>
        <result property="techNm_A1"             column="TECH_NM"                javaType="EZDBStringItem"/>
    </resultMap>
    <statement id="getAftDeclPnt" parameterClass="Map" resultClass="Integer">
        SELECT
            C.AFT_DECL_PNT_DIGIT_NUM
        FROM
            GLBL_CMPY       G
            ,CCY            C
        WHERE
                G.GLBL_CMPY_CD              = #glblCmpyCd#
            AND G.GLBL_CMPY_CD              = C.GLBL_CMPY_CD
            AND G.STD_CCY_CD                = C.CCY_CD
            AND G.EZCANCELFLAG              = '0'
            AND C.EZCANCELFLAG              = '0'
    </statement>
</sqlMap>