<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NLBL3150Query">

    <typeAlias alias="NLBL3150SMsg"   type="business.blap.NLBL3150.NLBL3150SMsg" />
    <typeAlias alias="NLBL3150_ASMsg" type="business.blap.NLBL3150.NLBL3150_ASMsg" />

    <statement id="searchResultList" parameterClass="Map" resultMap="result.searchResultList">
        SELECT
             *
        FROM
            (
            SELECT
                  MDSE_WH_COND_PK
                , MWC.MDSE_CD
                , AMV.MDSE_DESC_SHORT_TXT
                , MWC.RTL_WH_CD
                , RW.RTL_WH_NM
                , MWC.RTL_SWH_CD
                , RS.RTL_SWH_NM
                , MWC.EZUPTIME
                , MWC.EZUPTIMEZONE
            FROM
	              MDSE_WH_COND MWC
	            , RTL_WH RW
	            , RTL_SWH RS
	            , ALL_MDSE_V AMV
    
            WHERE
                    MWC.GLBL_CMPY_CD   = #glblCmpyCd#
                AND MWC.EZCANCELFLAG = '0'
            <isNotNull property="mdseCd">
                AND MWC.MDSE_CD LIKE #mdseCd#
            </isNotNull>
                AND MWC.MDSE_WH_COND_TP_CD = #condTpCd#
            <isNotNull property="rtlWhCd">
                AND MWC.RTL_WH_CD LIKE #rtlWhCd#
            </isNotNull>
            <isNotNull property="rtlSwhCd">
                AND MWC.RTL_SWH_CD LIKE #rtlSwhCd#
            </isNotNull>
                AND MWC.GLBL_CMPY_CD = RW.GLBL_CMPY_CD(+)
                AND MWC.RTL_WH_CD = RW.RTL_WH_CD(+)
                AND RW.EZCANCELFLAG(+) = '0'

                AND MWC.GLBL_CMPY_CD = RS.GLBL_CMPY_CD(+)
                AND MWC.RTL_WH_CD =  RS.RTL_WH_CD(+)
                AND MWC.RTL_SWH_CD = RS.RTL_SWH_CD(+)
                AND RS.EZCANCELFLAG(+) = '0'

                AND MWC.GLBL_CMPY_CD = AMV.GLBL_CMPY_CD(+)
                AND MWC.MDSE_CD = AMV.MDSE_CD(+)
                AND AMV.EZCANCELFLAG(+) = '0'
            )
         WHERE
             ROWNUM <![CDATA[<=]]> #rowNum#
         <!-- 2017/08/25 QC#20772 ADD BEGIN -->
         ORDER BY
                  MDSE_CD
                , RTL_WH_CD
                , RTL_SWH_CD
         <!-- 2017/08/25 QC#20772 ADD END -->
    </statement>

    <resultMap id="result.searchResultList" class="NLBL3150_ASMsg">
        <result property="mdseWhCondPk_A"     column="MDSE_WH_COND_PK"        javaType="EZDCBigDecimalItem" />
        <result property="mdseCd_A"           column="MDSE_CD"                javaType="EZDSStringItem" />
        <result property="mdseDescShortTxt_A" column="MDSE_DESC_SHORT_TXT"    javaType="EZDSStringItem" />
        <result property="rtlWhCd_A"          column="RTL_WH_CD"              javaType="EZDSStringItem" />
        <result property="rtlWhNm_A"          column="RTL_WH_NM"              javaType="EZDSStringItem" />
        <result property="rtlSwhCd_A"         column="RTL_SWH_CD"             javaType="EZDSStringItem" />
        <result property="rtlSwhNm_A"         column="RTL_SWH_NM"             javaType="EZDSStringItem" />
        <result property="ezUpTime_A"         column="EZUPTIME"               javaType="EZDSStringItem" />
        <result property="ezUpTimeZone_A"     column="EZUPTIMEZONE"           javaType="EZDSStringItem" />
    </resultMap>

    <statement id="checkRegisteredRule" parameterClass="Map" resultClass="Map">
        SELECT
            COUNT(MDSE_WH_COND_PK) CN
        FROM
            MDSE_WH_COND MWC
        WHERE
                MWC.GLBL_CMPY_CD           = #glblCmpyCd#
<!-- 2017/08/14 QC#20556 MOD BEGIN -->
            <isNotNull property="mdseWhCondPk">
                AND MWC.MDSE_WH_COND_PK &lt;&gt; #mdseWhCondPk#
            </isNotNull>
<!--            AND MWC.MDSE_CD             LIKE #mdseCd#-->
            AND MWC.MDSE_CD               IN (#mdseCd8#, #mdseCd10#)
            AND MWC.RTL_WH_CD              = #rtlWhCd#
<!--            AND MWC.RTL_SWH_CD             = #rtlSwhCd#-->
            AND MWC.RTL_SWH_CD            IN (#rtlSwhCd#, #asterisk#)
<!-- 2017/08/14 QC#20556 MOD END -->
            AND MWC.MDSE_WH_COND_TP_CD     = #mdseWhCondTpCd#
            AND MWC.EZCANCELFLAG           = '0'
    </statement>
</sqlMap>
