<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="ZZPL0030Query">
    <typeAlias alias="ZZPL0030CMsg" type="business.blap.ZZPL0030.ZZPL0030CMsg"/>
    <typeAlias alias="ZZPL0030_ASMsg" type="business.blap.ZZPL0030.ZZPL0030_ASMsg"/>
    <typeAlias alias="ZZPL0030_BSMsg" type="business.blap.ZZPL0030.ZZPL0030_BSMsg"/>

    <statement id="getReportList" parameterClass="Map" resultMap="result.ZZPL0030_ASMsg">
        WITH A AS(
          SELECT
            R.RPT_ID          AS RPT_ID
            ,R.RPT_DESC_TXT   AS RPT_DESC_TXT
          FROM
            EIP_RPT R
          WHERE
            R.EZCANCELFLAG = '0'
          <isNotNull property="cMsg.xxRptNm_0">
            AND R.RPT_ID LIKE #cMsg.xxRptNm_0# || '%'
          </isNotNull>
            AND
            <iterate property="authorizedRptList" var="rptList[]" open="(" close=")" conjunction="or">
              R.RPT_ID = #rptList[].reportName#
            </iterate>
          ORDER BY
            R.RPT_ID
        )
        SELECT
          A.RPT_ID
          ,A.RPT_DESC_TXT
        FROM
          A
        WHERE
          ROWNUM &lt;= #rowNum#
    </statement>
    <resultMap id="result.ZZPL0030_ASMsg" class="ZZPL0030_ASMsg">
        <result property="xxRptNm_A" column="RPT_ID" javaType="EZDSStringItem"/>
        <result property="xxPrtrDescTxt" column="RPT_DESC_TXT" javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getAdvSrchPulldownList" parameterClass="ZZPL0030CMsg" resultClass="Map">
        SELECT
          RP.RPT_PRM_NM          AS RPT_PRM_NM
          ,RP.RPT_PRM_DPLY_NM    AS RPT_PRM_DPLY_NM
        FROM
          EIP_RPT_PRM RP
        WHERE
          RP.EZCANCELFLAG = '0'
          AND RPT_ID = #xxRptNm_1#
          AND RPT_CRAT_COND_FLG = 'Y'
        ORDER BY   
          RP.RPT_PRM_DPLY_NM
    </statement>

    <statement id="getReportHistList" parameterClass="Map" resultMap="result.ZZPL0030_BSMsg">
         WITH A AS(
           SELECT
             RRA.RPT_PROC_END_TS      AS RPT_PROC_END_TS
             ,RRA.RPT_TTL_NM          AS RPT_TTL_NM
             ,RRA.RPT_FILE_ID         AS RPT_FILE_ID
           FROM
             EIP_RPT_RQST_ARC  RRA
           WHERE
             RRA.EZCANCELFLAG = '0'
           <isNotNull property="srchKey_rptCratDt_FR">
             AND RRA.RPT_PROC_END_TS &gt;= #srchKey_rptCratDt_FR#
           </isNotNull>
           <isNotNull property="srchKey_rptCratDt_TO">
             AND RRA.RPT_PROC_END_TS &lt; #srchKey_rptCratDt_TO#
           </isNotNull>
             AND RRA.RPT_ID = #cMsg.xxRptNm_1#
           <isNotNull property="cMsg.xxRptSrchTxt_1">
             AND EXISTS (SELECT
                           'X'
                         FROM
                           EIP_ARC_RPT_SRCH_PRM  RSP
                         WHERE
                           RSP.RPT_PROC_END_TS &gt;= #srchKey_rptCratDt_FR#
                           <isNotNull property="srchKey_rptCratDt_TO">
                           AND RSP.RPT_PROC_END_TS &lt; #srchKey_rptCratDt_TO#
                           </isNotNull>
                           AND RRA.RPT_ID = RSP.RPT_ID
                           AND RRA.EIP_RPT_RQST_PK = RSP.EIP_RPT_RQST_PK
                           AND RRA.RPT_RQST_SUB_ID = RSP.RPT_RQST_SUB_ID
                           AND RSP.RPT_PRM_NM = #cMsg.xxRptSrchCd_I1#
                           AND RSP.RPT_PRM_VAL_TXT LIKE #cMsg.xxRptSrchTxt_1# || '%')
           </isNotNull>
           <isNotNull property="cMsg.xxRptSrchTxt_2">
             AND EXISTS (SELECT
                           'X'
                         FROM
                           EIP_ARC_RPT_SRCH_PRM  RSP
                         WHERE
                           RSP.RPT_PROC_END_TS &gt;= #srchKey_rptCratDt_FR#
                           <isNotNull property="srchKey_rptCratDt_TO">
                           AND RSP.RPT_PROC_END_TS &lt; #srchKey_rptCratDt_TO#
                           </isNotNull>
                           AND RRA.RPT_ID = RSP.RPT_ID
                           AND RRA.EIP_RPT_RQST_PK = RSP.EIP_RPT_RQST_PK
                           AND RRA.RPT_RQST_SUB_ID = RSP.RPT_RQST_SUB_ID
                           AND RSP.RPT_PRM_NM = #cMsg.xxRptSrchCd_I2#
                           AND RSP.RPT_PRM_VAL_TXT LIKE #cMsg.xxRptSrchTxt_2# || '%')
           </isNotNull>
           <isNotNull property="cMsg.xxRptSrchTxt_3">
             AND EXISTS (SELECT
                           'X'
                         FROM
                           EIP_ARC_RPT_SRCH_PRM  RSP
                         WHERE
                           RSP.RPT_PROC_END_TS &gt;= #srchKey_rptCratDt_FR#
                           <isNotNull property="srchKey_rptCratDt_TO">
                           AND RSP.RPT_PROC_END_TS &lt; #srchKey_rptCratDt_TO#
                           </isNotNull>
                           AND RRA.RPT_ID = RSP.RPT_ID
                           AND RRA.EIP_RPT_RQST_PK = RSP.EIP_RPT_RQST_PK
                           AND RRA.RPT_RQST_SUB_ID = RSP.RPT_RQST_SUB_ID
                           AND RSP.RPT_PRM_NM = #cMsg.xxRptSrchCd_I3#
                           AND RSP.RPT_PRM_VAL_TXT LIKE #cMsg.xxRptSrchTxt_3# || '%')
           </isNotNull>
           <isNotNull property="cMsg.xxRptSrchTxt_4">
             AND EXISTS (SELECT
                           'X'
                         FROM
                           EIP_ARC_RPT_SRCH_PRM  RSP
                         WHERE
                           RSP.RPT_PROC_END_TS &gt;= #srchKey_rptCratDt_FR#
                           <isNotNull property="srchKey_rptCratDt_TO">
                           AND RSP.RPT_PROC_END_TS &lt; #srchKey_rptCratDt_TO#
                           </isNotNull>
                           AND RRA.RPT_ID = RSP.RPT_ID
                           AND RRA.EIP_RPT_RQST_PK = RSP.EIP_RPT_RQST_PK
                           AND RRA.RPT_RQST_SUB_ID = RSP.RPT_RQST_SUB_ID
                           AND RSP.RPT_PRM_NM = #cMsg.xxRptSrchCd_I4#
                           AND RSP.RPT_PRM_VAL_TXT LIKE #cMsg.xxRptSrchTxt_4# || '%')
           </isNotNull>
           ORDER BY
             RRA.RPT_PROC_END_TS DESC
         )
         SELECT
           A.RPT_PROC_END_TS
           ,A.RPT_TTL_NM
           ,A.RPT_FILE_ID
         FROM
           A
         WHERE
           ROWNUM &lt;= #rowNum#
    </statement>
    <resultMap id="result.ZZPL0030_BSMsg" class="ZZPL0030_BSMsg">
        <result property="xxRptCratTm" column="RPT_PROC_END_TS" javaType="EZDBStringItem"/>
        <result property="xxRptTtlNm" column="RPT_TTL_NM" javaType="EZDBStringItem"/>
        <result property="xxRptFileId" column="RPT_FILE_ID" javaType="EZDSBigDecimalItem"/>
    </resultMap>

</sqlMap>