<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NLXRWSReport">

	<!-- ==== Type Aliases ==== -->

	<!-- ==== Result Mapping ==== -->

    <statement id="selectRwsMessageBulk" parameterClass="Map">
     SELECT
               RWS_MSG_TXT
              ,RWS_MSG_SQ_NUM
              ,RWS_NUM
     FROM
               RWS_MSG
     WHERE
             <iterate property="rwsNumList" var="rwsNumList[]" open="(" close=")" conjunction="OR">
                  RWS_NUM            =  #rwsNumList[]#
             </iterate>
             AND  EZCANCELFLAG      =  '0'
             AND  GLBL_CMPY_CD      =  #glblCmpyCd#
     ORDER BY
                  RWS_NUM
                 ,RWS_MSG_SQ_NUM
    </statement>
	
	<statement id="selectRws" parameterClass="Map">
	 WITH
	          RWSV AS
	          (
	           SELECT
					RWSD.GLBL_CMPY_CD			GLBL_CMPY_CD
				,	RWSD.INVTY_STK_STS_CD		INVTY_STK_STS_CD
				,	RWSD.MDSE_CD				MDSE_CD
				,	RWSD.OUT_PACK_CSE_QTY		OUT_PACK_CSE_QTY
				,	RWSD.RWS_QTY				RWS_QTY
				,	RWSH.CNTNR_SEAL_NUM			CNTNR_SEAL_NUM
				,	RWSH.FROM_LOC_ADDR_01		FROM_LOC_ADDR_01
				,	RWSH.FROM_LOC_ADDR_02		FROM_LOC_ADDR_02
				,	RWSH.FROM_LOC_ADDR_03		FROM_LOC_ADDR_03
				,	RWSH.FROM_LOC_ADDR_04		FROM_LOC_ADDR_04
				,	RWSH.FROM_LOC_CD			FROM_LOC_CD
				,	RWSH.FROM_LOC_CTY_ADDR		FROM_LOC_CTY_ADDR
				,	RWSH.FROM_LOC_NM_01			FROM_LOC_NM_01
				,	RWSH.FROM_LOC_POST_CD		FROM_LOC_POST_CD
				,	RWSH.FROM_LOC_ST_CD			FROM_LOC_ST_CD
				,	RWSH.FROM_LOC_TP_CD			FROM_LOC_TP_CD
				,	RWSH.IMPT_INV_SHPG_METH_CD	IMPT_INV_SHPG_METH_CD
				,	RWSH.INLND_SHPG_METH_CD		INLND_SHPG_METH_CD
				,	RWSH.RWS_CARR_CD			RWS_CARR_CD
				,	RWSH.RWS_NUM				RWS_NUM
				,	RWSH.RWS_REF_NUM			RWS_REF_NUM
				,	RWSH.SCE_ORD_TP_CD			SCE_ORD_TP_CD
				,	RWSH.WH_CD					WH_CD
				,	RWSH.WH_IN_ETA_DT			WH_IN_ETA_DT
				<!-- ADD UnitTest#130 -->
				,   RWSD.INVTY_LOC_CD           INVTY_LOC_CD
     		   FROM
	               RWS_HDR             RWSH
	              ,RWS_DTL             RWSD
		       WHERE
	                    RWSH.GLBL_CMPY_CD             =  #glblCmpyCd#
	               <iterate property="rwsNumList" var="rwsNumList[]" open="AND (" close=")" conjunction="OR">
	                    RWSH.RWS_NUM = #rwsNumList[]#
	               </iterate>
	               AND  RWSH.EZCANCELFLAG             =  '0'
	               AND  RWSD.GLBL_CMPY_CD             =  RWSH.GLBL_CMPY_CD
	               AND  RWSD.RWS_NUM                  =  RWSH.RWS_NUM
	               AND  RWSD.EZCANCELFLAG             =  '0'
              )	
     SELECT
               RWSV.WH_CD                   WH_CD
              ,W.INVTY_LOC_NM               WH_LOC_NM
              ,RWSV.SCE_ORD_TP_CD           SCE_ORD_TP_CD
              ,OTP.SCE_ORD_TP_NM            SCE_ORD_TP_NM
              ,RWSV.RWS_REF_NUM             RWS_REF_NUM
              ,RWSV.RWS_NUM                 RWS_NUM
              ,LTP.LOC_TP_NM                LOC_TP_NM
              ,RWSV.FROM_LOC_CD             FROM_LOC_CD
              ,RWSV.FROM_LOC_NM_01          FROM_LOC_NM_01
              ,RWSV.FROM_LOC_ADDR_01        FROM_LOC_ADDR_01
              ,RWSV.FROM_LOC_ADDR_02        FROM_LOC_ADDR_02
              ,RWSV.FROM_LOC_ADDR_03        FROM_LOC_ADDR_03
              ,RWSV.FROM_LOC_ADDR_04        FROM_LOC_ADDR_04
              ,RWSV.FROM_LOC_CTY_ADDR       FROM_LOC_CTY_ADDR
              ,RWSV.FROM_LOC_ST_CD          FROM_LOC_ST_CD
              ,RWSV.FROM_LOC_POST_CD        FROM_LOC_POST_CD
              ,RWSV.RWS_CARR_CD             RWS_CARR_CD
              ,V.LOC_NM                     CARR_LOC_NM
              ,V.FIRST_LINE_ADDR            FIRST_LINE_ADDR
              ,V.SCD_LINE_ADDR              SCD_LINE_ADDR
              ,V.THIRD_LINE_ADDR            THIRD_LINE_ADDR
              ,V.FRTH_LINE_ADDR             FRTH_LINE_ADDR
              ,V.CTY_ADDR                   CTY_ADDR
              ,V.ST_CD                      ST_CD
              ,V.POST_CD                    POST_CD
              ,RWSV.WH_IN_ETA_DT            WH_IN_ETA_DT
              ,RWSV.IMPT_INV_SHPG_METH_CD   IMPT_INV_SHPG_METH_CD
              ,SM.IMPT_INV_SHPG_METH_NM     IMPT_INV_SHPG_METH_NM
              ,RWSV.INLND_SHPG_METH_CD      INLND_SHPG_METH_CD
              ,ISM.INLND_SHPG_METH_NM       INLND_SHPG_METH_NM
              ,RWSV.CNTNR_SEAL_NUM          CNTNR_SEAL_NUM
              ,RWSV.OUT_PACK_CSE_QTY        OUT_PACK_CSE_QTY
              ,M.FIRST_PROD_CTRL_CD         FIRST_PROD_CTRL_CD
              ,M.FIRST_PROD_CTRL_NM         FIRST_PROD_CTRL_NM
              ,RWSV.MDSE_CD                 MDSE_CD
              ,M.MDSE_NM                    MDSE_NM
              ,RWSV.RWS_QTY                 RWS_QTY
              ,RWSV.INVTY_STK_STS_CD        INVTY_STK_STS_CD
              ,SS.STK_STS_NM                STK_STS_NM
              ,RBL.BIN_NUM                  BIN_NUM
     FROM
               RWSV                RWSV
              ,SCE_ORD_TP          OTP
              ,DS_INVTY_LOC_V      W
              ,VND                 V
              ,IMPT_INV_SHPG_METH  SM
              ,INLND_SHPG_METH     ISM
              ,LOC_TP              LTP
              ,MDSE                M
              ,STK_STS             SS
              ,RTRN_BIN_LOC        RBL 
     WHERE
                    OTP.EZCANCELFLAG              =  '0'
               AND  W.EZCANCELFLAG                =  '0'
               AND  M.EZCANCELFLAG                =  '0'
               AND  SM.EZCANCELFLAG (+)           =  '0'
               AND  V.EZCANCELFLAG (+)            =  '0'
               AND  ISM.EZCANCELFLAG (+)          =  '0'
               AND  LTP.EZCANCELFLAG (+)          =  '0'
               AND  SS.EZCANCELFLAG (+)           =  '0'
               AND  OTP.INBD_OTBD_CD              =  #unbdOtbdCd#
               AND  M.GLBL_CMPY_CD                =  RWSV.GLBL_CMPY_CD
               AND  ISM.GLBL_CMPY_CD (+)          =  RWSV.GLBL_CMPY_CD
               AND  LTP.GLBL_CMPY_CD (+)          =  RWSV.GLBL_CMPY_CD
               AND  SM.GLBL_CMPY_CD (+)           =  RWSV.GLBL_CMPY_CD
               AND  V.GLBL_CMPY_CD (+)            =  RWSV.GLBL_CMPY_CD
               AND  W.GLBL_CMPY_CD                =  RWSV.GLBL_CMPY_CD
               AND  OTP.GLBL_CMPY_CD              =  RWSV.GLBL_CMPY_CD
               AND  SS.GLBL_CMPY_CD (+)           =  RWSV.GLBL_CMPY_CD
               AND  OTP.SCE_ORD_TP_CD             =  RWSV.SCE_ORD_TP_CD
               <!-- MOD UnitTest#130 -->
               AND  W.INVTY_LOC_CD                =  RWSV.INVTY_LOC_CD
               AND  V.VND_CD (+)                  =  RWSV.RWS_CARR_CD
               AND  SM.IMPT_INV_SHPG_METH_CD (+)  =  RWSV.IMPT_INV_SHPG_METH_CD
               AND  ISM.INLND_SHPG_METH_CD (+)    =  RWSV.INLND_SHPG_METH_CD
               AND  LTP.LOC_TP_CD (+)             =  RWSV.FROM_LOC_TP_CD
               AND  SS.STK_STS_CD (+)             =  RWSV.INVTY_STK_STS_CD
               AND  M.MDSE_CD                     =  RWSV.MDSE_CD
               <!-- Add Defect#7680 -->
               AND  RBL.GLBL_CMPY_CD (+)          =  RWSV.GLBL_CMPY_CD
               AND  RBL.MDSE_CD (+)               =  RWSV.MDSE_CD
               AND  RBL.WH_CD (+)                 =  RWSV.WH_CD
               AND  RBL.STK_STS_CD (+)            =  RWSV.INVTY_STK_STS_CD
     ORDER BY
                    RWSV.RWS_NUM
                   ,M.FIRST_PROD_CTRL_CD
                   ,RWSV.MDSE_CD
                   ,M.MDSE_NM
                   ,RWSV.RWS_QTY
	</statement>
	
    <statement id="getOutPackCseQty" parameterClass="Map">
    SELECT
               RWSD.OUT_PACK_CSE_QTY
              ,IPS.IMPT_ITEM_PACK_TP_CD
              ,IPS.IMPT_PACK_SLP_LINE_NUM
    FROM
               RWS_HDR        RWSH
              ,RWS_DTL        RWSD
              ,IMPT_PACK_SLP  IPS
              ,MDSE           M
              ,DS_INVTY_LOC_V W
              ,SCE_ORD_TP     OTP
    WHERE
                    RWSH.RWS_NUM          =  #rwsNum#
               AND  RWSD.RWS_NUM          =  RWSH.RWS_NUM
               AND  IPS.IMPT_PACK_SLP_PK  =  RWSD.IMPT_PACK_SLP_PK
               AND  IPS.CNTNR_DO_NUM      =  RWSD.IMPT_INV_DO_NUM || RWSD.IMPT_DO_CLS_CD
               AND  W.INVTY_LOC_CD        =  RWSH.WH_CD
               AND  M.MDSE_CD             =  RWSD.MDSE_CD
               AND  OTP.INBD_OTBD_CD      =  #unbdOtbdCd#
               AND  OTP.SCE_ORD_TP_CD     =  RWSH.SCE_ORD_TP_CD
               AND  RWSH.GLBL_CMPY_CD     =  #glblCmpyCd#
               AND  RWSH.GLBL_CMPY_CD     =  RWSD.GLBL_CMPY_CD
               AND  RWSH.GLBL_CMPY_CD     =  IPS.GLBL_CMPY_CD
               AND  RWSH.GLBL_CMPY_CD     =  W.GLBL_CMPY_CD
               AND  RWSH.GLBL_CMPY_CD     =  M.GLBL_CMPY_CD
               AND  RWSH.GLBL_CMPY_CD     =  OTP.GLBL_CMPY_CD
               AND  RWSH.EZCANCELFLAG     =  '0'
               AND  RWSD.EZCANCELFLAG     =  '0'
               AND  IPS.EZCANCELFLAG      =  '0'
               AND  M.EZCANCELFLAG        =  '0'
               AND  W.EZCANCELFLAG        =  '0'
               AND  OTP.EZCANCELFLAG      =  '0'
    </statement>
</sqlMap>
