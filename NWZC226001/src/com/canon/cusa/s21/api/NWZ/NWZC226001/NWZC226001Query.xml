<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NWZC226001Query">

    <typeAlias alias="CTAC_PSNTMsg"           type="business.db.CTAC_PSNTMsg"/>

    <statement id="getImptHdr" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            DIO.DS_IMPT_ORD_PK                           -- Direct Sales Import Order PK
            ,DIO.CPO_SRC_TP_CD                            -- CPO Source Type Code
            ,DIO.ORD_SRC_IMPT_TS                          -- Order Source Import Timestamp
            ,DIO.ORD_SRC_REF_NUM                          -- Order Source Reference Number
            ,DIO.IMPT_STS_CD                              -- Import Status Code
            ,DIO.SYS_SRC_CD                               -- System Source Code
            ,DIO.DS_ORD_CATG_CD                           -- Order Category Code
            ,DIO.DS_ORD_TP_CD                             -- Order Type Code
            ,DIO.DS_ORD_RSN_CD                            -- Direct Sales Order Reason Code
            ,DIO.CPO_ORD_TP_CD                            -- Customer Purchase Order Type Code
            ,DIO.CUST_ISS_PO_NUM                          -- Customer Issue PO Number
            ,DIO.CUST_ISS_PO_DT                           -- Customer Issue PO Date
            ,DIO.BILL_TO_CUST_ACCT_CD                     -- Bill To Customer Account Code
            ,DIO.BILL_TO_CUST_CD                          -- Bill To Customer Code
            ,DIO.SHIP_TO_CUST_ACCT_CD                     -- Ship To Customer Account Code
            ,DIO.SHIP_TO_CUST_CD                          -- Ship To Customer Code
            ,DIO.SELL_TO_CUST_CD                          -- Sell To Customer Code
            ,DIO.SOLD_TO_CUST_LOC_CD                      -- Sold To Customer Location Code
            ,DIO.DROP_SHIP_FLG                            -- Drop Ship Flag
            ,DIO.SHIP_TO_LOC_NM                           -- Ship To Location Name
            ,DIO.SHIP_TO_ADDL_LOC_NM                      -- Ship To Additional Location Name
            ,DIO.SHIP_TO_FIRST_LINE_ADDR                  -- Ship To First Line Address
            ,DIO.SHIP_TO_SCD_LINE_ADDR                    -- Ship To Second Line Address
            ,DIO.SHIP_TO_THIRD_LINE_ADDR                  -- Ship To Third Line One Address
            ,DIO.SHIP_TO_FRTH_LINE_ADDR                   -- Ship to Fourth Line One Address
            ,DIO.SHIP_TO_CTY_ADDR                         -- Ship To City Address
            ,DIO.SHIP_TO_ST_CD                            -- Ship To State Code
            ,DIO.SHIP_TO_PROV_NM                          -- Ship to Province Address
            ,DIO.SHIP_TO_CNTY_NM                          -- Ship To County Name
            ,DIO.SHIP_TO_POST_CD                          -- Ship To Postal Code
            ,DIO.SHIP_TO_CTRY_CD                          -- Ship To Country Code
            ,DIO.SHIP_TO_01_REF_CMNT_TXT                  -- Ship to 01 Reference Comment Text
            ,DIO.SHIP_TO_02_REF_CMNT_TXT                  -- Ship to 02 Reference Comment Text
            ,DIO.ADMIN_PSN_CD                             -- Admin Person Code
            ,DIO.RDD_DT                                   -- RDD Date
            ,DIO.FRT_COND_CD                              -- Freight Condition Code
            ,DIO.SPCL_HDLG_TP_CD                          -- Special Handling Type Code
            ,DIO.CARR_CD                                  -- Carrier Code
            ,DIO.CARR_SVC_LVL_CD                          -- Carrier Service Level
            ,DIO.SHPG_SVC_LVL_CD                          -- Shipping Service Level Code
            ,DIO.FRT_CHRG_TO_CD                           -- Freight Charge To Code
            ,DIO.FRT_CHRG_METH_CD                         -- Freight Charge Method Code
            ,DIO.CARR_ACCT_NUM                            -- Carrier Account Number
            ,DIO.ADD_PMT_TERM_CASH_DISC_CD                -- Payment Term Cash Discount Code
            ,DIO.DS_PMT_METH_CD                           -- WDS Payment Method Code
            ,DIO.PRE_PMT_CHK_NUM                          -- Pre Payment Check Number
            ,DIO.PRE_PMT_AMT                              -- Pre Payment Amount
            ,DIO.PRE_PMT_TP_CD                            -- Pre Payment Type Code
            ,DIO.PRC_BASE_DT                              -- Price Based Date
            ,DIO.NEGO_DEAL_AMT                            -- Negotiated Deal Amount
            ,DIO.PRC_CATG_CD                              -- Price Category Code
            ,DIO.FL_PRC_LIST_CD                           -- Floor Price List Code
            ,DIO.PRC_CONTR_NUM                            -- Price Contract Number
            ,DIO.CSMP_CONTR_NUM                           -- Marketing Program Number
            ,DIO.DLR_REF_NUM                              -- CSA Dealer Reference Number
            ,DIO.ORD_SGN_DT                               -- Order Signed Date
            ,DIO.AQU_NUM                                  -- Acquisition Number
            ,DIO.SLS_REP_TOC_CD                           -- Sales Rep Code
            ,DIO.LOAN_PER_DAYS_AOT                        -- Loan Period Days Amount of Time
            ,DIO.LEASE_CMPY_PO_NUM                        -- Lease Company PO Number
            ,DIO.LEASE_TERM_CD                            -- Lease Term Code
            ,DIO.LEASE_PRCH_OPT_CD                        -- Lease Purchase Optional Code
            ,DIO.LEASE_PMT_FREQ_CD                        -- Lease Payment Frequency Code
            ,DIO.ORD_LOG_TP_CD                            -- Order Log Type Code
            ,DIO.CR_REBIL_RSN_CATG_CD                     -- Credit Rebill Reason Category Code
            ,DIO.ORIG_ORD_NUM                             -- Original Order Number
            ,DIO.SEND_INV_FLG                             -- Send Invoice Flag
            ,DIO.RE_BILL_PAIR_CPO_ORD_NUM                 -- Re Bill Pair CPO Order Number
            ,DIO.ORD_HDR_EDTBL_FLG                        -- Order Header Editable Flag
            ,CST.ORD_CRAT_MODE_CD                         -- Order Creation Mode Code
            ,CST.AUTO_DOC_ATT_FLG
            ,CST.PRC_FRZ_FLG
            ,DIO.DCLN_SVC_CD
            ,DIO.LEASE_TERM_MTH_AOT
            ,DIO.MAINT_ONLY_FLG
            <isEqual property="isLoan" compareValue="true">
            ,ICONF.CONFIG_TP_CD
            ,OO.CPO_ORD_NUM               LOAN_ORIG_ORD_NUM
            ,OO.DS_ORD_CATG_CD            LOAN_ORIG_DS_ORD_CATG_CD
            ,CASE WHEN ICONF.CONFIG_TP_CD = 'O01' THEN 1 
                  WHEN ICONF.CONFIG_TP_CD = 'O02' THEN 2 
                  WHEN ICONF.CONFIG_TP_CD = 'R02' THEN 3 
                  WHEN ICONF.CONFIG_TP_CD = 'O04' THEN 4 
                  ELSE 5 
             END                          SORT_CONF_TP
            </isEqual>
        FROM
            DS_IMPT_ORD          DIO        -- Direct Sales Import Order
            ,IMPT_STS            IPS        -- Import Status
            ,CPO_SRC_TP          CST        -- CPO Source Type
            <isEqual property="isLoan" compareValue="true">
            ,DS_IMPT_ORD_CONFIG  ICONF      -- Direct Sales import Order Configuration
            ,(
              SELECT DISTINCT
                   CCONF.GLBL_CMPY_CD
                  ,CCONF.SVC_CONFIG_MSTR_PK
                  ,DTL.CPO_ORD_NUM
                  ,CPO.DS_ORD_CATG_CD
              FROM 
                 DS_CPO_CONFIG       CCONF      -- Direct Sales CPO Configuration
                ,CPO                 CPO        -- CPO
                ,CPO_DTL             DTL        -- CPO Detail
              WHERE
                    CCONF.GLBL_CMPY_CD       = #glblCmpyCd#
                AND CCONF.EZCANCELFLAG       = '0'
                AND CCONF.CONFIG_CATG_CD     = #configCatgCd#

                AND CCONF.GLBL_CMPY_CD       = CPO.GLBL_CMPY_CD
                AND CCONF.CPO_ORD_NUM        = CPO.CPO_ORD_NUM
                AND CPO.EZCANCELFLAG         = '0'
                AND CPO.ORD_HDR_STS_CD       NOT IN
                <iterate property="ordHdrStsCdList" var="ordHdrStsCd[]" open="(" close=")" conjunction=",">
                    #ordHdrStsCd[]#
                </iterate>
                AND CPO.ADD_ORIG_CPO_ORD_NUM IS NULL
                AND CPO.EZCANCELFLAG         = '0'
                AND CPO.GLBL_CMPY_CD         = DTL.GLBL_CMPY_CD
                AND CPO.CPO_ORD_NUM          = DTL.CPO_ORD_NUM
                AND CCONF.DS_ORD_POSN_NUM    = DTL.DS_ORD_POSN_NUM
                AND DTL.ORD_LINE_STS_CD      NOT IN
                 <iterate property="ordLineStsCdList" var="ordLineStsCd[]" open="(" close=")" conjunction=",">
                    #ordLineStsCd[]#
                 </iterate>
                AND DTL.BASE_CMPT_FLG        = 'Y'
                AND DTL.EZCANCELFLAG         = '0'
             ) OO
            </isEqual>
        WHERE
            DIO.EZCANCELFLAG             = '0'
            AND DIO.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DIO.DS_IMPT_ORD_PK       = #dsImptOrdPk#
            AND DIO.EZCANCELFLAG         = IPS.EZCANCELFLAG
            AND DIO.GLBL_CMPY_CD         = IPS.GLBL_CMPY_CD
            AND DIO.IMPT_STS_CD          = IPS.IMPT_STS_CD
            AND IPS.IMPT_BAT_TRGT_FLG    = 'Y'
            AND DIO.EZCANCELFLAG         = CST.EZCANCELFLAG
            AND DIO.GLBL_CMPY_CD         = CST.GLBL_CMPY_CD
            AND CST.CPO_SRC_TP_CD        = DIO.CPO_SRC_TP_CD
       <isEqual property="isLoan" compareValue="true">
            AND DIO.GLBL_CMPY_CD         = ICONF.GLBL_CMPY_CD(+)
            AND DIO.DS_IMPT_ORD_PK       = ICONF.DS_IMPT_ORD_PK(+)
            AND ICONF.EZCANCELFLAG(+)    = '0'
            AND ICONF.GLBL_CMPY_CD       = OO.GLBL_CMPY_CD(+)
            AND ICONF.SVC_CONFIG_MSTR_PK = OO.SVC_CONFIG_MSTR_PK(+)
        ORDER BY 
            SORT_CONF_TP        ASC
            ,LOAN_ORIG_ORD_NUM  ASC NULLS FIRST
       </isEqual>
    </statement>

    <statement id="getOrdCatgCtxTpCd" parameterClass="Map" resultClass="String">
        SELECT
            OCBC.ORD_CATG_CTX_TP_CD        -- Order Category Context Type Code
        FROM
            ORD_CATG_BIZ_CTX    OCBC       -- Order Category Business Context
        WHERE
            OCBC.EZCANCELFLAG        = '0'
            AND OCBC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND OCBC.ORD_CATG_CTX_TP_CD  = #ordCatgCtxTpCd#
            AND (
                 (OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                  AND OCBC.DS_ORD_TP_CD IS NULL
                  AND OCBC.DS_ORD_RSN_CD IS NULL)
                 OR
                 (OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                  AND OCBC.DS_ORD_TP_CD  = #dsOrdTpCd#
                  AND OCBC.DS_ORD_RSN_CD IS NULL)
                 OR
                 (OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                  AND OCBC.DS_ORD_TP_CD  = #dsOrdTpCd#
                  AND OCBC.DS_ORD_RSN_CD = #dsOrdRsnCd#)
            )
    </statement>

    <statement id="getLineBizTpCd" parameterClass="Map" resultClass="String">
        SELECT
            DOTPD.LINE_BIZ_TP_CD                         -- Line of Business Type Code
        FROM
            DS_ORD_TP_PROC_DFN   DOTPD     -- Direct Sales Order Type Process Definition
        WHERE
            DOTPD.EZCANCELFLAG       = '0'
            AND DOTPD.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DOTPD.DS_ORD_TP_CD   = #dsOrdTpCd#
            AND DOTPD.ACTV_FLG     = 'Y'
    </statement>

    <statement id="getShipToAccount" parameterClass="Map" resultClass="Map">
        SELECT
            SLTC.SELL_TO_CUST_CD                          -- Attribute definition, Data examples
        FROM
            SHIP_TO_CUST        SPTC        -- It is a Ship to Address master.
            ,SELL_TO_CUST       SLTC        -- It is a Sell to Address master
        WHERE
            SPTC.EZCANCELFLAG        = '0'
            AND SPTC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND SPTC.RGTN_STS_CD     = #rgtnStsCd#
            AND SPTC.EZCANCELFLAG    = SLTC.EZCANCELFLAG
            AND SPTC.GLBL_CMPY_CD    = SLTC.GLBL_CMPY_CD
            AND SPTC.SHIP_TO_CUST_CD = SLTC.SELL_TO_CUST_CD
            AND SLTC.RGTN_STS_CD     = #rgtnStsCd#
            AND SPTC.SHIP_TO_CUST_CD = #shipToCustCd#
    </statement>

    <statement id="getBillOrSoldToAccount" parameterClass="Map" resultClass="Map">
        SELECT
            SLTC.SELL_TO_CUST_CD                          -- Attribute definition, Data examples
        FROM
            BILL_TO_CUST         BLTC        -- It is a Bill to Address master.
            ,SELL_TO_CUST        SLTC        -- It is a Sell to Address master
        WHERE
            BLTC.EZCANCELFLAG           = '0'
            AND BLTC.GLBL_CMPY_CD       = #glblCmpyCd#
            AND BLTC.BILL_TO_CUST_CD    = #billOrSldToCustCd#
            AND BLTC.RGTN_STS_CD        = #rgtnStsCd#
            AND SLTC.EZCANCELFLAG       = BLTC.EZCANCELFLAG
            AND SLTC.GLBL_CMPY_CD       = BLTC.GLBL_CMPY_CD
            AND SLTC.SELL_TO_CUST_CD    = BLTC.SELL_TO_CUST_CD
            AND SLTC.RGTN_STS_CD        = #rgtnStsCd#
    </statement>

    <statement id="getCarrSvcLvlCd" parameterClass="EZDMsg" resultClass="Map">
        SELECT
            SSLCR.CARR_SVC_LVL_CD                          -- Carrier Service Level Code
        FROM
            SHPG_SVC_LVL_CARR_RELN SSLCR      -- Shipping Service Level Carrier Relation
        WHERE
            SSLCR.EZCANCELFLAG          = '0'
            AND SSLCR.GLBL_CMPY_CD      = #glblCmpyCd#
            AND SSLCR.SHPG_SVC_LVL_CD   = #shpgSvcLvlCd#
            AND SSLCR.CARR_CD           = #carrCd#
    </statement>

    <!-- 2018/01/23 QC#18798 Add Start -->
    <statement id="getDsImptOrdConfigPkList" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            DIOC.DS_IMPT_ORD_CONFIG_PK
        FROM
            DS_IMPT_ORD_CONFIG DIOC
        WHERE
                DIOC.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIOC.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIOC.EOPS_CONFIG_LTR_TXT IN (
                                             SELECT
                                                 DIOC2.EOPS_CONFIG_LTR_TXT
                                             FROM
                                                 DS_IMPT_ORD_CONFIG DIOC2
                                             WHERE
                                                 DIOC2.GLBL_CMPY_CD = #glblCmpyCd#
                                             AND DIOC2.DS_IMPT_ORD_PK = #dsImptOrdPk#
                                             AND DIOC2.DS_IMPT_ORD_CONFIG_PK = #dsImptOrdConfigPk#
                                             AND DIOC2.EZCANCELFLAG = '0'
                                            )
            AND DIOC.EZCANCELFLAG = '0'
    </statement>
    <!-- 2018/01/23 QC#18798 Add End -->

    <statement id="getDsImptOrdConfigPk" parameterClass="Map" resultClass="Map">
         SELECT DISTINCT 
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            CONF_INFO.*
            <!--  CONF_INFO.DS_IMPT_ORD_CONFIG_PK -->
            <!-- ,CONF_INFO.DS_ORD_POSN_NUM -->
            <!-- ,CONF_INFO.CONFIG_TP_CD -->
            <!-- ,CONF_INFO.CONFIG_CATG_CD -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM (
            SELECT
                <!-- 2018/06/12 S21_NA#24294 Mod Start -->
                DIOC.*
                <!-- DIOC.DS_IMPT_ORD_CONFIG_PK                     DS CPO Config Primary Key -->
                <!-- ,DIOC.DS_ORD_POSN_NUM -->
                <!-- ,DIOC.CONFIG_TP_CD -->
                <!-- ,DIOC.CONFIG_CATG_CD -->
                <!-- 2018/06/12 S21_NA#24294 Mod End -->
            FROM
                DS_IMPT_ORD_CONFIG   DIOC                      -- Direct Sales Import Order Configuration Inforamtion
                <isNotNull property="origCpoOrdNum">
                ,DS_CPO_CONFIG       CCONF
                </isNotNull>
            WHERE
                DIOC.EZCANCELFLAG           = '0'
                AND DIOC.GLBL_CMPY_CD       = #glblCmpyCd#
                AND DIOC.DS_IMPT_ORD_PK     = #dsImptOrdPk#
                <!-- 2018/01/23 S21_NA#18798 Add Start -->
                <isNotNull property="dsImptOrdConfigPkList">
                AND DIOC.DS_IMPT_ORD_CONFIG_PK IN
                <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                    #dsImptOrdConfigPk[]#
                </iterate>
                </isNotNull>
                <!-- 2018/01/23 S21_NA#18798 Add End -->
                <isNotNull property="configTpCd">
                AND DIOC.CONFIG_TP_CD       = #configTpCd#
                </isNotNull>
                <isEqual property="isLoanNewFlg" compareValue="Y">
                AND DIOC.SVC_CONFIG_MSTR_PK IS NULL
                </isEqual>
                <isNotNull property="origCpoOrdNum">
                AND DIOC.GLBL_CMPY_CD       = CCONF.GLBL_CMPY_CD
                AND DIOC.SVC_CONFIG_MSTR_PK = CCONF.SVC_CONFIG_MSTR_PK
                AND CCONF.CPO_ORD_NUM       = #origCpoOrdNum#
                AND CCONF.EZCANCELFLAG      = '0'
                </isNotNull>
                <!-- 2019/01/29 S21_NA#30022 Add Start -->
                AND (DIOC.CONFIG_CATG_CD    = #configCatgOut# 
                    AND EXISTS 
                        (SELECT 1 FROM DS_IMPT_ORD_DTL DIOD 
                         WHERE DIOC.GLBL_CMPY_CD = DIOD.GLBL_CMPY_CD
                         AND DIOC.DS_IMPT_ORD_PK = DIOD.DS_IMPT_ORD_PK 
                         AND DIOC.DS_ORD_POSN_NUM = DIOD.DS_ORD_POSN_NUM
                         AND DIOD.IMPT_LINE_FLG = #imptLineFlgY#
                         AND DIOD.EZCANCELFLAG      = '0') 
                     OR DIOC.CONFIG_CATG_CD = #configCatgIn#)
                <!-- 2019/01/29 S21_NA#30022 Add End -->
            ORDER BY
                 DIOC.CONFIG_CATG_CD
                ,LPAD(DIOC.DS_ORD_POSN_NUM, 4, '0')
        ) CONF_INFO 
        ORDER BY 
            CONF_INFO.CONFIG_CATG_CD
           ,LPAD(CONF_INFO.DS_ORD_POSN_NUM, 4, '0')
    </statement>

    <statement id="getConfigToc" parameterClass="Map" resultClass="Map">
        SELECT
            DIOSC.SLS_REP_TOC_CD                        -- Sales Rep Code
            ,T.COA_BR_CD                                -- Attribute Definition,Example Data
            ,T.COA_EXTN_CD                              -- COA Extension Code
        FROM
            DS_IMPT_ORD_SLS_CR   DIOSC      -- Direct Sales Import Order Sales Credit
            ,TOC                 T          -- Transaction Organization Code
        WHERE
            DIOSC.EZCANCELFLAG       = '0'
            AND DIOSC.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIOSC.EZCANCELFLAG   = T.EZCANCELFLAG
            AND DIOSC.DS_IMPT_ORD_CONFIG_PK = #dsImptOrdConfigPk#
            AND DIOSC.GLBL_CMPY_CD   = T.GLBL_CMPY_CD
            AND T.TOC_CD             = DIOSC.SLS_REP_TOC_CD
            <!-- 2018/01/23 QC#18798 Mod Start -->
            <!--AND DIOSC.SLS_REP_ROLE_TP_CD IN(#essw#, #ppsw#, #lfsw#) -->
            AND DIOSC.SLS_REP_ROLE_TP_CD IN(#essw#, #ppsw#, #lfsw#, #emsdw#)
            <!-- 2018/01/23 QC#18798 Mod End -->
    </statement>

    <statement id="getLineData" parameterClass="Map" resultClass="Map">
        SELECT
             <!-- 2018/06/11 S21_NA#24294 Mod Start -->
             DIOD.*
             <!-- ,DIOD.DS_IMPT_ORD_DTL_PK                        Direct Sales Import Order PK -->
             <!-- ,AMV.MDSE_TP_CD -->
             <!-- ,DOLPD.DS_ORD_LINE_CATG_CD                       Represents Order Line Category -->
             <!-- ,DIOD.DS_ORD_POSN_NUM -->
             <!-- ,DIOD.ORD_SRC_REF_LINE_NUM -->
             <!-- ,DIOD.ORD_SRC_REF_LINE_SUB_NUM -->
             <!-- ,DIOC.DS_IMPT_ORD_CONFIG_PK -->
             <!-- 2018/06/11 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_ORD_DTL      DIOD       -- Direct Sales Import Order Detail
            ,DS_IMPT_ORD_CONFIG  DIOC       -- Direct Sales Import Order Configuration Information
            <!-- ,ALL_MDSE_V          AMV  --> <!-- 2018/06/11 S21_NA#24294 Del -->
            ,DS_ORD_LINE_PROC_DFN DOLPD     -- Direct Sales Order Line Process Definition 
        WHERE
            DIOD.EZCANCELFLAG           = '0'
            AND DIOD.GLBL_CMPY_CD       = #glblCmpyCd#
            AND DIOD.DS_IMPT_ORD_PK     = #dsImptOrdPk#
            AND DIOD.IMPT_LINE_FLG      = 'Y'
            <isNotNull property="finItemLineFlg">
            <!-- 2019/01/16 S21_NA#29967 Mod Start -->
            <!-- AND DIOD.FIN_ITEM_LINE_FLG  = #finItemLineFlg# -->
            AND (DIOD.FIN_ITEM_LINE_FLG  = #finItemLineFlg# OR
                (DIOD.FIN_ITEM_LINE_FLG  = #finItemLineFlg_N# 
                 AND EXISTS (
                            SELECT 1 FROM DS_IMPT_SVC_ADDL_BASE SAB 
                            WHERE DIOD.GLBL_CMPY_CD = SAB.GLBL_CMPY_CD
                              AND DIOD.DS_IMPT_ORD_DTL_PK = SAB.DS_IMPT_ORD_DTL_PK
                              AND SAB.EZCANCELFLAG = '0')
                 ))
            <!-- 2019/01/16 S21_NA#29967 Mod End -->
            </isNotNull>
            AND DIOD.EZCANCELFLAG       = DIOC.EZCANCELFLAG
            AND DIOD.GLBL_CMPY_CD       = DIOC.GLBL_CMPY_CD
            AND DIOC.DS_IMPT_ORD_PK     = DIOD.DS_IMPT_ORD_PK
            AND DIOC.DS_IMPT_ORD_CONFIG_PK = DIOD.DS_IMPT_ORD_CONFIG_PK
            AND DIOC.DS_IMPT_ORD_CONFIG_PK IN 
            <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                #dsImptOrdConfigPk[]#
            </iterate>
            <!-- 2018/06/11 S21_NA#24294 Del Start -->
            <!-- AND DIOD.EZCANCELFLAG       = AMV.EZCANCELFLAG(+) -->
            <!-- AND DIOD.GLBL_CMPY_CD       = AMV.GLBL_CMPY_CD(+) -->
            <!-- AND DIOD.MDSE_CD            = AMV.MDSE_CD(+) -->
            <!-- 2018/06/11 S21_NA#24294 Del End -->
            AND DIOD.EZCANCELFLAG       = DOLPD.EZCANCELFLAG(+)
            AND DIOD.GLBL_CMPY_CD       = DOLPD.GLBL_CMPY_CD(+)
            AND DOLPD.DS_ORD_TP_CD(+)           = #dsOrdTpCd#
            AND DOLPD.DS_ORD_LINE_CATG_CD(+)    = DIOD.DS_ORD_LINE_CATG_CD
            AND DOLPD.PRIM_LINE_CATG_FLG(+)     = 'Y'
            AND DOLPD.EFF_FROM_DT(+)        &lt;= #slsDt#
            AND NVL(DOLPD.EFF_THRU_DT(+), '99991231') &gt;= #slsDt#
            AND DOLPD.ACTV_FLG(+)               = 'Y'
        ORDER BY
             LPAD(DIOD.DS_ORD_POSN_NUM, 4, '0')
             <!-- Mod Start 2017/07/26 QC#18022 -->
            <!-- ,DECODE(DIOD.ORD_SRC_REF_LINE_SUB_NUM, NULL, LPAD(DIOD.ORD_SRC_REF_LINE_NUM, 50, 'Z'), LPAD(DIOD.ORD_SRC_REF_LINE_NUM, 50, '0')) -->
            ,DECODE(DIOD.ORD_SRC_REF_LINE_NUM, NULL, LPAD(DIOD.ORD_SRC_REF_LINE_NUM, 50, 'Z'), LPAD(DIOD.ORD_SRC_REF_LINE_NUM, 50, '0'))
            <!-- Mod End 2017/07/26 QC#18022 -->
            ,LPAD(DIOD.ORD_SRC_REF_LINE_SUB_NUM, 50, '0')
    </statement>

    <statement id="getMdseInfo" parameterClass="Map" resultClass="Map">
        SELECT
            MDSE.COA_PROD_CD         AS COA_PROD_CD
           ,CP.COA_PROD_DESC_TXT     AS COA_PROD_DESC_TXT
           ,CPJ.COA_PROJ_CD          AS COA_MDSE_TP_CD
           ,CPJ.COA_PROJ_DESC_TXT    AS COA_MDSE_TP_DESC_TXT
           ,MSP.PKG_UOM_CD           AS PKG_UOM_CD
        FROM
            MDSE              MDSE
           ,COA_PROD          CP
           ,COA_PROJ          CPJ
           ,MDSE_STORE_PKG    MSP
        WHERE
            MDSE.GLBL_CMPY_CD     = #glblCmpyCd#
            AND MDSE.MDSE_CD      = #mdseCd#
            AND MDSE.RGTN_STS_CD  = #rgtnStsCd#
            AND MDSE.EZCANCELFLAG = '0'

            AND MDSE.GLBL_CMPY_CD = CP.GLBL_CMPY_CD
            AND MDSE.COA_PROD_CD  = CP.COA_PROD_CD
            AND CP.EZCANCELFLAG   = '0'

            AND MDSE.GLBL_CMPY_CD   = CPJ.GLBL_CMPY_CD
            AND MDSE.COA_MDSE_TP_CD = CPJ.COA_PROJ_CD
            AND CPJ.EZCANCELFLAG    = '0'

            AND MDSE.GLBL_CMPY_CD = MSP.GLBL_CMPY_CD
            AND MDSE.MDSE_CD      = MSP.MDSE_CD
            <isEqual property="isCalledMdl" compareValue="true">
                AND MSP.BASE_PKG_UOM_CD IS NOT NULL
            </isEqual>
            <isEqual property="isCalledMdl" compareValue="false">
                AND MSP.PRIM_PKG_UOM_FLG = 'Y'
            </isEqual>
            AND MSP.EZCANCELFLAG = '0'
    </statement>

    <statement id="getMdseForSet" parameterClass="Map" resultClass="Map">
        SELECT 
             NVL(CMP.CHILD_MDSE_CD, CMP.CHILD_ORD_TAKE_MDSE_CD) AS MDSE_CD
            ,CMP.CHILD_MDSE_QTY 
        FROM
            CMPSN CMP
        WHERE 
                CMP.GLBL_CMPY_CD                    = #glblCmpyCd#
            AND CMP.EZCANCELFLAG                    = '0'
            AND CMP.PRNT_MDSE_CD                    = #prntMdseCd#
            AND CMP.EFF_FROM_DT                     &lt;= #ordSrcImptTs#
            AND NVL(CMP.EFF_THRU_DT, '99991231')    &gt;= #ordSrcImptTs#
        <!-- 2017/03/01 QC#16800 Add Start -->
        ORDER BY
            CMP.CMPSN_PK
        <!-- 2017/03/01 QC#16800 Add End   -->
     </statement>

    <!-- 2018/06/05 S21_NA#26443 Mod Start -->
    <!-- <statement id="getEachQtyForUom" parameterClass="Map" resultClass="BigDecimal"> -->
    <statement id="getMdseStorePkgInfo" parameterClass="Map" resultClass="Map">
    <!-- 2018/06/05 S21_NA#26443 Mod End -->
        SELECT
            MSP.IN_EACH_QTY                              -- Attribute definition goes here,Example Data
            <!-- 2018/06/05 S21_NA#26443 Add Start -->
           ,MSP.IN_POUND_WT
            <!-- 2018/06/05 S21_NA#26443 Add End -->
        FROM
            MDSE_STORE_PKG       MSP        -- Merchandise Storage Package
        WHERE
            MSP.EZCANCELFLAG        = '0'
            AND MSP.GLBL_CMPY_CD    = #glblCmpyCd#
            <!-- 2017/11/10 S21_NA#22464 Mod Start -->
            <!-- AND MSP.PKG_UOM_CD      = #pkgUomCd# -->
            AND (
                MSP.PKG_UOM_CD      = #pkgUomCd#
                OR
                MSP.BASE_PKG_UOM_CD = #pkgUomCd#
            )
            <!-- 2017/11/10 S21_NA#22464 Mod End -->
            AND MSP.MDSE_CD         = #mdseCd#
    </statement>

    <statement id="getMdseSupplInfo" parameterClass="Map" resultClass="Map">
        SELECT
             MDSE.INSTL_BASE_CTRL_FLG                      -- InstallBase Controlled
            ,MTVS.MDSE_TP_CTX_TP_CD                        -- Merchandise Type Context Type Code
        FROM
             MDSE                MDSE       -- Merchandise
            ,MDSE_TP_VAL_SET     MTVS       -- Merchandise Type Value Set
        WHERE
            MDSE.EZCANCELFLAG       = '0'
            AND MDSE.GLBL_CMPY_CD   = #glblCmpyCd#
            AND MDSE.MDSE_CD        = #mdseCd#
            AND MDSE.GLBL_CMPY_CD   = MTVS.GLBL_CMPY_CD(+)
            AND MDSE.COA_MDSE_TP_CD = MTVS.COA_MDSE_TP_CD(+)
            AND MTVS.MDSE_TP_CTX_TP_CD(+) = #mdseTpCtxTpCd#
            AND MTVS.EZCANCELFLAG(+) = '0'
    </statement>

    <statement id="getReturnLineData" parameterClass="Map" resultClass="Map">
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DIORD.*
            <!-- DIOC.DS_IMPT_ORD_CONFIG_PK                      Direct Sales Import Order Config PK  -->
            <!-- ,DIORD.DS_IMPT_ORD_RTRN_DTL_PK                   Direct Sales Import Order Return Detail PK  -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_ORD_RTRN_DTL DIORD      -- Direct Sales Import Order Return Detail
            ,DS_IMPT_ORD_CONFIG   DIOC      -- Direct Sales Import Order Configuration Inforamtion
        WHERE
            DIORD.EZCANCELFLAG       = '0'
            AND DIORD.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIORD.EZCANCELFLAG   = DIOC.EZCANCELFLAG
            AND DIORD.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIORD.GLBL_CMPY_CD   = DIOC.GLBL_CMPY_CD
            AND DIOC.DS_IMPT_ORD_PK  = DIORD.DS_IMPT_ORD_PK
            AND DIOC.DS_IMPT_ORD_CONFIG_PK = DIORD.DS_IMPT_ORD_CONFIG_PK
            AND DIOC.DS_IMPT_ORD_CONFIG_PK IN 
            <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                #dsImptOrdConfigPk[]#
            </iterate>
        ORDER BY
             LPAD(DIORD.DS_ORD_POSN_NUM, 4, '0')
            ,DECODE(DIORD.ORD_SRC_REF_LINE_SUB_NUM, NULL, LPAD(DIORD.ORD_SRC_REF_LINE_NUM, 50, 'Z'), LPAD(DIORD.ORD_SRC_REF_LINE_NUM, 50, '0'))
            ,LPAD(DIORD.ORD_SRC_REF_LINE_SUB_NUM, 50, '0')

    </statement>



    <statement id="getDsImptPrcCalcBaseInfo" parameterClass="Map" resultClass="Map"><!-- 2018/06/12 S21_NA#24294 Mod resultClass BigDecimal to Map -->
        SELECT
        <!-- 2018/06/15 S21_NA#24294 Mod Start -->
             DIPCB.*
             <!-- DIPCB.DS_IMPT_PRC_CALC_BASE_PK                Direct Sales Import Price Calc Primary Key -->
        FROM
              DS_IMPT_ORD DIO
            , DS_IMPT_PRC_CALC_BASE DIPCB
            <!-- DS_IMPT_PRC_CALC_BASE DIPCB       Direct Sales Import Pricing Calc Base  -->
        WHERE
                DIO.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIO.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIO.EZCANCELFLAG   = '0'
            
            AND DIO.GLBL_CMPY_CD   = DIPCB.GLBL_CMPY_CD
            AND DIO.DS_IMPT_ORD_PK = DIPCB.DS_IMPT_ORD_PK
            AND DIPCB.PRC_DTL_GRP_CD = #prcDtlGrpCd#
            AND DIPCB.EZCANCELFLAG   = '0'
            
            <!-- DIPCB.EZCANCELFLAG       = '0' -->
            <!-- AND DIPCB.GLBL_CMPY_CD   = #glblCmpyCd# -->
            <!-- AND DIPCB.DS_IMPT_ORD_DTL_PK = #dsImptOrdDtlPk# -->
            <!-- AND DIPCB.PRC_DTL_GRP_CD = #prcDtlGrpCd# -->
            <!-- 2018/06/15 S21_NA#24294 Mod End -->
    </statement>

    <statement id="getDsImptSvcDtl" parameterClass="Map" resultClass="Map"><!-- 2018/06/12 S21_NA#24294 Mod resultClass BigDecimal to Map -->
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DISD.*
            <!-- DISD.DS_IMPT_SVC_DTL_PK                        Primary key of the entity -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_SVC_DTL      DISD       -- Direct Sales Import Service Detail
           ,DS_IMPT_ORD          DIO
           <!-- 2018/01/23 QC#18798 Add Start -->
           <isNotNull property="dsImptOrdDtlPkList">
           ,DS_IMPT_SVC_CONFIG_REF DISCR
           </isNotNull>
           <!-- 2018/01/23 QC#18798 Add End -->
        WHERE
            DIO.EZCANCELFLAG        = '0'
            AND DIO.GLBL_CMPY_CD    = #glblCmpyCd#
            AND DIO.DS_IMPT_ORD_PK  = #dsImptOrdPk#
            AND (DIO.DCLN_SVC_CD    &lt;&gt; '1' OR DIO.DCLN_SVC_CD IS NULL)
            AND DISD.EZCANCELFLAG   = '0'
            AND DISD.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DISD.DS_IMPT_ORD_PK = DIO.DS_IMPT_ORD_PK
            <!-- 2018/01/23 QC#18798 Add Start -->
            <isNotNull property="dsImptOrdDtlPkList">
            AND DISCR.GLBL_CMPY_CD  = #glblCmpyCd#
            AND DISCR.DS_IMPT_SVC_DTL_PK = DISD.DS_IMPT_SVC_DTL_PK
            AND DISCR.DS_IMPT_ORD_DTL_PK IN
            <iterate property="dsImptOrdDtlPkList" var="dsImptOrdDtlPk[]" open="(" close=")" conjunction=",">
                #dsImptOrdDtlPk[]#
            </iterate>
            AND DISCR.EZCANCELFLAG  = '0'
            </isNotNull>
            <!-- 2018/01/23 QC#18798 Add End -->
    </statement>


    <statement id="getDsImptSvcConfigRef" parameterClass="Map" resultClass="Map"><!-- 2018/06/12 S21_NA#24294 Mod resultClass BigDecimal to Map -->
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DISCR.*
            <!-- DISCR.DS_IMPT_SVC_CONFIG_REF_PK                 Primary key of the entity -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_SVC_CONFIG_REF DISCR      -- Direct Sales Import Service Config Reference
           ,DS_IMPT_ORD_DTL        DIOD
           ,DS_IMPT_ORD_CONFIG     DIOC
        WHERE
               DISCR.EZCANCELFLAG        = '0'
            AND DISCR.GLBL_CMPY_CD       = #glblCmpyCd#
            AND DISCR.DS_IMPT_SVC_DTL_PK = #dsImptSvcDtlPk#
            AND DISCR.DS_IMPT_ORD_DTL_PK = DIOD.DS_IMPT_ORD_DTL_PK
            AND DIOD.EZCANCELFLAG        = '0'
            AND DIOD.GLBL_CMPY_CD        = #glblCmpyCd#
            <!-- 2018/01/23 QC#18798 Add Start -->
            <isNotNull property="dsImptOrdDtlPkList">
            AND DIOD.DS_IMPT_ORD_DTL_PK IN
            <iterate property="dsImptOrdDtlPkList" var="dsImptOrdDtlPk[]" open="(" close=")" conjunction=",">
                #dsImptOrdDtlPk[]#
            </iterate>
            </isNotNull>
            <!-- 2018/01/23 QC#18798 Add End -->
            AND DIOD.DS_IMPT_ORD_PK      = DIOC.DS_IMPT_ORD_PK
            AND DIOD.DS_ORD_POSN_NUM     = DIOC.DS_ORD_POSN_NUM
            AND DIOC.CONFIG_CATG_CD      = 'O'
            AND (DIOC.DCLN_SVC_CD         &lt;&gt; '1' OR DIOC.DCLN_SVC_CD IS NULL)
            AND DIOC.EZCANCELFLAG        = '0'
            AND DIOC.GLBL_CMPY_CD        = #glblCmpyCd#
    </statement>


    <statement id="getDsImptSvcPrc" parameterClass="Map" resultClass="Map"><!-- 2018/06/12 S21_NA#24294 Mod resultClass BigDecimal to Map -->
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DISP.*
            <!-- DISP.DS_IMPT_SVC_PRC_PK                        Primary key of the entity -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_SVC_PRC      DISP       -- Direct Sales Import Service Price
           <!-- 2018/01/23 QC#18798 Add Start -->
           <isNotNull property="dsImptOrdDtlPkList">
           ,DS_IMPT_SVC_CONFIG_REF DISCR
           </isNotNull>
           <!-- 2018/01/23 QC#18798 Add End -->
        WHERE
            DISP.EZCANCELFLAG       = '0'
            AND DISP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DISP.DS_IMPT_SVC_DTL_PK = #dsImptSvcDtlPk#
            <!-- 2018/01/23 QC#18798 Add Start -->
            <isNotNull property="dsImptOrdDtlPkList">
            AND DISCR.EZCANCELFLAG  = '0'
            AND DISCR.GLBL_CMPY_CD  = DISP.GLBL_CMPY_CD
            AND DISP.DS_IMPT_SVC_CONFIG_REF_PK = DISCR.DS_IMPT_SVC_CONFIG_REF_PK
            AND DISCR.DS_IMPT_ORD_DTL_PK IN
            <iterate property="dsImptOrdDtlPkList" var="dsImptOrdDtlPk[]" open="(" close=")" conjunction=",">
                #dsImptOrdDtlPk[]#
            </iterate>
            </isNotNull>
            <!-- 2018/01/23 QC#18798 Add End -->
    </statement>

    <!-- Mod Start 2017/06/23 QC#19444 -->
    <statement id="getDsImptSvcUsgPrc" parameterClass="Map" resultClass="Map"><!-- 2018/06/12 S21_NA#24294 Mod resultClass BigDecimal to Map -->
        SELECT
              <!-- 2018/06/12 S21_NA#24294 Mod Start -->
              TBL.*
              <!-- TBL.DS_IMPT_SVC_USG_PRC_PK -->
              <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            ( SELECT
                  <!-- 2018/06/12 S21_NA#24294 Mod Start -->
                    DISUP.*
                  <!--   DISUP.DS_IMPT_SVC_USG_PRC_PK -->
                  , DISP.MDL_ID
                  <!-- , DISUP.BLLG_MTR_LB_CD -->
                  , CASE 
                        WHEN DISUP.USG_MDSE_CD IS NOT NULL   THEN '1' 
                        WHEN DISUP.REG_MTR_LB_CD IS NOT NULL THEN '1' 
                        ELSE '2' 
                    END AS SORT_NUM
                  , POSN_NUM.DS_ORD_POSN_NUM
                  <!-- , DISUP.USG_MDSE_CD -->
                  <!-- , DISUP.REG_MTR_LB_CD -->
                  <!-- , DISUP.PRC_SVC_TIER_TP_CD -->
                  <!-- 2018/06/12 S21_NA#24294 Mod End -->
              FROM
                    DS_IMPT_SVC_USG_PRC DISUP
                  , ( SELECT
                            DIOD.DS_ORD_POSN_NUM
                          , DISCR.DS_IMPT_SVC_PRC_PK
                          , DISCR.GLBL_CMPY_CD
                          , DISCR.EZCANCELFLAG 
                      FROM
                            DS_IMPT_SVC_PRC DISP2
                          , DS_IMPT_SVC_CONFIG_REF DISCR
                          , DS_IMPT_ORD_DTL DIOD 
                      WHERE
                          DISP2.GLBL_CMPY_CD                  = #glblCmpyCd# 
                          AND DISP2.EZCANCELFLAG              = '0' 
                          AND DISP2.GLBL_CMPY_CD              = DISCR.GLBL_CMPY_CD 
                          AND DISP2.EZCANCELFLAG              = DISCR.EZCANCELFLAG 
                          AND DISP2.DS_IMPT_SVC_CONFIG_REF_PK = DISCR.DS_IMPT_SVC_CONFIG_REF_PK 
                          AND DISCR.GLBL_CMPY_CD              = DIOD.GLBL_CMPY_CD 
                          AND DISCR.EZCANCELFLAG              = DIOD.EZCANCELFLAG 
                          AND DISCR.DS_IMPT_ORD_DTL_PK        = DIOD.DS_IMPT_ORD_DTL_PK
                          <!-- 2018/01/23 QC#18798 Add Start -->
                          <isNotNull property="dsImptOrdDtlPkList">
                          AND DIOD.DS_IMPT_ORD_DTL_PK IN
                          <iterate property="dsImptOrdDtlPkList" var="dsImptOrdDtlPk[]" open="(" close=")" conjunction=",">
                              #dsImptOrdDtlPk[]#
                          </iterate>
                          </isNotNull>
                          <!-- 2018/01/23 QC#18798 Add End -->
                    ) POSN_NUM
                  , DS_IMPT_SVC_PRC DISP 
              WHERE
                      DISUP.EZCANCELFLAG       = '0' 
                  AND DISUP.GLBL_CMPY_CD       = #glblCmpyCd# 
                  AND DISUP.DS_IMPT_SVC_DTL_PK = #dsImptSvcDtlPk# 
                  AND DISUP.GLBL_CMPY_CD       = POSN_NUM.GLBL_CMPY_CD(+) 
                  AND DISUP.EZCANCELFLAG       = POSN_NUM.EZCANCELFLAG(+) 
                  AND DISUP.DS_IMPT_SVC_PRC_PK = POSN_NUM.DS_IMPT_SVC_PRC_PK(+) 
                  AND DISUP.GLBL_CMPY_CD       = DISP.GLBL_CMPY_CD 
                  AND DISUP.EZCANCELFLAG       = DISP.EZCANCELFLAG 
                  AND DISUP.DS_IMPT_SVC_PRC_PK = DISP.DS_IMPT_SVC_PRC_PK 
              ORDER BY
                    DISP.MDL_ID
                  , DISUP.BLLG_MTR_LB_CD
                  , SORT_NUM
                  , POSN_NUM.DS_ORD_POSN_NUM NULLS FIRST
                  , DISUP.USG_MDSE_CD NULLS LAST
                  , DISUP.PRC_SVC_TIER_TP_CD
            ) TBL

    </statement>
    <!-- Mod End 2017/06/23 QC#19444 -->


    <statement id="getDsImptSvcAddlBase" parameterClass="Map" resultClass="Map"><!-- 2018/06/12 S21_NA#24294 Mod resultClass BigDecimal to Map -->
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DISAB.*
            <!-- DISAB.DS_IMPT_SVC_ADDL_BASE_PK                  Primary key of the entity -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_SVC_ADDL_BASE DISAB      -- Direct Sales Import Service Additional Base
        WHERE
            DISAB.EZCANCELFLAG       = '0'
            AND DISAB.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DISAB.DS_IMPT_SVC_DTL_PK = #dsImptSvcDtlPk#
            <!-- 2018/01/23 QC#18798 Add Start -->
            <isNotNull property="dsImptOrdDtlPkList">
            AND DISAB.DS_IMPT_ORD_DTL_PK IN
            <iterate property="dsImptOrdDtlPkList" var="dsImptOrdDtlPk[]" open="(" close=")" conjunction=",">
                #dsImptOrdDtlPk[]#
            </iterate>
            </isNotNull>
            <!-- 2018/01/23 QC#18798 Add End -->
            
            <!-- 2022/12/20 QC#60717 Add Start -->
            <isNotNull property="dsImptOrdDtlPk">
            AND DISAB.DS_IMPT_ORD_DTL_PK = #dsImptOrdDtlPk#
            </isNotNull>
            <!-- 2022/12/20 QC#60717 Add End -->
            
    </statement>
    
    <!-- 2022/12/20 QC#60717 Add Start -->
    <statement id="getDsImptOrdDtl" parameterClass="Map" resultClass="Map">
        SELECT
            DTL1.DS_IMPT_ORD_DTL_PK
        FROM 
            DS_IMPT_ORD_DTL DTL1
           ,DS_IMPT_ORD_DTL DTL2
        WHERE 
              DTL1.EZCANCELFLAG        = '0'
          AND DTL2.EZCANCELFLAG        = '0'
          AND DTL2.GLBL_CMPY_CD        = #glblCmpyCd#
          AND DTL2.GLBL_CMPY_CD        = #glblCmpyCd#
          AND DTL1.DS_ORD_POSN_NUM     = DTL2.DS_ORD_POSN_NUM
          AND DTL1.DS_IMPT_ORD_PK      = DTL2.DS_IMPT_ORD_PK
          AND DTL2.DS_IMPT_ORD_PK      = #dsImptOrdPk#
          AND DTL2.DS_IMPT_ORD_DTL_PK  = #dsImptOrdDtlPk#
          AND DTL1.DS_IMPT_ORD_PK      = #dsImptOrdPk#
       ORDER BY DTL1.DS_IMPT_ORD_DTL_PK
    </statement>
    <!-- 2022/12/20 QC#60717 Add End -->

    <statement id="getDsImptSvcAddlChrg" parameterClass="Map" resultClass="Map"><!-- 2018/06/12 S21_NA#24294 Mod resultClass BigDecimal to Map -->
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DISAC.*
            <!-- DISAC.DS_IMPT_SVC_ADDL_CHRG_PK                  Primary key of the entity -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_SVC_ADDL_CHRG DISAC      -- Direct Sales Import Service Additional Charge
        WHERE
            DISAC.EZCANCELFLAG       = '0'
            AND DISAC.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DISAC.DS_IMPT_SVC_DTL_PK = #dsImptSvcDtlPk#
            <!-- 2018/01/23 QC#18798 Add Start -->
            <isNotNull property="dsImptOrdDtlPkList">
            AND DISAC.DS_IMPT_ORD_DTL_PK IN
            <iterate property="dsImptOrdDtlPkList" var="dsImptOrdDtlPk[]" open="(" close=")" conjunction=",">
                #dsImptOrdDtlPk[]#
            </iterate>
            </isNotNull>
            <!-- 2018/01/23 QC#18798 Add End -->
    </statement>

    <statement id="getDsImptOrdSlsCr" parameterClass="Map" resultClass="Map">
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DIOSC.*
            <!--  DIOSC.DS_IMPT_ORD_SLS_CR_PK                     Direct Sales CPO Sales Credit Primary Key -->
            <!-- ,DIOSC.DS_IMPT_ORD_CONFIG_PK                     DS CPO Config Primary Key -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_ORD_SLS_CR   DIOSC      -- Direct Sales Import Order Sales Credit
            ,DS_IMPT_ORD_CONFIG   DIOC      -- Direct Sales Import Order Configuration Inforamtion
        WHERE
            DIOSC.EZCANCELFLAG       = '0'
            AND DIOSC.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIOSC.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIOSC.EZCANCELFLAG   = DIOC.EZCANCELFLAG(+)
            AND DIOSC.GLBL_CMPY_CD   = DIOC.GLBL_CMPY_CD(+)
            AND DIOSC.DS_IMPT_ORD_CONFIG_PK = DIOC.DS_IMPT_ORD_CONFIG_PK(+)

            <!-- 2017/03/16 S21_NA#18064 Mod Start -->
            <isEqual property="isLoanConversionFlg" compareValue="Y">
                AND DIOC.DS_IMPT_ORD_CONFIG_PK IN
                <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                    #dsImptOrdConfigPk[]#
                </iterate>
            </isEqual>
            <!-- 2017/03/16 S21_NA#18064 Mod End -->

        ORDER BY
            DIOSC.DS_IMPT_ORD_CONFIG_PK
    </statement>

    <statement id="getDsImptOrdDelyInfo" parameterClass="Map" resultClass="Map">
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DIODI.*
            <!--  DIODI.DS_IMPT_ORD_DELY_INFO_PK                  CPO Install Information PK -->
            <!-- ,DIODI.DS_IMPT_ORD_CONFIG_PK                     DS CPO Config Primary Key -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_ORD_DELY_INFO DIODI      -- Direct Sales Import Order Delivery Information
            ,DS_IMPT_ORD_CONFIG   DIOC       -- Direct Sales Import Order Configuration Inforamtion
        WHERE
            DIODI.EZCANCELFLAG       = '0'
            AND DIODI.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIODI.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIODI.EZCANCELFLAG   = DIOC.EZCANCELFLAG(+)
            AND DIODI.GLBL_CMPY_CD   = DIOC.GLBL_CMPY_CD(+)
            AND DIODI.DS_IMPT_ORD_CONFIG_PK = DIOC.DS_IMPT_ORD_CONFIG_PK(+)
            AND (
                DIOC.DS_IMPT_ORD_CONFIG_PK IN
                <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                    #dsImptOrdConfigPk[]#
                </iterate>
                OR DIOC.DS_IMPT_ORD_CONFIG_PK IS NULL
                )
        ORDER BY
            DIODI.DS_IMPT_ORD_CONFIG_PK NULLS FIRST
    </statement>

    <statement id="getDsImptOrdSiteSrvy" parameterClass="Map" resultClass="Map">
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DIOSS.*
            <!--  DIOSS.DS_IMPT_ORD_SITE_SRVY_PK                  Direct Sales Site Survey Primary Key -->
            <!-- ,DIOSS.DS_IMPT_ORD_CONFIG_PK                     DS CPO Config Primary Key -->
            <!-- 2018/06/12 S21_NA#24294 Mod End -->
        FROM
            DS_IMPT_ORD_SITE_SRVY DIOSS      -- Direct Sales Import Order Site Survey
            ,DS_IMPT_ORD_CONFIG   DIOC       -- Direct Sales Import Order Configuration Inforamtion
        WHERE
            DIOSS.EZCANCELFLAG       = '0'
            AND DIOSS.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIOSS.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIOSS.EZCANCELFLAG   = DIOC.EZCANCELFLAG(+)
            AND DIOSS.GLBL_CMPY_CD   = DIOC.GLBL_CMPY_CD(+)
            AND DIOSS.DS_IMPT_ORD_CONFIG_PK = DIOC.DS_IMPT_ORD_CONFIG_PK(+)
            AND (
                DIOC.DS_IMPT_ORD_CONFIG_PK IN
                <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                    #dsImptOrdConfigPk[]#
                </iterate>
                OR DIOC.DS_IMPT_ORD_CONFIG_PK IS NULL
                )
        ORDER BY
            DIOSS.DS_IMPT_ORD_CONFIG_PK NULLS FIRST
    </statement>

    <!-- Add Start 2017/08/01 QC#20000 -->
    <statement id="getDcRmaConfigDsImptOrdSiteSrvy" parameterClass="Map" resultClass="Map">
        SELECT
             DIOC.DS_IMPT_ORD_CONFIG_PK       -- DS CPO Config Primary Key
             ,DIOSS.DS_IMPT_ORD_SITE_SRVY_PK  -- Direct Sales Site Survey Primary Key
             ,DIOC.SHIP_TO_CUST_LOC_CD        -- Ship To Customer Location Code <!-- 2017/08/15 S21_NA#20000-2 Add -->
        FROM
            DS_IMPT_ORD_CONFIG     DIOC       -- Direct Sales Import Order Configuration Information
            ,DS_MDL                DM         -- Direct Sales Model
            ,DS_IMPT_ORD_SITE_SRVY DIOSS      -- Direct Sales Import Order Site Survey
        WHERE
            DIOC.EZCANCELFLAG        = '0'
            AND DIOC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND DIOC.DS_IMPT_ORD_PK  = #dsImptOrdPk#
            AND DIOC.CONFIG_CATG_CD  = #configCatg#
            AND DIOC.EZCANCELFLAG    = DM.EZCANCELFLAG
            AND DIOC.GLBL_CMPY_CD    = DM.GLBL_CMPY_CD
            AND DIOC.MDL_ID          = DM.MDL_ID
            AND DM.SITE_SRVY_REQ_FLG = 'Y'
            AND DIOC.EZCANCELFLAG    = DIOSS.EZCANCELFLAG(+)
            AND DIOC.GLBL_CMPY_CD    = DIOSS.GLBL_CMPY_CD(+)
            AND DIOC.DS_IMPT_ORD_CONFIG_PK = DIOSS.DS_IMPT_ORD_CONFIG_PK(+)
            AND (
                DIOC.DS_IMPT_ORD_CONFIG_PK IN
                <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                    #dsImptOrdConfigPk[]#
                </iterate>
                OR DIOC.DS_IMPT_ORD_CONFIG_PK IS NULL
                )
        ORDER BY
            DIOC.DS_IMPT_ORD_CONFIG_PK NULLS FIRST
    </statement>

    <statement id="getOrdSiteSrvyDataForDcRma" parameterClass="Map" resultClass="Map">
        SELECT
            CMPY_INFO_APT_BLDG_NM
            ,CMPY_INFO_FL_NM
            ,CMPY_INFO_DEPT_NM
            ,OTSD_STEP_NUM
            ,INSD_STEP_NUM
            ,STAIR_CRAW_REQ_FLG
            ,FLGT_STAIR_NUM
            ,ELEV_AVAL_FLG
            ,ELEV_AVAL_FROM_HOUR_MN
            ,ELEV_AVAL_TO_HOUR_MN
            ,ELEV_APPT_REQ_FLG
            ,ELEV_CTAC_TEL_NUM
            ,ELEV_PROT_REQ_FLG
            ,ELEV_WDT
            ,ELEV_DEPTH_NUM
            ,ELEV_CTAC_PSN_NM
            ,ELEV_CAP_WT
            ,ELEV_DOOR_HGT
            ,ELEV_DOOR_WDT
            ,STAIR_AND_LDG_WDT
            ,CRDR_WDT
            ,DOOR_WDT
            ,LOAD_DOCK_AVAL_FLG
            ,LOAD_DOCK_HGT
            ,TRCTR_AND_TRAIL_ACCS_FLG
            ,BLDG_ENT_DOOR_HGT
            ,BLDG_ENT_DOOR_WDT
            ,LOAD_DOCK_AVAL_FROM_HOUR_MN
            ,LOAD_DOCK_AVAL_TO_HOUR_MN
            ,CARR_DELY_TM_HOUR_MN
            ,DELY_TRNSP_OPT_CD
            ,SITE_SRVY_ADDL_CMNT_TXT
        FROM
            (SELECT
                DSS.CMPY_INFO_APT_BLDG_NM
                ,DSS.CMPY_INFO_FL_NM
                ,DSS.CMPY_INFO_DEPT_NM
                ,DSS.OTSD_STEP_NUM
                ,DSS.INSD_STEP_NUM
                ,DSS.STAIR_CRAW_REQ_FLG
                ,DSS.FLGT_STAIR_NUM
                ,DSS.ELEV_AVAL_FLG
                ,DSS.ELEV_AVAL_FROM_HOUR_MN
                ,DSS.ELEV_AVAL_TO_HOUR_MN
                ,DSS.ELEV_APPT_REQ_FLG
                ,DSS.ELEV_CTAC_TEL_NUM
                ,DSS.ELEV_PROT_REQ_FLG
                ,DSS.ELEV_WDT
                ,DSS.ELEV_DEPTH_NUM
                ,DSS.ELEV_CTAC_PSN_NM
                ,DSS.ELEV_CAP_WT
                ,DSS.ELEV_DOOR_HGT
                ,DSS.ELEV_DOOR_WDT
                ,DSS.STAIR_AND_LDG_WDT
                ,DSS.CRDR_WDT
                ,DSS.DOOR_WDT
                ,DSS.LOAD_DOCK_AVAL_FLG
                ,DSS.LOAD_DOCK_HGT
                ,DSS.TRCTR_AND_TRAIL_ACCS_FLG
                ,DSS.BLDG_ENT_DOOR_HGT
                ,DSS.BLDG_ENT_DOOR_WDT
                ,DSS.LOAD_DOCK_AVAL_FROM_HOUR_MN
                ,DSS.LOAD_DOCK_AVAL_TO_HOUR_MN
                ,DSS.CARR_DELY_TM_HOUR_MN
                ,DSS.DELY_TRNSP_OPT_CD
                ,DSS.SITE_SRVY_ADDL_CMNT_TXT
                ,CPO.CPO_ORD_NUM
                ,DCC.DS_CPO_CONFIG_PK
            FROM
                DS_IMPT_ORD_CONFIG DIOC
                ,DS_CPO_CONFIG     DCC
                ,CPO               CPO
                ,DS_SITE_SRVY      DSS
            WHERE
                DIOC.GLBL_CMPY_CD = #glblCmpyCd#
            AND DIOC.DS_IMPT_ORD_CONFIG_PK = #dsImptOrdConfigPk#
            AND DIOC.EZCANCELFLAG = '0'
            AND DIOC.GLBL_CMPY_CD = DCC.GLBL_CMPY_CD
            AND DIOC.SHIP_TO_CUST_LOC_CD = DCC.SHIP_TO_CUST_LOC_CD
            <isEqual property="withMdlFlg" compareValue="Y">
                AND DIOC.MDL_ID   = DCC.MDL_ID
            </isEqual>
            AND DCC.EZCANCELFLAG  = '0'
            AND DCC.GLBL_CMPY_CD  = DSS.GLBL_CMPY_CD
            AND DCC.CPO_ORD_NUM   = DSS.CPO_ORD_NUM
            AND DCC.DS_CPO_CONFIG_PK = DSS.DS_CPO_CONFIG_PK
            AND DSS.EZCANCELFLAG  = '0'
            AND DCC.GLBL_CMPY_CD  = CPO.GLBL_CMPY_CD
            AND DCC.CPO_ORD_NUM   = CPO.CPO_ORD_NUM
            AND CPO.ORD_HDR_STS_CD NOT IN (#ordHdrStsSaved#, #ordHdrStsCancelled#)
            AND CPO.EZCANCELFLAG  = '0'
            ORDER BY
                CPO.ORD_BOOK_TS DESC
                ,DCC.DS_ORD_POSN_NUM
            )
        WHERE
            ROWNUM        &lt; 2
    </statement>
    <!-- Add End 2017/08/01 QC#20000 -->

    <statement id="getDsImptOrdIstlInfo" parameterClass="Map" resultClass="Map">
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DIOII.*
            <!--  DIOII.DS_IMPT_ORD_ISTL_INFO_PK                  DS Import Order Install Information PK -->
            <!-- ,DIOII.DS_IMPT_ORD_CONFIG_PK                     DS CPO Config Primary Key -->
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
        FROM
            DS_IMPT_ORD_ISTL_INFO DIOII      -- Direct Sales Import Order Install Information
            ,DS_IMPT_ORD_CONFIG   DIOC       -- Direct Sales Import Order Configuration Inforamtion
        WHERE
            DIOII.EZCANCELFLAG       = '0'
            AND DIOII.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIOII.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIOII.EZCANCELFLAG   = DIOC.EZCANCELFLAG(+)
            AND DIOII.GLBL_CMPY_CD   = DIOC.GLBL_CMPY_CD(+)
            AND DIOII.DS_IMPT_ORD_CONFIG_PK = DIOC.DS_IMPT_ORD_CONFIG_PK(+)
            AND (
                DIOC.DS_IMPT_ORD_CONFIG_PK IN
                <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                    #dsImptOrdConfigPk[]#
                </iterate>
                OR DIOC.DS_IMPT_ORD_CONFIG_PK IS NULL
                )
        ORDER BY
            DIOII.DS_IMPT_ORD_CONFIG_PK NULLS FIRST
    </statement>

    <statement id="getDsImptOrdCtacPsn" parameterClass="Map" resultClass="Map">
        SELECT
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
            DIOCP.*
            <!--  DIOCP.DS_IMPT_ORD_CTAC_PSN_PK                   Contact Person Primary Key -->
            <!-- ,DIOCP.DS_IMPT_ORD_CONFIG_PK                     DS CPO Config Primary Key -->
            <!-- 2018/06/12 S21_NA#24294 Mod Start -->
        FROM
            DS_IMPT_ORD_CTAC_PSN DIOCP       -- Direct Sales Import Order Contact Person
            ,DS_IMPT_ORD_CONFIG   DIOC       -- Direct Sales Import Order Configuration Information
        WHERE
            DIOCP.EZCANCELFLAG       = '0'
            AND DIOCP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIOCP.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIOCP.EZCANCELFLAG   = DIOC.EZCANCELFLAG(+)
            AND DIOCP.GLBL_CMPY_CD   = DIOC.GLBL_CMPY_CD(+)
            AND DIOCP.DS_IMPT_ORD_CONFIG_PK = DIOC.DS_IMPT_ORD_CONFIG_PK(+)

            <!-- 2017/03/16 S21_NA#18064 Mod Start -->
            <isEqual property="isLoanConversionFlg" compareValue="Y">
                AND DIOC.DS_IMPT_ORD_CONFIG_PK IN
                <iterate property="dsImptOrdConfigPkList" var="dsImptOrdConfigPk[]" open="(" close=")" conjunction=",">
                    #dsImptOrdConfigPk[]#
                </iterate>
            </isEqual>
            <!-- 2017/03/16 S21_NA#18064 Mod End -->

        ORDER BY
            <!-- Mod Start 2017/07/04 QC#19692 -->
            <!-- DIOCP.DS_IMPT_ORD_CONFIG_PK NULLS FIRST -->
            DIOCP.DS_IMPT_ORD_CONFIG_PK
            <!-- Mod End 2017/07/04 QC#19692 -->
    </statement>

    <statement id="getShipInfo" parameterClass="Map" resultClass="Map">
        SELECT
                STC.SHIP_TO_CUST_CD
               ,STC.LOC_NM
               ,STC.ADDL_LOC_NM
               ,STC.FIRST_LINE_ADDR
               ,STC.SCD_LINE_ADDR
               ,STC.THIRD_LINE_ADDR
               ,STC.FRTH_LINE_ADDR
               ,STC.FIRST_REF_CMNT_TXT
               ,STC.SCD_REF_CMNT_TXT
               ,STC.CTY_ADDR
               ,STC.ST_CD
               ,STC.POST_CD
               ,STC.PROV_NM
               ,STC.CTRY_CD
               ,C.CNTY_NM
               ,STC.SELL_TO_CUST_CD
               ,STC.LOC_NUM
        FROM
                SHIP_TO_CUST STC
               ,CNTY         C
        WHERE
                STC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND STC.EZCANCELFLAG        = '0'
            AND STC.SHIP_TO_CUST_CD     = #shipToCustCd#
            AND STC.RGTN_STS_CD         = #rgtnStsCd#
            AND STC.GLBL_CMPY_CD        = C.GLBL_CMPY_CD(+)
            AND STC.EZCANCELFLAG        = C.EZCANCELFLAG(+)
            AND STC.CNTY_PK             = C.CNTY_PK(+)
    </statement>

    <!--  Add Start 2017/09/14 QC#20841 -->
    <statement id="getCtacCustRefTpCd" parameterClass="Map" resultClass="String">
        SELECT
            CT.CTAC_CUST_REF_TP_CD
        FROM
            CTAC_TP CT
        WHERE
                CT.GLBL_CMPY_CD = #glblCmpyCd#
            AND CT.CTAC_TP_CD   = #ctacPsnTpCd#
            AND CT.EZCANCELFLAG = '0'
    </statement>
    <!--  Add End 2017/09/14 QC#20841 -->

    <statement id="getEdiAttrb" parameterClass="Map" resultClass="Map">
        SELECT
            DIEA.DS_IMPT_ORD_PK                           -- Direct Sales Import Order PK
            ,DIDEA.DS_IMPT_ORD_DTL_PK                     -- Direct Sales Import Order Detail PK
            ,DETP.DS_EDI_TRD_PTNR_REF_CD                  -- Direct Sales EDI Trading Partner Reference Code
            ,DETP.SEND_PO_ACK_FLG                         -- Send PO Acknowledgement Flag
            ,DETP.PO_INBD_INTFC_ID                        -- PO Inbound Interface ID
        FROM
            DS_IMPT_EXT_ATTRB    DIEA       -- Direct Sales Import Extend Attribute
            ,DS_IMPT_DTL_EXT_ATTRB DIDEA    -- Direct Sales Import Detail Extend Attribute
            ,DS_EDI_TRD_PTNR      DETP      -- Direct Sales EDI Trading Partner
        WHERE
            DIEA.EZCANCELFLAG       = '0'
            AND DIEA.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIEA.EZCANCELFLAG   = DIDEA.EZCANCELFLAG
            AND DIEA.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIEA.GLBL_CMPY_CD   = DIDEA.GLBL_CMPY_CD
            AND DIEA.DS_IMPT_ORD_PK = DIDEA.DS_IMPT_ORD_PK
            AND DIEA.EZCANCELFLAG   = DETP.EZCANCELFLAG
            AND DIEA.GLBL_CMPY_CD   = DETP.GLBL_CMPY_CD
            AND DIEA.EDI_TRD_PTNR_CD = DETP.DS_EDI_TRD_PTNR_CD
    </statement>

    <statement id="getCpoDtlForEdiAck" parameterClass="Map" resultClass="Map">
        SELECT
             CD.ORD_SRC_REF_LINE_NUM                     -- Order Source Reference Line Number
            ,CD.ORD_SRC_REF_LINE_SUB_NUM                 -- Order Source Reference Sub Line Number
            ,CD.CPO_ORD_NUM                              -- CPO Order Number,Data Examples
            ,CD.CPO_DTL_LINE_NUM                         -- CPO Detail Line Number,Data Examples
            ,CD.CPO_DTL_LINE_SUB_NUM                     -- CPO Detail Line Sub Number,Data Examples
            ,CD.ORD_LINE_STS_CD                          -- Order Line Status Code,Not to be used
            ,CD.ORD_QTY                                  -- Order Quantity,Data Examples
            ,CD.ORD_CUST_UOM_QTY                         -- Ordered Customer UOM Quantity,Data examples
            ,CD.ENT_DEAL_NET_UNIT_PRC_AMT                -- Enter Deal Net Unit Price Amount,Data examples
            ,CD.ENT_CPO_DTL_DEAL_NET_AMT                 -- Enter CPO Detail Deal Net Amount,Data examples
            ,CD.ENT_CPO_DTL_DEAL_SLS_AMT                 -- Enter CPO Detail Deal Sales Amount,Data examples
            ,CD.UNIT_NET_WT                              -- Unit Net Weight
            ,CD.CCY_CD                                   -- Attribute definition, Data examples
            ,CD.RTL_WH_CD                                -- Retail Warehouse Code
            ,CD.RTL_SWH_CD                               -- Retail Sub Warehouse Code
            ,CD.CUST_UOM_CD                              -- Customer UOM Code,Data Examples
            ,CD.MDSE_CD                                  -- Attribute definition, Data examples
            ,CD.CUST_MDSE_CD                             -- Customer Merchandise Code,Data Examples
            ,CD.EXCH_RATE                                -- Attribute Definition,Example Data
        FROM
            CPO_DTL              CD          -- Entity Definition
        WHERE
            CD.EZCANCELFLAG       = '0'
            AND CD.GLBL_CMPY_CD   = #glblCmpyCd#
            AND CD.CPO_ORD_NUM    = #cpoOrdNum#
        ORDER BY
            CD.CPO_DTL_LINE_NUM, CD.CPO_DTL_LINE_SUB_NUM
    </statement>

    <statement id="getSpngPlnForEdiAck" parameterClass="Map" resultClass="Map">
        SELECT
             SP.SHPG_PLN_NUM                             -- Number which manages every Shipping Plan transaction, Data examples
            ,SP.TRX_HDR_NUM                              -- Transaction Header Number,Data examples
            ,SP.TRX_LINE_NUM                             -- Transaction Line Number,Data examples
            ,SP.TRX_LINE_SUB_NUM                         -- Transaction Line Sub Number,Data examples
            ,SP.SHPG_STS_CD                              -- Shipping Status Code,Not to be used
            ,SP.SP_DEAL_UNIT_PRC_AMT                     -- Shipping Plan Deal Unit Price Amount,Data examples
            ,SP.ORD_QTY                                  -- Order Quantity,Data examples
            ,SP.RDD_DT                                   -- RDD Date,Data Examples
            ,SP.PDD_DT                                   -- PDD Date,Data Examples
        FROM
            SHPG_PLN             SP         -- Shipping Plans based upon Distribution(OM)/Allocation(OM) and the Customer Order(OM) information.
        WHERE
            SP.EZCANCELFLAG       = '0'
            AND SP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND SP.TRX_HDR_NUM    = #trxHdrNum#
        ORDER BY
            SP.TRX_LINE_NUM, SP.TRX_LINE_SUB_NUM
    </statement>

    <statement id="getEdiPoAckHdrForEdiAck" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             EPAH.EDI_PO_ACK_HDR_PK                        -- EDI PO ACK Header Primary Key
        FROM
            EDI_PO_ACK_HDR       EPAH       -- EDI PO ACK Header
        WHERE
            EPAH.EZCANCELFLAG         = '0'
            AND EPAH.GLBL_CMPY_CD     = #glblCmpyCd#
            AND  EPAH.ORD_SRC_REF_NUM = #ordSrcRefNum#
    </statement>

    <statement id="getDefCtry" parameterClass="Map" resultClass="String">
        SELECT 
            C.CTRY_CD 
        FROM
            CTRY C
        WHERE
            C.EZCANCELFLAG       = '0'
            AND C.GLBL_CMPY_CD   = #glblCmpyCd#
            AND C.CTRY_DEF_FLG   = 'Y'
    </statement>

    <statement id="getDelyAddlCmnt" parameterClass="Map" resultClass="String">
        SELECT
            DCDI.DELY_ADDL_CMNT_TXT
        FROM
            DS_CPO_DELY_INFO DCDI
        WHERE
                DCDI.EZCANCELFLAG = '0'
            AND DCDI.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCDI.CPO_ORD_NUM  = #cpoOrdNum#
            AND ROWNUM            = 1
    </statement>

    <statement id="getScheduleTemplateList" parameterClass="Map" resultClass="Map">
        SELECT
             DIST.DS_IMPT_SCHD_TMPL_PK
            ,DCD.DS_CONTR_PK
            ,DCD.DS_CONTR_DTL_PK
            ,DISD.DS_IMPT_SVC_LINE_NUM
            ,C.CPO_ORD_NUM
            ,C.CPO_SRC_TP_CD
            ,C.ORD_SRC_REF_NUM
            ,DIST.DS_ORD_TP_CD
            ,DIST.SYS_SRC_REF_NUM
            ,DIST.SYS_SRC_CD
            ,DIST.SPLY_AGMT_DOC_TP_CD <!-- QC#15197 add -->
            ,DIST.QTY_CONTR_CAP_QTY
            ,DIST.SPLY_BASE_AMT
        FROM
             DS_IMPT_ORD       DIO
            ,CPO               C
            ,DS_IMPT_SCHD_TMPL DIST
            ,DS_IMPT_SVC_DTL   DISD
            ,DS_CONTR_DTL      DCD
        WHERE
                DIO.EZCANCELFLAG          = '0'
            AND DIO.GLBL_CMPY_CD          = #glblCmpyCd#
            AND DIO.DS_IMPT_ORD_PK        = #dsImptOrdPk#
            AND DIO.ORD_SRC_REF_NUM       = #ordSrcRefNum#
            AND DIO.EZCANCELFLAG          = C.EZCANCELFLAG
            AND DIO.GLBL_CMPY_CD          = C.GLBL_CMPY_CD
            AND DIO.ORD_SRC_REF_NUM       = C.ORD_SRC_REF_NUM
            AND C.CPO_ORD_NUM             = #cpoOrdNum#
            AND DIO.EZCANCELFLAG          = DIST.EZCANCELFLAG
            AND DIO.GLBL_CMPY_CD          = DIST.GLBL_CMPY_CD
            AND DIO.ORD_SRC_REF_NUM       = DIST.SYS_SRC_REF_NUM
            AND DIST.EZCANCELFLAG         = DISD.EZCANCELFLAG
            AND DIST.GLBL_CMPY_CD         = DISD.GLBL_CMPY_CD
            AND DIST.DS_IMPT_SVC_DTL_PK   = DISD.DS_IMPT_SVC_DTL_PK
            AND DISD.EZCANCELFLAG         = DCD.EZCANCELFLAG
            AND DISD.GLBL_CMPY_CD         = DCD.GLBL_CMPY_CD
            AND DISD.DS_IMPT_SVC_LINE_NUM = DCD.SHELL_LINE_NUM
            AND C.EZCANCELFLAG            = DCD.EZCANCELFLAG
            AND C.GLBL_CMPY_CD            = DCD.GLBL_CMPY_CD
            AND C.CPO_ORD_NUM             = DCD.CPO_ORD_NUM
            AND DCD.SVC_PRC_CATG_CD       = #svcPrcCatgCd#
            <!-- 2017/12/11 S21_NA#22221 Add Start -->
            AND EXISTS (
                SELECT
                    1
                FROM
                    DS_IMPT_SCHD_TMPL_LINE DISTL
                    ,DS_IMPT_SVC_CONFIG_REF DISCR
                    ,DS_IMPT_ORD_DTL        DIOD
                    ,CPO_DTL                CD
                WHERE
                    DIST.GLBL_CMPY_CD                   = DISTL.GLBL_CMPY_CD
                    AND DIST.DS_IMPT_SCHD_TMPL_PK       = DISTL.DS_IMPT_SCHD_TMPL_PK
                    AND DISTL.EZCANCELFLAG              = '0'
                    AND DISTL.GLBL_CMPY_CD              = DISCR.GLBL_CMPY_CD
                    AND DISTL.DS_IMPT_SVC_CONFIG_REF_PK = DISCR.DS_IMPT_SVC_CONFIG_REF_PK
                    AND DISCR.EZCANCELFLAG              = '0'
                    AND DISCR.GLBL_CMPY_CD              = DIOD.GLBL_CMPY_CD
                    AND DISCR.DS_IMPT_ORD_DTL_PK        = DIOD.DS_IMPT_ORD_DTL_PK
                    AND DIOD.EZCANCELFLAG               = '0'
                    AND DIOD.GLBL_CMPY_CD               = CD.GLBL_CMPY_CD
                    AND DIOD.ORD_SRC_REF_LINE_NUM       = CD.ORD_SRC_REF_LINE_NUM
                    AND NVL(DIOD.ORD_SRC_REF_LINE_SUB_NUM, '001')       = NVL(CD.ORD_SRC_REF_LINE_SUB_NUM, '001')
                    AND CD.EZCANCELFLAG                 = '0'
                    AND CD.GLBL_CMPY_CD                 = DCD.GLBL_CMPY_CD
                    AND CD.CPO_ORD_NUM                  = DCD.CPO_ORD_NUM
                    AND CD.CPO_DTL_LINE_NUM             = DCD.CPO_DTL_LINE_NUM
                    AND CD.CPO_DTL_LINE_SUB_NUM         = DCD.CPO_DTL_LINE_SUB_NUM
            )
            <!-- 2017/12/11 S21_NA#22221 Add End -->
        ORDER BY
            DISD.DS_IMPT_SVC_LINE_NUM
    </statement>

    <statement id="getScheduleTemplateLineList" parameterClass="Map" resultClass="Map">
        SELECT
             DCD.DS_CONTR_PK
            ,DCD.DS_CONTR_DTL_PK
            ,DISTL.SCHD_TMPL_LINE_NUM
            ,DISTL.MDSE_CD
            ,DISTL.SCHD_ALLW_QTY
            ,DISTL.SHPG_INTVL_CD
            ,DISTL.SCHD_SHPG_QTY
            ,DISTL.FIRST_SHIP_QTY
        FROM
             DS_IMPT_SCHD_TMPL_LINE DISTL
            ,DS_IMPT_SVC_CONFIG_REF DISCR
            ,DS_IMPT_ORD_DTL        DIOD
            ,CPO_DTL                CD
            ,DS_CONTR_DTL           DCD
        WHERE
                DISTL.EZCANCELFLAG              = '0'
            AND DISTL.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DISTL.DS_IMPT_SCHD_TMPL_PK      = #dsImptSchdTmplPk#
            AND DISTL.EZCANCELFLAG              = DISCR.EZCANCELFLAG
            AND DISTL.GLBL_CMPY_CD              = DISCR.GLBL_CMPY_CD
            AND DISTL.DS_IMPT_SVC_CONFIG_REF_PK = DISCR.DS_IMPT_SVC_CONFIG_REF_PK
            AND DISCR.EZCANCELFLAG              = DIOD.EZCANCELFLAG
            AND DISCR.GLBL_CMPY_CD              = DIOD.GLBL_CMPY_CD
            AND DISCR.DS_IMPT_ORD_DTL_PK        = DIOD.DS_IMPT_ORD_DTL_PK
            AND DIOD.EZCANCELFLAG               = CD.EZCANCELFLAG
            AND DIOD.GLBL_CMPY_CD               = CD.GLBL_CMPY_CD
            AND DIOD.ORD_SRC_REF_LINE_NUM       = CD.ORD_SRC_REF_LINE_NUM
            AND NVL(DIOD.ORD_SRC_REF_LINE_SUB_NUM, '001')       = NVL(CD.ORD_SRC_REF_LINE_SUB_NUM, '001')
            AND CD.CPO_ORD_NUM                  = #cpoOrdNum#
            AND CD.EZCANCELFLAG                 = DCD.EZCANCELFLAG
            AND CD.GLBL_CMPY_CD                 = DCD.GLBL_CMPY_CD
            AND CD.CPO_ORD_NUM                  = DCD.CPO_ORD_NUM
            AND CD.CPO_DTL_LINE_NUM             = DCD.CPO_DTL_LINE_NUM
            AND CD.CPO_DTL_LINE_SUB_NUM         = DCD.CPO_DTL_LINE_SUB_NUM
            AND DCD.DS_CONTR_DTL_PK             = #dsContrDtlPk#
        ORDER BY
             DCD.DS_CONTR_DTL_PK
            ,DISTL.SCHD_TMPL_LINE_NUM
    </statement>

    <statement id="getDocMstCatgCd" parameterClass="Map" resultClass="String">
        SELECT
             DMC.DOC_MGT_CATG_CD
        FROM
            DOC_MGT_CATG         DMC
        WHERE
            DMC.EZCANCELFLAG       = '0'
            AND DMC.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DMC.DOC_MGT_CATG_NUM = #docMgtCatgNum#
    </statement>

    <statement id="getItrlOrdProcFlg" parameterClass="Map" resultClass="String">
          SELECT 
                 PT.ITRL_ORD_PROC_FLG
          FROM  
                 DS_ORD_TP_PROC_DFN PD
                ,ORD_PROC_TP  PT
          WHERE 
                 PD.GLBL_CMPY_CD    = #glblCmpyCd#
             AND PD.DS_ORD_TP_CD    = #dsOrdTpCd#
             AND PD.EFF_FROM_DT     &lt;= #slsDt#
             AND (
                    PD.EFF_THRU_DT       &gt;= #slsDt#
                 OR PD.EFF_THRU_DT       IS NULL
                    )
             AND PD.ACTV_FLG        = 'Y'
             AND PD.EZCANCELFLAG    = '0'

             AND PD.GLBL_CMPY_CD    = PT.GLBL_CMPY_CD
             AND PD.ORD_PROC_TP_CD  = PT.ORD_PROC_TP_CD
             AND PT.EFF_FROM_DT     &lt;= #slsDt#
             AND (
                    PT.EFF_THRU_DT       &gt;= #slsDt#
                 OR PT.EFF_THRU_DT       IS NULL
                    )
            AND PT.ACTV_FLG        = 'Y'
            AND PT.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getMaxCpoDtlLineNum" parameterClass="Map" resultClass="String">
          SELECT 
                 NVL(MAX(CD.CPO_DTL_LINE_NUM), '000')
          FROM  
                 CPO_DTL CD
          WHERE 
                 CD.GLBL_CMPY_CD    = #glblCmpyCd#
            AND  CD.CPO_ORD_NUM     = #cpoOrdNum#
            AND  CD.EZCANCELFLAG    = '0'
    </statement>

    <statement id="countOrdCatgBizCtx" parameterClass="Map" resultClass="BigDecimal">
          SELECT
              COUNT(CTX.DS_ORD_CATG_CD)
          FROM
               ORD_CATG_BIZ_CTX  CTX
              ,DS_IMPT_ORD       DIO
          WHERE
                  DIO.GLBL_CMPY_CD       = #glblCmpyCd#
              AND DIO.DS_IMPT_ORD_PK     = #dsImptOrdPk#
              AND DIO.EZCANCELFLAG       = '0'
              AND DIO.GLBL_CMPY_CD       = CTX.GLBL_CMPY_CD
              AND DIO.DS_ORD_CATG_CD     = CTX.DS_ORD_CATG_CD
              <!-- L3#384 -->
              AND (
                  DIO.DS_ORD_TP_CD       = CTX.DS_ORD_TP_CD
                  OR CTX.DS_ORD_TP_CD   IS NULL
              )
              AND (
                  DIO.DS_ORD_RSN_CD      = CTX.DS_ORD_RSN_CD
                  OR CTX.DS_ORD_RSN_CD  IS NULL
              )
              <!-- L3#384 -->
              AND CTX.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCd#
              AND CTX.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getMaxDsCpoLineNum" parameterClass="Map" resultClass="BigDecimal">
          SELECT 
                 NVL(MAX(CD.DS_CPO_LINE_NUM), 0)
          FROM  
                 CPO_DTL CD
          WHERE 
                 CD.GLBL_CMPY_CD    = #glblCmpyCd#
            AND  CD.CPO_ORD_NUM     = #cpoOrdNum#
            AND  CD.DS_ORD_POSN_NUM = #dsOrdPosnNum#
            AND  CD.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getOrigSlsCrList" parameterClass="Map" resultClass="Map">
        SELECT
                 SC.GLBL_CMPY_CD
                ,SC.DS_CPO_SLS_CR_PK
                ,SC.CPO_ORD_NUM
                ,SC.DS_ORD_POSN_NUM
                ,SC.DS_CPO_CONFIG_PK
                ,SC.SLS_REP_TOC_CD
                ,SC.SLS_REP_ROLE_TP_CD
                ,SC.SLS_REP_CR_PCT
                ,SC.COA_EXTN_CD
                ,SC.COA_BR_CD
                ,SC.COA_CC_CD
                ,SC.SLS_CR_QUOT_FLG
        FROM
                 DS_CPO_SLS_CR   SC
        WHERE
                 SC.GLBL_CMPY_CD   = #glblCmpyCd#
          AND    SC.CPO_ORD_NUM    = #cpoOrdNum#
          AND    SC.EZCANCELFLAG   = '0'
        ORDER BY
                 SC.DS_ORD_POSN_NUM  NULLS FIRST
                ,SC.DS_CPO_SLS_CR_PK NULLS FIRST
    </statement>

    <statement id="getLineValSet" parameterClass="Map" resultClass="Map">
        SELECT 
                LVS.DS_ORD_LINE_CATG_CD
              , LVS.THIRD_BIZ_CTX_ATTRB_TXT  AS RTL_WH_CD
        FROM 
                ORD_LINE_VAL_SET LVS
        WHERE 
                LVS.GLBL_CMPY_CD             = #glblCmpyCd#
            AND LVS.ORD_LINE_CTX_TP_CD       = #ordLineCtxTpCd#
            AND LVS.FIRST_BIZ_CTX_ATTRB_TXT  = #actionNm#
            AND LVS.EZCANCELFLAG             = '0'
        ORDER BY
                LVS.SCD_BIZ_CTX_ATTRB_TXT
    </statement>

    <statement id="getMdseValSet" parameterClass="Map" resultClass="String">
            SELECT 
                VAL.FIRST_BIZ_CTX_ATTRB_TXT  AS LINE_CATG_CD
        FROM 
                 MDSE_TP_VAL_SET  VAL
                ,MDSE             MDSE
        WHERE 
                MDSE.GLBL_CMPY_CD      = #glblCmpyCd#
            AND MDSE.MDSE_CD           LIKE #mdseCd#
            AND MDSE.EZCANCELFLAG      = '0'
            AND MDSE.GLBL_CMPY_CD      = VAL.GLBL_CMPY_CD
            AND MDSE.COA_MDSE_TP_CD    = VAL.COA_MDSE_TP_CD
            AND VAL.MDSE_TP_CTX_TP_CD  = #mdseTpCtxTpCd#
            AND VAL.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getConversableItems" parameterClass="Map" resultClass="Map">
        SELECT
             CDTL.MDSE_CD
            ,CDTL.CPO_DTL_LINE_NUM
            ,CDTL.CPO_DTL_LINE_SUB_NUM
            ,STSV.ORD_LINE_STS_NM
            ,CPO.CPO_HLD_FLG
            ,CDTL.ORD_LINE_STS_CD
            ,CDTL.CPO_DTL_HLD_FLG
        FROM 
             CPO            CPO
            ,CPO_DTL        CDTL
            ,DS_ORD_STS_V   STSV
            ,DS_CPO_CONFIG  CONF
            <!-- 2018/04/19 S21_NA#25444 Add Start -->
            ,SVC_MACH_MSTR  SMM
            <!-- 2018/04/19 S21_NA#25444 Add End -->
        WHERE
                CPO.GLBL_CMPY_CD           = #glblCmpyCd#
            AND CPO.CPO_ORD_NUM            = #origCpoOrdNum#
            AND CPO.ORD_HDR_STS_CD         NOT IN
            <iterate property="ordHdrStsCdList" var="ordHdrStsCd[]" open="(" close=")" conjunction=",">
                #ordHdrStsCd[]#
            </iterate>
            AND CPO.EZCANCELFLAG           = '0'
            AND CONF.GLBL_CMPY_CD          = CPO.GLBL_CMPY_CD
            AND CONF.CPO_ORD_NUM           = CPO.CPO_ORD_NUM
            AND CONF.SVC_CONFIG_MSTR_PK    = #svcConfigMstrPk#
            AND CONF.EZCANCELFLAG          = '0'
            AND CONF.GLBL_CMPY_CD          = CDTL.GLBL_CMPY_CD
            AND CONF.CPO_ORD_NUM           = CDTL.CPO_ORD_NUM
            AND CONF.DS_CPO_CONFIG_PK      = CDTL.DS_CPO_CONFIG_PK
            AND CDTL.EZCANCELFLAG          = '0'
            AND CDTL.ORD_LINE_STS_CD       NOT IN
            <iterate property="ordLineStsCdList" var="ordLineStsCd[]" open="(" close=")" conjunction=",">
                #ordLineStsCd[]#
            </iterate>
            AND CDTL.EZCANCELFLAG          = '0'
            <!-- 2018/04/19 S21_NA#25444 Add Start -->
            AND CDTL.GLBL_CMPY_CD          = SMM.GLBL_CMPY_CD(+)
            AND CDTL.SVC_CONFIG_MSTR_PK    = SMM.SVC_CONFIG_MSTR_PK(+)
            AND CDTL.CPO_ORD_NUM           = SMM.CPO_ORD_NUM(+)
            AND CDTL.CPO_DTL_LINE_NUM      = SMM.CPO_DTL_LINE_NUM(+)
            AND CDTL.CPO_DTL_LINE_SUB_NUM  = SMM.CPO_DTL_LINE_SUB_NUM(+)
            AND SMM.EZCANCELFLAG(+)        = '0'
            <!-- 2018/04/19 S21_NA#25444 Add End -->
            AND CDTL.GLBL_CMPY_CD          = STSV.GLBL_CMPY_CD
			AND CDTL.CPO_ORD_NUM           = STSV.CPO_ORD_NUM
			AND CDTL.CPO_DTL_LINE_NUM      = STSV.CPO_DTL_LINE_NUM
			AND CDTL.CPO_DTL_LINE_SUB_NUM  = STSV.CPO_DTL_LINE_SUB_NUM
			<isEqual property="isSearchCondOnLoanFlg" compareValue="Y">
			AND STSV.ORD_LINE_STS_NM       IN
				<iterate property="ordLineStsNmList" var="ordLineStsNm[]" open="(" close=")" conjunction=",">
					#ordLineStsNm[]#
				</iterate>
			</isEqual>
			<isNotEqual property="isSearchCondOnLoanFlg" compareValue="Y">
			AND STSV.ORD_LINE_STS_NM       NOT IN
				<iterate property="ordLineStsNmList" var="ordLineStsNm[]" open="(" close=")" conjunction=",">
					#ordLineStsNm[]#
				</iterate>
			</isNotEqual>
			AND STSV.EZCANCELFLAG          = '0'
            AND NOT EXISTS
                (SELECT 
                    1
                FROM
                    DS_CPO_RTRN_DTL RDTL
                WHERE 
                        CDTL.GLBL_CMPY_CD          = RDTL.GLBL_CMPY_CD
                    AND CDTL.CPO_ORD_NUM           = RDTL.ORIG_CPO_ORD_NUM
                    AND CDTL.CPO_DTL_LINE_NUM      = RDTL.ORIG_CPO_DTL_LINE_NUM
                    AND CDTL.CPO_DTL_LINE_SUB_NUM  = RDTL.ORIG_CPO_DTL_LINE_SUB_NUM
                    AND SMM.SVC_MACH_MSTR_PK       = RDTL.SVC_MACH_MSTR_PK
                    AND RDTL.RTRN_LINE_STS_CD      NOT IN
                    <iterate property="rtrnLineStsCdList" var="rtrnLineStsCd[]" open="(" close=")" conjunction=",">
                        #rtrnLineStsCd[]#
                    </iterate>
                    AND RDTL.EZCANCELFLAG          = '0' 
                )
            AND NOT EXISTS
                (SELECT
                    1     
                FROM
                     DS_CPO_CONFIG  CONF
                    ,CPO_DTL        CDTL
                WHERE
                        CONF.GLBL_CMPY_CD          = #glblCmpyCd#
                    AND CONF.SVC_CONFIG_MSTR_PK    = #svcConfigMstrPk#
                    AND CONF.EZCANCELFLAG          = '0'
                    AND CONF.GLBL_CMPY_CD          = CDTL.GLBL_CMPY_CD
                    AND CONF.DS_CPO_CONFIG_PK      = CDTL.DS_CPO_CONFIG_PK
                    AND CDTL.EZCANCELFLAG          = '0'
                    AND CDTL.ORIG_CPO_ORD_NUM      = #origCpoOrdNum#
                    AND CDTL.EZCANCELFLAG          = '0'
                    <!-- 2017/12/15 S21_NA#22882 Add Start -->
                    AND CDTL.ORD_LINE_STS_CD       NOT IN
                    <iterate property="ordLineStsCdList" var="ordLineStsCd[]" open="(" close=")" conjunction=",">
                        #ordLineStsCd[]#
                    </iterate>
                    <!-- 2017/12/15 S21_NA#22882 Add End -->
                )
    </statement>

    <statement id="getMaxDsCpoRtrnLineNum" parameterClass="Map" resultClass="String">
          SELECT 
                 NVL(MAX(DCR.DS_CPO_RTRN_LINE_NUM), '000')
          FROM  
                 DS_CPO_RTRN_DTL DCR
          WHERE 
                 DCR.GLBL_CMPY_CD    = #glblCmpyCd#
            AND  DCR.CPO_ORD_NUM     = #cpoOrdNum#
            AND  DCR.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getMaxDsOrdPosnNum" parameterClass="Map" resultClass="String">
          SELECT 
                 NVL(MAX(DCC.DS_ORD_POSN_NUM), '0')
          FROM  
                 DS_CPO_CONFIG DCC
          WHERE 
                 DCC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND  DCC.CPO_ORD_NUM     = #cpoOrdNum#
            AND  DCC.CONFIG_CATG_CD  = #configCatgCd#
            AND  DCC.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getTrnsfAmt" parameterClass="Map" resultClass="Map">
        SELECT 
                REF.DS_IMPT_ORD_DTL_PK
              , NVL(SUM(REF.DEAL_SVC_REV_TRNSF_AMT), 0)  AS SUM_DEAL_SVC_REV_TRNSF_AMT
              , NVL(SUM(REF.DEAL_SVC_COST_TRNSF_AMT), 0) AS SUM_DEAL_SVC_COST_TRNSF_AMT
        FROM 
                DS_IMPT_SVC_CONFIG_REF REF
        WHERE 
                REF.GLBL_CMPY_CD             = #glblCmpyCd#
            AND REF.DS_IMPT_ORD_DTL_PK       = #dsImptOrdDtlPk#
            AND REF.EZCANCELFLAG             = '0'
        GROUP BY
                REF.DS_IMPT_ORD_DTL_PK
    </statement>

    <statement id="getSchdTmplListForCheck" parameterClass="Map" resultClass="Map">
        SELECT
             A.DS_IMPT_SVC_DTL_PK
            ,A.SPLY_AGMT_PLN_SHORT_NM
            ,D.DS_IMPT_SVC_PRC_PK
            ,D.MAINT_PRC_CATG_CD AS PRC_CATG_CD
            ,D.MDL_ID
            ,D.PRC_MTR_PKG_PK
            ,E.PRC_SVC_CONTR_TP_CD
            ,E.PRC_SVC_PLN_TP_CD
            ,F.PRC_LIST_BAND_CD
            ,F.BLLG_MTR_LB_CD
            ,G.PRC_CATG_NM
          FROM
             DS_IMPT_SCHD_TMPL      A
            ,DS_IMPT_SCHD_TMPL_LINE B
            ,DS_IMPT_SVC_CONFIG_REF C
            ,DS_IMPT_SVC_PRC        D
            ,DS_IMPT_SVC_DTL        E
            ,DS_IMPT_SVC_USG_PRC    F
            ,PRC_CATG               G
         WHERE
               A.GLBL_CMPY_CD = #glblCmpyCd#
           AND A.DS_IMPT_SVC_DTL_PK = #dsImptSvcDtlPk#
           AND A.EZCANCELFLAG = '0'
        
           AND A.GLBL_CMPY_CD = B.GLBL_CMPY_CD
           AND A.DS_IMPT_SCHD_TMPL_PK = B.DS_IMPT_SCHD_TMPL_PK
           AND B.EZCANCELFLAG = '0'
        
           AND B.GLBL_CMPY_CD = C.GLBL_CMPY_CD
           AND B.DS_IMPT_SVC_CONFIG_REF_PK = C.DS_IMPT_SVC_CONFIG_REF_PK
           AND C.EZCANCELFLAG = '0'
        
           AND C.GLBL_CMPY_CD = D.GLBL_CMPY_CD
           AND C.DS_IMPT_SVC_PRC_PK = D.DS_IMPT_SVC_PRC_PK
           AND D.EZCANCELFLAG = '0'
        
           AND D.GLBL_CMPY_CD = E.GLBL_CMPY_CD
           AND D.DS_IMPT_SVC_DTL_PK = E.DS_IMPT_SVC_DTL_PK
           AND E.EZCANCELFLAG = '0'
        
           AND D.GLBL_CMPY_CD = F.GLBL_CMPY_CD(+)
           AND D.DS_IMPT_SVC_DTL_PK = F.DS_IMPT_SVC_DTL_PK(+)
           AND D.DS_IMPT_SVC_PRC_PK = F.DS_IMPT_SVC_PRC_PK(+)
           AND F.EZCANCELFLAG(+) = '0'

           AND D.GLBL_CMPY_CD = G.GLBL_CMPY_CD(+)
           AND D.MAINT_PRC_CATG_CD = G.PRC_CATG_CD(+)
           AND G.EZCANCELFLAG(+) = '0'

         GROUP BY
             A.DS_IMPT_SVC_DTL_PK
            ,A.SPLY_AGMT_PLN_SHORT_NM
            ,D.DS_IMPT_SVC_PRC_PK
            ,D.MAINT_PRC_CATG_CD
            ,D.MDL_ID
            ,D.PRC_MTR_PKG_PK
            ,E.PRC_SVC_CONTR_TP_CD
            ,E.PRC_SVC_PLN_TP_CD
            ,F.PRC_LIST_BAND_CD
            ,F.BLLG_MTR_LB_CD
            ,G.PRC_CATG_NM

         ORDER BY
             A.DS_IMPT_SVC_DTL_PK
            ,A.SPLY_AGMT_PLN_SHORT_NM
            ,D.DS_IMPT_SVC_PRC_PK
            ,D.MAINT_PRC_CATG_CD
            ,D.MDL_ID
            ,D.PRC_MTR_PKG_PK
            ,E.PRC_SVC_CONTR_TP_CD
            ,E.PRC_SVC_PLN_TP_CD
            ,F.PRC_LIST_BAND_CD
            ,F.BLLG_MTR_LB_CD
            ,G.PRC_CATG_NM
    </statement>

    <statement id="getSplyAgmtPlnInfo" parameterClass="Map" resultClass="BigDecimal">
        SELECT
              COUNT(*)
        FROM
              PRC_LIST_SPLY_PGM   PLSP
            , SPLY_AGMT_PLN       SAP
        WHERE
                PLSP.GLBL_CMPY_CD        = #glblCmpyCd#
            AND PLSP.EZCANCELFLAG        = '0'
            AND PLSP.PRC_CATG_CD         = #prcCatgCd#
            AND PLSP.PRC_SVC_PLN_TP_CD   = #prcSvcPlnTpCd#
            AND PLSP.PRC_SVC_CONTR_TP_CD = #prcSvcContrTpCd#

        <isNull property="mdlId">
            AND PLSP.MDL_ID              IS NULL
        </isNull>
        <isNotNull property="mdlId">
            AND PLSP.MDL_ID              = #mdlId#
        </isNotNull>

        <isNull property="prcMtrPkgPk">
            AND PLSP.PRC_MTR_PKG_PK      IS NULL
        </isNull>
        <isNotNull property="prcMtrPkgPk">
            AND PLSP.PRC_MTR_PKG_PK      = #prcMtrPkgPk#
        </isNotNull>

        <isNotNull property="bllgMtrLbCd">
            AND PLSP.BLLG_MTR_LB_CD      = #bllgMtrLbCd#
        </isNotNull>

        <isNotNull property="prcListBandCd">
            AND PLSP.PRC_LIST_BAND_CD = #prcListBandCd#
        </isNotNull>

            AND PLSP.EFF_FROM_DT         &lt;= #slsDt#
            AND (PLSP.EFF_THRU_DT        IS NULL
                OR PLSP.EFF_THRU_DT      &gt;= #slsDt#)

            AND PLSP.GLBL_CMPY_CD           = SAP.GLBL_CMPY_CD
            AND PLSP.SPLY_AGMT_PLN_PK       = SAP.SPLY_AGMT_PLN_PK

        <isNotNull property="splyAgmtPlnShortNm">
            AND SAP.SPLY_AGMT_PLN_SHORT_NM  = #splyAgmtPlnShortNm#
        </isNotNull>

            AND SAP.ACTV_FLG                = 'Y'
            AND SAP.DEL_FLG                 = 'N'
            AND SAP.EZCANCELFLAG            = '0'
    </statement>
    
    <!-- Add Start 2017/08/21 QC#19233 -->
    <statement id="getCountPrcMtrPkg" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT('EXIST')        CNT
            FROM
              <isEqual property="prcListTp" compareValue="21"><!-- EzPack -->
                PRC_LIST_SPLY_PGM       PL
              </isEqual>
              <isEqual property="prcListTp" compareValue="07"><!-- service tier -->
                PRC_LIST_SVC_TIER       PL
              </isEqual>
              <isNotEqual property="prcListTp" compareValue="21">
              <isNotEqual property="prcListTp" compareValue="07">
                PRC_LIST_SVC           PL
              </isNotEqual>
              </isNotEqual>
            WHERE
                PL.GLBL_CMPY_CD             = #glblCmpyCd#
                AND PL.PRC_CATG_CD          = #prcCatgCd#
                AND PL.MDL_ID              IN
              <iterate property="mdlIdList" var="mdlIdList[]" open="(" close=")" conjunction=",">
                #mdlIdList[]#
              </iterate>
                AND PL.PRC_SVC_PLN_TP_CD    = #prcSvcPlnTp#
                AND PL.PRC_SVC_CONTR_TP_CD  = #prcSvcContrTp#
                AND PL.PRC_MTR_PKG_PK       = #prcMtrPkgPk#
                AND PL.DEL_FLG              = 'N'
                AND PL.EFF_FROM_DT         &lt;= #slsDt#
                AND ( 
                    PL.EFF_THRU_DT         IS NULL
                    OR PL.EFF_THRU_DT      &gt;= #slsDt#
                ) 
                AND PL.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getPrcListTp" parameterClass="Map" resultClass="String">
        SELECT
            PLT.PRC_LIST_TP_CD
        FROM
             PRC_CATG                PC
            ,PRC_CATG                DPC
            ,PRC_LIST_TP             PLT
        WHERE
                PC.GLBL_CMPY_CD      = #glblCmpyCd#
            AND PC.PRC_CATG_CD       = #prcCatgCd#
            AND PC.GLBL_CMPY_CD      = DPC.GLBL_CMPY_CD
            AND PC.PRC_CATG_CD       = DPC.PRC_CATG_CD
            AND DPC.GLBL_CMPY_CD     = PLT.GLBL_CMPY_CD
            AND DPC.PRC_LIST_TP_CD   = PLT.PRC_LIST_TP_CD
            AND PC.EZCANCELFLAG      = '0'
            AND DPC.EZCANCELFLAG     = '0'
            AND PLT.EZCANCELFLAG     = '0'
            AND ROWNUM               = 1
    </statement>

    <statement id="getMdlNm" parameterClass="Map" resultClass="String">
        SELECT
            MDL.T_MDL_NM
        FROM
             MDL_NM              MDL
        WHERE
                MDL.T_GLBL_CMPY_CD = #glblCmpyCd#
            AND MDL.EZCANCELFLAG   = '0'
            AND MDL.T_MDL_ID       = #mdlId#
            AND ROWNUM             = 1
    </statement>

    <statement id="getMdlIdList" parameterClass="Map" resultClass="BigDecimal">
        SELECT DISTINCT
                  CV.MDL_ID
            FROM
                DS_CPO_CONFIG_V         CV
                , CPO_DTL_V             DV
                , DS_CONTR_DTL          DCD
            WHERE
                CV.GLBL_CMPY_CD             = #glblCmpyCd#
                AND CV.CPO_ORD_NUM          = #cpoOrdNum#
                AND CV.CONFIG_CATG_CD       = #configCatgOutbound#
                AND CV.EZCANCELFLAG         = '0'
                -- 
                AND CV.GLBL_CMPY_CD         = DV.GLBL_CMPY_CD
                AND CV.CPO_ORD_NUM          = DV.CPO_ORD_NUM
                AND CV.DS_ORD_POSN_NUM      = DV.DS_ORD_POSN_NUM
                AND DV.EZCANCELFLAG         = '0'
                --
                AND DV.GLBL_CMPY_CD         = DCD.GLBL_CMPY_CD
                AND DV.CPO_ORD_NUM          = DCD.CPO_ORD_NUM
                AND DV.CPO_DTL_LINE_NUM     = DCD.CPO_DTL_LINE_NUM
                AND DV.CPO_DTL_LINE_SUB_NUM = DCD.CPO_DTL_LINE_SUB_NUM
                AND DCD.DS_CONTR_PK         = #dsContrPk#
                AND DCD.EZCANCELFLAG        = '0'
    </statement>
    <!-- Add End 2017/08/21 QC#19233 -->
    <statement id="getDsImptOrdConfigList" parameterClass="Map" resultClass="Map">
        SELECT 
            ICONF.SVC_CONFIG_MSTR_PK
        FROM
            DS_IMPT_ORD_CONFIG  ICONF      -- Direct Sales import Order Configuration
        WHERE
            ICONF.EZCANCELFLAG             = '0'
            AND ICONF.GLBL_CMPY_CD         = #glblCmpyCd#
            AND ICONF.DS_IMPT_ORD_PK       = #dsImptOrdPk#
    </statement>

    <!-- Add Start 2017/09/28 QC#20689 -->
    <statement id="getDsContrPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
              DC.DS_CONTR_PK
        FROM
              DS_CONTR DC
            , SVC_CONFIG_MSTR SCM
            , SVC_MACH_MSTR SMM 
        WHERE
                DC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND DC.EZCANCELFLAG        = '0'
            --
            AND DC.GLBL_CMPY_CD        = SMM.GLBL_CMPY_CD 
            AND DC.EZCANCELFLAG        = SMM.EZCANCELFLAG 
            AND DC.CPO_ORD_NUM         = SMM.CPO_ORD_NUM
            -- 
            AND SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD 
            AND SMM.EZCANCELFLAG       = SCM.EZCANCELFLAG 
            AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK 
            AND SMM.SVC_MACH_MSTR_PK   = SCM.SVC_MACH_MSTR_PK 
            AND SCM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#

    </statement>

    <statement id="getConfigLineInfo" parameterClass="Map" resultClass="Map">
        SELECT
              DIOC.DS_IMPT_ORD_CONFIG_PK
            , DIOC.CONFIG_TP_CD 
        FROM
              DS_IMPT_ORD_CONFIG DIOC
            , DS_IMPT_ORD_DTL DIOD 
        WHERE
                DIOC.GLBL_CMPY_CD = #glblCmpyCd# 
            AND DIOC.EZCANCELFLAG = '0' 
            AND DIOC.GLBL_CMPY_CD = DIOD.GLBL_CMPY_CD 
            AND DIOC.EZCANCELFLAG = DIOD.EZCANCELFLAG 
            AND DIOC.DS_IMPT_ORD_CONFIG_PK = DIOD.DS_IMPT_ORD_CONFIG_PK 
            AND DIOD.DS_IMPT_ORD_DTL_PK = #dsImptOrdDtlPk#
    </statement>
    <!-- Add End 2017/09/28 QC#20689 -->

    <statement id="getDsImptOrdSiteSrvyFromOutbound" parameterClass="Map" resultClass="Map">
        SELECT
                  IOSS.DS_IMPT_ORD_SITE_SRVY_PK
                , IOSS.DS_IMPT_ORD_CONFIG_PK
                , IOCO.SVC_CONFIG_MSTR_PK
                , IOCI.DS_IMPT_ORD_CONFIG_PK INBD_DS_IMPT_ORD_CONFIG_PK 
            FROM
                DS_IMPT_ORD_SITE_SRVY IOSS
                , DS_IMPT_ORD_CONFIG IOCO
                , DS_IMPT_ORD_CONFIG IOCI 
            WHERE
                IOSS.GLBL_CMPY_CD           = #glblCmpyCd#
                AND IOSS.DS_IMPT_ORD_PK     = #dsImptOrdPk#
                AND IOSS.EZCANCELFLAG       = '0'
                --
                AND IOSS.GLBL_CMPY_CD       = IOCO.GLBL_CMPY_CD
                AND IOSS.DS_IMPT_ORD_PK     = IOCO.DS_IMPT_ORD_PK
                AND IOCO.CONFIG_CATG_CD     = #configCatgOut#
                AND IOCO.SVC_CONFIG_MSTR_PK IN
            <iterate property="svcConfigMstrPkList" var="svcConfigMstrPk[]" open="(" close=")" conjunction=",">
                    #svcConfigMstrPk[]#
            </iterate>
                AND IOCO.EZCANCELFLAG       = '0'
                --
                AND IOSS.GLBL_CMPY_CD       = IOCI.GLBL_CMPY_CD
                AND IOSS.DS_IMPT_ORD_PK     = IOCI.DS_IMPT_ORD_PK
                AND IOCI.CONFIG_CATG_CD     = #configCatgIn#
                AND IOCI.SVC_CONFIG_MSTR_PK = IOCO.SVC_CONFIG_MSTR_PK
                AND IOCI.EZCANCELFLAG       = '0'
    </statement>

    <!-- 2018/01/04 S21_NA#23116 Add Start -->
    <statement id="getDsImptOrdCtacPsnFromOutbound" parameterClass="Map" resultClass="Map">
        SELECT
                  IOCP.DS_IMPT_ORD_CTAC_PSN_PK
                , IOCP.DS_IMPT_ORD_CONFIG_PK
                , IOCO.SVC_CONFIG_MSTR_PK
                , IOCI.DS_IMPT_ORD_CONFIG_PK INBD_DS_IMPT_ORD_CONFIG_PK 
            FROM
                DS_IMPT_ORD_CTAC_PSN IOCP
                , DS_IMPT_ORD_CONFIG IOCO
                , DS_IMPT_ORD_CONFIG IOCI 
            WHERE
                IOCP.GLBL_CMPY_CD           = #glblCmpyCd#
                AND IOCP.DS_IMPT_ORD_PK     = #dsImptOrdPk#
                AND IOCP.EZCANCELFLAG       = '0'
                --
                AND IOCP.GLBL_CMPY_CD       = IOCO.GLBL_CMPY_CD
                AND IOCP.DS_IMPT_ORD_PK     = IOCO.DS_IMPT_ORD_PK
                AND IOCO.CONFIG_CATG_CD     = #configCatgOut#
                AND IOCO.SVC_CONFIG_MSTR_PK IN
            <iterate property="svcConfigMstrPkList" var="svcConfigMstrPk[]" open="(" close=")" conjunction=",">
                    #svcConfigMstrPk[]#
            </iterate>
                AND IOCO.EZCANCELFLAG       = '0'
                --
                AND IOCP.GLBL_CMPY_CD       = IOCI.GLBL_CMPY_CD
                AND IOCP.DS_IMPT_ORD_PK     = IOCI.DS_IMPT_ORD_PK
                AND IOCI.CONFIG_CATG_CD     = #configCatgIn#
                AND IOCI.SVC_CONFIG_MSTR_PK = IOCO.SVC_CONFIG_MSTR_PK
                AND IOCI.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2018/01/04 S21_NA#23116 Add End -->

    <!-- 2018/03/14 S21_NA#20153 Add Start -->
    <statement id="getOrigOrdNum" parameterClass="Map" resultClass="String">
        SELECT
             CPO.CPO_ORD_NUM
        FROM
             DS_CPO_CONFIG    CONF
            ,CPO_DTL          DTL
            ,CPO              CPO
        WHERE
                CONF.GLBL_CMPY_CD       = #glblCmpyCd#
            AND CONF.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
            AND CONF.EZCANCELFLAG       = '0'

            AND DTL.GLBL_CMPY_CD        = CONF.GLBL_CMPY_CD
            AND DTL.CPO_ORD_NUM         = CONF.CPO_ORD_NUM
            AND DTL.DS_ORD_POSN_NUM     = CONF.DS_ORD_POSN_NUM
            AND DTL.BASE_CMPT_FLG       = 'Y'
            AND DTL.EZCANCELFLAG        = '0'

            AND CPO.GLBL_CMPY_CD        = DTL.GLBL_CMPY_CD
            AND CPO.CPO_ORD_NUM         = DTL.CPO_ORD_NUM
            AND CPO.EZCANCELFLAG        = '0'
    </statement>

    <statement id="countOrdCatgBizCtxByOrdNum" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(CTX.DS_ORD_CATG_CD)
        FROM
             ORD_CATG_BIZ_CTX  CTX
            ,CPO               CPO
        WHERE
                CPO.GLBL_CMPY_CD       = #glblCmpyCd#
            AND CPO.CPO_ORD_NUM        = #cpoOrdNum#
            AND CPO.EZCANCELFLAG       = '0'
            AND CPO.GLBL_CMPY_CD       = CTX.GLBL_CMPY_CD
            AND CPO.DS_ORD_CATG_CD     = CTX.DS_ORD_CATG_CD
            AND (
                CPO.DS_ORD_TP_CD       = CTX.DS_ORD_TP_CD
                OR CTX.DS_ORD_TP_CD   IS NULL
            )
            AND (
                CPO.DS_ORD_RSN_CD      = CTX.DS_ORD_RSN_CD
                OR CTX.DS_ORD_RSN_CD  IS NULL
            )
            AND CTX.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCd#
            AND CTX.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2018/03/14 S21_NA#20153 Add End -->
    
    <!-- 2018/06/13 S21_NA#24294 Add Start -->
    <statement id="getBillToLocNum" parameterClass="Map" resultClass="String">
        SELECT
              BTC.LOC_NUM  
        FROM
              BILL_TO_CUST BTC
        WHERE
                BTC.GLBL_CMPY_CD = #glblCmpyCd# 
            AND BTC.BILL_TO_CUST_CD = #billToCustCd#
            AND BTC.EZCANCELFLAG = '0'
    </statement>
    
    <statement id="getShipToLocNum" parameterClass="Map" resultClass="String">
        SELECT
              STC.LOC_NUM  
        FROM
              SHIP_TO_CUST STC
        WHERE
                STC.GLBL_CMPY_CD = #glblCmpyCd# 
            AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
            AND STC.EZCANCELFLAG = '0'
    </statement>
    <!-- 2018/06/13 S21_NA#24294 Add End -->
    
    <!-- 2018/08/21 S21_NA#27817 Add Start -->
    <statement id="getContact" parameterClass="Map" resultMap="result.getContact">
        SELECT
                 CP.CTAC_PSN_PK
                ,CP.CTAC_PSN_FIRST_NM
                ,CP.CTAC_PSN_LAST_NM
                ,A.DS_CTAC_PNT_VAL_TXT_A2  AS PHONE
                ,A.DS_CTAC_PSN_EXTN_NUM_A2 AS EXT
                ,A.DS_CTAC_PNT_VAL_TXT_A4  AS EMAIL
                ,A.DS_CTAC_PNT_VAL_TXT_A5  AS FAX
                ,A.DS_CTAC_PNT_VAL_TXT_A1  AS MOBILE

         FROM
                 DS_CTAC_PSN_RELN DCPR
                ,CTAC_PSN         CP
                ,(
                  SELECT
                      B.CTAC_PSN_PK
                     ,MAX(CASE WHEN B.DS_CTAC_PNT_TP_CD = #dsCtacPntTpCd_M# THEN P2.DS_CTAC_PNT_VAL_TXT  ELSE NULL END) DS_CTAC_PNT_VAL_TXT_A1
                     ,MAX(CASE WHEN B.DS_CTAC_PNT_TP_CD = #dsCtacPntTpCd_P# THEN P2.DS_CTAC_PNT_VAL_TXT  ELSE NULL END) DS_CTAC_PNT_VAL_TXT_A2
                     ,MAX(CASE WHEN B.DS_CTAC_PNT_TP_CD = #dsCtacPntTpCd_P# THEN P2.DS_CTAC_PSN_EXTN_NUM ELSE NULL END) DS_CTAC_PSN_EXTN_NUM_A2
                     ,MAX(CASE WHEN B.DS_CTAC_PNT_TP_CD = #dsCtacPntTpCd_E# THEN P2.DS_CTAC_PNT_VAL_TXT  ELSE NULL END) DS_CTAC_PNT_VAL_TXT_A4
                     ,MAX(CASE WHEN B.DS_CTAC_PNT_TP_CD = #dsCtacPntTpCd_F# THEN P2.DS_CTAC_PNT_VAL_TXT  ELSE NULL END) DS_CTAC_PNT_VAL_TXT_A5
                  FROM
                      (
                       SELECT
                           P.GLBL_CMPY_CD
                          ,P.CTAC_PSN_PK
                          ,TP.DS_CTAC_PNT_TP_CD
                          ,MAX(P.DS_CTAC_PNT_PK) AS DS_CTAC_PNT_PK
                       FROM
                           DS_CTAC_PNT P
                          ,DS_CTAC_PNT_TP TP
                       WHERE
                           P.GLBL_CMPY_CD             = #glblCmpyCd#
                           AND P.DS_CTAC_PNT_ACTV_FLG = 'Y'
                           AND P.EZCANCELFLAG         = '0'
                           AND P.GLBL_CMPY_CD         = TP.GLBL_CMPY_CD
                           AND P.DS_CTAC_PNT_TP_CD    = TP.DS_CTAC_PNT_TP_CD
                           AND TP.EZCANCELFLAG        = '0'
                       GROUP BY
                           P.GLBL_CMPY_CD
                          ,P.CTAC_PSN_PK
                          ,TP.DS_CTAC_PNT_TP_CD
                      ) B
                     ,DS_CTAC_PNT P2
                  WHERE
                          P2.GLBL_CMPY_CD       = #glblCmpyCd#
                      AND P2.EZCANCELFLAG   = '0'
                      AND P2.GLBL_CMPY_CD   = B.GLBL_CMPY_CD
                      AND P2.DS_CTAC_PNT_PK = B.DS_CTAC_PNT_PK
                  GROUP BY
                      B.CTAC_PSN_PK
                 ) A
                 <isNotNull property="soldToCustLocCd">
                 ,BILL_TO_CUST BTC
                 </isNotNull>
             WHERE
                 DCPR.GLBL_CMPY_CD    = #glblCmpyCd#
                 AND DCPR.EFF_FROM_DT &lt;= #salesDate#
                 AND NVL(DCPR.EFF_THRU_DT, '99991231') &gt;= #salesDate#
                 <isNotNull property="sellToCustCd">
                 AND DCPR.DS_ACCT_NUM LIKE #sellToCustCd#
                 </isNotNull>
                 
                 <isNotNull property="soldToCustLocCd">
                 AND DCPR.GLBL_CMPY_CD    = BTC.GLBL_CMPY_CD
                 AND DCPR.LOC_NUM         = BTC.LOC_NUM
                 AND BTC.BILL_TO_CUST_CD LIKE #soldToCustLocCd#
                 AND BTC.EZCANCELFLAG     = '0'
                 </isNotNull>
                 AND DCPR.CTAC_TP_CD = #ctacTpCd#
                 AND DCPR.EZCANCELFLAG    = '0'

                 AND DCPR.GLBL_CMPY_CD = CP.GLBL_CMPY_CD
                 AND DCPR.CTAC_PSN_PK  = CP.CTAC_PSN_PK
                 AND CP.CTAC_PSN_ACTV_FLG = 'Y'
                 <isNotNull property="ctacPsnFirstNm">
                 AND UPPER(CP.CTAC_PSN_FIRST_NM) LIKE UPPER(#ctacPsnFirstNm#)
                 </isNotNull>
                 <isNotNull property="ctacPsnLastNm">
                 AND UPPER(CP.CTAC_PSN_LAST_NM) LIKE UPPER(#ctacPsnLastNm#)
                 </isNotNull>
                 <!-- 2019/01/16 S21_NA#29535 Add Start -->
                 <isNotNull property="ctacPsnPk">
                 AND CP.CTAC_PSN_PK = #ctacPsnPk#
                 </isNotNull>
                 <!-- 2019/01/16 S21_NA#29535 Add End -->
                 AND CP.EZCANCELFLAG   = '0'

                 AND A.CTAC_PSN_PK(+) = CP.CTAC_PSN_PK
    </statement>
    
    <resultMap id="result.getContact" class="CTAC_PSNTMsg" >
        <result property="ctacPsnFirstNm"     column="CTAC_PSN_FIRST_NM"  javaType="EZDTStringItem"/>
        <result property="ctacPsnLastNm"      column="CTAC_PSN_LAST_NM"   javaType="EZDTStringItem"/>
        <result property="ctacPsnEmlAddr"     column="EMAIL"              javaType="EZDTStringItem"/>
        <result property="ctacPsnExtnNum"     column="EXT"                javaType="EZDTStringItem"/>
        <result property="ctacPsnTelNum"      column="PHONE"              javaType="EZDTStringItem"/>
        <result property="ctacPsnFaxNum"      column="FAX"                javaType="EZDTStringItem"/>
        <result property="ctacPsnCellPhoNum"  column="MOBILE"             javaType="EZDTStringItem"/>
        <result property="ctacPsnPk"          column="CTAC_PSN_PK"        javaType="EZDTBigDecimalItem"/>
    </resultMap>
    <!-- 2018/08/21 S21_NA#27817 Add End -->
    
    <!-- 2018/11/29 S21_NA#28899 Add Start -->
    <statement id="getCntyNm" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            P.CTY_ADDR
           ,P.ST_CD
           ,P.POST_CD
           ,C.CNTY_NM
        FROM 
            POST P
           ,CNTY_POST_RELN R
           ,CNTY C
        WHERE 
            P.EZCANCELFLAG = '0'
        AND P.GLBL_CMPY_CD = #glblCmpyCd#
        <isNotNull property="postCd5">
        AND P.POST_CD IN (#postCd5#, #postCd9#)
        </isNotNull>
        <isNotNull property="ctyAddr">
        AND P.CTY_ADDR = #ctyAddr#
        </isNotNull>
        <isNotNull property="stCd">
        AND P.ST_CD = #stCd#
        </isNotNull>
        AND R.EZCANCELFLAG(+) = '0'
        AND R.GLBL_CMPY_CD(+) = P.GLBL_CMPY_CD
        AND R.POST_PK(+) = P.POST_PK

        AND C.EZCANCELFLAG = '0'
        AND C.GLBL_CMPY_CD = R.GLBL_CMPY_CD
        AND C.CNTY_PK = R.CNTY_PK 
        <isNotNull property="cntyNm">
        AND C.CNTY_NM = #cntyNm#
        </isNotNull>
    </statement>
    <!-- 2018/11/29 S21_NA#28899 Add End -->

    <!-- 2020/01/06 S21_NA#54219 Del Start -->
    <!-- 2019/12/05 S21_NA#54219 Add Start -->
    <!-- <statement id="getCountDsImptSvcDtl" parameterClass="Map" resultClass="Integer">        -->
    <!--     SELECT                                                                              -->
    <!--               COUNT(DISD.DS_IMPT_SVC_DTL_PK)    CNT                                     -->
    <!--         FROM                                                                            -->
    <!--             DS_IMPT_SVC_DTL       DISD                                                  -->
    <!--         WHERE                                                                           -->
    <!--             DISD.GLBL_CMPY_CD      = #glblCmpyCd#                                       -->
    <!--         AND DISD.DS_IMPT_ORD_PK    = #dsImptOrdPk#                                      -->
    <!--         AND DISD.EZCANCELFLAG      = '0'                                                -->
    <!-- </statement>                                                                            -->

    <!-- <statement id="getCountShellOnShippingLine" parameterClass="Map" resultClass="Integer"> -->
    <!--     SELECT                                                                              -->
    <!--               COUNT(DISD.DS_IMPT_SVC_DTL_PK)    CNT                                     -->
    <!--         FROM                                                                            -->
    <!--             DS_IMPT_ORD_DTL        DIOD                                                 -->
    <!--            ,DS_IMPT_SVC_CONFIG_REF DISCR                                                -->
    <!--            ,DS_IMPT_SVC_DTL        DISD                                                 -->
    <!--         WHERE                                                                           -->
    <!--             DIOD.GLBL_CMPY_CD        = #glblCmpyCd#                                     -->
    <!--         AND DIOD.DS_IMPT_ORD_PK      = #dsImptOrdPk#                                    -->
    <!--         AND DIOD.IMPT_LINE_FLG       = #flgY#                                           -->
    <!--         AND DIOD.EZCANCELFLAG        = '0'                                              -->
    <!--         AND DIOD.GLBL_CMPY_CD        = DISCR.GLBL_CMPY_CD                               -->
    <!--         AND DIOD.DS_IMPT_ORD_PK      = DISCR.DS_IMPT_ORD_PK                             -->
    <!--         AND DIOD.DS_IMPT_ORD_DTL_PK  = DISCR.DS_IMPT_ORD_DTL_PK                         -->
    <!--         AND DISCR.EZCANCELFLAG       = '0'                                              -->
    <!--         AND DISCR.GLBL_CMPY_CD       = DISD.GLBL_CMPY_CD                                -->
    <!--         AND DISCR.DS_IMPT_ORD_PK     = DISD.DS_IMPT_ORD_PK                              -->
    <!--         AND DISCR.DS_IMPT_SVC_DTL_PK = DISD.DS_IMPT_SVC_DTL_PK                          -->
    <!--         AND DISD.EZCANCELFLAG        = '0'                                              -->
    <!-- </statement>                                                                            -->
    <!-- 2018/11/29 S21_NA#54219 Add End -->
    <!-- 2020/01/06 S21_NA#54219 Del End -->
    <!-- 2022/12/15 QC#60885 Add Start -->
    <statement id="getRtrSubWH" parameterClass="Map" resultClass="String">
        SELECT
            CD.RTL_SWH_CD
        FROM
            SVC_MACH_MSTR M
           ,CPO_DTL CD
        WHERE
            M.GLBL_CMPY_CD         = #glblCmpyCd#
        AND M.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
        AND CD.CPO_ORD_NUM         = #cpoOrdNum#
        AND CD.SVC_CONFIG_MSTR_PK  = #svcConfigMstrPK#
        AND M.SVC_CONFIG_MSTR_PK   = CD.SVC_CONFIG_MSTR_PK
        AND M.SVC_MACH_MSTR_PK     = #svcMachMstrPK#
        AND M.CPO_ORD_NUM          = CD.CPO_ORD_NUM
        AND M.CPO_DTL_LINE_NUM     = CD.CPO_DTL_LINE_NUM
        AND M.CPO_DTL_LINE_SUB_NUM = CD.CPO_DTL_LINE_SUB_NUM
        AND M.EZCANCELFLAG         = '0'
        AND CD.EZCANCELFLAG        = '0'
    </statement>
    <!-- 2022/12/15 QC#60885 Add End -->
</sqlMap>
