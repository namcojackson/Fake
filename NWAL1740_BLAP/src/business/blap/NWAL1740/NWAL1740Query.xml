<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL1740Query">

    <typeAlias alias="NWAL1740SMsg"    type="business.blap.NWAL1740.NWAL1740SMsg"/>
    <typeAlias alias="NWAL1740_ASMsg"  type="business.blap.NWAL1740.NWAL1740_ASMsg"/>
    <statement id="getProfitabilityPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
             PO.ORD_PROC_NODE_PRFL_CD
            ,PO.ORD_PROC_NODE_PRFL_NM
        FROM
             ORD_PROC_NODE_PRFL PO
            ,ORD_PRFT_NODE_PRFL PF
        WHERE
            PO.GLBL_CMPY_CD = #glblCmpyCd#
        AND PO.EZCANCELFLAG = '0'
        AND PO.ORD_PROC_NODE_PRFL_CD = PF.ORD_PROC_NODE_PRFL_CD
        AND PO.GLBL_CMPY_CD = PF.GLBL_CMPY_CD
        AND PF.EZCANCELFLAG = '0'
        ORDER BY
            ORD_PROC_NODE_PRFL_SORT_NUM
    </statement>
    <statement id="getMdseTpRules" parameterClass="Map" resultClass="Map">
       SELECT
             MD.COA_MDSE_TP_CD
            ,MD.FL_PRC_CALC_INCL_FLG
            ,MD.REP_REV_CALC_INCL_FLG
            ,MD.DISC_MDSE_TP_FLG
            ,MD.RED_FL_PRC_FLG
            ,MD.RED_REP_REV_FLG
            ,MD.DISC_ALLOC_METH_CD
            ,MD.DLR_CR_PRFT_INCL_FLG
            ,MD.RED_COMP_AMT_FLG
            ,MD.COA_PROJ_NM
            ,MD.DISC_ALLOC_METH_NM
            ,MD.EZUPTIME
            ,MD.EZUPTIMEZONE
       FROM
       (SELECT
            RU.COA_MDSE_TP_CD
            ,RU.FL_PRC_CALC_INCL_FLG
            ,RU.REP_REV_CALC_INCL_FLG
            ,RU.DISC_MDSE_TP_FLG
            ,RU.RED_FL_PRC_FLG
            ,RU.RED_REP_REV_FLG
            ,RU.DISC_ALLOC_METH_CD
            ,RU.DLR_CR_PRFT_INCL_FLG
            ,RU.RED_COMP_AMT_FLG
            ,CP.COA_PROJ_NM
            ,DA.DISC_ALLOC_METH_NM
            ,RU.EZUPTIME
            ,RU.EZUPTIMEZONE
       FROM
            ORD_PRFT_MDSE_TP_RULE RU
            ,COA_PROJ CP
            ,DISC_ALLOC_METH DA
       WHERE
           RU.GLBL_CMPY_CD = #glblCmpyCd#
       AND RU.EZCANCELFLAG = '0'
       AND RU.ORD_PROC_NODE_PRFL_CD = #ordProcNodePrflCd#

       AND RU.COA_MDSE_TP_CD = CP.COA_PROJ_CD
       AND RU.GLBL_CMPY_CD = CP.GLBL_CMPY_CD
       AND CP.EZCANCELFLAG = '0'

       AND RU.DISC_ALLOC_METH_CD = DA.DISC_ALLOC_METH_CD(+)
       AND RU.GLBL_CMPY_CD = DA.GLBL_CMPY_CD(+)
       AND DA.EZCANCELFLAG(+) = '0'
       ORDER BY
           RU.COA_MDSE_TP_CD) MD
       <isNotNull property="rowNum">
        WHERE ROWNUM &lt;= #rowNum#
       </isNotNull>
    </statement>
    
    <statement id="getLineCatgRules" parameterClass="Map" resultClass="Map">
        SELECT
             LN.DS_ORD_LINE_CATG_CD
            ,LN.ACTV_FLG
            ,LN.EFF_FROM_DT
            ,LN.EFF_THRU_DT
            ,LN.DS_ORD_LINE_CATG_NM
            ,LN.DS_ORD_LINE_CATG_DESC_TXT
            ,LN.EZUPTIME
            ,LN.EZUPTIMEZONE
        FROM
        (SELECT
             PL.DS_ORD_LINE_CATG_CD
            ,PL.ACTV_FLG
            ,PL.EFF_FROM_DT
            ,PL.EFF_THRU_DT
            ,LC.DS_ORD_LINE_CATG_NM
            ,LC.DS_ORD_LINE_CATG_DESC_TXT
            ,PL.EZUPTIME
            ,PL.EZUPTIMEZONE
        FROM
            ORD_PRFT_LINE_CATG_RULE PL
            ,DS_ORD_LINE_CATG LC
        WHERE
            PL.GLBL_CMPY_CD = #glblCmpyCd#
        AND PL.EZCANCELFLAG = '0'
        AND PL.ORD_PROC_NODE_PRFL_CD = #ordProcNodePrflCd#

        AND PL.DS_ORD_LINE_CATG_CD = LC.DS_ORD_LINE_CATG_CD
        AND PL.GLBL_CMPY_CD = LC.GLBL_CMPY_CD
        AND LC.EZCANCELFLAG = '0'
        ORDER BY
            LC.DS_ORD_LINE_CATG_SORT_NUM) LN
        <isNotNull property="rowNum">
            WHERE ROWNUM &lt;= #rowNum#
        </isNotNull>
    </statement>
    <statement id="getWHRules" parameterClass="Map" resultClass="Map">
        SELECT
             WH.RTL_WH_CD
            ,WH.RTL_SWH_CD
            ,WH.ACTV_FLG
            ,WH.EFF_FROM_DT
            ,WH.EFF_THRU_DT
            ,WH.RTL_WH_NM
            ,WH.RTL_SWH_NM
	        ,WH.MDSE_INVTY_COST_PCT
	        ,WH.EZUPTIME
            ,WH.EZUPTIMEZONE
        FROM
        (SELECT
            RU.RTL_WH_CD
            ,RU.RTL_SWH_CD
            ,RU.ACTV_FLG
            ,RU.EFF_FROM_DT
            ,RU.EFF_THRU_DT
            ,RWH.RTL_WH_NM
            ,RSWH.RTL_SWH_NM
	        ,SW.MDSE_INVTY_COST_PCT
	        ,RU.EZUPTIME
            ,RU.EZUPTIMEZONE
        FROM
            ORD_PRFT_WH_RULE RU
            ,RTL_WH RWH
            ,RTL_SWH RSWH
            ,SWH SW
        WHERE
            RU.GLBL_CMPY_CD = #glblCmpyCd#
        AND RU.EZCANCELFLAG = '0'
        AND RU.ORD_PROC_NODE_PRFL_CD = #ordProcNodePrflCd#

        AND RU.RTL_WH_CD = RWH.RTL_WH_CD
        AND RU.GLBL_CMPY_CD = RWH.GLBL_CMPY_CD
        AND RWH.EZCANCELFLAG = '0'

        AND RU.RTL_WH_CD = RSWH.RTL_WH_CD
        AND RU.RTL_SWH_CD = RSWH.RTL_SWH_CD
        AND RU.GLBL_CMPY_CD = RSWH.GLBL_CMPY_CD
        AND RSWH.EZCANCELFLAG = '0'

        AND RU.RTL_SWH_CD = SW.RTL_SWH_CD
        AND RU.GLBL_CMPY_CD = SW.GLBL_CMPY_CD
        AND SW.EZCANCELFLAG = '0'
        ORDER BY
            RWH.RTL_WH_NM
            ,RSWH.RTL_SWH_NM) WH
        <isNotNull property="rowNum">
            WHERE ROWNUM &lt;= #rowNum#
        </isNotNull>
    </statement>
    <statement id="getValuation" parameterClass="Map" resultClass="Map">
        SELECT
            RW.RTL_WH_CD
            ,RS.RTL_SWH_CD
            ,SH.MDSE_INVTY_COST_PCT
        FROM
            RTL_WH RW
           ,RTL_SWH RS
           ,SWH SH
        WHERE
            RW.GLBL_CMPY_CD = #glblCmpyCd#
        AND RW.EZCANCELFLAG = '0'
        AND RW.RTL_WH_NM = #rtlWhNm#

        AND RW.RTL_WH_CD = RS.RTL_WH_CD
        AND RW.GLBL_CMPY_CD = RS.GLBL_CMPY_CD
        AND RS.EZCANCELFLAG = '0'
        AND RS.RTL_SWH_NM = #rtlSWhNm#

        AND RS.RTL_SWH_CD = SH.RTL_SWH_CD
        AND RS.GLBL_CMPY_CD = SH.GLBL_CMPY_CD
        AND SH.EZCANCELFLAG = '0'
        <isNotNull property="rowNum">
           AND ROWNUM &lt;= #rowNum#
        </isNotNull>
    </statement>
</sqlMap>
