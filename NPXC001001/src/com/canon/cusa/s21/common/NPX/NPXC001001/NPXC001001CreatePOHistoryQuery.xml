<sqlMap namespace="NPXC001001CreatePOHistoryQuery">
    <statement id="getPoHeader" parameterClass="Map" resultClass="Map">
        SELECT
             P.PO_HDR_STS_CD
            ,P.PO_APVL_STS_CD
            ,P.PO_APVL_TS
            ,P.PO_APVL_PSN_CD
            ,P.PO_STS_CD
            ,P.PRNT_VND_CD
            ,P.PRNT_VND_NM
            ,P.VND_CD
            ,P.VND_NM
            ,P.PRCH_GRP_CD
            ,P.LINE_BIZ_TP_CD
            ,P.CARR_ACCT_NUM
            ,P.PO_ORD_CMNT_TXT
            ,P.VND_ISS_ORD_NUM
            ,P.PO_SEND_FLG
            ,P.PO_SEND_TS
            ,P.PO_PRINT_FLG
            ,P.TRSMT_METH_TP_CD
            ,P.SEND_PO_FAX_NUM
            ,P.SEND_PO_EML_ADDR
        FROM
             PO         P
        WHERE
            P.GLBL_CMPY_CD         = #glblCmpyCd#
        AND P.PO_ORD_NUM           = #poOrdNum#
        AND P.EZCANCELFLAG         = '0'

    </statement>

    <statement id="getPoDetail" parameterClass="Map" resultClass="Map">
         SELECT
              PD.PO_ORD_NUM
             ,PD.PO_ORD_DTL_LINE_NUM
             ,PD.DISP_PO_DTL_LINE_NUM
             ,PD.FRT_COND_CD
             ,PD.SHPG_SVC_LVL_CD
             ,PD.CARR_CD
             ,PD.PO_LINE_STS_CD
             ,PD.PO_STS_CD
             ,PD.INVTY_LOC_CD
             ,PD.DEST_RTL_WH_CD
             ,PD.DEST_RTL_SWH_CD
             ,PD.SRC_RTL_WH_CD
             ,PD.SRC_RTL_SWH_CD
             ,PD.SHIP_TO_CUST_CD
             ,PD.SHIP_TO_ACCT_NM
             ,PD.SHIP_TO_LOC_NM
             ,PD.RQST_RCV_DT
             ,PD.RQST_RCV_TM
             ,PD.FROM_STK_STS_CD
             ,PD.TO_STK_STS_CD
             ,PD.PO_MATCH_TP_CD
             ,PD.MDSE_CD
             ,PD.ORIG_MDSE_CD
             ,PD.ASL_MDSE_CD
             ,PD.PO_QTY
             ,PD.PO_DISP_QTY
             ,PD.PO_RCV_QTY
             ,PD.PO_CANC_QTY
             ,PD.PO_BAL_QTY
             ,PD.ORD_QTY
             ,PD.PO_INV_QTY
             ,PD.PO_INV_BAL_QTY
             ,PD.PO_DISP_UOM_CD
             ,PD.THIS_MTH_FOB_COST_AMT
             ,PD.ASL_DTL_PK
             ,PD.ASL_UNIT_PRC_AMT
             ,PD.ENT_DEAL_NET_UNIT_PRC_AMT
             ,PD.ENT_PO_DTL_DEAL_NET_AMT
             ,PD.ENT_FUNC_NET_UNIT_PRC_AMT
             ,PD.ENT_PO_DTL_FUNC_NET_AMT
             ,PD.CCY_CD
             ,PD.EXCH_RATE
             ,PD.PO_ORD_DTL_CMNT_TXT
             ,PSN.SER_NUM
             ,PD.SVC_CONFIG_MSTR_PK
             ,PD.ORIG_PO_ORD_NUM
             ,PD.ORIG_PO_ORD_DTL_LINE_NUM
             ,PD.ORIG_DISP_PO_DTL_LINE_NUM
             ,PD.VND_PO_ACK_STS_CD
             ,PD.VND_INVTY_LOC_CD
             ,PD.VND_ISS_PO_ORD_NUM
             ,PD.PO_SEND_TS
             ,V.SPLY_COA_CMPY_CD      CHRG_COA_CMPY_CD
             ,V.SPLY_COA_BR_CD        CHRG_COA_BR_CD
             ,V.SPLY_COA_CC_CD        CHRG_COA_CC_CD
             ,V.SPLY_COA_ACCT_CD      CHRG_COA_ACCT_CD
             ,V.SPLY_COA_PROD_CD      CHRG_COA_PROD_CD
             ,V.SPLY_COA_CH_CD        CHRG_COA_CH_CD
             ,V.SPLY_COA_AFFL_CD      CHRG_COA_AFFL_CD
             ,V.SPLY_COA_PROJ_CD      CHRG_COA_PROJ_CD
             ,V.SPLY_COA_EXTN_CD      CHRG_COA_EXTN_CD
             ,PAA.COA_CMPY_CD         ACRL_COA_CMPY_CD
             ,PAA.COA_BR_CD           ACRL_COA_BR_CD
             ,PAA.COA_CC_CD           ACRL_COA_CC_CD
             ,PAA.COA_ACCT_CD         ACRL_COA_ACCT_CD
             ,PAA.COA_PROD_CD         ACRL_COA_PROD_CD
             ,PAA.COA_CH_CD           ACRL_COA_CH_CD
             ,PAA.COA_AFFL_CD         ACRL_COA_AFFL_CD
             ,PAA.COA_PROJ_CD         ACRL_COA_PROJ_CD
             ,PAA.COA_EXTN_CD         ACRL_COA_EXTN_CD
             ,DPCI.COA_CMPY_CD        VAR_COA_CMPY_CD
             ,RW.COA_BR_CD            VAR_COA_BR_CD
             ,DPCI.COA_CC_CD          VAR_COA_CC_CD
             ,CPA.COA_ACCT_CD         VAR_COA_ACCT_CD
             ,DPCI.COA_PROD_CD        VAR_COA_PROD_CD
             ,DPCI.COA_CH_CD          VAR_COA_CH_CD
             ,DPCI.COA_AFFL_CD        VAR_COA_AFFL_CD
             ,DPCI.COA_PROJ_CD        VAR_COA_PROJ_CD
             ,DPCI.COA_EXTN_CD        VAR_COA_EXTN_CD
         FROM
              PO                P
             ,PO_DTL            PD
             ,PO_ACCT           PAA
             ,PO_SER_NUM        PSN
             ,VND               V
             ,DEF_DPLY_COA_INFO DPCI
             ,RTL_WH            RW
             ,MDSE              DMI
             ,PO_ACCT_TP        PAT
             ,COA_PROJ_ACCT     CPA
         WHERE
             P.GLBL_CMPY_CD          = #glblCmpyCd#
         AND P.PO_ORD_NUM            = #poOrdNum#
         AND P.EZCANCELFLAG          = '0'

         AND PD.GLBL_CMPY_CD         = P.GLBL_CMPY_CD
         AND PD.PO_ORD_NUM           = P.PO_ORD_NUM
         <isNotNull property="poOrdDtlLineNum">
         AND PD.PO_ORD_DTL_LINE_NUM  = #poOrdDtlLineNum#
         </isNotNull>
         AND PD.EZCANCELFLAG         = '0'

         AND PD.GLBL_CMPY_CD         = PAA.GLBL_CMPY_CD (+)
         AND PD.PO_ORD_NUM           = PAA.PO_ORD_NUM (+)
         AND PD.PO_ORD_DTL_LINE_NUM  = PAA.PO_ORD_DTL_LINE_NUM (+)
         AND PAA.PO_ACCT_TP_CD (+)   = #poAcctTpCd02#
         AND PAA.EZCANCELFLAG (+)    = '0'

         AND PD.GLBL_CMPY_CD         = PSN.GLBL_CMPY_CD (+)
         AND PD.PO_ORD_NUM           = PSN.KEY_INFO_CD_04 (+) 
         AND PD.PO_ORD_DTL_LINE_NUM  = PSN.KEY_INFO_CD_05 (+)
         AND PSN.EZCANCELFLAG (+)    = '0'

         AND P.GLBL_CMPY_CD          = V.GLBL_CMPY_CD (+)
         AND P.VND_CD                = V.VND_CD (+)
         AND V.EZCANCELFLAG (+)      = '0'

         AND PD.GLBL_CMPY_CD         = DPCI.GLBL_CMPY_CD (+)
         AND DPCI.APP_FUNC_ID (+)    = #PoEntryAppFuncId# || #poAcctTpCd03# || PD.PO_LINE_TP_CD
         AND DPCI.EZCANCELFLAG (+)   = '0'

         AND P.GLBL_CMPY_CD          = RW.GLBL_CMPY_CD (+)
         AND P.DEST_RTL_WH_CD        = RW.RTL_WH_CD (+)
         AND RW.EZCANCELFLAG (+)     = '0'


         AND PD.GLBL_CMPY_CD         = DMI.GLBL_CMPY_CD (+)
         AND PD.MDSE_CD              = DMI.MDSE_CD (+)
         AND DMI.EZCANCELFLAG (+)    = '0'

         AND P.GLBL_CMPY_CD          = PAT.GLBL_CMPY_CD (+)
         AND PAT.PO_ACCT_TP_CD (+)   = #poAcctTpCd03#
         AND PAT.EZCANCELFLAG (+)    = '0'

         AND DMI.GLBL_CMPY_CD        = CPA.GLBL_CMPY_CD (+)
         AND DMI.COA_MDSE_TP_CD      = CPA.COA_PROJ_CD (+)
         AND PAT.COA_PROJ_ACCT_TP_CD = CPA.COA_PROJ_ACCT_TP_CD (+)
         AND CPA.EZCANCELFLAG (+)    = '0'

         ORDER BY
             PD.PO_ORD_NUM
            ,PD.PO_ORD_DTL_LINE_NUM
    </statement>
</sqlMap>
