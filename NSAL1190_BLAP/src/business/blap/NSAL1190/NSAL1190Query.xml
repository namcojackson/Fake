<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAL1190Query">
    <typeAlias alias="NSAL1190_ASMsg" type="business.blap.NSAL1190.NSAL1190_ASMsg"/>
    <statement id="getMaxMtrLbSortNum" parameterClass="Map" resultClass="Map">
        SELECT
            MAX(ML.MTR_LB_SORT_NUM) AS MTR_LB_SORT_NUM
        FROM
            MTR_LB ML
        WHERE
                ML.GLBL_CMPY_CD = #glblCmpyCd#
            AND ML.EZCANCELFLAG = '0'
    </statement>
    <statement id="getSearchData" parameterClass="Map" resultMap="result.getSearchData">
        SELECT
             MTR_LB_CD
            ,MTR_IDX_CD
            ,MTR_LB_NM
            ,MTR_LB_TP_CD
            ,BLLG_MTR_LVL_NUM
            ,MTR_LB_DESC_TXT
            ,FLT_MTR_LB_CD
            ,FLT_MTR_LB_NM
            ,AGG_MTR_LB_CD
            ,AGG_MTR_LB_NM
            ,ACTV_FLG
            ,EFF_FROM_DT
            ,EFF_THRU_DT
            ,BW_MTR_FLG
            ,COLOR_MTR_FLG
            ,TOT_MTR_FLG
            ,CORP_ADVTG_FLG
            ,MTR_CNTR_ID
            ,INTG_MDSE_CD
            <!-- START 2018/02/05 M.Naito [QC#21184, ADD] -->
            ,INV_PRINT_MTR_LB_DESC_TXT
            <!-- END 2018/02/05 M.Naito [QC#21184, ADD] -->
            ,EZUPTIME
            ,EZUPTIMEZONE
            <!-- START 2016/12/01 K.Kojima [QC#14204, ADD] -->
            ,XX_REC_HIST_CRAT_TS_A
            ,XX_REC_HIST_CRAT_BY_NM_A
            ,XX_REC_HIST_UPD_TS_A
            ,XX_REC_HIST_UPD_BY_NM_A
            ,XX_REC_HIST_TBL_NM_A
            <!-- END 2016/12/01 K.Kojima [QC#14204, ADD] -->
        FROM (
            SELECT
                 ML.MTR_LB_CD
                ,ML.MTR_IDX_CD
                ,ML.MTR_LB_NM
                ,ML.MTR_LB_TP_CD
                ,ML.BLLG_MTR_LVL_NUM
                ,ML.MTR_LB_DESC_TXT
                ,MF.MTR_LB_CD           AS FLT_MTR_LB_CD
                ,MF.MTR_LB_NM           AS FLT_MTR_LB_NM
                ,MA.MTR_LB_CD           AS AGG_MTR_LB_CD
                ,MA.MTR_LB_NM           AS AGG_MTR_LB_NM
                ,ML.ACTV_FLG
                ,ML.EFF_FROM_DT
                ,ML.EFF_THRU_DT
                ,ML.BW_MTR_FLG
                ,ML.COLOR_MTR_FLG
                ,ML.TOT_MTR_FLG
                ,ML.CORP_ADVTG_FLG
                ,ML.MTR_CNTR_ID
                ,ML.INTG_MDSE_CD
                <!-- START 2018/02/05 M.Naito [QC#21184, ADD] -->
                ,ML.INV_PRINT_MTR_LB_DESC_TXT
                <!-- END 2018/02/05 M.Naito [QC#21184, ADD] -->
                ,ML.EZUPTIME
                ,ML.EZUPTIMEZONE
                <!-- START 2016/12/01 K.Kojima [QC#14204, ADD] -->
                ,ML.EZINTIME            AS XX_REC_HIST_CRAT_TS_A
                ,ML.EZINUSERID          AS XX_REC_HIST_CRAT_BY_NM_A
                ,ML.EZUPTIME            AS XX_REC_HIST_UPD_TS_A
                ,ML.EZUPUSERID          AS XX_REC_HIST_UPD_BY_NM_A
                ,ML.EZTABLEID           AS XX_REC_HIST_TBL_NM_A
                <!-- END 2016/12/01 K.Kojima [QC#14204, ADD] -->
            FROM
                MTR_LB      ML
               ,MTR_LB_TP   MT
               ,MTR_LB      MF
               ,MTR_LB      MA
            WHERE
                    ML.GLBL_CMPY_CD     =    #glblCmpyCd#
                AND ML.EZCANCELFLAG     =    '0'
                <isNotNull property="mtrLbNm">
                AND ML.MTR_LB_NM        LIKE #mtrLbNm#
                </isNotNull>
                <isNotNull property="mtrLbDescTxt">
                AND ML.MTR_LB_DESC_TXT  LIKE #mtrLbDescTxt#
                </isNotNull>
                AND ML.GLBL_CMPY_CD     = MT.GLBL_CMPY_CD
                AND ML.MTR_LB_TP_CD     = MT.MTR_LB_TP_CD
                AND MT.EZCANCELFLAG     = '0'
                AND ML.GLBL_CMPY_CD     = MF.GLBL_CMPY_CD(+)
                AND ML.FLEET_MTR_LB_CD  = MF.MTR_LB_CD   (+)
                AND MF.EZCANCELFLAG(+)  = '0'
                AND ML.GLBL_CMPY_CD     = MA.GLBL_CMPY_CD(+)
                AND ML.AGGR_MTR_LB_CD   = MA.MTR_LB_CD   (+)
                AND MA.EZCANCELFLAG(+)  = '0'
            ORDER BY
                ML.MTR_LB_SORT_NUM ASC)
        WHERE
            ROWNUM  &lt;= #limitCnt#
    </statement>
    <resultMap id="result.getSearchData"      class="NSAL1190_ASMsg">
        <result property="mtrLbCd_A"         column="MTR_LB_CD"           javaType="EZDSStringItem"/>
        <result property="mtrLbNm_A"         column="MTR_LB_NM"           javaType="EZDCStringItem"/>
        <result property="mtrLbTpCd_A"       column="MTR_LB_TP_CD"        javaType="EZDSStringItem"/>
        <result property="mtrIdxCd_A"        column="MTR_IDX_CD"          javaType="EZDSStringItem"/>
        <result property="bllgMtrLvlNum_A"   column="BLLG_MTR_LVL_NUM"    javaType="EZDCStringItem"/>
        <result property="mtrLbDescTxt_A"    column="MTR_LB_DESC_TXT"     javaType="EZDCStringItem"/>
        <result property="fleetMtrLbCd_A"    column="FLT_MTR_LB_CD"       javaType="EZDCStringItem"/>
        <result property="mtrLbNm_AF"        column="FLT_MTR_LB_NM"       javaType="EZDCStringItem"/>
        <result property="aggrMtrLbCd_A"     column="AGG_MTR_LB_CD"       javaType="EZDCStringItem"/>
        <result property="mtrLbNm_AG"        column="AGG_MTR_LB_NM"       javaType="EZDCStringItem"/>
        <result property="actvFlg_A"         column="ACTV_FLG"            javaType="EZDCStringItem"/>
        <result property="effFromDt_A"       column="EFF_FROM_DT"         javaType="EZDCStringItem"/>
        <result property="effThruDt_A"       column="EFF_THRU_DT"         javaType="EZDCStringItem"/>
        <result property="bwMtrFlg_A"        column="BW_MTR_FLG"          javaType="EZDCStringItem"/>
        <result property="colorMtrFlg_A"     column="COLOR_MTR_FLG"       javaType="EZDCStringItem"/>
        <result property="totMtrFlg_A"       column="TOT_MTR_FLG"         javaType="EZDCStringItem"/>
        <result property="corpAdvtgFlg_A"    column="CORP_ADVTG_FLG"      javaType="EZDCStringItem"/>
        <result property="mtrCntrId_A"       column="MTR_CNTR_ID"         javaType="EZDCStringItem"/>
        <result property="intgMdseCd_A"      column="INTG_MDSE_CD"        javaType="EZDCStringItem"/>
        <!-- START 2018/02/05 M.Naito [QC#21184, ADD] -->
        <result property="invPrintMtrLbDescTxt_A" column="INV_PRINT_MTR_LB_DESC_TXT" javaType="EZDCStringItem"/>
        <!-- END 2018/02/05 M.Naito [QC#21184, ADD] -->
        <result property="ezUpTime_A"        column="EZUPTIME"            javaType="EZDCStringItem"/>
        <result property="ezUpTimeZone_A"    column="EZUPTIMEZONE"        javaType="EZDCStringItem"/>
        <!-- START 2016/12/01 K.Kojima [QC#14204, ADD] -->
        <result property="xxRecHistCratTs_A"   column="XX_REC_HIST_CRAT_TS_A"    javaType="EZDSStringItem"/>
        <result property="xxRecHistCratByNm_A" column="XX_REC_HIST_CRAT_BY_NM_A" javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdTs_A"    column="XX_REC_HIST_UPD_TS_A"     javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdByNm_A"  column="XX_REC_HIST_UPD_BY_NM_A"  javaType="EZDSStringItem"/>
        <result property="xxRecHistTblNm_A"    column="XX_REC_HIST_TBL_NM_A"     javaType="EZDSStringItem"/>
        <!-- END 2016/12/01 K.Kojima [QC#14204, ADD] -->
    </resultMap>
</sqlMap>
