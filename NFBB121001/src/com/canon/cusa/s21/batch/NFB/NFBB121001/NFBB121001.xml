<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NFBB121001">

    <typeAlias alias="NFBI0250_18TMsg"           type="business.db.NFBI0250_18TMsg"/>

    <statement id="getTarget" parameterClass="Map" resultClass="Map">
        SELECT
             I06.INTERFACE_ID                  INTERFACE_ID
            ,I06.TRANSACTION_ID                TRANSACTION_ID
            ,I06.EDI_INTFC_INV_NUM             EDI_INTFC_INV_NUM
            ,I06.EDI_INTFC_INV_DT_TXT          EDI_INTFC_INV_DT_TXT
            ,I06.EDI_INTFC_PO_NUM              EDI_INTFC_PO_NUM
            ,I06.EDI_INTFC_TP_CD               EDI_INTFC_TP_CD
            ,I06.EDI_INTFC_TERM_INT_TXT_01     EDI_INTFC_TERM_INT_TXT_01
            ,I06.EDI_INTFC_INV_TXT             EDI_INTFC_INV_TXT
            ,I08.EDI_INTFC_BILL_TXT            EDI_INTFC_BILL_TXT
            ,I08.EDI_INTFC_BILL_ADDR_01        EDI_INTFC_BILL_ADDR_01
            ,I08.EDI_INTFC_BILL_ADDR_02        EDI_INTFC_BILL_ADDR_02
            ,I08.EDI_INTFC_BILL_ADDR_03        EDI_INTFC_BILL_ADDR_03
            ,I08.EDI_INTFC_BILL_ADDR_04        EDI_INTFC_BILL_ADDR_04
            ,I08.EDI_INTFC_BILL_CTY_ADDR       EDI_INTFC_BILL_CTY_ADDR
            ,I08.EDI_INTFC_BILL_ST_INT_TXT     EDI_INTFC_BILL_ST_INT_TXT
            ,I08.EDI_INTFC_BILL_PROV_TXT       EDI_INTFC_BILL_PROV_TXT
            ,I08.EDI_INTFC_BILL_CNTY_TXT       EDI_INTFC_BILL_CNTY_TXT
            ,I08.EDI_INTFC_BILL_POST_TXT       EDI_INTFC_BILL_POST_TXT
            ,I08.EDI_INTFC_BILL_CTRY_TXT       EDI_INTFC_BILL_CTRY_TXT
            
        FROM 
             NFBI0250_06 I06
            ,NFBI0250_08 I08
        WHERE
                I06.INTERFACE_ID = #interfaceId#
            
       <iterate property="trxIdList" var="trxIdList[]" open="AND I06.TRANSACTION_ID IN (" close=")" conjunction=",">
             #trxIdList[]#
       </iterate>
            AND I06.EZCANCELFLAG = '0'

            AND I06.INTERFACE_ID       = I08.INTERFACE_ID       (+)
            AND I06.TRANSACTION_ID     = I08.TRANSACTION_ID     (+)
            AND I06.EDI_INTFC_INV_NUM  = I08.EDI_INTFC_INV_NUM  (+)
            AND I08.EZCANCELFLAG    (+)= '0'
    </statement>
   
   <statement id="getTargetInvByTranId" parameterClass="Map" resultClass="Map">
        SELECT
             I06.INTERFACE_ID                  INTERFACE_ID
            ,I06.TRANSACTION_ID                TRANSACTION_ID
            ,I06.EDI_INTFC_INV_NUM             EDI_INTFC_INV_NUM
            ,I06.EDI_INTFC_INV_DT_TXT          EDI_INTFC_INV_DT_TXT
            ,I06.EDI_INTFC_PO_NUM              EDI_INTFC_PO_NUM
            ,I06.EDI_INTFC_TP_CD               EDI_INTFC_TP_CD
            ,I06.EDI_INTFC_TERM_INT_TXT_01     EDI_INTFC_TERM_INT_TXT_01
            ,I06.EDI_INTFC_INV_TXT             EDI_INTFC_INV_TXT
        FROM 
             NFBI0250_06 I06
           
        WHERE
                I06.INTERFACE_ID = #interfaceId#
            
            AND I06.TRANSACTION_ID = #trxId#
            AND I06.EZCANCELFLAG = '0'
    </statement>
   
    <statement id="countTargetByInv" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             count(*)
        FROM 
             NFBI0250_06 I06
           
        WHERE
                I06.INTERFACE_ID        = #interfaceId#
            AND I06.TRANSACTION_ID      = #trxId#
            AND I06.EDI_INTFC_INV_NUM   = #invNum#
            AND I06.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getTargetI08" parameterClass="Map" resultClass="Map">
        SELECT
             I08.EDI_INTFC_BILL_TXT            EDI_INTFC_BILL_TXT
            ,I08.EDI_INTFC_BILL_ADDR_01        EDI_INTFC_BILL_ADDR_01
            ,I08.EDI_INTFC_BILL_ADDR_02        EDI_INTFC_BILL_ADDR_02
            ,I08.EDI_INTFC_BILL_ADDR_03        EDI_INTFC_BILL_ADDR_03
            ,I08.EDI_INTFC_BILL_ADDR_04        EDI_INTFC_BILL_ADDR_04
            ,I08.EDI_INTFC_BILL_CTY_ADDR       EDI_INTFC_BILL_CTY_ADDR
            ,I08.EDI_INTFC_BILL_ST_INT_TXT     EDI_INTFC_BILL_ST_INT_TXT
            ,I08.EDI_INTFC_BILL_PROV_TXT       EDI_INTFC_BILL_PROV_TXT
            ,I08.EDI_INTFC_BILL_CNTY_TXT       EDI_INTFC_BILL_CNTY_TXT
            ,I08.EDI_INTFC_BILL_POST_TXT       EDI_INTFC_BILL_POST_TXT
            ,I08.EDI_INTFC_BILL_CTRY_TXT       EDI_INTFC_BILL_CTRY_TXT
        FROM 
             NFBI0250_08 I08
           
        WHERE
                I08.INTERFACE_ID        = #interfaceId#
            AND I08.TRANSACTION_ID      = #trxId#
            AND I08.EDI_INTFC_INV_NUM   = #invNum#
            AND I08.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getSumFreightAmt" parameterClass="Map" resultClass="Map">
        SELECT  
             SUM(I18.EDI_INTFC_INV_PRC_TXT) EDI_INTFC_INV_PRC_TXT 
        FROM 
            NFBI0250_18 I18 
        WHERE
                I18.INTERFACE_ID                = #interfaceId#
            AND I18.TRANSACTION_ID              = #trxId#
            AND I18.EDI_INTFC_INV_NUM           = #invNum#
            AND I18.EDI_INTFC_ITEM_LINE_TP_CD   = #lineTpCd#
            AND I18.EZCANCELFLAG                = '0'

    </statement>

    <resultMap id="result.getTargetNfbi0250_18" class="NFBI0250_18TMsg">
        <result property="ediIntfcItemCd"       column="EDI_INTFC_ITEM_CD"      javaType="EZDTStringItem"/>
        <result property="ediIntfcInvCd"        column="EDI_INTFC_INV_CD"       javaType="EZDTStringItem"/>
        <result property="ediIntfcPoLineNum"    column="EDI_INTFC_PO_LINE_NUM"  javaType="EZDTStringItem"/>
        <result property="ediIntfcInvNum"       column="EDI_INTFC_INV_NUM"      javaType="EZDTStringItem"/>
        <result property="ediIntfcUnitPrcTxt"   column="EDI_INTFC_UNIT_PRC_TXT" javaType="EZDTStringItem"/>
        <result property="ediIntfcInvPrcTxt"    column="EDI_INTFC_INV_PRC_TXT"  javaType="EZDTStringItem"/>
    </resultMap>
    <statement id="getTargetNfbi0250_18" parameterClass="Map" resultMap="result.getTargetNfbi0250_18">
          
        SELECT
             I.EDI_INTFC_ITEM_CD
            ,I.EDI_INTFC_INV_CD
            ,I.EDI_INTFC_PO_LINE_NUM
            ,I.EDI_INTFC_INV_NUM
            ,I.EDI_INTFC_UNIT_PRC_TXT
            ,I.EDI_INTFC_INV_PRC_TXT
        FROM
            NFBI0250_18 I
        WHERE
                I.INTERFACE_ID              = #interfaceId#
            AND I.TRANSACTION_ID            = #trxId#
            AND I.EDI_INTFC_INV_NUM         = #invNum#
            AND I.EDI_INTFC_ITEM_LINE_TP_CD &lt;&gt; #lineTpCd#
            AND I.EZCANCELFLAG = '0'
    </statement>

</sqlMap>