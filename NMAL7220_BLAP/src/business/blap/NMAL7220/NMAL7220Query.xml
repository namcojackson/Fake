<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAL7220Query">

    <statement id="search" parameterClass="Map" resultClass="Map">
        SELECT
             PM.PRC_FMLA_NM
            ,PM.PRC_FMLA_DESC_TXT
            ,PM.EFF_FROM_DT
            ,PM.EFF_THRU_DT
            ,PM.ACTV_FLG
            ,PMT.PRC_FMLA_TP_CD
            ,CASE
             WHEN PMT.PRC_FMLA_TP_CD = #prcFmlaTpCd#
             THEN
                 (
                  SELECT
                      PC.PRC_CATG_NM
                  FROM
                      PRC_CATG PC
                  WHERE
                      PC.PRC_CATG_CD = PM.PRC_CATG_CD
                  AND
                      PC.GLBL_CMPY_CD    = #glblCmpyCd#
                  AND
                      PC.EZCANCELFLAG    = '0'
                 )
             ELSE ''
             END AS "PRC_CATG_NM"
            ,PM.PRC_CATG_CD
            ,PM.PRC_FMLA_OP_CD
            ,PM.PRC_FMLA_NUM
            ,PFT.PRC_FUNC_TP_CD
            ,PM.EZUPTIME
            ,PM.EZUPTIMEZONE
        FROM
             PRC_FMLA PM
            ,PRC_FMLA_TP PMT
            ,PRC_FMLA_OP PFO
            ,PRC_FUNC_TP PFT
        WHERE
            PM.GLBL_CMPY_CD    = #glblCmpyCd#
        AND
            PM.EZCANCELFLAG    = '0'
        AND
            PM.GLBL_CMPY_CD    = PMT.GLBL_CMPY_CD(+)
        AND
            PM.EZCANCELFLAG    = PMT.EZCANCELFLAG(+)
        AND
            PM.GLBL_CMPY_CD    = PFO.GLBL_CMPY_CD(+)
        AND
            PM.EZCANCELFLAG    = PFO.EZCANCELFLAG(+)
        AND
            PM.GLBL_CMPY_CD    = PFT.GLBL_CMPY_CD(+)
        AND
            PM.EZCANCELFLAG    = PFT.EZCANCELFLAG(+)
        AND
            PM.PRC_FMLA_TP_CD  = PMT.PRC_FMLA_TP_CD(+)
        AND
            PM.PRC_FMLA_OP_CD  = PFO.PRC_FMLA_OP_CD(+)
        AND
            PM.PRC_FUNC_TP_CD  = PFT.PRC_FUNC_TP_CD(+)
        AND
            PM.PRC_FMLA_PK     = #prcFmlaPk#
    </statement>

    <statement id="isExistFmlaNm" parameterClass="Map" resultClass="String">
        SELECT
            'Y' EXIST_FLG
        FROM
            PRC_FMLA PM
        WHERE
            PM.GLBL_CMPY_CD   = #glblCmpyCd#
        AND
            PM.EZCANCELFLAG   = '0'
        AND
            PM.PRC_FMLA_NM = #prcFmlaNm#
        <isNotNull property="prcFmlaPk">
        AND
            PM.PRC_FMLA_PK &lt;&gt; #prcFmlaPk#
        </isNotNull>
    </statement>

    <statement id="isExistPriceList" parameterClass="Map" resultClass="String">
        SELECT
            PC.PRC_CATG_CD
        FROM
             PRC_CATG PC
            ,PRC_LIST_TP PLT
            ,PRC_LIST_STRU_TP PLST
        WHERE
            PC.GLBL_CMPY_CD            = #glblCmpyCd#
        AND
            PC.EZCANCELFLAG            = '0'
        AND
            PC.PRC_CATG_NM             = #prcCatgNm#
        AND
            PC.PRC_LIST_TP_CD          = PLT.PRC_LIST_TP_CD
        AND
            PC.GLBL_CMPY_CD            = PLT.GLBL_CMPY_CD
        AND
            PC.EZCANCELFLAG            = PLT.EZCANCELFLAG
        AND
            PLT.GLBL_CMPY_CD           = PLST.GLBL_CMPY_CD
        AND
            PLT.EZCANCELFLAG           = PLST.EZCANCELFLAG
        AND
            PLT.PRC_LIST_TP_CD         = PLST.PRC_LIST_STRU_TP_CD
        AND
            PLST.PRC_LIST_STRU_TP_CD   = #prcListTpCd#
     </statement>
</sqlMap>
