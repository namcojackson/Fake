<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NLZC206001">
    <!-- ==== Type Aliases -->
    <!-- ==== Result Mapping ==== -->

    <statement id="getDestInvtyLocNm" parameterClass="Map" resultClass = "String">
        SELECT
            DILV.INVTY_LOC_NM
        FROM
            DS_INVTY_LOC_V DILV
        WHERE
            DILV.GLBL_CMPY_CD = #glblCmpyCd#
        AND DILV.INVTY_LOC_CD = #invtyLocCd#
        AND DILV.EZCANCELFLAG = '0'
    </statement>

    <statement id="getSrcOrdNum" parameterClass="Map" resultClass = "String">
        SELECT
            DH.SRC_ORD_NUM
        FROM
            RWS_HDR DH
        WHERE
            DH.GLBL_CMPY_CD     = #glblCmpyCd#
        AND DH.RWS_NUM          = #rwsNum#
        AND DH.EZCANCELFLAG     = '0'
    </statement>

    <!-- QC#25198 Add -->
    <statement id="expenseOutItem" parameterClass="Map" resultClass="String">
        SELECT
           MDSE.PRT_ITEM_TP_CD
        FROM
           ALL_MDSE_V MDSE
        WHERE 1=1
        AND MDSE.GLBL_CMPY_CD     = #glblCmpyCd#
        AND MDSE.MDSE_CD          = #mdseCd#
        AND MDSE.EZCANCELFLAG     = '0'
    </statement>

    <!-- QC#25198 Add -->
    <statement id="expenseOutLocTp" parameterClass="Map" resultClass="String">
        SELECT
           ILV.INVTY_LOC_TP_CD
        FROM
           INVTY_LOC_V ILV
        WHERE 1=1
        AND ILV.GLBL_CMPY_CD     = #glblCmpyCd#
        AND ILV.INVTY_LOC_CD     = #invtyLocCd#
        AND ILV.EZCANCELFLAG     = '0'
    </statement>

     <!-- QC#12110 Add SQL -->
    <statement id="getRcvOrdNumList" parameterClass="Map" resultClass="Map">
         SELECT
            RWSH.RWS_NUM
           ,RWSH.RWS_REF_NUM
           ,RWSH.SCE_ORD_TP_CD
           ,RWSD.RWS_DTL_LINE_NUM
           ,RWSD.MDSE_CD
           ,RWSD.RWS_QTY
           ,RWSD.INVTY_LOC_CD
           ,RCVD.PO_RCV_NUM
           ,RCVD.PO_RCV_LINE_NUM
           ,NVL(PR.RQST_TECH_TOC_CD, RWSH.WH_CD)    AS RQST_TECH_TOC_CD
           ,PR.PRCH_REQ_NUM
           ,IOD.INVTY_ORD_NUM
           ,IOD.INVTY_ORD_LINE_NUM
           ,PD.PO_ORD_NUM
           ,PD.PO_ORD_DTL_LINE_NUM
        FROM
            RWS_HDR       RWSH
           ,RWS_DTL       RWSD
           ,PO_RCV_DTL    RCVD
           ,PRCH_REQ      PR
           ,INVTY_ORD_DTL IOD
           ,PO_DTL        PD
        WHERE
            RWSD.GLBL_CMPY_CD          = #glblCmpyCd#
        AND RWSD.RWS_NUM               = #rwsNum#
        AND RWSD.RWS_DTL_LINE_NUM      = #rwsDtlLineNum#
        AND RWSD.EZCANCELFLAG          = '0'
        AND RWSD.RWS_NUM               = RWSH.RWS_NUM
        AND RWSH.EZCANCELFLAG          = '0'
        AND RCVD.PRCH_REQ_NUM          = RWSD.PRCH_REQ_NUM
        AND RCVD.PRCH_REQ_LINE_NUM     = RWSD.PRCH_REQ_LINE_NUM
        AND RCVD.PRCH_REQ_LINE_SUB_NUM = RWSD.PRCH_REQ_LINE_SUB_NUM
        AND RCVD.EZCANCELFLAG          = '0'
        AND PR.PRCH_REQ_NUM            = RWSD.PRCH_REQ_NUM
        AND PR.EZCANCELFLAG            = '0'
        AND RWSD.PRCH_REQ_NUM          = IOD.PRCH_REQ_NUM (+)
        AND RWSD.PRCH_REQ_LINE_NUM     = IOD.PRCH_REQ_LINE_NUM (+)
        AND RWSD.PRCH_REQ_LINE_SUB_NUM = IOD.PRCH_REQ_LINE_SUB_NUM (+)
        AND IOD.EZCANCELFLAG (+)       = '0'
        AND RWSD.PRCH_REQ_NUM          = PD.PRCH_REQ_NUM (+)
        AND RWSD.PRCH_REQ_LINE_NUM     = PD.PRCH_REQ_LINE_NUM (+)
        AND RWSD.PRCH_REQ_LINE_SUB_NUM = PD.PRCH_REQ_LINE_SUB_NUM (+)
        AND PD.EZCANCELFLAG (+)        = '0'
    </statement>
<!-- START 2019/09/25 M.Naito [QC#53695,ADD] -->
    <statement id="getRcvOrdNumListFromPO" parameterClass="Map" resultClass="Map">
        SELECT
            RWSH.RWS_NUM
           ,RWSH.RWS_REF_NUM
           ,RWSH.SCE_ORD_TP_CD
           ,RWSD.RWS_DTL_LINE_NUM
           ,RWSD.MDSE_CD
           ,RWSD.RWS_QTY
           ,RWSD.INVTY_LOC_CD
           ,RCVD.PO_RCV_NUM
           ,RCVD.PO_RCV_LINE_NUM
           ,NVL(PO.RQST_TECH_TOC_CD, RWSH.WH_CD)    AS RQST_TECH_TOC_CD
           ,PD.PO_ORD_NUM
           ,PD.PO_ORD_DTL_LINE_NUM
        FROM
            RWS_HDR       RWSH
           ,RWS_DTL       RWSD
           ,PO_RCV_HDR    RCVH
           ,PO_RCV_DTL    RCVD
           ,PO            PO
           ,PO_DTL        PD
        WHERE
            RWSD.GLBL_CMPY_CD          = #glblCmpyCd#
        AND RWSD.RWS_NUM               = #rwsNum#
        AND RWSD.RWS_DTL_LINE_NUM      = #rwsDtlLineNum#
        AND RWSD.EZCANCELFLAG          = '0'
        AND RWSD.RWS_NUM               = RWSH.RWS_NUM
        AND RWSH.EZCANCELFLAG          = '0'
        AND RWSH.PO_RCV_TRX_HDR_NUM    = RCVH.PO_RCV_TRX_HDR_NUM
        AND RCVH.EZCANCELFLAG          = '0'
        AND RCVH.PO_RCV_NUM            = RCVD.PO_RCV_NUM
        AND RWSD.PO_RCV_TRX_LINE_NUM   = RCVD.PO_RCV_TRX_LINE_NUM
        AND RCVD.EZCANCELFLAG          = '0'
        AND RCVH.PO_RCV_TRX_HDR_NUM    = PD.PO_ORD_NUM
        AND RWSD.TRX_LINE_NUM          = PD.PO_ORD_DTL_LINE_NUM
        AND PD.EZCANCELFLAG            = '0'
        AND PD.PO_ORD_NUM              = PO.PO_ORD_NUM
        AND PO.EZCANCELFLAG            = '0'
    </statement>
<!-- END 2019/09/25 M.Naito [QC#53695,ADD] -->
</sqlMap>
