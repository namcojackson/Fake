<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="ZZZL0030Query">

	<statement id="getData" parameterClass="Map" resultClass="Map">
	SELECT	*
	FROM	(
	        SELECT  GLBL_CMPY_CD,
	        		OPS_USR_ID,
	        		JVM_NM,
	        		BIZ_ID,
	        		SCR_APP_ID,
	        		OPS_TS,
	        		BIZ_ELPS_TM_TXT,
	        		GLBL_AREA_DATA_CNT       		
	        FROM    ONL_PROC_LOG
	        WHERE   EZCANCELFLAG  = '0'
	        AND		(SUBSTR(ERR_MSG_CD, LENGTH(ERR_MSG_CD),1) != 'E' OR ERR_MSG_CD IS NULL)
	        <!--  AND		(REGEXP_LIKE (ERR_MSG_CD, '[^E]$$') OR ERR_MSG_CD IS NULL)-->
	        <iterate property="scrAppId" var="scrAppId[]" open="and (" close=")" conjunction="or">
					SCR_APP_ID = #scrAppId[]#
			</iterate>
	        <isNotNull property="jvmNm">
	        AND     JVM_NM        = #jvmNm#
	        </isNotNull>
	        <isNotNull property="glblCmpyCd">
	        AND     GLBL_CMPY_CD  = #glblCmpyCd#
	        </isNotNull>
	        <isNotNull property="opsUsrId">
	        AND     OPS_USR_ID    = #opsUsrId#
	        </isNotNull>
	        <isNotNull property="bizStartTs">
			AND 	OPS_TS 		  &gt;= #bizStartTs#
			</isNotNull>
			<isNotNull property="bizEndTs">
			AND 	OPS_TS 		  &lt;= #bizEndTs#
			</isNotNull>
	        ORDER BY
	        	BIZ_ID ASC,
	        	SCR_APP_ID ASC,
	        	OPS_TS ASC
	        )
	WHERE	ROWNUM &lt;= 30001
	</statement>
	
	<statement id="getJvmNm" parameterClass="Map" resultClass="Map">
        SELECT  JVM_NM    		
        FROM    ONL_PROC_CONFIG
        WHERE   EZCANCELFLAG  = '0'
        AND     GLBL_CMPY_CD  = #cMsg.glblCmpyCd#
        ORDER BY
        	JVM_NM ASC
	</statement>
</sqlMap>