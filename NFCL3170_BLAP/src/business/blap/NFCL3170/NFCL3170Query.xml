<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NFCL3170Query">
    <!-- *********************************************************** -->
    <!-- ********** Bean Definition ******************************** -->
    <!-- *********************************************************** -->
    <typeAlias alias="NFCL3170CMsg"     type="business.blap.NFCL3170.NFCL3170CMsg"/>
    <typeAlias alias="NFCL3170_ACMsg"   type="business.blap.NFCL3170.NFCL3170_ACMsg"/>

    <statement id="getDsBankPullDownList" parameterClass="Map" resultClass="Map">
        SELECT
             A.DS_BANK_CD
            ,A.DS_BANK_NM
        FROM
                DS_BANK A
        WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.EZCANCELFLAG  = '0'
        ORDER BY
            A.DS_BANK_SORT_NUM
    </statement>

    <statement id="getDsBankBrPullDownList" parameterClass="Map" resultClass="Map">
        SELECT
             A.BANK_RTE_NUM
            ,A.DS_BANK_BR_NM
        FROM
                DS_BANK_BR A
        WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.DS_BANK_CD    = #dsBankCd#
            AND A.EZCANCELFLAG  = '0'
        ORDER BY
            A.BANK_RTE_NUM
    </statement>

    <statement id="getArRcptSrcPullDownList" parameterClass="Map" resultClass="Map">
        SELECT
                 SRC.AR_RCPT_SRC_CD
                ,SRC.AR_RCPT_SRC_NM
        FROM
                AR_RCPT_SRC SRC
        WHERE
                SRC.GLBL_CMPY_CD              =   #glblCmpyCd#
            AND SRC.EZCANCELFLAG              =  '0'
        ORDER BY
                AR_RCPT_SRC_SORT_NUM
    </statement>

    <statement id="getArLockBoxPullDownList" parameterClass="Map" resultClass="Map">
        SELECT
                 A.AR_LOCK_BOX_CD
                ,A.AR_LOCK_BOX_NM
        FROM
                AR_LOCK_BOX A
        WHERE
                A.GLBL_CMPY_CD              =   #glblCmpyCd#
            AND A.EZCANCELFLAG              =  '0'
        ORDER BY
                AR_LOCK_BOX_SORT_NUM
    </statement>

    <statement id="getCcyPullDownList" parameterClass="Map" resultClass="Map">
        SELECT
             A.CCY_CD
            ,A.CCY_NM
        FROM
                CCY A
        WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.EZCANCELFLAG  = '0'
        ORDER BY
            A.CCY_SORT_NUM
    </statement>

    <statement id="getCntyPullDownList" parameterClass="Map" resultClass="Map">
        SELECT
             A.CNTY_PK
            ,A.CNTY_NM
        FROM
                CNTY A
        WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.EZCANCELFLAG  = '0'
        ORDER BY
            A.CNTY_PK
    </statement>

    <statement id="getCtryPullDownList" parameterClass="Map" resultClass="Map">
        SELECT
             A.CTRY_CD
            ,A.CTRY_NM
        FROM
                CTRY A
        WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.EZCANCELFLAG  = '0'
            AND A.CTRY_VIS_FLG  = 'Y'
        ORDER BY
            A.CTRY_SORT_NUM
    </statement>

    <statement id="getStPullDownList" parameterClass="Map" resultClass="Map">
        SELECT
             A.ST_CD
            ,A.ST_NM
        FROM
                ST A
        WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.EZCANCELFLAG  = '0'
            AND A.CTRY_CD       = 'US'
        ORDER BY
            A.ST_SORT_NUM
    </statement>

    <statement id="getDsAcctCustPK" parameterClass="Map" resultClass="String">
        SELECT
                ACCT.SELL_TO_CUST_PK
        FROM
                SELL_TO_CUST ACCT
        WHERE
                ACCT.GLBL_CMPY_CD   = #glblCmpyCd#
            AND ACCT.EZCANCELFLAG   = '0'
            AND ACCT.SELL_TO_CUST_CD= #dsAcctNum#
            AND ROWNUM          &lt;=   $rowNum$
    </statement>

    <statement id="getCntyPK" parameterClass="Map" resultClass="String">
        SELECT
                A.CNTY_PK
        FROM
                CNTY    A
        WHERE
                A.GLBL_CMPY_CD  = #glblCmpyCd#
            AND A.EZCANCELFLAG  = '0'
            AND A.CNTY_NM       = #cntyNm#
            AND ROWNUM      &lt;= $rowNum$
    </statement>

    <statement id="searchDsCustBankAcctReln" parameterClass="Map" resultMap="result.searchDsCustBankAcctReln">
        SELECT
             A.DS_CUST_BANK_ACCT_RELN_PK    AS DS_CUST_BANK_ACCT_RELN_PK_A1
            ,B.SELL_TO_CUST_CD              AS DS_ACCT_NUM_A1
            ,B.DS_ACCT_NM                   AS DS_ACCT_NM_A1
            ,A.EFF_FROM_DT                  AS EFF_FROM_DT_A1
            ,A.EFF_THRU_DT                  AS EFF_THRU_DT_A1
            ,A.DS_ACCT_CUST_PK              AS DS_ACCT_CUST_PK_A1
            ,A.LOC_NUM                      AS LOC_NUM_A1
        FROM
             DS_CUST_BANK_ACCT_RELN A
            ,SELL_TO_CUST           B
        WHERE
                A.GLBL_CMPY_CD      = #glblCmpyCd#
            AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD
            AND A.DS_BANK_ACCT_PK   = #dsBankAcctPk#
            AND A.DS_ACCT_CUST_PK   = B.SELL_TO_CUST_PK
            AND A.EZCANCELFLAG      = '0'
            AND B.EZCANCELFLAG      = '0'
         ORDER BY
             B.SELL_TO_CUST_CD
            ,A.EFF_FROM_DT
    </statement>
    <resultMap id="result.searchDsCustBankAcctReln" class="NFCL3170_ACMsg">
        <result property="dsCustBankAcctRelnPk_A1"  column="DS_CUST_BANK_ACCT_RELN_PK_A1"   javaType="EZDSBigDecimalItem" />
        <result property="dsAcctNum_A1"             column="DS_ACCT_NUM_A1"                 javaType="EZDSStringItem" />
        <result property="dsAcctNm_A1"              column="DS_ACCT_NM_A1"                  javaType="EZDSStringItem" />
        <result property="effFromDt_A1"             column="EFF_FROM_DT_A1"                 javaType="EZDSStringItem" />
        <result property="effThruDt_A1"             column="EFF_THRU_DT_A1"                 javaType="EZDSStringItem" />
        <result property="dsAcctCustPk_A1"          column="DS_ACCT_CUST_PK_A1"             javaType="EZDSBigDecimalItem" />
        <result property="locNum_A1"                column="LOC_NUM_A1"                     javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getDsBankAcct" parameterClass="Map" resultClass="Map">
        SELECT
            A.DS_BANK_ACCT_NUM
        FROM
            DS_BANK_ACCT    A
        WHERE
                A.GLBL_CMPY_CD      = #glblCmpyCd#
            AND A.DS_BANK_ACCT_NUM  = #dsBankAcctNum#
            AND A.BANK_RTE_NUM      = #bankRteNum#
            AND A.EZCANCELFLAG      = '0'
    </statement>

    <statement id="searchDsBankInfo" parameterClass="Map" resultMap="result.searchDsBankInfo">
        SELECT
             A.DS_BANK_ACCT_NM                  AS DS_BANK_ACCT_NM_H1
            ,A.DS_BANK_ACCT_NUM                 AS DS_BANK_ACCT_NUM_H1
            ,A.DS_BANK_ACCT_TP_CD               AS DS_BANK_ACCT_TP_CD_H1
            ,A.EFF_FROM_DT                      AS EFF_FROM_DT_H1
            ,A.EFF_THRU_DT                      AS EFF_THRU_DT_H1
            ,B.DS_BANK_BR_PK                    AS DS_BANK_BR_PK_H1
            ,B.DS_BANK_BR_NM                    AS DS_BANK_BR_NM_H1
            ,B.BANK_RTE_NUM                     AS BANK_RTE_NUM_H1
            ,B.FIRST_LINE_ADDR                  AS FIRST_LINE_ADDR_H1
            ,B.SCD_LINE_ADDR                    AS SCD_LINE_ADDR_H1
            ,B.CTY_ADDR                         AS CTY_ADDR_H1
            ,B.CNTY_PK                          AS CNTY_PK_H1
            ,B.ST_CD                            AS ST_CD_H1
            ,B.POST_CD                          AS POST_CD_H1
            ,C.CNTY_NM                          AS CNTY_NM_H1
        FROM
             DS_BANK_ACCT             A
            ,DS_BANK_BR               B
            ,CNTY                     C
        WHERE
                    A.GLBL_CMPY_CD      = #glblCmpyCd#
                AND A.DS_BANK_ACCT_PK   = #dsBankAcctPk#
                AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD
                AND ((A.BANK_RTE_NUM    = B.BANK_RTE_NUM)
                     OR
                     (A.BANK_RTE_NUM IS NULL AND B.BANK_RTE_NUM IS NULL)
                )
                AND A.DS_BANK_BR_PK     = B.DS_BANK_BR_PK
                AND A.EZCANCELFLAG      = '0'
                AND B.EZCANCELFLAG      = '0'
                
                AND B.GLBL_CMPY_CD      = C.GLBL_CMPY_CD (+)
                AND B.CNTY_PK           = C.CNTY_PK (+)
                AND C.EZCANCELFLAG (+)  = '0'

    </statement>
    <resultMap id="result.searchDsBankInfo" class="NFCL3170CMsg">
        <result property="dsBankAcctNm_H1"                  column="DS_BANK_ACCT_NM_H1"             javaType="EZDCStringItem" />
        <result property="dsBankAcctNum_H1"                 column="DS_BANK_ACCT_NUM_H1"            javaType="EZDCStringItem" />
        <result property="dsBankAcctTpCd_H1"                column="DS_BANK_ACCT_TP_CD_H1"          javaType="EZDCStringItem" />
        <result property="effFromDt_H1"                     column="EFF_FROM_DT_H1"                 javaType="EZDCStringItem" />
        <result property="effThruDt_H1"                     column="EFF_THRU_DT_H1"                 javaType="EZDCStringItem" />
        <result property="dsBankBrPk_H1"                    column="DS_BANK_BR_PK_H1"               javaType="EZDCBigDecimalItem" />
        <result property="dsBankBrNm_H1"                    column="DS_BANK_BR_NM_H1"               javaType="EZDCStringItem" />
        <result property="bankRteNum_H1"                    column="BANK_RTE_NUM_H1"                javaType="EZDCStringItem" />
        <result property="firstLineAddr_H1"                 column="FIRST_LINE_ADDR_H1"             javaType="EZDCStringItem" />
        <result property="scdLineAddr_H1"                   column="SCD_LINE_ADDR_H1"               javaType="EZDCStringItem" />
        <result property="ctyAddr_H1"                       column="CTY_ADDR_H1"                    javaType="EZDCStringItem" />
        <result property="cntyPk_H1"                        column="CNTY_PK_H1"                     javaType="EZDCStringItem" />
        <result property="stCd_H1"                          column="ST_CD_H1"                       javaType="EZDCStringItem" />
        <result property="postCd_H1"                        column="POST_CD_H1"                     javaType="EZDCStringItem" />
        <result property="cntyNm_H1"                        column="CNTY_NM_H1"                     javaType="EZDCStringItem" />

    </resultMap>
    
    <statement id="checkDsBankAcct" parameterClass="Map" resultClass="Map">
        SELECT
            A.DS_BANK_ACCT_NUM
        FROM
            DS_BANK_ACCT    A
        WHERE
                A.GLBL_CMPY_CD      = #glblCmpyCd#
        <isNotNull property="dsBankAcctNum">
            AND A.DS_BANK_ACCT_NUM  = #dsBankAcctNum#
        </isNotNull>
        <isNotNull property="dsBankAcctNm">
            AND A.DS_BANK_ACCT_NM   = #dsBankAcctNm#
        </isNotNull>
        <isNotNull property="bankRteNum">
            AND A.BANK_RTE_NUM      = #bankRteNum#
        </isNotNull>
        <!-- START 2016/04/27 S.Fujita [QC#5743,MOD] -->
        <isNull property="bankRteNum">
            AND A.BANK_RTE_NUM      IS NULL
        </isNull>
        <!-- END 2016/04/27 S.Fujita [QC#5743,MOD] -->
            AND A.EZCANCELFLAG      = '0'
    </statement>

    <!-- START 2016/04/27 S.Fujita [QC#5743,MOD] -->
    <!--
    <statement id="checkDsBankBr" parameterClass="Map" resultClass="Map">
        SELECT
            A.BANK_RTE_NUM
        FROM
            DS_BANK_BR    A
        WHERE
                A.GLBL_CMPY_CD      = #glblCmpyCd#
            AND A.BANK_RTE_NUM      = #bankRteNum#
            AND A.EZCANCELFLAG      = '0'
    </statement>
    -->
    <!-- END 2016/04/27 S.Fujita [QC#5743,MOD] -->
    
    <!-- START 2023/02/07 R.Takau [QC#55645,ADD]-->
    <statement id="getAccountInfo" parameterClass="Map" resultClass="Map">
         SELECT
             B.SELL_TO_CUST_CD
            ,B.DS_ACCT_NM
            ,A.LOC_NUM
            ,B.SELL_TO_CUST_PK
         FROM
             BILL_TO_CUST A
            ,SELL_TO_CUST B
         WHERE
                A.GLBL_CMPY_CD     = #glblCmpyCd#
            AND A.EZCANCELFLAG     = '0'
            AND A.BILL_TO_CUST_CD  = #billToCustCd#
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.SELL_TO_CUST_CD  = B.SELL_TO_CUST_CD
            AND B.EZCANCELFLAG     = '0'
    </statement>
    <!-- END 2023/02/07 R.Takau [QC#55645,ADD]-->
</sqlMap>
