<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB230001">

     <statement id="getPersonForInsert" parameterClass="Map" resultClass="Map">

      SELECT
           HPI.GLBL_CMPY_CD
         , HPI.HR_PSN_INTFC_EMP_ID
         , HPI.HR_PSN_INTFC_PSN_NM
         , HPI.HR_PSN_EMP_CNSLT_TP_CD
         , HPI.HR_PSN_INTFC_EMP_STS_CD
         , HPI.HR_PSN_INTFC_STS_DESC_TXT
         , HPI.HR_PSN_INTFC_CMPY_CD
         , HPI.HR_PSN_INTFC_CMPY_NM
         , HPI.HR_PSN_INTFC_DIV_CD
         , HPI.HR_PSN_INTFC_DIV_NM
         , HPI.HR_PSN_INTFC_GRP_CD
         , HPI.HR_PSN_INTFC_GRP_NM
         , HPI.HR_PSN_INTFC_JOB_CD
         , HPI.HR_PSN_INTFC_JOB_TTL_NM
         , HPI.HR_PSN_INTFC_RG_ESTB_ID
         , HPI.HR_PSN_WRK_TEL_NUM
         , HPI.HR_PSN_INTFC_EML_ADDR
         , HPI.HR_PSN_INTFC_MGR_LVL_NUM
         , HPI.HR_PSN_INTFC_REG_TEMP_TP_CD
         , HPI.HR_PSN_INTFC_DEPT_ID
         , HPI.HR_PSN_INTFC_DEPT_NM
         , HPI.HR_PSN_INTFC_COA_ACCT_CD
         , HPI.HR_PSN_INTFC_CC_NM
         , HPI.HR_PSN_INTFC_SUPV_ID
         , HPI.HR_PSN_INTFC_SUPV_NM
         , HPI.HR_PSN_INTFC_SLS_TP_CD
         , HPI.HR_PSN_INTFC_SUPV_EML_ADDR
         , HPI.HR_PSN_INTFC_PSN_FIRST_NM
         , HPI.HR_PSN_INTFC_PSN_LAST_NM
         , HPI.HR_PSN_INTFC_RUN_DT
         , HPI.HR_PSN_WRK_TEL_EXT_NUM
         , HPI.HR_PSN_INTFC_FAX_NUM
         , HPI.HR_PSN_INTFC_CELL_TEL_NUM
         , HPI.HR_PSN_INTFC_PSN_MID_NM
         , HPI.HR_PSN_INTFC_MGR_LVL_TXT
         , HPI.HR_PSN_INTFC_HIRE_DT
         , HPI.HR_PSN_INTFC_SSN_LAST4_NUM
         , HPI.HR_PSN_INTFC_RG_ESTB_TXT
         , HPI.HR_PSN_INTFC_LOC_CD
         , HPI.HR_PSN_INTFC_LOC_DESC_TXT
         , HPI.HR_PSN_INTFC_EXPAT_IND
         , HPI.HR_PSN_EEO4_FUNC_TP_CD
         , HPI.HR_PSN_INTFC_FC_BLDG_CD
         , HPI.HR_PSN_INTFC_JOB_GRP_TP_CD
         , HPI.HR_PSN_INTFC_WRK_TM_TP_CD
         , HPI.HR_PSN_INTFC_LOC_CTY_NM
         , HPI.HR_PSN_INTFC_LOC_ST_CD
         , HPI.HR_PSN_INTFC_SUB_DIV_CD
         , HPI.HR_PSN_INTFC_SUB_DIV_NM
         , HPI.HR_PSN_INTFC_SUB_GRP_CD
         , HPI.HR_PSN_INTFC_SUB_GRP_NM
         , HPI.HR_PSN_INTFC_DATA_SRC_CD
         , HPI.HR_PSN_INTFC_WRK_END_DT
         <!-- QC#1988 -->
         , HPI.HR_PSN_ARCS_COA_CMPY_CD
         , HPI.HR_PSN_ARCS_COA_EXTN_CD
         , HPI.HR_PSN_ARCS_COA_BR_CD
         , HPI.HR_PSN_ARCS_COA_CC_CD

      FROM
          HR_PSN_INTFC HPI

      WHERE
          HPI.HR_PSN_INTFC_CMPY_CD    = #hrPsnIntfcCmpyCd#
      AND HPI.EZCANCELFLAG            = '0'
      AND HPI.HR_PSN_INTFC_EMP_STS_CD = #hrPsnIntfcEmpStsCd#
      AND HPI.GLBL_CMPY_CD            = #glblCmpyCd#

      AND NOT EXISTS (
          SELECT 
              *
          FROM
             S21_PSN      SP

          WHERE
              SP.GLBL_CMPY_CD         = #glblCmpyCd#
          AND SP.EZCANCELFLAG         = '0'
          AND HPI.HR_PSN_INTFC_EMP_ID = SP.PSN_CD
      )
      <!-- QC#1988 -->
      AND HR_PSN_INTFC_EMP_ID NOT LIKE #mailBoxEmpIdPrefix#

     </statement>
     
     <statement id="getPersonForUpDateOrTerminate" parameterClass="Map" resultClass="Map">

      SELECT
           HPI.GLBL_CMPY_CD
         , HPI.HR_PSN_INTFC_EMP_ID
         , HPI.HR_PSN_INTFC_PSN_NM
         , HPI.HR_PSN_EMP_CNSLT_TP_CD
         , HPI.HR_PSN_INTFC_EMP_STS_CD
         , HPI.HR_PSN_INTFC_STS_DESC_TXT
         , HPI.HR_PSN_INTFC_CMPY_CD
         , HPI.HR_PSN_INTFC_CMPY_NM
         , HPI.HR_PSN_INTFC_DIV_CD
         , HPI.HR_PSN_INTFC_DIV_NM
         , HPI.HR_PSN_INTFC_GRP_CD
         , HPI.HR_PSN_INTFC_GRP_NM
         , HPI.HR_PSN_INTFC_JOB_CD
         , HPI.HR_PSN_INTFC_JOB_TTL_NM
         , HPI.HR_PSN_INTFC_RG_ESTB_ID
         , HPI.HR_PSN_WRK_TEL_NUM
         , HPI.HR_PSN_INTFC_EML_ADDR
         , HPI.HR_PSN_INTFC_MGR_LVL_NUM
         , HPI.HR_PSN_INTFC_REG_TEMP_TP_CD
         , HPI.HR_PSN_INTFC_DEPT_ID
         , HPI.HR_PSN_INTFC_DEPT_NM
         , HPI.HR_PSN_INTFC_COA_ACCT_CD
         , HPI.HR_PSN_INTFC_CC_NM
         , HPI.HR_PSN_INTFC_SUPV_ID
         , HPI.HR_PSN_INTFC_SUPV_NM
         , HPI.HR_PSN_INTFC_SLS_TP_CD
         , HPI.HR_PSN_INTFC_SUPV_EML_ADDR
         , HPI.HR_PSN_INTFC_PSN_FIRST_NM
         , HPI.HR_PSN_INTFC_PSN_LAST_NM
         , HPI.HR_PSN_INTFC_RUN_DT
         , HPI.HR_PSN_WRK_TEL_EXT_NUM
         , HPI.HR_PSN_INTFC_FAX_NUM
         , HPI.HR_PSN_INTFC_CELL_TEL_NUM
         , HPI.HR_PSN_INTFC_PSN_MID_NM
         , HPI.HR_PSN_INTFC_MGR_LVL_TXT
         , HPI.HR_PSN_INTFC_HIRE_DT
         , HPI.HR_PSN_INTFC_SSN_LAST4_NUM
         , HPI.HR_PSN_INTFC_RG_ESTB_TXT
         , HPI.HR_PSN_INTFC_LOC_CD
         , HPI.HR_PSN_INTFC_LOC_DESC_TXT
         , HPI.HR_PSN_INTFC_EXPAT_IND
         , HPI.HR_PSN_EEO4_FUNC_TP_CD
         , HPI.HR_PSN_INTFC_FC_BLDG_CD
         , HPI.HR_PSN_INTFC_JOB_GRP_TP_CD
         , HPI.HR_PSN_INTFC_WRK_TM_TP_CD
         , HPI.HR_PSN_INTFC_LOC_CTY_NM
         , HPI.HR_PSN_INTFC_LOC_ST_CD
         , HPI.HR_PSN_INTFC_SUB_DIV_CD
         , HPI.HR_PSN_INTFC_SUB_DIV_NM
         , HPI.HR_PSN_INTFC_SUB_GRP_CD
         , HPI.HR_PSN_INTFC_SUB_GRP_NM
         , HPI.HR_PSN_INTFC_DATA_SRC_CD
         , HPI.HR_PSN_INTFC_WRK_END_DT
         <!-- QC#1988 -->
         , HPI.HR_PSN_ARCS_COA_CMPY_CD
         , HPI.HR_PSN_ARCS_COA_EXTN_CD
         , HPI.HR_PSN_ARCS_COA_BR_CD
         , HPI.HR_PSN_ARCS_COA_CC_CD

      FROM
          HR_PSN_INTFC HPI
        , S21_PSN      SP

      WHERE
          HPI.HR_PSN_INTFC_CMPY_CD    = #hrPsnIntfcCmpyCd#
      AND HPI.GLBL_CMPY_CD            = #glblCmpyCd#
      AND HPI.EZCANCELFLAG            = '0'
      AND HPI.HR_PSN_INTFC_EMP_STS_CD = #hrPsnIntfcEmpStsCd#
      
      AND HPI.GLBL_CMPY_CD         = SP.GLBL_CMPY_CD
      AND HPI.HR_PSN_INTFC_EMP_ID = SP.PSN_CD
      AND SP.EZCANCELFLAG         = '0'
      AND SP.DEL_FLG              = 'N'
      
      <!-- QC#1988 -->
      AND HR_PSN_INTFC_EMP_ID NOT LIKE #mailBoxEmpIdPrefix#
      <!--  QC#61266 2023/04/14 Add Start -->
      AND NOT EXISTS (
          SELECT
              1
          FROM
              ORG_FUNC_ASG     OFA
             ,TOC              T
             ,ORG_FUNC_ROLE_TP OFRT
             ,BIZ_AREA_ORG     BAO
          WHERE
              OFA.GLBL_CMPY_CD        = #glblCmpyCd#
          AND OFA.EZCANCELFLAG        = '0'
          AND OFA.PSN_CD              = SP.PSN_CD
          AND OFA.GLBL_CMPY_CD        = T.GLBL_CMPY_CD
          AND OFA.TOC_CD              = T.TOC_CD
          AND T.EZCANCELFLAG          = '0'
          AND T.GLBL_CMPY_CD          = OFRT.GLBL_CMPY_CD
          AND T.ORG_FUNC_ROLE_TP_CD   = OFRT.ORG_FUNC_ROLE_TP_CD
          AND OFRT.EZCANCELFLAG       = '0'
          AND OFRT.GLBL_CMPY_CD       = BAO.GLBL_CMPY_CD
          AND OFRT.FIRST_ORG_CD       = BAO.BIZ_AREA_ORG_CD
          AND BAO.EZCANCELFLAG        = '0'
          AND BAO.BIZ_AREA_ORG_CD     = #bizAreaOrgCd#
          AND TO_DATE(#slsDt#,'YYYYMMDD') - TO_DATE(HPI.HR_PSN_INTFC_WRK_END_DT, 'YYYYMMDD') &lt;= #gracePeriod#
      )
      <!--  QC#61266 2023/04/14 Add End -->

     </statement>

     <statement id="getDsOrgResrcRev" parameterClass="Map" resultClass="Map">

      SELECT
          DORR.PSN_CD
        , DORR.REV_ACCT_TP_CD
        , DORR.EFF_FROM_DT

      FROM
          DS_ORG_RESRC_REV DORR

      WHERE
          DORR.GLBL_CMPY_CD       = #glblCmpyCd#
      AND DORR.EZCANCELFLAG       = '0'
      AND DORR.PSN_CD             = #psnCd#
      AND NVL(DORR.EFF_THRU_DT, #maxEffThruDt#) &gt;= #slsDt#
      <isNotNull property="revAcctTpCd">
      AND DORR.REV_ACCT_TP_CD     = #revAcctTpCd#
      </isNotNull>

     </statement>

     <statement id="getActiveDsOrgResrcRev" parameterClass="Map" resultClass="Map">

      SELECT
          DORR.PSN_CD
        , DORR.REV_ACCT_TP_CD
        , DORR.EFF_FROM_DT
        , DORR.MAN_ENTRY_FLG

      FROM
          DS_ORG_RESRC_REV DORR

      WHERE
          DORR.GLBL_CMPY_CD   = #glblCmpyCd#
      AND DORR.EZCANCELFLAG   = '0'
      AND DORR.PSN_CD         = #psnCd#
      AND DORR.REV_ACCT_TP_CD = #revAcctTpCd#
      AND NVL(DORR.EFF_THRU_DT, #maxEffThruDt#) &gt;= #effThruDt#

     </statement>

     <statement id="getOrgFuncAsg" parameterClass="Map" resultClass="Map">

      SELECT
          OFA.PSN_CD
        , OFA.TOC_CD
        , OFA.EFF_FROM_DT

      FROM
          ORG_FUNC_ASG OFA

      WHERE
          OFA.GLBL_CMPY_CD = #glblCmpyCd#
      AND OFA.EZCANCELFLAG = '0'
      AND OFA.PSN_CD       = #psnCd#

     </statement>

     <statement id="getDsOrgResrcReln" parameterClass="Map" resultClass="Map">

      SELECT
          DORR.ORG_CD
        , DORR.ORG_STRU_TP_CD
        , DORR.PSN_CD
        , DORR.ORG_FUNC_ROLE_TP_CD
        , DORR.EFF_FROM_DT

      FROM
          DS_ORG_RESRC_RELN DORR

      WHERE
          DORR.GLBL_CMPY_CD = #glblCmpyCd#
      AND DORR.EZCANCELFLAG = '0'
      AND DORR.PSN_CD       = #psnCd#

     </statement>

     <statement id="getTocOrgStruReln" parameterClass="Map" resultClass="Map">

      SELECT
          TOSR.ORG_STRU_TP_CD
        , TOSR.TOC_CD
        , TOSR.ORG_CD
        , TOSR.GLBL_CMPY_CD

      FROM
          ORG_TOC_CHNG_RQST OTCR
        , ORG_FUNC_ROLE_TP  OFRT
        , BIZ_AREA_ORG      BAO
        , TOC_ORG_STRU_RELN TOSR

      WHERE
          OTCR.GLBL_CMPY_CD        = #glblCmpyCd#
      AND OTCR.EZCANCELFLAG        = '0'
      AND OTCR.TOC_CD              = #tocCd#

      AND OTCR.GLBL_CMPY_CD        = OFRT.GLBL_CMPY_CD
      AND OTCR.EZCANCELFLAG        = OFRT.EZCANCELFLAG
      AND OTCR.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD
      AND OFRT.ACTV_FLG            = 'Y'

      AND OFRT.EZCANCELFLAG        = BAO.EZCANCELFLAG
      AND OFRT.GLBL_CMPY_CD        = BAO.GLBL_CMPY_CD
      AND OFRT.FIRST_ORG_CD        = BAO.BIZ_AREA_ORG_CD
      AND BAO.ORG_STRU_TP_CD       = #orgStruTpCd#

      AND OTCR.GLBL_CMPY_CD        = TOSR.GLBL_CMPY_CD
      AND OTCR.EZCANCELFLAG        = TOSR.EZCANCELFLAG
      AND OTCR.TOC_CD              = TOSR.TOC_CD

     </statement>

     <statement id="getPersonForRehire" parameterClass="Map" resultClass="Map">

      SELECT
           HPI.GLBL_CMPY_CD
         , HPI.HR_PSN_INTFC_EMP_ID
         , HPI.HR_PSN_INTFC_PSN_NM
         , HPI.HR_PSN_EMP_CNSLT_TP_CD
         , HPI.HR_PSN_INTFC_EMP_STS_CD
         , HPI.HR_PSN_INTFC_STS_DESC_TXT
         , HPI.HR_PSN_INTFC_CMPY_CD
         , HPI.HR_PSN_INTFC_CMPY_NM
         , HPI.HR_PSN_INTFC_DIV_CD
         , HPI.HR_PSN_INTFC_DIV_NM
         , HPI.HR_PSN_INTFC_GRP_CD
         , HPI.HR_PSN_INTFC_GRP_NM
         , HPI.HR_PSN_INTFC_JOB_CD
         , HPI.HR_PSN_INTFC_JOB_TTL_NM
         , HPI.HR_PSN_INTFC_RG_ESTB_ID
         , HPI.HR_PSN_WRK_TEL_NUM
         , HPI.HR_PSN_INTFC_EML_ADDR
         , HPI.HR_PSN_INTFC_MGR_LVL_NUM
         , HPI.HR_PSN_INTFC_REG_TEMP_TP_CD
         , HPI.HR_PSN_INTFC_DEPT_ID
         , HPI.HR_PSN_INTFC_DEPT_NM
         , HPI.HR_PSN_INTFC_COA_ACCT_CD
         , HPI.HR_PSN_INTFC_CC_NM
         , HPI.HR_PSN_INTFC_SUPV_ID
         , HPI.HR_PSN_INTFC_SUPV_NM
         , HPI.HR_PSN_INTFC_SLS_TP_CD
         , HPI.HR_PSN_INTFC_SUPV_EML_ADDR
         , HPI.HR_PSN_INTFC_PSN_FIRST_NM
         , HPI.HR_PSN_INTFC_PSN_LAST_NM
         , HPI.HR_PSN_INTFC_RUN_DT
         , HPI.HR_PSN_WRK_TEL_EXT_NUM
         , HPI.HR_PSN_INTFC_FAX_NUM
         , HPI.HR_PSN_INTFC_CELL_TEL_NUM
         , HPI.HR_PSN_INTFC_PSN_MID_NM
         , HPI.HR_PSN_INTFC_MGR_LVL_TXT
         , HPI.HR_PSN_INTFC_HIRE_DT
         , HPI.HR_PSN_INTFC_SSN_LAST4_NUM
         , HPI.HR_PSN_INTFC_RG_ESTB_TXT
         , HPI.HR_PSN_INTFC_LOC_CD
         , HPI.HR_PSN_INTFC_LOC_DESC_TXT
         , HPI.HR_PSN_INTFC_EXPAT_IND
         , HPI.HR_PSN_EEO4_FUNC_TP_CD
         , HPI.HR_PSN_INTFC_FC_BLDG_CD
         , HPI.HR_PSN_INTFC_JOB_GRP_TP_CD
         , HPI.HR_PSN_INTFC_WRK_TM_TP_CD
         , HPI.HR_PSN_INTFC_LOC_CTY_NM
         , HPI.HR_PSN_INTFC_LOC_ST_CD
         , HPI.HR_PSN_INTFC_SUB_DIV_CD
         , HPI.HR_PSN_INTFC_SUB_DIV_NM
         , HPI.HR_PSN_INTFC_SUB_GRP_CD
         , HPI.HR_PSN_INTFC_SUB_GRP_NM
         , HPI.HR_PSN_INTFC_DATA_SRC_CD
         , HPI.HR_PSN_INTFC_WRK_END_DT
         <!-- QC#1988 -->
         , HPI.HR_PSN_ARCS_COA_CMPY_CD
         , HPI.HR_PSN_ARCS_COA_EXTN_CD
         , HPI.HR_PSN_ARCS_COA_BR_CD
         , HPI.HR_PSN_ARCS_COA_CC_CD

      FROM
          HR_PSN_INTFC HPI
        , S21_PSN      SP

      WHERE
          HPI.HR_PSN_INTFC_CMPY_CD    = #hrPsnIntfcCmpyCd#
      <!-- QC#13809 -->
      AND HPI.GLBL_CMPY_CD            = #glblCmpyCd#
      AND HPI.EZCANCELFLAG            = '0'
      AND HPI.HR_PSN_INTFC_EMP_STS_CD = #hrPsnIntfcEmpStsCd#
      
      AND SP.GLBL_CMPY_CD         = #glblCmpyCd#
      AND SP.EZCANCELFLAG         = '0'
      AND HPI.HR_PSN_INTFC_EMP_ID = SP.PSN_CD
      AND SP.DEL_FLG              = 'Y'

      <!-- QC#1988 -->
      AND HR_PSN_INTFC_EMP_ID NOT LIKE #mailBoxEmpIdPrefix#
     </statement>

     <statement id="getAdressByHrLocation" parameterClass="Map" resultClass="Map">
      SELECT
          P.FIRST_LINE_ADDR
        , P.SCD_LINE_ADDR
        , P.THIRD_LINE_ADDR
        , P.FRTH_LINE_ADDR
        , P.CTY_ADDR
        , P.CNTY_PK
        , P.PROV_NM
        , P.ST_CD
        , P.POST_CD
        , P.CTRY_CD
      FROM
          DS_XREF_ACCT X
        , PTY_LOC_WRK  P
      WHERE
          X.GLBL_CMPY_CD       = #glblCmpyCd#
      AND X.EZCANCELFLAG       = '0'
      AND X.DS_XREF_ACCT_TP_CD = #dsXrefAcctTp_CSA#
      AND X.DS_XREF_ACCT_CD    = #hrLocCd#
      AND X.LOC_NUM            = P.LOC_NUM
      AND X.GLBL_CMPY_CD       = P.GLBL_CMPY_CD
      AND P.EZCANCELFLAG       = '0'
      ORDER BY
          X.LOC_NUM
     </statement>

     <statement id="checkExistsRevenue" parameterClass="Map" resultClass="Integer">
      SELECT
         COUNT(REV.PSN_CD)
      FROM
         DS_ORG_RESRC_REV REV
      WHERE 
          REV.GLBL_CMPY_CD   = #glblCmpyCd#
      AND REV.EZCANCELFLAG   = '0'
      AND REV.PSN_CD         = #psnCd#
      AND REV.REV_ACCT_TP_CD = #revAcctTp_REV#
     </statement>

</sqlMap>