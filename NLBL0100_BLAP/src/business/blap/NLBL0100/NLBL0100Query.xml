<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NLBL0100Query">

	<typeAlias alias="NLBL0100CMsg"		type="business.blap.NLBL0100.NLBL0100CMsg"/>
	<typeAlias alias="NLBL0100SMsg"		type="business.blap.NLBL0100.NLBL0100SMsg"/>
	<typeAlias alias="NLBL0100_ASMsg"	type="business.blap.NLBL0100.NLBL0100_ASMsg"/>

	<statement id="getHistoryHeaderInfo" parameterClass="EZDMsg" resultMap="result.NLBL0100CMsg">
		SELECT
			POD.SHPPR_CTY_NM			AS SHPPR_CTY_NM
			, POD.CNSGN_CTY_NM			AS CNSGN_CTY_NM
			, POD.EZINTIME				AS EZINTIME
			, POD.SHPPR_NM				AS SHPPR_NM
			, POD.SHPPR_ADDR			AS SHPPR_ADDR
			, SHPPR_ST.ST_NM			AS ST_NM_SP
			, POD.SHPPR_POST_CD			AS SHPPR_POST_CD
			, POD.POD_CNSGN_NM			AS POD_CNSGN_NM
			, POD.CNSGN_ADDR			AS CNSGN_ADDR
			, CNSGN_ST.ST_NM			AS ST_NM_CS
			, POD.CNSGN_POST_CD			AS CNSGN_POST_CD
		FROM
			POD			POD
			, ST		SHPPR_ST
			, ST		CNSGN_ST
		WHERE
			POD.GLBL_CMPY_CD				=	#glblCmpyCd#
			AND POD.CARR_CD					=	#carrCd#
			AND POD.PRO_NUM					=	#proNum#
			AND POD.POD_LTST_REC_FLG		=	'Y'
			AND POD.EZCANCELFLAG			=	'0'
			AND SHPPR_ST.EZCANCELFLAG (+)	=	'0'
			AND CNSGN_ST.EZCANCELFLAG (+)	=	'0'
			
			AND POD.GLBL_CMPY_CD			=	SHPPR_ST.GLBL_CMPY_CD (+)
			AND POD.SHPPR_ST_CD				=	SHPPR_ST.ST_CD (+)
			
			AND POD.GLBL_CMPY_CD			=	CNSGN_ST.GLBL_CMPY_CD (+)
			AND POD.CNSGN_ST_CD				=	CNSGN_ST.ST_CD (+)
	</statement>

	<resultMap id="result.NLBL0100CMsg" class="NLBL0100CMsg">
		<result property="shpprCtyNm" column="SHPPR_CTY_NM" javaType="EZDCStringItem"/>
		<result property="cnsgnCtyNm" column="CNSGN_CTY_NM" javaType="EZDCStringItem"/>
		<result property="ezInTime" column="EZINTIME" javaType="EZDCStringItem"/>
		<result property="shpprNm" column="SHPPR_NM" javaType="EZDCStringItem"/>
		<result property="shpprAddr" column="SHPPR_ADDR" javaType="EZDCStringItem"/>
		<result property="stNm_SP" column="ST_NM_SP" javaType="EZDCStringItem"/>
		<result property="shpprPostCd" column="SHPPR_POST_CD" javaType="EZDCStringItem"/>
		<result property="podCnsgnNm" column="POD_CNSGN_NM" javaType="EZDCStringItem"/>
		<result property="cnsgnAddr" column="CNSGN_ADDR" javaType="EZDCStringItem"/>
		<result property="stNm_CS" column="ST_NM_CS" javaType="EZDCStringItem"/>
		<result property="cnsgnPostCd" column="CNSGN_POST_CD" javaType="EZDCStringItem"/>
	</resultMap>


	<statement id="getHistoryDetailList" parameterClass="EZDMsg" resultMap="result.NLBL0100_ASMsg">
		SELECT
			POD.POD_STS_CD				AS POD_STS_CD
			, PODS.POD_STS_NM			AS POD_STS_NM
			, POD.POD_STS_DT			AS POD_STS_DT
			, POD.POD_WT				AS POD_WT
			, POD.POD_LDG_QTY			AS POD_LDG_QTY
			, POD.POD_PKG_CD			AS POD_PKG_CD
			, POD.POD_EX_LDG_QTY		AS POD_EX_LDG_QTY
			, POD.POD_EX_CD				AS POD_EX_CD
			, PODE.POD_EX_NM			AS POD_EX_NM
			, PODST.POD_SRC_TP_NM		AS POD_SRC_TP_NM       <!-- 10/14/2015 add -->
		FROM
			POD				POD
			, POD_STS		PODS
			, POD_EX		PODE
			, POD_SRC_TP	PODST  <!-- 10/14/2015 add -->
		WHERE
			POD.GLBL_CMPY_CD		=	#glblCmpyCd#
			AND POD.CARR_CD			=	#carrCd#
			AND POD.PRO_NUM			=	#proNum#
			AND POD.EZCANCELFLAG	=	'0'
		
			AND POD.GLBL_CMPY_CD	=	PODS.GLBL_CMPY_CD (+)
			AND POD.POD_STS_CD		=	PODS.POD_STS_CD (+)
		
			AND POD.GLBL_CMPY_CD	=	PODE.GLBL_CMPY_CD (+)
			AND POD.POD_EX_CD		=	PODE.POD_EX_CD (+)

			AND POD.GLBL_CMPY_CD	=	PODST.GLBL_CMPY_CD (+)	<!-- 10/14/2015 add -->
			AND POD.POD_SRC_TP_CD	=	PODST.POD_SRC_TP_CD (+)	<!-- 10/14/2015 add -->

			AND PODS.EZCANCELFLAG(+) 	=	'0'
			AND PODE.EZCANCELFLAG(+) 	=	'0'
			AND PODST.EZCANCELFLAG(+) 	=	'0'					<!-- 10/14/2015 add -->
		ORDER BY
			POD.POD_SQ_NUM DESC
	</statement>

	<resultMap id="result.NLBL0100_ASMsg" class="NLBL0100_ASMsg">
		<result property="podStsCd" column="POD_STS_CD" javaType="EZDSStringItem"/>
		<result property="podStsNm" column="POD_STS_NM" javaType="EZDSStringItem"/>
		<result property="podStsDt" column="POD_STS_DT" javaType="EZDSStringItem"/>
		<result property="podWt" column="POD_WT" javaType="EZDSBigDecimalItem"/>
		<result property="podLdgQty" column="POD_LDG_QTY" javaType="EZDSBigDecimalItem"/>
		<result property="podPkgCd" column="POD_PKG_CD" javaType="EZDSStringItem"/>
		<result property="podExLdgQty" column="POD_EX_LDG_QTY" javaType="EZDSBigDecimalItem"/>
		<result property="podExCd" column="POD_EX_CD" javaType="EZDSStringItem"/>
		<result property="podExNm" column="POD_EX_NM" javaType="EZDSStringItem"/>
		<result property="podSrcTpNm" column="POD_SRC_TP_NM" javaType="EZDSStringItem"/>
	</resultMap>
	
</sqlMap>
