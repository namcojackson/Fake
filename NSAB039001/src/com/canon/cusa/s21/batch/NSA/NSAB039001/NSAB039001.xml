<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSAB039001">

    <statement id="getCfsLeaseContrPkForPurge" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            T.CFS_LEASE_CONTR_PK
        FROM
            CFS_LEASE_CONTR T
        WHERE
            T.GLBL_CMPY_CD   = #GLBL_CMPY_CD#
    </statement>


    <statement id="getCfsLeaseContrPkForUpd" parameterClass="Map" resultClass="Map">
        SELECT
            TRN.CFS_LEASE_CONTR_PK
           ,TRN.SER_NUM
           ,(CASE WHEN MAC.SER_NUM IS NULL THEN #CFS_EQUIP_CD# ELSE MDS.COA_MDSE_TP_CD END) CFS_EQUIP_CD
        FROM
            CFS_LEASE_CONTR     TRN
           ,SVC_MACH_MSTR       MAC
           ,MDSE                MDS
        WHERE
            TRN.GLBL_CMPY_CD    = #GLBL_CMPY_CD#
        AND TRN.GLBL_CMPY_CD    = MAC.GLBL_CMPY_CD(+)
        AND TRN.SER_NUM         = MAC.SER_NUM(+)
        AND MAC.GLBL_CMPY_CD    = MDS.GLBL_CMPY_CD(+)
        AND MAC.MDSE_CD         = MDS.MDSE_CD(+)
        AND TRN.EZCANCELFLAG    = '0'
        AND MAC.EZCANCELFLAG(+) = '0'
        AND MDS.EZCANCELFLAG(+) = '0'
        ORDER BY
             TRN.CFS_LEASE_CONTR_PK
            ,MAC.SVC_MACH_MSTR_PK
    </statement>


    <statement id="getCfsLeaseContrPkForDel" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            T.CFS_LEASE_CONTR_PK
        FROM
            CFS_LEASE_CONTR T
        WHERE
            T.GLBL_CMPY_CD   = #GLBL_CMPY_CD#
        AND T.CFS_EQUIP_CD  != #CFS_EQUIP_CD#
        AND T.EZCANCELFLAG   = '0'
    </statement>


    <statement id="getNSAI0020" parameterClass="Map" resultClass="Map">
        SELECT
            TRN.CFS_LEASE_NUM
           ,TRN.CSA_CONTR_NUM
           ,TRN.SER_NUM
           ,TRN.CFS_FLEET_FLG
           ,TRN.END_CUST_NM
           ,TRN.LEASE_DLR_CD
           ,TRN.BASE_BILL_FLG
           ,TRN.USG_BILL_FLG
           ,TRN.USG_TP_BILL_CD
           ,TRN.BASE_BLLG_CYCLE_CD
           ,TRN.USG_BLLG_CYCLE_CD
           ,TRN.USG_TRMN_DT
           ,TRN.BASE_PER_CYCLE_DEAL_AMT
           ,TRN.FIRST_XS_MTR_COPY_DPLY_QTY
           ,TRN.FIRST_XS_MTR_RATE
           ,TRN.SCD_XS_MTR_COPY_DPLY_QTY
           ,TRN.SCD_XS_MTR_RATE
           ,TRN.THIRD_XS_MTR_COPY_DPLY_QTY
           ,TRN.THIRD_XS_MTR_RATE
           ,TRN.FRTH_XS_MTR_COPY_DPLY_QTY
           ,TRN.FRTH_XS_MTR_RATE
           ,TRN.ASSET_LAST_MOD_DT
           ,TRN.ASSET_START_DT
           ,TRN.ASSET_END_DT
           ,TRN.ASSET_TRMN_DT
           ,TRN.HDR_START_DT
           ,TRN.HDR_END_DT
           ,TRN.HDR_TRMN_DT
           ,TRN.CFS_AGGR_CD
           ,TRN.CFS_LEGAL_FLG
           ,TRN.LAST_READ_MTR_CNT
           ,TRN.LAST_TEST_MTR_CNT
           ,TRN.CFS_EQUIP_CD
           ,TRN.HDR_BKNG_DT
           ,TRN.CFS_FTR_FLG
           ,TRN.INIT_CPLT_DT
        FROM
            NSAI0020_01           TRN
           ,LEASE_DLR_MAP         DLR
           ,CFS_EQUIP_MAP         EQP
        WHERE 
            TRN.INTERFACE_ID      = #INTERFACE_ID#
        AND TRN.TRANSACTION_ID    = #TRANSACTION_ID#
        AND TRN.LEASE_DLR_CD      = DLR.LEASE_DLR_CD
        AND DLR.GLBL_CMPY_CD      = #GLBL_CMPY_CD#
        AND DLR.ENBL_FLG          = #ENBL_FLG#
        AND TRN.CFS_EQUIP_CD      = EQP.CFS_EQUIP_CD
        AND EQP.GLBL_CMPY_CD      = #GLBL_CMPY_CD#
        AND EQP.ENBL_FLG          = #ENBL_FLG#
        AND TRN.EZCANCELFLAG      = '0'
        AND DLR.EZCANCELFLAG      = '0'
        AND EQP.EZCANCELFLAG      = '0'
        ORDER BY 
            UNIT_ID
    </statement>

</sqlMap>
