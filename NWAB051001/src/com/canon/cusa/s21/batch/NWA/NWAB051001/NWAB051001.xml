<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NWAB051001">

    <statement id="TruncateCloOrd" parameterClass="Map">
        TRUNCATE TABLE DS_CLO_ORD
    </statement>

    <statement id="DeleteCloOrd" parameterClass="Map">
        DELETE
            FROM
                DS_CLO_ORD
        WHERE
            GLBL_CMPY_CD        = #glblCmpyCd#
            AND EZCANCELFLAG    = '0'
    </statement>
    
    <statement id="CreateCloOrd" parameterClass="Map">
        INSERT INTO DS_CLO_ORD
            (
        SELECT
            'DS_CLO_ORD' EZTABLEID
            ,'0' EZCANCELFLAG
            ,#ezintime# EZINTIME
            ,#ezintimezone# EZINTIMEZONE
            ,#ezincompanycode# EZINCOMPANYCODE
            ,#ezinuserid# EZINUSERID
            ,#ezinaplid# EZINAPLID
            ,#ezuptime# EZUPTIME
            ,#ezuptimezone# EZUPTIMEZONE
            ,#ezupcompanycode# EZUPCOMPANYCODE
            ,#ezupuserid# EZUPUSERID
            ,#ezupaplid# EZUPAPLID
            ,GLBL_CMPY_CD
            ,DS_CLO_ORD_SQ.nextVal
            ,SRC_REF_OR_CPO_ORD_NUM
            ,CPO_DTL_LINE_NUM
            ,CPO_DTL_LINE_SUB_NUM
            ,DS_ORD_POSN_NUM
            ,DS_CPO_LINE_NUM
            ,DS_CPO_LINE_SUB_NUM
            ,DS_CPO_RTRN_LINE_NUM
            ,DS_CPO_RTRN_LINE_SUB_NUM
            ,DS_CPO_CONFIG_PK
            ,SHPG_PLN_NUM
            ,PRCH_REQ_NUM
            ,PO_ORD_NUM
            ,SO_NUM
            ,SO_SLP_NUM
            ,INV_NUM
            ,INV_BOL_LINE_NUM
            ,INV_LINE_NUM
            ,INV_LINE_SUB_NUM
            ,INV_LINE_SUB_TRX_NUM
            ,DS_INV_SLS_CR_PK
            ,ADD_ORIG_CPO_ORD_NUM
            ,CUST_ISS_PO_NUM
            ,LEASE_CMPY_PO_NUM
            ,SOLD_TO_CUST_ACCT_NM
            ,SOLD_TO_CUST_ACCT_CD
            ,SOLD_TO_CUST_LOC_CD
            ,SHIP_TO_CUST_ACCT_NM
            ,SHIP_TO_CUST_ACCT_CD
            ,SHIP_TO_CUST_LOC_CD
            ,BILL_TO_CUST_ACCT_NM
            ,BILL_TO_CUST_ACCT_CD
            ,BILL_TO_CUST_LOC_CD
            ,COA_BR_CD
            ,COA_BR_DESC_TXT
            ,COA_EXTN_CD
            ,COA_EXTN_DESC_TXT
            ,SLS_REP_TOC_CD
            ,SLS_REP_TOC_NM
            ,CPO_SRC_TP_CD
            ,CPO_SRC_TP_DESC_TXT
            ,DS_ORD_CATG_CD
            ,DS_ORD_CATG_DESC_TXT
            ,DS_ORD_TP_CD
            ,DS_ORD_TP_DESC_TXT
            ,DS_ORD_RSN_CD
            ,DS_ORD_RSN_DESC_TXT
            ,CSMP_CONTR_NUM
            ,PRC_CONTR_NUM
            ,PRC_CONTR_NM
            ,ORD_SRC_REF_NUM
            ,IMPT_STS_CD
            ,ZEROTH_PROD_CTRL_CD
            ,ZEROTH_PROD_CTRL_NM
            ,FIRST_PROD_CTRL_CD
            ,FIRST_PROD_CTRL_NM
            ,SCD_PROD_CTRL_CD
            ,SCD_PROD_CTRL_NM
            ,THIRD_PROD_CTRL_CD
            ,THIRD_PROD_CTRL_NM
            ,FRTH_PROD_CTRL_CD
            ,FRTH_PROD_CTRL_NM
            ,FIFTH_PROD_CTRL_CD
            ,FIFTH_PROD_CTRL_NM
            ,MDSE_CD
            ,MDSE_DESC_SHORT_TXT
            ,COA_PROD_CD
            ,COA_PROD_DESC_TXT
            ,COA_MDSE_TP_CD
            ,COA_MDSE_TP_DESC_TXT
            ,REV_COA_ACCT_CD
            ,REV_TRIAL_BAL_TP_CD
            ,MDL_ID
            ,T_MDL_NM
            ,SER_NUM
            ,RTRN_RSN_CD
            ,RTRN_RSN_DESC_TXT
            ,ACTL_SHIP_DT
            ,INV_DT
            ,ORD_LINE_SRC_CD
            ,ORD_LINE_SRC_NM
            ,RTL_WH_CD
            ,RTL_WH_NM
            ,RTL_SWH_CD
            ,RTL_SWH_NM
            ,INVTY_LOC_CD
            ,VND_NM
            ,NVL(DROP_SHIP_FLG,'N')
            ,DS_CONTR_NUM
            ,SVC_CONFIG_MSTR_PK
            ,CRAT_BY_USR_ID
            ,CPO_ORD_TS
            ,ORD_BOOK_TS
            ,ORD_HDR_STS_CD
            ,ORD_LINE_STS_CD
            ,RTRN_LINE_STS_CD
            ,ORD_HDR_DPLY_STS_NM
            ,ORD_LINE_DPLY_STS_NM
            ,ORD_RTRN_LINE_DPLY_STS_NM
            ,CONFIG_CATG_CD
            ,SLS_REP_OR_SLS_TEAM_TOC_CD
            ,SLS_REP_OR_SLS_TEAM_TOC_NM
            ,ISTL_DT
            ,RDD_DT
            ,PSD_DT
            ,PDD_DT
            ,PRC_CATG_CD
            ,PRC_CATG_DESC_TXT
            ,ORD_QTY
            ,CR_HLD_QTY
            ,CR_CHK_QTY
            ,SLS_HLD_QTY
            ,ENT_CPO_DTL_FUNC_NET_AMT
            ,ENT_CPO_DTL_FUNC_SLS_AMT
            ,SP_FUNC_UNIT_PRC_AMT
            ,SP_FUNC_NET_UNIT_PRC_AMT
            ,SP_TOT_FUNC_NET_AMT
            ,LINE_BIZ_TP_CD
            ,LINE_BIZ_TP_DESC_TXT
            ,DS_ORD_LINE_CATG_CD
            ,DS_ORD_LINE_CATG_DESC_TXT
            ,SVC_MACH_MSTR_PK
            ,INV_LINE_FUNC_NET_AMT
            ,FUNC_GRS_TOT_PRC_AMT
            ,FUNC_SLS_CR_AMT
            ,TRX_CD
            ,TRX_RSN_CD
            ,NVL(DFRD_REV_FLG,'N')
            ,ORD_AGING_BCKT_DESC_TXT
            ,ORD_SRC_IMPT_DT
            ,DPLY_VND_NM
            <!-- 2017/09/21 QC#21086 Add Start -->
            ,DS_CPO_CRAT_USR_ID
            <!-- 2017/09/21 QC#21086 Add End -->
            ,SLS_REP_PSN_NUM <!-- 2018/02/22 QC#21611 Add -->
            ,AQU_NUM <!-- 2018/08/01 QC#26304 Add -->
        FROM
            (
                SELECT
                    <!-- 2018/07/06 QC#26758 Add Start -->
                    $hintCloOrdV$
                    <!-- 2018/07/06 QC#26758 Add End -->
                    GLBL_CMPY_CD
                    ,SRC_REF_OR_CPO_ORD_NUM
                    ,CPO_DTL_LINE_NUM
                    ,CPO_DTL_LINE_SUB_NUM
                    ,DS_ORD_POSN_NUM
                    ,DS_CPO_LINE_NUM
                    ,DS_CPO_LINE_SUB_NUM
                    ,DS_CPO_RTRN_LINE_NUM
                    ,DS_CPO_RTRN_LINE_SUB_NUM
                    ,DS_CPO_CONFIG_PK
                    ,SHPG_PLN_NUM
                    ,PRCH_REQ_NUM
                    ,PO_ORD_NUM
                    ,SO_NUM
                    ,SO_SLP_NUM
                    ,INV_NUM
                    ,INV_BOL_LINE_NUM
                    ,INV_LINE_NUM
                    ,INV_LINE_SUB_NUM
                    ,INV_LINE_SUB_TRX_NUM
                    ,DS_INV_SLS_CR_PK
                    ,ADD_ORIG_CPO_ORD_NUM
                    ,CUST_ISS_PO_NUM
                    ,LEASE_CMPY_PO_NUM
                    ,SOLD_TO_CUST_ACCT_NM
                    ,SOLD_TO_CUST_ACCT_CD
                    ,SOLD_TO_CUST_LOC_CD
                    ,SHIP_TO_CUST_ACCT_NM
                    ,SHIP_TO_CUST_ACCT_CD
                    ,SHIP_TO_CUST_LOC_CD
                    ,BILL_TO_CUST_ACCT_NM
                    ,BILL_TO_CUST_ACCT_CD
                    ,BILL_TO_CUST_LOC_CD
                    ,COA_BR_CD
                    ,COA_BR_DESC_TXT
                    ,COA_EXTN_CD
                    ,COA_EXTN_DESC_TXT
                    ,SLS_REP_TOC_CD
                    ,SLS_REP_TOC_NM
                    ,CPO_SRC_TP_CD
                    ,CPO_SRC_TP_DESC_TXT
                    ,DS_ORD_CATG_CD
                    ,DS_ORD_CATG_DESC_TXT
                    ,DS_ORD_TP_CD
                    ,DS_ORD_TP_DESC_TXT
                    ,DS_ORD_RSN_CD
                    ,DS_ORD_RSN_DESC_TXT
                    ,CSMP_CONTR_NUM
                    ,PRC_CONTR_NUM
                    ,PRC_CONTR_NM
                    ,ORD_SRC_REF_NUM
                    ,IMPT_STS_CD
                    ,ZEROTH_PROD_CTRL_CD
                    ,ZEROTH_PROD_CTRL_NM
                    ,FIRST_PROD_CTRL_CD
                    ,FIRST_PROD_CTRL_NM
                    ,SCD_PROD_CTRL_CD
                    ,SCD_PROD_CTRL_NM
                    ,THIRD_PROD_CTRL_CD
                    ,THIRD_PROD_CTRL_NM
                    ,FRTH_PROD_CTRL_CD
                    ,FRTH_PROD_CTRL_NM
                    ,FIFTH_PROD_CTRL_CD
                    ,FIFTH_PROD_CTRL_NM
                    ,MDSE_CD
                    ,MDSE_DESC_SHORT_TXT
                    ,COA_PROD_CD
                    ,COA_PROD_DESC_TXT
                    ,COA_MDSE_TP_CD
                    ,COA_MDSE_TP_DESC_TXT
                    ,REV_COA_ACCT_CD
                    ,REV_TRIAL_BAL_TP_CD
                    ,MDL_ID
                    ,T_MDL_NM
                    ,SER_NUM
                    ,RTRN_RSN_CD
                    ,RTRN_RSN_DESC_TXT
                    ,ACTL_SHIP_DT
                    ,INV_DT
                    ,ORD_LINE_SRC_CD
                    ,ORD_LINE_SRC_NM
                    ,RTL_WH_CD
                    ,RTL_WH_NM
                    ,RTL_SWH_CD
                    ,RTL_SWH_NM
                    ,INVTY_LOC_CD
                    ,VND_NM
                    ,DROP_SHIP_FLG
                    ,DS_CONTR_NUM
                    ,SVC_CONFIG_MSTR_PK
                    ,CRAT_BY_USR_ID
                    ,CPO_ORD_TS
                    ,ORD_BOOK_TS
                    ,ORD_HDR_STS_CD
                    ,ORD_LINE_STS_CD
                    ,RTRN_LINE_STS_CD
                    ,ORD_HDR_DPLY_STS_NM
                    ,ORD_LINE_DPLY_STS_NM
                    ,ORD_RTRN_LINE_DPLY_STS_NM
                    ,CONFIG_CATG_CD
                    ,SLS_REP_OR_SLS_TEAM_TOC_CD
                    ,SLS_REP_OR_SLS_TEAM_TOC_NM
                    ,ISTL_DT
                    ,RDD_DT
                    ,PSD_DT
                    ,PDD_DT
                    ,PRC_CATG_CD
                    ,PRC_CATG_DESC_TXT
                    ,ORD_QTY
                    ,CR_HLD_QTY
                    ,CR_CHK_QTY
                    ,SLS_HLD_QTY
                    ,ENT_CPO_DTL_FUNC_NET_AMT
                    ,ENT_CPO_DTL_FUNC_SLS_AMT
                    ,SP_FUNC_UNIT_PRC_AMT
                    ,SP_FUNC_NET_UNIT_PRC_AMT
                    ,SP_TOT_FUNC_NET_AMT
                    ,LINE_BIZ_TP_CD
                    ,LINE_BIZ_TP_DESC_TXT
                    ,DS_ORD_LINE_CATG_CD
                    ,DS_ORD_LINE_CATG_DESC_TXT
                    ,SVC_MACH_MSTR_PK
                    ,INV_LINE_FUNC_NET_AMT
                    ,FUNC_GRS_TOT_PRC_AMT
                    ,FUNC_SLS_CR_AMT
                    ,TRX_CD
                    ,TRX_RSN_CD
                    ,DFRD_REV_FLG
                    ,ORD_AGING_BCKT_DESC_TXT
                    ,ORD_SRC_IMPT_DT
                    ,DPLY_VND_NM
                    <!-- 2017/09/21 QC#21086 Add Start -->
                    ,DS_CPO_CRAT_USR_ID
                    <!-- 2017/09/21 QC#21086 Add End -->
                    ,SLS_REP_PSN_NUM <!-- 2018/02/22 QC#21611 Add -->
                    ,AQU_NUM <!-- 2018/08/01 QC#26304 Add -->
                FROM
                     CLO_ORD_V
                WHERE
                    GLBL_CMPY_CD        = #glblCmpyCd#
                    AND EZCANCELFLAG    = '0'
               )
            )
    </statement>
</sqlMap>
