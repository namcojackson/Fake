<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL1570Query">

    <typeAlias alias="NWAL1570SMsg"    type="business.blap.NWAL1570.NWAL1570SMsg"/>
    <typeAlias alias="NWAL1570_ASMsg"  type="business.blap.NWAL1570.NWAL1570_ASMsg"/>
    <typeAlias alias="NWAL1570_BSMsg"  type="business.blap.NWAL1570.NWAL1570_BSMsg"/>

    <statement id="findOrderList" parameterClass="Map" resultClass="Map">
        <isEqual property="teamSearchFlg" compareValue="Y">
        WITH
        TMZN AS (
        SELECT
            TM.GLBL_CMPY_CD
            ,TM.ORD_TEAM_MSTR_NM
            ,TM.ORD_ZN_DESC_TXT
            ,CBU.CRAT_BY_USR_ID
            ,CAC.CUST_ACCT_CD
            ,LBT.LINE_BIZ_TP_CD
            ,CBC.COA_BR_CD
        FROM 
            (
            SELECT
                OTMH.GLBL_CMPY_CD
                ,OTMH.ORD_TEAM_MSTR_NM
                ,OZ.ORD_ZN_DESC_TXT
                ,NULL AS ORD_TEAM_ATTRB_TP_CD10
                ,NULL AS CRAT_BY_USR_ID
                ,NULL AS ORD_TEAM_ATTRB_TP_CD20
                ,NULL AS CUST_ACCT_CD
                ,NULL AS ORD_TEAM_ATTRB_TP_CD30
                ,NULL AS LINE_BIZ_TP_CD
                ,NULL AS ORD_TEAM_ATTRB_TP_CD40
                ,NULL AS COA_BR_CD
            FROM
                ORD_TEAM_MSTR_HDR OTMH
                ,ORD_ZN OZ
            WHERE
                OTMH.GLBL_CMPY_CD = #glblCmpyCd#
                <isNotNull property="cMsg.xxOrdTeamSrchTxt">
                AND OTMH.ORD_TEAM_MSTR_NM = #ordTeamSrchTxt#
                </isNotNull>
                AND OTMH.EFF_FROM_DT        &lt;= #slsDt#
                AND (OTMH.EFF_THRU_DT IS NULL
                        OR OTMH.EFF_THRU_DT &gt;= #slsDt#)
                AND OTMH.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OZ.GLBL_CMPY_CD
                AND OTMH.ORD_ZN_CD = OZ.ORD_ZN_CD
                <isNotNull property="cMsg.xxOrdZnSrchTxt">
                AND OZ.ORD_ZN_DESC_TXT = #ordZnSrchTxt#
                </isNotNull>
                AND OZ.EZCANCELFLAG = '0'
            ) TM
            ,(
            SELECT
                OTMH.GLBL_CMPY_CD
                ,OTMH.ORD_TEAM_MSTR_NM
                ,OZ.ORD_ZN_DESC_TXT
                ,OTAT.ORD_TEAM_ATTRB_TP_CD AS ORD_TEAM_ATTRB_TP_CD10
                ,OTMD.ORD_TEAM_ATTRB_VAL_TXT AS CRAT_BY_USR_ID
                ,NULL AS ORD_TEAM_ATTRB_TP_CD20
                ,NULL AS CUST_ACCT_CD
                ,NULL AS ORD_TEAM_ATTRB_TP_CD30
                ,NULL AS LINE_BIZ_TP_CD
                ,NULL AS ORD_TEAM_ATTRB_TP_CD40
                ,NULL AS COA_BR_CD
            FROM
                ORD_TEAM_MSTR_HDR OTMH
                ,ORD_TEAM_MSTR_DTL OTMD
                ,ORD_TEAM_ATTRB_TP OTAT
                ,ORD_ZN OZ
            WHERE
                OTMH.GLBL_CMPY_CD = #glblCmpyCd#
                <isNotNull property="cMsg.xxOrdTeamSrchTxt">
                AND OTMH.ORD_TEAM_MSTR_NM = #ordTeamSrchTxt#
                </isNotNull>
                AND OTMH.EFF_FROM_DT        &lt;= #slsDt#
                AND (OTMH.EFF_THRU_DT IS NULL
                        OR OTMH.EFF_THRU_DT &gt;= #slsDt#)
                AND OTMH.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OZ.GLBL_CMPY_CD
                AND OTMH.ORD_ZN_CD = OZ.ORD_ZN_CD
                <isNotNull property="cMsg.xxOrdZnSrchTxt">
                AND OZ.ORD_ZN_DESC_TXT = #ordZnSrchTxt#
                </isNotNull>
                AND OZ.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OTMD.GLBL_CMPY_CD
                AND OTMH.ORD_TEAM_MSTR_HDR_PK = OTMD.ORD_TEAM_MSTR_HDR_PK
                AND OTMD.EZCANCELFLAG = '0'
                AND OTMD.GLBL_CMPY_CD = OTAT.GLBL_CMPY_CD
                AND OTMD.ORD_TEAM_ATTRB_TP_CD = OTAT.ORD_TEAM_ATTRB_TP_CD
                AND OTAT.ORD_TEAM_ATTRB_TP_CD = #attrbTpCdUser#
                AND OTAT.EZCANCELFLAG = '0'
            ) CBU
            ,(
            SELECT
                OTMH.GLBL_CMPY_CD
                ,OTMH.ORD_TEAM_MSTR_NM
                ,OZ.ORD_ZN_DESC_TXT
                ,NULL AS ORD_TEAM_ATTRB_TP_CD10
                ,NULL AS CRAT_BY_USR_ID
                ,OTAT.ORD_TEAM_ATTRB_TP_CD AS ORD_TEAM_ATTRB_TP_CD20
                ,OTMD.ORD_TEAM_ATTRB_VAL_TXT AS CUST_ACCT_CD
                ,NULL AS ORD_TEAM_ATTRB_TP_CD30
                ,NULL AS LINE_BIZ_TP_CD
                ,NULL AS ORD_TEAM_ATTRB_TP_CD40
                ,NULL AS COA_BR_CD
            FROM
                ORD_TEAM_MSTR_HDR OTMH
                ,ORD_TEAM_MSTR_DTL OTMD
                ,ORD_TEAM_ATTRB_TP OTAT
                ,ORD_ZN OZ
            WHERE
                OTMH.GLBL_CMPY_CD = #glblCmpyCd#
                <isNotNull property="cMsg.xxOrdTeamSrchTxt">
                AND OTMH.ORD_TEAM_MSTR_NM = #ordTeamSrchTxt#
                </isNotNull>
                AND OTMH.EFF_FROM_DT        &lt;= #slsDt#
                AND (OTMH.EFF_THRU_DT IS NULL
                        OR OTMH.EFF_THRU_DT &gt;= #slsDt#)
                AND OTMH.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OZ.GLBL_CMPY_CD
                AND OTMH.ORD_ZN_CD = OZ.ORD_ZN_CD
                <isNotNull property="cMsg.xxOrdZnSrchTxt">
                AND OZ.ORD_ZN_DESC_TXT = #ordZnSrchTxt#
                </isNotNull>
                AND OZ.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OTMD.GLBL_CMPY_CD
                AND OTMH.ORD_TEAM_MSTR_HDR_PK = OTMD.ORD_TEAM_MSTR_HDR_PK
                AND OTMD.EZCANCELFLAG = '0'
                AND OTMD.GLBL_CMPY_CD = OTAT.GLBL_CMPY_CD
                AND OTMD.ORD_TEAM_ATTRB_TP_CD = OTAT.ORD_TEAM_ATTRB_TP_CD
                AND OTAT.ORD_TEAM_ATTRB_TP_CD = #attrbTpCdCustomer#
                AND OTAT.EZCANCELFLAG = '0'
            ) CAC
            ,(
            SELECT
                OTMH.GLBL_CMPY_CD
                ,OTMH.ORD_TEAM_MSTR_NM
                ,OZ.ORD_ZN_DESC_TXT
                ,NULL AS ORD_TEAM_ATTRB_TP_CD10
                ,NULL AS CRAT_BY_USR_ID
                ,NULL AS ORD_TEAM_ATTRB_TP_CD20
                ,NULL AS CUST_ACCT_CD
                ,OTAT.ORD_TEAM_ATTRB_TP_CD AS ORD_TEAM_ATTRB_TP_CD30
                ,OTMD.ORD_TEAM_ATTRB_VAL_TXT AS LINE_BIZ_TP_CD
                ,NULL AS ORD_TEAM_ATTRB_TP_CD40
                ,NULL AS COA_BR_CD
            FROM
                ORD_TEAM_MSTR_HDR OTMH
                ,ORD_TEAM_MSTR_DTL OTMD
                ,ORD_TEAM_ATTRB_TP OTAT
                ,ORD_ZN OZ
            WHERE
                OTMH.GLBL_CMPY_CD = #glblCmpyCd#
                <isNotNull property="cMsg.xxOrdTeamSrchTxt">
                AND OTMH.ORD_TEAM_MSTR_NM = #ordTeamSrchTxt#
                </isNotNull>
                AND OTMH.EFF_FROM_DT        &lt;= #slsDt#
                AND (OTMH.EFF_THRU_DT IS NULL
                        OR OTMH.EFF_THRU_DT &gt;= #slsDt#)
                AND OTMH.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OZ.GLBL_CMPY_CD
                AND OTMH.ORD_ZN_CD = OZ.ORD_ZN_CD
                <isNotNull property="cMsg.xxOrdZnSrchTxt">
                AND OZ.ORD_ZN_DESC_TXT = #ordZnSrchTxt#
                </isNotNull>
                AND OZ.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OTMD.GLBL_CMPY_CD
                AND OTMH.ORD_TEAM_MSTR_HDR_PK = OTMD.ORD_TEAM_MSTR_HDR_PK
                AND OTMD.EZCANCELFLAG = '0'
                AND OTMD.GLBL_CMPY_CD = OTAT.GLBL_CMPY_CD
                AND OTMD.ORD_TEAM_ATTRB_TP_CD = OTAT.ORD_TEAM_ATTRB_TP_CD
                AND OTAT.ORD_TEAM_ATTRB_TP_CD = #attrbTpCdLob#
                AND OTAT.EZCANCELFLAG = '0'
            ) LBT
            ,(
            SELECT
                OTMH.GLBL_CMPY_CD
                ,OTMH.ORD_TEAM_MSTR_NM
                ,OZ.ORD_ZN_DESC_TXT
                ,NULL AS ORD_TEAM_ATTRB_TP_CD10
                ,NULL AS CRAT_BY_USR_ID
                ,NULL AS ORD_TEAM_ATTRB_TP_CD20
                ,NULL AS CUST_ACCT_CD
                ,NULL AS ORD_TEAM_ATTRB_TP_CD30
                ,NULL AS LINE_BIZ_TP_CD
                ,OTAT.ORD_TEAM_ATTRB_TP_CD AS ORD_TEAM_ATTRB_TP_CD40
                ,OTMD.ORD_TEAM_ATTRB_VAL_TXT AS COA_BR_CD
            FROM
                ORD_TEAM_MSTR_HDR OTMH
                ,ORD_TEAM_MSTR_DTL OTMD
                ,ORD_TEAM_ATTRB_TP OTAT
                ,ORD_ZN OZ
            WHERE
                OTMH.GLBL_CMPY_CD = #glblCmpyCd#
                <isNotNull property="cMsg.xxOrdTeamSrchTxt">
                AND OTMH.ORD_TEAM_MSTR_NM = #ordTeamSrchTxt#
                </isNotNull>
                AND OTMH.EFF_FROM_DT        &lt;= #slsDt#
                AND (OTMH.EFF_THRU_DT IS NULL
                        OR OTMH.EFF_THRU_DT &gt;= #slsDt#)
                AND OTMH.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OZ.GLBL_CMPY_CD
                AND OTMH.ORD_ZN_CD = OZ.ORD_ZN_CD
                <isNotNull property="cMsg.xxOrdZnSrchTxt">
                AND OZ.ORD_ZN_DESC_TXT = #ordZnSrchTxt#
                </isNotNull>
                AND OZ.EZCANCELFLAG = '0'
                AND OTMH.GLBL_CMPY_CD = OTMD.GLBL_CMPY_CD
                AND OTMH.ORD_TEAM_MSTR_HDR_PK = OTMD.ORD_TEAM_MSTR_HDR_PK
                AND OTMD.EZCANCELFLAG = '0'
                AND OTMD.GLBL_CMPY_CD = OTAT.GLBL_CMPY_CD
                AND OTMD.ORD_TEAM_ATTRB_TP_CD = OTAT.ORD_TEAM_ATTRB_TP_CD
                AND OTAT.ORD_TEAM_ATTRB_TP_CD = #attrbTpCdBranch#
                AND OTAT.EZCANCELFLAG = '0'
            ) CBC
        WHERE
            TM.GLBL_CMPY_CD =  CBU.GLBL_CMPY_CD(+)
            AND TM.ORD_TEAM_MSTR_NM = CBU.ORD_TEAM_MSTR_NM(+)
            AND TM.ORD_ZN_DESC_TXT = CBU.ORD_ZN_DESC_TXT(+)
            AND TM.GLBL_CMPY_CD = CAC.GLBL_CMPY_CD(+)
            AND TM.ORD_TEAM_MSTR_NM = CAC.ORD_TEAM_MSTR_NM(+)
            AND TM.ORD_ZN_DESC_TXT = CAC.ORD_ZN_DESC_TXT(+)
            AND TM.GLBL_CMPY_CD = LBT.GLBL_CMPY_CD(+)
            AND TM.ORD_TEAM_MSTR_NM = LBT.ORD_TEAM_MSTR_NM(+)
            AND TM.ORD_ZN_DESC_TXT = LBT.ORD_ZN_DESC_TXT(+)
            AND TM.GLBL_CMPY_CD = CBC.GLBL_CMPY_CD(+)
            AND TM.ORD_TEAM_MSTR_NM = CBC.ORD_TEAM_MSTR_NM(+)
            AND TM.ORD_ZN_DESC_TXT = CBC.ORD_ZN_DESC_TXT(+)
        )
        </isEqual>
        SELECT
        <!-- Header -->
            GLBL_CMPY_CD
            ,SRC_REF_OR_CPO_ORD_NUM
        <isEqual property="cMsg.grpByDnldCd" compareValue="1">
            ,CUST_ISS_PO_NUM
            ,LEASE_CMPY_PO_NUM
            ,SOLD_TO_CUST_ACCT_NM
            ,SOLD_TO_CUST_ACCT_CD
            ,SOLD_TO_CUST_LOC_CD
            ,COA_BR_CD
            ,COA_BR_DESC_TXT
            ,COA_EXTN_CD
            ,COA_EXTN_DESC_TXT
            ,SLS_REP_TOC_CD
            ,SLS_REP_TOC_NM
            ,CPO_SRC_TP_CD
            ,CPO_SRC_TP_DESC_TXT
            ,DS_ORD_CATG_CD
            ,DS_ORD_CATG_DESC_TXT
            ,DS_ORD_TP_CD
            ,DS_ORD_TP_DESC_TXT
            ,DS_ORD_RSN_CD
            ,DS_ORD_RSN_DESC_TXT
            ,CSMP_CONTR_NUM
            ,ORD_SRC_REF_NUM
            ,CPO_ORD_TS
            ,ORD_BOOK_TS
            ,ORD_HDR_DPLY_STS_NM
            ,SLS_REP_PSN_NUM
            ,AQU_NUM
        </isEqual>
        <!-- Config -->
        <isEqual property="cMsg.grpByDnldCd" compareValue="2">
            ,SVC_CONFIG_MSTR_PK
            ,CUST_ISS_PO_NUM
            ,LEASE_CMPY_PO_NUM
            ,SOLD_TO_CUST_ACCT_NM
            ,SOLD_TO_CUST_ACCT_CD
            ,SOLD_TO_CUST_LOC_CD
            ,SHIP_TO_CUST_ACCT_NM
            ,SHIP_TO_CUST_ACCT_CD
            ,SHIP_TO_CUST_LOC_CD
            ,BILL_TO_CUST_ACCT_NM
            ,BILL_TO_CUST_ACCT_CD
            ,BILL_TO_CUST_LOC_CD
            ,COA_BR_CD
            ,COA_BR_DESC_TXT
            ,COA_EXTN_CD
            ,COA_EXTN_DESC_TXT
            ,SLS_REP_TOC_CD
            ,SLS_REP_TOC_NM
            ,CPO_SRC_TP_CD
            ,CPO_SRC_TP_DESC_TXT
            ,DS_ORD_CATG_CD
            ,DS_ORD_CATG_DESC_TXT
            ,DS_ORD_TP_CD
            ,DS_ORD_TP_DESC_TXT
            ,DS_ORD_RSN_CD
            ,DS_ORD_RSN_DESC_TXT
            ,CSMP_CONTR_NUM
            ,PRC_CONTR_NUM
            ,PRC_CONTR_NM
            ,ORD_SRC_REF_NUM
            ,MDL_ID
            ,T_MDL_NM
            ,CPO_ORD_TS
            ,ORD_BOOK_TS
            ,ORD_HDR_DPLY_STS_NM
            ,SLS_REP_PSN_NUM
            ,AQU_NUM
        </isEqual>
        <!-- Line -->
        <isEqual property="cMsg.grpByDnldCd" compareValue="3">
            ,CPO_DTL_LINE_NUM
            ,CPO_DTL_LINE_SUB_NUM
            ,DS_ORD_POSN_NUM
            ,DS_CPO_LINE_NUM
            ,DS_CPO_LINE_SUB_NUM
            ,DS_CPO_RTRN_LINE_NUM
            ,DS_CPO_RTRN_LINE_SUB_NUM
            ,DS_CPO_CONFIG_PK
            ,SHPG_PLN_NUM
            ,PRCH_REQ_NUM
            ,PO_ORD_NUM
            ,SO_NUM
            ,SO_SLP_NUM
            ,INV_NUM
            ,INV_BOL_LINE_NUM
            ,INV_LINE_NUM
            ,INV_LINE_SUB_NUM
            ,INV_LINE_SUB_TRX_NUM
            ,DS_INV_SLS_CR_PK
            ,ADD_ORIG_CPO_ORD_NUM
            ,CUST_ISS_PO_NUM
            ,LEASE_CMPY_PO_NUM
            ,SOLD_TO_CUST_ACCT_NM
            ,SOLD_TO_CUST_ACCT_CD
            ,SOLD_TO_CUST_LOC_CD
            ,SHIP_TO_CUST_ACCT_NM
            ,SHIP_TO_CUST_ACCT_CD
            ,SHIP_TO_CUST_LOC_CD
            ,BILL_TO_CUST_ACCT_NM
            ,BILL_TO_CUST_ACCT_CD
            ,BILL_TO_CUST_LOC_CD
            ,COA_BR_CD
            ,COA_BR_DESC_TXT
            ,COA_EXTN_CD
            ,COA_EXTN_DESC_TXT
            ,SLS_REP_TOC_CD
            ,SLS_REP_TOC_NM
            ,CPO_SRC_TP_CD
            ,CPO_SRC_TP_DESC_TXT
            ,DS_ORD_CATG_CD
            ,DS_ORD_CATG_DESC_TXT
            ,DS_ORD_TP_CD
            ,DS_ORD_TP_DESC_TXT
            ,DS_ORD_RSN_CD
            ,DS_ORD_RSN_DESC_TXT
            ,CSMP_CONTR_NUM
            ,PRC_CONTR_NUM
            ,PRC_CONTR_NM
            ,ORD_SRC_REF_NUM
            ,IMPT_STS_CD
            ,ZEROTH_PROD_CTRL_CD
            ,ZEROTH_PROD_CTRL_NM
            ,FIRST_PROD_CTRL_CD
            ,FIRST_PROD_CTRL_NM
            ,SCD_PROD_CTRL_CD
            ,SCD_PROD_CTRL_NM
            ,THIRD_PROD_CTRL_CD
            ,THIRD_PROD_CTRL_NM
            ,FRTH_PROD_CTRL_CD
            ,FRTH_PROD_CTRL_NM
            ,FIFTH_PROD_CTRL_CD
            ,FIFTH_PROD_CTRL_NM
            ,MDSE_CD
            ,MDSE_DESC_SHORT_TXT
            ,COA_PROD_CD
            ,COA_PROD_DESC_TXT
            ,COA_MDSE_TP_CD
            ,COA_MDSE_TP_DESC_TXT
            ,REV_COA_ACCT_CD
            ,REV_TRIAL_BAL_TP_CD
            ,MDL_ID
            ,T_MDL_NM
            ,SER_NUM
            ,RTRN_RSN_CD
            ,RTRN_RSN_DESC_TXT
            ,ACTL_SHIP_DT
            ,INV_DT
            ,ORD_LINE_SRC_CD
            ,ORD_LINE_SRC_NM
            ,RTL_WH_CD
            ,RTL_WH_NM
            <!-- 2018/12/13 QC#29024 Add Start -->
            ,RTL_WH_DESC_TXT
            <!-- 2018/12/13 QC#29024 Add End -->
            ,RTL_SWH_CD
            ,RTL_SWH_NM
            ,INVTY_LOC_CD
            ,VND_NM
            ,DPLY_VND_NM
            ,DROP_SHIP_FLG
            ,DS_CONTR_NUM
            ,SVC_CONFIG_MSTR_PK
            ,CRAT_BY_USR_ID
            ,CPO_ORD_TS
            ,ORD_BOOK_TS
            ,ORD_HDR_STS_CD
            ,ORD_LINE_STS_CD
            ,RTRN_LINE_STS_CD
            ,ORD_HDR_DPLY_STS_NM
            ,ORD_LINE_DPLY_STS_NM
            ,ORD_RTRN_LINE_DPLY_STS_NM
            ,CONFIG_CATG_CD
            ,SLS_REP_OR_SLS_TEAM_TOC_CD
            ,SLS_REP_OR_SLS_TEAM_TOC_NM
            ,ISTL_DT
            ,RDD_DT
            ,PSD_DT
            ,PDD_DT
            ,PRC_CATG_CD
            ,PRC_CATG_DESC_TXT
            ,TRX_CD
            ,TRX_RSN_CD
            ,DFRD_REV_FLG
            ,LINE_BIZ_TP_CD
            ,LINE_BIZ_TP_DESC_TXT
            ,DS_ORD_LINE_CATG_CD
            ,DS_ORD_LINE_CATG_DESC_TXT
            ,SVC_MACH_MSTR_PK
            ,ORD_AGING_BCKT_DESC_TXT
            ,ORD_SRC_IMPT_DT
            ,SLS_REP_PSN_NUM
            ,AQU_NUM
            <isEqual property="teamSearchFlg" compareValue="Y">
            ,ORD_ZN_DESC_TXT
            ,ORD_TEAM_MSTR_NM
            </isEqual>
        </isEqual>

        <isEqual property="cMsg.xxRsltModeCd" compareValue="1">
            ,ORD_QTY
            ,AMT
        </isEqual>

        <isEqual property="cMsg.xxRsltModeCd" compareValue="2">
            ,PEND_IMPT_SMRY_AMT
            ,ENT_SMRY_AMT
            ,DI_HLD_SMRY_AMT
            ,VLD_SMRY_AMT
            ,PRFT_SMRY_AMT
            ,CR_HLD_SMRY_AMT
            ,SPLY_ABUSE_SMRY_AMT
            ,PEND_RE_SUBMT_SMRY_AMT
            ,BOOK_SMRY_AMT
            ,AWAIT_DROP_SHIP_SMRY_AMT
            ,PEND_RE_ALLOC_SMRY_AMT
            ,PO_CANC_SMRY_AMT
            ,PEND_FUFL_SMRY_AMT
            ,PEND_ALLOC_SMRY_AMT
            ,BO_SMRY_AMT
            ,PEND_PICK_SMRY_AMT
            ,DELY_TO_SHOP_SMRY_AMT
            ,IN_SHOP_CONFIG_SMRY_AMT
            ,PEND_SHIP_SMRY_AMT
            ,SHIP_SMRY_AMT
            ,PEND_DELY_CONF_SMRY_AMT
            ,PEND_ISTL_SMRY_AMT
            ,ON_LOAN_SMRY_AMT
            ,WAIT_RCPT_SMRY_AMT
            ,PEND_RTRN_SMRY_AMT
            ,PEND_INSP_SMRY_AMT
            ,RWS_CANC_SMRY_AMT
            ,PRTL_RCV_SMRY_AMT
            ,PEND_INV_SMRY_AMT
            ,BLLG_HLD_SMRY_AMT
            ,PEND_DLR_ISTL_SMRY_AMT
            ,SHIP_CLO_SMRY_AMT
            ,CLO_SMRY_AMT
            ,CLO_LOAN_RTRN_SMRY_AMT
            ,CLO_LOAN_SOLD_SMRY_AMT
            ,CANC_SMRY_AMT
            ,PEND_IMPT_SMRY_CNT
            ,ENT_SMRY_CNT
            ,DI_HLD_SMRY_CNT
            ,VLD_SMRY_CNT
            ,PRFT_SMRY_CNT
            ,CR_HLD_SMRY_CNT
            ,SPLY_ABUSE_SMRY_CNT
            ,PEND_RE_SUBMT_SMRY_CNT
            ,BOOK_SMRY_CNT
            ,AWAIT_DROP_SHIP_SMRY_CNT
            ,PEND_RE_ALLOC_SMRY_CNT
            ,PO_CANC_SMRY_CNT
            ,PEND_FUFL_SMRY_CNT
            ,PEND_ALLOC_SMRY_CNT
            ,BO_SMRY_CNT
            ,PEND_PICK_SMRY_CNT
            ,DELY_TO_SHOP_SMRY_CNT
            ,IN_SHOP_CONFIG_SMRY_CNT
            ,PEND_SHIP_SMRY_CNT
            ,SHIP_SMRY_CNT
            ,PEND_DELY_CONF_SMRY_CNT
            ,PEND_ISTL_SMRY_CNT
            ,ON_LOAN_SMRY_CNT
            ,WAIT_RCPT_SMRY_CNT
            ,PEND_RTRN_SMRY_CNT
            ,PEND_INSP_SMRY_CNT
            ,RWS_CANC_SMRY_CNT
            ,PRTL_RCV_SMRY_CNT
            ,PEND_INV_SMRY_CNT
            ,BLLG_HLD_SMRY_CNT
            ,PEND_DLR_ISTL_SMRY_CNT
            ,SHIP_CLO_SMRY_CNT
            ,CLO_SMRY_CNT
            ,CLO_LOAN_RTRN_SMRY_CNT
            ,CLO_LOAN_SOLD_SMRY_CNT
            ,CANC_SMRY_CNT
        </isEqual>

            ,DPLY_BY_01_SUM_LINE_FLG
            ,DPLY_BY_01_ITEM_CD
            ,GROUPING01
            <isNotNull property="pairDplyByItemNm_01">
                ,DPLY_BY_01_ITEM_NM
            </isNotNull>
            <isNotNull property="cMsg.dplyBy02ItemNm">
                ,DPLY_BY_02_SUM_LINE_FLG
                ,DPLY_BY_02_ITEM_CD
                ,GROUPING02
                <isNotNull property="pairDplyByItemNm_02">
                    ,DPLY_BY_02_ITEM_NM
                </isNotNull>
            </isNotNull>
            <isNotNull property="cMsg.dplyBy03ItemNm">
                ,DPLY_BY_03_SUM_LINE_FLG
                ,DPLY_BY_03_ITEM_CD
                ,GROUPING03
                <isNotNull property="pairDplyByItemNm_03">
                    ,DPLY_BY_03_ITEM_NM
                </isNotNull>
            </isNotNull>
            ,GROUPING_ID
        FROM
            (
            SELECT
            <!-- Header -->
                GLBL_CMPY_CD
                ,SRC_REF_OR_CPO_ORD_NUM
            <isEqual property="cMsg.grpByDnldCd" compareValue="1">
                ,CUST_ISS_PO_NUM
                ,LEASE_CMPY_PO_NUM
                ,SOLD_TO_CUST_ACCT_NM
                ,SOLD_TO_CUST_ACCT_CD
                ,SOLD_TO_CUST_LOC_CD
                ,COA_BR_CD
                ,COA_BR_DESC_TXT
                ,COA_EXTN_CD
                ,COA_EXTN_DESC_TXT
                ,SLS_REP_TOC_CD
                ,SLS_REP_TOC_NM
                ,CPO_SRC_TP_CD
                ,CPO_SRC_TP_DESC_TXT
                ,DS_ORD_CATG_CD
                ,DS_ORD_CATG_DESC_TXT
                ,DS_ORD_TP_CD
                ,DS_ORD_TP_DESC_TXT
                ,DS_ORD_RSN_CD
                ,DS_ORD_RSN_DESC_TXT
                ,CSMP_CONTR_NUM
                ,ORD_SRC_REF_NUM
                ,CPO_ORD_TS
                ,ORD_BOOK_TS
                ,ORD_HDR_DPLY_STS_NM
                ,SLS_REP_PSN_NUM
                ,AQU_NUM
            </isEqual>
            <!-- Config -->
            <isEqual property="cMsg.grpByDnldCd" compareValue="2">
                ,SVC_CONFIG_MSTR_PK
                ,CUST_ISS_PO_NUM
                ,LEASE_CMPY_PO_NUM
                ,SOLD_TO_CUST_ACCT_NM
                ,SOLD_TO_CUST_ACCT_CD
                ,SOLD_TO_CUST_LOC_CD
                ,SHIP_TO_CUST_ACCT_NM
                ,SHIP_TO_CUST_ACCT_CD
                ,SHIP_TO_CUST_LOC_CD
                ,BILL_TO_CUST_ACCT_NM
                ,BILL_TO_CUST_ACCT_CD
                ,BILL_TO_CUST_LOC_CD
                ,COA_BR_CD
                ,COA_BR_DESC_TXT
                ,COA_EXTN_CD
                ,COA_EXTN_DESC_TXT
                ,SLS_REP_TOC_CD
                ,SLS_REP_TOC_NM
                ,CPO_SRC_TP_CD
                ,CPO_SRC_TP_DESC_TXT
                ,DS_ORD_CATG_CD
                ,DS_ORD_CATG_DESC_TXT
                ,DS_ORD_TP_CD
                ,DS_ORD_TP_DESC_TXT
                ,DS_ORD_RSN_CD
                ,DS_ORD_RSN_DESC_TXT
                ,CSMP_CONTR_NUM
                ,PRC_CONTR_NUM
                ,PRC_CONTR_NM
                ,ORD_SRC_REF_NUM
                ,MDL_ID
                ,T_MDL_NM
                ,CPO_ORD_TS
                ,ORD_BOOK_TS
                ,ORD_HDR_DPLY_STS_NM
                ,SLS_REP_PSN_NUM
                ,AQU_NUM
            </isEqual>
            <!-- Line -->
            <isEqual property="cMsg.grpByDnldCd" compareValue="3">
                ,CPO_DTL_LINE_NUM
                ,CPO_DTL_LINE_SUB_NUM
                ,DS_ORD_POSN_NUM
                ,DS_CPO_LINE_NUM
                ,DS_CPO_LINE_SUB_NUM
                ,DS_CPO_RTRN_LINE_NUM
                ,DS_CPO_RTRN_LINE_SUB_NUM
                ,DS_CPO_CONFIG_PK
                ,SHPG_PLN_NUM
                ,PRCH_REQ_NUM
                ,PO_ORD_NUM
                ,SO_NUM
                ,SO_SLP_NUM
                ,INV_NUM
                ,INV_BOL_LINE_NUM
                ,INV_LINE_NUM
                ,INV_LINE_SUB_NUM
                ,INV_LINE_SUB_TRX_NUM
                ,DS_INV_SLS_CR_PK
                ,ADD_ORIG_CPO_ORD_NUM
                ,CUST_ISS_PO_NUM
                ,LEASE_CMPY_PO_NUM
                ,SOLD_TO_CUST_ACCT_NM
                ,SOLD_TO_CUST_ACCT_CD
                ,SOLD_TO_CUST_LOC_CD
                ,SHIP_TO_CUST_ACCT_NM
                ,SHIP_TO_CUST_ACCT_CD
                ,SHIP_TO_CUST_LOC_CD
                ,BILL_TO_CUST_ACCT_NM
                ,BILL_TO_CUST_ACCT_CD
                ,BILL_TO_CUST_LOC_CD
                ,COA_BR_CD
                ,COA_BR_DESC_TXT
                ,COA_EXTN_CD
                ,COA_EXTN_DESC_TXT
                ,SLS_REP_TOC_CD
                ,SLS_REP_TOC_NM
                ,CPO_SRC_TP_CD
                ,CPO_SRC_TP_DESC_TXT
                ,DS_ORD_CATG_CD
                ,DS_ORD_CATG_DESC_TXT
                ,DS_ORD_TP_CD
                ,DS_ORD_TP_DESC_TXT
                ,DS_ORD_RSN_CD
                ,DS_ORD_RSN_DESC_TXT
                ,CSMP_CONTR_NUM
                ,PRC_CONTR_NUM
                ,PRC_CONTR_NM
                ,ORD_SRC_REF_NUM
                ,IMPT_STS_CD
                ,ZEROTH_PROD_CTRL_CD
                ,ZEROTH_PROD_CTRL_NM
                ,FIRST_PROD_CTRL_CD
                ,FIRST_PROD_CTRL_NM
                ,SCD_PROD_CTRL_CD
                ,SCD_PROD_CTRL_NM
                ,THIRD_PROD_CTRL_CD
                ,THIRD_PROD_CTRL_NM
                ,FRTH_PROD_CTRL_CD
                ,FRTH_PROD_CTRL_NM
                ,FIFTH_PROD_CTRL_CD
                ,FIFTH_PROD_CTRL_NM
                ,MDSE_CD
                ,MDSE_DESC_SHORT_TXT
                ,COA_PROD_CD
                ,COA_PROD_DESC_TXT
                ,COA_MDSE_TP_CD
                ,COA_MDSE_TP_DESC_TXT
                ,REV_COA_ACCT_CD
                ,REV_TRIAL_BAL_TP_CD
                ,MDL_ID
                ,T_MDL_NM
                ,SER_NUM
                ,RTRN_RSN_CD
                ,RTRN_RSN_DESC_TXT
                ,ACTL_SHIP_DT
                ,INV_DT
                ,ORD_LINE_SRC_CD
                ,ORD_LINE_SRC_NM
                ,RTL_WH_CD
                ,RTL_WH_NM
                <!-- 2018/12/13 QC#29024 Add Start -->
                ,RTL_WH_DESC_TXT
                <!-- 2018/12/13 QC#29024 Add End -->
                ,RTL_SWH_CD
                ,RTL_SWH_NM
                ,INVTY_LOC_CD
                ,VND_NM
                ,DPLY_VND_NM
                ,DROP_SHIP_FLG
                ,DS_CONTR_NUM
                ,SVC_CONFIG_MSTR_PK
                ,CRAT_BY_USR_ID
                ,CPO_ORD_TS
                ,ORD_BOOK_TS
                ,ORD_HDR_STS_CD
                ,ORD_LINE_STS_CD
                ,RTRN_LINE_STS_CD
                ,ORD_HDR_DPLY_STS_NM
                ,ORD_LINE_DPLY_STS_NM
                ,ORD_RTRN_LINE_DPLY_STS_NM
                ,CONFIG_CATG_CD
                ,SLS_REP_OR_SLS_TEAM_TOC_CD
                ,SLS_REP_OR_SLS_TEAM_TOC_NM
                ,ISTL_DT
                ,RDD_DT
                ,PSD_DT
                ,PDD_DT
                ,PRC_CATG_CD
                ,PRC_CATG_DESC_TXT
                ,TRX_CD
                ,TRX_RSN_CD
                ,DFRD_REV_FLG
                ,LINE_BIZ_TP_CD
                ,LINE_BIZ_TP_DESC_TXT
                ,DS_ORD_LINE_CATG_CD
                ,DS_ORD_LINE_CATG_DESC_TXT
                ,SVC_MACH_MSTR_PK
                ,ORD_AGING_BCKT_DESC_TXT
                ,ORD_SRC_IMPT_DT
                ,SLS_REP_PSN_NUM
                ,AQU_NUM
                <isEqual property="teamSearchFlg" compareValue="Y">
                ,ORD_ZN_DESC_TXT
                ,ORD_TEAM_MSTR_NM
                </isEqual>
            </isEqual>

            <isEqual property="cMsg.xxRsltModeCd" compareValue="1">
                ,SUM(NVL(ORD_QTY, 0))                                     AS ORD_QTY
                ,SUM(NVL(AMT, 0))                                         AS AMT
            </isEqual>

            <isEqual property="cMsg.xxRsltModeCd" compareValue="2">
                ,SUM(NVL(PEND_IMPT_SMRY_AMT, 0))                          AS PEND_IMPT_SMRY_AMT
                ,SUM(NVL(ENT_SMRY_AMT, 0))                                AS ENT_SMRY_AMT
                ,SUM(NVL(DI_HLD_SMRY_AMT, 0))                             AS DI_HLD_SMRY_AMT
                ,SUM(NVL(VLD_SMRY_AMT, 0))                                AS VLD_SMRY_AMT
                ,SUM(NVL(PRFT_SMRY_AMT, 0))                               AS PRFT_SMRY_AMT
                ,SUM(NVL(CR_HLD_SMRY_AMT, 0))                             AS CR_HLD_SMRY_AMT
                ,SUM(NVL(SPLY_ABUSE_SMRY_AMT, 0))                         AS SPLY_ABUSE_SMRY_AMT
                ,SUM(NVL(PEND_RE_SUBMT_SMRY_AMT, 0))                      AS PEND_RE_SUBMT_SMRY_AMT
                ,SUM(NVL(BOOK_SMRY_AMT, 0))                               AS BOOK_SMRY_AMT
                ,SUM(NVL(AWAIT_DROP_SHIP_SMRY_AMT, 0))                    AS AWAIT_DROP_SHIP_SMRY_AMT
                ,SUM(NVL(PEND_RE_ALLOC_SMRY_AMT, 0))                      AS PEND_RE_ALLOC_SMRY_AMT
                ,SUM(NVL(PO_CANC_SMRY_AMT, 0))                            AS PO_CANC_SMRY_AMT
                ,SUM(NVL(PEND_FUFL_SMRY_AMT, 0))                          AS PEND_FUFL_SMRY_AMT
                ,SUM(NVL(PEND_ALLOC_SMRY_AMT, 0))                         AS PEND_ALLOC_SMRY_AMT
                ,SUM(NVL(BO_SMRY_AMT, 0))                                 AS BO_SMRY_AMT
                ,SUM(NVL(PEND_PICK_SMRY_AMT, 0))                          AS PEND_PICK_SMRY_AMT
                ,SUM(NVL(DELY_TO_SHOP_SMRY_AMT, 0))                       AS DELY_TO_SHOP_SMRY_AMT
                ,SUM(NVL(IN_SHOP_CONFIG_SMRY_AMT, 0))                     AS IN_SHOP_CONFIG_SMRY_AMT
                ,SUM(NVL(PEND_SHIP_SMRY_AMT, 0))                          AS PEND_SHIP_SMRY_AMT
                ,SUM(NVL(SHIP_SMRY_AMT, 0))                               AS SHIP_SMRY_AMT
                ,SUM(NVL(PEND_DELY_CONF_SMRY_AMT, 0))                     AS PEND_DELY_CONF_SMRY_AMT
                ,SUM(NVL(PEND_ISTL_SMRY_AMT, 0))                          AS PEND_ISTL_SMRY_AMT
                ,SUM(NVL(ON_LOAN_SMRY_AMT, 0))                            AS ON_LOAN_SMRY_AMT
                ,SUM(NVL(WAIT_RCPT_SMRY_AMT, 0))                          AS WAIT_RCPT_SMRY_AMT
                ,SUM(NVL(PEND_RTRN_SMRY_AMT, 0))                          AS PEND_RTRN_SMRY_AMT
                ,SUM(NVL(PEND_INSP_SMRY_AMT, 0))                          AS PEND_INSP_SMRY_AMT
                ,SUM(NVL(RWS_CANC_SMRY_AMT, 0))                           AS RWS_CANC_SMRY_AMT
                ,SUM(NVL(PRTL_RCV_SMRY_AMT, 0))                           AS PRTL_RCV_SMRY_AMT
                ,SUM(NVL(PEND_INV_SMRY_AMT, 0))                           AS PEND_INV_SMRY_AMT
                ,SUM(NVL(BLLG_HLD_SMRY_AMT, 0))                           AS BLLG_HLD_SMRY_AMT
                ,SUM(NVL(PEND_DLR_ISTL_SMRY_AMT, 0))                      AS PEND_DLR_ISTL_SMRY_AMT
                ,SUM(NVL(SHIP_CLO_SMRY_AMT, 0))                           AS SHIP_CLO_SMRY_AMT
                ,SUM(NVL(CLO_SMRY_AMT, 0))                                AS CLO_SMRY_AMT
                ,SUM(NVL(CLO_LOAN_RTRN_SMRY_AMT, 0))                      AS CLO_LOAN_RTRN_SMRY_AMT
                ,SUM(NVL(CLO_LOAN_SOLD_SMRY_AMT, 0))                      AS CLO_LOAN_SOLD_SMRY_AMT
                ,SUM(NVL(CANC_SMRY_AMT, 0))                               AS CANC_SMRY_AMT
                ,COUNT(DISTINCT(PEND_IMPT_SMRY_CNT))                      AS PEND_IMPT_SMRY_CNT
                ,COUNT(DISTINCT(ENT_SMRY_CNT))                            AS ENT_SMRY_CNT
                ,COUNT(DISTINCT(DI_HLD_SMRY_CNT))                         AS DI_HLD_SMRY_CNT
                ,COUNT(DISTINCT(VLD_SMRY_CNT))                            AS VLD_SMRY_CNT
                ,COUNT(DISTINCT(PRFT_SMRY_CNT))                           AS PRFT_SMRY_CNT
                ,COUNT(DISTINCT(CR_HLD_SMRY_CNT))                         AS CR_HLD_SMRY_CNT
                ,COUNT(DISTINCT(SPLY_ABUSE_SMRY_CNT))                     AS SPLY_ABUSE_SMRY_CNT
                ,COUNT(DISTINCT(PEND_RE_SUBMT_SMRY_CNT))                  AS PEND_RE_SUBMT_SMRY_CNT
                ,COUNT(DISTINCT(BOOK_SMRY_CNT))                           AS BOOK_SMRY_CNT
                ,COUNT(DISTINCT(AWAIT_DROP_SHIP_SMRY_CNT))                AS AWAIT_DROP_SHIP_SMRY_CNT
                ,COUNT(DISTINCT(PEND_RE_ALLOC_SMRY_CNT))                  AS PEND_RE_ALLOC_SMRY_CNT
                ,COUNT(DISTINCT(PO_CANC_SMRY_CNT))                        AS PO_CANC_SMRY_CNT
                ,COUNT(DISTINCT(PEND_FUFL_SMRY_CNT))                      AS PEND_FUFL_SMRY_CNT
                ,COUNT(DISTINCT(PEND_ALLOC_SMRY_CNT))                     AS PEND_ALLOC_SMRY_CNT
                ,COUNT(DISTINCT(BO_SMRY_CNT))                             AS BO_SMRY_CNT
                ,COUNT(DISTINCT(PEND_PICK_SMRY_CNT))                      AS PEND_PICK_SMRY_CNT
                ,COUNT(DISTINCT(DELY_TO_SHOP_SMRY_CNT))                   AS DELY_TO_SHOP_SMRY_CNT
                ,COUNT(DISTINCT(IN_SHOP_CONFIG_SMRY_CNT))                 AS IN_SHOP_CONFIG_SMRY_CNT
                ,COUNT(DISTINCT(PEND_SHIP_SMRY_CNT))                      AS PEND_SHIP_SMRY_CNT
                ,COUNT(DISTINCT(SHIP_SMRY_CNT))                           AS SHIP_SMRY_CNT
                ,COUNT(DISTINCT(PEND_DELY_CONF_SMRY_CNT))                 AS PEND_DELY_CONF_SMRY_CNT
                ,COUNT(DISTINCT(PEND_ISTL_SMRY_CNT))                      AS PEND_ISTL_SMRY_CNT
                ,COUNT(DISTINCT(ON_LOAN_SMRY_CNT))                        AS ON_LOAN_SMRY_CNT
                ,COUNT(DISTINCT(WAIT_RCPT_SMRY_CNT))                      AS WAIT_RCPT_SMRY_CNT
                ,COUNT(DISTINCT(PEND_RTRN_SMRY_CNT))                      AS PEND_RTRN_SMRY_CNT
                ,COUNT(DISTINCT(PEND_INSP_SMRY_CNT))                      AS PEND_INSP_SMRY_CNT
                ,COUNT(DISTINCT(RWS_CANC_SMRY_CNT))                       AS RWS_CANC_SMRY_CNT
                ,COUNT(DISTINCT(PRTL_RCV_SMRY_CNT))                       AS PRTL_RCV_SMRY_CNT
                ,COUNT(DISTINCT(PEND_INV_SMRY_CNT))                       AS PEND_INV_SMRY_CNT
                ,COUNT(DISTINCT(BLLG_HLD_SMRY_CNT))                       AS BLLG_HLD_SMRY_CNT
                ,COUNT(DISTINCT(PEND_DLR_ISTL_SMRY_CNT))                  AS PEND_DLR_ISTL_SMRY_CNT
                ,COUNT(DISTINCT(SHIP_CLO_SMRY_CNT))                       AS SHIP_CLO_SMRY_CNT
                ,COUNT(DISTINCT(CLO_SMRY_CNT))                            AS CLO_SMRY_CNT
                ,COUNT(DISTINCT(CLO_LOAN_RTRN_SMRY_CNT))                  AS CLO_LOAN_RTRN_SMRY_CNT
                ,COUNT(DISTINCT(CLO_LOAN_SOLD_SMRY_CNT))                  AS CLO_LOAN_SOLD_SMRY_CNT
                ,COUNT(DISTINCT(CANC_SMRY_CNT))                           AS CANC_SMRY_CNT
            </isEqual>

                ,DECODE(GROUPING($cMsg.dplyBy01ItemNm$),0,'N','Y')        AS DPLY_BY_01_SUM_LINE_FLG
                ,$cMsg.dplyBy01ItemNm$                                    AS DPLY_BY_01_ITEM_CD
                ,GROUPING($cMsg.dplyBy01ItemNm$)                          AS GROUPING01
                <isNotNull property="pairDplyByItemNm_01">
                    ,$pairDplyByItemNm_01$                                AS DPLY_BY_01_ITEM_NM
                </isNotNull>
                <isNotNull property="cMsg.dplyBy02ItemNm">
                    ,DECODE(GROUPING($cMsg.dplyBy02ItemNm$),0,'N','Y')    AS DPLY_BY_02_SUM_LINE_FLG
                    ,$cMsg.dplyBy02ItemNm$                                AS DPLY_BY_02_ITEM_CD
                    ,GROUPING($cMsg.dplyBy02ItemNm$)                      AS GROUPING02
                    <isNotNull property="pairDplyByItemNm_02">
                        ,$pairDplyByItemNm_02$                            AS DPLY_BY_02_ITEM_NM
                    </isNotNull>
                </isNotNull>
                <isNotNull property="cMsg.dplyBy03ItemNm">
                    ,DECODE(GROUPING($cMsg.dplyBy03ItemNm$),0,'N','Y')    AS DPLY_BY_03_SUM_LINE_FLG
                    ,$cMsg.dplyBy03ItemNm$                                AS DPLY_BY_03_ITEM_CD
                    ,GROUPING($cMsg.dplyBy01ItemNm$)                      AS GROUPING03
                    <isNotNull property="pairDplyByItemNm_03">
                        ,$pairDplyByItemNm_03$                            AS DPLY_BY_03_ITEM_NM
                    </isNotNull>
                </isNotNull>
                ,GROUPING_ID (GLBL_CMPY_CD,$cMsg.dplyBy01ItemNm$
                <isNotNull property="cMsg.dplyBy02ItemNm">
                    ,$cMsg.dplyBy02ItemNm$
                </isNotNull>
                <isNotNull property="cMsg.dplyBy03ItemNm">
                    ,$cMsg.dplyBy03ItemNm$
                </isNotNull>
                )                                                         AS GROUPING_ID

            FROM
                (
        <isEqual property="searchOrdFlg" compareValue="Y">
                SELECT
                    DOO.GLBL_CMPY_CD                                      AS GLBL_CMPY_CD
                    ,DOO.SRC_REF_OR_CPO_ORD_NUM                           AS SRC_REF_OR_CPO_ORD_NUM
                    ,DOO.CPO_DTL_LINE_NUM                                 AS CPO_DTL_LINE_NUM
                    ,DOO.CPO_DTL_LINE_SUB_NUM                             AS CPO_DTL_LINE_SUB_NUM
                    ,DOO.DS_ORD_POSN_NUM                                  AS DS_ORD_POSN_NUM
                    ,DOO.DS_CPO_LINE_NUM                                  AS DS_CPO_LINE_NUM
                    ,DOO.DS_CPO_LINE_SUB_NUM                              AS DS_CPO_LINE_SUB_NUM
                    ,DOO.DS_CPO_RTRN_LINE_NUM                             AS DS_CPO_RTRN_LINE_NUM
                    ,DOO.DS_CPO_RTRN_LINE_SUB_NUM                         AS DS_CPO_RTRN_LINE_SUB_NUM
                    ,DOO.DS_CPO_CONFIG_PK                                 AS DS_CPO_CONFIG_PK
                    ,DOO.SHPG_PLN_NUM                                     AS SHPG_PLN_NUM
                    ,DOO.PRCH_REQ_NUM                                     AS PRCH_REQ_NUM
                    ,DOO.PO_ORD_NUM                                       AS PO_ORD_NUM
                    ,DOO.SO_NUM                                           AS SO_NUM
                    ,DOO.SO_SLP_NUM                                       AS SO_SLP_NUM
                    ,DOO.INV_NUM                                          AS INV_NUM
                    ,''                                                   AS INV_BOL_LINE_NUM
                    ,''                                                   AS INV_LINE_NUM
                    ,''                                                   AS INV_LINE_SUB_NUM
                    ,''                                                   AS INV_LINE_SUB_TRX_NUM
                    ,0                                                    AS DS_INV_SLS_CR_PK
                    ,DOO.ADD_ORIG_CPO_ORD_NUM                             AS ADD_ORIG_CPO_ORD_NUM
                    ,DOO.CUST_ISS_PO_NUM                                  AS CUST_ISS_PO_NUM
                    ,DOO.LEASE_CMPY_PO_NUM                                AS LEASE_CMPY_PO_NUM
                    ,DOO.SOLD_TO_CUST_ACCT_NM                             AS SOLD_TO_CUST_ACCT_NM
                    ,DOO.SOLD_TO_CUST_ACCT_CD                             AS SOLD_TO_CUST_ACCT_CD
                    ,DOO.SOLD_TO_CUST_LOC_CD                              AS SOLD_TO_CUST_LOC_CD
                    ,DOO.SHIP_TO_CUST_ACCT_NM                             AS SHIP_TO_CUST_ACCT_NM
                    ,DOO.SHIP_TO_CUST_ACCT_CD                             AS SHIP_TO_CUST_ACCT_CD
                    ,DOO.SHIP_TO_CUST_LOC_CD                              AS SHIP_TO_CUST_LOC_CD
                    ,DOO.BILL_TO_CUST_ACCT_NM                             AS BILL_TO_CUST_ACCT_NM                      
                    ,DOO.BILL_TO_CUST_ACCT_CD                             AS BILL_TO_CUST_ACCT_CD
                    ,DOO.BILL_TO_CUST_LOC_CD                              AS BILL_TO_CUST_LOC_CD
                    ,DOO.COA_BR_CD                                        AS COA_BR_CD
                    ,DOO.COA_BR_DESC_TXT                                  AS COA_BR_DESC_TXT
                    ,DOO.COA_EXTN_CD                                      AS COA_EXTN_CD
                    ,DOO.COA_EXTN_DESC_TXT                                AS COA_EXTN_DESC_TXT
                    ,DOO.SLS_REP_TOC_CD                                   AS SLS_REP_TOC_CD
                    ,DOO.SLS_REP_TOC_NM                                   AS SLS_REP_TOC_NM
                    ,DOO.CPO_SRC_TP_CD                                    AS CPO_SRC_TP_CD
                    ,DOO.CPO_SRC_TP_DESC_TXT                              AS CPO_SRC_TP_DESC_TXT
                    ,DOO.DS_ORD_CATG_CD                                   AS DS_ORD_CATG_CD
                    ,DOO.DS_ORD_CATG_DESC_TXT                             AS DS_ORD_CATG_DESC_TXT
                    ,DOO.DS_ORD_TP_CD                                     AS DS_ORD_TP_CD
                    ,DOO.DS_ORD_TP_DESC_TXT                               AS DS_ORD_TP_DESC_TXT
                    ,DOO.DS_ORD_RSN_CD                                    AS DS_ORD_RSN_CD
                    ,DOO.DS_ORD_RSN_DESC_TXT                              AS DS_ORD_RSN_DESC_TXT
                    ,DOO.CSMP_CONTR_NUM                                   AS CSMP_CONTR_NUM
                    ,DOO.PRC_CONTR_NUM                                    AS PRC_CONTR_NUM
                    ,DOO.PRC_CONTR_NM                                     AS PRC_CONTR_NM
                    ,DOO.ORD_SRC_REF_NUM                                  AS ORD_SRC_REF_NUM
                    ,DOO.IMPT_STS_CD                                      AS IMPT_STS_CD
                    ,DOO.ZEROTH_PROD_CTRL_CD                              AS ZEROTH_PROD_CTRL_CD
                    ,DOO.ZEROTH_PROD_CTRL_NM                              AS ZEROTH_PROD_CTRL_NM
                    ,DOO.FIRST_PROD_CTRL_CD                               AS FIRST_PROD_CTRL_CD
                    ,DOO.FIRST_PROD_CTRL_NM                               AS FIRST_PROD_CTRL_NM
                    ,DOO.SCD_PROD_CTRL_CD                                 AS SCD_PROD_CTRL_CD
                    ,DOO.SCD_PROD_CTRL_NM                                 AS SCD_PROD_CTRL_NM
                    ,DOO.THIRD_PROD_CTRL_CD                               AS THIRD_PROD_CTRL_CD
                    ,DOO.THIRD_PROD_CTRL_NM                               AS THIRD_PROD_CTRL_NM
                    ,DOO.FRTH_PROD_CTRL_CD                                AS FRTH_PROD_CTRL_CD
                    ,DOO.FRTH_PROD_CTRL_NM                                AS FRTH_PROD_CTRL_NM
                    ,DOO.FIFTH_PROD_CTRL_CD                               AS FIFTH_PROD_CTRL_CD
                    ,DOO.FIFTH_PROD_CTRL_NM                               AS FIFTH_PROD_CTRL_NM
                    ,DOO.MDSE_CD                                          AS MDSE_CD
                    ,DOO.MDSE_DESC_SHORT_TXT                              AS MDSE_DESC_SHORT_TXT
                    ,DOO.COA_PROD_CD                                      AS COA_PROD_CD
                    ,DOO.COA_PROD_DESC_TXT                                AS COA_PROD_DESC_TXT
                    ,DOO.COA_MDSE_TP_CD                                   AS COA_MDSE_TP_CD
                    ,DOO.COA_MDSE_TP_DESC_TXT                             AS COA_MDSE_TP_DESC_TXT
                    ,DOO.REV_COA_ACCT_CD                                  AS REV_COA_ACCT_CD
                    ,DOO.REV_TRIAL_BAL_TP_CD                              AS REV_TRIAL_BAL_TP_CD
                    ,DOO.MDL_ID                                           AS MDL_ID
                    ,DOO.T_MDL_NM                                         AS T_MDL_NM
                    ,DOO.SER_NUM                                          AS SER_NUM
                    ,DOO.RTRN_RSN_CD                                      AS RTRN_RSN_CD
                    ,DOO.RTRN_RSN_DESC_TXT                                AS RTRN_RSN_DESC_TXT
                    ,DOO.ACTL_SHIP_DT                                     AS ACTL_SHIP_DT
                    ,DOO.INV_DT                                           AS INV_DT
                    ,DOO.ORD_LINE_SRC_CD                                  AS ORD_LINE_SRC_CD
                    ,DOO.ORD_LINE_SRC_NM                                  AS ORD_LINE_SRC_NM
                    ,DOO.RTL_WH_CD                                        AS RTL_WH_CD
                    ,DOO.RTL_WH_NM                                        AS RTL_WH_NM
                    <!-- 2018/12/13 QC#29024 Add Start -->
                    ,DOO.RTL_WH_DESC_TXT                                  AS RTL_WH_DESC_TXT
                    <!-- 2018/12/13 QC#29024 Add End -->
                    ,DOO.RTL_SWH_CD                                       AS RTL_SWH_CD
                    ,DOO.RTL_SWH_NM                                       AS RTL_SWH_NM
                    ,DOO.INVTY_LOC_CD                                     AS INVTY_LOC_CD
                    ,DOO.VND_NM                                           AS VND_NM
                    ,DOO.DPLY_VND_NM                                      AS DPLY_VND_NM
                    ,DOO.DROP_SHIP_FLG                                    AS DROP_SHIP_FLG
                    ,DOO.DS_CONTR_NUM                                     AS DS_CONTR_NUM
                    ,DOO.SVC_CONFIG_MSTR_PK                               AS SVC_CONFIG_MSTR_PK
                    ,DOO.CRAT_BY_USR_ID                                   AS CRAT_BY_USR_ID
                    ,DOO.CPO_ORD_TS                                       AS CPO_ORD_TS
                    ,SUBSTR(DOO.ORD_BOOK_TS, 0 ,8)                        AS ORD_BOOK_TS
                    ,DOO.ORD_HDR_STS_CD                                   AS ORD_HDR_STS_CD
                    ,DOO.ORD_LINE_STS_CD                                  AS ORD_LINE_STS_CD
                    ,DOO.RTRN_LINE_STS_CD                                 AS RTRN_LINE_STS_CD
                    ,DOO.ORD_HDR_DPLY_STS_NM                              AS ORD_HDR_DPLY_STS_NM
                    ,DOO.ORD_LINE_DPLY_STS_NM                             AS ORD_LINE_DPLY_STS_NM
                    ,DOO.ORD_RTRN_LINE_DPLY_STS_NM                        AS ORD_RTRN_LINE_DPLY_STS_NM
                    ,DOO.CONFIG_CATG_CD                                   AS CONFIG_CATG_CD
                    ,DOO.SLS_REP_OR_SLS_TEAM_TOC_CD                       AS SLS_REP_OR_SLS_TEAM_TOC_CD
                    ,DOO.SLS_REP_OR_SLS_TEAM_TOC_NM                       AS SLS_REP_OR_SLS_TEAM_TOC_NM
                    ,DOO.ISTL_DT                                          AS ISTL_DT
                    ,DOO.RDD_DT                                           AS RDD_DT
                    ,DOO.PSD_DT                                           AS PSD_DT
                    ,DOO.PDD_DT                                           AS PDD_DT
                    ,DOO.PRC_CATG_CD                                      AS PRC_CATG_CD
                    ,DOO.PRC_CATG_DESC_TXT                                AS PRC_CATG_DESC_TXT
                    <!-- 2019/02/13 QC#29736 Mod Start -->
                    <!--,DOO.ORD_QTY                                          AS ORD_QTY-->
                    ,CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                        1
                     ELSE
                        DOO.ORD_QTY
                     END AS ORD_QTY
                    <!-- 2019/02/13 QC#29736 Mod End -->
                    ,DOO.CR_HLD_QTY                                       AS CR_HLD_QTY
                    ,DOO.CR_CHK_QTY                                       AS CR_CHK_QTY
                    ,DOO.SLS_HLD_QTY                                      AS SLS_HLD_QTY
                    <!-- 2019/02/13 QC#29736 Mod Start -->
                    <!--,NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0)) AS AMT -->
                    ,CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                        NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                     ELSE
                        NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                     END AS AMT
                     <!-- 2019/02/13 QC#29736 Mod End -->
                    ,DOO.ENT_CPO_DTL_FUNC_NET_AMT                         AS ENT_CPO_DTL_FUNC_NET_AMT
                    ,DOO.ENT_CPO_DTL_FUNC_SLS_AMT                         AS ENT_CPO_DTL_FUNC_SLS_AMT
                    ,DOO.SP_FUNC_UNIT_PRC_AMT                             AS SP_FUNC_UNIT_PRC_AMT
                    ,DOO.SP_FUNC_NET_UNIT_PRC_AMT                         AS SP_FUNC_NET_UNIT_PRC_AMT
                    ,DOO.SP_TOT_FUNC_NET_AMT                              AS SP_TOT_FUNC_NET_AMT
                    ,DOO.TRX_CD                                           AS TRX_CD
                    ,''                                                   AS TRX_RSN_CD
                    ,''                                                   AS DFRD_REV_FLG
                    ,DOO.LINE_BIZ_TP_CD                                   AS LINE_BIZ_TP_CD
                    ,DOO.LINE_BIZ_TP_DESC_TXT                             AS LINE_BIZ_TP_DESC_TXT
                    ,DOO.DS_ORD_LINE_CATG_CD                              AS DS_ORD_LINE_CATG_CD
                    ,DOO.DS_ORD_LINE_CATG_DESC_TXT                        AS DS_ORD_LINE_CATG_DESC_TXT
                    ,DOO.SVC_MACH_MSTR_PK                                 AS SVC_MACH_MSTR_PK
                    ,DOO.ORD_AGING_BCKT_DESC_TXT                          AS ORD_AGING_BCKT_DESC_TXT
                    ,DOO.ORD_SRC_IMPT_DT                                  AS ORD_SRC_IMPT_DT
                    ,DOO.SLS_REP_PSN_NUM                                  AS SLS_REP_PSN_NUM
                    ,DOO.AQU_NUM                                          AS AQU_NUM
                     <isEqual property="teamSearchFlg" compareValue="Y">
                    ,DOO.ORD_ZN_DESC_TXT                                 AS ORD_ZN_DESC_TXT
                    ,DOO.ORD_TEAM_MSTR_NM                                AS ORD_TEAM_MSTR_NM
                     </isEqual>
            <isEqual property="cMsg.xxRsltModeCd" compareValue="2">
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                       CASE DOO.ORD_HDR_DPLY_STS_NM
                           WHEN #stsPendImpt#
                           THEN
                               CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                   NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                               ELSE
                                   NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                               END
                           ELSE 0
                        END
                     ELSE 0
                     END                                                  AS PEND_IMPT_SMRY_AMT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsEnt#
                            THEN
                                CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                    NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                                ELSE
                                    NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                                END
                            ELSE 0
                         END
                     ELSE 0
                     END                                                  AS ENT_SMRY_AMT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsDiHld#
                            THEN
                                CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                    NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                                ELSE
                                    NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                                END
                            ELSE 0
                         END 
                     ELSE 0
                     END                                                  AS DI_HLD_SMRY_AMT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsVld#
                            THEN
                                CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                    NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                                ELSE
                                    NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                                END
                            ELSE 0
                         END
                     ELSE 0
                     END                                                  AS VLD_SMRY_AMT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsPrft#
                            THEN
                                CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                    NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                                ELSE
                                    NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                                END
                            ELSE 0
                         END
                     ELSE 0
                     END                                                  AS PRFT_SMRY_AMT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                       CASE DOO.ORD_HDR_DPLY_STS_NM
                           WHEN #stsCrHld#
                           THEN
                               CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                   NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                               ELSE
                                   NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                               END
                           ELSE 0
                        END
                     ELSE 0
                     END                                                  AS CR_HLD_SMRY_AMT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsSplyAbuse#
                            THEN
                                CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                    NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                                ELSE
                                    NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                                END
                            ELSE 0
                         END
                     ELSE 0
                     END                                                  AS SPLY_ABUSE_SMRY_AMT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsPendReSubmt#
                            THEN
                                CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                    NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                                ELSE
                                    NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                                END
                            ELSE 0
                         END
                     ELSE 0
                     END                                                  AS PEND_RE_SUBMT_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsBook# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsBook#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS BOOK_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsAwaitDropShip# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsAwaitDropShip#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS AWAIT_DROP_SHIP_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendReAlloc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendReAlloc#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_RE_ALLOC_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPoCanc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPoCanc#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PO_CANC_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendFufl# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendFufl#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_FUFL_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendAlloc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendAlloc#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_ALLOC_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsBo# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsBo#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS BO_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendPick# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendPick#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_PICK_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsDelyToShop# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsDelyToShop#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS DELY_TO_SHOP_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsInShopConfig# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsInShopConfig#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS IN_SHOP_CONFIG_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendShip# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendShip#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_SHIP_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsShip# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsShip#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS SHIP_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendDelyConf# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendDelyConf#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_DELY_CONF_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendIstl# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendIstl#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_ISTL_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsOnLoan# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsOnLoan#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS ON_LOAN_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsWaitRcpt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsWaitRcpt#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS WAIT_RCPT_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendRtrn# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendRtrn#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_RTRN_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendInsp# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendInsp#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_INSP_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsRwsCanc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsRwsCanc#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS RWS_CANC_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPrtlRcv# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPrtlRcv#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PRTL_RCV_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendInv# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendInv#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_INV_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsBllgHld# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsBllgHld#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS BLLG_HLD_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendDlrIstl# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendDlrIstl#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS PEND_DLR_ISTL_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsShipClo# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsShipClo#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS SHIP_CLO_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsClo# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsClo#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS CLO_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsCloLoanRtrn# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsCloLoanRtrn#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS CLO_LOAN_RTRN_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsCloLoanSold# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsCloLoanSold#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS CLO_LOAN_SOLD_SMRY_AMT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsCanc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsCanc#
                        THEN
                            CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                                NVL(DOO.SP_FUNC_NET_UNIT_PRC_AMT,NVL(DOO.ENT_FUNC_NET_UNIT_PRC_AMT,0))
                            ELSE
                                NVL(DOO.SP_TOT_FUNC_NET_AMT,NVL(DOO.ENT_CPO_DTL_FUNC_NET_AMT,0))
                            END
                        ELSE 0
                     END                                                  AS CANC_SMRY_AMT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsPendImpt# then SRC_REF_OR_CPO_ORD_NUM
                            ELSE null
                         END
                     ELSE null
                     END                                                  AS PEND_IMPT_SMRY_CNT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsEnt# then SRC_REF_OR_CPO_ORD_NUM
                            ELSE null
                         END
                     ELSE null
                     END                                                  AS ENT_SMRY_CNT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsDiHld# then SRC_REF_OR_CPO_ORD_NUM
                            ELSE null
                         END
                     ELSE null
                     END                                                  AS DI_HLD_SMRY_CNT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsVld# then SRC_REF_OR_CPO_ORD_NUM
                            ELSE null
                         END
                     ELSE null
                     END                                                  AS VLD_SMRY_CNT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsPrft# then SRC_REF_OR_CPO_ORD_NUM
                            ELSE null
                         END
                     ELSE null
                     END                                                  AS PRFT_SMRY_CNT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsCrHld# then SRC_REF_OR_CPO_ORD_NUM
                            ELSE null
                         END
                     ELSE null
                     END                                                  AS CR_HLD_SMRY_CNT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsSplyAbuse# then SRC_REF_OR_CPO_ORD_NUM
                            ELSE null
                         END
                     ELSE null
                     END                                                  AS SPLY_ABUSE_SMRY_CNT
                    ,CASE WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsLineEnt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsLineEnt# THEN
                        CASE DOO.ORD_HDR_DPLY_STS_NM
                            WHEN #stsPendReSubmt# then SRC_REF_OR_CPO_ORD_NUM
                            ELSE null
                         END
                     ELSE null
                     END                                                  AS PEND_RE_SUBMT_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsBook# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsBook#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS BOOK_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsAwaitDropShip# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsAwaitDropShip#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS AWAIT_DROP_SHIP_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendReAlloc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendReAlloc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_RE_ALLOC_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPoCanc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPoCanc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PO_CANC_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendFufl# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendFufl#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_FUFL_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendAlloc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendAlloc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_ALLOC_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsBo# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsBo#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS BO_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendPick# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendPick#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_PICK_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsDelyToShop# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsDelyToShop#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS DELY_TO_SHOP_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsInShopConfig# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsInShopConfig#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS IN_SHOP_CONFIG_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendShip# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendShip#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_SHIP_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsShip# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsShip#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS SHIP_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendDelyConf# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendDelyConf#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_DELY_CONF_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendIstl# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendIstl#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_ISTL_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsOnLoan# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsOnLoan#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS ON_LOAN_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsWaitRcpt# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsWaitRcpt#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS WAIT_RCPT_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendRtrn# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendRtrn#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_RTRN_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendInsp# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendInsp#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_INSP_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsRwsCanc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsRwsCanc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS RWS_CANC_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPrtlRcv# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPrtlRcv#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PRTL_RCV_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendInv# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendInv#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_INV_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsBllgHld# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsBllgHld#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS BLLG_HLD_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsPendDlrIstl# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendDlrIstl#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_DLR_ISTL_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsShipClo# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsShipClo#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS SHIP_CLO_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsClo# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsClo#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS CLO_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsCloLoanRtrn# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsCloLoanRtrn#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS CLO_LOAN_RTRN_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsCloLoanSold# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsCloLoanSold#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS CLO_LOAN_SOLD_SMRY_CNT
                    ,CASE
                        WHEN DOO.ORD_LINE_DPLY_STS_NM = #stsCanc# OR DOO.ORD_RTRN_LINE_DPLY_STS_NM = #stsCanc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS CANC_SMRY_CNT
            </isEqual>
                FROM
                        (
                        <isEqual property="realTimeInqFlg" compareValue="Y">
                        SELECT                             --RealTime search
                           DOO_IN.GLBL_CMPY_CD
                           ,DOO_IN.SRC_REF_OR_CPO_ORD_NUM
                           ,DOO_IN.CPO_DTL_LINE_NUM
                           ,DOO_IN.CPO_DTL_LINE_SUB_NUM
                           ,DOO_IN.DS_ORD_POSN_NUM
                           ,DOO_IN.DS_CPO_LINE_NUM
                           ,DOO_IN.DS_CPO_LINE_SUB_NUM
                           ,DOO_IN.DS_CPO_RTRN_LINE_NUM
                           ,DOO_IN.DS_CPO_RTRN_LINE_SUB_NUM
                           ,DOO_IN.DS_CPO_CONFIG_PK
                           ,DOO_IN.SHPG_PLN_NUM
                           ,DOO_IN.PRCH_REQ_NUM
                           ,DOO_IN.PO_ORD_NUM
                           ,DOO_IN.SO_NUM
                           ,DOO_IN.SO_SLP_NUM
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                              DOO_IN.INV_NUM
                            ELSE
                              I.INV_NUM
                            END                                                 AS INV_NUM
                           ,DOO_IN.ADD_ORIG_CPO_ORD_NUM
                           ,DOO_IN.CUST_ISS_PO_NUM
                           ,DOO_IN.LEASE_CMPY_PO_NUM
                           ,DOO_IN.SOLD_TO_CUST_ACCT_NM                        AS SOLD_TO_CUST_ACCT_NM
                           ,DOO_IN.SOLD_TO_CUST_ACCT_CD
                           ,DOO_IN.SOLD_TO_CUST_LOC_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.SHIP_TO_CUST_ACCT_NM
                             ELSE
                               CASE WHEN DOO_IN.DROP_SHIP_FLG = 'Y' THEN
                                 IB.SHIP_TO_LOC_NM
                               ELSE
                                 IB.SHIP_TO_CUST_ACCT_NM
                               END
                             END                                                AS SHIP_TO_CUST_ACCT_NM
                           ,DOO_IN.SHIP_TO_CUST_ACCT_CD
                           ,DOO_IN.SHIP_TO_CUST_LOC_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.BILL_TO_CUST_ACCT_NM
                             ELSE
                               I.BILL_TO_CUST_ACCT_NM
                             END                                                AS BILL_TO_CUST_ACCT_NM
                           ,DOO_IN.BILL_TO_CUST_ACCT_CD
                           ,DOO_IN.BILL_TO_CUST_LOC_CD
                           ,DOO_IN.COA_BR_CD
                           ,DOO_IN.COA_BR_DESC_TXT
                           ,DOO_IN.COA_EXTN_CD
                           ,DOO_IN.COA_EXTN_DESC_TXT
                           ,DOO_IN.SLS_REP_TOC_CD
                           ,DOO_IN.SLS_REP_TOC_NM
                           ,DOO_IN.CPO_SRC_TP_CD
                           ,DOO_IN.CPO_SRC_TP_DESC_TXT
                           ,DOO_IN.DS_ORD_CATG_CD
                           ,DOO_IN.DS_ORD_CATG_DESC_TXT
                           ,DOO_IN.DS_ORD_TP_CD
                           ,DOO_IN.DS_ORD_TP_DESC_TXT
                           ,DOO_IN.DS_ORD_RSN_CD
                           ,DOO_IN.DS_ORD_RSN_DESC_TXT
                           ,DOO_IN.CSMP_CONTR_NUM
                           ,DOO_IN.PRC_CONTR_NUM
                           ,DOO_IN.PRC_CONTR_NM
                           ,DOO_IN.ORD_SRC_REF_NUM
                           ,DOO_IN.IMPT_STS_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.ZEROTH_PROD_CTRL_CD
                             ELSE
                               IL.ZEROTH_PROD_CTRL_CD
                             END                                                 AS ZEROTH_PROD_CTRL_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.ZEROTH_PROD_CTRL_NM
                             ELSE
                               IL.ZEROTH_PROD_CTRL_NM
                             END                                                 AS ZEROTH_PROD_CTRL_NM
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.FIRST_PROD_CTRL_CD
                             ELSE
                               IL.FIRST_PROD_CTRL_CD
                             END                                                 AS FIRST_PROD_CTRL_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.FIRST_PROD_CTRL_NM
                             ELSE
                               IL.FIRST_PROD_CTRL_NM
                             END                                                 AS FIRST_PROD_CTRL_NM
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.SCD_PROD_CTRL_CD
                             ELSE
                               IL.SCD_PROD_CTRL_CD
                             END                                                 AS SCD_PROD_CTRL_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.SCD_PROD_CTRL_NM
                             ELSE
                               IL.SCD_PROD_CTRL_NM
                             END                                                 AS SCD_PROD_CTRL_NM
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.THIRD_PROD_CTRL_CD
                             ELSE
                               IL.THIRD_PROD_CTRL_CD
                             END                                                 AS THIRD_PROD_CTRL_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.THIRD_PROD_CTRL_NM
                             ELSE
                               IL.THIRD_PROD_CTRL_NM
                             END                                                 AS THIRD_PROD_CTRL_NM
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.FRTH_PROD_CTRL_CD
                             ELSE
                               IL.FRTH_PROD_CTRL_CD
                             END                                                 AS FRTH_PROD_CTRL_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.FRTH_PROD_CTRL_NM
                             ELSE
                               IL.FRTH_PROD_CTRL_NM
                             END                                                 AS FRTH_PROD_CTRL_NM
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.FIFTH_PROD_CTRL_CD
                             ELSE
                               IL.FIFTH_PROD_CTRL_CD
                             END                                                 AS FIFTH_PROD_CTRL_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.FIFTH_PROD_CTRL_NM
                             ELSE
                               IL.FIFTH_PROD_CTRL_NM
                             END                                                 AS FIFTH_PROD_CTRL_NM
                           ,DOO_IN.MDSE_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.MDSE_DESC_SHORT_TXT
                             ELSE
                               IL.MDSE_NM
                             END                                                 AS MDSE_DESC_SHORT_TXT
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.COA_PROD_CD
                             ELSE
                               IL.COA_PROD_CD
                             END                                                 AS COA_PROD_CD
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.COA_PROD_DESC_TXT
                             ELSE
                               IL.COA_PROD_NM
                             END                                                 AS COA_PROD_DESC_TXT
                           ,DOO_IN.COA_MDSE_TP_CD
                           ,DOO_IN.COA_MDSE_TP_DESC_TXT
                           ,DOO_IN.REV_COA_ACCT_CD
                           ,DOO_IN.REV_TRIAL_BAL_TP_CD
                           ,DOO_IN.MDL_ID
                           ,DOO_IN.T_MDL_NM
                           ,DOO_IN.SER_NUM
                           ,DOO_IN.RTRN_RSN_CD
                           ,DOO_IN.RTRN_RSN_DESC_TXT
                           ,DOO_IN.ACTL_SHIP_DT
                           ,CASE WHEN I.INV_NUM IS NULL THEN
                               DOO_IN.INV_DT
                             ELSE
                               I.INV_DT
                             END                                                 AS INV_DT
                           ,DOO_IN.ORD_LINE_SRC_CD
                           ,DOO_IN.ORD_LINE_SRC_NM
                           ,DOO_IN.RTL_WH_CD
                           ,DOO_IN.RTL_WH_NM
                           <!-- 2018/12/13 QC#29024 Add Start -->
                           ,DOO_IN.RTL_WH_DESC_TXT
                           <!-- 2018/12/13 QC#29024 Add End -->
                           ,DOO_IN.RTL_SWH_CD
                           ,DOO_IN.RTL_SWH_NM
                           ,DOO_IN.INVTY_LOC_CD
                           ,DOO_IN.VND_NM
                           ,DOO_IN.DPLY_VND_NM
                           ,DOO_IN.DROP_SHIP_FLG
                           ,DOO_IN.DS_CONTR_NUM
                           ,DOO_IN.SVC_CONFIG_MSTR_PK
                           ,DOO_IN.CRAT_BY_USR_ID
                           ,DOO_IN.CPO_ORD_TS
                           ,DOO_IN.ORD_BOOK_TS
                           ,DOO_IN.ORD_HDR_STS_CD
                           ,DOO_IN.ORD_LINE_STS_CD
                           ,DOO_IN.RTRN_LINE_STS_CD
                           ,DOO_IN.ORD_HDR_DPLY_STS_NM
                           ,DOO_IN.ORD_LINE_DPLY_STS_NM
                           ,DOO_IN.ORD_RTRN_LINE_DPLY_STS_NM
                           ,DOO_IN.CONFIG_CATG_CD
                           ,DOO_IN.SLS_REP_OR_SLS_TEAM_TOC_CD
                           ,DOO_IN.SLS_REP_OR_SLS_TEAM_TOC_NM
                           ,DOO_IN.ISTL_DT
                           ,DOO_IN.RDD_DT
                           ,DOO_IN.PSD_DT
                           ,DOO_IN.PDD_DT
                           ,DOO_IN.PRC_CATG_CD
                           ,DOO_IN.PRC_CATG_DESC_TXT
                           ,DOO_IN.ORD_QTY
                           ,DOO_IN.CR_HLD_QTY
                           ,DOO_IN.CR_CHK_QTY
                           ,DOO_IN.SLS_HLD_QTY
                           ,DOO_IN.ENT_CPO_DTL_FUNC_NET_AMT
                           ,DOO_IN.ENT_CPO_DTL_FUNC_SLS_AMT
                           ,DOO_IN.ENT_FUNC_NET_UNIT_PRC_AMT
                           ,DOO_IN.SP_FUNC_UNIT_PRC_AMT
                           ,DOO_IN.SP_FUNC_NET_UNIT_PRC_AMT
                           ,DOO_IN.SP_TOT_FUNC_NET_AMT
                           ,DOO_IN.LINE_BIZ_TP_CD
                           ,DOO_IN.LINE_BIZ_TP_DESC_TXT
                           ,DOO_IN.DS_ORD_LINE_CATG_CD
                           ,DOO_IN.DS_ORD_LINE_CATG_DESC_TXT
                           ,DOO_IN.SVC_MACH_MSTR_PK
                           ,DOO_IN.TRX_CD
                           ,DOO_IN.ORD_AGING_BCKT_DESC_TXT
                           ,DOO_IN.ORD_SRC_IMPT_DT
                           ,DOO_IN.DS_CPO_CRAT_USR_ID
                           ,DOO_IN.SLS_REP_PSN_NUM
                           ,DOO_IN.AQU_NUM
                            <isEqual property="teamSearchFlg" compareValue="Y">
                           ,TMZN.ORD_ZN_DESC_TXT                                 AS ORD_ZN_DESC_TXT
                           ,TMZN.ORD_TEAM_MSTR_NM                                AS ORD_TEAM_MSTR_NM
                            </isEqual>
                            <!-- 2019/02/25 QC#29736  ADD START -->
                           , COUNT(1) OVER ( 
                                            PARTITION BY
                                              DOO_IN.SRC_REF_OR_CPO_ORD_NUM
                                              , DOO_IN.SHPG_PLN_NUM
                                              , DOO_IN.CONFIG_CATG_CD
                                              , DOO_IN.DS_ORD_POSN_NUM
                                              , DOO_IN.DS_CPO_LINE_NUM
                                              , DOO_IN.DS_CPO_LINE_SUB_NUM
                                          ) AS COUNT_FOR_SER_NUM
                            <!-- 2019/02/25 QC#29736  ADD END -->
                        FROM
                        (
                           SELECT '0' AS EZCANCELFLAG,
                                  C.GLBL_CMPY_CD AS GLBL_CMPY_CD                             -- HEADER
                                                                ,
                                  C.CPO_ORD_NUM AS SRC_REF_OR_CPO_ORD_NUM,
                                  DTL.CPO_DTL_LINE_NUM AS CPO_DTL_LINE_NUM,
                                  DTL.CPO_DTL_LINE_SUB_NUM AS CPO_DTL_LINE_SUB_NUM,
                                  DTL.SRCH_LINE_NUM,
                                  DTL.SRCH_LINE_SUB_NUM,
                                  DTL.DS_ORD_POSN_NUM AS DS_ORD_POSN_NUM,
                                  DTL.DS_CPO_LINE_NUM AS DS_CPO_LINE_NUM,
                                  DTL.DS_CPO_LINE_SUB_NUM AS DS_CPO_LINE_SUB_NUM,
                                  DTL.DS_CPO_RTRN_LINE_NUM AS DS_CPO_RTRN_LINE_NUM,
                                  DTL.DS_CPO_RTRN_LINE_SUB_NUM AS DS_CPO_RTRN_LINE_SUB_NUM,
                                  DCC.DS_CPO_CONFIG_PK AS DS_CPO_CONFIG_PK,
                                  DTL.SHPG_PLN_NUM AS SHPG_PLN_NUM,
                                  DTL.PRCH_REQ_NUM AS PRCH_REQ_NUM,
                                  DTL.PO_ORD_NUM AS PO_ORD_NUM,
                                  DTL.SO_NUM AS SO_NUM,
                                  DTL.SO_SLP_NUM AS SO_SLP_NUM,
                                  DTL.INV_NUM AS INV_NUM,
                                  C.ADD_ORIG_CPO_ORD_NUM AS ADD_ORIG_CPO_ORD_NUM,
                                  C.CUST_ISS_PO_NUM AS CUST_ISS_PO_NUM,
                                  C.LEASE_CMPY_PO_NUM AS LEASE_CMPY_PO_NUM,
                                  DAC_SELL.DS_ACCT_NM AS SOLD_TO_CUST_ACCT_NM,
                                  C.SELL_TO_CUST_CD AS SOLD_TO_CUST_ACCT_CD,
                                  C.SOLD_TO_CUST_LOC_CD AS SOLD_TO_CUST_LOC_CD,
                                  DECODE(DTL.DROP_SHIP_FLG, 'Y', DTL.SHIP_TO_LOC_NM, NVL(DAC_SHIP.DS_ACCT_NM, DA_SHIP.DS_ACCT_NM)) AS SHIP_TO_CUST_ACCT_NM,
                                  NVL(DCC.SHIP_TO_CUST_ACCT_CD, C.SHIP_TO_CUST_ACCT_CD) AS SHIP_TO_CUST_ACCT_CD,
                                  NVL(DCC.SHIP_TO_CUST_LOC_CD, C.ADD_SHIP_TO_CUST_CD) AS SHIP_TO_CUST_LOC_CD,
                                  NVL(DAC_BILL.DS_ACCT_NM, DA_BILL.DS_ACCT_NM) AS BILL_TO_CUST_ACCT_NM,
                                  NVL(DCC.BILL_TO_CUST_ACCT_CD, C.BILL_TO_CUST_ACCT_CD) AS BILL_TO_CUST_ACCT_CD,
                                  NVL(DCC.BILL_TO_CUST_LOC_CD, C.BILL_TO_CUST_CD) AS BILL_TO_CUST_LOC_CD,
                                  TOC_H.COA_BR_CD AS COA_BR_CD,
                                  CB.COA_BR_DESC_TXT AS COA_BR_DESC_TXT,
                                  TOC_H.COA_EXTN_CD AS COA_EXTN_CD,
                                  CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT,
                                  C.SLS_REP_TOC_CD AS SLS_REP_TOC_CD,
                                  TOC_H.TOC_NM AS SLS_REP_TOC_NM,
                                  C.CPO_SRC_TP_CD AS CPO_SRC_TP_CD,
                                  CST.CPO_SRC_TP_DESC_TXT AS CPO_SRC_TP_DESC_TXT,
                                  C.DS_ORD_CATG_CD AS DS_ORD_CATG_CD,
                                  DOC.DS_ORD_CATG_DESC_TXT AS DS_ORD_CATG_DESC_TXT,
                                  C.DS_ORD_TP_CD AS DS_ORD_TP_CD,
                                  DOT.DS_ORD_TP_DESC_TXT AS DS_ORD_TP_DESC_TXT,
                                  C.DS_ORD_RSN_CD AS DS_ORD_RSN_CD,
                                  DOR.DS_ORD_RSN_DESC_TXT AS DS_ORD_RSN_DESC_TXT,
                                  C.CSMP_CONTR_NUM AS CSMP_CONTR_NUM,
                                  C.PRC_CONTR_NUM AS PRC_CONTR_NUM,
                                  PCR.PRC_CONTR_NM AS PRC_CONTR_NM,
                                  C.ORD_SRC_REF_NUM AS ORD_SRC_REF_NUM,
                                  DIO.IMPT_STS_CD AS IMPT_STS_CD                        -- CONFIG/LINE
                                                                ,
                                  NVL(MP.ZEROTH_PROD_CTRL_CD, MV.ZEROTH_PROD_CTRL_CD) AS ZEROTH_PROD_CTRL_CD,
                                  NVL(MP.ZEROTH_PROD_CTRL_NM, MV.ZEROTH_PROD_CTRL_NM) AS ZEROTH_PROD_CTRL_NM,
                                  NVL(MP.FIRST_PROD_CTRL_CD, MV.FIRST_PROD_CTRL_CD) AS FIRST_PROD_CTRL_CD,
                                  NVL(MP.FIRST_PROD_CTRL_NM, MV.FIRST_PROD_CTRL_NM) AS FIRST_PROD_CTRL_NM,
                                  NVL(MP.SCD_PROD_CTRL_CD, MV.SCD_PROD_CTRL_CD) AS SCD_PROD_CTRL_CD,
                                  NVL(MP.SCD_PROD_CTRL_NM, MV.SCD_PROD_CTRL_NM) AS SCD_PROD_CTRL_NM,
                                  NVL(MP.THIRD_PROD_CTRL_CD, MV.THIRD_PROD_CTRL_CD) AS THIRD_PROD_CTRL_CD,
                                  NVL(MP.THIRD_PROD_CTRL_NM, MV.THIRD_PROD_CTRL_NM) AS THIRD_PROD_CTRL_NM,
                                  NVL(MP.FRTH_PROD_CTRL_CD, MV.FRTH_PROD_CTRL_CD) AS FRTH_PROD_CTRL_CD,
                                  NVL(MP.FRTH_PROD_CTRL_NM, MV.FRTH_PROD_CTRL_NM) AS FRTH_PROD_CTRL_NM,
                                  NVL(MP.FIFTH_PROD_CTRL_CD, MV.FIFTH_PROD_CTRL_CD) AS FIFTH_PROD_CTRL_CD,
                                  NVL(MP.FIFTH_PROD_CTRL_NM, MV.FIFTH_PROD_CTRL_NM) AS FIFTH_PROD_CTRL_NM,
                                  DTL.MDSE_CD AS MDSE_CD,
                                  NVL(MP.MDSE_DESC_SHORT_TXT, MV.MDSE_DESC_SHORT_TXT) AS MDSE_DESC_SHORT_TXT,
                                  DTL.COA_PROD_CD AS COA_PROD_CD,
                                  NVL(CPP.COA_PROD_DESC_TXT, CP.COA_PROD_DESC_TXT) AS COA_PROD_DESC_TXT,
                                  NVL(MP.COA_MDSE_TP_CD, MV.COA_MDSE_TP_CD) AS COA_MDSE_TP_CD,
                                  NVL(CMTP.COA_PROJ_DESC_TXT, CMT.COA_PROJ_DESC_TXT) AS COA_MDSE_TP_DESC_TXT,
                                  NVL(MP.REV_COA_ACCT_CD, MV.REV_COA_ACCT_CD) AS REV_COA_ACCT_CD,
                                  NVL(CAP.TRIAL_BAL_TP_CD, CA.TRIAL_BAL_TP_CD) AS REV_TRIAL_BAL_TP_CD,
                                  DCC.MDL_ID AS MDL_ID,
                                  MN.T_MDL_NM AS T_MDL_NM,
                                  DTL.SER_NUM AS SER_NUM,
                                  DTL.RTRN_RSN_CD AS RTRN_RSN_CD,
                                  DTL.RTRN_RSN_DESC_TXT AS RTRN_RSN_DESC_TXT,
                                  DTL.ACTL_SHIP_DT AS ACTL_SHIP_DT,
                                  DTL.INV_DT AS INV_DT,
                                  DTL.ORD_LINE_SRC_CD AS ORD_LINE_SRC_CD,
                                  OLS.ORD_LINE_SRC_NM AS ORD_LINE_SRC_NM,
                                  DTL.RTL_WH_CD AS RTL_WH_CD,
                                  RW.RTL_WH_NM AS RTL_WH_NM,
                                  <!-- 2018/12/13 QC#29024 Add Start -->
                                  RW.RTL_WH_DESC_TXT,
                                  <!-- 2018/12/13 QC#29024 Add End -->
                                  DTL.RTL_SWH_CD AS RTL_SWH_CD,
                                  RSW.RTL_SWH_NM AS RTL_SWH_NM,
                                  DTL.INVTY_LOC_CD AS INVTY_LOC_CD,
                                  VND.LOC_NM AS VND_NM,
                                  DPLY_VND.DPLY_VND_NM AS DPLY_VND_NM,
                                  DTL.DROP_SHIP_FLG AS DROP_SHIP_FLG,
                                  DTL.DS_CONTR_NUM AS DS_CONTR_NUM,
                                  DCC.SVC_CONFIG_MSTR_PK AS SVC_CONFIG_MSTR_PK,
                                  C.ADMIN_PSN_CD AS CRAT_BY_USR_ID,
                                  C.CPO_ORD_TS AS CPO_ORD_TS,
                                  C.ORD_BOOK_TS AS ORD_BOOK_TS                               -- STATUS
                                                              ,
                                  C.ORD_HDR_STS_CD AS ORD_HDR_STS_CD,
                                  DTL.ORD_LINE_STS_CD AS ORD_LINE_STS_CD,
                                  DTL.RTRN_LINE_STS_CD AS RTRN_LINE_STS_CD,
                                  OHDS.ORD_HDR_DPLY_STS_DESC_TXT AS ORD_HDR_DPLY_STS_NM, -- OUTBOUND --
                                  NVL(SPDS.SHPG_PLN_DPLY_STS_DESC_TXT, OLDS.ORD_LINE_DPLY_STS_DESC_TXT) AS ORD_LINE_DPLY_STS_NM, -- INBOUND --
                                  RLDS.RTRN_LINE_DPLY_STS_DESC_TXT AS ORD_RTRN_LINE_DPLY_STS_NM -- LIST
                                                                                               ,
                                  DCC.CONFIG_CATG_CD AS CONFIG_CATG_CD,
                                  DTL.SLS_REP_OR_SLS_TEAM_TOC_CD AS SLS_REP_OR_SLS_TEAM_TOC_CD,
                                  TOC_D.TOC_NM AS SLS_REP_OR_SLS_TEAM_TOC_NM,
                                  DTL.ISTL_DT AS ISTL_DT,
                                  DTL.RDD_DT AS RDD_DT,
                                  DTL.PSD_DT AS PSD_DT,
                                  DTL.PDD_DT AS PDD_DT,
                                  DTL.PRC_CATG_CD AS PRC_CATG_CD,
                                  PC.PRC_CATG_DESC_TXT AS PRC_CATG_DESC_TXT,
                                  DTL.ORD_QTY AS ORD_QTY,
                                  DTL.CR_HLD_QTY AS CR_HLD_QTY,
                                  DTL.CR_CHK_QTY AS CR_CHK_QTY,
                                  DTL.SLS_HLD_QTY AS SLS_HLD_QTY,
                                  NVL(DTL.ENT_CPO_DTL_FUNC_NET_AMT, 0) AS ENT_CPO_DTL_FUNC_NET_AMT,
                                  NVL(DTL.ENT_CPO_DTL_FUNC_SLS_AMT, 0) AS ENT_CPO_DTL_FUNC_SLS_AMT,
                                  NVL(DTL.ENT_FUNC_NET_UNIT_PRC_AMT, 0) AS ENT_FUNC_NET_UNIT_PRC_AMT,
                                  DTL.SP_FUNC_UNIT_PRC_AMT AS SP_FUNC_UNIT_PRC_AMT,
                                  DTL.SP_FUNC_NET_UNIT_PRC_AMT AS SP_FUNC_NET_UNIT_PRC_AMT,
                                  DTL.SP_TOT_FUNC_NET_AMT AS SP_TOT_FUNC_NET_AMT,
                                  DOTPD.LINE_BIZ_TP_CD AS LINE_BIZ_TP_CD,
                                  LBT.LINE_BIZ_TP_DESC_TXT AS LINE_BIZ_TP_DESC_TXT,
                                  DTL.DS_ORD_LINE_CATG_CD AS DS_ORD_LINE_CATG_CD,
                                  OLC.DS_ORD_LINE_CATG_DESC_TXT AS DS_ORD_LINE_CATG_DESC_TXT,
                                  DTL.SVC_MACH_MSTR_PK AS SVC_MACH_MSTR_PK,
                                  DTL.TRX_CD AS TRX_CD,
                                  CASE
                                     WHEN   NVL(SPDS.SHPG_PLN_DPLY_STS_DESC_TXT, OLDS.ORD_LINE_DPLY_STS_DESC_TXT) = 'CLOSED'
                                     THEN
                                        'z.Close'
                                     WHEN   TO_DATE (DT.MGT_DT, 'YYYYMMDD') - TO_DATE (NVL (DTL.CPO_ORD_TS, C.CPO_ORD_TS), 'YYYYMMDD') = 0
                                     THEN
                                        'a.Today'
                                     WHEN   TO_DATE (DT.MGT_DT, 'YYYYMMDD') - TO_DATE (NVL (DTL.CPO_ORD_TS, C.CPO_ORD_TS), 'YYYYMMDD') <![CDATA[<=]]> 2
                                     THEN
                                        'b.1-2'
                                     WHEN   TO_DATE (DT.MGT_DT, 'YYYYMMDD') - TO_DATE (NVL (DTL.CPO_ORD_TS, C.CPO_ORD_TS), 'YYYYMMDD') <![CDATA[<=]]> 10
                                     THEN
                                        'c.3-10'
                                     WHEN   TO_DATE (DT.MGT_DT, 'YYYYMMDD') - TO_DATE (NVL (DTL.CPO_ORD_TS, C.CPO_ORD_TS), 'YYYYMMDD') <![CDATA[<=]]> 30
                                     THEN
                                        'd.11-30'
                                     WHEN   TO_DATE (DT.MGT_DT, 'YYYYMMDD') - TO_DATE (NVL (DTL.CPO_ORD_TS, C.CPO_ORD_TS), 'YYYYMMDD') <![CDATA[<=]]> 50
                                     THEN
                                        'e.31-50'
                                     ELSE
                                        'f.51+'
                                  END
                                     AS ORD_AGING_BCKT_DESC_TXT,
                                  SUBSTR (C.ORD_SRC_IMPT_TS, 0, 8) AS ORD_SRC_IMPT_DT,
                                  C.DS_CPO_CRAT_USR_ID AS DS_CPO_CRAT_USR_ID,
                                  SP.PSN_NUM AS SLS_REP_PSN_NUM,
                                  C.AQU_NUM AS AQU_NUM,
                                  DTL.TRX_SRC_TP_CD
                             FROM CPO C,
                                  DS_CPO_CONFIG DCC,
                                  (SELECT CD.GLBL_CMPY_CD AS GLBL_CMPY_CD,-- SAVE(EXCLUDE HEADER ONLY SAVE) OR CANCEL
                                          CD.CPO_ORD_NUM AS CPO_ORD_NUM,
                                          CD.CPO_DTL_LINE_NUM AS CPO_DTL_LINE_NUM,
                                          CD.CPO_DTL_LINE_SUB_NUM AS CPO_DTL_LINE_SUB_NUM,
                                          CD.CPO_DTL_LINE_NUM AS SRCH_LINE_NUM,
                                          CD.CPO_DTL_LINE_SUB_NUM AS SRCH_LINE_SUB_NUM,
                                          CD.DS_ORD_POSN_NUM AS DS_ORD_POSN_NUM,
                                          CD.DS_CPO_LINE_NUM AS DS_CPO_LINE_NUM,
                                          CD.DS_CPO_LINE_SUB_NUM AS DS_CPO_LINE_SUB_NUM,
                                          NULL AS DS_CPO_RTRN_LINE_NUM,
                                          NULL AS DS_CPO_RTRN_LINE_SUB_NUM,
                                          CD.DS_CPO_CONFIG_PK AS DS_CPO_CONFIG_PK,
                                          NULL AS SHPG_PLN_NUM,
                                          NULL AS PRCH_REQ_NUM,
                                          NULL AS PO_ORD_NUM,
                                          NULL AS SO_NUM,
                                          NULL AS SO_SLP_NUM,
                                          NULL AS INV_NUM,
                                          0 AS CR_HLD_QTY,
                                          0 AS CR_CHK_QTY,
                                          NULL AS SHPG_STS_CD,
                                          0 AS SLS_HLD_QTY,
                                          CD.CPO_DTL_HLD_FLG AS CPO_DTL_HLD_FLG,
                                          CD.SHOP_ITEM_FLG AS SHOP_ITEM_FLG,
                                          CD.MDSE_CD AS MDSE_CD,
                                          CD.COA_PROD_CD AS COA_PROD_CD,
                                          NVL(SMM.SER_NUM, CD.SER_NUM) AS SER_NUM,
                                          NULL AS RTRN_RSN_CD,
                                          NULL AS RTRN_RSN_DESC_TXT,
                                          NULL AS ACTL_SHIP_DT,
                                          CD.DS_ORD_LINE_CATG_CD AS DS_ORD_LINE_CATG_CD,
                                          CD.ORD_LINE_SRC_CD AS ORD_LINE_SRC_CD,
                                          CD.RTL_WH_CD AS RTL_WH_CD,
                                          CD.RTL_SWH_CD AS RTL_SWH_CD,
                                          CD.INVTY_LOC_CD AS INVTY_LOC_CD,
                                          CD.DROP_SHIP_FLG AS DROP_SHIP_FLG,
                                          CD.DS_CONTR_NUM AS DS_CONTR_NUM,
                                          CD.ORD_LINE_STS_CD AS ORD_LINE_STS_CD,
                                          NULL AS RTRN_LINE_STS_CD,
                                          CD.OPEN_FLG AS OPEN_FLG,
                                          CD.RDD_DT AS RDD_DT,
                                          NULL AS PSD_DT,
                                          NULL AS PDD_DT,
                                          CD.PRC_CATG_CD AS PRC_CATG_CD,
                                          CD.SLS_REP_OR_SLS_TEAM_TOC_CD AS SLS_REP_OR_SLS_TEAM_TOC_CD,
                                          CD.SVC_MACH_MSTR_PK AS SVC_MACH_MSTR_PK,
                                          CD.ORD_QTY AS ORD_QTY,
                                          CD.ENT_CPO_DTL_FUNC_NET_AMT AS ENT_CPO_DTL_FUNC_NET_AMT,
                                          CD.ENT_CPO_DTL_FUNC_SLS_AMT AS ENT_CPO_DTL_FUNC_SLS_AMT,
                                          CD.ENT_FUNC_NET_UNIT_PRC_AMT AS ENT_FUNC_NET_UNIT_PRC_AMT,
                                          NULL AS SP_FUNC_UNIT_PRC_AMT,
                                          NULL AS SP_FUNC_NET_UNIT_PRC_AMT,
                                          NULL AS SP_TOT_FUNC_NET_AMT,
                                          CD.CPO_ORD_TS AS CPO_ORD_TS,
                                          NULL AS TRX_CD,
                                          CD.LOAN_BAL_QTY AS LOAN_BAL_QTY,
                                          'N' AS PO_REQ_FLG,
                                          CD.REF_CPO_DTL_LINE_NUM AS REF_CPO_DTL_LINE_NUM,
                                          CD.REF_CPO_DTL_LINE_SUB_NUM AS REF_CPO_DTL_LINE_SUB_NUM,
                                          CD.DS_CPO_DTL_CRAT_TS AS DS_CPO_DTL_CRAT_TS,
                                          CD.ORD_LINE_DPLY_STS_CD AS ORD_LINE_DPLY_STS_CD,
                                          NULL AS SHPG_PLN_DPLY_STS_CD,
                                          NULL AS RTRN_LINE_DPLY_STS_CD,
                                          NULL AS INV_DT,
                                          CD.SHIP_TO_LOC_NM AS SHIP_TO_LOC_NM,
                                          NULL AS ISTL_DT,
                                          '010' AS TRX_SRC_TP_CD
                                     FROM CPO_DTL CD,
                                          CPO C,
                                          SVC_MACH_MSTR SMM
                                    WHERE     CD.GLBL_CMPY_CD = C.GLBL_CMPY_CD
                                          AND CD.CPO_ORD_NUM = C.CPO_ORD_NUM
                                          AND (CD.ORD_LINE_STS_CD = '00' OR CD.ORD_LINE_STS_CD = '99')
                                          AND CD.EZCANCELFLAG = '0'
                                          AND C.EZCANCELFLAG = '0'
                                          AND NOT EXISTS(SELECT '1' 
                                                           FROM SHPG_PLN SP 
                                                          WHERE CD.GLBL_CMPY_CD = SP.GLBL_CMPY_CD
                                                                AND CD.CPO_ORD_NUM = SP.TRX_HDR_NUM
                                                                AND CD.CPO_DTL_LINE_NUM = SP.TRX_LINE_NUM
                                                                AND CD.CPO_DTL_LINE_SUB_NUM = SP.TRX_LINE_SUB_NUM
                                                                AND SP.EZCANCELFLAG = '0')
                                          AND CD.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK(+)
                                          AND CD.GLBL_CMPY_CD = SMM.GLBL_CMPY_CD(+)
                                          AND SMM.EZCANCELFLAG(+) = '0'
                                         <!--2019/02/13 QC#30238 Add Start  -->
                                         <isNotNull property="ORDER_NUMBER">
                                          AND C.CPO_ORD_NUM LIKE #ORDER_NUMBER#
                                         </isNotNull>
                                         <!--2019/02/13 QC#30238 Add End  -->
                                         <isNotNull property="searchQuickCondition">
                                                $searchQuickCondition$
                                         </isNotNull>
                                   UNION ALL
                                   SELECT CD.GLBL_CMPY_CD AS GLBL_CMPY_CD,-- AFTER VALIDATED AND S/O
                                          CD.CPO_ORD_NUM AS CPO_ORD_NUM,
                                          CD.CPO_DTL_LINE_NUM AS CPO_DTL_LINE_NUM,
                                          CD.CPO_DTL_LINE_SUB_NUM AS CPO_DTL_LINE_SUB_NUM,
                                          CD.CPO_DTL_LINE_NUM AS SRCH_LINE_NUM,
                                          CD.CPO_DTL_LINE_SUB_NUM AS SRCH_LINE_SUB_NUM,
                                          CD.DS_ORD_POSN_NUM AS DS_ORD_POSN_NUM,
                                          CD.DS_CPO_LINE_NUM AS DS_CPO_LINE_NUM,
                                          CD.DS_CPO_LINE_SUB_NUM AS DS_CPO_LINE_SUB_NUM,
                                          NULL AS DS_CPO_RTRN_LINE_NUM,
                                          NULL AS DS_CPO_RTRN_LINE_SUB_NUM,
                                          CD.DS_CPO_CONFIG_PK AS DS_CPO_CONFIG_PK,
                                          SP.SHPG_PLN_NUM AS SHPG_PLN_NUM,
                                          NULL AS PRCH_REQ_NUM,
                                          SP.PO_ORD_NUM AS PO_ORD_NUM,
                                          SP.SO_NUM AS SO_NUM,
                                          SP.SO_SLP_NUM AS SO_SLP_NUM,
                                          SP.INV_NUM AS INV_NUM,
                                          NVL (SP.CR_HLD_QTY, 0) AS CR_HLD_QTY,
                                          NVL (SP.CR_CHK_QTY, 0) AS CR_CHK_QTY,
                                          SP.SHPG_STS_CD AS SHPG_STS_CD,
                                          NVL (SP.SLS_HLD_QTY, 0) AS SLS_HLD_QTY,
                                          CD.CPO_DTL_HLD_FLG AS CPO_DTL_HLD_FLG,
                                          CD.SHOP_ITEM_FLG AS SHOP_ITEM_FLG,
                                          NVL (SP.MDSE_CD, CD.MDSE_CD) AS MDSE_CD,
                                          CD.COA_PROD_CD AS COA_PROD_CD,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- NVL(SSN.SER_NUM, NVL(SMM.SER_NUM, CD.SER_NUM)) AS SER_NUM, -->
                                          NVL(SSN.SER_NUM, NVL(SMMH.SER_NUM, CD.SER_NUM)) AS SER_NUM,
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          NULL AS RTRN_RSN_CD,
                                          NULL AS RTRN_RSN_DESC_TXT,
                                          SP.ACTL_SHIP_DT AS ACTL_SHIP_DT,
                                          CD.DS_ORD_LINE_CATG_CD AS DS_ORD_LINE_CATG_CD,
                                          CD.ORD_LINE_SRC_CD AS ORD_LINE_SRC_CD,
                                          CD.RTL_WH_CD AS RTL_WH_CD,
                                          CD.RTL_SWH_CD AS RTL_SWH_CD,
                                          NVL (SP.INVTY_LOC_CD, CD.INVTY_LOC_CD) AS INVTY_LOC_CD,
                                          NVL (SP.DROP_SHIP_FLG, CD.DROP_SHIP_FLG) AS DROP_SHIP_FLG,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- CD.DS_CONTR_NUM AS DS_CONTR_NUM, -->
                                          NVL(CD.DS_CONTR_NUM, DC.DS_CONTR_NUM) AS DS_CONTR_NUM,
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          CD.ORD_LINE_STS_CD AS ORD_LINE_STS_CD,
                                          NULL AS RTRN_LINE_STS_CD,
                                          CD.OPEN_FLG AS OPEN_FLG,
                                          NVL (SP.RDD_DT, CD.RDD_DT) AS RDD_DT,
                                          SP.PSD_DT AS PSD_DT,
                                          SP.PDD_DT AS PDD_DT,
                                          NVL (SP.PRC_CATG_CD, CD.PRC_CATG_CD) AS PRC_CATG_CD,
                                          CD.SLS_REP_OR_SLS_TEAM_TOC_CD AS SLS_REP_OR_SLS_TEAM_TOC_CD,
                                          CD.SVC_MACH_MSTR_PK AS SVC_MACH_MSTR_PK,
                                          NVL (SP.ORD_QTY, CD.ORD_QTY) AS ORD_QTY,
                                          CD.ENT_CPO_DTL_FUNC_NET_AMT AS ENT_CPO_DTL_FUNC_NET_AMT,
                                          CD.ENT_CPO_DTL_FUNC_SLS_AMT AS ENT_CPO_DTL_FUNC_SLS_AMT,
                                          CD.ENT_FUNC_NET_UNIT_PRC_AMT AS ENT_FUNC_NET_UNIT_PRC_AMT,
                                          SP.SP_FUNC_UNIT_PRC_AMT AS SP_FUNC_UNIT_PRC_AMT,
                                          SP.SP_FUNC_NET_UNIT_PRC_AMT AS SP_FUNC_NET_UNIT_PRC_AMT,
                                          SP.SP_TOT_FUNC_NET_AMT AS SP_TOT_FUNC_NET_AMT,
                                          CD.CPO_ORD_TS AS CPO_ORD_TS,
                                          SP.TRX_CD AS TRX_CD,
                                          CD.LOAN_BAL_QTY AS LOAN_BAL_QTY,
                                          SP.PO_REQ_FLG AS PO_REQ_FLG,
                                          CD.REF_CPO_DTL_LINE_NUM AS REF_CPO_DTL_LINE_NUM,
                                          CD.REF_CPO_DTL_LINE_SUB_NUM AS REF_CPO_DTL_LINE_SUB_NUM,
                                          CD.DS_CPO_DTL_CRAT_TS AS DS_CPO_DTL_CRAT_TS,
                                          CD.ORD_LINE_DPLY_STS_CD AS ORD_LINE_DPLY_STS_CD,
                                          SP.SHPG_PLN_DPLY_STS_CD AS SHPG_PLN_DPLY_STS_CD,
                                          NULL AS RTRN_LINE_DPLY_STS_CD,
                                          NULL AS INV_DT,
                                          SP.SHIP_TO_LOC_NM AS SHIP_TO_LOC_NM,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!--  SMM.ISTL_DT AS ISTL_DT, -->
                                          SMMH.ISTL_DT AS ISTL_DT,
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          '010' AS TRX_SRC_TP_CD
                                     FROM CPO_DTL CD,
                                          SHPG_PLN SP,
                                          CPO C,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                       <!-- SVC_MACH_MSTR SMM, -->
                                       (SELECT
                                            HIST.CPO_ORD_NUM,
                                            HIST.CPO_DTL_LINE_NUM,
                                            HIST.CPO_DTL_LINE_SUB_NUM,
                                            HIST.SER_NUM,
                                            MAX(HIST.ISTL_DT) AS ISTL_DT
                                        FROM
                                            SVC_MACH_MSTR_HIST HIST
                                        WHERE
                                                HIST.EZCANCELFLAG = '0'
                                            AND HIST.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND (HIST.SVC_MACH_MSTR_STS_CD = 'INSTL'
                                            OR  HIST.SVC_MACH_MSTR_STS_CD IS NULL)
                                            AND HIST.CPO_ORD_NUM IS NOT NULL
                                            AND HIST.CPO_DTL_LINE_NUM IS NOT NULL
                                            AND HIST.CPO_DTL_LINE_SUB_NUM IS NOT NULL
                                        GROUP BY
                                            HIST.CPO_ORD_NUM,
                                            HIST.CPO_DTL_LINE_NUM,
                                            HIST.CPO_DTL_LINE_SUB_NUM,
                                            HIST.SER_NUM
                                       ) SMMH,
                                       (SELECT
                                            DCD.CPO_ORD_NUM,
                                            DCD.CPO_DTL_LINE_NUM,
                                            DCD.CPO_DTL_LINE_SUB_NUM,
                                            MIN(DC.DS_CONTR_NUM) DS_CONTR_NUM
                                        FROM
                                            DS_CONTR DC,
                                            DS_CONTR_DTL DCD
                                        WHERE
                                                DC.EZCANCELFLAG = '0'
                                            AND DC.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND DCD.EZCANCELFLAG = '0'
                                            AND DCD.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND DC.DS_CONTR_PK = DCD.DS_CONTR_PK
                                            AND DC.DS_CONTR_CATG_CD IN ('REG','FLT','AGG')
                                            AND DCD.CPO_ORD_NUM IS NOT NULL
                                            AND DCD.CPO_DTL_LINE_NUM IS NOT NULL
                                            AND DCD.CPO_DTL_LINE_SUB_NUM IS NOT NULL
                                        GROUP BY
                                            DCD.CPO_ORD_NUM,
                                            DCD.CPO_DTL_LINE_NUM,
                                            DCD.CPO_DTL_LINE_SUB_NUM
                                       ) DC,
                                       <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          SHIP_SER_NUM SSN
                                    WHERE     CD.GLBL_CMPY_CD = SP.GLBL_CMPY_CD
                                          AND CD.CPO_ORD_NUM = SP.TRX_HDR_NUM
                                          AND CD.CPO_DTL_LINE_NUM = SP.TRX_LINE_NUM
                                          AND CD.CPO_DTL_LINE_SUB_NUM = SP.TRX_LINE_SUB_NUM
                                          AND SP.PO_REQ_FLG = 'N'
                                          AND CD.GLBL_CMPY_CD = C.GLBL_CMPY_CD
                                          AND CD.CPO_ORD_NUM = C.CPO_ORD_NUM
                                          AND CD.EZCANCELFLAG = '0'
                                          AND SP.EZCANCELFLAG = '0'
                                          AND C.EZCANCELFLAG = '0'
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- AND CD.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK(+) -->
                                          <!-- AND CD.GLBL_CMPY_CD = SMM.GLBL_CMPY_CD(+) -->
                                          <!-- AND SMM.EZCANCELFLAG(+) = '0' -->
                                          AND CD.CPO_ORD_NUM = SMMH.CPO_ORD_NUM(+)
                                          AND CD.CPO_DTL_LINE_NUM = SMMH.CPO_DTL_LINE_NUM(+)
                                          AND CD.CPO_DTL_LINE_SUB_NUM = SMMH.CPO_DTL_LINE_SUB_NUM(+)
                                          AND SSN.SER_NUM = SMMH.SER_NUM(+)
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          AND SP.GLBL_CMPY_CD = SSN.GLBL_CMPY_CD(+)
                                          AND SP.SO_NUM = SSN.SO_NUM(+)
                                          AND SP.SO_SLP_NUM = SSN.SO_SLP_NUM(+)
                                          AND SSN.EZCANCELFLAG(+) = '0'
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, ADD] -->
                                          AND CD.CPO_ORD_NUM = DC.CPO_ORD_NUM(+)
                                          AND CD.CPO_DTL_LINE_NUM = DC.CPO_DTL_LINE_NUM(+)
                                          AND CD.CPO_DTL_LINE_SUB_NUM = DC.CPO_DTL_LINE_SUB_NUM(+)
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, ADD] -->
                                         <!--2019/02/13 QC#30238 Add Start  -->
                                         <isNotNull property="ORDER_NUMBER">
                                          AND C.CPO_ORD_NUM LIKE #ORDER_NUMBER#
                                         </isNotNull>
                                         <!--2019/02/13 QC#30238 Add End  -->
                                          <isNotNull property="searchQuickCondition">
                                                $searchQuickCondition$
                                         </isNotNull>
                                   UNION ALL
                                   SELECT CD.GLBL_CMPY_CD AS GLBL_CMPY_CD, -- AFTER VALIDATED AND P/O
                                          CD.CPO_ORD_NUM AS CPO_ORD_NUM,
                                          CD.CPO_DTL_LINE_NUM AS CPO_DTL_LINE_NUM,
                                          CD.CPO_DTL_LINE_SUB_NUM AS CPO_DTL_LINE_SUB_NUM,
                                          CD.CPO_DTL_LINE_NUM AS SRCH_LINE_NUM,
                                          CD.CPO_DTL_LINE_SUB_NUM AS SRCH_LINE_SUB_NUM,
                                          CD.DS_ORD_POSN_NUM AS DS_ORD_POSN_NUM,
                                          CD.DS_CPO_LINE_NUM AS DS_CPO_LINE_NUM,
                                          CD.DS_CPO_LINE_SUB_NUM AS DS_CPO_LINE_SUB_NUM,
                                          NULL AS DS_CPO_RTRN_LINE_NUM,
                                          NULL AS DS_CPO_RTRN_LINE_SUB_NUM,
                                          CD.DS_CPO_CONFIG_PK AS DS_CPO_CONFIG_PK,
                                          SP.SHPG_PLN_NUM AS SHPG_PLN_NUM,
                                          <!--2019/01/21 QC#29741 Mod Start-->
                                          <!--PD.PRCH_REQ_NUM AS PRCH_REQ_NUM,-->
                                          NVL (PD.PRCH_REQ_NUM, PRD.PRCH_REQ_NUM) AS PRCH_REQ_NUM,
                                          <!--2019/01/21 QC#29741 Mod End-->
                                          SP.PO_ORD_NUM AS PO_ORD_NUM,
                                          SP.SO_NUM AS SO_NUM,
                                          SP.SO_SLP_NUM AS SO_SLP_NUM,
                                          SP.INV_NUM AS INV_NUM,
                                          SP.CR_HLD_QTY AS CR_HLD_QTY,
                                          SP.CR_CHK_QTY AS CR_CHK_QTY,
                                          SP.SHPG_STS_CD AS SHPG_STS_CD,
                                          SP.SLS_HLD_QTY AS SLS_HLD_QTY,
                                          CD.CPO_DTL_HLD_FLG AS CPO_DTL_HLD_FLG,
                                          CD.SHOP_ITEM_FLG AS SHOP_ITEM_FLG,
                                          NVL (SP.MDSE_CD, CD.MDSE_CD) AS MDSE_CD,
                                          CD.COA_PROD_CD AS COA_PROD_CD,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- NVL(PSN.SER_NUM, NVL(SMM.SER_NUM, CD.SER_NUM)) AS SER_NUM, -->
                                          NVL(PSN.SER_NUM, NVL(SMMH.SER_NUM, CD.SER_NUM)) AS SER_NUM,
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          NULL AS RTRN_RSN_CD,
                                          NULL AS RTRN_RSN_DESC_TXT,
                                          SP.ACTL_SHIP_DT AS ACTL_SHIP_DT,
                                          CD.DS_ORD_LINE_CATG_CD AS DS_ORD_LINE_CATG_CD,
                                          CD.ORD_LINE_SRC_CD AS ORD_LINE_SRC_CD,
                                          CD.RTL_WH_CD AS RTL_WH_CD,
                                          CD.RTL_SWH_CD AS RTL_SWH_CD,
                                          SP.INVTY_LOC_CD AS INVTY_LOC_CD,
                                          SP.DROP_SHIP_FLG AS DROP_SHIP_FLG,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- CD.DS_CONTR_NUM AS DS_CONTR_NUM, -->
                                          NVL(CD.DS_CONTR_NUM, DC.DS_CONTR_NUM) AS DS_CONTR_NUM,
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          CD.ORD_LINE_STS_CD AS ORD_LINE_STS_CD,
                                          NULL AS RTRN_LINE_STS_CD,
                                          CD.OPEN_FLG AS OPEN_FLG,
                                          SP.RDD_DT AS RDD_DT,
                                          SP.PSD_DT AS PSD_DT,
                                          SP.PDD_DT AS PDD_DT,
                                          SP.PRC_CATG_CD AS PRC_CATG_CD,
                                          CD.SLS_REP_OR_SLS_TEAM_TOC_CD AS SLS_REP_OR_SLS_TEAM_TOC_CD,
                                          CD.SVC_MACH_MSTR_PK AS SVC_MACH_MSTR_PK,
                                          NVL (SP.ORD_QTY, CD.ORD_QTY) AS ORD_QTY,
                                          CD.ENT_CPO_DTL_FUNC_NET_AMT AS ENT_CPO_DTL_FUNC_NET_AMT,
                                          CD.ENT_CPO_DTL_FUNC_SLS_AMT AS ENT_CPO_DTL_FUNC_SLS_AMT,
                                          CD.ENT_FUNC_NET_UNIT_PRC_AMT AS ENT_FUNC_NET_UNIT_PRC_AMT,
                                          SP.SP_FUNC_UNIT_PRC_AMT AS SP_FUNC_UNIT_PRC_AMT,
                                          SP.SP_FUNC_NET_UNIT_PRC_AMT AS SP_FUNC_NET_UNIT_PRC_AMT,
                                          SP.SP_TOT_FUNC_NET_AMT AS SP_TOT_FUNC_NET_AMT,
                                          CD.CPO_ORD_TS AS CPO_ORD_TS,
                                          SP.TRX_CD AS TRX_CD,
                                          CD.LOAN_BAL_QTY AS LOAN_BAL_QTY,
                                          SP.PO_REQ_FLG AS PO_REQ_FLG,
                                          CD.REF_CPO_DTL_LINE_NUM AS REF_CPO_DTL_LINE_NUM,
                                          CD.REF_CPO_DTL_LINE_SUB_NUM AS REF_CPO_DTL_LINE_SUB_NUM,
                                          CD.DS_CPO_DTL_CRAT_TS AS DS_CPO_DTL_CRAT_TS,
                                          CD.ORD_LINE_DPLY_STS_CD AS ORD_LINE_DPLY_STS_CD,
                                          SP.SHPG_PLN_DPLY_STS_CD AS SHPG_PLN_DPLY_STS_CD,
                                          NULL AS RTRN_LINE_DPLY_STS_CD,
                                          NULL AS INV_DT,
                                          SP.SHIP_TO_LOC_NM AS SHIP_TO_LOC_NM,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- SMM.ISTL_DT AS ISTL_DT, -->
                                          SMMH.ISTL_DT AS ISTL_DT,
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          '010' AS TRX_SRC_TP_CD
                                     FROM CPO_DTL CD,
                                          SHPG_PLN SP,
                                          PO_DTL PD,
                                          CPO C,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                       <!-- SVC_MACH_MSTR SMM, -->
                                       (SELECT
                                            SMMHTMP.DS_CONTR_NUM,
                                            SMMHTMP.SVC_MACH_MSTR_PK,
                                            SMMHTMP.ISTL_DT,
                                            SMMHTMP.SER_NUM
                                        FROM
                                            (SELECT
                                                 DC.DS_CONTR_NUM,
                                                 DCD.SVC_MACH_MSTR_PK,
                                                 HIST.ISTL_DT,
                                                 ROW_NUMBER() OVER( PARTITION BY DC.DS_CONTR_NUM, DCD.SVC_MACH_MSTR_PK ORDER BY HIST.LAST_SVC_CALL_DT) ROW_NUM,
                                                 HIST.SER_NUM
                                             FROM
                                                 DS_CONTR DC,
                                                 DS_CONTR_DTL DCD,
                                                 SVC_MACH_MSTR_HIST HIST
                                             WHERE
                                                     DC.EZCANCELFLAG = '0'
                                                 AND DC.GLBL_CMPY_CD = #glblCmpyCd#
                                                 AND DCD.GLBL_CMPY_CD = #glblCmpyCd#
                                                 AND HIST.EZCANCELFLAG = '0'
                                                 AND HIST.GLBL_CMPY_CD = #glblCmpyCd#
                                                 AND DC.CPO_ORD_NUM = DCD.CPO_ORD_NUM
                                                 AND DCD.CPO_ORD_NUM = HIST.CPO_ORD_NUM
                                                 AND DCD.SVC_MACH_MSTR_PK = HIST.SVC_MACH_MSTR_PK
                                                 AND (HIST.SVC_MACH_MSTR_STS_CD = 'INSTL'
                                                 OR  HIST.SVC_MACH_MSTR_STS_CD IS NULL)
                                                 AND DC.CPO_ORD_NUM IS NOT NULL
                                                 AND DCD.CPO_ORD_NUM IS NOT NULL
                                                 AND HIST.CPO_ORD_NUM IS NOT NULL
                                                 AND DC.DS_CONTR_NUM IS NOT NULL
                                                 AND DCD.SVC_MACH_MSTR_PK IS NOT NULL
                                             GROUP BY
                                                DC.DS_CONTR_NUM,
                                                DCD.SVC_MACH_MSTR_PK,
                                                HIST.ISTL_DT,
                                                HIST.LAST_SVC_CALL_DT,
                                                HIST.SER_NUM
                                             ) SMMHTMP
                                        WHERE
                                            SMMHTMP.ROW_NUM = 1
                                       ) SMMH,
                                       (SELECT
                                            DCD.CPO_ORD_NUM,
                                            DCD.CPO_DTL_LINE_NUM,
                                            DCD.CPO_DTL_LINE_SUB_NUM,
                                            MIN(DC.DS_CONTR_NUM) DS_CONTR_NUM,
                                            HIST.ISTL_DT,
                                            HIST.SER_NUM
                                        FROM
                                            DS_CONTR DC,
                                            DS_CONTR_DTL DCD,
                                            SVC_MACH_MSTR_HIST HIST
                                        WHERE
                                                DC.EZCANCELFLAG = '0'
                                            AND DC.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND DCD.EZCANCELFLAG = '0'
                                            AND DCD.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND HIST.EZCANCELFLAG = '0'
                                            AND HIST.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND DC.DS_CONTR_PK = DCD.DS_CONTR_PK
                                            AND DC.DS_CONTR_CATG_CD IN ('REG','FLT','AGG')
                                            AND DCD.CPO_ORD_NUM IS NOT NULL
                                            AND DCD.CPO_DTL_LINE_NUM IS NOT NULL
                                            AND DCD.CPO_DTL_LINE_SUB_NUM IS NOT NULL
                                            AND DC.CPO_ORD_NUM = HIST.CPO_ORD_NUM
                                            AND DCD.SVC_MACH_MSTR_PK = HIST.SVC_MACH_MSTR_PK
                                        GROUP BY
                                            DCD.CPO_ORD_NUM,
                                            DCD.CPO_DTL_LINE_NUM,
                                            DCD.CPO_DTL_LINE_SUB_NUM,
                                            HIST.ISTL_DT,
                                            HIST.SER_NUM
                                       ) DC,
                                       <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          PO_SER_NUM PSN,
                                          <!--2019/01/21 QC#29741 Add Start-->
                                          PRCH_REQ_DTL PRD
                                          <!--2019/01/21 QC#29741 Add End  -->
                                    WHERE     CD.GLBL_CMPY_CD = SP.GLBL_CMPY_CD
                                          AND CD.CPO_ORD_NUM = SP.TRX_HDR_NUM
                                          AND CD.CPO_DTL_LINE_NUM = SP.TRX_LINE_NUM
                                          AND CD.CPO_DTL_LINE_SUB_NUM = SP.TRX_LINE_SUB_NUM
                                          AND SP.PO_REQ_FLG = 'Y'
                                          AND SP.GLBL_CMPY_CD = PD.GLBL_CMPY_CD(+)
                                          AND SP.PO_ORD_NUM = PD.PO_ORD_NUM(+)
                                          AND SP.TRX_HDR_NUM = PD.CPO_ORD_NUM(+)
                                          AND SP.TRX_LINE_NUM = PD.CPO_DTL_LINE_NUM(+)
                                          AND SP.TRX_LINE_SUB_NUM = PD.CPO_DTL_LINE_SUB_NUM(+)
                                          AND CD.GLBL_CMPY_CD = C.GLBL_CMPY_CD
                                          AND CD.CPO_ORD_NUM = C.CPO_ORD_NUM
                                          AND CD.EZCANCELFLAG = '0'
                                          AND SP.EZCANCELFLAG = '0'
                                          AND PD.EZCANCELFLAG(+) = '0'
                                          AND C.EZCANCELFLAG = '0'
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- AND CD.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK(+) -->
                                          <!-- AND CD.GLBL_CMPY_CD = SMM.GLBL_CMPY_CD(+) -->
                                          <!-- AND SMM.EZCANCELFLAG(+) = '0' -->
                                          AND CD.DS_CONTR_NUM = SMMH.DS_CONTR_NUM(+)
                                          AND CD.SVC_MACH_MSTR_PK = SMMH.SVC_MACH_MSTR_PK(+)
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          AND PD.GLBL_CMPY_CD = PSN.GLBL_CMPY_CD(+)
                                          AND PD.CPO_ORD_NUM = PSN.KEY_INFO_CD_01(+)
                                          AND PD.CPO_DTL_LINE_NUM = PSN.KEY_INFO_CD_02(+)
                                          AND PD.CPO_DTL_LINE_SUB_NUM = PSN.KEY_INFO_CD_03(+)
                                          AND PD.PO_ORD_NUM = PSN.KEY_INFO_CD_04(+)
                                          AND PD.PO_ORD_DTL_LINE_NUM = PSN.KEY_INFO_CD_05(+)
                                          AND PSN.EZCANCELFLAG(+) = '0'
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, ADD] -->
                                          AND CD.CPO_ORD_NUM = DC.CPO_ORD_NUM(+)
                                          AND CD.CPO_DTL_LINE_NUM = DC.CPO_DTL_LINE_NUM(+)
                                          AND CD.CPO_DTL_LINE_SUB_NUM = DC.CPO_DTL_LINE_SUB_NUM(+)
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, ADD] -->
                                          <!--2019/01/21 QC#29741 Add Start-->
                                          AND PRD.EZCANCELFLAG(+) = '0'
                                          AND SP.GLBL_CMPY_CD = PRD.GLBL_CMPY_CD(+)
                                          AND SP.SHPG_PLN_NUM = PRD.SHPG_PLN_NUM(+)
                                          AND SP.TRX_HDR_NUM = PRD.TRX_REF_NUM(+)
                                          AND SP.TRX_LINE_NUM = PRD.TRX_REF_LINE_NUM(+)
                                          AND SP.TRX_LINE_SUB_NUM = PRD.TRX_REF_LINE_SUB_NUM(+)
                                          <!--2019/01/21 QC#29741 Add End  -->
                                          <!-- START 2019/07/23 Hd.Sugawara [QC#51987,ADD] -->
                                          AND PRD.PRCH_REQ_LINE_STS_CD(+) &lt;&gt; '99'
                                          <!-- END 2019/07/23 Hd.Sugawara [QC#51987,ADD] -->
                                          <!--2019/03/05 QC#30649 Mod Start-->
                                          AND CASE 
                                                  WHEN (SP.PO_ORD_NUM IS NULL) OR (PRD.PO_ORD_NUM IS NULL) THEN 1 
                                                  WHEN SP.PO_ORD_NUM = PRD.PO_ORD_NUM THEN 1 
                                                  ELSE 0 
                                              END = 1 
                                          <!--2019/01/21 QC#29736 Add Start-->
                                          <!-- AND SP.PO_ORD_NUM = PRD.PO_ORD_NUM(+) -->
                                          <!--2019/01/21 QC#29736 Add End-->
                                          <!--2019/03/05 QC#30649 Mod End-->
                                          <!--2019/02/13 QC#30238 Add Start  -->
                                         <isNotNull property="ORDER_NUMBER">
                                          AND C.CPO_ORD_NUM LIKE #ORDER_NUMBER#
                                         </isNotNull>
                                          <!--2019/02/13 QC#30238 Add End  -->
                                          <isNotNull property="searchQuickCondition">
                                                $searchQuickCondition$
                                         </isNotNull>
                                   UNION ALL
                                   SELECT RD.GLBL_CMPY_CD AS GLBL_CMPY_CD,-- INBOUND
                                          RD.CPO_ORD_NUM AS CPO_ORD_NUM,
                                          NULL AS CPO_DTL_LINE_NUM,
                                          NULL AS CPO_DTL_LINE_SUB_NUM,
                                          RD.DS_CPO_RTRN_LINE_NUM AS SRCH_LINE_NUM,
                                          RD.DS_CPO_RTRN_LINE_SUB_NUM AS SRCH_LINE_SUB_NUM,
                                          RD.DS_ORD_POSN_NUM AS DS_ORD_POSN_NUM,
                                          RD.DS_CPO_LINE_NUM AS DS_CPO_LINE_NUM,
                                          RD.DS_CPO_LINE_SUB_NUM AS DS_CPO_LINE_SUB_NUM,
                                          RD.DS_CPO_RTRN_LINE_NUM AS DS_CPO_RTRN_LINE_NUM,
                                          RD.DS_CPO_RTRN_LINE_SUB_NUM AS DS_CPO_RTRN_LINE_SUB_NUM,
                                          RD.DS_CPO_CONFIG_PK AS DS_CPO_CONFIG_PK,
                                          NULL AS SHPG_PLN_NUM,
                                          NULL AS PRCH_REQ_NUM,
                                          NULL AS PO_ORD_NUM,
                                          NULL AS SO_NUM,
                                          NULL AS SO_SLP_NUM,
                                          RD.INV_NUM AS INV_NUM,
                                          NULL AS CR_HLD_QTY,
                                          NULL AS CR_CHK_QTY,
                                          NULL AS SHPG_STS_CD,
                                          NULL AS SLS_HLD_QTY,
                                          RD.CPO_DTL_HLD_FLG AS CPO_DTL_HLD_FLG,
                                          NULL AS SHOP_ITEM_FLG,
                                          RD.MDSE_CD AS MDSE_CD,
                                          NULL AS COA_PROD_CD,
                                          NVL(RWS.SER_NUM, RD.SER_NUM) AS SER_NUM,
                                          RD.RTRN_RSN_CD AS RTRN_RSN_CD,
                                          RR.RTRN_RSN_DESC_TXT AS RTRN_RSN_DESC_TXT,
                                          NULL AS ACTL_SHIP_DT,
                                          RD.DS_ORD_LINE_CATG_CD AS DS_ORD_LINE_CATG_CD,
                                          RD.ORD_LINE_SRC_CD AS ORD_LINE_SRC_CD,
                                          RD.RTL_WH_CD AS RTL_WH_CD,
                                          RD.RTL_SWH_CD AS RTL_SWH_CD,
                                          RD.INVTY_LOC_CD AS INVTY_LOC_CD,
                                          RD.DROP_SHIP_FLG AS DROP_SHIP_FLG,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- RD.DS_CONTR_NUM AS DS_CONTR_NUM, -->
                                          NVL(RD.DS_CONTR_NUM, DC.DS_CONTR_NUM) AS DS_CONTR_NUM,
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          NULL AS ORD_LINE_STS_CD,
                                          RD.RTRN_LINE_STS_CD AS RTRN_LINE_STS_CD,
                                          RD.OPEN_FLG AS OPEN_FLG,
                                          NULL AS RDD_DT,
                                          NULL AS PSD_DT,
                                          NULL AS PDD_DT,
                                          RD.PRC_CATG_CD AS PRC_CATG_CD,
                                          RD.SLS_REP_OR_SLS_TEAM_TOC_CD AS SLS_REP_OR_SLS_TEAM_TOC_CD,
                                          RD.SVC_MACH_MSTR_PK AS SVC_MACH_MSTR_PK,
                                          RD.ORD_QTY AS ORD_QTY,
                                          RD.ENT_CPO_DTL_FUNC_NET_AMT AS ENT_CPO_DTL_FUNC_NET_AMT,
                                          RD.ENT_CPO_DTL_FUNC_SLS_AMT AS ENT_CPO_DTL_FUNC_SLS_AMT,
                                          RD.ENT_FUNC_NET_UNIT_PRC_AMT AS ENT_FUNC_NET_UNIT_PRC_AMT,
                                          NULL AS SP_FUNC_UNIT_PRC_AMT,
                                          NULL AS SP_FUNC_NET_UNIT_PRC_AMT,
                                          NULL AS SP_TOT_FUNC_NET_AMT,
                                          RD.CPO_ORD_TS AS CPO_ORD_TS,
                                          RD.TRX_CD AS TRX_CD,
                                          0 AS LOAN_BAL_QTY,
                                          NULL AS PO_REQ_FLG,
                                          NULL AS REF_CPO_DTL_LINE_NUM,
                                          NULL AS REF_CPO_DTL_LINE_SUB_NUM,
                                          NULL AS DS_CPO_DTL_CRAT_TS,
                                          NULL AS SHPG_PLN_DPLY_STS_CD,
                                          NULL AS ORD_LINE_DPLY_STS_CD,
                                          RD.RTRN_LINE_DPLY_STS_CD AS RTRN_LINE_DPLY_STS_CD,
                                          NULL AS INV_DT,
                                          RD.SHIP_TO_LOC_NM AS SHIP_TO_LOC_NM,
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- SMM.ISTL_DT AS ISTL_DT, -->
                                          SMMH.ISTL_DT AS ISTL_DT,
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          '011' AS TRX_SRC_TP_CD
                                     FROM DS_CPO_RTRN_DTL RD, 
                                          RTRN_RSN RR,
                                          CPO C,
                                       <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                       <!-- SVC_MACH_MSTR SMM, -->
                                       (SELECT
                                            HIST.RMA_NUM,
                                            HIST.RMA_LINE_NUM,
                                            HIST.RMA_LINE_SUB_NUM,
                                            HIST.SER_NUM,
                                            MAX(HIST.ISTL_DT) AS ISTL_DT
                                        FROM
                                            SVC_MACH_MSTR_HIST HIST
                                        WHERE
                                                HIST.EZCANCELFLAG = '0'
                                            AND HIST.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND (HIST.SVC_MACH_MSTR_STS_CD IN ('RMV','W4R')
                                            OR  HIST.SVC_MACH_MSTR_STS_CD IS NULL)
                                            AND HIST.ISTL_DT IS NOT NULL
                                            AND HIST.RMA_NUM IS NOT NULL
                                            AND HIST.RMA_LINE_NUM IS NOT NULL
                                            AND HIST.RMA_LINE_SUB_NUM IS NOT NULL
                                        GROUP BY
                                            HIST.RMA_NUM,
                                            HIST.RMA_LINE_NUM,
                                            HIST.RMA_LINE_SUB_NUM,
                                            HIST.SER_NUM
                                       ) SMMH,
                                       (SELECT
                                            DCD.CPO_ORD_NUM,
                                            DCD.CPO_DTL_LINE_NUM,
                                            DCD.CPO_DTL_LINE_SUB_NUM,
                                            MIN(DC.DS_CONTR_NUM) DS_CONTR_NUM
                                        FROM
                                            DS_CONTR DC,
                                            DS_CONTR_DTL DCD
                                        WHERE
                                                DC.EZCANCELFLAG = '0'
                                            AND DC.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND DCD.EZCANCELFLAG = '0'
                                            AND DCD.GLBL_CMPY_CD = #glblCmpyCd#
                                            AND DC.DS_CONTR_PK = DCD.DS_CONTR_PK
                                            AND DC.DS_CONTR_CATG_CD IN ('REG','FLT','AGG')
                                            AND DCD.CPO_ORD_NUM IS NOT NULL
                                            AND DCD.CPO_DTL_LINE_NUM IS NOT NULL
                                            AND DCD.CPO_DTL_LINE_SUB_NUM IS NOT NULL
                                        GROUP BY
                                            DCD.CPO_ORD_NUM,
                                            DCD.CPO_DTL_LINE_NUM,
                                            DCD.CPO_DTL_LINE_SUB_NUM
                                       ) DC,
                                       <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          (SELECT RWSH.GLBL_CMPY_CD,
                                                  RWSH.TRX_ORD_NUM,
                                                  RWSH.EZCANCELFLAG,
                                                  RWSD.TRX_LINE_NUM,
                                                  RWSD.TRX_LINE_SUB_NUM,
                                                  RWSS.SER_NUM, 
                                                  <!-- 2019/03/14 QC#30700 Add Start -->
                                                  ROW_NUMBER() OVER(PARTITION BY RWSH.TRX_ORD_NUM, RWSD.TRX_LINE_NUM, RWSD.TRX_LINE_SUB_NUM ORDER BY RWSH.RWS_NUM) AS ROW_NUM
                                                  <!-- 2019/03/14 QC#30700 Add End -->
                                             FROM RWS_DTL RWSD, RWS_HDR RWSH, RWS_SER RWSS
                                            WHERE     RWSH.GLBL_CMPY_CD = RWSD.GLBL_CMPY_CD
                                                  AND RWSH.RWS_NUM = RWSD.RWS_NUM
                                                  <!-- 2019/02/27 QC#29736 ADD START -->
                                                  AND RWSD.RWS_STS_CD &lt;&gt; 99
                                                  <!-- 2019/02/27 QC#29736 ADD END -->
                                                  AND RWSD.EZCANCELFLAG = '0'
                                                  AND RWSH.EZCANCELFLAG = '0'
                                                  AND RWSD.GLBL_CMPY_CD = RWSS.GLBL_CMPY_CD(+)
                                                  AND RWSD.RWS_NUM = RWSS.RWS_NUM(+)
                                                  AND RWSD.RWS_DTL_LINE_NUM = RWSS.RWS_LINE_NUM(+)
                                                  AND RWSS.EZCANCELFLAG(+) = '0') RWS
                                    WHERE     RD.GLBL_CMPY_CD = RR.GLBL_CMPY_CD(+)
                                          AND RD.RTRN_RSN_CD = RR.RTRN_RSN_CD(+)
                                          AND RD.GLBL_CMPY_CD = C.GLBL_CMPY_CD
                                          AND RD.CPO_ORD_NUM = C.CPO_ORD_NUM
                                          AND RD.EZCANCELFLAG = '0'
                                          AND C.EZCANCELFLAG = '0'
                                          AND RR.EZCANCELFLAG(+) = '0'
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          <!-- AND RD.SVC_MACH_MSTR_PK = SMM.SVC_MACH_MSTR_PK(+) -->
                                          <!-- AND RD.GLBL_CMPY_CD = SMM.GLBL_CMPY_CD(+) -->
                                          <!-- AND SMM.EZCANCELFLAG(+) = '0' -->
                                          AND RD.CPO_ORD_NUM = SMMH.RMA_NUM(+)
                                          AND RD.DS_CPO_RTRN_LINE_NUM = SMMH.RMA_LINE_NUM(+)
                                          AND RD.DS_CPO_RTRN_LINE_SUB_NUM = SMMH.RMA_LINE_SUB_NUM(+)
                                          AND RD.SER_NUM = SMMH.SER_NUM(+)
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, MOD] -->
                                          AND RD.CPO_ORD_NUM = RWS.TRX_ORD_NUM(+)
                                          AND RD.DS_CPO_RTRN_LINE_NUM = RWS.TRX_LINE_NUM(+)
                                          AND RD.DS_CPO_RTRN_LINE_SUB_NUM = RWS.TRX_LINE_SUB_NUM(+)
                                          AND RWS.EZCANCELFLAG(+) = '0'
                                          <!-- START 2023/07/21 S.Fujita [QC#61076, ADD] -->
                                          AND RD.CPO_ORD_NUM = DC.CPO_ORD_NUM(+)
                                          AND RD.DS_CPO_RTRN_LINE_NUM = DC.CPO_DTL_LINE_NUM(+)
                                          AND RD.DS_CPO_RTRN_LINE_SUB_NUM = DC.CPO_DTL_LINE_SUB_NUM(+)
                                          <!-- END 2023/07/21 S.Fujita [QC#61076, ADD] -->
                                          <!-- 2019/03/14 QC#30700 Add Start -->
                                          AND RWS.ROW_NUM(+)      = 1
                                          <!-- 2019/03/14 QC#30700 Add End -->
                                         <!--2019/02/13 QC#30238 Add Start  -->
                                         <isNotNull property="ORDER_NUMBER">
                                          AND C.CPO_ORD_NUM LIKE #ORDER_NUMBER#
                                         </isNotNull>
                                         <!--2019/02/13 QC#30238 Add End  -->
                                         <isNotNull property="searchQuickCondition">
                                                $searchQuickCondition$
                                         </isNotNull>
                                         ) DTL,
                                  MDSE MV,
                                  ORD_TAKE_MDSE OTM,
                                  MDSE MP,
                                  COA_ACCT CA,
                                  COA_ACCT CAP,
                                  SELL_TO_CUST DAC_BILL,
                                  SELL_TO_CUST DA_BILL,--HEADER ONLY SAVE
                                  SELL_TO_CUST DAC_SELL,
                                  SELL_TO_CUST DAC_SHIP,
                                  SELL_TO_CUST DA_SHIP,--HEADER ONLY SAVE
                                  DS_IMPT_ORD DIO,
                                  CPO_SRC_TP CST,
                                  DS_ORD_CATG DOC,
                                  DS_ORD_TP DOT,
                                  DS_ORD_RSN DOR,
                                  TOC TOC_H,
                                  TOC TOC_D,
                                  DS_ORD_TP_PROC_DFN DOTPD,
                                  COA_BR CB,
                                  COA_EXTN CE,
                                  COA_PROD CP,
                                  COA_PROD CPP,
                                  COA_PROJ CMT,
                                  COA_PROJ CMTP,
                                  MDL_NM MN,
                                  DS_ORD_LINE_CATG OLC,
                                  ORD_LINE_SRC OLS,
                                  RTL_WH RW,
                                  RTL_SWH RSW,
                                  VND VND,
                                  (SELECT V.GLBL_CMPY_CD AS GLBL_CMPY_CD,
                                          V.VND_CD AS VND_CD,
                                          V.LOC_NM AS VND_NM,
                                          PV.PRNT_VND_CD AS PRNT_VND_CD,
                                          PV.PRNT_VND_NM AS PRNT_VND_NM,
                                          PV.PRNT_VND_NM || ' - ' || V.LOC_NM AS DPLY_VND_NM
                                     FROM VND V, VND_TP_RELN VTR, PRNT_VND PV
                                    WHERE     V.VND_CD = VTR.VND_CD
                                          AND V.GLBL_CMPY_CD = VTR.GLBL_CMPY_CD
                                          AND VTR.VND_TP_CD = '01'                         -- SUPPLIER
                                          AND V.RGTN_STS_CD = 'P20'
                                          AND V.EFF_THRU_DT >= TO_CHAR (SYSDATE, 'YYYYMMDD')
                                          AND VTR.EZCANCELFLAG = '0'
                                          AND V.EZCANCELFLAG = '0'
                                          AND PV.EZCANCELFLAG = '0'
                                          AND V.GLBL_CMPY_CD = PV.GLBL_CMPY_CD
                                          AND V.PRNT_VND_PK = PV.PRNT_VND_PK
                                          AND (   PV.INAC_DT IS NULL
                                               OR PV.INAC_DT > TO_CHAR (SYSDATE, 'YYYYMMDD')))
                                  DPLY_VND,
                                  PRC_CATG PC,
                                  PRC_CONTR PCR,
                                  LINE_BIZ_TP LBT,
                                  DT_MGT DT,
                                  ORD_HDR_DPLY_STS OHDS,
                                  ORD_LINE_DPLY_STS OLDS,
                                  SHPG_PLN_DPLY_STS SPDS,
                                  RTRN_LINE_DPLY_STS RLDS,
                                  ORG_FUNC_ASG OFA,
                                  S21_PSN SP
                            WHERE     C.GLBL_CMPY_CD = #glblCmpyCd#
                                  AND C.GLBL_CMPY_CD = DCC.GLBL_CMPY_CD(+)
                                  AND C.CPO_ORD_NUM = DCC.CPO_ORD_NUM(+)
                                  AND C.GLBL_CMPY_CD = DTL.GLBL_CMPY_CD(+)
                                  AND C.CPO_ORD_NUM = DTL.CPO_ORD_NUM(+)
                                  AND DCC.DS_CPO_CONFIG_PK = DTL.DS_CPO_CONFIG_PK(+)
                                  AND DTL.GLBL_CMPY_CD = MV.GLBL_CMPY_CD(+)
                                  AND DTL.MDSE_CD = MV.MDSE_CD(+)
                                  AND MV.GLBL_CMPY_CD = CA.GLBL_CMPY_CD(+)
                                  AND MV.REV_COA_ACCT_CD = CA.COA_ACCT_CD(+)
                                  AND MP.GLBL_CMPY_CD = CAP.GLBL_CMPY_CD(+)
                                  AND MP.REV_COA_ACCT_CD = CAP.COA_ACCT_CD(+)
                                  AND DTL.GLBL_CMPY_CD = OTM.GLBL_CMPY_CD(+)
                                  AND DTL.MDSE_CD = OTM.ORD_TAKE_MDSE_CD(+)
                                  AND OTM.GLBL_CMPY_CD = MP.GLBL_CMPY_CD(+)
                                  AND OTM.MDSE_CD = MP.MDSE_CD(+)
                                  AND DCC.GLBL_CMPY_CD = DAC_BILL.GLBL_CMPY_CD(+)
                                  AND DCC.BILL_TO_CUST_ACCT_CD = DAC_BILL.SELL_TO_CUST_CD(+)
                                  AND C.GLBL_CMPY_CD = DA_BILL.GLBL_CMPY_CD(+)
                                  AND C.BILL_TO_CUST_ACCT_CD = DA_BILL.SELL_TO_CUST_CD(+)
                                  AND C.GLBL_CMPY_CD = DAC_SELL.GLBL_CMPY_CD(+)
                                  AND C.SELL_TO_CUST_CD = DAC_SELL.SELL_TO_CUST_CD(+)
                                  AND DCC.GLBL_CMPY_CD = DAC_SHIP.GLBL_CMPY_CD(+)
                                  AND DCC.SHIP_TO_CUST_ACCT_CD = DAC_SHIP.SELL_TO_CUST_CD(+)
                                  AND C.GLBL_CMPY_CD = DA_SHIP.GLBL_CMPY_CD(+)
                                  AND C.SHIP_TO_CUST_ACCT_CD = DA_SHIP.SELL_TO_CUST_CD(+)
                                  AND C.GLBL_CMPY_CD = DIO.GLBL_CMPY_CD(+)
                                  AND C.CPO_ORD_NUM = DIO.CPO_ORD_NUM(+)
                                  AND C.GLBL_CMPY_CD = CST.GLBL_CMPY_CD
                                  AND C.CPO_SRC_TP_CD = CST.CPO_SRC_TP_CD
                                  AND C.GLBL_CMPY_CD = DOC.GLBL_CMPY_CD
                                  AND C.DS_ORD_CATG_CD = DOC.DS_ORD_CATG_CD
                                  AND C.GLBL_CMPY_CD = DOT.GLBL_CMPY_CD
                                  AND C.DS_ORD_TP_CD = DOT.DS_ORD_TP_CD
                                  AND C.GLBL_CMPY_CD = DOR.GLBL_CMPY_CD(+)
                                  AND C.DS_ORD_RSN_CD = DOR.DS_ORD_RSN_CD(+)
                                  AND C.GLBL_CMPY_CD = TOC_H.GLBL_CMPY_CD(+)
                                  AND C.SLS_REP_TOC_CD = TOC_H.TOC_CD(+)
                                  AND DTL.GLBL_CMPY_CD = TOC_D.GLBL_CMPY_CD(+)
                                  AND DTL.SLS_REP_OR_SLS_TEAM_TOC_CD = TOC_D.TOC_CD(+)
                                  AND C.GLBL_CMPY_CD = DOTPD.GLBL_CMPY_CD(+)
                                  AND C.DS_ORD_TP_CD = DOTPD.DS_ORD_TP_CD(+)
                                  AND TOC_H.GLBL_CMPY_CD = CB.GLBL_CMPY_CD(+)
                                  AND TOC_H.COA_BR_CD = CB.COA_BR_CD(+)
                                  AND TOC_H.GLBL_CMPY_CD = CE.GLBL_CMPY_CD(+)
                                  AND TOC_H.COA_EXTN_CD = CE.COA_EXTN_CD(+)
                                  AND MV.GLBL_CMPY_CD = CP.GLBL_CMPY_CD(+)
                                  AND MV.COA_PROD_CD = CP.COA_PROD_CD(+)
                                  AND MV.GLBL_CMPY_CD = CMT.GLBL_CMPY_CD(+)
                                  AND MV.COA_MDSE_TP_CD = CMT.COA_PROJ_CD(+)
                                  AND MP.GLBL_CMPY_CD = CPP.GLBL_CMPY_CD(+)
                                  AND MP.COA_PROD_CD = CPP.COA_PROD_CD(+)
                                  AND MP.GLBL_CMPY_CD = CMTP.GLBL_CMPY_CD(+)
                                  AND MP.COA_MDSE_TP_CD = CMTP.COA_PROJ_CD(+)
                                  AND DCC.GLBL_CMPY_CD = MN.T_GLBL_CMPY_CD(+)
                                  AND DCC.MDL_ID = MN.T_MDL_ID(+)
                                  AND DTL.GLBL_CMPY_CD = OLC.GLBL_CMPY_CD(+)
                                  AND DTL.DS_ORD_LINE_CATG_CD = OLC.DS_ORD_LINE_CATG_CD(+)
                                  AND DTL.GLBL_CMPY_CD = OLS.GLBL_CMPY_CD(+)
                                  AND DTL.ORD_LINE_SRC_CD = OLS.ORD_LINE_SRC_CD(+)
                                  AND DTL.GLBL_CMPY_CD = RSW.GLBL_CMPY_CD(+)
                                  AND DTL.RTL_WH_CD = RSW.RTL_WH_CD(+)
                                  AND DTL.RTL_SWH_CD = RSW.RTL_SWH_CD(+)
                                  AND DTL.GLBL_CMPY_CD = RW.GLBL_CMPY_CD(+)
                                  AND DTL.RTL_WH_CD = RW.RTL_WH_CD(+)
                                  AND DTL.GLBL_CMPY_CD = VND.GLBL_CMPY_CD(+)
                                  AND DTL.INVTY_LOC_CD = VND.VND_CD(+)
                                  AND DTL.GLBL_CMPY_CD = DPLY_VND.GLBL_CMPY_CD(+)
                                  AND DTL.INVTY_LOC_CD = DPLY_VND.VND_CD(+)
                                  AND DTL.GLBL_CMPY_CD = PC.GLBL_CMPY_CD(+)
                                  AND DTL.PRC_CATG_CD = PC.PRC_CATG_CD(+)
                                  AND C.GLBL_CMPY_CD = PCR.GLBL_CMPY_CD(+)
                                  AND C.PRC_CONTR_NUM = PCR.PRC_CONTR_NUM(+)
                                  AND DOTPD.GLBL_CMPY_CD = LBT.GLBL_CMPY_CD(+)
                                  AND DOTPD.LINE_BIZ_TP_CD = LBT.LINE_BIZ_TP_CD(+)
                                  AND C.GLBL_CMPY_CD = OHDS.GLBL_CMPY_CD(+)
                                  AND C.ORD_HDR_DPLY_STS_CD = OHDS.ORD_HDR_DPLY_STS_CD(+)
                                  AND DTL.GLBL_CMPY_CD = OLDS.GLBL_CMPY_CD(+)
                                  AND DTL.ORD_LINE_DPLY_STS_CD = OLDS.ORD_LINE_DPLY_STS_CD(+)
                                  AND DTL.GLBL_CMPY_CD = SPDS.GLBL_CMPY_CD(+)
                                  AND DTL.SHPG_PLN_DPLY_STS_CD = SPDS.SHPG_PLN_DPLY_STS_CD(+)
                                  AND DTL.GLBL_CMPY_CD = RLDS.GLBL_CMPY_CD(+)
                                  AND DTL.RTRN_LINE_DPLY_STS_CD = RLDS.RTRN_LINE_DPLY_STS_CD(+)
                                  AND C.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD(+)
                                  AND C.SLS_REP_TOC_CD = OFA.TOC_CD(+)
                                  AND OFA.GLBL_CMPY_CD = SP.GLBL_CMPY_CD(+)
                                  AND OFA.PSN_CD = SP.PSN_CD(+)
                                  AND C.EZCANCELFLAG = '0'
                                  AND DCC.EZCANCELFLAG(+) = '0'
                                  AND CA.EZCANCELFLAG(+) = '0'
                                  AND DAC_BILL.EZCANCELFLAG(+) = '0'
                                  AND DA_BILL.EZCANCELFLAG(+) = '0'
                                  AND DAC_SELL.EZCANCELFLAG(+) = '0'
                                  AND DAC_SHIP.EZCANCELFLAG(+) = '0'
                                  AND DA_SHIP.EZCANCELFLAG(+) = '0'
                                  AND DIO.EZCANCELFLAG(+) = '0'
                                  AND CST.EZCANCELFLAG(+) = '0'
                                  AND DOC.EZCANCELFLAG(+) = '0'
                                  AND DOT.EZCANCELFLAG(+) = '0'
                                  AND DOR.EZCANCELFLAG(+) = '0'
                                  AND TOC_H.EZCANCELFLAG(+) = '0'
                                  AND TOC_D.EZCANCELFLAG(+) = '0'
                                  AND DOTPD.EZCANCELFLAG(+) = '0'
                                  AND CB.EZCANCELFLAG(+) = '0'
                                  AND CE.EZCANCELFLAG(+) = '0'
                                  AND CP.EZCANCELFLAG(+) = '0'
                                  AND CMT.EZCANCELFLAG(+) = '0'
                                  AND MN.EZCANCELFLAG(+) = '0'
                                  AND OLC.EZCANCELFLAG(+) = '0'
                                  AND OLS.EZCANCELFLAG(+) = '0'
                                  AND RW.EZCANCELFLAG(+) = '0'
                                  AND RSW.EZCANCELFLAG(+) = '0'
                                  AND VND.EZCANCELFLAG(+) = '0'
                                  AND PC.EZCANCELFLAG(+) = '0'
                                  AND PCR.EZCANCELFLAG(+) = '0'
                                  AND LBT.EZCANCELFLAG(+) = '0'
                                  AND OHDS.EZCANCELFLAG(+) = '0'
                                  AND OLDS.EZCANCELFLAG(+) = '0'
                                  AND SPDS.EZCANCELFLAG(+) = '0'
                                  AND RLDS.EZCANCELFLAG(+) = '0'
                                  AND OFA.EZCANCELFLAG(+) = '0'
                                  AND SP.EZCANCELFLAG(+) = '0'
                                  AND OTM.EZCANCELFLAG(+) = '0'
                                  AND MP.EZCANCELFLAG(+) = '0'
                                  AND CAP.EZCANCELFLAG(+) = '0'
                                  AND CPP.EZCANCELFLAG(+) = '0'
                                  AND CMTP.EZCANCELFLAG(+) = '0'
                                  AND DT.GLBL_CMPY_CD = C.GLBL_CMPY_CD
                                  AND DT.DT_MGT_PGM_ID = '*'
                                  AND DT.DT_PROC_CD = 'S'
                                  AND DT.EZCANCELFLAG = '0'
                        ) DOO_IN

                        <isEqual property="teamSearchFlg" compareValue="Y">
                          ,TMZN
                        </isEqual>
                        , INV I
                        , INV_BOL IB
                        , INV_LINE IL
                    WHERE
                        DOO_IN.GLBL_CMPY_CD = #glblCmpyCd#
                        AND DOO_IN.TRX_SRC_TP_CD = I.TRX_SRC_TP_CD(+)
                        AND DOO_IN.INV_NUM = I.INV_NUM(+)
                        AND DOO_IN.INV_NUM = IB.INV_NUM(+)
                        AND DOO_IN.INV_NUM = IL.INV_NUM(+)
                        AND IL.INV_BOL_LINE_NUM =IB.INV_BOL_LINE_NUM(+)
                        --AND DOO_IN.SHPG_PLN_NUM = IL.SHPG_PLN_NUM(+)
                        AND NVL(DOO_IN.SHPG_PLN_NUM, 'PASS') =
                              CASE WHEN (DOO_IN.TRX_SRC_TP_CD = '010') THEN
                                  CASE WHEN (DOO_IN.INV_NUM IS NULL) THEN
                                    'PASS'
                                  ELSE 
                                     IL.SHPG_PLN_NUM(+)
                                  END
                              ELSE
                                  'PASS'
                              END
                        AND DOO_IN.SRCH_LINE_NUM = IL.CPO_DTL_LINE_NUM (+)
                        AND DOO_IN.SRCH_LINE_SUB_NUM = IL.CPO_DTL_LINE_SUB_NUM(+)
                        AND IL.INV_LINE_CATG_CD(+) = '00'
                        AND I.GLBL_CMPY_CD(+) = #glblCmpyCd#
                        AND IB.GLBL_CMPY_CD(+) = #glblCmpyCd#
                        AND IL.GLBL_CMPY_CD(+) = #glblCmpyCd#
                        AND I.EZCANCELFLAG(+) = '0'
                        AND IB.EZCANCELFLAG(+) = '0'
                        AND IL.EZCANCELFLAG(+) = '0'
                        <isEqual property="cMsg.xxOnlySlsOrdFlg" compareValue="Y">
                            AND DOO_IN.TRX_CD = #trxCd#
                        </isEqual>
                        <!--2019/02/13 QC#30238 Add Start  -->
                        <isNotNull property="ORDER_NUMBER">
                            AND DOO_IN.SRC_REF_OR_CPO_ORD_NUM  LIKE #ORDER_NUMBER#
                        </isNotNull>
                        <!--2019/02/13 QC#30238 Add End  -->
                        <isNotNull property="searchCondition_OpenOrder">
                            $searchCondition_OpenOrder$
                        </isNotNull>
                        <isEqual property="teamSearchFlg" compareValue="Y">
                        AND DOO_IN.CRAT_BY_USR_ID =
                            CASE
                            WHEN
                                TMZN.CRAT_BY_USR_ID IS NULL
                            THEN
                                DOO_IN.CRAT_BY_USR_ID
                            ELSE
                                TMZN.CRAT_BY_USR_ID
                            END
                        AND (DOO_IN.SOLD_TO_CUST_ACCT_CD =
                            CASE
                            WHEN
                                TMZN.CUST_ACCT_CD IS NULL
                            THEN
                                DOO_IN.SOLD_TO_CUST_ACCT_CD
                            ELSE
                                TMZN.CUST_ACCT_CD
                            END
                            OR DOO_IN.SHIP_TO_CUST_ACCT_CD =
                            CASE
                            WHEN
                                TMZN.CUST_ACCT_CD IS NULL
                            THEN
                                DOO_IN.SHIP_TO_CUST_ACCT_CD
                            ELSE
                                TMZN.CUST_ACCT_CD
                            END
                            OR DOO_IN.BILL_TO_CUST_ACCT_CD =
                            CASE
                            WHEN
                                TMZN.CUST_ACCT_CD IS NULL
                            THEN
                                DOO_IN.BILL_TO_CUST_ACCT_CD
                            ELSE
                                TMZN.CUST_ACCT_CD
                            END)
                        AND DOO_IN.LINE_BIZ_TP_CD =
                            CASE
                            WHEN
                                TMZN.LINE_BIZ_TP_CD IS NULL
                            THEN
                                DOO_IN.LINE_BIZ_TP_CD
                            ELSE
                                TMZN.LINE_BIZ_TP_CD
                            END
                        AND DOO_IN.COA_BR_CD =
                            CASE
                            WHEN
                                TMZN.COA_BR_CD IS NULL
                            THEN
                                DOO_IN.COA_BR_CD
                            ELSE
                                TMZN.COA_BR_CD
                            END
                        </isEqual>
                        </isEqual>
                        <isEqual property="realTimeInqFlg" compareValue="N">
                        SELECT                                --No RealTime search
                           DOO_IN.GLBL_CMPY_CD
                           ,DOO_IN.SRC_REF_OR_CPO_ORD_NUM
                           ,DOO_IN.CPO_DTL_LINE_NUM
                           ,DOO_IN.CPO_DTL_LINE_SUB_NUM
                           ,DOO_IN.DS_ORD_POSN_NUM
                           ,DOO_IN.DS_CPO_LINE_NUM
                           ,DOO_IN.DS_CPO_LINE_SUB_NUM
                           ,DOO_IN.DS_CPO_RTRN_LINE_NUM
                           ,DOO_IN.DS_CPO_RTRN_LINE_SUB_NUM
                           ,DOO_IN.DS_CPO_CONFIG_PK
                           ,DOO_IN.SHPG_PLN_NUM
                           ,DOO_IN.PRCH_REQ_NUM
                           ,DOO_IN.PO_ORD_NUM
                           ,DOO_IN.SO_NUM
                           ,DOO_IN.SO_SLP_NUM
                           ,DOO_IN.INV_NUM
                           ,DOO_IN.ADD_ORIG_CPO_ORD_NUM
                           ,DOO_IN.CUST_ISS_PO_NUM
                           ,DOO_IN.LEASE_CMPY_PO_NUM
                           ,DOO_IN.SOLD_TO_CUST_ACCT_NM
                           ,DOO_IN.SOLD_TO_CUST_ACCT_CD
                           ,DOO_IN.SOLD_TO_CUST_LOC_CD
                           ,DOO_IN.SHIP_TO_CUST_ACCT_NM
                           ,DOO_IN.SHIP_TO_CUST_ACCT_CD
                           ,DOO_IN.SHIP_TO_CUST_LOC_CD
                           ,DOO_IN.BILL_TO_CUST_ACCT_NM
                           ,DOO_IN.BILL_TO_CUST_ACCT_CD
                           ,DOO_IN.BILL_TO_CUST_LOC_CD
                           ,DOO_IN.COA_BR_CD
                           ,DOO_IN.COA_BR_DESC_TXT
                           ,DOO_IN.COA_EXTN_CD
                           ,DOO_IN.COA_EXTN_DESC_TXT
                           ,DOO_IN.SLS_REP_TOC_CD
                           ,DOO_IN.SLS_REP_TOC_NM
                           ,DOO_IN.CPO_SRC_TP_CD
                           ,DOO_IN.CPO_SRC_TP_DESC_TXT
                           ,DOO_IN.DS_ORD_CATG_CD
                           ,DOO_IN.DS_ORD_CATG_DESC_TXT
                           ,DOO_IN.DS_ORD_TP_CD
                           ,DOO_IN.DS_ORD_TP_DESC_TXT
                           ,DOO_IN.DS_ORD_RSN_CD
                           ,DOO_IN.DS_ORD_RSN_DESC_TXT
                           ,DOO_IN.CSMP_CONTR_NUM
                           ,DOO_IN.PRC_CONTR_NUM
                           ,DOO_IN.PRC_CONTR_NM
                           ,DOO_IN.ORD_SRC_REF_NUM
                           ,DOO_IN.IMPT_STS_CD
                           ,DOO_IN.ZEROTH_PROD_CTRL_CD
                           ,DOO_IN.ZEROTH_PROD_CTRL_NM
                           ,DOO_IN.FIRST_PROD_CTRL_CD
                           ,DOO_IN.FIRST_PROD_CTRL_NM
                           ,DOO_IN.SCD_PROD_CTRL_CD
                           ,DOO_IN.SCD_PROD_CTRL_NM
                           ,DOO_IN.THIRD_PROD_CTRL_CD
                           ,DOO_IN.THIRD_PROD_CTRL_NM
                           ,DOO_IN.FRTH_PROD_CTRL_CD
                           ,DOO_IN.FRTH_PROD_CTRL_NM
                           ,DOO_IN.FIFTH_PROD_CTRL_CD
                           ,DOO_IN.FIFTH_PROD_CTRL_NM
                           ,DOO_IN.MDSE_CD
                           ,DOO_IN.MDSE_DESC_SHORT_TXT
                           ,DOO_IN.COA_PROD_CD
                           ,DOO_IN.COA_PROD_DESC_TXT
                           ,DOO_IN.COA_MDSE_TP_CD
                           ,DOO_IN.COA_MDSE_TP_DESC_TXT
                           ,DOO_IN.REV_COA_ACCT_CD
                           ,DOO_IN.REV_TRIAL_BAL_TP_CD
                           ,DOO_IN.MDL_ID
                           ,DOO_IN.T_MDL_NM
                           ,DOO_IN.SER_NUM
                           ,DOO_IN.RTRN_RSN_CD
                           ,DOO_IN.RTRN_RSN_DESC_TXT
                           ,DOO_IN.ACTL_SHIP_DT
                           ,DOO_IN.INV_DT
                           ,DOO_IN.ORD_LINE_SRC_CD
                           ,DOO_IN.ORD_LINE_SRC_NM
                           ,DOO_IN.RTL_WH_CD
                           ,DOO_IN.RTL_WH_NM
                           <!-- 2018/12/13 QC#29024 Add Start -->
                           ,DOO_IN.RTL_WH_DESC_TXT
                           <!-- 2018/12/13 QC#29024 Add End -->
                           ,DOO_IN.RTL_SWH_CD
                           ,DOO_IN.RTL_SWH_NM
                           ,DOO_IN.INVTY_LOC_CD
                           ,DOO_IN.VND_NM
                           ,DOO_IN.DPLY_VND_NM
                           ,DOO_IN.DROP_SHIP_FLG
                           ,DOO_IN.DS_CONTR_NUM
                           ,DOO_IN.SVC_CONFIG_MSTR_PK
                           ,DOO_IN.CRAT_BY_USR_ID
                           ,DOO_IN.CPO_ORD_TS
                           ,DOO_IN.ORD_BOOK_TS
                           ,DOO_IN.ORD_HDR_STS_CD
                           ,DOO_IN.ORD_LINE_STS_CD
                           ,DOO_IN.RTRN_LINE_STS_CD
                           ,DOO_IN.ORD_HDR_DPLY_STS_NM
                           ,DOO_IN.ORD_LINE_DPLY_STS_NM
                           ,DOO_IN.ORD_RTRN_LINE_DPLY_STS_NM
                           ,DOO_IN.CONFIG_CATG_CD
                           ,DOO_IN.SLS_REP_OR_SLS_TEAM_TOC_CD
                           ,DOO_IN.SLS_REP_OR_SLS_TEAM_TOC_NM
                           ,DOO_IN.ISTL_DT
                           ,DOO_IN.RDD_DT
                           ,DOO_IN.PSD_DT
                           ,DOO_IN.PDD_DT
                           ,DOO_IN.PRC_CATG_CD
                           ,DOO_IN.PRC_CATG_DESC_TXT
                           ,DOO_IN.ORD_QTY
                           ,DOO_IN.CR_HLD_QTY
                           ,DOO_IN.CR_CHK_QTY
                           ,DOO_IN.SLS_HLD_QTY
                           ,DOO_IN.ENT_CPO_DTL_FUNC_NET_AMT
                           ,DOO_IN.ENT_CPO_DTL_FUNC_SLS_AMT
                           <!-- 2019/02/25 QC#29736  ADD START -->
                           ,NULL AS ENT_FUNC_NET_UNIT_PRC_AMT
                           <!-- 2019/02/25 QC#29736  ADD END -->
                           ,DOO_IN.SP_FUNC_UNIT_PRC_AMT
                           ,DOO_IN.SP_FUNC_NET_UNIT_PRC_AMT
                           ,DOO_IN.SP_TOT_FUNC_NET_AMT
                           ,DOO_IN.LINE_BIZ_TP_CD
                           ,DOO_IN.LINE_BIZ_TP_DESC_TXT
                           ,DOO_IN.DS_ORD_LINE_CATG_CD
                           ,DOO_IN.DS_ORD_LINE_CATG_DESC_TXT
                           ,DOO_IN.SVC_MACH_MSTR_PK
                           ,DOO_IN.TRX_CD
                           ,DOO_IN.ORD_AGING_BCKT_DESC_TXT
                           ,DOO_IN.ORD_SRC_IMPT_DT
                           ,DOO_IN.DS_CPO_CRAT_USR_ID
                           ,DOO_IN.SLS_REP_PSN_NUM
                           ,DOO_IN.AQU_NUM
                            <isEqual property="teamSearchFlg" compareValue="Y">
                           ,TMZN.ORD_ZN_DESC_TXT                                 AS ORD_ZN_DESC_TXT
                           ,TMZN.ORD_TEAM_MSTR_NM                                AS ORD_TEAM_MSTR_NM
                            </isEqual>
                            <!-- 2019/02/25 QC#29736  ADD START -->
                           , COUNT(1) OVER ( 
                                            PARTITION BY
                                              DOO_IN.SRC_REF_OR_CPO_ORD_NUM
                                              , DOO_IN.SHPG_PLN_NUM
                                              , DOO_IN.CONFIG_CATG_CD
                                              , DOO_IN.DS_ORD_POSN_NUM
                                              , DOO_IN.DS_CPO_LINE_NUM
                                              , DOO_IN.DS_CPO_LINE_SUB_NUM
                                          ) AS COUNT_FOR_SER_NUM
                            <!-- 2019/02/25 QC#29736  ADD END -->
                        FROM
                           DS_ALL_ORD DOO_IN
                           <isEqual property="teamSearchFlg" compareValue="Y">
                             ,TMZN
                           </isEqual>
                        WHERE
                           DOO_IN.GLBL_CMPY_CD = #glblCmpyCd#
                           AND DOO_IN.EZCANCELFLAG = '0'
                        <isEqual property="cMsg.xxOnlySlsOrdFlg" compareValue="Y">
                            AND DOO_IN.TRX_CD = #trxCd#
                        </isEqual>
                        <!--2019/02/13 QC#30238 Add Start  -->
                        <isNotNull property="ORDER_NUMBER">
                            AND DOO_IN.SRC_REF_OR_CPO_ORD_NUM LIKE #ORDER_NUMBER#
                        </isNotNull>
                        <!--2019/02/13 QC#30238 Add End  -->
                        <isNotNull property="searchCondition_OpenOrder">
                            $searchCondition_OpenOrder$
                        </isNotNull>
                        <isEqual property="teamSearchFlg" compareValue="Y">
                        AND DOO_IN.CRAT_BY_USR_ID =
                            CASE
                            WHEN
                                TMZN.CRAT_BY_USR_ID IS NULL
                            THEN
                                DOO_IN.CRAT_BY_USR_ID
                            ELSE
                                TMZN.CRAT_BY_USR_ID
                            END
                        AND (DOO_IN.SOLD_TO_CUST_ACCT_CD =
                            CASE
                            WHEN
                                TMZN.CUST_ACCT_CD IS NULL
                            THEN
                                DOO_IN.SOLD_TO_CUST_ACCT_CD
                            ELSE
                                TMZN.CUST_ACCT_CD
                            END
                            OR DOO_IN.SHIP_TO_CUST_ACCT_CD =
                            CASE
                            WHEN
                                TMZN.CUST_ACCT_CD IS NULL
                            THEN
                                DOO_IN.SHIP_TO_CUST_ACCT_CD
                            ELSE
                                TMZN.CUST_ACCT_CD
                            END
                            OR DOO_IN.BILL_TO_CUST_ACCT_CD =
                            CASE
                            WHEN
                                TMZN.CUST_ACCT_CD IS NULL
                            THEN
                                DOO_IN.BILL_TO_CUST_ACCT_CD
                            ELSE
                                TMZN.CUST_ACCT_CD
                            END)
                        AND DOO_IN.LINE_BIZ_TP_CD =
                            CASE
                            WHEN
                                TMZN.LINE_BIZ_TP_CD IS NULL
                            THEN
                                DOO_IN.LINE_BIZ_TP_CD
                            ELSE
                                TMZN.LINE_BIZ_TP_CD
                            END
                        AND DOO_IN.COA_BR_CD =
                            CASE
                            WHEN
                                TMZN.COA_BR_CD IS NULL
                            THEN
                                DOO_IN.COA_BR_CD
                            ELSE
                                TMZN.COA_BR_CD
                            END
                        </isEqual>
                        </isEqual>
                        ) DOO
        </isEqual>
                <isEqual property="unionPendImptOrdFlg" compareValue="Y">
                UNION ALL
                </isEqual>
                <isEqual property="cMsg.xxInclPendImptOrdFlg" compareValue="Y">
                SELECT
                    DOO2.GLBL_CMPY_CD                                      AS GLBL_CMPY_CD
                    ,DOO2.SRC_REF_OR_CPO_ORD_NUM                           AS SRC_REF_OR_CPO_ORD_NUM
                    ,DOO2.CPO_DTL_LINE_NUM                                 AS CPO_DTL_LINE_NUM
                    ,DOO2.CPO_DTL_LINE_SUB_NUM                             AS CPO_DTL_LINE_SUB_NUM
                    ,DOO2.DS_ORD_POSN_NUM                                  AS DS_ORD_POSN_NUM
                    ,DOO2.DS_CPO_LINE_NUM                                  AS DS_CPO_LINE_NUM
                    ,DOO2.DS_CPO_LINE_SUB_NUM                              AS DS_CPO_LINE_SUB_NUM
                    ,DOO2.DS_CPO_RTRN_LINE_NUM                             AS DS_CPO_RTRN_LINE_NUM
                    ,DOO2.DS_CPO_RTRN_LINE_SUB_NUM                         AS DS_CPO_RTRN_LINE_SUB_NUM
                    ,DOO2.DS_CPO_CONFIG_PK                                 AS DS_CPO_CONFIG_PK
                    ,DOO2.SHPG_PLN_NUM                                     AS SHPG_PLN_NUM
                    ,DOO2.PRCH_REQ_NUM                                     AS PRCH_REQ_NUM
                    ,DOO2.PO_ORD_NUM                                       AS PO_ORD_NUM
                    ,DOO2.SO_NUM                                           AS SO_NUM
                    ,DOO2.SO_SLP_NUM                                       AS SO_SLP_NUM
                    ,DOO2.INV_NUM                                          AS INV_NUM
                    ,''                                                    AS INV_BOL_LINE_NUM
                    ,''                                                    AS INV_LINE_NUM
                    ,''                                                    AS INV_LINE_SUB_NUM
                    ,''                                                    AS INV_LINE_SUB_TRX_NUM
                    ,0                                                     AS DS_INV_SLS_CR_PK
                    ,DOO2.ADD_ORIG_CPO_ORD_NUM                             AS ADD_ORIG_CPO_ORD_NUM
                    ,DOO2.CUST_ISS_PO_NUM                                  AS CUST_ISS_PO_NUM
                    ,DOO2.LEASE_CMPY_PO_NUM                                AS LEASE_CMPY_PO_NUM
                    ,DOO2.SOLD_TO_CUST_ACCT_NM                             AS SOLD_TO_CUST_ACCT_NM
                    ,DOO2.SOLD_TO_CUST_ACCT_CD                             AS SOLD_TO_CUST_ACCT_CD
                    ,DOO2.SOLD_TO_CUST_LOC_CD                              AS SOLD_TO_CUST_LOC_CD
                    ,DOO2.SHIP_TO_CUST_ACCT_NM                             AS SHIP_TO_CUST_ACCT_NM
                    ,DOO2.SHIP_TO_CUST_ACCT_CD                             AS SHIP_TO_CUST_ACCT_CD
                    ,DOO2.SHIP_TO_CUST_LOC_CD                              AS SHIP_TO_CUST_LOC_CD
                    ,DOO2.BILL_TO_CUST_ACCT_NM                             AS BILL_TO_CUST_ACCT_NM
                    ,DOO2.BILL_TO_CUST_ACCT_CD                             AS BILL_TO_CUST_ACCT_CD
                    ,DOO2.BILL_TO_CUST_LOC_CD                              AS BILL_TO_CUST_LOC_CD
                    ,DOO2.COA_BR_CD                                        AS COA_BR_CD
                    ,DOO2.COA_BR_DESC_TXT                                  AS COA_BR_DESC_TXT
                    ,DOO2.COA_EXTN_CD                                      AS COA_EXTN_CD
                    ,DOO2.COA_EXTN_DESC_TXT                                AS COA_EXTN_DESC_TXT
                    ,DOO2.SLS_REP_TOC_CD                                   AS SLS_REP_TOC_CD
                    ,DOO2.SLS_REP_TOC_NM                                   AS SLS_REP_TOC_NM
                    ,DOO2.CPO_SRC_TP_CD                                    AS CPO_SRC_TP_CD
                    ,DOO2.CPO_SRC_TP_DESC_TXT                              AS CPO_SRC_TP_DESC_TXT
                    ,DOO2.DS_ORD_CATG_CD                                   AS DS_ORD_CATG_CD
                    ,DOO2.DS_ORD_CATG_DESC_TXT                             AS DS_ORD_CATG_DESC_TXT
                    ,DOO2.DS_ORD_TP_CD                                     AS DS_ORD_TP_CD
                    ,DOO2.DS_ORD_TP_DESC_TXT                               AS DS_ORD_TP_DESC_TXT
                    ,DOO2.DS_ORD_RSN_CD                                    AS DS_ORD_RSN_CD
                    ,DOO2.DS_ORD_RSN_DESC_TXT                              AS DS_ORD_RSN_DESC_TXT
                    ,DOO2.CSMP_CONTR_NUM                                   AS CSMP_CONTR_NUM
                    ,DOO2.PRC_CONTR_NUM                                    AS PRC_CONTR_NUM
                    ,DOO2.PRC_CONTR_NM                                     AS PRC_CONTR_NM
                    ,DOO2.ORD_SRC_REF_NUM                                  AS ORD_SRC_REF_NUM
                    ,DOO2.IMPT_STS_CD                                      AS IMPT_STS_CD
                    ,DOO2.ZEROTH_PROD_CTRL_CD                              AS ZEROTH_PROD_CTRL_CD
                    ,DOO2.ZEROTH_PROD_CTRL_NM                              AS ZEROTH_PROD_CTRL_NM
                    ,DOO2.FIRST_PROD_CTRL_CD                               AS FIRST_PROD_CTRL_CD
                    ,DOO2.FIRST_PROD_CTRL_NM                               AS FIRST_PROD_CTRL_NM
                    ,DOO2.SCD_PROD_CTRL_CD                                 AS SCD_PROD_CTRL_CD
                    ,DOO2.SCD_PROD_CTRL_NM                                 AS SCD_PROD_CTRL_NM
                    ,DOO2.THIRD_PROD_CTRL_CD                               AS THIRD_PROD_CTRL_CD
                    ,DOO2.THIRD_PROD_CTRL_NM                               AS THIRD_PROD_CTRL_NM
                    ,DOO2.FRTH_PROD_CTRL_CD                                AS FRTH_PROD_CTRL_CD
                    ,DOO2.FRTH_PROD_CTRL_NM                                AS FRTH_PROD_CTRL_NM
                    ,DOO2.FIFTH_PROD_CTRL_CD                               AS FIFTH_PROD_CTRL_CD
                    ,DOO2.FIFTH_PROD_CTRL_NM                               AS FIFTH_PROD_CTRL_NM
                    ,DOO2.MDSE_CD                                          AS MDSE_CD
                    ,DOO2.MDSE_DESC_SHORT_TXT                              AS MDSE_DESC_SHORT_TXT
                    ,DOO2.COA_PROD_CD                                      AS COA_PROD_CD
                    ,DOO2.COA_PROD_DESC_TXT                                AS COA_PROD_DESC_TXT
                    ,DOO2.COA_MDSE_TP_CD                                   AS COA_MDSE_TP_CD
                    ,DOO2.COA_MDSE_TP_DESC_TXT                             AS COA_MDSE_TP_DESC_TXT
                    ,DOO2.REV_COA_ACCT_CD                                  AS REV_COA_ACCT_CD
                    ,DOO2.REV_TRIAL_BAL_TP_CD                              AS REV_TRIAL_BAL_TP_CD
                    ,DOO2.MDL_ID                                           AS MDL_ID
                    ,DOO2.T_MDL_NM                                         AS T_MDL_NM
                    ,DOO2.SER_NUM                                          AS SER_NUM
                    ,DOO2.RTRN_RSN_CD                                      AS RTRN_RSN_CD
                    ,DOO2.RTRN_RSN_DESC_TXT                                AS RTRN_RSN_DESC_TXT
                    ,DOO2.ACTL_SHIP_DT                                     AS ACTL_SHIP_DT
                    ,DOO2.INV_DT                                           AS INV_DT
                    ,DOO2.ORD_LINE_SRC_CD                                  AS ORD_LINE_SRC_CD
                    ,DOO2.ORD_LINE_SRC_NM                                  AS ORD_LINE_SRC_NM
                    ,DOO2.RTL_WH_CD                                        AS RTL_WH_CD
                    ,DOO2.RTL_WH_NM                                        AS RTL_WH_NM
                    <!-- 2018/12/13 QC#29024 Add Start -->
                    ,DOO2.RTL_WH_DESC_TXT                                  AS RTL_WH_DESC_TXT
                    <!-- 2018/12/13 QC#29024 Add End -->
                    ,DOO2.RTL_SWH_CD                                       AS RTL_SWH_CD
                    ,DOO2.RTL_SWH_NM                                       AS RTL_SWH_NM
                    ,DOO2.INVTY_LOC_CD                                     AS INVTY_LOC_CD
                    ,DOO2.VND_NM                                           AS VND_NM
                    ,DOO2.DPLY_VND_NM                                      AS DPLY_VND_NM
                    ,DOO2.DROP_SHIP_FLG                                    AS DROP_SHIP_FLG
                    ,DOO2.DS_CONTR_NUM                                     AS DS_CONTR_NUM
                    ,DOO2.SVC_CONFIG_MSTR_PK                               AS SVC_CONFIG_MSTR_PK
                    ,DOO2.CRAT_BY_USR_ID                                   AS CRAT_BY_USR_ID
                    ,DOO2.CPO_ORD_TS                                       AS CPO_ORD_TS
                    ,SUBSTR(DOO2.ORD_BOOK_TS, 0 ,8)                        AS ORD_BOOK_TS
                    ,DOO2.ORD_HDR_STS_CD                                   AS ORD_HDR_STS_CD
                    ,DOO2.ORD_LINE_STS_CD                                  AS ORD_LINE_STS_CD
                    ,DOO2.RTRN_LINE_STS_CD                                 AS RTRN_LINE_STS_CD
                    ,DOO2.ORD_HDR_DPLY_STS_NM                              AS ORD_HDR_DPLY_STS_NM
                    ,DOO2.ORD_LINE_DPLY_STS_NM                             AS ORD_LINE_DPLY_STS_NM
                    ,DOO2.ORD_RTRN_LINE_DPLY_STS_NM                        AS ORD_RTRN_LINE_DPLY_STS_NM
                    ,DOO2.CONFIG_CATG_CD                                   AS CONFIG_CATG_CD
                    ,DOO2.SLS_REP_OR_SLS_TEAM_TOC_CD                       AS SLS_REP_OR_SLS_TEAM_TOC_CD
                    ,DOO2.SLS_REP_OR_SLS_TEAM_TOC_NM                       AS SLS_REP_OR_SLS_TEAM_TOC_NM
                    ,DOO2.ISTL_DT                                          AS ISTL_DT
                    ,DOO2.RDD_DT                                           AS RDD_DT
                    ,DOO2.PSD_DT                                           AS PSD_DT
                    ,DOO2.PDD_DT                                           AS PDD_DT
                    ,DOO2.PRC_CATG_CD                                      AS PRC_CATG_CD
                    ,DOO2.PRC_CATG_DESC_TXT                                AS PRC_CATG_DESC_TXT
                    <!-- 2019/10/04 QC#53981 Mod START -->
                    <!-- 2019/02/26 QC#29736 Mod Start -->
                    <!--,DOO2.ORD_QTY                                          AS ORD_QTY -->
                    <!--,CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                        1
                     ELSE
                        DOO2.ORD_QTY
                     END                                                   AS ORD_QTY   -->
                    ,DOO2.ORD_QTY                                          AS ORD_QTY
                    <!-- 2019/02/26 QC#29736 Mod End -->
                    <!-- 2019/10/04 QC#53981 Mod END -->
                    ,DOO2.CR_HLD_QTY                                       AS CR_HLD_QTY
                    ,DOO2.CR_CHK_QTY                                       AS CR_CHK_QTY
                    ,DOO2.SLS_HLD_QTY                                      AS SLS_HLD_QTY
                    <!-- 2019/10/04 QC#53981 Mod START -->
                    <!-- 2019/10/02 QC#53600 Mod START -->
                    <!-- 2019/02/26 QC#29736 Mod Start -->
                    <!-- ,NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0)) AS AMT -->
                    <!-- ,CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                        NVL(DOO2.SP_FUNC_NET_UNIT_PRC_AMT,0)
                     ELSE
                        NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                     END                                                   AS AMT -->
                    <!-- ,CASE WHEN COUNT_FOR_SER_NUM &gt;= 2 THEN
                        NVL(DOO2.SP_FUNC_UNIT_PRC_AMT,0)
                     ELSE
                        NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                     END                                                   AS AMT -->
                    ,NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0)) AS AMT
                     <!-- 2019/02/26 QC#29736 Mod End -->
                     <!-- 2019/10/02 QC#53600 Mod END -->
                     <!-- 2019/10/04 QC#53981 Mod END -->
                    ,DOO2.ENT_CPO_DTL_FUNC_NET_AMT                         AS ENT_CPO_DTL_FUNC_NET_AMT
                    ,DOO2.ENT_CPO_DTL_FUNC_SLS_AMT                         AS ENT_CPO_DTL_FUNC_SLS_AMT
                    ,DOO2.SP_FUNC_UNIT_PRC_AMT                             AS SP_FUNC_UNIT_PRC_AMT
                    ,DOO2.SP_FUNC_NET_UNIT_PRC_AMT                         AS SP_FUNC_NET_UNIT_PRC_AMT
                    ,DOO2.SP_TOT_FUNC_NET_AMT                              AS SP_TOT_FUNC_NET_AMT
                    ,DOO2.TRX_CD                                           AS TRX_CD
                    ,''                                                    AS TRX_RSN_CD
                    ,''                                                    AS DFRD_REV_FLG
                    ,DOO2.LINE_BIZ_TP_CD                                   AS LINE_BIZ_TP_CD
                    ,DOO2.LINE_BIZ_TP_DESC_TXT                             AS LINE_BIZ_TP_DESC_TXT
                    ,DOO2.DS_ORD_LINE_CATG_CD                              AS DS_ORD_LINE_CATG_CD
                    ,DOO2.DS_ORD_LINE_CATG_DESC_TXT                        AS DS_ORD_LINE_CATG_DESC_TXT
                    ,DOO2.SVC_MACH_MSTR_PK                                 AS SVC_MACH_MSTR_PK
                    ,DOO2.ORD_AGING_BCKT_DESC_TXT                          AS ORD_AGING_BCKT_DESC_TXT
                    ,DOO2.ORD_SRC_IMPT_DT                                  AS ORD_SRC_IMPT_DT
                    ,DOO2.SLS_REP_PSN_NUM                                  AS SLS_REP_PSN_NUM
                    ,DOO2.AQU_NUM                                          AS AQU_NUM
                     <isEqual property="teamSearchFlg" compareValue="Y">
                    ,TMZN.ORD_ZN_DESC_TXT                                 AS ORD_ZN_DESC_TXT
                    ,TMZN.ORD_TEAM_MSTR_NM                                AS ORD_TEAM_MSTR_NM
                     </isEqual>
            <isEqual property="cMsg.xxRsltModeCd" compareValue="2">
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsPendImpt#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_IMPT_SMRY_AMT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsEnt#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS ENT_SMRY_AMT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsDiHld#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS DI_HLD_SMRY_AMT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsVld#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS VLD_SMRY_AMT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsPrft#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PRFT_SMRY_AMT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsCrHld#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS CR_HLD_SMRY_AMT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsSplyAbuse#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS SPLY_ABUSE_SMRY_AMT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsPendReSubmt#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_RE_SUBMT_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsBook# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsBook#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS BOOK_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsAwaitDropShip# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsAwaitDropShip#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS AWAIT_DROP_SHIP_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendReAlloc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendReAlloc#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_RE_ALLOC_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPoCanc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPoCanc#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PO_CANC_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendFufl# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendFufl#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_FUFL_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendAlloc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendAlloc#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_ALLOC_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsBo# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsBo#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS BO_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendPick# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendPick#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_PICK_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsDelyToShop# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsDelyToShop#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS DELY_TO_SHOP_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsInShopConfig# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsInShopConfig#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS IN_SHOP_CONFIG_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendShip# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendShip#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_SHIP_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsShip# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsShip#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS SHIP_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendDelyConf# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendDelyConf#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_DELY_CONF_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendIstl# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendIstl#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_ISTL_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsOnLoan# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsOnLoan#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS ON_LOAN_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsWaitRcpt# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsWaitRcpt#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS WAIT_RCPT_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendRtrn# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendRtrn#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_RTRN_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendInsp# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendInsp#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_INSP_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsRwsCanc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsRwsCanc#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS RWS_CANC_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPrtlRcv# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPrtlRcv#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PRTL_RCV_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendInv# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendInv#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_INV_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsBllgHld# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsBllgHld#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS BLLG_HLD_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendDlrIstl# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendDlrIstl#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS PEND_DLR_ISTL_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsShipClo# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsShipClo#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS SHIP_CLO_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsClo# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsClo#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS CLO_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsCloLoanRtrn# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsCloLoanRtrn#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS CLO_LOAN_RTRN_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsCloLoanSold# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsCloLoanSold#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS CLO_LOAN_SOLD_SMRY_AMT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsCanc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsCanc#
                        THEN
                            NVL(DOO2.SP_TOT_FUNC_NET_AMT,NVL(DOO2.ENT_CPO_DTL_FUNC_NET_AMT,0))
                        ELSE 0
                     END                                                  AS CANC_SMRY_AMT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsPendImpt# then SRC_REF_OR_CPO_ORD_NUM
                        ELSE null
                     END                                                  AS PEND_IMPT_SMRY_CNT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsEnt# then SRC_REF_OR_CPO_ORD_NUM
                        ELSE null
                     END                                                  AS ENT_SMRY_CNT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsDiHld# then SRC_REF_OR_CPO_ORD_NUM
                        ELSE null
                     END                                                  AS DI_HLD_SMRY_CNT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsVld# then SRC_REF_OR_CPO_ORD_NUM
                        ELSE null
                     END                                                  AS VLD_SMRY_CNT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsPrft# then SRC_REF_OR_CPO_ORD_NUM
                        ELSE null
                     END                                                  AS PRFT_SMRY_CNT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsCrHld# then SRC_REF_OR_CPO_ORD_NUM
                        ELSE null
                     END                                                  AS CR_HLD_SMRY_CNT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsSplyAbuse# then SRC_REF_OR_CPO_ORD_NUM
                        ELSE null
                     END                                                  AS SPLY_ABUSE_SMRY_CNT
                    ,CASE DOO2.ORD_HDR_DPLY_STS_NM
                        WHEN #stsPendReSubmt# then SRC_REF_OR_CPO_ORD_NUM
                        ELSE null
                     END                                                  AS PEND_RE_SUBMT_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsBook# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsBook#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS BOOK_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsAwaitDropShip# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsAwaitDropShip#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS AWAIT_DROP_SHIP_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendReAlloc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendReAlloc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_RE_ALLOC_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPoCanc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPoCanc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PO_CANC_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendFufl# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendFufl#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_FUFL_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendAlloc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendAlloc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_ALLOC_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsBo# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsBo#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS BO_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendPick# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendPick#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_PICK_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsDelyToShop# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsDelyToShop#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS DELY_TO_SHOP_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsInShopConfig# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsInShopConfig#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS IN_SHOP_CONFIG_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendShip# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendShip#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_SHIP_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsShip# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsShip#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS SHIP_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendDelyConf# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendDelyConf#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_DELY_CONF_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendIstl# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendIstl#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_ISTL_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsOnLoan# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsOnLoan#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS ON_LOAN_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsWaitRcpt# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsWaitRcpt#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS WAIT_RCPT_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendRtrn# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendRtrn#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_RTRN_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendInsp# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendInsp#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_INSP_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsRwsCanc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsRwsCanc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS RWS_CANC_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPrtlRcv# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPrtlRcv#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PRTL_RCV_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendInv# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendInv#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_INV_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsBllgHld# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsBllgHld#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS BLLG_HLD_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsPendDlrIstl# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsPendDlrIstl#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS PEND_DLR_ISTL_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsShipClo# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsShipClo#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS SHIP_CLO_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsClo# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsClo#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS CLO_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsCloLoanRtrn# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsCloLoanRtrn#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS CLO_LOAN_RTRN_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsCloLoanSold# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsCloLoanSold#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS CLO_LOAN_SOLD_SMRY_CNT
                    ,CASE
                        WHEN DOO2.ORD_LINE_DPLY_STS_NM = #stsCanc# OR DOO2.ORD_RTRN_LINE_DPLY_STS_NM = #stsCanc#
                        THEN SRC_REF_OR_CPO_ORD_NUM
                        ELSE NULL
                     END                                                  AS CANC_SMRY_CNT
            </isEqual>
                FROM
                    <isEqual property="realTimeInqFlg" compareValue="N">
                    (
                    SELECT
                        EZCANCELFLAG
                        , GLBL_CMPY_CD
                        , DS_ALL_ORD_PK
                        , SRC_REF_OR_CPO_ORD_NUM
                        , CPO_DTL_LINE_NUM
                        , CPO_DTL_LINE_SUB_NUM
                        , DS_ORD_POSN_NUM
                        , DS_CPO_LINE_NUM
                        , DS_CPO_LINE_SUB_NUM
                        , DS_CPO_RTRN_LINE_NUM
                        , DS_CPO_RTRN_LINE_SUB_NUM
                        , DS_CPO_CONFIG_PK
                        , SHPG_PLN_NUM
                        , PRCH_REQ_NUM
                        , PO_ORD_NUM
                        , SO_NUM
                        , SO_SLP_NUM
                        , INV_NUM
                        , INV_BOL_LINE_NUM
                        , INV_LINE_NUM
                        , INV_LINE_SUB_NUM
                        , INV_LINE_SUB_TRX_NUM
                        , DS_INV_SLS_CR_PK
                        , ADD_ORIG_CPO_ORD_NUM
                        , CUST_ISS_PO_NUM
                        , LEASE_CMPY_PO_NUM
                        , SOLD_TO_CUST_ACCT_NM
                        , SOLD_TO_CUST_ACCT_CD
                        , SOLD_TO_CUST_LOC_CD
                        , SHIP_TO_CUST_ACCT_NM
                        , SHIP_TO_CUST_ACCT_CD
                        , SHIP_TO_CUST_LOC_CD
                        , BILL_TO_CUST_ACCT_NM
                        , BILL_TO_CUST_ACCT_CD
                        , BILL_TO_CUST_LOC_CD
                        , COA_BR_CD
                        , COA_BR_DESC_TXT
                        , COA_EXTN_CD
                        , COA_EXTN_DESC_TXT
                        , SLS_REP_TOC_CD
                        , SLS_REP_TOC_NM
                        , CPO_SRC_TP_CD
                        , CPO_SRC_TP_DESC_TXT
                        , DS_ORD_CATG_CD
                        , DS_ORD_CATG_DESC_TXT
                        , DS_ORD_TP_CD
                        , DS_ORD_TP_DESC_TXT
                        , DS_ORD_RSN_CD
                        , DS_ORD_RSN_DESC_TXT
                        , CSMP_CONTR_NUM
                        , PRC_CONTR_NUM
                        , PRC_CONTR_NM
                        , ORD_SRC_REF_NUM
                        , IMPT_STS_CD
                        , ZEROTH_PROD_CTRL_CD
                        , ZEROTH_PROD_CTRL_NM
                        , FIRST_PROD_CTRL_CD
                        , FIRST_PROD_CTRL_NM
                        , SCD_PROD_CTRL_CD
                        , SCD_PROD_CTRL_NM
                        , THIRD_PROD_CTRL_CD
                        , THIRD_PROD_CTRL_NM
                        , FRTH_PROD_CTRL_CD
                        , FRTH_PROD_CTRL_NM
                        , FIFTH_PROD_CTRL_CD
                        , FIFTH_PROD_CTRL_NM
                        , MDSE_CD
                        , MDSE_DESC_SHORT_TXT
                        , COA_PROD_CD
                        , COA_PROD_DESC_TXT
                        , COA_MDSE_TP_CD
                        , COA_MDSE_TP_DESC_TXT
                        , REV_COA_ACCT_CD
                        , REV_TRIAL_BAL_TP_CD
                        , MDL_ID
                        , T_MDL_NM
                        , SER_NUM
                        , RTRN_RSN_CD
                        , RTRN_RSN_DESC_TXT
                        , ACTL_SHIP_DT
                        , INV_DT
                        , ORD_LINE_SRC_CD
                        , ORD_LINE_SRC_NM
                        , RTL_WH_CD
                        , RTL_WH_NM
                        , RTL_SWH_CD
                        , RTL_SWH_NM
                        , INVTY_LOC_CD
                        , VND_NM
                        , DROP_SHIP_FLG
                        , DS_CONTR_NUM
                        , SVC_CONFIG_MSTR_PK
                        , CRAT_BY_USR_ID
                        , CPO_ORD_TS
                        , ORD_BOOK_TS
                        , ORD_HDR_STS_CD
                        , ORD_LINE_STS_CD
                        , RTRN_LINE_STS_CD
                        , ORD_HDR_DPLY_STS_NM
                        , ORD_LINE_DPLY_STS_NM
                        , ORD_RTRN_LINE_DPLY_STS_NM
                        , CONFIG_CATG_CD
                        , SLS_REP_OR_SLS_TEAM_TOC_CD
                        , SLS_REP_OR_SLS_TEAM_TOC_NM
                        , ISTL_DT
                        , RDD_DT
                        , PSD_DT
                        , PDD_DT
                        , PRC_CATG_CD
                        , PRC_CATG_DESC_TXT
                        , ORD_QTY
                        , CR_HLD_QTY
                        , CR_CHK_QTY
                        , SLS_HLD_QTY
                        , ENT_CPO_DTL_FUNC_NET_AMT
                        , ENT_CPO_DTL_FUNC_SLS_AMT
                        , SP_FUNC_UNIT_PRC_AMT
                        , SP_FUNC_NET_UNIT_PRC_AMT
                        , SP_TOT_FUNC_NET_AMT
                        , LINE_BIZ_TP_CD
                        , LINE_BIZ_TP_DESC_TXT
                        , DS_ORD_LINE_CATG_CD
                        , DS_ORD_LINE_CATG_DESC_TXT
                        , SVC_MACH_MSTR_PK
                        , INV_LINE_FUNC_NET_AMT
                        , FUNC_GRS_TOT_PRC_AMT
                        , FUNC_SLS_CR_AMT
                        , TRX_CD
                        , TRX_RSN_CD
                        , DFRD_REV_FLG
                        , ORD_AGING_BCKT_DESC_TXT
                        , ORD_SRC_IMPT_DT
                        , DPLY_VND_NM
                        , DS_CPO_CRAT_USR_ID
                        , SLS_REP_PSN_NUM
                        , AQU_NUM
                        , RTL_WH_DESC_TXT
                        <!-- 2019/10/04 QC#53981 DEL START -->
                        <!-- 2019/02/25 QC#29736  ADD START -->
                        <!-- , COUNT(1) OVER ( 
                                        PARTITION BY
                                          DOO2_IN.SRC_REF_OR_CPO_ORD_NUM
                                          , DOO2_IN.SHPG_PLN_NUM
                                          , DOO2_IN.CONFIG_CATG_CD
                                          , DOO2_IN.DS_ORD_POSN_NUM
                                          , DOO2_IN.DS_CPO_LINE_NUM
                                          , DOO2_IN.DS_CPO_LINE_SUB_NUM
                                      ) AS COUNT_FOR_SER_NUM -->
                        <!-- 2019/02/25 QC#29736  ADD END -->
                        <!-- 2019/10/04 QC#53981 DEL END -->
                    FROM
                        DS_ALL_ORD DOO2_IN
                    ) DOO2
                    </isEqual>
                    <isEqual property="realTimeInqFlg" compareValue="Y">
                    (
                    SELECT
                        GLBL_CMPY_CD
                        ,SRC_REF_OR_CPO_ORD_NUM
                        ,CPO_DTL_LINE_NUM
                        ,CPO_DTL_LINE_SUB_NUM
                        ,DS_ORD_POSN_NUM
                        ,DS_CPO_LINE_NUM
                        ,DS_CPO_LINE_SUB_NUM
                        ,DS_CPO_RTRN_LINE_NUM
                        ,DS_CPO_RTRN_LINE_SUB_NUM
                        ,DS_CPO_CONFIG_PK
                        ,SHPG_PLN_NUM
                        ,PRCH_REQ_NUM
                        ,PO_ORD_NUM
                        ,SO_NUM
                        ,SO_SLP_NUM
                        ,INV_NUM
                        ,ADD_ORIG_CPO_ORD_NUM
                        ,CUST_ISS_PO_NUM
                        ,LEASE_CMPY_PO_NUM
                        ,SOLD_TO_CUST_ACCT_NM
                        ,SOLD_TO_CUST_ACCT_CD
                        ,SOLD_TO_CUST_LOC_CD
                        ,SHIP_TO_CUST_ACCT_NM
                        ,SHIP_TO_CUST_ACCT_CD
                        ,SHIP_TO_CUST_LOC_CD
                        ,BILL_TO_CUST_ACCT_NM
                        ,BILL_TO_CUST_ACCT_CD
                        ,BILL_TO_CUST_LOC_CD
                        ,COA_BR_CD
                        ,COA_BR_DESC_TXT
                        ,COA_EXTN_CD
                        ,COA_EXTN_DESC_TXT
                        ,SLS_REP_TOC_CD
                        ,SLS_REP_TOC_NM
                        ,CPO_SRC_TP_CD
                        ,CPO_SRC_TP_DESC_TXT
                        ,DS_ORD_CATG_CD
                        ,DS_ORD_CATG_DESC_TXT
                        ,DS_ORD_TP_CD
                        ,DS_ORD_TP_DESC_TXT
                        ,DS_ORD_RSN_CD
                        ,DS_ORD_RSN_DESC_TXT
                        ,CSMP_CONTR_NUM
                        ,PRC_CONTR_NUM
                        ,PRC_CONTR_NM
                        ,ORD_SRC_REF_NUM
                        ,IMPT_STS_CD
                        ,ZEROTH_PROD_CTRL_CD
                        ,ZEROTH_PROD_CTRL_NM
                        ,FIRST_PROD_CTRL_CD
                        ,FIRST_PROD_CTRL_NM
                        ,SCD_PROD_CTRL_CD
                        ,SCD_PROD_CTRL_NM
                        ,THIRD_PROD_CTRL_CD
                        ,THIRD_PROD_CTRL_NM
                        ,FRTH_PROD_CTRL_CD
                        ,FRTH_PROD_CTRL_NM
                        ,FIFTH_PROD_CTRL_CD
                        ,FIFTH_PROD_CTRL_NM
                        ,MDSE_CD
                        ,MDSE_DESC_SHORT_TXT
                        ,COA_PROD_CD
                        ,COA_PROD_DESC_TXT
                        ,COA_MDSE_TP_CD
                        ,COA_MDSE_TP_DESC_TXT
                        ,REV_COA_ACCT_CD
                        ,REV_TRIAL_BAL_TP_CD
                        ,MDL_ID
                        ,T_MDL_NM
                        ,SER_NUM
                        ,RTRN_RSN_CD
                        ,RTRN_RSN_DESC_TXT
                        ,ACTL_SHIP_DT
                        ,INV_DT
                        ,ORD_LINE_SRC_CD
                        ,ORD_LINE_SRC_NM
                        ,RTL_WH_CD
                        ,RTL_WH_NM
                        <!-- 2018/12/13 QC#29024 Add Start -->
                        ,RTL_WH_DESC_TXT
                        <!-- 2018/12/13 QC#29024 Add End -->
                        ,RTL_SWH_CD
                        ,RTL_SWH_NM
                        ,INVTY_LOC_CD
                        ,VND_NM
                        ,DPLY_VND_NM
                        ,DROP_SHIP_FLG
                        ,DS_CONTR_NUM
                        ,SVC_CONFIG_MSTR_PK
                        ,CRAT_BY_USR_ID
                        ,CPO_ORD_TS
                        ,ORD_BOOK_TS
                        ,ORD_HDR_STS_CD
                        ,ORD_LINE_STS_CD
                        ,RTRN_LINE_STS_CD
                        ,ORD_HDR_DPLY_STS_NM
                        ,ORD_LINE_DPLY_STS_NM
                        ,ORD_RTRN_LINE_DPLY_STS_NM
                        ,CONFIG_CATG_CD
                        ,SLS_REP_OR_SLS_TEAM_TOC_CD
                        ,SLS_REP_OR_SLS_TEAM_TOC_NM
                        ,ISTL_DT
                        ,RDD_DT
                        ,PSD_DT
                        ,PDD_DT
                        ,PRC_CATG_CD
                        ,PRC_CATG_DESC_TXT
                        ,ORD_QTY
                        ,CR_HLD_QTY
                        ,CR_CHK_QTY
                        ,SLS_HLD_QTY
                        ,ENT_CPO_DTL_FUNC_NET_AMT
                        ,ENT_CPO_DTL_FUNC_SLS_AMT
                        ,SP_FUNC_UNIT_PRC_AMT
                        ,SP_FUNC_NET_UNIT_PRC_AMT
                        ,SP_TOT_FUNC_NET_AMT
                        ,LINE_BIZ_TP_CD
                        ,LINE_BIZ_TP_DESC_TXT
                        ,DS_ORD_LINE_CATG_CD
                        ,DS_ORD_LINE_CATG_DESC_TXT
                        ,SVC_MACH_MSTR_PK
                        ,TRX_CD
                        ,ORD_AGING_BCKT_DESC_TXT
                        ,ORD_SRC_IMPT_DT
                        ,DS_CPO_CRAT_USR_ID
                        ,SLS_REP_PSN_NUM
                        ,AQU_NUM
                        <!-- 2019/10/04 QC#53981 DEL START -->
                        <!-- 2019/02/25 QC#29736  ADD START -->
                        <!-- , COUNT(1) OVER ( 
                                        PARTITION BY
                                          SRC_REF_OR_CPO_ORD_NUM
                                          , SHPG_PLN_NUM
                                          , CONFIG_CATG_CD
                                          , DS_ORD_POSN_NUM
                                          , DS_CPO_LINE_NUM
                                          , DS_CPO_LINE_SUB_NUM
                                      ) AS COUNT_FOR_SER_NUM -->
                        <!-- 2019/02/25 QC#29736  ADD END -->
                        <!-- 2019/10/04 QC#53981 DEL END -->
                    FROM
                        PEND_IMPT_V
                    WHERE
                        GLBL_CMPY_CD        = #glblCmpyCd#
                        AND EZCANCELFLAG    = '0'
                    ) DOO2
                    </isEqual>
                    <isEqual property="teamSearchFlg" compareValue="Y">
                      ,TMZN
                    </isEqual>
                WHERE
                    DOO2.GLBL_CMPY_CD = #glblCmpyCd#
                    <isEqual property="realTimeInqFlg" compareValue="N">
                    AND DOO2.EZCANCELFLAG = '0'
                    AND DOO2.ORD_HDR_DPLY_STS_NM = #stsPendImpt#
                    </isEqual>
                    <!--2019/02/13 QC#30238 Add Start  -->
                    <isNotNull property="ORDER_NUMBER">
                        AND DOO2.SRC_REF_OR_CPO_ORD_NUM LIKE #ORDER_NUMBER#
                    </isNotNull>
                    <!--2019/02/13 QC#30238 Add End  -->
                    <isNotNull property="searchCondition_PendingImportOrder">
                        $searchCondition_PendingImportOrder$
                    </isNotNull>
                    <isEqual property="teamSearchFlg" compareValue="Y">
                    AND DOO2.CRAT_BY_USR_ID =
                        CASE
                        WHEN
                            TMZN.CRAT_BY_USR_ID IS NULL
                        THEN
                            DOO2.CRAT_BY_USR_ID
                        ELSE
                            TMZN.CRAT_BY_USR_ID
                        END
                    AND (DOO2.SOLD_TO_CUST_ACCT_CD =
                        CASE
                        WHEN
                            TMZN.CUST_ACCT_CD IS NULL
                        THEN
                            DOO2.SOLD_TO_CUST_ACCT_CD
                        ELSE
                            TMZN.CUST_ACCT_CD
                        END
                        OR DOO2.SHIP_TO_CUST_ACCT_CD =
                        CASE
                        WHEN
                            TMZN.CUST_ACCT_CD IS NULL
                        THEN
                            DOO2.SHIP_TO_CUST_ACCT_CD
                        ELSE
                            TMZN.CUST_ACCT_CD
                        END
                        OR DOO2.BILL_TO_CUST_ACCT_CD =
                        CASE
                        WHEN
                            TMZN.CUST_ACCT_CD IS NULL
                        THEN
                            DOO2.BILL_TO_CUST_ACCT_CD
                        ELSE
                            TMZN.CUST_ACCT_CD
                        END)
                    AND DOO2.LINE_BIZ_TP_CD =
                        CASE
                        WHEN
                            TMZN.LINE_BIZ_TP_CD IS NULL
                        THEN
                            DOO2.LINE_BIZ_TP_CD
                        ELSE
                            TMZN.LINE_BIZ_TP_CD
                        END
                    AND DOO2.COA_BR_CD =
                        CASE
                        WHEN
                            TMZN.COA_BR_CD IS NULL
                        THEN
                            DOO2.COA_BR_CD
                        ELSE
                            TMZN.COA_BR_CD
                        END
                    </isEqual>
                </isEqual>
                )
            -- ++++++++++++++++++++++++++++
            -- Group By for Search Screen
            -- ++++++++++++++++++++++++++++
            GROUP BY ROLLUP(
                ($cMsg.dplyBy01ItemNm$
                <isNotNull property="pairDplyByItemNm_01">
                    ,$pairDplyByItemNm_01$
                </isNotNull>
                )
                <isNotNull property="cMsg.dplyBy02ItemNm">
                    ,($cMsg.dplyBy02ItemNm$
                    <isNotNull property="pairDplyByItemNm_02">
                        ,$pairDplyByItemNm_02$
                    </isNotNull>
                    )
                </isNotNull>
                <isNotNull property="cMsg.dplyBy03ItemNm">
                    ,($cMsg.dplyBy03ItemNm$
                    <isNotNull property="pairDplyByItemNm_03">
                        ,$pairDplyByItemNm_03$
                    </isNotNull>
                    )
                </isNotNull>
                    ,(
                      GLBL_CMPY_CD
                      ,SRC_REF_OR_CPO_ORD_NUM
                <isEqual property="cMsg.grpByDnldCd" compareValue="1">
                      ,CUST_ISS_PO_NUM
                      ,LEASE_CMPY_PO_NUM
                      ,SOLD_TO_CUST_ACCT_NM
                      ,SOLD_TO_CUST_ACCT_CD
                      ,SOLD_TO_CUST_LOC_CD
                      ,COA_BR_CD
                      ,COA_BR_DESC_TXT
                      ,COA_EXTN_CD
                      ,COA_EXTN_DESC_TXT
                      ,SLS_REP_TOC_CD
                      ,SLS_REP_TOC_NM
                      ,CPO_SRC_TP_CD
                      ,CPO_SRC_TP_DESC_TXT
                      ,DS_ORD_CATG_CD
                      ,DS_ORD_CATG_DESC_TXT
                      ,DS_ORD_TP_CD
                      ,DS_ORD_TP_DESC_TXT
                      ,DS_ORD_RSN_CD
                      ,DS_ORD_RSN_DESC_TXT
                      ,CSMP_CONTR_NUM
                      ,ORD_SRC_REF_NUM
                      ,CPO_ORD_TS
                      ,ORD_BOOK_TS
                      ,ORD_HDR_DPLY_STS_NM
                      ,SLS_REP_PSN_NUM
                      ,AQU_NUM
                </isEqual>
                <isEqual property="cMsg.grpByDnldCd" compareValue="2">
                      ,SVC_CONFIG_MSTR_PK
                      ,CUST_ISS_PO_NUM
                      ,LEASE_CMPY_PO_NUM
                      ,SOLD_TO_CUST_ACCT_NM
                      ,SOLD_TO_CUST_ACCT_CD
                      ,SOLD_TO_CUST_LOC_CD
                      ,SHIP_TO_CUST_ACCT_NM
                      ,SHIP_TO_CUST_ACCT_CD
                      ,SHIP_TO_CUST_LOC_CD
                      ,BILL_TO_CUST_ACCT_NM
                      ,BILL_TO_CUST_ACCT_CD
                      ,BILL_TO_CUST_LOC_CD
                      ,COA_BR_CD
                      ,COA_BR_DESC_TXT
                      ,COA_EXTN_CD
                      ,COA_EXTN_DESC_TXT
                      ,SLS_REP_TOC_CD
                      ,SLS_REP_TOC_NM
                      ,CPO_SRC_TP_CD
                      ,CPO_SRC_TP_DESC_TXT
                      ,DS_ORD_CATG_CD
                      ,DS_ORD_CATG_DESC_TXT
                      ,DS_ORD_TP_CD
                      ,DS_ORD_TP_DESC_TXT
                      ,DS_ORD_RSN_CD
                      ,DS_ORD_RSN_DESC_TXT
                      ,CSMP_CONTR_NUM
                      ,PRC_CONTR_NUM
                      ,PRC_CONTR_NM
                      ,ORD_SRC_REF_NUM
                      ,MDL_ID
                      ,T_MDL_NM
                      ,CPO_ORD_TS
                      ,ORD_BOOK_TS
                      ,ORD_HDR_DPLY_STS_NM
                      ,SLS_REP_PSN_NUM
                      ,AQU_NUM
                </isEqual>
                <isEqual property="cMsg.grpByDnldCd" compareValue="3">
                      ,CPO_DTL_LINE_NUM
                      ,CPO_DTL_LINE_SUB_NUM
                      ,DS_ORD_POSN_NUM
                      ,DS_CPO_LINE_NUM
                      ,DS_CPO_LINE_SUB_NUM
                      ,DS_CPO_RTRN_LINE_NUM
                      ,DS_CPO_RTRN_LINE_SUB_NUM
                      ,DS_CPO_CONFIG_PK
                      ,SHPG_PLN_NUM
                      ,PRCH_REQ_NUM
                      ,PO_ORD_NUM
                      ,SO_NUM
                      ,SO_SLP_NUM
                      ,INV_NUM
                      ,INV_BOL_LINE_NUM
                      ,INV_LINE_NUM
                      ,INV_LINE_SUB_NUM
                      ,INV_LINE_SUB_TRX_NUM
                      ,DS_INV_SLS_CR_PK
                      ,ADD_ORIG_CPO_ORD_NUM
                      ,CUST_ISS_PO_NUM
                      ,LEASE_CMPY_PO_NUM
                      ,SOLD_TO_CUST_ACCT_NM
                      ,SOLD_TO_CUST_ACCT_CD
                      ,SOLD_TO_CUST_LOC_CD
                      ,SHIP_TO_CUST_ACCT_NM
                      ,SHIP_TO_CUST_ACCT_CD
                      ,SHIP_TO_CUST_LOC_CD
                      ,BILL_TO_CUST_ACCT_NM
                      ,BILL_TO_CUST_ACCT_CD
                      ,BILL_TO_CUST_LOC_CD
                      ,COA_BR_CD
                      ,COA_BR_DESC_TXT
                      ,COA_EXTN_CD
                      ,COA_EXTN_DESC_TXT
                      ,SLS_REP_TOC_CD
                      ,SLS_REP_TOC_NM
                      ,CPO_SRC_TP_CD
                      ,CPO_SRC_TP_DESC_TXT
                      ,DS_ORD_CATG_CD
                      ,DS_ORD_CATG_DESC_TXT
                      ,DS_ORD_TP_CD
                      ,DS_ORD_TP_DESC_TXT
                      ,DS_ORD_RSN_CD
                      ,DS_ORD_RSN_DESC_TXT
                      ,CSMP_CONTR_NUM
                      ,PRC_CONTR_NUM
                      ,PRC_CONTR_NM
                      ,ORD_SRC_REF_NUM
                      ,IMPT_STS_CD
                      ,ZEROTH_PROD_CTRL_CD
                      ,ZEROTH_PROD_CTRL_NM
                      ,FIRST_PROD_CTRL_CD
                      ,FIRST_PROD_CTRL_NM
                      ,SCD_PROD_CTRL_CD
                      ,SCD_PROD_CTRL_NM
                      ,THIRD_PROD_CTRL_CD
                      ,THIRD_PROD_CTRL_NM
                      ,FRTH_PROD_CTRL_CD
                      ,FRTH_PROD_CTRL_NM
                      ,FIFTH_PROD_CTRL_CD
                      ,FIFTH_PROD_CTRL_NM
                      ,MDSE_CD
                      ,MDSE_DESC_SHORT_TXT
                      ,COA_PROD_CD
                      ,COA_PROD_DESC_TXT
                      ,COA_MDSE_TP_CD
                      ,COA_MDSE_TP_DESC_TXT
                      ,REV_COA_ACCT_CD
                      ,REV_TRIAL_BAL_TP_CD
                      ,MDL_ID
                      ,T_MDL_NM
                      ,SER_NUM
                      ,RTRN_RSN_CD
                      ,RTRN_RSN_DESC_TXT
                      ,ACTL_SHIP_DT
                      ,INV_DT
                      ,ORD_LINE_SRC_CD
                      ,ORD_LINE_SRC_NM
                      ,RTL_WH_CD
                      ,RTL_WH_NM
                      <!-- 2018/12/13 QC#29024 Add Start -->
                      ,RTL_WH_DESC_TXT
                      <!-- 2018/12/13 QC#29024 Add End -->
                      ,RTL_SWH_CD
                      ,RTL_SWH_NM
                      ,INVTY_LOC_CD
                      ,VND_NM
                      ,DPLY_VND_NM
                      ,DROP_SHIP_FLG
                      ,DS_CONTR_NUM
                      ,SVC_CONFIG_MSTR_PK
                      ,CRAT_BY_USR_ID
                      ,CPO_ORD_TS
                      ,ORD_BOOK_TS
                      ,ORD_HDR_STS_CD
                      ,ORD_LINE_STS_CD
                      ,RTRN_LINE_STS_CD
                      ,ORD_HDR_DPLY_STS_NM
                      ,ORD_LINE_DPLY_STS_NM
                      ,ORD_RTRN_LINE_DPLY_STS_NM
                      ,CONFIG_CATG_CD
                      ,SLS_REP_OR_SLS_TEAM_TOC_CD
                      ,SLS_REP_OR_SLS_TEAM_TOC_NM
                      ,ISTL_DT
                      ,RDD_DT
                      ,PSD_DT
                      ,PDD_DT
                      ,PRC_CATG_CD
                      ,PRC_CATG_DESC_TXT
                      ,TRX_CD
                      ,TRX_RSN_CD
                      ,DFRD_REV_FLG
                      ,LINE_BIZ_TP_CD
                      ,LINE_BIZ_TP_DESC_TXT
                      ,DS_ORD_LINE_CATG_CD
                      ,DS_ORD_LINE_CATG_DESC_TXT
                      ,SVC_MACH_MSTR_PK
                      ,ORD_AGING_BCKT_DESC_TXT
                      ,ORD_SRC_IMPT_DT
                      ,SLS_REP_PSN_NUM
                      ,AQU_NUM
                      <isEqual property="teamSearchFlg" compareValue="Y">
                      ,ORD_ZN_DESC_TXT
                      ,ORD_TEAM_MSTR_NM
                      </isEqual>
                </isEqual>
                    )
                )
                <isEqual property="cMsg.xxRsltModeCd" compareValue="2">
                HAVING GROUPING_ID (GLBL_CMPY_CD,$cMsg.dplyBy01ItemNm$
                <isNotNull property="cMsg.dplyBy02ItemNm">
                    ,$cMsg.dplyBy02ItemNm$
                </isNotNull>
                <isNotNull property="cMsg.dplyBy03ItemNm">
                    ,$cMsg.dplyBy03ItemNm$
                </isNotNull>
                ) > 0
                </isEqual>
            -- ++++++++++++++++++++++++++++
            -- Order BY for Search Screen
            -- ++++++++++++++++++++++++++++
            ORDER BY
            <!--2024/03/01 QC#63608 Add Start  -->
                <isEqual property="cMsg.xxChkBox_A" compareValue="Y">
                    $cMsg.dplyBy01ItemNm$ DESC             NULLS FIRST
                </isEqual>
                <isNotEqual property="cMsg.xxChkBox_A" compareValue="Y">
                    $cMsg.dplyBy01ItemNm$ ASC              NULLS FIRST
                </isNotEqual>
                    ,GROUPING($cMsg.dplyBy01ItemNm$)        DESC
                <isNotNull property="cMsg.dplyBy02ItemNm">
                    <isEqual property="cMsg.xxChkBox_B" compareValue="Y">
                       ,$cMsg.dplyBy02ItemNm$  DESC             NULLS FIRST
                    </isEqual>
                    <isNotEqual property="cMsg.xxChkBox_B" compareValue="Y">
                       ,$cMsg.dplyBy02ItemNm$  ASC              NULLS FIRST
                    </isNotEqual>
                       ,GROUPING($cMsg.dplyBy02ItemNm$)        DESC
                </isNotNull>
                <isNotNull property="cMsg.dplyBy03ItemNm">
                    <isEqual property="cMsg.xxChkBox_C" compareValue="Y">
                       ,$cMsg.dplyBy03ItemNm$  DESC             NULLS FIRST
                    </isEqual>
                    <isNotEqual property="cMsg.xxChkBox_C" compareValue="Y">
                       ,$cMsg.dplyBy03ItemNm$   ASC              NULLS FIRST
                    </isNotEqual>
                       ,GROUPING($cMsg.dplyBy03ItemNm$)        DESC
                </isNotNull>
            <!--2024/03/01 QC#63608 Add End  -->
                <!-- Display Mode Header -->
                    ,GLBL_CMPY_CD           NULLS FIRST
                    ,SRC_REF_OR_CPO_ORD_NUM
                <isEqual property="cMsg.grpByDnldCd" compareValue="3">
                    ,CONFIG_CATG_CD         DESC
                </isEqual>
                <!-- Display Mode Config -->
                <isEqual property="cMsg.grpByDnldCd" compareValue="2">
                    ,SVC_CONFIG_MSTR_PK
                </isEqual>
                <!-- Display Mode Line -->
                <isEqual property="cMsg.grpByDnldCd" compareValue="3">
                    ,TO_NUMBER(DS_ORD_POSN_NUM)
                    ,DS_CPO_LINE_NUM
                    ,DS_CPO_LINE_SUB_NUM    NULLS FIRST
                </isEqual>
            FETCH FIRST #rowNum# ROWS ONLY
            )
    </statement>

    <statement id="findOrderTeamZoneByUserId" parameterClass="Map" resultClass="Map">
        SELECT
            OZ.ORD_ZN_DESC_TXT
            ,OTMH.ORD_TEAM_MSTR_NM 
        FROM
            ORD_TEAM_MSTR_HDR OTMH
            ,ORD_TEAM_MSTR_DTL OTMD
            ,ORD_TEAM_ATTRB_TP OTAT
            ,ORD_ZN OZ
        WHERE
            OTMH.GLBL_CMPY_CD = #glblCmpyCd#
            AND OTMH.EZCANCELFLAG           = '0'
            AND OTMH.EFF_FROM_DT        &lt;= #slsDt#
            AND (OTMH.EFF_THRU_DT IS NULL
            OR OTMH.EFF_THRU_DT &gt;= #slsDt#)
            AND OTMH.GLBL_CMPY_CD           = OZ.GLBL_CMPY_CD
            AND OTMH.ORD_ZN_CD              = OZ.ORD_ZN_CD
            AND OZ.EZCANCELFLAG             = '0'
            AND OTMH.GLBL_CMPY_CD           = OTMD.GLBL_CMPY_CD
            AND OTMH.ORD_TEAM_MSTR_HDR_PK   = OTMD.ORD_TEAM_MSTR_HDR_PK
            AND OTMD.ORD_TEAM_ATTRB_VAL_TXT = #userId#
            AND OTMD.EZCANCELFLAG           = '0'
            AND OTMD.GLBL_CMPY_CD           = OTAT.GLBL_CMPY_CD
            AND OTMD.ORD_TEAM_ATTRB_TP_CD   = OTAT.ORD_TEAM_ATTRB_TP_CD
            AND OTAT.ORD_TEAM_ATTRB_TP_CD   = #attrbTpCdUser#
            AND OTAT.EZCANCELFLAG = '0'
    </statement>

    <statement id="getSavedSearchOptionList" parameterClass="Map" resultClass="Map">
        SELECT
                  SSO.SRCH_OPT_PK
                , SSO.SRCH_OPT_NM
            FROM
                SAVE_SRCH_OPT SSO 
            WHERE
                SSO.GLBL_CMPY_CD        = #glblCmpyCd#
                AND SSO.SRCH_OPT_APL_ID = #srchOptAplId#
                AND SSO.SRCH_OPT_USR_ID = #srchOptUsrId#
                AND SSO.EZCANCELFLAG    = '0'
            ORDER BY
                  SSO.SRCH_OPT_NM
    </statement>

    <statement id="getDdContrPk" parameterClass="Map" resultClass="Map">
        SELECT
                  DC.DS_CONTR_PK
            FROM
                DS_CONTR DC 
            WHERE
                DC.GLBL_CMPY_CD        = #glblCmpyCd#
                AND DC.DS_CONTR_NUM = #dsContrNum#
                AND DC.EZCANCELFLAG    = '0'
    </statement>

    <statement id ="getProductLevelName" parameterClass="Map"  resultClass="Map">
        SELECT
            MSET.MDSE_STRU_ELMNT_TP_CD
           ,MSET.MDSE_STRU_ELMNT_TP_DESC_TXT MDSE_STRU_ELMNT_TP_NM
        FROM
            MDSE_STRU_ELMNT_TP MSET
        WHERE 
            MSET.EZCANCELFLAG = '0'
        AND MSET.GLBL_CMPY_CD = #glblCmpyCd#
    </statement>

</sqlMap>
