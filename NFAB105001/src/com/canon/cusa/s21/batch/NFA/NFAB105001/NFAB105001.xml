<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NFAB105001">

<typeAlias alias="COA_GL_CMBNTMsg"	type="business.db.COA_GL_CMBNTMsg"/>

<statement id="getNewCmbn" parameterClass="Map" resultMap="result.coaCmbn">

    SELECT #glblCmpyCd#     AS GLBL_CMPY_CD
          ,IF.COA_GL_CMBN_PK
          ,IF.COA_CMPY_CD
          ,IF.COA_BR_CD
          ,IF.COA_CC_CD
          ,IF.COA_ACCT_CD
          ,IF.COA_PROD_CD
          ,IF.COA_CH_CD
          ,IF.COA_AFFL_CD
          ,IF.COA_CH_CD
          ,IF.COA_PROJ_CD
          ,IF.COA_EXTN_CD
          ,DECODE(IF.COA_GL_CMBN_ENBL_FLG, #flgY#, '0', '9') COA_GL_CMBN_STS_CD
          ,IF.COA_ID
          ,IF.COA_GL_CMBN_TP_CD
          ,IF.COA_GL_CMBN_ENBL_FLG
          ,IF.COA_GL_CMBN_PSTG_ALLW_FLG
          ,IF.COA_GL_CMBN_BDG_ALLW_FLG
          <!-- start add 2016/07/01 -->
          ,IF.COA_START_ACTV_DT
          ,IF.COA_END_ACTV_DT
          <!-- end 2016/07/01 -->
     FROM NFAI0100_01    IF
         ,COA_GL_CMBN    CGC
    WHERE IF.TRANSACTION_ID         = #transactionId#
      AND IF.COA_GL_CMBN_STS_CD     = #insert#
      AND #glblCmpyCd#              = CGC.GLBL_CMPY_CD(+)
      AND IF.COA_ID                 = CGC.COA_ID(+)
      AND CGC.COA_ID                IS NULL
      
</statement>

<statement id="getReactivateCmbn" parameterClass="Map" resultMap="result.coaCmbn">

    SELECT #glblCmpyCd#     AS GLBL_CMPY_CD
          ,IF.COA_GL_CMBN_PK
          ,IF.COA_CMPY_CD
          ,IF.COA_BR_CD
          ,IF.COA_CC_CD
          ,IF.COA_ACCT_CD
          ,IF.COA_PROD_CD
          ,IF.COA_CH_CD
          ,IF.COA_AFFL_CD
          ,IF.COA_CH_CD
          ,IF.COA_PROJ_CD
          ,IF.COA_EXTN_CD
          ,DECODE(IF.COA_GL_CMBN_ENBL_FLG, #flgY#, '0', '9') COA_GL_CMBN_STS_CD
          ,IF.COA_ID
          ,IF.COA_GL_CMBN_TP_CD
          ,IF.COA_GL_CMBN_ENBL_FLG
          ,IF.COA_GL_CMBN_PSTG_ALLW_FLG
          ,IF.COA_GL_CMBN_BDG_ALLW_FLG
          <!-- start add 2016/07/01 -->
          ,IF.COA_START_ACTV_DT
          ,IF.COA_END_ACTV_DT
          <!-- end 2016/07/01 -->
     FROM NFAI0100_01    IF
         ,COA_GL_CMBN    CGC
    WHERE IF.TRANSACTION_ID         = #transactionId#
      AND IF.COA_GL_CMBN_STS_CD     = #insert#
      AND #glblCmpyCd#              = CGC.GLBL_CMPY_CD
      AND '1'                       = CGC.EZCANCELFLAG
      AND IF.COA_ID                 = CGC.COA_ID
      
</statement>

<statement id="getUpdatedCmbn" parameterClass="Map" resultMap="result.coaCmbn">

    SELECT #glblCmpyCd#     AS GLBL_CMPY_CD
          ,IF.COA_GL_CMBN_PK
          ,IF.COA_CMPY_CD
          ,IF.COA_BR_CD
          ,IF.COA_CC_CD
          ,IF.COA_ACCT_CD
          ,IF.COA_PROD_CD
          ,IF.COA_CH_CD
          ,IF.COA_AFFL_CD
          ,IF.COA_CH_CD
          ,IF.COA_PROJ_CD
          ,IF.COA_EXTN_CD
          ,DECODE(IF.COA_GL_CMBN_ENBL_FLG, #flgY#, '0', '9') COA_GL_CMBN_STS_CD
          ,IF.COA_ID
          ,IF.COA_GL_CMBN_TP_CD
          ,IF.COA_GL_CMBN_ENBL_FLG
          ,IF.COA_GL_CMBN_PSTG_ALLW_FLG
          ,IF.COA_GL_CMBN_BDG_ALLW_FLG
          <!-- start add 2016/07/01 -->
          ,IF.COA_START_ACTV_DT
          ,IF.COA_END_ACTV_DT
          <!-- end 2016/07/01 -->
     FROM NFAI0100_01    IF
    WHERE IF.TRANSACTION_ID         = #transactionId#
      AND IF.COA_GL_CMBN_STS_CD     = #upd#
      
</statement>

<statement id="getDelCmbn" parameterClass="Map" resultMap="result.coaCmbn">

    SELECT #glblCmpyCd#     AS GLBL_CMPY_CD
          ,IF.COA_GL_CMBN_PK
          ,IF.COA_CMPY_CD
          ,IF.COA_BR_CD
          ,IF.COA_CC_CD
          ,IF.COA_ACCT_CD
          ,IF.COA_PROD_CD
          ,IF.COA_CH_CD
          ,IF.COA_AFFL_CD
          ,IF.COA_CH_CD
          ,IF.COA_PROJ_CD
          ,IF.COA_EXTN_CD
          ,DECODE(IF.COA_GL_CMBN_ENBL_FLG, #flgY#, '0', '9') COA_GL_CMBN_STS_CD
          ,IF.COA_ID
          ,IF.COA_GL_CMBN_TP_CD
          ,IF.COA_GL_CMBN_ENBL_FLG
          ,IF.COA_GL_CMBN_PSTG_ALLW_FLG
          ,IF.COA_GL_CMBN_BDG_ALLW_FLG
          <!-- start add 2016/10/07 -->
          ,IF.COA_START_ACTV_DT
          ,IF.COA_END_ACTV_DT
          <!-- end 2016/10/07 -->
     FROM NFAI0100_01    IF
    WHERE IF.TRANSACTION_ID         = #transactionId#
      AND IF.COA_GL_CMBN_STS_CD     = #del#
      
</statement>

<resultMap id="result.coaCmbn" class="COA_GL_CMBNTMsg">
        <result property="glblCmpyCd"                        column="GLBL_CMPY_CD"                              javaType="EZDTStringItem"/>
        <result property="coaGlCmbnPk"                       column="COA_GL_CMBN_PK"                            javaType="EZDTBigDecimalItem"/>
        <result property="coaCmpyCd"                         column="COA_CMPY_CD"                               javaType="EZDTStringItem"/>
        <result property="coaBrCd"                           column="COA_BR_CD"                                 javaType="EZDTStringItem"/>
        <result property="coaCcCd"                           column="COA_CC_CD"                                 javaType="EZDTStringItem"/>
        <result property="coaAcctCd"                         column="COA_ACCT_CD"                               javaType="EZDTStringItem"/>
        <result property="coaProdCd"                         column="COA_PROD_CD"                               javaType="EZDTStringItem"/>
        <result property="coaChCd"                           column="COA_CH_CD"                                 javaType="EZDTStringItem"/>
        <result property="coaAfflCd"                         column="COA_AFFL_CD"                               javaType="EZDTStringItem"/>
        <result property="coaProjCd"                         column="COA_PROJ_CD"                               javaType="EZDTStringItem"/>
        <result property="coaExtnCd"                         column="COA_EXTN_CD"                               javaType="EZDTStringItem"/>
        <result property="coaGlCmbnStsCd"                    column="COA_GL_CMBN_STS_CD"                        javaType="EZDTStringItem"/>
        <result property="coaId"                             column="COA_ID"                                    javaType="EZDTBigDecimalItem"/>
        <result property="coaGlCmbnTpCd"                     column="COA_GL_CMBN_TP_CD"                         javaType="EZDTStringItem"/>
        <result property="coaGlCmbnEnblFlg"                  column="COA_GL_CMBN_ENBL_FLG"                      javaType="EZDTStringItem"/>
        <result property="coaGlCmbnPstgAllwFlg"              column="COA_GL_CMBN_PSTG_ALLW_FLG"                 javaType="EZDTStringItem"/>
        <result property="coaGlCmbnBdgAllwFlg"               column="COA_GL_CMBN_BDG_ALLW_FLG"                  javaType="EZDTStringItem"/>
        <result property="coaStartActvDt"                    column="COA_START_ACTV_DT"                         javaType="EZDTStringItem"/>
        <result property="coaEndActvDt"                      column="COA_END_ACTV_DT"                           javaType="EZDTStringItem"/>
    </resultMap>

    <statement id="getCoaGlCmbnFor4Seg" parameterClass="Map" resultClass="Map">
        SELECT
             CGC.COA_BR_CD || CGC.COA_CC_CD || CGC.COA_PROD_CD || CGC.COA_CH_CD AS COA_GL_CMBN_4_SEG_CD
            ,CGC.COA_BR_CD
            ,CGC.COA_CC_CD
            ,CGC.COA_PROD_CD
            ,CGC.COA_CH_CD
        FROM
            COA_GL_CMBN CGC
        WHERE
            CGC.GLBL_CMPY_CD         = #glblCmpyCd#
        AND CGC.COA_GL_CMBN_ENBL_FLG = #flgY#
        AND CGC.EZCANCELFLAG         = '0'
        GROUP BY
             CGC.COA_BR_CD
            ,CGC.COA_CC_CD
            ,CGC.COA_PROD_CD
            ,CGC.COA_CH_CD
        ORDER BY
             CGC.COA_BR_CD
            ,CGC.COA_CC_CD
            ,CGC.COA_PROD_CD
            ,CGC.COA_CH_CD
    </statement>

</sqlMap>