<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAB255001">

    <statement id="getAttRqst" parameterClass="Map" resultClass="Map">  
        SELECT
            DAR.DOC_MGT_ATT_RQST_PK
            ,DAR.DOC_MGT_DOC_ID
            ,DAR.DOC_MGT_CATG_NUM
            ,DMC.DOC_MGT_CATG_CD
            ,DMC.ATT_DOC_TP_CD
            ,DAR.DOC_MGT_BIZ_DOC_NUM
            ,DAR.DOC_MGT_PRNT_DOC_NUM
            ,DAR.DOC_MGT_ATT_RTRY_RQST_FLG
        FROM
            DOC_MGT_ATT_RQST DAR
            ,DOC_MGT_CATG    DMC
        WHERE
            DAR.GLBL_CMPY_CD              = #glblCmpyCd#
        AND DAR.DOC_MGT_RQST_STS_CD       = #rqstStsCd#
        AND DAR.DOC_MGT_ATT_RQST_PROC_FLG = 'N'
        AND DAR.EZCANCELFLAG              = '0'

        AND DAR.GLBL_CMPY_CD              = DMC.GLBL_CMPY_CD(+)
        AND DAR.DOC_MGT_CATG_NUM          = DMC.DOC_MGT_CATG_NUM(+)
        AND DMC.EZCANCELFLAG(+)              = '0'
    </statement>

    <statement id="getCpoOrdNumByCfsLeasePkgNum" parameterClass="Map" resultClass="Map">
        SELECT
               D.CPO_ORD_NUM
        FROM
               CFS_LEASE_PKG_PO_HDR H
              ,CFS_LEASE_PKG_PO_DTL D
        WHERE
               H.GLBL_CMPY_CD            = #glblCmpyCd#
        <!-- 2019/04/04 QC#30756 Mod Start -->
        <!-- AND    H.CFS_APP_NUM             = #cfsAppNum# -->
        <!-- AND    H.CFS_PO_NUM              = #cfsPoNum# -->
        AND    UPPER(H.CFS_APP_NUM)      = UPPER(#cfsAppNum#)
        AND    UPPER(H.CFS_PO_NUM)       = UPPER(#cfsPoNum#)
        <!-- 2019/04/04 QC#30756 Mod End -->
        AND    H.EZCANCELFLAG            = '0'
        AND    H.GLBL_CMPY_CD            = D.GLBL_CMPY_CD
        AND    H.CFS_LEASE_PKG_PO_HDR_PK = D.CFS_LEASE_PKG_PO_HDR_PK
        AND    H.EZCANCELFLAG            = '0'
        GROUP BY D.CPO_ORD_NUM
        ORDER BY D.CPO_ORD_NUM
    </statement>

    <statement id="getBizDoc" parameterClass="Map" resultClass="Map">
        SELECT
               A.LINE_BIZ_TP_CD                      AS LINE_BIZ_TP_CD
              ,A.COA_BR_CD                           AS COA_BR_CD
              ,A.AQU_NUM                             AS AQU_NUM
              ,A.CPO_ORD_NUM                         AS CPO_ORD_NUM
              ,A.LEASE_CMPY_PO_NUM                   AS LEASE_CMPY_PO_NUM
              ,(SELECT B.FULL_PSN_NM
                FROM   S21_PSN_V B
                WHERE  B.GLBL_CMPY_CD = A.GLBL_CMPY_CD
                AND    B.PSN_CD = A.SLS_REP_PSN_NUM
                AND    B.EZCANCELFLAG = '0')         AS SLS_REP_PSN_NM
              ,A.CPO_ORD_TS                          AS CPO_ORD_TS
              ,A.ORD_BOOK_TS                         AS ORD_BOOK_TS
              ,(SELECT B.ORD_HDR_STS_NM
                FROM DS_ORD_STS_V B
                WHERE B.GLBL_CMPY_CD = A.GLBL_CMPY_CD
                AND   B.CPO_ORD_NUM  = A.CPO_ORD_NUM
                AND   B.EZCANCELFLAG = '0'
                AND   ROWNUM         = 1)            AS ORD_HDR_STS_NM
              ,A.ORD_TOT_DEAL_NET_AMT                AS ORD_TOT_DEAL_NET_AMT
              ,NULL                                  AS POD_NUM
              ,A.CPO_ORD_NUM                         AS RMA_NUM
              ,A.BILL_TO_CUST_ACCT_NM                AS BILL_TO_CUST_ACCT_NM
              ,A.SHIP_TO_CUST_ACCT_NM                AS SHIP_TO_CUST_ACCT_NM
              ,A.SOLD_TO_CUST_ACCT_NM                AS SOLD_TO_CUST_ACCT_NM
              ,A.BILL_TO_CUST_ACCT_CD                AS BILL_TO_CUST_ACCT_CD
              ,A.SELL_TO_CUST_CD                     AS SELL_TO_CUST_CD
              ,A.SHIP_TO_CUST_ACCT_CD                AS SHIP_TO_CUST_ACCT_CD
        FROM
               CPO_V A
        WHERE
               A.GLBL_CMPY_CD = #glblCmpyCd#
        AND    A.CPO_ORD_NUM  IN 
            <iterate property="cpoOrdNumList" var="cpoOrdNumList[]" open="(" close=")" conjunction=",">
               #cpoOrdNumList[]#
            </iterate>
        AND    A.EZCANCELFLAG = '0'
    </statement>

    <statement id="getIdxAttrbInfo" parameterClass="Map" resultClass="Map">
        SELECT
               DMI.IDX_ATTRB_TRGT_COL_NM
              ,DMI.DOC_MGT_FLD_CD
              ,DMF.DOC_MGT_FLD_NUM
              ,DMF.DOC_MGT_FLD_TP_CD
              ,DMC.DOC_MGT_CATG_CD
              ,DMC.DOC_MGT_CATG_NUM
        FROM
               DOC_MGT_IDX_ATTRB_DFN DMI
              ,DOC_MGT_FLD           DMF
              ,DOC_MGT_CATG          DMC
        WHERE
               DMI.GLBL_CMPY_CD     = #glblCmpyCd#
        AND    DMI.ACTV_FLG         = 'Y'
        AND    DMI.EZCANCELFLAG     = '0'
        AND    DMF.GLBL_CMPY_CD     = DMI.GLBL_CMPY_CD
        AND    DMF.DOC_MGT_FLD_CD   = DMI.DOC_MGT_FLD_CD
        AND    DMF.EZCANCELFLAG     = '0'
        AND    DMC.GLBL_CMPY_CD     = DMI.GLBL_CMPY_CD
        AND    DMC.DOC_MGT_CATG_NUM = #docMgtCatgNum#
        AND    DMC.DOC_MGT_CATG_CD  = DMI.DOC_MGT_CATG_CD
        AND    DMC.EZCANCELFLAG     = '0'
        ORDER BY DMF.DOC_MGT_FLD_NUM
    </statement>
</sqlMap>