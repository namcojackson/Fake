<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL1660Query">

    <statement id="getInPondWt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                  IN_POUND_WT
        FROM (
            SELECT
                      P.IN_POUND_WT 
                FROM
                      ALL_MDSE_V M
                    , MDSE_STORE_PKG P 
                WHERE
                    M.GLBL_CMPY_CD     = #glblCmpyCd#
                    AND M.MDSE_CD      = #mdseCd#
                    AND M.EZCANCELFLAG = '0' 
                    AND M.GLBL_CMPY_CD = P.GLBL_CMPY_CD 
                    AND M.MDSE_CD      = P.MDSE_CD 
                    AND P.EZCANCELFLAG = '0'
            UNION ALL
            SELECT
                      P.IN_POUND_WT 
                FROM
                      ALL_MDSE_V M
                    , ORD_TAKE_MDSE O
                    , MDSE_STORE_PKG P 
                WHERE
                    M.GLBL_CMPY_CD     = #glblCmpyCd#
                    AND M.MDSE_CD      = #mdseCd#
                    AND M.EZCANCELFLAG = '0' 
                    AND M.GLBL_CMPY_CD = O.GLBL_CMPY_CD 
                    AND M.MDSE_CD      = O.ORD_TAKE_MDSE_CD 
                    AND O.EZCANCELFLAG = '0'
                    AND O.GLBL_CMPY_CD = P.GLBL_CMPY_CD 
                    AND O.MDSE_CD      = P.MDSE_CD 
                    AND P.EZCANCELFLAG = '0'
        )
        WHERE ROWNUM = 1
    </statement>

    <statement id="getPrcRuleInfo" parameterClass="Map" resultClass="Map">
    <!--  Price Rule -->
        SELECT
                  SCP.SPEC_COND_PRC_PK
                , SCP.PRC_MAX_AMT_RATE
                , SCP.PRC_MIN_AMT_RATE
                , PRD.PRC_RULE_DTL_PK
                , PRD.PRC_RULE_DTL_CHRG_NM
                , PRD.PRC_RULE_MOD_TP_CD
                , PRD.PRC_RULE_ADJ_TP_CD
                , PRD.PRC_RULE_ADJ_LVL_CD
                , PRD.PRC_FMLA_PK
                , PRD.PRC_RULE_DTL_RATE
                , PRD.PRC_RULE_DTL_TXT
                , PRH.PRC_RULE_HDR_PK
                , PRH.PRC_RULE_NM
                , PRH.PRC_RULE_DESC_TXT
                , PRH.PRC_RULE_CATG_CD
                , PRH.APPLY_AUTO_FLG
                , PRH.OVRD_FLG
                , PRH.ACTV_FLG
                , PRH.DEF_RULE_PRCD_NUM
                , PRH.PRC_RULE_COND_TP_CD
                , PRH.PRC_RULE_TRX_CATG_CD
                , PRH.DEL_FLG
                , PRC.PRC_RULE_CATG_DESC_TXT
                , PRAT.PRC_RULE_ADJ_TP_DESC_TXT 
                , PRA.PRC_RULE_ATTRB_CD
                , PRA.PRC_RULE_ATTRB_DESC_TXT
            FROM
                SPEC_COND_PRC SCP
                , PRC_RULE_DTL PRD
                , PRC_RULE_HDR PRH
                , PRC_RULE_CATG PRC
                , PRC_RULE_ADJ_TP PRAT
                , PRC_RULE_ATTRB PRA
            WHERE
                SCP.GLBL_CMPY_CD            = #glblCmpyCd#
                AND SCP.SPEC_COND_PRC_PK    = #spcCondPrcPk#
                AND SCP.EZCANCELFLAG        = '0' 
                AND SCP.GLBL_CMPY_CD        = PRD.GLBL_CMPY_CD 
                AND SCP.PRC_RULE_DTL_PK     = PRD.PRC_RULE_DTL_PK 
                <!-- 2018/09/20 S21_NA#28283 Del Start -->
                <!-- AND PRD.EFF_FROM_DT        &lt;= #prcBaseDt# -->
                <!-- AND ( -->
                <!--     PRD.EFF_THRU_DT        &gt;= #prcBaseDt# -->
                <!--  OR PRD.EFF_THRU_DT        IS NULL -->
                <!--     ) -->
                <!-- 2018/09/20 S21_NA#28283 Del End -->
                AND PRD.EZCANCELFLAG        = '0' 
                AND PRD.GLBL_CMPY_CD        = PRH.GLBL_CMPY_CD 
                AND PRD.PRC_RULE_HDR_PK     = PRH.PRC_RULE_HDR_PK 
                <!-- 2018/09/20 S21_NA#28283 Del Start -->
                <!-- AND PRH.EFF_FROM_DT        &lt;= #prcBaseDt# -->
                <!-- AND ( -->
                <!--     PRH.EFF_THRU_DT        &gt;= #prcBaseDt# -->
                <!--  OR PRH.EFF_THRU_DT        IS NULL -->
                <!--     ) -->
                <!-- 2018/09/20 S21_NA#28283 Del End -->
                AND PRH.EZCANCELFLAG        = '0'
                AND PRH.GLBL_CMPY_CD        = PRC.GLBL_CMPY_CD 
                AND PRH.PRC_RULE_CATG_CD    = PRC.PRC_RULE_CATG_CD 
                AND PRC.EZCANCELFLAG        = '0' 
                AND PRD.GLBL_CMPY_CD        = PRAT.GLBL_CMPY_CD 
                AND PRD.PRC_RULE_ADJ_TP_CD  = PRAT.PRC_RULE_ADJ_TP_CD 
                AND PRAT.EZCANCELFLAG        = '0'
                AND PRD.GLBL_CMPY_CD        = PRAT.GLBL_CMPY_CD 
                AND PRD.PRC_RULE_ADJ_TP_CD  = PRAT.PRC_RULE_ADJ_TP_CD 
                AND PRAT.EZCANCELFLAG        = '0'
                AND PRD.GLBL_CMPY_CD        = PRA.GLBL_CMPY_CD 
                AND PRD.PRC_RULE_ATTRB_CD   = PRA.PRC_RULE_ATTRB_CD 
                AND PRA.EZCANCELFLAG        = '0'
        UNION ALL
        <!--  Adjustment -->
                SELECT
                  SCP.SPEC_COND_PRC_PK
                , SCP.PRC_MAX_AMT_RATE
                , SCP.PRC_MIN_AMT_RATE
                , PAD.PRC_RULE_DTL_PK
                , PAD.PRC_RULE_DTL_CHRG_NM
                , PRH.PRC_RULE_MOD_TP_CD
                , PRH.PRC_RULE_ADJ_TP_CD
                , PRH.PRC_RULE_ADJ_LVL_CD
                , PAD.PRC_FMLA_PK
                , PAD.PRC_RULE_DTL_RATE
                , PAD.PRC_RULE_DTL_TXT
                , PRH.PRC_RULE_HDR_PK
                , PRH.PRC_RULE_NM
                , PRH.PRC_RULE_DESC_TXT
                , PRH.PRC_RULE_CATG_CD
                , PRH.APPLY_AUTO_FLG
                , PRH.OVRD_FLG
                , PRH.ACTV_FLG
                , PRH.DEF_RULE_PRCD_NUM
                , PRH.PRC_RULE_COND_TP_CD
                , PRH.PRC_RULE_TRX_CATG_CD
                , PRH.DEL_FLG
                , PRC.PRC_RULE_CATG_DESC_TXT
                , PRAT.PRC_RULE_ADJ_TP_DESC_TXT 
                , PAD.PRC_RULE_ATTRB_CD
                , PRA.PRC_RULE_ATTRB_DESC_TXT
            FROM
                SPEC_COND_PRC SCP
                , PRC_ADJ_DTL PAD
                , PRC_RULE_HDR PRH
                , PRC_RULE_CATG PRC
                , PRC_RULE_ADJ_TP PRAT
                , PRC_RULE_ATTRB PRA
            WHERE
                SCP.GLBL_CMPY_CD            = #glblCmpyCd#
                AND SCP.SPEC_COND_PRC_PK    = #spcCondPrcPk#
                AND SCP.EZCANCELFLAG        = '0' 
                AND SCP.GLBL_CMPY_CD        = PAD.GLBL_CMPY_CD 
                AND SCP.PRC_RULE_DTL_PK     = PAD.PRC_RULE_DTL_PK 
                <!-- 2018/09/20 S21_NA#28283 Del Start -->
                <!-- AND PAD.EFF_FROM_DT        &lt;= #prcBaseDt# -->
                <!-- AND ( -->
                <!--     PAD.EFF_THRU_DT        &gt;= #prcBaseDt# -->
                <!--  OR PAD.EFF_THRU_DT        IS NULL -->
                <!--     ) -->
                <!-- 2018/09/20 S21_NA#28283 Del End -->
                AND PAD.EZCANCELFLAG        = '0' 
                AND PAD.GLBL_CMPY_CD        = PRH.GLBL_CMPY_CD 
                AND PAD.PRC_RULE_HDR_PK     = PRH.PRC_RULE_HDR_PK 
                <!-- 2018/09/20 S21_NA#28283 Del Start -->
                <!-- AND PRH.EFF_FROM_DT        &lt;= #prcBaseDt# -->
                <!-- AND ( -->
                <!--     PRH.EFF_THRU_DT        &gt;= #prcBaseDt# -->
                <!--  OR PRH.EFF_THRU_DT        IS NULL -->
                <!--     ) -->
                <!-- 2018/09/20 S21_NA#28283 Del End -->
                AND PRH.EZCANCELFLAG        = '0'

                AND PRH.GLBL_CMPY_CD        = PRC.GLBL_CMPY_CD 
                AND PRH.PRC_RULE_CATG_CD    = PRC.PRC_RULE_CATG_CD 
                AND PRC.EZCANCELFLAG        = '0' 
                AND PRH.GLBL_CMPY_CD        = PRAT.GLBL_CMPY_CD 
                AND PRH.PRC_RULE_ADJ_TP_CD  = PRAT.PRC_RULE_ADJ_TP_CD 
                AND PRAT.EZCANCELFLAG       = '0'
                AND PAD.GLBL_CMPY_CD        = PRA.GLBL_CMPY_CD 
                AND PAD.PRC_RULE_ATTRB_CD   = PRA.PRC_RULE_ATTRB_CD 
                AND PRA.EZCANCELFLAG        = '0'

    </statement>

    <statement id="getMdseNm" parameterClass="Map" resultClass="String">
        SELECT
                  M.MDSE_DESC_SHORT_TXT
            FROM
                ALL_MDSE_V M
            WHERE
                M.GLBL_CMPY_CD     = #glblCmpyCd#
                AND M.MDSE_CD      = #mdseCd#
                AND M.EZCANCELFLAG = '0' 

    </statement>

<!-- Sample ssm for receive MapClass
    <statement id="getSampleList" parameterClass="Map" resultClass="Map">
        SELECT
            TS.XXX
        FROM
             TBL_SAMPLE TS
        WHERE
             TS.GLBL_CMPY_CD       = #glblCmpyCd#
         AND TS.EZCANCELFLAG       = '0'
    </statement>
-->

<!-- Sample ssm for receive sMsg
    <statement id="getSampleToSMsg" parameterClass="Map" resultMap="rm.getSampleToSMsg">
        WITH DTL_DATA AS (
            SELECT
                      DCD.MDSE_CD
                    , DCD.CONTR_EFF_FROM_DT
                    , DCD.TRMN_TOT_AMT
                FROM
                    DS_CONTR_DTL DCD
                WHERE
                    DCD.GLBL_CMPY_CD           = #glblCmpyCd#
                    AND DCD.EZCANCELFLAG       = '0'
                ORDER BY
                    DS_CONTR_PK
                    , DS_CONTR_DTL_PK
            )
            SELECT
                      MDSE_CD
                    , CONTR_EFF_FROM_DT
                    , TRMN_TOT_AMT
                FROM
                    DTL_DATA
                WHERE
                    ROWNUM &lt; #limitRownum#
                ORDER BY
                    DS_CONTR_PK
                    , DS_CONTR_DTL_PK
    </statement>

    <typeAlias alias="NWAL1660SMsg"    type="business.blap.NWAL1660.NWAL1660SMsg"/>
    <typeAlias alias="NWAL1660_ASMsg"  type="business.blap.NWAL1660.NWAL1660_ASMsg"/>

    <resultMap id="rm.getSampleToSMsg" class="NWAL1660_ASMsg">
        <result property="mdseCd_A"             column="MDSE_CD"                javaType="EZDSStringItem"/>
        <result property="contrEffFromDt_A"     column="CONTR_EFF_FROM_DT"      javaType="EZDSDateItem"/>
        <result property="trmnTotAmt_A"         column="TRMN_TOT_AMT"           javaType="EZDSBigDecimalItem"/>
    </resultMap>
-->

</sqlMap>
