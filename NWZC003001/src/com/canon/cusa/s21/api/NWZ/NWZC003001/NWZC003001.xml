<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWZC003001">

    <typeAlias alias="NWZC003001PMsg" type="business.parts.NWZC003001PMsg"/>

    <typeAlias alias="SHIP_TO_CUSTTMsg" type="business.db.SHIP_TO_CUSTTMsg"/>
    <typeAlias alias="SHPG_PLNTMsg" type="business.db.SHPG_PLNTMsg"/>
    <typeAlias alias="HLDTMsg" type="business.db.HLDTMsg"/>

    <statement id="getCPOExistenceFlag" parameterClass="NWZC003001PMsg" resultClass="String">
        SELECT
               TR.CPO_EXST_FLG CPO_EXST_FLG
        FROM
               SHPG_PLN SP
              ,TRX_SRC_TP TR
        WHERE
                 SP.GLBL_CMPY_CD  = #glblCmpyCd#
             AND SP.SHPG_PLN_NUM  = #shpgPlnNum#
             AND TR.GLBL_CMPY_CD  = SP.GLBL_CMPY_CD
             AND TR.TRX_SRC_TP_CD = SP.TRX_SRC_TP_CD
             AND SP.EZCANCELFLAG  = '0'
             AND TR.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getCarrierName" parameterClass="Map" resultClass="String">
        SELECT
               V.LOC_NM LOC_NM
        FROM
               VND V
              ,VND_TP_RELN VT
        WHERE
                 V.GLBL_CMPY_CD  = #glblCmpyCd#
             AND V.VND_CD        = #vndCd#
             AND VT.VND_TP_CD    = #vndTpCd#
             AND VT.GLBL_CMPY_CD = V.GLBL_CMPY_CD
             AND VT.VND_CD       = V.VND_CD
             AND V.EZCANCELFLAG  = '0'
             AND VT.EZCANCELFLAG = '0'
    </statement>

    <statement id="getMaxDisplayNumber" parameterClass="Map" resultClass="String">
        SELECT
               MAX(TO_NUMBER(SP.SHPG_PLN_DPLY_LINE_NUM)) AS MAX_NUM
        FROM
               SHPG_PLN SP
        WHERE
                 SP.GLBL_CMPY_CD     = #glblCmpyCd#
             AND SP.TRX_HDR_NUM      = #trxHdrNum#
             AND SP.TRX_LINE_NUM     = #trxLineNum#
             AND SP.TRX_LINE_SUB_NUM = #trxLineSubNum#
             AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
    </statement>

    <statement id="searchSoftAllocation" parameterClass="Map" resultClass="BigDecimal">
        SELECT
               SO.SOFT_ALLOC_PK SOFT_ALLOC_PK
        FROM
               SOFT_ALLOC SO
              ,DIST_PLN_TM_FRAME DT
        WHERE
                 SO.GLBL_CMPY_CD      = #glblCmpyCd#
             AND SO.SHPG_PLN_NUM      = #shpgPlnNum#
             AND DT.GLBL_CMPY_CD      = SO.GLBL_CMPY_CD
             AND DT.DIST_PLN_NUM      = SO.DIST_PLN_NUM
             AND DT.DIST_TM_FRAME_NUM = SO.DIST_TM_FRAME_NUM
             AND SO.EZCANCELFLAG      = '0'
             AND DT.EZCANCELFLAG      = '0'
         ORDER BY
             DT.TM_FRAME_FROM_DT ASC
    </statement>

    <statement id="getShipToCustData" parameterClass="Map" resultMap="result.getShipToCustData">
        SELECT
               SH.LOC_NM                LOC_NM
              ,SH.ADDL_LOC_NM           ADDL_LOC_NM
              ,SH.FIRST_LINE_ADDR       FIRST_LINE_ADDR
              ,SH.SCD_LINE_ADDR         SCD_LINE_ADDR
              ,SH.THIRD_LINE_ADDR       THIRD_LINE_ADDR
              ,SH.FRTH_LINE_ADDR        FRTH_LINE_ADDR
              ,SH.FIRST_REF_CMNT_TXT    SHIP_TO_FIRST_REF_CMNT_TXT
              ,SH.SCD_REF_CMNT_TXT      SHIP_TO_SCD_REF_CMNT_TXT
              ,SH.CTY_ADDR              CTY_ADDR
              ,SH.ST_CD                 ST_CD
              ,SH.PROV_NM               PROV_NM
              ,SH.CNTY_PK               CNTY_PK
              ,SH.POST_CD               POST_CD
              ,SH.CTRY_CD               CTRY_CD
        FROM
               SHIP_TO_CUST SH
        WHERE
                 SH.GLBL_CMPY_CD    = #glblCmpyCd#
             AND SH.SHIP_TO_CUST_CD = #shipToCustCd#
             AND SH.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getVndData" parameterClass="Map" resultMap="result.getShipToCustData">
        SELECT
               V.LOC_NM                LOC_NM
              ,V.ADDL_LOC_NM           ADDL_LOC_NM
              ,V.FIRST_LINE_ADDR       FIRST_LINE_ADDR
              ,V.SCD_LINE_ADDR         SCD_LINE_ADDR
              ,V.THIRD_LINE_ADDR       THIRD_LINE_ADDR
              ,V.FRTH_LINE_ADDR        FRTH_LINE_ADDR
              ,V.FIRST_REF_CMNT_TXT    SHIP_TO_FIRST_REF_CMNT_TXT
              ,V.SCD_REF_CMNT_TXT      SHIP_TO_SCD_REF_CMNT_TXT
              ,V.CTY_ADDR              CTY_ADDR
              ,V.ST_CD                 ST_CD
              ,V.PROV_NM               PROV_NM
              ,V.CNTY_PK               CNTY_PK
              ,V.POST_CD               POST_CD
              ,V.CTRY_CD               CTRY_CD
        FROM
               VND V
        WHERE
                V.GLBL_CMPY_CD    = #glblCmpyCd#
            AND V.VND_CD          = #shipToCustCd#
            AND V.EZCANCELFLAG    = '0'
    </statement>

    <resultMap id="result.getShipToCustData" class="SHIP_TO_CUSTTMsg">
        <result property="locNm"           column="LOC_NM"                     javaType="EZDTStringItem"/>
        <result property="addlLocNm"       column="ADDL_LOC_NM"                javaType="EZDTStringItem"/>
        <result property="firstLineAddr"   column="FIRST_LINE_ADDR"            javaType="EZDTStringItem"/>
        <result property="scdLineAddr"     column="SCD_LINE_ADDR"              javaType="EZDTStringItem"/>
        <result property="thirdLineAddr"   column="THIRD_LINE_ADDR"            javaType="EZDTStringItem"/>
        <result property="frthLineAddr"    column="FRTH_LINE_ADDR"             javaType="EZDTStringItem"/>
        <result property="firstRefCmntTxt" column="SHIP_TO_FIRST_REF_CMNT_TXT" javaType="EZDTStringItem"/>
        <result property="scdRefCmntTxt"   column="SHIP_TO_SCD_REF_CMNT_TXT"   javaType="EZDTStringItem"/>
        <result property="ctyAddr"         column="CTY_ADDR"                   javaType="EZDTStringItem"/>
        <result property="stCd"            column="ST_CD"                      javaType="EZDTStringItem"/>
        <result property="provNm"          column="PROV_NM"                    javaType="EZDTStringItem"/>
        <result property="cntyPk"          column="CNTY_PK"                    javaType="EZDTBigDecimalItem"/>
        <result property="postCd"          column="POST_CD"                    javaType="EZDTStringItem"/>
        <result property="ctryCd"          column="CTRY_CD"                    javaType="EZDTStringItem"/>
    </resultMap>

    <statement id="queryEachCompTotalQty" parameterClass="Map" resultClass="Map">
        SELECT
               CD.CPO_ORD_NUM                AS CPO_ORD_NUM
              ,CD.CPO_DTL_LINE_NUM           AS CPO_DTL_LINE_NUM
              ,CD.CPO_DTL_LINE_SUB_NUM       AS CPO_DTL_LINE_SUB_NUM
              ,NVL(SPWRK.SUM_ORD_QTY,0)      AS SUM_ORD_QTY
              ,CD.MDSE_CD                    AS MDSE_CD
              ,CD.SET_MDSE_CD                AS SET_MDSE_CD
              ,CD.CPO_ORD_TS                 AS CPO_ORD_TS
        FROM
                (
                     SELECT
                           CD.CPO_ORD_NUM               AS CPO_ORD_NUM
                          ,CD.CPO_DTL_LINE_NUM          AS CPO_DTL_LINE_NUM
                          ,CD.CPO_DTL_LINE_SUB_NUM      AS CPO_DTL_LINE_SUB_NUM
                          ,CD.MDSE_CD                   AS MDSE_CD
                          ,CD.SET_MDSE_CD               AS SET_MDSE_CD
                          ,CD.CPO_ORD_TS                AS CPO_ORD_TS
                     FROM
                           CPO_DTL CD
                    WHERE
                            CD.GLBL_CMPY_CD         = #glblCmpyCd#
                        AND CD.CPO_ORD_NUM          = #trxHdrNum#
                        AND CD.CPO_DTL_LINE_NUM     = #trxLineNum#
                        AND CD.CPO_DTL_LINE_SUB_NUM &lt;&gt; #trxLineNumSet#
                        AND CD.EZCANCELFLAG         = '0'
                 ) CD
                LEFT JOIN
                 (
                     SELECT
                           SP.TRX_HDR_NUM       AS CPO_ORD_NUM
                          ,SP.TRX_LINE_NUM      AS CPO_DTL_LINE_NUM
                          ,SP.TRX_LINE_SUB_NUM  AS CPO_DTL_LINE_SUB_NUM
                          ,SUM(SP.ORD_QTY)      AS SUM_ORD_QTY
                     FROM
                          SHPG_PLN SP
                    WHERE
                            SP.GLBL_CMPY_CD     = #glblCmpyCd#
                        AND SP.TRX_HDR_NUM      = #trxHdrNum#
                        AND SP.TRX_LINE_NUM     = #trxLineNum#
                        AND SP.TRX_LINE_SUB_NUM &lt;&gt; #trxLineNumSet#
                        AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
                        AND SP.SET_SHPG_PLN_NUM = #setShpgPlnNum#
                        AND
                            (
                                    EXISTS (
                                                SELECT  '1'
                                                FROM    MDSE M
                                                WHERE
                                                            M.GLBL_CMPY_CD   = #glblCmpyCd#
                                                        AND SP.MDSE_CD       = M.MDSE_CD
                                                        AND SP.SHPG_STS_CD   = #shpgStsCdVA#
                                                        AND M.INVTY_CTRL_FLG = #off#
                                                        AND M.EZCANCELFLAG   = '0'
                                               )
                        <isEqual property="soPrintFlg" compareValue="Y">
                                  OR EXISTS (
                                                SELECT  '1'
                                                FROM    SHPG_STS SS
                                                WHERE
                                                            SP.SHPG_STS_CD   = SS.SHPG_STS_CD
                                                        AND SP.GLBL_CMPY_CD  = SS.GLBL_CMPY_CD
                                                        AND SS.SO_PRINT_FLG  = #on#
                                                        AND SS.EZCANCELFLAG  = '0'
                                               )
                        </isEqual>
                        <isEqual property="shipFlg" compareValue="Y">
                                  OR EXISTS (
                                                SELECT  '1'
                                                FROM    SHPG_STS SS
                                                WHERE       SP.SHPG_STS_CD   = SS.SHPG_STS_CD
                                                        AND SP.GLBL_CMPY_CD  = SS.GLBL_CMPY_CD
                                                        AND SS.SHIP_FLG      = #on#
                                                        AND SS.EZCANCELFLAG  = '0'
                                               )
                        </isEqual>
                            )
                        AND SP.EZCANCELFLAG = '0'
                    GROUP BY
                            SP.TRX_HDR_NUM
                           ,SP.TRX_LINE_NUM
                           ,SP.TRX_LINE_SUB_NUM
                ) SPWRK
        ON
                CD.CPO_ORD_NUM          = SPWRK.CPO_ORD_NUM
            AND CD.CPO_DTL_LINE_NUM     = SPWRK.CPO_DTL_LINE_NUM
            AND CD.CPO_DTL_LINE_SUB_NUM = SPWRK.CPO_DTL_LINE_SUB_NUM
    </statement>

    <statement id="queryShpgPlnEachComp" parameterClass="Map" resultClass="Map">
        SELECT
              SP.GLBL_CMPY_CD        AS GLBL_CMPY_CD
             ,SP.TRX_HDR_NUM         AS TRX_HDR_NUM
             ,SP.TRX_LINE_NUM        AS TRX_LINE_NUM
             ,SP.TRX_LINE_SUB_NUM    AS TRX_LINE_SUB_NUM
             ,SP.SHPG_STS_CD         AS SHPG_STS_CD
             ,SP.SHPG_PLN_NUM        AS SHPG_PLN_NUM 
             ,SP.ORD_QTY             AS ORD_QTY
             ,SP.MDSE_CD             AS MDSE_CD
             ,SP.SET_MDSE_CD         AS SET_MDSE_CD
             ,SP.SOFT_ALLOC_QTY      AS SOFT_ALLOC_QTY
             ,SP.PO_REQ_FLG          AS PO_REQ_FLG
        FROM
              SHPG_PLN SP
        WHERE
               SP.GLBL_CMPY_CD     = #glblCmpyCd#
           AND SP.TRX_HDR_NUM      = #trxHdrNum#
           AND SP.TRX_LINE_NUM     = #trxLineNum#
           AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
           AND SP.SET_SHPG_PLN_NUM = #setShpgPlnNum#
           AND SP.TRX_LINE_SUB_NUM &lt;&gt; #trxLineNumSet#
           AND
                            (
                                    EXISTS (
                                                SELECT '1'
                                                FROM    MDSE M
                                                WHERE
                                                       M.GLBL_CMPY_CD   = #glblCmpyCd#
                                                   AND SP.MDSE_CD       = M.MDSE_CD
                                                   AND SP.SHPG_STS_CD   = #shpgStsCdVA#
                                                   AND M.INVTY_CTRL_FLG = #off#
                                                   AND M.EZCANCELFLAG   = '0'
                                               )
                        <isEqual property="soPrintFlg" compareValue="Y">
                                  OR EXISTS (
                                                SELECT  '1'
                                                FROM    SHPG_STS SS
                                                WHERE
                                                       SP.SHPG_STS_CD  = SS.SHPG_STS_CD
                                                   AND SP.GLBL_CMPY_CD = SS.GLBL_CMPY_CD
                                                   AND SS.SO_PRINT_FLG = #on#
                                                   AND SS.EZCANCELFLAG = '0'
                                               )
                        </isEqual>
                        <isEqual property="shipFlg" compareValue="Y">
                                  OR EXISTS (
                                                SELECT  '1'
                                                FROM    SHPG_STS SS
                                                WHERE
                                                       SP.SHPG_STS_CD  = SS.SHPG_STS_CD
                                                   AND SP.GLBL_CMPY_CD = SS.GLBL_CMPY_CD
                                                   AND SS.SHIP_FLG     = #on#
                                                   AND SS.EZCANCELFLAG = '0'
                                               )
                        </isEqual>
                            )
            AND SP.EZCANCELFLAG = '0'
        ORDER BY
                SP.TRX_HDR_NUM
               ,SP.TRX_LINE_NUM
               ,SP.TRX_LINE_SUB_NUM
               ,SP.SHPG_STS_CD DESC
               ,SP.SHPG_PLN_NUM
    </statement>
    
    <statement id="querySetShpgPln" parameterClass="Map" resultClass="String">
        SELECT
              SP.SHPG_PLN_NUM  AS SHPG_PLN_NUM
        FROM
              SHPG_PLN SP
        WHERE
              SP.GLBL_CMPY_CD      = #glblCmpyCd#
           AND SP.TRX_HDR_NUM      = #trxHdrNum#
           AND SP.TRX_LINE_NUM     = #trxLineNum#
           AND SP.TRX_LINE_SUB_NUM = #trxLineNumSet#
           AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
           AND SP.EZCANCELFLAG     = '0'
           AND SP.SHPG_STS_CD      IN
                <iterate property="shpgStsList" var="shpgSts[]" open="(" close=")" conjunction=",">
                        #shpgSts[]#
                </iterate>
        ORDER BY
                SP.SHPG_STS_CD DESC
    </statement>
    
    <statement id="queryCompShpgPln" parameterClass="Map" resultClass="String">
        SELECT
              SP.SHPG_PLN_NUM  AS SHPG_PLN_NUM
        FROM
              SHPG_PLN SP
             ,HARD_ALLOC HA
        WHERE
               SP.GLBL_CMPY_CD     = #glblCmpyCd#
           AND SP.TRX_HDR_NUM      = #trxHdrNum#
           AND SP.TRX_LINE_NUM     = #trxLineNum#
           AND SP.TRX_LINE_SUB_NUM = #trxLineSubNum#
           AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
           AND SP.EZCANCELFLAG     = '0'
           AND SP.SHPG_STS_CD      = #shpgStsCdHA#
           AND SP.SET_SHPG_PLN_NUM = #setSHpgPlnNum#
           AND SP.GLBL_CMPY_CD     = HA.GLBL_CMPY_CD
           AND SP.SHPG_PLN_NUM     = HA.SHPG_PLN_NUM
           AND HA.EZCANCELFLAG     = '0'
        ORDER BY
            HARD_ALLOC_TS
    </statement>
    
    <statement id="queryPsdDt" parameterClass="Map" resultClass="String">
        SELECT
              SP.PSD_DT
        FROM
              SHPG_PLN SP
        WHERE
               SP.GLBL_CMPY_CD     = #glblCmpyCd#
           AND SP.TRX_HDR_NUM      = #trxHdrNum#
           AND SP.TRX_LINE_NUM     = #trxLineNum#
           AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
           AND SP.EZCANCELFLAG     = '0'
           AND SP.SET_SHPG_PLN_NUM = #setSHpgPlnNum#
        ORDER BY
            SP.PSD_DT
    </statement>

    <statement id="queryPddDt" parameterClass="Map" resultClass="String">
        SELECT
              SP.PDD_DT 
        FROM
              SHPG_PLN SP
        WHERE
               SP.GLBL_CMPY_CD     = #glblCmpyCd#
           AND SP.TRX_HDR_NUM      = #trxHdrNum#
           AND SP.TRX_LINE_NUM     = #trxLineNum#
           AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
           AND SP.EZCANCELFLAG     = '0'
           AND SP.SET_SHPG_PLN_NUM = #setSHpgPlnNum#
        ORDER BY
            SP.PDD_DT
    </statement>

    <statement id="queryEachCompTotalQtyByStatus" parameterClass="Map" resultClass="Map">
        SELECT
              CD.CPO_ORD_NUM             AS CPO_ORD_NUM 
             ,CD.CPO_DTL_LINE_NUM        AS CPO_DTL_LINE_NUM
             ,CD.CPO_DTL_LINE_SUB_NUM    AS CPO_DTL_LINE_SUB_NUM
             ,NVL(SPWRK.SUM_ORD_QTY,0)   AS SUM_ORD_QTY
             ,CD.MDSE_CD                 AS MDSE_CD
             ,CD.SET_MDSE_CD             AS SET_MDSE_CD
             ,CD.CPO_ORD_TS              AS CPO_ORD_TS
        FROM
                (
                     SELECT
                           CD.CPO_ORD_NUM           AS CPO_ORD_NUM
                          ,CD.CPO_DTL_LINE_NUM      AS CPO_DTL_LINE_NUM
                          ,CD.CPO_DTL_LINE_SUB_NUM  AS CPO_DTL_LINE_SUB_NUM
                          ,CD.MDSE_CD               AS MDSE_CD
                          ,CD.SET_MDSE_CD           AS SET_MDSE_CD
                          ,CD.CPO_ORD_TS            AS CPO_ORD_TS
                     FROM
                         CPO_DTL CD
                    WHERE
                            CD.GLBL_CMPY_CD         = #glblCmpyCd#
                        AND CD.CPO_ORD_NUM          = #trxHdrNum#
                        AND CD.CPO_DTL_LINE_NUM     = #trxLineNum#
                        AND CD.CPO_DTL_LINE_SUB_NUM &lt;&gt; #trxLineNumSet#
                        AND CD.EZCANCELFLAG         = '0'
                 )  CD
                LEFT JOIN
                 (
                     SELECT
                           SP.TRX_HDR_NUM       AS CPO_ORD_NUM
                          ,SP.TRX_LINE_NUM      AS CPO_DTL_LINE_NUM
                          ,SP.TRX_LINE_SUB_NUM  AS CPO_DTL_LINE_SUB_NUM
                          ,SUM(SP.ORD_QTY)      AS SUM_ORD_QTY
                     FROM
                         SHPG_PLN SP
                    WHERE
                            SP.GLBL_CMPY_CD     = #glblCmpyCd#
                        AND SP.TRX_HDR_NUM      = #trxHdrNum#
                        AND SP.TRX_LINE_NUM     = #trxLineNum#
                        AND SP.TRX_LINE_SUB_NUM &lt;&gt; #trxLineNumSet#
                        AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
                        AND SP.SET_SHPG_PLN_NUM = #setShpgPlnNum#
                        AND
                            (
                                    EXISTS (
                                                SELECT  '1'
                                                FROM    MDSE M
                                                WHERE
                                                       M.GLBL_CMPY_CD   = #glblCmpyCd#
                                                   AND SP.MDSE_CD       = M.MDSE_CD
                                                   AND SP.SHPG_STS_CD   = #shpgStsCdVA#
                                                   AND M.INVTY_CTRL_FLG = #off#
                                                   AND M.EZCANCELFLAG   = '0'
                                               )
                                  OR (SP.SHPG_STS_CD = #shpgPlnStsCd#)
                            )
                        AND SP.EZCANCELFLAG = '0'
                    GROUP BY
                         SP.TRX_HDR_NUM
                        ,SP.TRX_LINE_NUM
                        ,SP.TRX_LINE_SUB_NUM
                ) SPWRK
        ON
                CD.CPO_ORD_NUM           = SPWRK.CPO_ORD_NUM
            AND CD.CPO_DTL_LINE_NUM      = SPWRK.CPO_DTL_LINE_NUM
            AND CD.CPO_DTL_LINE_SUB_NUM  = SPWRK.CPO_DTL_LINE_SUB_NUM
    </statement>

    <statement id="getSoNumInfo" parameterClass="Map" resultClass="Map">
        SELECT
              SP.BOL_NUM
             ,SP.PRO_NUM
        FROM
              SHPG_PLN SP
        WHERE
               SP.GLBL_CMPY_CD = #glblCmpyCd#
           AND SP.SO_NUM       = #soNum#
           AND SP.BOL_NUM      IS NOT NULL
           AND SP.SHPG_PLN_NUM &lt;&gt; #shpgPlnNum#
           AND SP.EZCANCELFLAG = '0'
    </statement>

    <statement id="getStdCcyDigit" parameterClass="Map" resultClass="Integer">
        SELECT
              C.AFT_DECL_PNT_DIGIT_NUM
        FROM
              CCY C
        WHERE
               C.GLBL_CMPY_CD = #glblCmpyCd#
           AND C.CCY_CD       = #ccyCd#
           AND C.EZCANCELFLAG = '0'
    </statement>

<!-- START ADD S.Yamamoto [OM053] -->
    <statement id="getActualFreightFlag" parameterClass="SHPG_PLNTMsg" resultClass="String">
        SELECT
              FC.ACTL_FRT_FLG
        FROM
              SHPG_PLN   SP
             ,CPO_DTL    CD
             ,FRT_COND   FC
        WHERE
               SP.GLBL_CMPY_CD          = #glblCmpyCd#
           AND SP.SHPG_PLN_NUM          = #shpgPlnNum#
           AND SP.EZCANCELFLAG          = '0'
           AND CD.GLBL_CMPY_CD          = SP.GLBL_CMPY_CD
           AND CD.CPO_ORD_NUM           = SP.TRX_HDR_NUM
           AND CD.CPO_DTL_LINE_NUM      = SP.TRX_LINE_NUM
           AND CD.CPO_DTL_LINE_SUB_NUM  = SP.TRX_LINE_SUB_NUM
           AND CD.EZCANCELFLAG          = '0'
           AND FC.GLBL_CMPY_CD          = CD.GLBL_CMPY_CD
           AND FC.FRT_COND_CD           = CD.FRT_COND_CD
           AND FC.EZCANCELFLAG         = '0'
    </statement>
<!-- END   ADD S.Yamamoto [OM053] -->
<!-- 2015/09/10 CNA(2.8 Allocation - SO/PO) Add Start -->
    <statement id="getToBeValidateShpgPln" parameterClass="Map" resultMap="result.SHPG_PLNTMsg">
        SELECT 
                SP.EZTABLEID
            ,   SP.EZCANCELFLAG
            ,   SP.EZINTIME
            ,   SP.EZINTIMEZONE
            ,   SP.EZINCOMPANYCODE
            ,   SP.EZINUSERID
            ,   SP.EZINAPLID
            ,   SP.EZUPTIME
            ,   SP.EZUPTIMEZONE
            ,   SP.EZUPCOMPANYCODE
            ,   SP.EZUPUSERID
            ,   SP.EZUPAPLID
            ,   SP.GLBL_CMPY_CD
            ,   SP.SHPG_PLN_NUM
            ,   SP.SHPG_PLN_DPLY_LINE_NUM
            ,   SP.TRX_SRC_TP_CD
            ,   SP.TRX_HDR_NUM
            ,   SP.TRX_LINE_NUM
            ,   SP.TRX_LINE_SUB_NUM
            ,   SP.BILL_TO_CUST_CD
            ,   SP.SELL_TO_CUST_CD
            ,   SP.SHIP_TO_CUST_CD
            ,   SP.DROP_SHIP_FLG
            ,   SP.TRX_CD
            ,   SP.SHPG_STS_CD
            ,   SP.RTE_STS_CD
            ,   SP.REQ_SHPG_SVC_LVL_CD
            ,   SP.ORIG_SHPG_SVC_LVL_CD
            ,   SP.REQ_FRT_CHRG_TO_CD
            ,   SP.REQ_FRT_CHRG_METH_CD
            ,   SP.SP_DEAL_UNIT_PRC_AMT
            ,   SP.SP_DEAL_NET_UNIT_PRC_AMT
            ,   SP.SP_TOT_DEAL_SLS_AMT
            ,   SP.SP_TOT_DEAL_NET_AMT
            ,   SP.SP_TOT_DEAL_FRT_AMT
            ,   SP.SP_FUNC_UNIT_PRC_AMT
            ,   SP.SP_FUNC_NET_UNIT_PRC_AMT
            ,   SP.SP_TOT_FUNC_SLS_AMT
            ,   SP.SP_TOT_FUNC_NET_AMT
            ,   SP.SP_TOT_FUNC_FRT_AMT
            ,   SP.AVAL_HARD_ALLOC_QTY
            ,   SP.AVAL_SOFT_ALLOC_QTY
            ,   SP.AVAL_SO_QTY
            ,   SP.AVAL_PO_QTY
            ,   SP.SO_NUM
            ,   SP.PO_ORD_NUM
            ,   SP.THIRD_PTY_INV_NUM
            ,   SP.ACTL_SHPG_METH_CD
            ,   SP.ACTL_SHPG_TERM_CD
            ,   SP.ACTL_SHPG_SVC_LVL_CD
            ,   SP.ACTL_FRT_CHRG_TO_CD
            ,   SP.ACTL_FRT_CHRG_METH_CD
            ,   SP.CARR_CD
            ,   SP.CARR_NM
            ,   SP.BOL_NUM
            ,   SP.PRO_NUM
            ,   SP.INV_NUM
            ,   SP.CCY_CD
            ,   SP.EXCH_RATE
            ,   SP.ORD_UOM_QTY
            ,   SP.RDD_DT
            ,   SP.RSD_DT
            ,   SP.PSD_DT
            ,   SP.PDD_DT
            ,   SP.ETA_DT
            ,   SP.ACTL_SHIP_DT
            ,   SP.ACTL_ARV_DT
            ,   SP.SHIP_TO_LOC_NM
            ,   SP.SHIP_TO_ADDL_LOC_NM
            ,   SP.SHIP_TO_FIRST_LINE_ADDR
            ,   SP.SHIP_TO_SCD_LINE_ADDR
            ,   SP.SHIP_TO_THIRD_LINE_ADDR
            ,   SP.SHIP_TO_FRTH_LINE_ADDR
            ,   SP.SHIP_TO_FIRST_REF_CMNT_TXT
            ,   SP.SHIP_TO_SCD_REF_CMNT_TXT
            ,   SP.SHIP_TO_CTY_ADDR
            ,   SP.SHIP_TO_ST_CD
            ,   SP.SHIP_TO_PROV_ADDR
            ,   SP.SHIP_TO_CNTY_NM
            ,   SP.SHIP_TO_POST_CD
            ,   SP.SHIP_TO_CTRY_CD
            ,   SP.DSLP_INFO_FLG
            ,   SP.CUST_UOM_CD
            ,   SP.RQST_CARR_CD
            ,   SP.CARR_ACCT_NUM
            ,   SP.CARR_ACCT_SHIP_NUM
            ,   SP.SHIP_CMNT_FIRST_LINE_TXT
            ,   SP.SHIP_CMNT_SCD_LINE_TXT
            ,   SP.SHIP_CMNT_THIRD_LINE_TXT
            ,   SP.SHIP_CMNT_FRTH_LINE_TXT
            ,   SP.SHIP_AVAL_FLG
            ,   SP.PO_REQ_FLG
            ,   SP.SO_CLOSE_FLG
            ,   SP.MDSE_CD
            ,   SP.INVTY_LOC_CD
            ,   SP.STK_STS_CD
            ,   SP.SHIP_CPLT_CD
            ,   SP.UOM_CPLT_FLG
            ,   SP.PMT_TERM_CD
            ,   SP.CASH_DISC_TERM_CD
            ,   SP.SLS_REP_TOC_CD
            ,   SP.SHIP_PLN_HLD_FLG
            ,   SP.SHIP_PLN_CANC_FLG
            ,   SP.SHIP_PLN_CANC_DT
            ,   SP.SOFT_ALLOC_QTY
            ,   SP.ORD_QTY
            ,   SP.CR_HLD_QTY
            ,   SP.SLS_HLD_QTY
            ,   SP.CR_CHK_QTY
            ,   SP.SET_PRC_DET_GRP_SQ
            ,   SP.SET_MDSE_CD
            ,   SP.SET_ITEM_SHIP_CPLT_FLG
            ,   SP.SEND_EML_CPLT_FLG
            ,   SP.SYS_SRC_CD
            ,   SP.TRX_RSN_CD
            ,   SP.REV_RECOG_FLG
            ,   SP.EXPT_FLG
            ,   SP.SET_SHPG_PLN_NUM
            ,   SP.PMT_TERM_CASH_DISC_CD
            ,   SP.PRC_CATG_CD
        FROM 
                SHPG_PLN SP
        WHERE
                SP.GLBL_CMPY_CD = #glblCmpyCd#
            AND SP.EZCANCELFLAG = '0'
            AND SP.TRX_SRC_TP_CD = #trx_src_tp#
            AND SP.TRX_HDR_NUM = #TrxHdrNum#
            AND SP.TRX_LINE_NUM = #TrxLineNum#
            AND SP.TRX_LINE_SUB_NUM = #TrxLineSubNum#
            AND SP.SHPG_STS_CD IN
        <iterate property="shpg_sts" var="shpg_sts[]" open="(" close=")" conjunction=",">
            #shpg_sts[]#
        </iterate>
        ORDER BY 
                SP.SHPG_STS_CD
    </statement>

    <!-- 12/16/2016 CSAI Y.Imazu Add QC16614 START -->
    <statement id="getOpenShpgPlnList" parameterClass="Map" resultMap="result.SHPG_PLNTMsg">
        SELECT
            SP.EZTABLEID
           ,SP.EZCANCELFLAG
           ,SP.EZINTIME
           ,SP.EZINTIMEZONE
           ,SP.EZINCOMPANYCODE
           ,SP.EZINUSERID
           ,SP.EZINAPLID
           ,SP.EZUPTIME
           ,SP.EZUPTIMEZONE
           ,SP.EZUPCOMPANYCODE
           ,SP.EZUPUSERID
           ,SP.EZUPAPLID
           ,SP.GLBL_CMPY_CD
           ,SP.SHPG_PLN_NUM
           ,SP.SHPG_PLN_DPLY_LINE_NUM
           ,SP.TRX_SRC_TP_CD
           ,SP.TRX_HDR_NUM
           ,SP.TRX_LINE_NUM
           ,SP.TRX_LINE_SUB_NUM
           ,SP.BILL_TO_CUST_CD
           ,SP.SELL_TO_CUST_CD
           ,SP.SHIP_TO_CUST_CD
           ,SP.DROP_SHIP_FLG
           ,SP.TRX_CD
           ,SP.SHPG_STS_CD
           ,SP.RTE_STS_CD
           ,SP.REQ_SHPG_SVC_LVL_CD
           ,SP.ORIG_SHPG_SVC_LVL_CD
           ,SP.REQ_FRT_CHRG_TO_CD
           ,SP.REQ_FRT_CHRG_METH_CD
           ,SP.SP_DEAL_UNIT_PRC_AMT
           ,SP.SP_DEAL_NET_UNIT_PRC_AMT
           ,SP.SP_TOT_DEAL_SLS_AMT
           ,SP.SP_TOT_DEAL_NET_AMT
           ,SP.SP_TOT_DEAL_FRT_AMT
           ,SP.SP_FUNC_UNIT_PRC_AMT
           ,SP.SP_FUNC_NET_UNIT_PRC_AMT
           ,SP.SP_TOT_FUNC_SLS_AMT
           ,SP.SP_TOT_FUNC_NET_AMT
           ,SP.SP_TOT_FUNC_FRT_AMT
           ,SP.AVAL_HARD_ALLOC_QTY
           ,SP.AVAL_SOFT_ALLOC_QTY
           ,SP.AVAL_SO_QTY
           ,SP.AVAL_PO_QTY
           ,SP.SO_NUM
           ,SP.SO_SLP_NUM
           ,SP.PO_ORD_NUM
           ,SP.THIRD_PTY_INV_NUM
           ,SP.ACTL_SHPG_METH_CD
           ,SP.ACTL_SHPG_TERM_CD
           ,SP.ACTL_SHPG_SVC_LVL_CD
           ,SP.ACTL_FRT_CHRG_TO_CD
           ,SP.ACTL_FRT_CHRG_METH_CD
           ,SP.CARR_CD
           ,SP.CARR_NM
           ,SP.BOL_NUM
           ,SP.PRO_NUM
           ,SP.INV_NUM
           ,SP.CCY_CD
           ,SP.EXCH_RATE
           ,SP.ORD_UOM_QTY
           ,SP.RDD_DT
           ,SP.RSD_DT
           ,SP.PSD_DT
           ,SP.PDD_DT
           ,SP.ETA_DT
           ,SP.ACTL_SHIP_DT
           ,SP.ACTL_ARV_DT
           ,SP.SHIP_TO_LOC_NM
           ,SP.SHIP_TO_ADDL_LOC_NM
           ,SP.SHIP_TO_FIRST_LINE_ADDR
           ,SP.SHIP_TO_SCD_LINE_ADDR
           ,SP.SHIP_TO_THIRD_LINE_ADDR
           ,SP.SHIP_TO_FRTH_LINE_ADDR
           ,SP.SHIP_TO_FIRST_REF_CMNT_TXT
           ,SP.SHIP_TO_SCD_REF_CMNT_TXT
           ,SP.SHIP_TO_CTY_ADDR
           ,SP.SHIP_TO_ST_CD
           ,SP.SHIP_TO_PROV_ADDR
           ,SP.SHIP_TO_CNTY_NM
           ,SP.SHIP_TO_POST_CD
           ,SP.SHIP_TO_CTRY_CD
           ,SP.DSLP_INFO_FLG
           ,SP.CUST_UOM_CD
           ,SP.RQST_CARR_CD
           ,SP.CARR_ACCT_NUM
           ,SP.CARR_ACCT_SHIP_NUM
           ,SP.SHIP_CMNT_FIRST_LINE_TXT
           ,SP.SHIP_CMNT_SCD_LINE_TXT
           ,SP.SHIP_CMNT_THIRD_LINE_TXT
           ,SP.SHIP_CMNT_FRTH_LINE_TXT
           ,SP.SHIP_AVAL_FLG
           ,SP.PO_REQ_FLG
           ,SP.SO_CLOSE_FLG
           ,SP.MDSE_CD
           ,SP.INVTY_LOC_CD
           ,SP.STK_STS_CD
           ,SP.SHIP_CPLT_CD
           ,SP.UOM_CPLT_FLG
           ,SP.PMT_TERM_CD
           ,SP.CASH_DISC_TERM_CD
           ,SP.SLS_REP_TOC_CD
           ,SP.SHIP_PLN_HLD_FLG
           ,SP.SHIP_PLN_CANC_FLG
           ,SP.SHIP_PLN_CANC_DT
           ,SP.SOFT_ALLOC_QTY
           ,SP.ORD_QTY
           ,SP.CR_HLD_QTY
           ,SP.SLS_HLD_QTY
           ,SP.CR_CHK_QTY
           ,SP.SET_PRC_DET_GRP_SQ
           ,SP.SET_MDSE_CD
           ,SP.SET_ITEM_SHIP_CPLT_FLG
           ,SP.SEND_EML_CPLT_FLG
           ,SP.SYS_SRC_CD
           ,SP.TRX_RSN_CD
           ,SP.REV_RECOG_FLG
           ,SP.EXPT_FLG
           ,SP.SET_SHPG_PLN_NUM
           ,SP.PMT_TERM_CASH_DISC_CD
           ,SP.PRC_CATG_CD
        FROM
            SHPG_PLN SP
        WHERE
            SP.GLBL_CMPY_CD = #glblCmpyCd#
        AND SP.SO_NUM       = #soNum#
        AND SP.SHPG_STS_CD NOT IN (#shpgStsCd39#, #shpgStsCd99#)
        AND SP.EZCANCELFLAG = '0'
        <!-- 01/24/2018 CSAI T.Tokutomi Add QC16614 START -->
        <isNotNull property="invtyCtrlFlg_Y">
        AND EXISTS(
                SELECT 1
                FROM MDSE M
                WHERE
                    M.MDSE_CD        = SP.MDSE_CD
                AND M.INVTY_CTRL_FLG = #invtyCtrlFlg_Y#
                AND M.EZCANCELFLAG   = '0'
           )
        </isNotNull>
        <!-- 01/24/2018 CSAI T.Tokutomi Add QC16614 END -->
    </statement>
    <!-- 12/16/2016 CSAI Y.Imazu Add QC16614 END -->

    <resultMap id="result.SHPG_PLNTMsg" class="SHPG_PLNTMsg">
        <result property="ezTableID"                column="EZTABLEID"                  javaType="EZDTStringItem"/>
        <result property="ezCancelFlag"             column="EZCANCELFLAG"               javaType="EZDTStringItem"/>
        <result property="ezInTime"                 column="EZINTIME"                   javaType="EZDTStringItem"/>
        <result property="ezInTimeZone"             column="EZINTIMEZONE"               javaType="EZDTStringItem"/>
        <result property="ezInCompanyCode"          column="EZINCOMPANYCODE"            javaType="EZDTStringItem"/>
        <result property="ezInUserID"               column="EZINUSERID"                 javaType="EZDTStringItem"/>
        <result property="ezInAplID"                column="EZINAPLID"                  javaType="EZDTStringItem"/>
        <result property="ezUpTime"                 column="EZUPTIME"                   javaType="EZDTStringItem"/>
        <result property="ezUpTimeZone"             column="EZUPTIMEZONE"               javaType="EZDTStringItem"/>
        <result property="ezUpCompanyCode"          column="EZUPCOMPANYCODE"            javaType="EZDTStringItem"/>
        <result property="ezUpUserID"               column="EZUPUSERID"                 javaType="EZDTStringItem"/>
        <result property="ezUpAplID"                column="EZUPAPLID"                  javaType="EZDTStringItem"/>
        <result property="glblCmpyCd"               column="GLBL_CMPY_CD"               javaType="EZDTStringItem"/>
        <result property="shpgPlnNum"               column="SHPG_PLN_NUM"               javaType="EZDTStringItem"/>
        <result property="shpgPlnDplyLineNum"       column="SHPG_PLN_DPLY_LINE_NUM"     javaType="EZDTStringItem"/>
        <result property="trxSrcTpCd"               column="TRX_SRC_TP_CD"              javaType="EZDTStringItem"/>
        <result property="trxHdrNum"                column="TRX_HDR_NUM"                javaType="EZDTStringItem"/>
        <result property="trxLineNum"               column="TRX_LINE_NUM"               javaType="EZDTStringItem"/>
        <result property="trxLineSubNum"            column="TRX_LINE_SUB_NUM"           javaType="EZDTStringItem"/>
        <result property="billToCustCd"             column="BILL_TO_CUST_CD"            javaType="EZDTStringItem"/>
        <result property="sellToCustCd"             column="SELL_TO_CUST_CD"            javaType="EZDTStringItem"/>
        <result property="shipToCustCd"             column="SHIP_TO_CUST_CD"            javaType="EZDTStringItem"/>
        <result property="dropShipFlg"              column="DROP_SHIP_FLG"              javaType="EZDTStringItem"/>
        <result property="trxCd"                    column="TRX_CD"                     javaType="EZDTStringItem"/>
        <result property="shpgStsCd"                column="SHPG_STS_CD"                javaType="EZDTStringItem"/>
        <result property="rteStsCd"                 column="RTE_STS_CD"                 javaType="EZDTStringItem"/>
        <result property="reqShpgSvcLvlCd"          column="REQ_SHPG_SVC_LVL_CD"        javaType="EZDTStringItem"/>
        <result property="origShpgSvcLvlCd"         column="ORIG_SHPG_SVC_LVL_CD"       javaType="EZDTStringItem"/>
        <result property="reqFrtChrgToCd"           column="REQ_FRT_CHRG_TO_CD"         javaType="EZDTStringItem"/>
        <result property="reqFrtChrgMethCd"         column="REQ_FRT_CHRG_METH_CD"       javaType="EZDTStringItem"/>
        <result property="spDealUnitPrcAmt"         column="SP_DEAL_UNIT_PRC_AMT"       javaType="EZDTBigDecimalItem"/>
        <result property="spDealNetUnitPrcAmt"      column="SP_DEAL_NET_UNIT_PRC_AMT"   javaType="EZDTBigDecimalItem"/>
        <result property="spTotDealSlsAmt"          column="SP_TOT_DEAL_SLS_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="spTotDealNetAmt"          column="SP_TOT_DEAL_NET_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="spTotDealFrtAmt"          column="SP_TOT_DEAL_FRT_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="spFuncUnitPrcAmt"         column="SP_FUNC_UNIT_PRC_AMT"       javaType="EZDTBigDecimalItem"/>
        <result property="spFuncNetUnitPrcAmt"      column="SP_FUNC_NET_UNIT_PRC_AMT"   javaType="EZDTBigDecimalItem"/>
        <result property="spTotFuncSlsAmt"          column="SP_TOT_FUNC_SLS_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="spTotFuncNetAmt"          column="SP_TOT_FUNC_NET_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="spTotFuncFrtAmt"          column="SP_TOT_FUNC_FRT_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="avalHardAllocQty"         column="AVAL_HARD_ALLOC_QTY"        javaType="EZDTBigDecimalItem"/>
        <result property="avalSoftAllocQty"         column="AVAL_SOFT_ALLOC_QTY"        javaType="EZDTBigDecimalItem"/>
        <result property="avalSoQty"                column="AVAL_SO_QTY"                javaType="EZDTBigDecimalItem"/>
        <result property="avalPoQty"                column="AVAL_PO_QTY"                javaType="EZDTBigDecimalItem"/>
        <result property="soNum"                    column="SO_NUM"                     javaType="EZDTStringItem"/>
        <result property="soSlpNum"                 column="SO_SLP_NUM"                 javaType="EZDTStringItem"/>
        <result property="poOrdNum"                 column="PO_ORD_NUM"                 javaType="EZDTStringItem"/>
        <result property="thirdPtyInvNum"           column="THIRD_PTY_INV_NUM"          javaType="EZDTStringItem"/>
        <result property="actlShpgMethCd"           column="ACTL_SHPG_METH_CD"          javaType="EZDTStringItem"/>
        <result property="actlShpgTermCd"           column="ACTL_SHPG_TERM_CD"          javaType="EZDTStringItem"/>
        <result property="actlShpgSvcLvlCd"         column="ACTL_SHPG_SVC_LVL_CD"       javaType="EZDTStringItem"/>
        <result property="actlFrtChrgToCd"          column="ACTL_FRT_CHRG_TO_CD"        javaType="EZDTStringItem"/>
        <result property="actlFrtChrgMethCd"        column="ACTL_FRT_CHRG_METH_CD"      javaType="EZDTStringItem"/>
        <result property="carrCd"                   column="CARR_CD"                    javaType="EZDTStringItem"/>
        <result property="carrNm"                   column="CARR_NM"                    javaType="EZDTStringItem"/>
        <result property="bolNum"                   column="BOL_NUM"                    javaType="EZDTStringItem"/>
        <result property="proNum"                   column="PRO_NUM"                    javaType="EZDTStringItem"/>
        <result property="invNum"                   column="INV_NUM"                    javaType="EZDTStringItem"/>
        <result property="ccyCd"                    column="CCY_CD"                     javaType="EZDTStringItem"/>
        <result property="exchRate"                 column="EXCH_RATE"                  javaType="EZDTBigDecimalItem"/>
        <result property="ordUomQty"                column="ORD_UOM_QTY"                javaType="EZDTBigDecimalItem"/>
        <result property="rddDt"                    column="RDD_DT"                     javaType="EZDTDateItem"/>
        <result property="rsdDt"                    column="RSD_DT"                     javaType="EZDTDateItem"/>
        <result property="psdDt"                    column="PSD_DT"                     javaType="EZDTDateItem"/>
        <result property="pddDt"                    column="PDD_DT"                     javaType="EZDTDateItem"/>
        <result property="etaDt"                    column="ETA_DT"                     javaType="EZDTDateItem"/>
        <result property="actlShipDt"               column="ACTL_SHIP_DT"               javaType="EZDTDateItem"/>
        <result property="actlArvDt"                column="ACTL_ARV_DT"                javaType="EZDTDateItem"/>
        <result property="shipToLocNm"              column="SHIP_TO_LOC_NM"             javaType="EZDTStringItem"/>
        <result property="shipToAddlLocNm"          column="SHIP_TO_ADDL_LOC_NM"        javaType="EZDTStringItem"/>
        <result property="shipToFirstLineAddr"      column="SHIP_TO_FIRST_LINE_ADDR"    javaType="EZDTStringItem"/>
        <result property="shipToScdLineAddr"        column="SHIP_TO_SCD_LINE_ADDR"      javaType="EZDTStringItem"/>
        <result property="shipToThirdLineAddr"      column="SHIP_TO_THIRD_LINE_ADDR"    javaType="EZDTStringItem"/>
        <result property="shipToFrthLineAddr"       column="SHIP_TO_FRTH_LINE_ADDR"     javaType="EZDTStringItem"/>
        <result property="shipToFirstRefCmntTxt"    column="SHIP_TO_FIRST_REF_CMNT_TXT" javaType="EZDTStringItem"/>
        <result property="shipToScdRefCmntTxt"      column="SHIP_TO_SCD_REF_CMNT_TXT"   javaType="EZDTStringItem"/>
        <result property="shipToCtyAddr"            column="SHIP_TO_CTY_ADDR"           javaType="EZDTStringItem"/>
        <result property="shipToStCd"               column="SHIP_TO_ST_CD"              javaType="EZDTStringItem"/>
        <result property="shipToProvAddr"           column="SHIP_TO_PROV_ADDR"          javaType="EZDTStringItem"/>
        <result property="shipToCntyNm"             column="SHIP_TO_CNTY_NM"            javaType="EZDTStringItem"/>
        <result property="shipToPostCd"             column="SHIP_TO_POST_CD"            javaType="EZDTStringItem"/>
        <result property="shipToCtryCd"             column="SHIP_TO_CTRY_CD"            javaType="EZDTStringItem"/>
        <result property="dslpInfoFlg"              column="DSLP_INFO_FLG"              javaType="EZDTStringItem"/>
        <result property="custUomCd"                column="CUST_UOM_CD"                javaType="EZDTStringItem"/>
        <result property="rqstCarrCd"               column="RQST_CARR_CD"               javaType="EZDTStringItem"/>
        <result property="carrAcctNum"              column="CARR_ACCT_NUM"              javaType="EZDTStringItem"/>
        <result property="carrAcctShipNum"          column="CARR_ACCT_SHIP_NUM"         javaType="EZDTStringItem"/>
        <result property="shipCmntFirstLineTxt"     column="SHIP_CMNT_FIRST_LINE_TXT"   javaType="EZDTStringItem"/>
        <result property="shipCmntScdLineTxt"       column="SHIP_CMNT_SCD_LINE_TXT"     javaType="EZDTStringItem"/>
        <result property="shipCmntThirdLineTxt"     column="SHIP_CMNT_THIRD_LINE_TXT"   javaType="EZDTStringItem"/>
        <result property="shipCmntFrthLineTxt"      column="SHIP_CMNT_FRTH_LINE_TXT"    javaType="EZDTStringItem"/>
        <result property="shipAvalFlg"              column="SHIP_AVAL_FLG"              javaType="EZDTStringItem"/>
        <result property="poReqFlg"                 column="PO_REQ_FLG"                 javaType="EZDTStringItem"/>
        <result property="soCloseFlg"               column="SO_CLOSE_FLG"               javaType="EZDTStringItem"/>
        <result property="mdseCd"                   column="MDSE_CD"                    javaType="EZDTStringItem"/>
        <result property="invtyLocCd"               column="INVTY_LOC_CD"               javaType="EZDTStringItem"/>
        <result property="stkStsCd"                 column="STK_STS_CD"                 javaType="EZDTStringItem"/>
        <result property="shipCpltCd"               column="SHIP_CPLT_CD"               javaType="EZDTStringItem"/>
        <result property="uomCpltFlg"               column="UOM_CPLT_FLG"               javaType="EZDTStringItem"/>
        <result property="pmtTermCd"                column="PMT_TERM_CD"                javaType="EZDTStringItem"/>
        <result property="cashDiscTermCd"           column="CASH_DISC_TERM_CD"          javaType="EZDTStringItem"/>
        <result property="slsRepTocCd"              column="SLS_REP_TOC_CD"             javaType="EZDTStringItem"/>
        <result property="shipPlnHldFlg"            column="SHIP_PLN_HLD_FLG"           javaType="EZDTStringItem"/>
        <result property="shipPlnCancFlg"           column="SHIP_PLN_CANC_FLG"          javaType="EZDTStringItem"/>
        <result property="shipPlnCancDt"            column="SHIP_PLN_CANC_DT"           javaType="EZDTDateItem"/>
        <result property="softAllocQty"             column="SOFT_ALLOC_QTY"             javaType="EZDTBigDecimalItem"/>
        <result property="ordQty"                   column="ORD_QTY"                    javaType="EZDTBigDecimalItem"/>
        <result property="crHldQty"                 column="CR_HLD_QTY"                 javaType="EZDTBigDecimalItem"/>
        <result property="slsHldQty"                column="SLS_HLD_QTY"                javaType="EZDTBigDecimalItem"/>
        <result property="crChkQty"                 column="CR_CHK_QTY"                 javaType="EZDTBigDecimalItem"/>
        <result property="setPrcDetGrpSq"           column="SET_PRC_DET_GRP_SQ"         javaType="EZDTBigDecimalItem"/>
        <result property="setMdseCd"                column="SET_MDSE_CD"                javaType="EZDTStringItem"/>
        <result property="setItemShipCpltFlg"       column="SET_ITEM_SHIP_CPLT_FLG"     javaType="EZDTStringItem"/>
        <result property="sendEmlCpltFlg"           column="SEND_EML_CPLT_FLG"          javaType="EZDTStringItem"/>
        <result property="sysSrcCd"                 column="SYS_SRC_CD"                 javaType="EZDTStringItem"/>
        <result property="trxRsnCd"                 column="TRX_RSN_CD"                 javaType="EZDTStringItem"/>
        <result property="revRecogFlg"              column="REV_RECOG_FLG"              javaType="EZDTStringItem"/>
        <result property="exptFlg"                  column="EXPT_FLG"                   javaType="EZDTStringItem"/>
        <result property="setShpgPlnNum"            column="SET_SHPG_PLN_NUM"           javaType="EZDTStringItem"/>
        <result property="pmtTermCashDiscCd"        column="PMT_TERM_CASH_DISC_CD"      javaType="EZDTStringItem"/>
        <result property="prcCatgCd"                column="PRC_CATG_CD"                javaType="EZDTStringItem"/>
    </resultMap>
    <statement id="checkSetShpgPln" parameterClass="Map" resultClass="Map">
        SELECT 
            M.INVTY_DIST_TP_CD      INVTY_DIST_TP_CD
            ,SP.SOFT_ALLOC_QTY      SOFT_ALLOC_QTY
        FROM
             SHPG_PLN SP
            ,MDSE M 
        WHERE
	            SP.GLBL_CMPY_CD     = #glblCmpyCd#
	        AND SP.SHPG_PLN_NUM     = #setShpgPlnNum#
	        AND M.GLBL_CMPY_CD      = #glblCmpyCd#
	        AND SP.MDSE_CD          = M.MDSE_CD
	        AND M.EZCANCELFLAG      = '0'
	        AND SP.EZCANCELFLAG     = '0'
    </statement>
    <statement id="softAllocTotQty" parameterClass="Map" resultClass="Map">
        SELECT 
            SUM(SP.SOFT_ALLOC_QTY)     SUM_SOFT_ALLOC_QTY
        FROM
            SHPG_PLN SP
        WHERE
                SP.GLBL_CMPY_CD      = #glblCmpyCd#
            AND SP.SET_SHPG_PLN_NUM  = #setShpgPlnNum#
            AND SP.TRX_HDR_NUM       = #trxHdrNum#
            AND SP.TRX_LINE_NUM      = #trxLineNum#
            AND SP.TRX_LINE_SUB_NUM  = #trxLineSubNum#
            AND SP.TRX_SRC_TP_CD     = #trxSrcTpCd#
            AND SP.EZCANCELFLAG      = '0'
    </statement>
    <statement id="getHldRsnCd" parameterClass="Map" resultClass="String">
        SELECT
            HR.HLD_RSN_CD
        FROM
            HLD_RSN HR
        WHERE
                HR.GLBL_CMPY_CD     = #glblCmpyCd#
            AND HR.HLD_TP_CD        = #hldTpCd#
            AND HR.HLD_LVL_CD       = #hldLvlCd#
            AND HR.NIGHT_BAT_FLG    = #nightBatFlg#
            AND HR.DTM_BAT_FLG      = #dtmBatFlg#
            AND HR.EZCANCELFLAG     = '0'
        ORDER BY
            HR.HLD_RSN_CD
    </statement>
    <statement id="getHldInfo" parameterClass="Map" resultMap="result.HLDTMsg">
        SELECT
            H.GLBL_CMPY_CD
            ,H.HLD_RSN_CD
            ,H.HLD_DT
            ,H.TRX_SRC_TP_CD
            ,H.CPO_ORD_NUM
            ,H.CPO_DTL_LINE_NUM
            ,H.CPO_DTL_LINE_SUB_NUM
            ,H.HLD_DTL_TXT
            ,H.RVW_FLG
            ,H.REL_FLG
            ,H.REL_PSN_CD
            ,H.REL_DT
            ,H.REL_MEMO_TXT
        FROM
            HLD H
        WHERE
            H.GLBL_CMPY_CD      = #glblCmpyCd#
            AND H.HLD_RSN_CD IN
            <iterate property="hldRsnCd" var="hldRsnCd[]" open="(" close=")" conjunction=",">
                #hldRsnCd[]#
            </iterate>
            AND H.REL_FLG       = #flgOffN#
            AND H.SHPG_PLN_NUM IN
            <iterate property="delShplgPlnNumLst" var="delShplgPlnNumLst[]" open="(" close=")" conjunction=",">
                #delShplgPlnNumLst[]#
            </iterate>
            AND H.EZCANCELFLAG  = '0'
    </statement>

    <resultMap id="result.HLDTMsg" class="HLDTMsg">
        <result property="glblCmpyCd"               column="GLBL_CMPY_CD"               javaType="EZDTStringItem"/>
        <result property="hldRsnCd"                 column="HLD_RSN_CD"                 javaType="EZDTStringItem"/>
        <result property="hldDt"                    column="HLD_DT"                     javaType="EZDTStringItem"/>
        <result property="trxSrcTpCd"               column="TRX_SRC_TP_CD"              javaType="EZDTStringItem"/>
        <result property="cpoOrdNum"                column="CPO_ORD_NUM"                javaType="EZDTStringItem"/>
        <result property="cpoDtlLineNum"            column="CPO_DTL_LINE_NUM"           javaType="EZDTStringItem"/>
        <result property="cpoDtlLineSubNum"         column="CPO_DTL_LINE_SUB_NUM"       javaType="EZDTStringItem"/>
        <result property="hldDtlTxt"                column="HLD_DTL_TXT"                javaType="EZDTStringItem"/>
        <result property="rvwFlg"                   column="RVW_FLG"                    javaType="EZDTStringItem"/>
        <result property="relFlg"                   column="REL_FLG"                    javaType="EZDTStringItem"/>
        <result property="relPsnCd"                 column="REL_PSN_CD"                 javaType="EZDTStringItem"/>
        <result property="relDt"                    column="REL_DT"                     javaType="EZDTStringItem"/>
        <result property="relMemoTxt"               column="REL_MEMO_TXT"               javaType="EZDTStringItem"/>
    </resultMap>
    <statement id="queryShpgPlnEachCompForCancel" parameterClass="Map" resultClass="Map">
    
        SELECT 
              SP.GLBL_CMPY_CD               AS GLBL_CMPY_CD
            , SP.TRX_HDR_NUM                AS TRX_HDR_NUM
            , SP.TRX_LINE_NUM               AS TRX_LINE_NUM
            , SP.TRX_LINE_SUB_NUM           AS TRX_LINE_SUB_NUM
            , SP.SHPG_STS_CD                AS SHPG_STS_CD
            , SP.SHPG_PLN_NUM               AS SHPG_PLN_NUM 
            , SP.ORD_QTY                    AS ORD_QTY
            , SP.MDSE_CD                    AS MDSE_CD
            , SP.SET_MDSE_CD                AS SET_MDSE_CD
            , SP.SOFT_ALLOC_QTY             AS SOFT_ALLOC_QTY
            , SP.PO_REQ_FLG                 AS PO_REQ_FLG
        FROM
                SHPG_PLN SP
        WHERE
                SP.GLBL_CMPY_CD               = #glblCmpyCd#
            AND SP.TRX_HDR_NUM                = #trxHdrNum#
            AND SP.TRX_LINE_NUM               = #trxLineNum#
            AND SP.TRX_SRC_TP_CD              = #trxSrcTpCd#
            AND SP.SET_SHPG_PLN_NUM           = #setShpgPlnNum# 
            AND SP.TRX_LINE_SUB_NUM         &lt;&gt; #trxLineNumSet#
            AND
                            (
                                      SP.SHPG_STS_CD          = #shpgStsCdHA#
                                  OR  SP.SHPG_STS_CD          = #shpgStsCdSO#
                                  OR  SP.SHPG_STS_CD          = #shpgStsCdPO#
                                  OR  EXISTS (
                                                SELECT  *
                                                FROM    SHPG_STS SS
                                                WHERE        SP.SHPG_STS_CD         = SS.SHPG_STS_CD
                                                        AND  SP.GLBL_CMPY_CD        = SS.GLBL_CMPY_CD
                                                        AND  SS.SO_PRINT_FLG        = #on#
                                                        AND  SS.EZCANCELFLAG        = '0'  
                                             )
                         
                                  OR  EXISTS (
                                                SELECT  *
                                                FROM    MDSE M
                                                WHERE        M.GLBL_CMPY_CD         = #glblCmpyCd#
                                                        AND  SP.MDSE_CD             = M.MDSE_CD
                                                        AND  SP.SHPG_STS_CD         = #shpgStsCdVA#
                                                        AND  M.INVTY_CTRL_FLG       = #off#
                                                        AND  M.EZCANCELFLAG         = '0'
                                             )
                                  OR  (
                                            SP.SHPG_STS_CD        = #shpgStsCdVA#
                                        AND SP.PO_REQ_FLG         = #on#
                                      )
                            )
            AND SP.EZCANCELFLAG           = '0'
        ORDER BY
                SP.TRX_HDR_NUM
            ,   SP.TRX_LINE_NUM
            ,   SP.TRX_LINE_SUB_NUM
            ,   SP.SHPG_STS_CD DESC
            ,   SP.SHPG_PLN_NUM
            
    </statement>
    <statement id="getShpgLvlSalesHold" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            H.HLD_PK
        FROM
              HLD H
            , HLD_RSN HR
        WHERE
                H.GLBL_CMPY_CD  = #glblCmpyCd#
            AND H.SHPG_PLN_NUM  = #shpgPlnNum#
            AND HR.GLBL_CMPY_CD = H.GLBL_CMPY_CD
            AND HR.HLD_RSN_CD   = H.HLD_RSN_CD
            AND HR.HLD_LVL_CD   = #hldLvlCd#
            AND HR.HLD_TP_CD    = #hldTpCd#
            AND H.EZCANCELFLAG  = '0'
            AND HR.EZCANCELFLAG = '0'
    </statement>
    <statement id="getVendorDrop" parameterClass="Map" resultClass="Map">
        SELECT 
                 SP.SHPG_PLN_NUM 
                ,SP.TRX_LINE_SUB_NUM
                ,SP.SET_SHPG_PLN_NUM
        FROM 
                SHPG_PLN SP
        WHERE
                SP.GLBL_CMPY_CD         = #glblCmpyCd#
            AND SP.TRX_HDR_NUM          = #trxHdrNum#
            AND SP.TRX_LINE_NUM         = #trxLineNum#
            AND SP.SET_SHPG_PLN_NUM     = #setShpgPlnNum#
            AND SP.SHPG_STS_CD          = #shpgStsCdVA#
            AND SP.PO_REQ_FLG           = #on#
            AND SP.EZCANCELFLAG = '0'
        ORDER BY
            SP.TRX_LINE_SUB_NUM
    </statement>
    <statement id="getIntangible" parameterClass="Map" resultClass="Map">
        SELECT 
                 SP.SHPG_PLN_NUM 
                ,SP.TRX_LINE_SUB_NUM
                ,SP.SET_SHPG_PLN_NUM 
        FROM 
                 SHPG_PLN SP
                ,MDSE M
        WHERE
                SP.GLBL_CMPY_CD         = #glblCmpyCd#
            AND SP.TRX_HDR_NUM          = #trxHdrNum#
            AND SP.TRX_LINE_NUM         = #trxLineNum#
            AND SP.SET_SHPG_PLN_NUM     = #setShpgPlnNum#
            AND SP.SHPG_STS_CD          = #shpgStsCdVA# 
            AND M.GLBL_CMPY_CD          = #glblCmpyCd#
            AND SP.MDSE_CD              = M.MDSE_CD 
            AND M.INVTY_CTRL_FLG        = #off#
            AND SP.EZCANCELFLAG         = '0'
            AND M.EZCANCELFLAG          = '0'
        ORDER BY
            SP.TRX_LINE_SUB_NUM
    </statement>
<!-- 2015/09/10 CNA(2.8 Allocation - SO/PO) Add End -->
<!-- 2015/09/10 CNA(2.9 Revenue Recognition) Add Start -->
    <statement id="getPodOrder" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(C.CPO_ORD_NUM) CNT
        FROM
            CPO C
        WHERE
            C.GLBL_CMPY_CD = #glblCmpyCd#
            AND C.CPO_ORD_NUM = #cpoOrdNum#
            AND C.REV_RECOG_METH_CD = #revRecogMethCdPOD#
            AND C.EZCANCELFLAG = '0'
    </statement>
    <statement id="getDeliveryBasicInConfig" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(CD.CPO_ORD_NUM) REC_CNT
        FROM
            CPO_DTL         CD
            ,DS_CPO_CONFIG  DCC
            ,DS_MDL         DM
        WHERE
            CD.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND CD.CPO_ORD_NUM              = #cpoOrdNum#
            AND CD.CPO_DTL_LINE_NUM         = #cpoDtlLineNum#
            AND CD.CPO_DTL_LINE_SUB_NUM     = #cpoDtlLineSubNum#
            AND CD.GLBL_CMPY_CD             = DCC.GLBL_CMPY_CD
            AND CD.DS_CPO_CONFIG_PK         = DCC.DS_CPO_CONFIG_PK
            AND DCC.GLBL_CMPY_CD            = DM.GLBL_CMPY_CD
            AND DCC.MDL_ID                  = DM.MDL_ID
            AND DM.SVC_ISTL_REQ_FLG         = #flgOnY#
            AND CD.EZCANCELFLAG             = '0'
            AND DCC.EZCANCELFLAG            = '0'
            AND DM.EZCANCELFLAG             = '0'
    </statement>
    <statement id="getShpgPlnDplyLineMum" parameterClass="Map" resultClass="Integer">
        SELECT 
                nvl(MAX(SP.SHPG_PLN_DPLY_LINE_NUM),0)  AS MAX_NUM
        FROM 
                SHPG_PLN SP
        WHERE
                SP.GLBL_CMPY_CD = #glblCmpyCd#
            AND SP.TRX_HDR_NUM = #trxHdrNum#
            AND SP.TRX_LINE_NUM = #trxLineNum#
            AND SP.TRX_LINE_SUB_NUM = #trxLineSubNum#
    </statement>
<!-- 2015/09/10 CNA(2.9 Revenue Recognition) Add End -->

    <statement id="existOrdCatgBizCtx" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(1)
        FROM
            ORD_CATG_BIZ_CTX     OCBC       -- Order Category Business Context
        WHERE
            OCBC.EZCANCELFLAG               = '0'
            AND OCBC.GLBL_CMPY_CD           = #glblCmpyCd#
            AND OCBC.ORD_CATG_CTX_TP_CD     = #ordCatgCtxTpCd#
            AND 
            (
                (
                    OCBC.DS_ORD_CATG_CD     = #dsOrdCatgCd#
                    AND OCBC.DS_ORD_TP_CD   = #dsOrdTpCd#
                    AND OCBC.DS_ORD_RSN_CD  = #dsOrdRsnCd#
                )
                OR
                (
                    OCBC.DS_ORD_CATG_CD     = #dsOrdCatgCd#
                    AND OCBC.DS_ORD_TP_CD   = #dsOrdTpCd#
                    AND OCBC.DS_ORD_RSN_CD  IS NULL
                )
                OR
                (
                    OCBC.DS_ORD_CATG_CD     = #dsOrdCatgCd#
                    AND OCBC.DS_ORD_TP_CD   IS NULL
                    AND OCBC.DS_ORD_RSN_CD  IS NULL
                )
            )
    </statement>

    <statement id="getLoanBalanceQty" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            CD.LOAN_BAL_QTY                  -- Count for ON LOAN status
        FROM
            CPO_DTL                CD        -- CPO Detail
            ,DS_ORD_LINE_PROC_DFN  DOLPD     -- Direct Sales Order Line Process Definition
            ,ORD_PROC_TP           OPT       -- Order Process Type
        WHERE
            CD.EZCANCELFLAG            = '0'
            AND CD.GLBL_CMPY_CD        = #glblCmpyCd#
            AND CD.CPO_ORD_NUM         = #cpoOrdNum#
            AND CD.CPO_DTL_LINE_NUM    = #cpoDtlLineNum#
            AND CD.CPO_DTL_LINE_SUB_NUM = #cpoDtlLineSubNum#
            AND CD.EZCANCELFLAG        = DOLPD.EZCANCELFLAG
            AND CD.GLBL_CMPY_CD        = DOLPD.GLBL_CMPY_CD
            AND DOLPD.DS_ORD_TP_CD     = #dsOrdTpCd#
            AND CD.DS_ORD_LINE_CATG_CD = DOLPD.DS_ORD_LINE_CATG_CD
            AND CD.EZCANCELFLAG        = OPT.EZCANCELFLAG
            AND CD.GLBL_CMPY_CD        = OPT.GLBL_CMPY_CD
            AND OPT.ORD_PROC_TP_CD     = DOLPD.ORD_PROC_TP_CD
            AND OPT.OUT_OF_WH_INVTY_PROC_FLG = 'Y'
    </statement>

    <!-- 2023/06/02 QC#61383 Add Start -->
    <statement id="getShpgSts" parameterClass="Map" resultClass="Map">
       SELECT
           A.SHPG_STS_CD
          ,B.CPO_ORD_NUM
          ,B.DS_ORD_CATG_CD
          ,B.DS_ORD_TP_CD
          ,B.DS_ORD_RSN_CD
       FROM
           SHPG_PLN A
          ,CPO      B
       WHERE
           A.GLBL_CMPY_CD      = #glblCmpyCd#
       AND A.EZCANCELFLAG      = '0'
       AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD
       AND B.EZCANCELFLAG      = '0'
       AND A.TRX_HDR_NUM       = B.CPO_ORD_NUM
       AND A.SHPG_PLN_NUM      = #shpgPlnNum#
    </statement>

    <statement id="getTargetOrdCatgBizCtx" parameterClass="Map" resultClass="BigDecimal">
       SELECT 
           Count(*)
       FROM
           ORD_CATG_BIZ_CTX OCBC
       WHERE
           OCBC.GLBL_CMPY_CD        = #glblCmpyCd#
       AND OCBC.EZCANCELFLAG        = '0'
       AND OCBC.ORD_CATG_CTX_TP_CD  = #ordCatgCtxTpCd#
       AND OCBC.DS_ORD_CATG_CD      = #dsOrdCatgCd# 
       <isNotNull property="dsOrdTpCd">
            AND (OCBC.DS_ORD_TP_CD = #dsOrdTpCd# OR OCBC.DS_ORD_TP_CD IS NULL)
       </isNotNull>
        <isNull property="dsOrdTpCd">
            AND OCBC.DS_ORD_TP_CD IS NULL
        </isNull>
       <isNotNull property="dsOrdRsnCd">
            AND (OCBC.DS_ORD_RSN_CD = #dsOrdRsnCd# OR OCBC.DS_ORD_RSN_CD IS NULL)
       </isNotNull>
       <isNull property="dsOrdRsnCd">
            AND OCBC.DS_ORD_RSN_CD IS NULL
       </isNull>
    </statement> 

    <statement id="getDsCondConst" parameterClass="Map" resultClass="String">
       SELECT
           A.DS_COND_CONST_VAL_TXT_02
       FROM
           DS_COND_CONST A
       WHERE
           A.GLBL_CMPY_CD             = #glblCmpyCd#
       AND A.EZCANCELFLAG             = '0'
       AND A.DS_COND_CONST_GRP_ID     = #dsCondConstGrpId#
       AND A.DS_COND_CONST_VAL_TXT_01 = #dsCondConstValTxt01#
    </statement>

    <statement id="getCustNtfyShipInfoCount" parameterClass="Map" resultClass="BigDecimal">
       SELECT
           Count(*)
       FROM
           CUST_NTFY_SHIP_INFO A
       WHERE
           A.GLBL_CMPY_CD      = #glblCmpyCd#
       AND A.EZCANCELFLAG      = '0'
       AND A.CPO_ORD_NUM       = #cpoOrdNum#
       AND A.SHPG_PLN_NUM      = #shpgPlnNum#
    </statement>
    <!-- 2023/06/02 QC#61383 Add End -->
</sqlMap>
