<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NLCL0280Query">

    <statement id="getTrxCodeList" parameterClass="Map" resultClass="Map">
        SELECT
            TRX_CD
           ,TRX_CD || ':' || TRX_DESC_TXT AS TRX_DESC_TXT
        FROM
            TRX
        WHERE
            GLBL_CMPY_CD  = #glblCmpyCd#
        AND INVTY_TRX_FLG = #invtyTrxFlg#
        AND EZCANCELFLAG  = '0'
        ORDER BY
            TRX_CD
    </statement>

    <statement id="selectTrxCodeList" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            T.TRX_CD
           ,T.TRX_CD || ':' || T.TRX_DESC_TXT AS TRX_DESC_TXT
        FROM
            TRX T
           ,DS_COND_CONST DCC
        WHERE
            DCC.GLBL_CMPY_CD             = #glblCmpyCd#
        AND DCC.DS_COND_CONST_GRP_ID     = #dsCondConstGrpId#
        AND DCC.DS_COND_CONST_VAL_TXT_01 = #trxTpCd#
        AND DCC.EZCANCELFLAG             = '0'
        AND T.GLBL_CMPY_CD               = DCC.GLBL_CMPY_CD
        AND T.TRX_CD                     = DCC.DS_COND_CONST_VAL_TXT_02
        AND T.INVTY_TRX_FLG              = #invtyTrxFlg#
        AND T.EZCANCELFLAG               = '0'
        ORDER BY
            T.TRX_CD
    </statement>
    
    <statement id="selectTrxRsnCodeList" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            TR.TRX_CD
           ,TR.TRX_RSN_CD
           ,TR.TRX_RSN_CD || ':' || TR.TRX_RSN_DESC_TXT AS TRX_RSN_DESC_TXT
        FROM
            TRX_RSN TR
           ,DS_COND_CONST DCC
        WHERE
            DCC.GLBL_CMPY_CD             = #glblCmpyCd#
        AND DCC.DS_COND_CONST_GRP_ID     = #dsCondConstGrpId#
        AND DCC.DS_COND_CONST_VAL_TXT_01 = #trxTpCd#
        AND DCC.EZCANCELFLAG             = '0'
        AND TR.GLBL_CMPY_CD              = DCC.GLBL_CMPY_CD
        AND TR.TRX_CD                    = DCC.DS_COND_CONST_VAL_TXT_02
        AND TR.TRX_RSN_CD                = DCC.DS_COND_CONST_VAL_TXT_03
        AND TR.INVTY_TRX_FLG             = #invtyTrxFlg#
        AND TR.EZCANCELFLAG              = '0'
        ORDER BY
            TR.TRX_CD
           ,TR.TRX_RSN_CD
    </statement>

    <statement id="selectTrxRsnCodeListNoTrxTp" parameterClass="Map" resultClass="Map">
        SELECT
            TR.TRX_CD
           ,TR.TRX_RSN_CD
           ,TR.TRX_RSN_CD || ':' || TR.TRX_RSN_DESC_TXT AS TRX_RSN_DESC_TXT
        FROM
            TRX_RSN TR
        WHERE
            TR.GLBL_CMPY_CD              = #glblCmpyCd#
        AND TR.TRX_CD                    = #trxCd#
        AND TR.INVTY_TRX_FLG             = #invtyTrxFlg#
        AND TR.EZCANCELFLAG              = '0'
        ORDER BY
            TR.TRX_CD
           ,TR.TRX_RSN_CD
    </statement>

    <statement id="selectTrxRsnCodeListHasTrxTp" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            TR.TRX_CD
           ,TR.TRX_RSN_CD
           ,TR.TRX_RSN_CD || ':' || TR.TRX_RSN_DESC_TXT AS TRX_RSN_DESC_TXT
        FROM
            TRX_RSN TR
           ,DS_COND_CONST DCC
        WHERE
            TR.GLBL_CMPY_CD              = #glblCmpyCd#
        AND TR.TRX_CD                    = #trxCd#
        AND TR.INVTY_TRX_FLG             = #invtyTrxFlg#
        AND TR.EZCANCELFLAG              = '0'
        AND DCC.GLBL_CMPY_CD             = TR.GLBL_CMPY_CD
        AND DCC.DS_COND_CONST_GRP_ID     = #dsCondConstGrpId#
        AND DCC.DS_COND_CONST_VAL_TXT_01 = #trxTpCd#
        AND DCC.DS_COND_CONST_VAL_TXT_02 = TR.TRX_CD
        AND DCC.DS_COND_CONST_VAL_TXT_03 = TR.TRX_RSN_CD
        AND DCC.EZCANCELFLAG             = '0'
        ORDER BY
            TR.TRX_CD
           ,TR.TRX_RSN_CD
    </statement>

    <statement id="getTrxTypeList" parameterClass="Map" resultClass="Map">
        SELECT
            INVTY_TRX_TP_CD
           ,INVTY_TRX_TP_DESC_TXT
        FROM
            INVTY_TRX_TP
        WHERE
            GLBL_CMPY_CD  = #glblCmpyCd#
        AND EZCANCELFLAG  = '0'
        ORDER BY
            INVTY_TRX_TP_SORT_NUM
    </statement>

    <statement id="getLocStsList" parameterClass="Map" resultClass="Map">
        SELECT
            LS.LOC_STS_CD
           ,LS.LOC_STS_CD || ':' || LS.LOC_STS_DESC_TXT AS LOC_STS_DESC_TXT
        FROM
            LOC_STS       LS
           ,DS_COND_CONST DCC
        WHERE
            LS.GLBL_CMPY_CD          = #glblCmpyCd#
        AND LS.EZCANCELFLAG          = '0'
        AND DCC.GLBL_CMPY_CD         = LS.GLBL_CMPY_CD
        AND DCC.DS_COND_CONST_GRP_ID = #dsCondConstGrpId#
        AND DCC.DS_COND_CONST_CD     = LS.LOC_STS_CD
        AND DCC.EZCANCELFLAG         = '0'
        ORDER BY
            LS.LOC_STS_SORT_NUM
    </statement>

    <statement id="getVndNm" parameterClass="Map" resultClass="String">
        SELECT
            DPLY_VND_NM
        FROM
            PO_VND_V
        WHERE
            GLBL_CMPY_CD  = #glblCmpyCd#
        AND VND_CD        = #vndCd#
        AND EZCANCELFLAG  = '0'
    </statement>

    <statement id="getShipToLocationInfo" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            RW.RTL_WH_CD AS LOC_CD
           ,RW.RTL_WH_NM AS LOC_NM
           ,LT.LOC_TP_CD
           ,LT.LOC_TP_NM
           ,TRIM(RW.FIRST_LINE_ADDR || ' ' || RW.SCD_LINE_ADDR) AS LINE_ADDR
           ,RW.CTY_ADDR
           ,RW.ST_CD
           ,RW.POST_CD
        FROM
            RTL_WH  RW
           ,RTL_SWH RSW
           ,WH      W
           ,LOC_TP  LT
        WHERE
            RW.GLBL_CMPY_CD  = #glblCmpyCd#
        AND RW.RTL_WH_CD     = #shipToLocCd#
        AND RW.EZCANCELFLAG  = '0'
        AND RW.GLBL_CMPY_CD  = RSW.GLBL_CMPY_CD
        AND RW.RTL_WH_CD     = RSW.RTL_WH_CD
        AND RSW.EZCANCELFLAG = '0'
        AND RSW.GLBL_CMPY_CD = W.GLBL_CMPY_CD
        AND RSW.INVTY_LOC_CD = W.WH_CD
        AND W.EZCANCELFLAG   = '0'
        AND W.GLBL_CMPY_CD   = LT.GLBL_CMPY_CD
        AND W.LOC_GRP_CD     = LT.LOC_GRP_CD
        AND W.LOC_ROLE_TP_CD = LT.LOC_ROLE_TP_CD
        AND LT.EZCANCELFLAG  = '0'
        -- RETAIL WAREHOUSE (DUMMY)
        UNION
        SELECT DISTINCT
            RW.RTL_WH_CD AS LOC_CD
           ,RW.RTL_WH_NM AS LOC_NM
           ,LT.LOC_TP_CD
           ,LT.LOC_TP_NM
           ,TRIM(RW.FIRST_LINE_ADDR || ' ' || RW.SCD_LINE_ADDR) AS LINE_ADDR
           ,RW.CTY_ADDR
           ,RW.ST_CD
           ,RW.POST_CD
        FROM
            RTL_WH RW
           ,WH     W
           ,LOC_TP LT
        WHERE
            RW.GLBL_CMPY_CD  = #glblCmpyCd#
        AND RW.RTL_WH_CD     = #shipToLocCd#
        AND RW.EZCANCELFLAG  = '0'
        AND RW.GLBL_CMPY_CD  = W.GLBL_CMPY_CD
        AND RW.RTL_WH_CD     = W.WH_CD
        AND W.EZCANCELFLAG   = '0'
        AND W.GLBL_CMPY_CD   = LT.GLBL_CMPY_CD
        AND W.LOC_GRP_CD     = LT.LOC_GRP_CD
        AND W.LOC_ROLE_TP_CD = LT.LOC_ROLE_TP_CD
        AND LT.EZCANCELFLAG  = '0'
        -- TECH
        UNION
        SELECT DISTINCT
            RW.RTL_WH_CD AS LOC_CD
           ,RW.RTL_WH_NM AS LOC_NM
           ,LT.LOC_TP_CD
           ,LT.LOC_TP_NM
           ,TRIM(RW.FIRST_LINE_ADDR || ' ' || RW.SCD_LINE_ADDR) AS LINE_ADDR
           ,RW.CTY_ADDR
           ,RW.ST_CD
           ,RW.POST_CD
        FROM
            RTL_WH   RW
           ,RTL_SWH  RSW
           ,TECH_LOC TL
           ,LOC_TP   LT
        WHERE
            RW.GLBL_CMPY_CD   = #glblCmpyCd#
        AND RW.RTL_WH_CD      = #shipToLocCd#
        AND RW.EZCANCELFLAG   = '0'
        AND RW.GLBL_CMPY_CD   = RSW.GLBL_CMPY_CD
        AND RW.RTL_WH_CD      = RSW.RTL_WH_CD
        AND RSW.EZCANCELFLAG  = '0'
        AND RSW.GLBL_CMPY_CD  = TL.GLBL_CMPY_CD
        AND RSW.INVTY_LOC_CD  = TL.TECH_LOC_CD
        AND TL.EZCANCELFLAG   = '0'
        AND TL.GLBL_CMPY_CD   = LT.GLBL_CMPY_CD
        AND TL.LOC_GRP_CD     = LT.LOC_GRP_CD
        AND TL.LOC_ROLE_TP_CD = LT.LOC_ROLE_TP_CD
        AND LT.EZCANCELFLAG   = '0'
        -- VENDOR
        UNION
        SELECT
            V.VND_CD        AS LOC_CD
           ,PVV.DPLY_VND_NM AS LOC_NM
           ,LT.LOC_TP_CD
           ,LT.LOC_TP_NM
           ,TRIM(V.FIRST_LINE_ADDR || ' ' || V.SCD_LINE_ADDR) AS LINE_ADDR
           ,V.CTY_ADDR
           ,V.ST_CD
           ,V.POST_CD
        FROM
            VND      V
           ,LOC_TP   LT
           ,PO_VND_V PVV
        WHERE
            V.GLBL_CMPY_CD   = #glblCmpyCd#
        AND V.VND_CD         = #shipToLocCd#
        AND V.EZCANCELFLAG   = '0'
        AND V.GLBL_CMPY_CD   = LT.GLBL_CMPY_CD
        AND V.LOC_GRP_CD     = LT.LOC_GRP_CD
        AND V.LOC_ROLE_TP_CD = LT.LOC_ROLE_TP_CD
        AND LT.EZCANCELFLAG  = '0'
        AND V.GLBL_CMPY_CD   = PVV.GLBL_CMPY_CD
        AND V.VND_CD         = PVV.VND_CD
        AND PVV.EZCANCELFLAG = '0'
        -- SHIP TO CUSTOMER
        UNION
        SELECT
            ST.SHIP_TO_CUST_CD AS LOC_CD
           ,DAC.DS_ACCT_NM     AS LOC_NM
           ,LT.LOC_TP_CD
           ,LT.LOC_TP_NM
           ,TRIM(ST.FIRST_LINE_ADDR || ' ' || ST.SCD_LINE_ADDR) AS LINE_ADDR
           ,ST.CTY_ADDR
           ,ST.ST_CD
           ,ST.POST_CD
        FROM
            SHIP_TO_CUST ST
           ,SELL_TO_CUST DAC
           ,LOC_TP       LT
        WHERE
            ST.GLBL_CMPY_CD    = #glblCmpyCd#
        AND ST.SHIP_TO_CUST_CD = #shipToLocCd#
        AND ST.EZCANCELFLAG    = '0'
        AND ST.GLBL_CMPY_CD    = DAC.GLBL_CMPY_CD
        AND ST.SELL_TO_CUST_CD = DAC.SELL_TO_CUST_CD
        AND DAC.EZCANCELFLAG   = '0'
        AND ST.GLBL_CMPY_CD    = LT.GLBL_CMPY_CD
        AND ST.LOC_GRP_CD      = LT.LOC_GRP_CD
        AND ST.LOC_ROLE_TP_CD  = LT.LOC_ROLE_TP_CD
        AND LT.EZCANCELFLAG    = '0'
        AND NOT EXISTS (SELECT
                            1
                        FROM
                            RTL_WH NR
                        WHERE
                            NR.GLBL_CMPY_CD = ST.GLBL_CMPY_CD
                        AND NR.RTL_WH_CD    = ST.SHIP_TO_CUST_CD
                        AND NR.EZCANCELFLAG = '0')
        AND NOT EXISTS (SELECT
                            1
                        FROM
                            WH NW
                        WHERE
                            NW.GLBL_CMPY_CD = ST.GLBL_CMPY_CD
                        AND NW.WH_CD        = ST.SHIP_TO_CUST_CD
                        AND NW.EZCANCELFLAG = '0')
        AND NOT EXISTS (SELECT
                            1
                        FROM
                            TECH_LOC NT
                        WHERE
                            NT.GLBL_CMPY_CD = ST.GLBL_CMPY_CD
                        AND NT.TECH_LOC_CD  = ST.SHIP_TO_CUST_CD
                        AND NT.EZCANCELFLAG = '0')
        AND NOT EXISTS (SELECT
                            1
                        FROM
                            VND NV
                        WHERE
                            NV.GLBL_CMPY_CD = ST.GLBL_CMPY_CD
                        AND NV.VND_CD       = ST.SHIP_TO_CUST_CD
                        AND NV.EZCANCELFLAG = '0')
        AND NOT EXISTS (SELECT
                            1
                        FROM
                            BR B
                        WHERE
                            B.GLBL_CMPY_CD = ST.GLBL_CMPY_CD
                        AND B.BR_CD        = ST.SHIP_TO_CUST_CD
                        AND B.EZCANCELFLAG = '0')
        ORDER BY
            LOC_CD
    </statement>

    <statement id="getInvtyTrx" parameterClass="Map" resultClass="Map">
        <!-- Inventory Trx Detail  -->
        WITH INVTY_TRX_DTL AS (
            SELECT /*+ OPTIMIZER_FEATURES_ENABLE('10.2.0.5') */ 
                IT.GLBL_CMPY_CD
               ,IT.INVTY_TRX_PK
               ,IT.INVTY_TRX_DT
               ,IT.MDSE_CD
               ,MD.MDSE_DESC_SHORT_TXT
               ,MD.COA_MDSE_TP_CD
               ,PJ.COA_PROJ_CD
               ,PJ.COA_PROJ_DESC_TXT
               ,MD.MDSE_ITEM_TP_CD
               ,MIT.MDSE_ITEM_TP_DESC_TXT
               ,MD.COA_PROD_CD
               ,CP.COA_PROD_DESC_TXT
               ,PD.ASL_MDSE_CD AS SPLY_ITEM_NUM
               ,MD.MNF_ITEM_CD
               ,DILV.RTL_WH_CD
               ,DILV.RTL_WH_NM
               ,DILV.RTL_SWH_CD
               ,IT.INVTY_LOC_CD
               ,IT.LOC_STS_CD
               ,LS.LOC_STS_DESC_TXT
               ,IT.STK_STS_CD
               ,SS.STK_STS_DESC_TXT
               ,IT.INVTY_TRX_QTY
               ,IT.TRX_CD
               ,TR.TRX_DESC_TXT
               ,IT.TRX_RSN_CD
               ,TRS.TRX_RSN_DESC_TXT
               ,TRS.AJE_LINK_FLG
               ,IT.TRIAL_LOAN_MSTR_PK AS SVC_CONFIG_MSTR_PK
               ,(SELECT MN.T_MDL_NM FROM SVC_CONFIG_MSTR SCM, MDL_NM MN WHERE IT.GLBL_CMPY_CD = SCM.GLBL_CMPY_CD AND IT.TRIAL_LOAN_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK AND SCM.EZCANCELFLAG = '0' AND SCM.GLBL_CMPY_CD = MN.T_GLBL_CMPY_CD AND SCM.MDL_ID = MN.T_MDL_ID AND MN.EZCANCELFLAG = '0' AND ROWNUM = 1) AS MDL_NM
               ,IT.INVTY_TRX_SLP_NUM  AS SRC_ORD_NUM
               ,CASE WHEN IT.PO_ORD_NUM     IS NOT NULL THEN PD.DISP_PO_DTL_LINE_NUM
                     WHEN EXISTS (SELECT 1 FROM DS_CPO_RTRN_DTL DCRD WHERE IT.GLBL_CMPY_CD = DCRD.GLBL_CMPY_CD AND IT.CPO_ORD_NUM = DCRD.CPO_ORD_NUM AND IT.CPO_DTL_LINE_NUM = DCRD.DS_CPO_RTRN_LINE_NUM AND IT.CPO_DTL_LINE_SUB_NUM = DCRD.DS_CPO_RTRN_LINE_SUB_NUM AND DCRD.EZCANCELFLAG = '0') 
                          THEN (SELECT CONCAT(DCRD.DS_ORD_POSN_NUM, '.') || CONCAT(DCRD.DS_CPO_LINE_NUM, DECODE(DCRD.DS_CPO_LINE_SUB_NUM, NULL, '', '.')) || DCRD.DS_CPO_LINE_SUB_NUM FROM DS_CPO_RTRN_DTL DCRD WHERE IT.GLBL_CMPY_CD = DCRD.GLBL_CMPY_CD AND IT.CPO_ORD_NUM = DCRD.CPO_ORD_NUM AND IT.CPO_DTL_LINE_NUM = DCRD.DS_CPO_RTRN_LINE_NUM AND IT.CPO_DTL_LINE_SUB_NUM = DCRD.DS_CPO_RTRN_LINE_SUB_NUM AND DCRD.EZCANCELFLAG = '0' AND ROWNUM = 1)
                     WHEN EXISTS (SELECT 1 FROM CPO_DTL CD WHERE IT.GLBL_CMPY_CD = CD.GLBL_CMPY_CD AND IT.CPO_ORD_NUM = CD.CPO_ORD_NUM AND IT.CPO_DTL_LINE_NUM = CD.CPO_DTL_LINE_NUM AND IT.CPO_DTL_LINE_SUB_NUM = CD.CPO_DTL_LINE_SUB_NUM AND CD.EZCANCELFLAG = '0')
                          THEN  (SELECT CONCAT(CD.DS_ORD_POSN_NUM, '.') || CONCAT(CD.DS_CPO_LINE_NUM, DECODE(CD.DS_CPO_LINE_SUB_NUM, NULL, '', '.')) || CD.DS_CPO_LINE_SUB_NUM FROM CPO_DTL CD WHERE IT.GLBL_CMPY_CD = CD.GLBL_CMPY_CD AND IT.CPO_ORD_NUM = CD.CPO_ORD_NUM AND IT.CPO_DTL_LINE_NUM = CD.CPO_DTL_LINE_NUM AND IT.CPO_DTL_LINE_SUB_NUM = CD.CPO_DTL_LINE_SUB_NUM AND CD.EZCANCELFLAG = '0' AND ROWNUM = 1)
                     WHEN IT.VND_RTRN_NUM   IS NOT NULL THEN IT.TRX_LINE_NUM || '.' || TO_CHAR(TO_NUMBER(IT.TRX_LINE_SUB_NUM))
                     WHEN IT.WRK_ORD_NUM    IS NOT NULL THEN IT.WRK_ORD_LINE_NUM
                     WHEN IT.TRX_LINE_NUM   IS NOT NULL THEN IT.TRX_LINE_NUM || '.' || TO_CHAR(TO_NUMBER(IT.TRX_LINE_SUB_NUM))
                     WHEN IT.INVTY_ORD_NUM  IS NOT NULL THEN IT.INVTY_ORD_LINE_NUM
                END
                AS SRC_ORD_LINE_NUM
               ,CASE WHEN IT.SELL_TO_CUST_CD IS NOT NULL THEN (SELECT STC.DS_ACCT_NM FROM SELL_TO_CUST STC WHERE IT.GLBL_CMPY_CD = STC.GLBL_CMPY_CD AND IT.SELL_TO_CUST_CD = STC.SELL_TO_CUST_CD AND STC.EZCANCELFLAG = '0' AND ROWNUM = 1)
                     WHEN IT.VND_CD          IS NOT NULL THEN (SELECT V.DPLY_VND_NM FROM PO_VND_V V WHERE IT.GLBL_CMPY_CD = V.GLBL_CMPY_CD AND IT.VND_CD = V.VND_CD AND V.EZCANCELFLAG = '0' AND ROWNUM = 1)
                     WHEN IT.LOC_TP_CD = '06'            THEN (SELECT TM.TECH_NM FROM TECH_LOC TL, TECH_MSTR TM WHERE IT.GLBL_CMPY_CD = TL.GLBL_CMPY_CD AND IT.INVTY_LOC_CD = TL.TECH_LOC_CD AND TL.EZCANCELFLAG = '0' AND TL.GLBL_CMPY_CD = TM.GLBL_CMPY_CD AND TL.TECH_TOC_CD = TM.TECH_TOC_CD AND TM.EZCANCELFLAG = '0' AND ROWNUM = 1)
                     ELSE LST.DS_ACCT_NM
                END
                AS PARTY_NM
               ,CASE WHEN EXISTS (SELECT 1 FROM MDSE M WHERE M.GLBL_CMPY_CD = M.GLBL_CMPY_CD AND M.MDSE_CD = IT.MDSE_CD AND M.SHPG_SER_TAKE_FLG = 'N' AND M.RCV_SER_TAKE_FLG = 'N' AND M.EZCANCELFLAG = '0') THEN 'N'
                     WHEN EXISTS (SELECT 1 FROM SER_TRX ST WHERE ST.GLBL_CMPY_CD = IT.GLBL_CMPY_CD AND ST.SER_TRX_SRC_HDR_NUM = IT.SO_NUM        AND ST.SER_TRX_SRC_LINE_NUM = IT.SO_SLP_NUM         AND ST.EZCANCELFLAG = '0') THEN 'Y'
                     WHEN EXISTS (SELECT 1 FROM SER_TRX ST WHERE ST.GLBL_CMPY_CD = IT.GLBL_CMPY_CD AND ST.SER_TRX_SRC_HDR_NUM = IT.RWS_NUM       AND ST.SER_TRX_SRC_LINE_NUM = IT.RWS_DTL_LINE_NUM   AND ST.EZCANCELFLAG = '0') THEN 'Y'
                     WHEN EXISTS (SELECT 1 FROM SER_TRX ST WHERE ST.GLBL_CMPY_CD = IT.GLBL_CMPY_CD AND ST.SER_TRX_SRC_HDR_NUM = IT.INVTY_ORD_NUM AND ST.SER_TRX_SRC_LINE_NUM = IT.INVTY_ORD_LINE_NUM AND ST.EZCANCELFLAG = '0') THEN 'Y'
                     ELSE 'N'
                END AS SER_TRX_FLG
               ,CASE WHEN EXISTS (SELECT 1 FROM MDSE_ITEM_FLIP_SET MIFS WHERE MIFS.GLBL_CMPY_CD = IT.GLBL_CMPY_CD AND MIFS.MDSE_CD = IT.MDSE_CD AND MIFS.EZCANCELFLAG = '0') THEN 'Y'
                     ELSE 'N'
                END AS ITEM_FLIP_FLG
               ,(SELECT IO.ADJ_TRX_TP_CD FROM INVTY_ORD IO WHERE IT.GLBL_CMPY_CD = IO.GLBL_CMPY_CD AND IT.INVTY_ORD_NUM = IO.INVTY_ORD_NUM AND IO.EZCANCELFLAG = '0' AND ROWNUM = 1) AS ADJ_TRX_TP_CD
               ,(SELECT P.DS_PO_TP_CD FROM PO P WHERE IT.PO_ORD_NUM = P.PO_ORD_NUM AND P.EZCANCELFLAG = '0' AND ROWNUM = 1) AS DS_PO_TP_CD
               ,(
                   SELECT
                       ILVF.LOC_TP_CD
                   FROM
                        SHIP_TO_CUST STCF
                       ,LOC_TP       ILVF
                   WHERE
                       IT.GLBL_CMPY_CD          = STCF.GLBL_CMPY_CD
                   AND IT.SHIP_FROM_LOC_CUST_CD = STCF.SHIP_TO_CUST_CD
                   AND STCF.EZCANCELFLAG        = '0'
                   AND STCF.GLBL_CMPY_CD        = ILVF.GLBL_CMPY_CD
                   AND STCF.LOC_GRP_CD          = ILVF.LOC_GRP_CD
                   AND STCF.LOC_ROLE_TP_CD      = ILVF.LOC_ROLE_TP_CD
                   AND ILVF.EZCANCELFLAG        = '0'
                ) AS FROM_INVTY_LOC_TP_CD
               ,(
                   SELECT
                       ILVT.LOC_TP_CD
                   FROM
                        SHIP_TO_CUST STCT
                       ,LOC_TP       ILVT
                   WHERE
                       IT.GLBL_CMPY_CD          = STCT.GLBL_CMPY_CD
                   AND IT.SHIP_TO_LOC_CUST_CD   = STCT.SHIP_TO_CUST_CD
                   AND STCT.EZCANCELFLAG        = '0'
                   AND STCT.GLBL_CMPY_CD        = ILVT.GLBL_CMPY_CD
                   AND STCT.LOC_GRP_CD          = ILVT.LOC_GRP_CD
                   AND STCT.LOC_ROLE_TP_CD      = ILVT.LOC_ROLE_TP_CD
                   AND ILVT.EZCANCELFLAG        = '0'
                ) AS TO_INVTY_LOC_TP_CD
               ,IT.SO_NUM
               ,IT.SO_SLP_NUM
               ,IT.RWS_NUM
               ,IT.RWS_DTL_LINE_NUM
               ,IT.SHIP_FROM_LOC_CUST_CD
               ,IT.SHIP_FROM_LOC_CUST_NM
               ,IT.SHIP_TO_LOC_CUST_CD
               ,IT.SHIP_TO_LOC_CUST_NM
               ,IT.EZINTIME
               <!-- START 2023/04/07 G.Quan [QC#61206, ADD] -->
               ,IT.EZINTIME AS XX_REC_HIST_CRAT_TS
               ,IT.EZINUSERID AS XX_REC_HIST_CRAT_BY_NM
               ,IT.EZUPTIME AS XX_REC_HIST_UPD_TS
               ,IT.EZUPUSERID AS XX_REC_HIST_UPD_BY_NM
               ,IT.EZTABLEID AS XX_REC_HIST_TBL_NM
               <!-- END 2023/04/07 G.Quan [QC#61206, ADD] -->
            FROM
                INVTY_TRX       IT
               ,DS_INVTY_LOC_V  DILV
               ,LOC_STS         LS
               ,STK_STS         SS
               ,TRX             TR
               ,TRX_RSN         TRS
               ,MDSE            MD
               ,COA_PROJ        PJ
               ,MDSE_ITEM_TP    MIT
               ,COA_PROD        CP
               ,PO_DTL          PD
               ,SHIP_TO_CUST    LSP
               ,SELL_TO_CUST    LST
            WHERE
                IT.GLBL_CMPY_CD         = #glblCmpyCd#
            AND IT.INVTY_LOC_CD        != #invtyLocCdCR#
            <isNotNull property="trxId">
            AND IT.INVTY_TRX_PK         = #trxId#
            </isNotNull>
            <isNotNull property="trxDtFrom">
            AND IT.INVTY_TRX_DT        &gt;= #trxDtFrom#
            </isNotNull>
            <isNotNull property="trxDtTo">
            AND IT.INVTY_TRX_DT        &lt;= #trxDtTo#
            </isNotNull>
            <iterate property="locStsList" var="locStsList[]" open="AND IT.LOC_STS_CD IN (" conjunction= ", " close=")">
                 #locStsList[]#
            </iterate>
            <isNotNull property="trxCd">
            AND IT.TRX_CD               = #trxCd#
            </isNotNull>
            <isNotNull property="trxRsnCd">
            AND IT.TRX_RSN_CD           = #trxRsnCd#
            </isNotNull>
            <isNotNull property="srcDocNum">
            AND IT.INVTY_TRX_SLP_NUM    = #srcDocNum#
            </isNotNull>
            <isNotNull property="rwsNum">
            AND IT.RWS_NUM              = #rwsNum#
            </isNotNull>
            <isNotNull property="soNum">
            AND IT.SO_NUM               = #soNum#
            </isNotNull>
            <isNotNull property="ordTakeMdseCd">
            AND IT.MDSE_CD              LIKE #ordTakeMdseCd#
            </isNotNull>
            <isNotNull property="mdseCd">
            AND IT.MDSE_CD              = #mdseCd#
            </isNotNull>
            <isNotNull property="vndCd">
            AND IT.VND_CD               = #vndCd#
            </isNotNull>
            -- SHIP_FROM (Cust or Vnd)
            <isEqual property="shipFromLocTpFlg" compareValue="Y">
                <isNotNull property="shipFromLocCd">
                AND IT.SHIP_FROM_LOC_CUST_CD = #shipFromLocCd#
                </isNotNull>
            </isEqual>
            -- SHIP_FROM (Cust or Vnd)
            -- SHIP_TO (Cust or Vnd)
            <isEqual property="shipToLocTpFlg" compareValue="Y">
                <isNotNull property="shipToLocCd">
                AND IT.SHIP_TO_LOC_CUST_CD   = #shipToLocCd#
                </isNotNull>
            </isEqual>
            -- SHIP_TO (Cust or Vnd)
            -- RTL_WH/RTL_SWH
            <isNotNull property="rtlWhCd">
                AND EXISTS
                    (SELECT
                        INVTY_LOC_CD
                     FROM
                         DS_INVTY_LOC_V V
                     WHERE
                         V.RTL_WH_CD    = #rtlWhCd#
                         <isNotNull property="rtlSwhCd">
                             AND V.RTL_SWH_CD   = #rtlSwhCd#
                         </isNotNull>
                     AND IT.GLBL_CMPY_CD = V.GLBL_CMPY_CD
                     AND V.EZCANCELFLAG  = '0'
                     AND IT.INVTY_LOC_CD = V.INVTY_LOC_CD
                    )
            </isNotNull>
            <isNull property="rtlWhCd">
                <isNotNull property="rtlSwhCd">
                    AND EXISTS
                        (SELECT
                            INVTY_LOC_CD
                         FROM
                             DS_INVTY_LOC_V V
                         WHERE
                             V.RTL_SWH_CD   = #rtlSwhCd#
                         AND IT.GLBL_CMPY_CD = V.GLBL_CMPY_CD
                         AND V.EZCANCELFLAG  = '0'
                         AND IT.INVTY_LOC_CD = V.INVTY_LOC_CD
                        )
                </isNotNull>
            </isNull>
            -- RTL_WH/RTL_SWH
            -- SER_NUM
            <isNotNull property="serNum">
                AND EXISTS
                    (SELECT
                        1
                    FROM
                        (
                            SELECT
                                I.INVTY_TRX_PK
                            FROM
                                 SHIP_SER_NUM SSN
                                ,INVTY_TRX    I
                            WHERE
                                SSN.GLBL_CMPY_CD = #glblCmpyCd#
                            AND SSN.SER_NUM      = #serNum#
                            AND SSN.EZCANCELFLAG = '0'
                            AND SSN.GLBL_CMPY_CD = I.GLBL_CMPY_CD
                            AND SSN.SO_NUM       = I.SO_NUM
                            AND SSN.SO_SLP_NUM   = I.SO_SLP_NUM
                            AND I.EZCANCELFLAG   = '0'
                            UNION ALL
                            SELECT
                                I.INVTY_TRX_PK
                            FROM
                                 SHIP_SER_NUM SSN
                                ,SHPG_ORD_DTL SOD
                                ,INVTY_TRX    I
                            WHERE
                                SSN.GLBL_CMPY_CD = #glblCmpyCd#
                            AND SSN.SER_NUM      = #serNum#
                            AND SSN.EZCANCELFLAG = '0'
                            AND SSN.GLBL_CMPY_CD = SOD.GLBL_CMPY_CD
                            AND SSN.SO_NUM       = SOD.SO_NUM
                            AND SSN.SO_SLP_NUM   = SOD.SO_SLP_NUM
                            AND SOD.EZCANCELFLAG = '0'
                            AND SOD.GLBL_CMPY_CD = I.GLBL_CMPY_CD
                            AND SOD.TRX_HDR_NUM  = I.WRK_ORD_NUM
                            AND SOD.TRX_LINE_NUM = I.WRK_ORD_LINE_NUM
                            AND I.EZCANCELFLAG   = '0'
                            UNION ALL
                            SELECT
                                I.INVTY_TRX_PK
                            FROM
                                 RWS_PUT_AWAY_SER RPAS
                                ,INVTY_TRX        I
                            WHERE
                                RPAS.GLBL_CMPY_CD = #glblCmpyCd#
                            AND RPAS.SER_NUM      = #serNum#
                            AND RPAS.EZCANCELFLAG = '0'
                            AND RPAS.GLBL_CMPY_CD = I.GLBL_CMPY_CD
                            AND RPAS.RWS_NUM      = I.RWS_NUM
                            AND RPAS.RWS_LINE_NUM = I.RWS_DTL_LINE_NUM
                            AND I.EZCANCELFLAG    = '0'
                            UNION ALL
                            SELECT
                                I.INVTY_TRX_PK
                            FROM
                                 INVTY_ORD_SER IOS
                                ,INVTY_TRX     I
                            WHERE
                                IOS.GLBL_CMPY_CD       = #glblCmpyCd#
                            AND IOS.SER_NUM            = #serNum#
                            AND IOS.EZCANCELFLAG       = '0'
                            AND IOS.GLBL_CMPY_CD       = I.GLBL_CMPY_CD
                            AND IOS.INVTY_ORD_NUM      = I.INVTY_ORD_NUM
                            AND IOS.INVTY_ORD_LINE_NUM = I.INVTY_ORD_LINE_NUM
                            AND I.SO_NUM     IS NULL
                            AND I.RWS_NUM    IS NULL
                            AND I.EZCANCELFLAG         = '0'
                            UNION ALL
                            SELECT
                                I.INVTY_TRX_PK
                            FROM
                                 PO_SER_NUM PSN
                                ,INVTY_TRX  I
                            WHERE
                                PSN.GLBL_CMPY_CD   = #glblCmpyCd#
                            AND PSN.SER_NUM        = #serNum#
                            AND PSN.EZCANCELFLAG   = '0'
                            AND PSN.GLBL_CMPY_CD   = I.GLBL_CMPY_CD
                            AND PSN.KEY_INFO_CD_01 = I.CPO_ORD_NUM
                            AND PSN.KEY_INFO_CD_02 = I.CPO_DTL_LINE_NUM
                            AND PSN.KEY_INFO_CD_03 = I.CPO_DTL_LINE_SUB_NUM
                            AND I.EZCANCELFLAG     = '0'
                        ) SER
                    WHERE 
                        IT.INVTY_TRX_PK         = SER.INVTY_TRX_PK
                    )
            </isNotNull>
            AND IT.EZCANCELFLAG         = '0'
            -- SER_NUM
            -- SHIP_FROM (WH or Tech)
            <isEqual property="shipFromLocTpFlg" compareValue="N">
            AND EXISTS
                (
                    SELECT
                        1
                    FROM
                        DS_INVTY_LOC_V  SF
                    WHERE
                        IT.GLBL_CMPY_CD          = SF.GLBL_CMPY_CD
                    AND IT.SHIP_FROM_LOC_CUST_CD = SF.INVTY_LOC_CD
                    <isNotNull property="shipFromLocCd">
                        AND SF.RTL_WH_CD             = #shipFromLocCd#
                    </isNotNull>
                    AND SF.EZCANCELFLAG          = '0'
                )
            </isEqual>
            -- SHIP_FROM (WH or Tech)

            -- SHIP_TO (WH or Tech)
            <isEqual property="shipToLocTpFlg" compareValue="N">
            AND EXISTS
                (
                    SELECT
                        1
                    FROM
                        DS_INVTY_LOC_V  ST
                    WHERE
                        IT.GLBL_CMPY_CD          = ST.GLBL_CMPY_CD
                    AND IT.SHIP_TO_LOC_CUST_CD   = ST.INVTY_LOC_CD
                    <isNotNull property="shipToLocCd">
                        AND ST.RTL_WH_CD             = #shipToLocCd#
                    </isNotNull>
                    AND ST.EZCANCELFLAG          = '0'
                )
            </isEqual>
            -- SHIP_TO (WH or Tech)

            -- RELN_MDSE_CD
            <isNotNull property="xrefItemCd">
            AND EXISTS
                (
                    SELECT
                        1
                    FROM
                        MDSE_ITEM_FLIP_SET MIFS
                    WHERE
                        IT.GLBL_CMPY_CD           = MIFS.GLBL_CMPY_CD
                    AND IT.MDSE_CD                = MIFS.MDSE_CD
                    AND MIFS.RELN_MDSE_CD         = #xrefItemCd#
                    AND MIFS.MDSE_ITEM_RELN_TP_CD = #xrefItemTpCd#
                    AND MIFS.EZCANCELFLAG         = '0'
                )
            </isNotNull>
            -- RELN_MDSE_CD
            AND IT.GLBL_CMPY_CD         = DILV.GLBL_CMPY_CD
            AND IT.INVTY_LOC_CD         = DILV.INVTY_LOC_CD
            AND DILV.EZCANCELFLAG       = '0'
            AND IT.GLBL_CMPY_CD         = LS.GLBL_CMPY_CD
            AND IT.LOC_STS_CD           = LS.LOC_STS_CD
            AND LS.EZCANCELFLAG         = '0'
            AND IT.GLBL_CMPY_CD         = SS.GLBL_CMPY_CD
            AND IT.STK_STS_CD           = SS.STK_STS_CD
            AND SS.EZCANCELFLAG         = '0'
            AND IT.GLBL_CMPY_CD         = TR.GLBL_CMPY_CD
            AND IT.TRX_CD               = TR.TRX_CD
            AND TR.EZCANCELFLAG         = '0'
            AND IT.GLBL_CMPY_CD         = TRS.GLBL_CMPY_CD
            AND IT.TRX_CD               = TRS.TRX_CD
            AND IT.TRX_RSN_CD           = TRS.TRX_RSN_CD
            AND TRS.EZCANCELFLAG        = '0'
            AND IT.GLBL_CMPY_CD         = MD.GLBL_CMPY_CD
            AND IT.MDSE_CD              = MD.MDSE_CD
            <isNotNull property="mdseDescShortTxt">
            AND MD.MDSE_DESC_SHORT_TXT  LIKE #mdseDescShortTxt#
            </isNotNull>
            <isNotNull property="coaMdseTpCd">
            AND MD.COA_MDSE_TP_CD       = #coaMdseTpCd#
            </isNotNull>
            <isNotNull property="mdseItemTpCd">
            AND MD.MDSE_ITEM_TP_CD      = #mdseItemTpCd#
            </isNotNull>
            <isNotNull property="prodCd">
            AND MD.COA_PROD_CD          = #prodCd#
            </isNotNull>
            <isNotNull property="mnfItemCd">
            AND MD.MNF_ITEM_CD          = #mnfItemCd#
            </isNotNull>
            AND MD.EZCANCELFLAG         = '0'
            AND MD.GLBL_CMPY_CD         = PJ.GLBL_CMPY_CD
            AND MD.COA_MDSE_TP_CD       = PJ.COA_PROJ_CD
            AND PJ.EZCANCELFLAG         = '0'
            AND MD.GLBL_CMPY_CD         = MIT.GLBL_CMPY_CD
            AND MD.MDSE_ITEM_TP_CD      = MIT.MDSE_ITEM_TP_CD
            AND MIT.EZCANCELFLAG        = '0'
            AND MD.GLBL_CMPY_CD         = CP.GLBL_CMPY_CD
            AND MD.COA_PROD_CD          = CP.COA_PROD_CD
            AND CP.EZCANCELFLAG         = '0'
            AND IT.GLBL_CMPY_CD         = LSP.GLBL_CMPY_CD
            AND IT.INVTY_LOC_CD         = LSP.SHIP_TO_CUST_CD
            AND LSP.EZCANCELFLAG        = '0'
            AND LSP.GLBL_CMPY_CD        = LST.GLBL_CMPY_CD
            AND LSP.SELL_TO_CUST_CD     = LST.SELL_TO_CUST_CD
            AND LST.EZCANCELFLAG        = '0'
            AND IT.GLBL_CMPY_CD         = PD.GLBL_CMPY_CD(+)
            AND IT.PO_ORD_NUM           = PD.PO_ORD_NUM(+)
            AND IT.PO_ORD_DTL_LINE_NUM  = PD.PO_ORD_DTL_LINE_NUM(+)
            <isNotNull property="splyItemNum">
            AND PD.ASL_MDSE_CD          = #splyItemNum#
            </isNotNull>
            AND PD.EZCANCELFLAG(+)      = '0'
        )
        <!-- DS_COND_CONST (Text04 : RTL_WH_CD) -->
        , VAL_TXT_04 AS (
            SELECT DISTINCT
                ITD.GLBL_CMPY_CD
               ,ITD.INVTY_TRX_PK
               ,ITD.TRX_CD                             AS DS_COND_CONST_VAL_TXT_02
               ,ITD.TRX_RSN_CD                         AS DS_COND_CONST_VAL_TXT_03
               ,NVL(DCC.DS_COND_CONST_VAL_TXT_04, '*') AS DS_COND_CONST_VAL_TXT_04
               ,ITD.FROM_INVTY_LOC_TP_CD               AS DS_COND_CONST_VAL_TXT_05
               ,ITD.TO_INVTY_LOC_TP_CD                 AS DS_COND_CONST_VAL_TXT_06
               ,ITD.DS_PO_TP_CD                        AS DS_COND_CONST_VAL_TXT_07
               ,ITD.ADJ_TRX_TP_CD                      AS DS_COND_CONST_VAL_TXT_08
            FROM
                INVTY_TRX_DTL ITD
               ,DS_COND_CONST DCC
            WHERE
                DCC.GLBL_CMPY_CD(+)             = ITD.GLBL_CMPY_CD
            AND DCC.DS_COND_CONST_GRP_ID(+)     = #dsCondConstGrpId#
            AND DCC.DS_COND_CONST_VAL_TXT_02(+) = ITD.TRX_CD
            AND DCC.DS_COND_CONST_VAL_TXT_03(+) = ITD.TRX_RSN_CD
            AND DCC.DS_COND_CONST_VAL_TXT_04(+) = ITD.RTL_WH_CD
            AND DCC.EZCANCELFLAG(+)             = '0'
        )
        <!-- DS_COND_CONST (Text05 : FROM_INVTY_LOC_TP_CD) -->
        , VAL_TXT_05 AS (
            SELECT DISTINCT
                V4.GLBL_CMPY_CD
               ,V4.INVTY_TRX_PK
               ,V4.DS_COND_CONST_VAL_TXT_02
               ,V4.DS_COND_CONST_VAL_TXT_03
               ,V4.DS_COND_CONST_VAL_TXT_04
               ,NVL(DCC.DS_COND_CONST_VAL_TXT_05, '*') AS DS_COND_CONST_VAL_TXT_05
               ,V4.DS_COND_CONST_VAL_TXT_06
               ,V4.DS_COND_CONST_VAL_TXT_07
               ,V4.DS_COND_CONST_VAL_TXT_08
            FROM
                VAL_TXT_04    V4
               ,DS_COND_CONST DCC
            WHERE
                DCC.GLBL_CMPY_CD(+)             = V4.GLBL_CMPY_CD
            AND DCC.DS_COND_CONST_GRP_ID(+)     = #dsCondConstGrpId#
            AND DCC.DS_COND_CONST_VAL_TXT_02(+) = V4.DS_COND_CONST_VAL_TXT_02
            AND DCC.DS_COND_CONST_VAL_TXT_03(+) = V4.DS_COND_CONST_VAL_TXT_03
            AND DCC.DS_COND_CONST_VAL_TXT_04(+) = V4.DS_COND_CONST_VAL_TXT_04
            AND DCC.DS_COND_CONST_VAL_TXT_05(+) = V4.DS_COND_CONST_VAL_TXT_05
            AND DCC.EZCANCELFLAG(+)             = '0'
        )
        <!-- DS_COND_CONST (Text06 : TO_INVTY_LOC_TP_CD) -->
        , VAL_TXT_06 AS (
            SELECT DISTINCT
                V5.GLBL_CMPY_CD
               ,V5.INVTY_TRX_PK
               ,V5.DS_COND_CONST_VAL_TXT_02
               ,V5.DS_COND_CONST_VAL_TXT_03
               ,V5.DS_COND_CONST_VAL_TXT_04
               ,V5.DS_COND_CONST_VAL_TXT_05
               ,NVL(DCC.DS_COND_CONST_VAL_TXT_06, '*') AS DS_COND_CONST_VAL_TXT_06
               ,V5.DS_COND_CONST_VAL_TXT_07
               ,V5.DS_COND_CONST_VAL_TXT_08
            FROM
                VAL_TXT_05    V5
               ,DS_COND_CONST DCC
            WHERE
                DCC.GLBL_CMPY_CD(+)             = V5.GLBL_CMPY_CD
            AND DCC.DS_COND_CONST_GRP_ID(+)     = #dsCondConstGrpId#
            AND DCC.DS_COND_CONST_VAL_TXT_02(+) = V5.DS_COND_CONST_VAL_TXT_02
            AND DCC.DS_COND_CONST_VAL_TXT_03(+) = V5.DS_COND_CONST_VAL_TXT_03
            AND DCC.DS_COND_CONST_VAL_TXT_04(+) = V5.DS_COND_CONST_VAL_TXT_04
            AND DCC.DS_COND_CONST_VAL_TXT_05(+) = V5.DS_COND_CONST_VAL_TXT_05
            AND DCC.DS_COND_CONST_VAL_TXT_06(+) = V5.DS_COND_CONST_VAL_TXT_06
            AND DCC.EZCANCELFLAG(+)             = '0'
        )
        <!-- DS_COND_CONST (Text07 : DS_PO_TP_CD) -->
        , VAL_TXT_07 AS (
            SELECT DISTINCT
                V6.GLBL_CMPY_CD
               ,V6.INVTY_TRX_PK
               ,V6.DS_COND_CONST_VAL_TXT_02
               ,V6.DS_COND_CONST_VAL_TXT_03
               ,V6.DS_COND_CONST_VAL_TXT_04
               ,V6.DS_COND_CONST_VAL_TXT_05
               ,V6.DS_COND_CONST_VAL_TXT_06
               ,NVL(DCC.DS_COND_CONST_VAL_TXT_07, '*') AS DS_COND_CONST_VAL_TXT_07
               ,V6.DS_COND_CONST_VAL_TXT_08
            FROM
                VAL_TXT_06    V6
               ,DS_COND_CONST DCC
            WHERE
                DCC.GLBL_CMPY_CD(+)             = V6.GLBL_CMPY_CD
            AND DCC.DS_COND_CONST_GRP_ID(+)     = #dsCondConstGrpId#
            AND DCC.DS_COND_CONST_VAL_TXT_02(+) = V6.DS_COND_CONST_VAL_TXT_02
            AND DCC.DS_COND_CONST_VAL_TXT_03(+) = V6.DS_COND_CONST_VAL_TXT_03
            AND DCC.DS_COND_CONST_VAL_TXT_04(+) = V6.DS_COND_CONST_VAL_TXT_04
            AND DCC.DS_COND_CONST_VAL_TXT_05(+) = V6.DS_COND_CONST_VAL_TXT_05
            AND DCC.DS_COND_CONST_VAL_TXT_06(+) = V6.DS_COND_CONST_VAL_TXT_06
            AND DCC.DS_COND_CONST_VAL_TXT_07(+) = V6.DS_COND_CONST_VAL_TXT_07
            AND DCC.EZCANCELFLAG(+)             = '0'
        )
        <!-- DS_COND_CONST (Text08 : ADJ_TRX_TP_CD) -->
        , VAL_TXT_08 AS (
            SELECT DISTINCT
                V7.GLBL_CMPY_CD
               ,V7.INVTY_TRX_PK
               ,V7.DS_COND_CONST_VAL_TXT_02
               ,V7.DS_COND_CONST_VAL_TXT_03
               ,V7.DS_COND_CONST_VAL_TXT_04
               ,V7.DS_COND_CONST_VAL_TXT_05
               ,V7.DS_COND_CONST_VAL_TXT_06
               ,V7.DS_COND_CONST_VAL_TXT_07
               ,NVL(DCC.DS_COND_CONST_VAL_TXT_08, '*') AS DS_COND_CONST_VAL_TXT_08
            FROM
                VAL_TXT_07    V7
               ,DS_COND_CONST DCC
            WHERE
                DCC.GLBL_CMPY_CD(+)             = V7.GLBL_CMPY_CD
            AND DCC.DS_COND_CONST_GRP_ID(+)     = #dsCondConstGrpId#
            AND DCC.DS_COND_CONST_VAL_TXT_02(+) = V7.DS_COND_CONST_VAL_TXT_02
            AND DCC.DS_COND_CONST_VAL_TXT_03(+) = V7.DS_COND_CONST_VAL_TXT_03
            AND DCC.DS_COND_CONST_VAL_TXT_04(+) = V7.DS_COND_CONST_VAL_TXT_04
            AND DCC.DS_COND_CONST_VAL_TXT_05(+) = V7.DS_COND_CONST_VAL_TXT_05
            AND DCC.DS_COND_CONST_VAL_TXT_06(+) = V7.DS_COND_CONST_VAL_TXT_06
            AND DCC.DS_COND_CONST_VAL_TXT_07(+) = V7.DS_COND_CONST_VAL_TXT_07
            AND DCC.DS_COND_CONST_VAL_TXT_08(+) = V7.DS_COND_CONST_VAL_TXT_08
            AND DCC.EZCANCELFLAG(+)             = '0'
        )
        <!-- DS_COND_CONST (Text01 : INVTY_TRX_CD) -->
        , VAL_TRX_01 AS (
            SELECT DISTINCT
                V8.GLBL_CMPY_CD
               ,V8.INVTY_TRX_PK
               ,ITT.INVTY_TRX_TP_CD
               ,ITT.INVTY_TRX_TP_DESC_TXT
            FROM
                VAL_TXT_08    V8
               ,DS_COND_CONST DCC
               ,INVTY_TRX_TP  ITT
            WHERE
                DCC.GLBL_CMPY_CD(+)             = V8.GLBL_CMPY_CD
            AND DCC.DS_COND_CONST_GRP_ID(+)     = #dsCondConstGrpId#
            AND DCC.DS_COND_CONST_VAL_TXT_02(+) = V8.DS_COND_CONST_VAL_TXT_02
            AND DCC.DS_COND_CONST_VAL_TXT_03(+) = V8.DS_COND_CONST_VAL_TXT_03
            AND DCC.DS_COND_CONST_VAL_TXT_04(+) = V8.DS_COND_CONST_VAL_TXT_04
            AND DCC.DS_COND_CONST_VAL_TXT_05(+) = V8.DS_COND_CONST_VAL_TXT_05
            AND DCC.DS_COND_CONST_VAL_TXT_06(+) = V8.DS_COND_CONST_VAL_TXT_06
            AND DCC.DS_COND_CONST_VAL_TXT_07(+) = V8.DS_COND_CONST_VAL_TXT_07
            AND DCC.DS_COND_CONST_VAL_TXT_08(+) = V8.DS_COND_CONST_VAL_TXT_08
            AND DCC.EZCANCELFLAG(+)             = '0'
            AND ITT.GLBL_CMPY_CD(+)             = DCC.GLBL_CMPY_CD
            AND ITT.INVTY_TRX_TP_CD(+)          = DCC.DS_COND_CONST_VAL_TXT_01
            AND ITT.EZCANCELFLAG(+)             = '0'
        )
        <!-- Main SQL -->
        SELECT
            ITDV.RTL_WH_CD
           ,ITDV.RTL_WH_NM
           ,ITDV.RTL_SWH_CD
           ,ITDV.MDSE_CD
           ,ITDV.MDSE_DESC_SHORT_TXT
           ,ITDV.COA_PROJ_CD
           ,ITDV.COA_PROJ_DESC_TXT
           ,ITDV.MDSE_ITEM_TP_CD
           ,ITDV.MDSE_ITEM_TP_DESC_TXT
           ,ITDV.COA_PROD_CD
           ,ITDV.COA_PROD_DESC_TXT
           ,ITDV.SPLY_ITEM_NUM
           ,ITDV.MNF_ITEM_CD
           ,ITDV.SVC_CONFIG_MSTR_PK
           ,ITDV.MDL_NM
           ,ITDV.INVTY_TRX_PK
           ,VT1.INVTY_TRX_TP_DESC_TXT
           ,ITDV.TRX_CD
           ,ITDV.TRX_DESC_TXT
           ,ITDV.TRX_RSN_CD
           ,ITDV.TRX_RSN_DESC_TXT
           ,ITDV.INVTY_TRX_QTY
           ,ITDV.STK_STS_CD
           ,ITDV.STK_STS_DESC_TXT
           ,ITDV.LOC_STS_CD
           ,ITDV.LOC_STS_DESC_TXT
           ,ITDV.SRC_ORD_NUM
           ,ITDV.SRC_ORD_LINE_NUM
           ,ITDV.SO_NUM
           ,ITDV.SO_SLP_NUM
           ,ITDV.RWS_NUM
           ,ITDV.RWS_DTL_LINE_NUM
           ,ITDV.PARTY_NM
           ,ITDV.SER_TRX_FLG
           ,ITDV.ITEM_FLIP_FLG
           ,ITDV.INVTY_TRX_DT
           ,ITDV.EZINTIME
           ,ITDV.SHIP_TO_LOC_CUST_NM
           ,ITDV.AJE_LINK_FLG
           <!-- START 2023/04/07 G.Quan [QC#61206, ADD] -->
           ,ITDV.XX_REC_HIST_CRAT_TS
           ,ITDV.XX_REC_HIST_CRAT_BY_NM
           ,ITDV.XX_REC_HIST_UPD_TS
           ,ITDV.XX_REC_HIST_UPD_BY_NM
           ,ITDV.XX_REC_HIST_TBL_NM
           <!-- END 2023/04/07 G.Quan [QC#61206, ADD] -->
        FROM
            INVTY_TRX_DTL  ITDV
           ,VAL_TRX_01     VT1
        WHERE
        <isNull property="trxTpCd">
            ITDV.GLBL_CMPY_CD   = VT1.GLBL_CMPY_CD(+)
        AND ITDV.INVTY_TRX_PK   = VT1.INVTY_TRX_PK(+)
        </isNull>
        <isNotNull property="trxTpCd">
            ITDV.GLBL_CMPY_CD   = VT1.GLBL_CMPY_CD
        AND ITDV.INVTY_TRX_PK   = VT1.INVTY_TRX_PK
        AND VT1.INVTY_TRX_TP_CD = #trxTpCd#
        </isNotNull>
        <!-- 04/21/2023 - QC#61403 - Add rowNum parameter - START -->
        AND ROWNUM          &lt;= #rowNum#
        <!-- 04/21/2023 - QC#61403 - Add rowNum parameter - END -->
        ORDER BY
            INVTY_TRX_DT
           ,INVTY_TRX_PK
    </statement>

    <statement id="getRcvSerList" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
            ITX2.INVTY_TRX_PK
           ,ITX2.INVTY_TRX_QTY
           ,ITX2.TRX_CD
           ,ITX2.TRX_RSN_CD
           ,RPS.RWS_NUM
           ,RPS.RWS_LINE_NUM
           ,RPS.INVTY_STK_STS_CD
           ,RPS.SER_NUM
           ,RPS.EZINTIME
        FROM
            INVTY_TRX        ITX
           ,INVTY_TRX        ITX2
           ,RWS_PUT_AWAY_SER RPS
        WHERE
            ITX.GLBL_CMPY_CD      = #glblCmpyCd#
        <iterate property="rcvSerInvtyTrxPkList" var="rcvSerInvtyTrxPkList[]" open="AND ITX.INVTY_TRX_PK IN (" conjunction= ", " close=")">
            #rcvSerInvtyTrxPkList[]#
        </iterate>
        AND ITX.INVTY_TRX_QTY  &gt; 0
        AND ITX.EZCANCELFLAG      = '0'
        AND ITX.GLBL_CMPY_CD      = ITX2.GLBL_CMPY_CD
        AND ITX.TRX_CD            = ITX2.TRX_CD
        AND ITX.TRX_RSN_CD        = ITX2.TRX_RSN_CD
        AND ITX.INVTY_LOC_CD      = ITX2.INVTY_LOC_CD
        AND ITX.MDSE_CD           = ITX2.MDSE_CD
        AND ITX.STK_STS_CD        = ITX2.STK_STS_CD
        AND ITX.RWS_NUM           = ITX2.RWS_NUM
        AND ITX.RWS_DTL_LINE_NUM  = ITX2.RWS_DTL_LINE_NUM
        AND ITX2.EZCANCELFLAG     = '0'
        AND ITX2.GLBL_CMPY_CD     = RPS.GLBL_CMPY_CD
        AND ITX2.RWS_NUM          = RPS.RWS_NUM
        AND ITX2.RWS_DTL_LINE_NUM = RPS.RWS_LINE_NUM
        AND ITX2.STK_STS_CD       = RPS.INVTY_STK_STS_CD
        AND RPS.EZCANCELFLAG      = '0'
        ORDER BY
            RPS.RWS_NUM
           ,RPS.RWS_LINE_NUM
           ,RPS.INVTY_STK_STS_CD
           ,ITX2.INVTY_TRX_PK
           ,RPS.EZINTIME
           ,RPS.SER_NUM
    </statement>

</sqlMap>