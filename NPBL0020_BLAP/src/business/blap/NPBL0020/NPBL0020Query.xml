<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NPBL0020Query">
    <typeAlias alias="NPBL0020CMsg" type="business.blap.NPBL0020.NPBL0020CMsg" />
    <typeAlias alias="NPBL0020SMsg" type="business.blap.NPBL0020.NPBL0020SMsg" />
    <typeAlias alias="NPBL0020_ASMsg" type="business.blap.NPBL0020.NPBL0020_ASMsg" />

    <statement id="getRequisitionTypePulldownList" parameterClass="Map"
        resultClass="Map">
        SELECT
            PRT.PRCH_REQ_TP_CD
            ,PRT.PRCH_REQ_TP_DESC_TXT
        FROM
            PRCH_REQ_TP PRT
        WHERE
                PRT.GLBL_CMPY_CD            = #glblCmpyCd#
            AND PRT.PRCH_REQ_REC_TP_CD      = #prchReqRecTpCd#
            <isNotNull property="scrEntAvalFlg">
            AND PRT.SCR_ENT_AVAL_FLG        = #scrEntAvalFlg#
            </isNotNull>
            AND PRT.EZCANCELFLAG            = '0'
        ORDER BY
            PRT.PRCH_REQ_TP_SORT_NUM ASC
    </statement>

    <statement id="getLineTypePulldownList" parameterClass="Map"
        resultClass="Map">
        SELECT
            PRLT.PRCH_REQ_LINE_TP_CD
            ,PRLT.PRCH_REQ_LINE_TP_DESC_TXT
            ,PRLT.FROM_STK_STS_CD
        FROM
            PRCH_REQ_LINE_TP PRLT
        WHERE
                PRLT.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="prchReqLineTpCd">
            AND PRLT.PRCH_REQ_LINE_TP_CD = #prchReqLineTpCd#
            </isNotNull>
            AND PRLT.PRCH_REQ_REC_TP_CD  = #prchReqRecTpCd#
            <isNotNull property="scrEntAvalFlg">
            AND PRLT.SCR_ENT_AVAL_FLG    = #scrEntAvalFlg#
            </isNotNull>
            AND PRLT.EZCANCELFLAG        = '0'
        ORDER BY
            PRLT.PRCH_REQ_LINE_TP_SORT_NUM ASC
    </statement>

    <statement id="getStockStatusPulldownList" parameterClass="Map"
        resultClass="Map">
        SELECT
             SS.STK_STS_CD
            ,SS.STK_STS_DESC_TXT
        FROM
            STK_STS SS
        WHERE
            SS.GLBL_CMPY_CD = #glblCmpyCd#
        AND SS.EZCANCELFLAG = '0'
        ORDER BY SS.STK_STS_SORT_NUM ASC
    </statement>

    <statement id="getLineStatusName" parameterClass="Map"
        resultClass="String">
        SELECT
            PRLS.PRCH_REQ_LINE_STS_DESC_TXT
        FROM
            PRCH_REQ_LINE_STS PRLS
        WHERE
                PRLS.GLBL_CMPY_CD         = #glblCmpyCd#
            AND PRLS.PRCH_REQ_LINE_STS_CD = #prchReqLineStsCd#
            AND PRLS.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getConfigTypeName" parameterClass="Map"
        resultClass="String">
        SELECT
            CT.CONFIG_TP_DESC_TXT
        FROM
            CONFIG_TP CT
        WHERE
                CT.GLBL_CMPY_CD = #glblCmpyCd#
            AND CT.CONFIG_TP_CD = #configTpCd#
            AND CT.EZCANCELFLAG = '0'
    </statement>

    <statement id="getHeaderStatusName" parameterClass="Map"
        resultClass="String">
        SELECT
            PRS.PRCH_REQ_STS_DESC_TXT
        FROM
            PRCH_REQ_STS PRS
        WHERE
                PRS.GLBL_CMPY_CD    = #glblCmpyCd#
            AND PRS.PRCH_REQ_STS_CD = #prchReqStsCd#
            AND PRS.EZCANCELFLAG    = '0'
    </statement>
    <statement id="getApprovalStatusName" parameterClass="Map"
        resultClass="String">
        SELECT
            PRAS.PRCH_REQ_APVL_STS_DESC_TXT
        FROM
            PRCH_REQ_APVL_STS PRAS
        WHERE
                PRAS.GLBL_CMPY_CD         = #glblCmpyCd#
            AND PRAS.PRCH_REQ_APVL_STS_CD = #prchReqApvlStsCd#
            AND PRAS.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getDocumentSourceTypeName" parameterClass="Map"
        resultClass="String">
        SELECT
            PRST.PRCH_REQ_SRC_TP_DESC_TXT
        FROM
            PRCH_REQ_SRC_TP PRST
        WHERE
                PRST.GLBL_CMPY_CD       = #glblCmpyCd#
            AND PRST.PRCH_REQ_SRC_TP_CD = #prchReqSrcTpCd#
            AND PRST.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getRequisitionType" parameterClass="Map"
        resultClass="String">
        SELECT
            PRT.DEF_PRCH_REQ_LINE_TP_CD
        FROM
            PRCH_REQ_TP PRT
        WHERE
                PRT.GLBL_CMPY_CD   = #glblCmpyCd#
            AND PRT.PRCH_REQ_TP_CD = #prchReqTpCd#
            AND PRT.EZCANCELFLAG   = '0'
    </statement>

    <statement id="getConfigComponents" parameterClass="Map"
        resultClass="Map">
        SELECT
            SMM.CUR_LOC_NUM
            ,SMM.MDSE_CD
            ,SMM.SER_NUM
            ,SMM.STK_STS_CD
            <!-- START 2023/03/13 R.Azucena [QC#61282, ADD] -->
            ,SMM.SVC_MACH_MSTR_STS_CD
            ,SMM.SVC_MACH_MAINT_AVAL_FLG
            ,SMM.TRX_HDR_NUM
            <!-- END 2023/03/13 R.Azucena [QC#61282, ADD] -->
            <!-- START 2022/11/16 R.Azucena [QC#60808, ADD] -->
            ,SMM.SVC_MACH_MSTR_PK
            <!-- END 2022/11/16 R.Azucena [QC#60808, ADD] -->
            ,RW.RTL_WH_CD
            ,RW.RTL_WH_NM
            ,RW.RTL_WH_CATG_CD
            ,RS.RTL_SWH_CD
            ,RS.RTL_SWH_NM
        FROM
            SVC_MACH_MSTR SMM
            ,RTL_SWH      RS
            ,RTL_WH       RW
        WHERE
                SMM.GLBL_CMPY_CD             = #glblCmpyCd#
            AND SMM.SVC_CONFIG_MSTR_PK       = #svcConfigMstrPk#
            <!-- START 2023/03/13 R.Azucena [QC#61282, MOD] -->
            <!-- <iterate property="svcMachMstrStsCdList" var="svcMachMstrStsCd[]" open="AND SMM.SVC_MACH_MSTR_STS_CD IN (" conjunction= ", " close=")"> -->
            <!--     #svcMachMstrStsCd[]# -->
            <!-- </iterate> -->
            <!-- AND SMM.SVC_MACH_MAINT_AVAL_FLG  = #svcMachMaintAvalFlg# -->
            AND SMM.SVC_MACH_MSTR_STS_CD     &lt;&gt; #svcMachMstrStsCd#
            <!-- END 2023/03/13 R.Azucena [QC#61282, MOD] -->
            AND SMM.CUR_LOC_NUM              = RS.INVTY_LOC_CD(+)
            AND SMM.GLBL_CMPY_CD             = RS.GLBL_CMPY_CD(+)
            AND RS.RTL_WH_CD                 = RW.RTL_WH_CD(+)
            AND RS.GLBL_CMPY_CD              = RW.GLBL_CMPY_CD(+)
            <!-- START 2023/03/13 R.Azucena [QC#61282, DEL] -->
            <!-- <isNotNull property="curLocNum"> -->
            <!--     AND SMM.CUR_LOC_NUM              LIKE #curLocNum# -->
            <!-- </isNotNull> -->
            <!-- END 2023/03/13 R.Azucena [QC#61282, DEL] -->
            AND SMM.EZCANCELFLAG             = '0'
            AND RS.EZCANCELFLAG(+)           = '0'
            AND RW.EZCANCELFLAG(+)           = '0'
        ORDER BY
<!-- START 2019/10/21 H.Umeda [QC#54030,Add] -->
            SMM.SVC_MACH_TP_CD,
<!-- END   2019/10/21 H.Umeda [QC#54030,Add] -->
            SMM.SVC_MACH_SQ_NUM ASC
    </statement>
    <statement id="getItemDescription" parameterClass="Map"
        resultClass="String">
        SELECT
            M.MDSE_DESC_SHORT_TXT
        FROM
            MDSE M
        WHERE
                M.GLBL_CMPY_CD   = #glblCmpyCd#
            AND M.MDSE_CD        = #mdseCd#
            AND M.RGTN_STS_CD    = #rgtnStsCd#
            AND M.EZCANCELFLAG   = '0'
    </statement>

    <statement id="getPoOrderStatus" parameterClass="Map"
        resultClass="Map">
        SELECT
            PD.PO_STS_CD
        FROM
            PO_DTL PD
        WHERE
                PD.GLBL_CMPY_CD        = #glblCmpyCd#
            AND PD.PO_ORD_NUM          = #poOrdNum#
            AND PD.PO_ORD_DTL_LINE_NUM = #poOrdDtlLineNum#
            AND PD.EZCANCELFLAG        = '0'
            AND ROWNUM                 = #rowNum#
    </statement>

    <statement id="getShipToAddress" parameterClass="Map"
        resultClass="Map">
        SELECT
            STC.SHIP_TO_CUST_CD
            ,STC.LOC_NM
            ,NVL(STC.ADDL_LOC_NM, STC.DS_LOC_NM) AS ADDL_LOC_NM
            ,STC.FIRST_LINE_ADDR
            ,STC.SCD_LINE_ADDR
            ,STC.THIRD_LINE_ADDR
            ,STC.FRTH_LINE_ADDR
            ,STC.FIRST_LINE_ADDR || ' ' || STC.SCD_LINE_ADDR || ' ' || STC.THIRD_LINE_ADDR || ' ' || STC.FRTH_LINE_ADDR AS SHIP_VND_ADDR
            ,STC.CTRY_CD
            ,STC.POST_CD
            ,STC.CTY_ADDR
            ,STC.ST_CD
            ,STC.PROV_NM
            ,C.CTRY_NM
            ,C2.CNTY_NM
        FROM
            SHIP_TO_CUST STC
            ,CTRY C
            ,CNTY C2
        WHERE
                STC.GLBL_CMPY_CD      = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD   = #shipToCustCd#
            AND STC.RGTN_STS_CD       = #rgtnStsCd#
            AND STC.GLBL_CMPY_CD      = C.GLBL_CMPY_CD(+)
            AND STC.CTRY_CD           = C.CTRY_CD(+)
            AND STC.GLBL_CMPY_CD      = C2.GLBL_CMPY_CD(+)
            AND STC.CNTY_PK           = C2.CNTY_PK(+)
            AND STC.EZCANCELFLAG      = '0'
            AND C.EZCANCELFLAG(+)     = '0'
            AND C2.EZCANCELFLAG(+)    = '0'
    </statement>

    <statement id="findRequester" parameterClass="Map" resultClass="Map">
        SELECT
               AUTH_PSN_V.PSN_CD
          FROM 
               (
                SELECT
                       AP.USR_NM AS PSN_CD
                     , AP.FIRST_NM || ' ' || CONCAT(AP.MID_NM, DECODE(AP.MID_NM, NULL, '', ' ')) || AP.LAST_NM AS FULL_PSN_NM
                  FROM
                       AUTH_PSN AP
                 WHERE
                       AP.GLBL_CMPY_CD = #glblCmpyCd#
                   AND AP.EZCANCELFLAG = '0'
                UNION SELECT
                       SSUL.PSN_CD
                      ,SSUL.FULL_PSN_NM
                  FROM
                      SCE_SYS_USR_LIST SSUL
                 WHERE
                       SSUL.GLBL_CMPY_CD = #glblCmpyCd#
                   AND SSUL.EZCANCELFLAG = '0'
               ) AUTH_PSN_V
         WHERE
               UPPER(AUTH_PSN_V.FULL_PSN_NM) = UPPER(#fullPsnNm#)
    </statement>

    <statement id="findShipToSupplier" parameterClass="Map"
        resultClass="Map">
        SELECT
            PVV.PRNT_VND_CD
            ,PVV.DPLY_VND_NM
        FROM
            PO_VND_V PVV
        WHERE
                PVV.GLBL_CMPY_CD = #glblCmpyCd#
            AND PVV.VND_CD       = #vndCd#
            AND PVV.EZCANCELFLAG = '0'
    </statement>

    <statement id="findShipToSupplierFromName" parameterClass="Map"
        resultClass="Map">
        SELECT
            PVV.PRNT_VND_CD
            ,PVV.VND_CD
        FROM
            PO_VND_V PVV
        WHERE
                PVV.GLBL_CMPY_CD    = #glblCmpyCd#
            AND PVV.DPLY_VND_NM     LIKE #dplyVndNm#
            AND PVV.EZCANCELFLAG    = '0'
    </statement>
    <statement id="findRtlWhFromName" parameterClass="Map"
        resultClass="Map">
        SELECT
            RW.RTL_WH_CD
            ,RW.RTL_WH_NM
            ,RW.RTL_WH_CATG_CD
        FROM
            RTL_WH RW
        WHERE
                RW.GLBL_CMPY_CD = #glblCmpyCd#
            AND RW.RTL_WH_NM    LIKE #rtlWhNm#
            <isNotNull property="rtlWhCd">
            AND RW.RTL_WH_CD    = #rtlWhCd#
            </isNotNull>
            AND RW.EZCANCELFLAG = '0'
    </statement>

    <statement id="findRtlWh" parameterClass="Map"
        resultClass="Map">
        SELECT
            RW.RTL_WH_NM
            ,RW.RTL_WH_CATG_CD
        FROM
            RTL_WH RW
        WHERE
                RW.GLBL_CMPY_CD = #glblCmpyCd#
            AND RW.RTL_WH_CD    = #rtlWhCd#
            AND RW.EZCANCELFLAG = '0'
    </statement>

    <statement id="findRtlSwhFromName" parameterClass="Map"
        resultClass="Map">
        SELECT
            RS.RTL_SWH_CD
            ,RS.RTL_SWH_NM
        FROM
            RTL_SWH RS
        WHERE
                RS.GLBL_CMPY_CD = #glblCmpyCd#
            AND RS.RTL_WH_CD    = #rtlWhCd#
            AND RS.RTL_SWH_NM   LIKE #rtlSwhNm#
            AND RS.EZCANCELFLAG = '0'
    </statement>
    <statement id="checkInventoryAccount" parameterClass="Map"
        resultClass="Map">
        SELECT
            RW1.RTL_WH_CD
        FROM
            RTL_WH RW1
            ,RTL_WH RW2
        WHERE
                RW1.GLBL_CMPY_CD  = #glblCmpyCd#
            AND RW1.RTL_WH_CD     = #destRtlWhCd#
            AND RW1.INVTY_ACCT_CD = RW2.INVTY_ACCT_CD
            AND RW1.GLBL_CMPY_CD  = RW2.GLBL_CMPY_CD
            AND RW2.RTL_WH_CD     = #srcRtlWhCd#
            AND RW1.EZCANCELFLAG  = '0'
            AND RW2.EZCANCELFLAG  = '0'
    </statement>

    <statement id="findShpgSvcLvlCarrierRelation" parameterClass="Map"
        resultClass="Map">
        SELECT
            SSLCR.CARR_SVC_LVL_CD
        FROM
            SHPG_SVC_LVL_CARR_RELN SSLCR
        WHERE
                SSLCR.GLBL_CMPY_CD    = #glblCmpyCd#
            AND SSLCR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
            AND SSLCR.CARR_CD         = #carrCd#
            AND SSLCR.EZCANCELFLAG    = '0'
    </statement>

    <statement id="findSerialWarehouseRelation" parameterClass="Map"
        resultClass="Map">
        SELECT
            SMM.CUR_LOC_NUM
        FROM
            SVC_MACH_MSTR SMM
        WHERE
                SMM.GLBL_CMPY_CD = #glblCmpyCd#
            <iterate property="serNum" var="serNum[]" open="AND (" close=")" conjunction="OR">
                SMM.SER_NUM      = #serNum[]#
            </iterate>
            AND SMM.EZCANCELFLAG = '0'
    </statement>
    <statement id="findCarrierFromRtlWH" parameterClass="Map"
        resultClass="Map">
        SELECT
            RW.PRF_CARR_CD
            ,OCV.CARR_NM
        FROM
            RTL_WH RW
            ,OTBD_CARR_V OCV
        WHERE
                RW.GLBL_CMPY_CD  = #glblCmpyCd#
            AND RW.RTL_WH_CD     = #rtlWhCd#
            AND RW.PRF_CARR_CD   = OCV.CARR_CD
            AND RW.GLBL_CMPY_CD  = OCV.GLBL_CMPY_CD
            AND RW.EZCANCELFLAG  = '0'
            AND OCV.EZCANCELFLAG = '0'
    </statement>

    <statement id="findAccountBranchFromRtlWH" parameterClass="Map"
        resultClass="Map">
        SELECT
            RW.COA_BR_CD
        FROM
            RTL_WH RW
        WHERE
                RW.GLBL_CMPY_CD    = #glblCmpyCd#
            AND RW.RTL_WH_CD       = #rtlWhCd#
            AND RW.EZCANCELFLAG    = '0'
    </statement>

    <statement id="findAccountAcctFromRtlWH" parameterClass="Map"
        resultClass="Map">
        SELECT
            CPA.COA_ACCT_CD
        FROM
            MDSE DMI
            ,COA_PROJ CP
            ,COA_PROJ_ACCT CPA
            ,PRCH_REQ_TP PRT
        WHERE
                DMI.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DMI.MDSE_CD                = #mdseCd#
            AND DMI.COA_MDSE_TP_CD         = CP.COA_PROJ_CD
            AND DMI.GLBL_CMPY_CD           = CP.GLBL_CMPY_CD
            AND CP.COA_PROJ_CD             = CPA.COA_PROJ_CD
            AND CP.GLBL_CMPY_CD            = CPA.GLBL_CMPY_CD
            AND CPA.COA_PROJ_ACCT_TP_CD    = PRT.COA_PROJ_ACCT_TP_CD
            AND CPA.GLBL_CMPY_CD           = PRT.GLBL_CMPY_CD
            AND PRT.PRCH_REQ_TP_CD         = #prchReqTp#
            AND DMI.EZCANCELFLAG           = '0'
            AND CP.EZCANCELFLAG            = '0'
            AND CPA.EZCANCELFLAG           = '0'
            AND PRT.EZCANCELFLAG           = '0'
    </statement>

    <statement id="findDefDplyCoaInfo" parameterClass="Map"
        resultClass="Map">
        SELECT
            DDCI.COA_CMPY_CD
            ,DDCI.COA_AFFL_CD
            ,DDCI.COA_BR_CD
            ,DDCI.COA_CC_CD
            ,DDCI.COA_ACCT_CD
            ,DDCI.COA_PROD_CD
            ,DDCI.COA_CH_CD
            ,DDCI.COA_PROJ_CD
            ,DDCI.COA_EXTN_CD
        FROM
            DEF_DPLY_COA_INFO DDCI
        WHERE
                DDCI.GLBL_CMPY_CD    = #glblCmpyCd#
            AND DDCI.APP_FUNC_ID     = #appFuncId#
            AND DDCI.EZCANCELFLAG    = '0'
    </statement>

    <statement id="findPO" parameterClass="Map"
        resultClass="Map">
        SELECT
            P.VND_CD
            ,PVV.PRNT_VND_CD
            ,PVV.DPLY_VND_NM
            ,PD.MDSE_CD
            ,PD.MDSE_DESC_SHORT_TXT
            ,PD.PO_ORD_DTL_LINE_NUM
            ,PD.PO_DISP_QTY
        FROM
            PO P
            ,PO_VND_V PVV
            ,PO_DTL PD
        WHERE
                P.GLBL_CMPY_CD          = #glblCmpyCd#
            AND P.PO_ORD_NUM            = #poOrdNum#
            AND P.VND_CD                = PVV.VND_CD
            AND P.GLBL_CMPY_CD          = PVV.GLBL_CMPY_CD
            AND P.PO_ORD_NUM            = PD.PO_ORD_NUM
            AND P.GLBL_CMPY_CD          = PD.GLBL_CMPY_CD
            AND P.EZCANCELFLAG          = '0'
            AND PVV.EZCANCELFLAG        = '0'
            AND PD.EZCANCELFLAG         = '0'
        ORDER BY
            PD.PO_ORD_DTL_LINE_NUM ASC
    </statement>

    <statement id="search" parameterClass="Map"
        resultMap="result.NPBL0020_ASMsg">
        SELECT
        -- 08/07/2017 CITS H.Naoi Add MRP_PLN_NM Sol 097 QC18398
            MAIN.PRCH_REQ_LINE_NUM
            ,MAIN.PRCH_REQ_LINE_SUB_NUM
            ,MAIN.LINE_NUMBER
            ,MAIN.CONFIG_TP_CD
            ,MAIN.CONFIG_TP_DESC_TXT
            ,MAIN.PRCH_REQ_LINE_TP_CD
            ,MAIN.MDSE_CD
            ,MAIN.MDSE_DESC_SHORT_TXT
            ,MAIN.SHPG_SER_TAKE_FLG
            ,MAIN.SVC_CONFIG_MSTR_PK
            ,MAIN.PRCH_REQ_DISP_QTY
            ,MAIN.SHIP_QTY
            ,MAIN.SRC_RTL_WH_CD
            ,MAIN.SRC_RTL_WH_NM
            ,MAIN.SRC_RTL_SWH_CD
            ,MAIN.SRC_RTL_SWH_NM
            ,MAIN.DEST_RTL_WH_CD
            ,MAIN.DEST_RTL_WH_NM
            ,MAIN.DEST_RTL_SWH_CD
            ,MAIN.DEST_RTL_SWH_NM
            ,MAIN.PRNT_VND_CD
            ,MAIN.VND_CD
            ,MAIN.DPLY_VND_NM
            ,MAIN.PRCH_REQ_LINE_STS_CD
            ,MAIN.PRCH_REQ_LINE_STS_DESC_TXT
            ,MAIN.ENT_DEAL_NET_UNIT_PRC_AMT
            ,MAIN.ENT_PO_DTL_DEAL_NET_AMT
            ,MAIN.COA_CMPY_CD
            ,MAIN.COA_AFFL_CD
            ,MAIN.COA_BR_CD
            ,MAIN.COA_CC_CD
            ,MAIN.COA_ACCT_CD
            ,MAIN.COA_PROD_CD2
            ,MAIN.COA_CH_CD
            ,MAIN.COA_PROJ_CD
            ,MAIN.COA_EXTN_CD
            ,MAIN.CHARGE_ACCOUNT
            ,MAIN.COA_MDSE_TP_CD
            ,MAIN.COA_PROD_CD
            ,MAIN.SERIAL_NUMBER_PK
            ,MAIN.SERIAL_NUMBER
            ,MAIN.SO_NUM
            ,MAIN.RWS_NUM
            ,MAIN.PRCH_REQ_LINE_CMNT_TXT
            ,MAIN.PRCH_REQ_NUM
            ,MAIN.PRCH_REQ_TP_CD
            ,MAIN.PRCH_REQ_STS_CD
            ,MAIN.PRCH_REQ_STS_DESC_TXT
            ,MAIN.PRCH_REQ_APVL_STS_CD
            ,MAIN.PRCH_REQ_APVL_STS_DESC_TXT
            ,MAIN.PRCH_REQ_CRAT_DT
            ,MAIN.RQST_RCV_DT
            ,MAIN.PRCH_REQ_SRC_TP_CD
            ,MAIN.PRCH_REQ_SRC_TP_DESC_TXT
            ,MAIN.TRX_REF_NUM
            ,MAIN.MRP_PLN_NM
            ,MAIN.PRCH_REQ_RQST_BY_PSN_CD
            ,NVL2(MAIN.FULL_PSN_NM2,MAIN.FULL_PSN_NM2,MAIN.FULL_PSN_NM) AS FULL_PSN_NM
            ,MAIN.SHPG_SVC_LVL_CD
            ,MAIN.CARR_CD
            ,MAIN.CARR_NM
            ,MAIN.CTAC_PSN_NM
            ,MAIN.PRCH_REQ_CMNT_TXT
	        ,MAIN.SHIP_TO_LOC_NM
            ,MAIN.SHIP_TO_ADDL_LOC_NM
            ,MAIN.SHIP_TO_FIRST_LINE_ADDR
            ,MAIN.SHIP_TO_SCD_LINE_ADDR
            ,MAIN.SHIP_TO_THIRD_LINE_ADDR
            ,MAIN.SHIP_TO_FRTH_LINE_ADDR
            ,MAIN.SHIP_VND_ADDR
            ,MAIN.SHIP_TO_POST_CD
            ,MAIN.SHIP_TO_CTY_ADDR
            ,MAIN.SHIP_TO_CNTY_NM
            ,MAIN.SHIP_TO_ST_CD
            ,MAIN.SHIP_TO_PROV_NM
            ,MAIN.SHIP_TO_CTRY_CD
            ,MAIN.CTRY_NM
            ,MAIN.VND_RTRN_RSN_CD
            ,MAIN.PRCH_REQ_REC_TP_CD
            ,MAIN.PRCH_REQ_CRAT_BY_PSN_CD
            ,MAIN.PRCH_GRP_CD
            ,MAIN.PRCH_REQ_APVL_DT
            ,MAIN.PRCH_REQ_APVL_BY_PSN_CD
            ,MAIN.FSR_NUM
            ,MAIN.SVC_TASK_NUM
            ,MAIN.SVC_MACH_SER_NUM
            ,MAIN.CPO_ORD_NUM
            ,MAIN.CUST_ISS_PO_NUM
            ,MAIN.CUST_ISS_PO_DT
            ,MAIN.CPO_ORD_TP_CD
            ,MAIN.RQST_TECH_TOC_CD
            ,MAIN.SHIP_TO_FIRST_REF_CMNT_TXT
            ,MAIN.SHIP_TO_SCD_REF_CMNT_TXT
            ,MAIN.BILL_TO_CUST_CD
            ,MAIN.SELL_TO_CUST_CD
            ,MAIN.LINE_BIZ_TP_CD
            ,MAIN.ADMIN_PSN_CD
            ,MAIN.DELY_ADDL_CMNT_TXT
            ,MAIN.RCV_ADDL_CMNT_TXT
            ,MAIN.PO_QLFY_CD
            ,MAIN.BAT_ERR_MSG_TXT
            ,MAIN.PRCH_REQ_INTFC_PK
            ,MAIN.ORIG_PRCH_REQ_LINE_NUM
            ,MAIN.ORIG_PRCH_REQ_LINE_SUB_NUM
            ,MAIN.RQST_RCV_TM
            ,MAIN.SHIP_FROM_SO_NUM
            ,MAIN.PO_SCHD_REL_DT
            ,MAIN.FRT_CHRG_TO_CD
            ,MAIN.FRT_CHRG_METH_CD
            ,MAIN.FRT_COND_CD
            ,MAIN.CARR_ACCT_NUM
            ,MAIN.PRCH_REQ_FRZ_FLG
            ,MAIN.PROCR_TP_CD
            ,MAIN.VND_INVTY_LOC_CD
            ,MAIN.PO_MDSE_CMPSN_TP_CD
            ,MAIN.ASL_MDSE_CD
            ,MAIN.ORD_QTY
            ,MAIN.CUST_UOM_CD
            ,MAIN.PRCH_REQ_DSPL_UOM_CD
            ,MAIN.PRCH_REQ_REL_QTY
            ,MAIN.ROP_QTY
            ,MAIN.MIN_ORD_QTY
            ,MAIN.INCR_ORD_QTY
            ,MAIN.MAX_INVTY_QTY
            ,MAIN.CUR_INVTY_QTY
            ,MAIN.CUR_INVTY_AVAL_QTY
            ,MAIN.SCHD_INBD_QTY
            ,MAIN.SCHD_OTBD_QTY
            ,MAIN.PRO_NUM
            ,MAIN.SHIP_DT_TM_TS
            ,MAIN.RWS_CLO_DT_TM_TS
            ,MAIN.RWS_PUT_AWAY_QTY
            ,MAIN.BACK_TO_TECH_QTY
            ,MAIN.FROM_STK_STS_CD
            ,MAIN.TO_STK_STS_CD
            ,MAIN.ASL_DTL_PK
            ,MAIN.ASL_UNIT_PRC_AMT
            ,MAIN.CCY_CD
            ,MAIN.EXCH_RATE
            ,MAIN.PRCH_REQ_REL_STS_CD
            ,MAIN.PRCH_REQ_REL_ERR_MSG_TXT
            ,MAIN.REL_RQST_TO_PO_ORD_NUM
            ,MAIN.INVTY_ORD_NUM
            ,MAIN.INVTY_ORD_LINE_NUM
            ,MAIN.WRK_ORD_NUM
            ,MAIN.WRK_ORD_DTL_LINE_NUM
            ,MAIN.TRX_REF_LINE_NUM
            ,MAIN.TRX_REF_LINE_SUB_NUM
            ,MAIN.SHPG_PLN_NUM
            ,MAIN.BO_EML_PROC_STS_CD
            ,MAIN.PRCH_REQ_SAVED_FLG
            ,MAIN.PRCH_REQ_APVL_FLG
            ,MAIN.OPEN_STS_FLG
            ,MAIN.PRCH_REQ_REL_DT_TM_TS
            ,MAIN.DEF_PRCH_REQ_LINE_TP_CD
            ,MAIN.LINE_OPEN_STS_FLG
            ,MAIN.SRC_RTL_WH_CATG_CD
            ,MAIN.DEST_RTL_WH_CATG_CD
            ,MAIN.DEST_INVTY_LOC_CD
            ,MAIN.DS_ACCT_NM
            ,MAIN.EZUPTIME
            ,MAIN.EZUPTIMEZONE
        FROM(
            SELECT
                PRD.PRCH_REQ_LINE_NUM
                ,PRD.PRCH_REQ_LINE_SUB_NUM
                ,PRD.PRCH_REQ_LINE_NUM || '.' || PRD.PRCH_REQ_LINE_SUB_NUM AS LINE_NUMBER
                ,PRD.CONFIG_TP_CD
                ,CT.CONFIG_TP_DESC_TXT
                ,PRD.PRCH_REQ_LINE_TP_CD
                ,PRD.MDSE_CD
                ,MDSE.MDSE_DESC_SHORT_TXT
                ,MDSE.SHPG_SER_TAKE_FLG
                ,PRD.SVC_CONFIG_MSTR_PK
                ,PRD.PRCH_REQ_DISP_QTY
                ,PRD.SHIP_QTY
                ,PRD.SRC_RTL_WH_CD
                ,RW.RTL_WH_NM AS SRC_RTL_WH_NM
                ,PRD.SRC_RTL_SWH_CD
                ,RS.RTL_SWH_NM AS SRC_RTL_SWH_NM
                ,CASE WHEN PR.PRCH_REQ_TP_CD = #expenseOrderTp# THEN NULL ELSE PRD.DEST_RTL_WH_CD END AS DEST_RTL_WH_CD
                ,RW2.RTL_WH_NM AS DEST_RTL_WH_NM
                ,PRD.DEST_RTL_SWH_CD
                ,RS2.RTL_SWH_NM AS DEST_RTL_SWH_NM
                ,PRD.PRNT_VND_CD
                ,PRD.VND_CD
                ,CASE
                    WHEN PVV.PRNT_VND_NM IS NOT NULL OR PVV.VND_NM IS NOT NULL THEN PVV.PRNT_VND_NM || ' - ' || PVV.VND_NM
                    ELSE NULL END AS DPLY_VND_NM
                ,PRD.PRCH_REQ_LINE_STS_CD
                ,PRLS.PRCH_REQ_LINE_STS_DESC_TXT
                ,PRD.ENT_DEAL_NET_UNIT_PRC_AMT
                ,PRD.ENT_PO_DTL_DEAL_NET_AMT
                ,PRD.COA_CMPY_CD
                ,PRD.COA_AFFL_CD
                ,PRD.COA_BR_CD
                ,PRD.COA_CC_CD
                ,PRD.COA_ACCT_CD
                ,PRD.COA_PROD_CD AS COA_PROD_CD2
                ,PRD.COA_CH_CD
                ,PRD.COA_PROJ_CD
                ,PRD.COA_EXTN_CD
                <!-- QC#13165 9seg sort change  -->
                <!-- ,PRD.COA_CMPY_CD ||  '.' || PRD.COA_AFFL_CD ||  '.' || PRD.COA_BR_CD ||  '.' || PRD.COA_CC_CD ||  '.' || PRD.COA_ACCT_CD ||  '.' || PRD.COA_PROD_CD ||  '.' || PRD.COA_CH_CD ||  '.' || PRD.COA_PROJ_CD ||  '.' || PRD.COA_EXTN_CD AS CHARGE_ACCOUNT -->
                <!-- START 2018/04/03 S.Katsuma [QC#23521,25063,MOD] -->
                ,CASE
                    <!-- WHEN (PR.PRCH_REQ_TP_CD = #prchReqTpCd# OR (PRD.CONFIG_TP_CD IS NOT NULL AND PRD.PRCH_REQ_LINE_SUB_NUM = '0')) THEN NULL -->
                    WHEN (PRT.CHRG_ACCT_EDTBL_FLG = #flgN# OR (PRD.CONFIG_TP_CD IS NOT NULL AND PRD.PRCH_REQ_LINE_SUB_NUM = '0')) THEN NULL
                    ELSE PRD.COA_CMPY_CD ||  '.' || PRD.COA_BR_CD ||  '.' || PRD.COA_CC_CD ||  '.' || PRD.COA_ACCT_CD ||  '.' || PRD.COA_PROD_CD ||  '.' || PRD.COA_CH_CD ||  '.' || PRD.COA_AFFL_CD ||  '.' || PRD.COA_PROJ_CD ||  '.' || PRD.COA_EXTN_CD
                 END AS CHARGE_ACCOUNT
                 <!-- END 2018/04/03 S.Katsuma [QC#23521,25063,MOD] -->
                ,MDSE.COA_MDSE_TP_CD
                ,MDSE.COA_PROD_CD
                ,(SELECT LISTAGG(PRSR.PRCH_REQ_SER_PK, ',') WITHIN GROUP (ORDER BY PRSR.SER_NUM)
                    FROM PRCH_REQ_SER PRSR
                    WHERE PRSR.PRCH_REQ_NUM            = PRD.PRCH_REQ_NUM
                      AND PRSR.PRCH_REQ_LINE_NUM       = PRD.PRCH_REQ_LINE_NUM
                      AND PRSR.PRCH_REQ_LINE_SUB_NUM   = PRD.PRCH_REQ_LINE_SUB_NUM
                      AND PRSR.GLBL_CMPY_CD            = PRD.GLBL_CMPY_CD
                      AND PRSR.EZCANCELFLAG            = '0') AS SERIAL_NUMBER_PK
                ,(SELECT LISTAGG(PRSR.SER_NUM, ',') WITHIN GROUP (ORDER BY PRSR.SER_NUM)
                    FROM PRCH_REQ_SER PRSR
                    WHERE PRSR.PRCH_REQ_NUM            = PRD.PRCH_REQ_NUM
                      AND PRSR.PRCH_REQ_LINE_NUM       = PRD.PRCH_REQ_LINE_NUM
                      AND PRSR.PRCH_REQ_LINE_SUB_NUM   = PRD.PRCH_REQ_LINE_SUB_NUM
                      AND PRSR.GLBL_CMPY_CD            = PRD.GLBL_CMPY_CD
                      AND PRSR.EZCANCELFLAG            = '0') AS SERIAL_NUMBER
                ,PRD.SO_NUM
                ,PRD.RWS_NUM
                ,PRD.PRCH_REQ_LINE_CMNT_TXT
                ,PR.PRCH_REQ_NUM
                ,PR.PRCH_REQ_TP_CD
                ,PR.PRCH_REQ_STS_CD
                ,PRS.PRCH_REQ_STS_DESC_TXT
                ,PR.PRCH_REQ_APVL_STS_CD
                ,PRAS.PRCH_REQ_APVL_STS_DESC_TXT
                ,PR.PRCH_REQ_CRAT_DT
                ,PRD.RQST_RCV_DT
                ,PR.PRCH_REQ_SRC_TP_CD
                ,PRST.PRCH_REQ_SRC_TP_DESC_TXT
                ,PR.TRX_REF_NUM
                ,PR.MRP_PLN_NM
                ,PR.PRCH_REQ_RQST_BY_PSN_CD
                ,AP.FIRST_NM || ' ' || CONCAT(AP.MID_NM, DECODE(AP.MID_NM, NULL, '', ' ')) || AP.LAST_NM AS FULL_PSN_NM
                ,SSUL.FULL_PSN_NM AS FULL_PSN_NM2
                ,PRD.SHPG_SVC_LVL_CD
                ,PRD.CARR_CD
                ,OCV.CARR_NM
                ,PR.CTAC_PSN_NM
                ,PR.PRCH_REQ_CMNT_TXT
                ,PR.SHIP_TO_CUST_CD
                ,PR.SHIP_TO_LOC_NM
                ,PR.SHIP_TO_ADDL_LOC_NM
                ,PR.SHIP_TO_FIRST_LINE_ADDR
                ,PR.SHIP_TO_SCD_LINE_ADDR
                ,PR.SHIP_TO_THIRD_LINE_ADDR
                ,PR.SHIP_TO_FRTH_LINE_ADDR
                ,SUBSTR(PR.SHIP_TO_FIRST_LINE_ADDR || ' ' || PR.SHIP_TO_SCD_LINE_ADDR || ' ' ||  PR.SHIP_TO_THIRD_LINE_ADDR || ' ' ||  PR.SHIP_TO_FRTH_LINE_ADDR, 1, 240) AS SHIP_VND_ADDR
                ,PR.SHIP_TO_POST_CD
                ,PR.SHIP_TO_CTY_ADDR
                ,PR.SHIP_TO_CNTY_NM
                ,PR.SHIP_TO_ST_CD
                ,PR.SHIP_TO_PROV_NM
                ,PR.SHIP_TO_CTRY_CD
                ,C.CTRY_NM
                ,PRD.VND_RTRN_RSN_CD
                ,PR.PRCH_REQ_REC_TP_CD
                ,PR.PRCH_REQ_CRAT_BY_PSN_CD
                ,PR.PRCH_GRP_CD
                ,PR.PRCH_REQ_APVL_DT
                ,PR.PRCH_REQ_APVL_BY_PSN_CD
                ,PR.FSR_NUM
                ,PR.SVC_TASK_NUM
                ,PR.SVC_MACH_SER_NUM
                ,CASE
                     WHEN PR.PRCH_REQ_TP_CD IN(#whTransferTp#, #expenseOrderTp#) THEN (
                         SELECT DISTINCT
                             DIO.CPO_ORD_NUM
                         FROM
                              DS_IMPT_ORD DIO
                             ,DS_IMPT_ORD_DTL DIOD
                         WHERE
                             PRD.GLBL_CMPY_CD      = DIO.GLBL_CMPY_CD
                         AND PRD.PRCH_REQ_NUM      = DIO.ORD_SRC_REF_NUM
                         AND DIO.GLBL_CMPY_CD      = DIOD.GLBL_CMPY_CD
                         AND DIO.DS_IMPT_ORD_PK    = DIOD.DS_IMPT_ORD_PK
                         AND PRD.PRCH_REQ_LINE_NUM = DIOD.ORD_SRC_REF_LINE_NUM
                         AND DIO.EZCANCELFLAG      = '0'
                         AND DIOD.EZCANCELFLAG     = '0'
                     )
                     ELSE PR.CPO_ORD_NUM
                 END AS CPO_ORD_NUM
                ,PR.CUST_ISS_PO_NUM
                ,PR.CUST_ISS_PO_DT
                ,PR.CPO_ORD_TP_CD
                ,PR.RQST_TECH_TOC_CD
                ,PR.SHIP_TO_FIRST_REF_CMNT_TXT
                ,PR.SHIP_TO_SCD_REF_CMNT_TXT
                ,PR.BILL_TO_CUST_CD
                ,PR.SELL_TO_CUST_CD
                ,PR.LINE_BIZ_TP_CD
                ,PR.ADMIN_PSN_CD
                ,PR.DELY_ADDL_CMNT_TXT
                ,PR.RCV_ADDL_CMNT_TXT
                ,PR.PO_QLFY_CD
                ,PR.BAT_ERR_MSG_TXT
                ,PRD.PRCH_REQ_INTFC_PK
                ,PRD.ORIG_PRCH_REQ_LINE_NUM
                ,PRD.ORIG_PRCH_REQ_LINE_SUB_NUM
                ,PRD.RQST_RCV_TM
                ,PRD.SHIP_FROM_SO_NUM
                ,PRD.PO_SCHD_REL_DT
                ,PRD.FRT_CHRG_TO_CD
                ,PRD.FRT_CHRG_METH_CD
                ,PRD.FRT_COND_CD
                ,PRD.CARR_ACCT_NUM
                ,PRD.PRCH_REQ_FRZ_FLG
                ,PRD.PROCR_TP_CD
                ,PRD.VND_INVTY_LOC_CD
                ,PRD.PO_MDSE_CMPSN_TP_CD
                ,PRD.ASL_MDSE_CD
                ,PRD.ORD_QTY
                ,PRD.CUST_UOM_CD
                ,PRD.PRCH_REQ_DSPL_UOM_CD
                ,PRD.PRCH_REQ_REL_QTY
                ,PRD.ROP_QTY
                ,PRD.MIN_ORD_QTY
                ,PRD.INCR_ORD_QTY
                ,PRD.MAX_INVTY_QTY
                ,PRD.CUR_INVTY_QTY
                ,PRD.CUR_INVTY_AVAL_QTY
                ,PRD.SCHD_INBD_QTY
                ,PRD.SCHD_OTBD_QTY
                ,PRD.PRO_NUM
                ,PRD.SHIP_DT_TM_TS
                ,PRD.RWS_CLO_DT_TM_TS
                ,PRD.RWS_PUT_AWAY_QTY
                ,PRD.BACK_TO_TECH_QTY
                ,PRD.FROM_STK_STS_CD
                ,PRD.TO_STK_STS_CD
                ,PRD.ASL_DTL_PK
                ,PRD.ASL_UNIT_PRC_AMT
                ,PRD.CCY_CD
                ,PRD.EXCH_RATE
                ,PRD.PRCH_REQ_REL_STS_CD
                ,PRD.PRCH_REQ_REL_ERR_MSG_TXT
                ,PRD.REL_RQST_TO_PO_ORD_NUM
                ,PRD.INVTY_ORD_NUM
                ,PRD.INVTY_ORD_LINE_NUM
                ,PRD.WRK_ORD_NUM
                ,PRD.WRK_ORD_DTL_LINE_NUM
                ,PRD.TRX_REF_LINE_NUM
                ,PRD.TRX_REF_LINE_SUB_NUM
                ,PRD.SHPG_PLN_NUM
                ,PRD.BO_EML_PROC_STS_CD
                ,PRAS.PRCH_REQ_SAVED_FLG
                ,PRAS.PRCH_REQ_APVL_FLG
                ,PRS.OPEN_STS_FLG
                ,PRD.PRCH_REQ_REL_DT_TM_TS
                ,PRT.DEF_PRCH_REQ_LINE_TP_CD
                ,PRLS.OPEN_STS_FLG AS LINE_OPEN_STS_FLG
                ,RW.RTL_WH_CATG_CD AS SRC_RTL_WH_CATG_CD
                ,RW2.RTL_WH_CATG_CD AS DEST_RTL_WH_CATG_CD
                ,CASE WHEN PR.PRCH_REQ_TP_CD = #expenseOrderTp# THEN PRD.DEST_INVTY_LOC_CD 
                 WHEN PR.PRCH_REQ_TP_CD = #whTransferTp# THEN NULL
                 WHEN PR.PRCH_REQ_TP_CD = #kittingTp# THEN NULL
                 WHEN PR.SHIP_TO_CUST_CD = PRD.SRC_RTL_WH_CD THEN NULL
                 WHEN PR.SHIP_TO_CUST_CD = PRD.VND_CD THEN NULL
                 ELSE PR.SHIP_TO_CUST_CD END AS DEST_INVTY_LOC_CD
<!-- START 2019/09/26 T.Ogura [QC#52362,MOD] -->
<!--            ,CASE WHEN PR.PRCH_REQ_TP_CD = #expenseOrderTp# THEN DAC.DS_ACCT_NM -->
                ,CASE WHEN PR.PRCH_REQ_TP_CD = #expenseOrderTp# THEN SUBSTR(DAC.DS_ACCT_NM, 1, 60)
<!-- END   2019/09/26 T.Ogura [QC#52362,MOD] -->
                 WHEN PR.PRCH_REQ_TP_CD = #whTransferTp# THEN NULL
                 WHEN PR.PRCH_REQ_TP_CD = #kittingTp# THEN NULL
                 WHEN PR.SHIP_TO_CUST_CD = PRD.SRC_RTL_WH_CD THEN NULL
                 WHEN PR.SHIP_TO_CUST_CD = PRD.VND_CD THEN NULL
                 ELSE PR.SHIP_TO_LOC_NM END AS DS_ACCT_NM
                ,PR.EZUPTIME
                ,PR.EZUPTIMEZONE
            FROM
                PRCH_REQ             PR
                ,PRCH_REQ_DTL        PRD
                ,PRCH_REQ_STS        PRS
                ,PRCH_REQ_APVL_STS   PRAS
                ,PRCH_REQ_SRC_TP     PRST
                ,AUTH_PSN            AP
                ,SCE_SYS_USR_LIST    SSUL
                ,OTBD_CARR_V         OCV
                ,PO_VND_V            PVV
                ,CONFIG_TP           CT
                ,RTL_WH              RW
                ,RTL_SWH             RS
                ,RTL_WH              RW2
                ,RTL_SWH             RS2
                ,PRCH_REQ_LINE_STS   PRLS
                ,MDSE                MDSE
                ,CTRY                C
                ,PRCH_REQ_TP         PRT
                ,STK_STS             SS
                ,SHIP_TO_CUST        STC
                ,LOC_TP              LT
                ,SELL_TO_CUST        DAC
            WHERE
                PR.GLBL_CMPY_CD                = #glblCmpyCd#
            AND PR.PRCH_REQ_REC_TP_CD          = #prchReqRecTpCd#
            AND PR.PRCH_REQ_NUM                = #cMsg.prchReqNum#
            AND PR.PRCH_REQ_NUM                = PRD.PRCH_REQ_NUM
            AND PR.GLBL_CMPY_CD                = PRD.GLBL_CMPY_CD
            AND PR.PRCH_REQ_STS_CD             = PRS.PRCH_REQ_STS_CD(+)
            AND PR.GLBL_CMPY_CD                = PRS.GLBL_CMPY_CD(+)
            AND PR.PRCH_REQ_APVL_STS_CD        = PRAS.PRCH_REQ_APVL_STS_CD(+)
            AND PR.GLBL_CMPY_CD                = PRAS.GLBL_CMPY_CD(+)
            AND PR.PRCH_REQ_SRC_TP_CD          = PRST.PRCH_REQ_SRC_TP_CD(+)
            AND PR.GLBL_CMPY_CD                = PRST.GLBL_CMPY_CD(+)
            AND PR.PRCH_REQ_RQST_BY_PSN_CD     = AP.USR_NM(+)
            AND PR.GLBL_CMPY_CD                = AP.GLBL_CMPY_CD(+)
            AND PR.PRCH_REQ_RQST_BY_PSN_CD     = SSUL.FULL_PSN_NM(+)
            AND PR.GLBL_CMPY_CD                = SSUL.GLBL_CMPY_CD(+)
            AND PRD.CARR_CD                    = OCV.CARR_CD(+)
            AND PRD.GLBL_CMPY_CD               = OCV.GLBL_CMPY_CD(+)
            AND PRD.VND_CD                     = PVV.VND_CD(+)
            AND PRD.GLBL_CMPY_CD               = PVV.GLBL_CMPY_CD(+)
            AND PRD.CONFIG_TP_CD               = CT.CONFIG_TP_CD(+)
            AND PRD.GLBL_CMPY_CD               = CT.GLBL_CMPY_CD(+)
            AND PRD.SRC_RTL_WH_CD              = RW.RTL_WH_CD(+)
            AND PRD.GLBL_CMPY_CD               = RW.GLBL_CMPY_CD(+)
            AND PRD.SRC_RTL_WH_CD              = RS.RTL_WH_CD(+)
            AND PRD.SRC_RTL_SWH_CD             = RS.RTL_SWH_CD(+)
            AND PRD.GLBL_CMPY_CD               = RS.GLBL_CMPY_CD(+)
            AND PRD.DEST_RTL_WH_CD             = RW2.RTL_WH_CD(+)
            AND PRD.GLBL_CMPY_CD               = RW2.GLBL_CMPY_CD(+)
            AND PRD.DEST_RTL_WH_CD             = RS2.RTL_WH_CD(+)
            AND PRD.DEST_RTL_SWH_CD            = RS2.RTL_SWH_CD(+)
            AND PRD.GLBL_CMPY_CD               = RS2.GLBL_CMPY_CD(+)
            AND PRD.PRCH_REQ_LINE_STS_CD       = PRLS.PRCH_REQ_LINE_STS_CD(+)
            AND PRD.GLBL_CMPY_CD               = PRLS.GLBL_CMPY_CD(+)
            AND PRD.MDSE_CD                    = MDSE.MDSE_CD(+)
            AND PRD.GLBL_CMPY_CD               = MDSE.GLBL_CMPY_CD(+)
            AND PR.SHIP_TO_CTRY_CD             = C.CTRY_CD(+)
            AND PR.GLBL_CMPY_CD                = C.GLBL_CMPY_CD(+)
            AND PR.PRCH_REQ_TP_CD              = PRT.PRCH_REQ_TP_CD(+)
            AND PR.GLBL_CMPY_CD                = PRT.GLBL_CMPY_CD(+)
            AND PRD.GLBL_CMPY_CD               = SS.GLBL_CMPY_CD(+)
            AND PRD.FROM_STK_STS_CD            = SS.STK_STS_CD(+)
            AND PRD.GLBL_CMPY_CD               = STC.GLBL_CMPY_CD(+)
            AND PRD.DEST_INVTY_LOC_CD          = STC.SHIP_TO_CUST_CD(+)
            AND STC.GLBL_CMPY_CD               = LT.GLBL_CMPY_CD(+)
            AND STC.LOC_GRP_CD                 = LT.LOC_GRP_CD(+)
            AND STC.LOC_ROLE_TP_CD             = LT.LOC_ROLE_TP_CD(+)
            AND STC.GLBL_CMPY_CD               = DAC.GLBL_CMPY_CD(+)
            AND STC.SELL_TO_CUST_CD            = DAC.SELL_TO_CUST_CD(+)
            AND PR.EZCANCELFLAG                = '0'
            AND PRD.EZCANCELFLAG               = '0'
            AND PRS.EZCANCELFLAG(+)            = '0'
            AND PRAS.EZCANCELFLAG(+)           = '0'
            AND PRST.EZCANCELFLAG(+)           = '0'
            AND AP.EZCANCELFLAG(+)             = '0'
            AND SSUL.EZCANCELFLAG(+)           = '0'
            AND OCV.EZCANCELFLAG(+)            = '0'
            AND PVV.EZCANCELFLAG(+)            = '0'
            AND CT.EZCANCELFLAG(+)             = '0'
            AND MDSE.EZCANCELFLAG(+)           = '0'
            AND RW.EZCANCELFLAG(+)             = '0'
            AND RS.EZCANCELFLAG(+)             = '0'
            AND RW2.EZCANCELFLAG(+)            = '0'
            AND RS2.EZCANCELFLAG(+)            = '0'
            AND PRLS.EZCANCELFLAG(+)           = '0'
            AND MDSE.EZCANCELFLAG(+)           = '0'
            AND C.EZCANCELFLAG(+)              = '0'
            AND PRT.EZCANCELFLAG(+)            = '0'
            AND SS.EZCANCELFLAG(+)             = '0'
            AND STC.EZCANCELFLAG(+)            = '0'
            AND LT.EZCANCELFLAG(+)             = '0'
            AND DAC.EZCANCELFLAG(+)            = '0'
            ORDER BY
                PR.PRCH_REQ_NUM ASC
                ,PRD.PRCH_REQ_LINE_NUM ASC
                ,PRD.PRCH_REQ_LINE_SUB_NUM ASC
        ) MAIN
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <resultMap id="result.NPBL0020_ASMsg" class="NPBL0020_ASMsg">
        <result property="prchReqLineNum_A1"             column="PRCH_REQ_LINE_NUM"               javaType="EZDSStringItem"/>
        <result property="prchReqLineSubNum_A1"          column="PRCH_REQ_LINE_SUB_NUM"           javaType="EZDSBigDecimalItem"/>
        <result property="xxScrItem20Txt_A1"             column="LINE_NUMBER"                     javaType="EZDSStringItem"/>
        <result property="configTpCd_A1"                 column="CONFIG_TP_CD"                    javaType="EZDSStringItem"/>
        <result property="configTpDescTxt_A1"            column="CONFIG_TP_DESC_TXT"              javaType="EZDSStringItem"/>
        <result property="prchReqLineTpCd_A1"            column="PRCH_REQ_LINE_TP_CD"             javaType="EZDSStringItem"/>
        <result property="mdseCd_A1"                     column="MDSE_CD"                         javaType="EZDSStringItem"/>
        <result property="mdseDescShortTxt_A1"           column="MDSE_DESC_SHORT_TXT"             javaType="EZDSStringItem"/>
        <result property="shpgSerTakeFlg_A1"             column="SHPG_SER_TAKE_FLG"               javaType="EZDSStringItem"/>
        <result property="svcConfigMstrPk_A1"            column="SVC_CONFIG_MSTR_PK"              javaType="EZDSBigDecimalItem"/>
        <result property="prchReqDispQty_A1"             column="PRCH_REQ_DISP_QTY"               javaType="EZDSBigDecimalItem"/>
        <result property="shipQty_A1"                    column="SHIP_QTY"                        javaType="EZDSBigDecimalItem"/>
        <result property="srcRtlWhCd_A1"                 column="SRC_RTL_WH_CD"                   javaType="EZDSStringItem"/>
        <result property="rtlWhNm_A1"                    column="SRC_RTL_WH_NM"                   javaType="EZDSStringItem"/>
        <result property="srcRtlSwhCd_A1"                column="SRC_RTL_SWH_CD"                  javaType="EZDSStringItem"/>
        <result property="rtlSwhNm_A1"                   column="SRC_RTL_SWH_NM"                  javaType="EZDSStringItem"/>
        <result property="destRtlWhCd_A1"                column="DEST_RTL_WH_CD"                  javaType="EZDSStringItem"/>
        <result property="rtlWhNm_A2"                    column="DEST_RTL_WH_NM"                  javaType="EZDSStringItem"/>
        <result property="destRtlSwhCd_A1"               column="DEST_RTL_SWH_CD"                 javaType="EZDSStringItem"/>
        <result property="rtlSwhNm_A2"                   column="DEST_RTL_SWH_NM"                 javaType="EZDSStringItem"/>
        <result property="prntVndCd_A1"                  column="PRNT_VND_CD"                     javaType="EZDSStringItem"/>
        <result property="vndCd_A1"                      column="VND_CD"                          javaType="EZDSStringItem"/>
        <result property="dplyVndNm_A1"                  column="DPLY_VND_NM"                     javaType="EZDSStringItem"/>
        <result property="prchReqLineStsCd_A1"           column="PRCH_REQ_LINE_STS_CD"            javaType="EZDSStringItem"/>
        <result property="prchReqLineStsDescTxt_A1"      column="PRCH_REQ_LINE_STS_DESC_TXT"      javaType="EZDSStringItem"/>
        <result property="entDealNetUnitPrcAmt_A1"       column="ENT_DEAL_NET_UNIT_PRC_AMT"       javaType="EZDSBigDecimalItem"/>
        <result property="entPoDtlDealNetAmt_A1"         column="ENT_PO_DTL_DEAL_NET_AMT"         javaType="EZDSBigDecimalItem"/>
        <result property="coaCmpyCd_A1"                  column="COA_CMPY_CD"                     javaType="EZDSStringItem"/>
        <result property="coaAfflCd_A1"                  column="COA_AFFL_CD"                     javaType="EZDSStringItem"/>
        <result property="coaBrCd_A1"                    column="COA_BR_CD"                       javaType="EZDSStringItem"/>
        <result property="coaCcCd_A1"                    column="COA_CC_CD"                       javaType="EZDSStringItem"/>
        <result property="coaAcctCd_A1"                  column="COA_ACCT_CD"                     javaType="EZDSStringItem"/>
        <result property="coaProdCd_A2"                  column="COA_PROD_CD2"                    javaType="EZDSStringItem"/>
        <result property="coaChCd_A1"                    column="COA_CH_CD"                       javaType="EZDSStringItem"/>
        <result property="coaProjCd_A1"                  column="COA_PROJ_CD"                     javaType="EZDSStringItem"/>
        <result property="coaExtnCd_A1"                  column="COA_EXTN_CD"                     javaType="EZDSStringItem"/>
        <result property="xxScrItem50Txt_A1"             column="CHARGE_ACCOUNT"                  javaType="EZDSStringItem"/>
        <result property="coaMdseTpCd_A1"                column="COA_MDSE_TP_CD"                  javaType="EZDSStringItem"/>
        <result property="coaProdCd_A1"                  column="COA_PROD_CD"                     javaType="EZDSStringItem"/>
        <result property="xxLogDtlTxt_A2"                column="SERIAL_NUMBER_PK"                javaType="EZDSStringItem"/>
        <result property="xxLogDtlTxt_A1"                column="SERIAL_NUMBER"                   javaType="EZDSStringItem"/>
        <result property="cpoOrdNum_A1"                  column="CPO_ORD_NUM"                     javaType="EZDSStringItem"/>
        <result property="soNum_A1"                      column="SO_NUM"                          javaType="EZDSStringItem"/>
        <result property="rwsNum_A1"                     column="RWS_NUM"                         javaType="EZDSStringItem"/>
        <result property="prchReqLineCmntTxt_A1"         column="PRCH_REQ_LINE_CMNT_TXT"          javaType="EZDSStringItem"/>
        <result property="prchReqNum_A1"                 column="PRCH_REQ_NUM"                    javaType="EZDSStringItem"/>
        <result property="prchReqTpCd_A1"                column="PRCH_REQ_TP_CD"                  javaType="EZDSStringItem"/>
        <result property="prchReqStsCd_A1"               column="PRCH_REQ_STS_CD"                 javaType="EZDSStringItem"/>
        <result property="prchReqStsDescTxt_A1"          column="PRCH_REQ_STS_DESC_TXT"           javaType="EZDSStringItem"/>
        <result property="prchReqApvlStsCd_A1"           column="PRCH_REQ_APVL_STS_CD"            javaType="EZDSStringItem"/>
        <result property="prchReqApvlStsDescTxt_A1"      column="PRCH_REQ_APVL_STS_DESC_TXT"      javaType="EZDSStringItem"/>
        <result property="prchReqCratDt_A1"              column="PRCH_REQ_CRAT_DT"                javaType="EZDSDateItem"/>
        <result property="rqstRcvDt_A1"                  column="RQST_RCV_DT"                     javaType="EZDSDateItem"/>
        <result property="prchReqSrcTpCd_A1"             column="PRCH_REQ_SRC_TP_CD"              javaType="EZDSStringItem"/>
        <result property="prchReqSrcTpDescTxt_A1"        column="PRCH_REQ_SRC_TP_DESC_TXT"        javaType="EZDSStringItem"/>
        <result property="trxRefNum_A1"                  column="TRX_REF_NUM"                     javaType="EZDSStringItem"/>
        <result property="mrpPlnNm_A1"                   column="MRP_PLN_NM"                      javaType="EZDSStringItem"/>
        <result property="prchReqRqstByPsnCd_A1"         column="PRCH_REQ_RQST_BY_PSN_CD"         javaType="EZDSStringItem"/>
        <result property="fullPsnNm_A1"                  column="FULL_PSN_NM"                     javaType="EZDSStringItem"/>
        <result property="shpgSvcLvlCd_A1"               column="SHPG_SVC_LVL_CD"                 javaType="EZDSStringItem"/>
        <result property="carrCd_A1"                     column="CARR_CD"                         javaType="EZDSStringItem"/>
        <result property="carrNm_A1"                     column="CARR_NM"                         javaType="EZDSStringItem"/>
        <result property="ctacPsnNm_A1"                  column="CTAC_PSN_NM"                     javaType="EZDSStringItem"/>
        <result property="prchReqCmntTxt_A1"             column="PRCH_REQ_CMNT_TXT"               javaType="EZDSStringItem"/>
        <result property="shipToCustCd_A1"               column="SHIP_TO_CUST_CD"                 javaType="EZDSStringItem"/>
        <result property="shipToLocNm_A1"                column="SHIP_TO_LOC_NM"                  javaType="EZDSStringItem"/>
        <result property="shipToAddlLocNm_A1"            column="SHIP_TO_ADDL_LOC_NM"             javaType="EZDSStringItem"/>
        <result property="shipToFirstLineAddr_A1"        column="SHIP_TO_FIRST_LINE_ADDR"         javaType="EZDSStringItem"/>
        <result property="shipToScdLineAddr_A1"          column="SHIP_TO_SCD_LINE_ADDR"           javaType="EZDSStringItem"/>
        <result property="shipToThirdLineAddr_A1"        column="SHIP_TO_THIRD_LINE_ADDR"         javaType="EZDSStringItem"/>
        <result property="shipToFrthLineAddr_A1"         column="SHIP_TO_FRTH_LINE_ADDR"          javaType="EZDSStringItem"/>
        <result property="xxShipVndAddr_A1"              column="SHIP_VND_ADDR"                   javaType="EZDSStringItem"/>
        <result property="shipToPostCd_A1"               column="SHIP_TO_POST_CD"                 javaType="EZDSStringItem"/>
        <result property="shipToCtyAddr_A1"              column="SHIP_TO_CTY_ADDR"                javaType="EZDSStringItem"/>
        <result property="shipToCntyNm_A1"               column="SHIP_TO_CNTY_NM"                 javaType="EZDSStringItem"/>
        <result property="shipToStCd_A1"                 column="SHIP_TO_ST_CD"                   javaType="EZDSStringItem"/>
        <result property="shipToProvNm_A1"               column="SHIP_TO_PROV_NM"                 javaType="EZDSStringItem"/>
        <result property="shipToCtryCd_A1"               column="SHIP_TO_CTRY_CD"                 javaType="EZDSStringItem"/>
        <result property="ctryNm_A1"                     column="CTRY_NM"                         javaType="EZDSStringItem"/>
        <result property="vndRtrnRsnCd_A1"               column="VND_RTRN_RSN_CD"                 javaType="EZDSStringItem"/>
        <result property="prchReqRecTpCd_A1"             column="PRCH_REQ_REC_TP_CD"              javaType="EZDSStringItem"/>
        <result property="prchReqCratByPsnCd_A1"         column="PRCH_REQ_CRAT_BY_PSN_CD"         javaType="EZDSStringItem"/>
        <result property="prchGrpCd_A1"                  column="PRCH_GRP_CD"                     javaType="EZDSStringItem"/>
        <result property="prchReqApvlDt_A1"              column="PRCH_REQ_APVL_DT"                javaType="EZDSDateItem"/>
        <result property="prchReqApvlByPsnCd_A1"         column="PRCH_REQ_APVL_BY_PSN_CD"         javaType="EZDSStringItem"/>
        <result property="fsrNum_A1"                     column="FSR_NUM"                         javaType="EZDSStringItem"/>
        <result property="svcTaskNum_A1"                 column="SVC_TASK_NUM"                    javaType="EZDSStringItem"/>
        <result property="svcMachSerNum_A1"              column="SVC_MACH_SER_NUM"                javaType="EZDSStringItem"/>
        <result property="cpoOrdNum_A1"                  column="CPO_ORD_NUM"                     javaType="EZDSStringItem"/>
        <result property="custIssPoNum_A1"               column="CUST_ISS_PO_NUM"                 javaType="EZDSStringItem"/>
        <result property="custIssPoDt_A1"                column="CUST_ISS_PO_DT"                  javaType="EZDSDateItem"/>
        <result property="cpoOrdTpCd_A1"                 column="CPO_ORD_TP_CD"                   javaType="EZDSStringItem"/>
        <result property="rqstTechTocCd_A1"              column="RQST_TECH_TOC_CD"                javaType="EZDSStringItem"/>
        <result property="shipToFirstRefCmntTxt_A1"      column="SHIP_TO_FIRST_REF_CMNT_TXT"      javaType="EZDSStringItem"/>
        <result property="shipToScdRefCmntTxt_A1"        column="SHIP_TO_SCD_REF_CMNT_TXT"        javaType="EZDSStringItem"/>
        <result property="billToCustCd_A1"               column="BILL_TO_CUST_CD"                 javaType="EZDSStringItem"/>
        <result property="sellToCustCd_A1"               column="SELL_TO_CUST_CD"                 javaType="EZDSStringItem"/>
        <result property="lineBizTpCd_A1"                column="LINE_BIZ_TP_CD"                  javaType="EZDSStringItem"/>
        <result property="adminPsnCd_A1"                 column="ADMIN_PSN_CD"                    javaType="EZDSStringItem"/>
        <result property="delyAddlCmntTxt_A1"            column="DELY_ADDL_CMNT_TXT"              javaType="EZDSStringItem"/>
        <result property="rcvAddlCmntTxt_A1"             column="RCV_ADDL_CMNT_TXT"               javaType="EZDSStringItem"/>
        <result property="poQlfyCd_A1"                   column="PO_QLFY_CD"                      javaType="EZDSStringItem"/>
        <result property="batErrMsgTxt_A1"               column="BAT_ERR_MSG_TXT"                 javaType="EZDSStringItem"/>
        <result property="prchReqIntfcPk_A1"             column="PRCH_REQ_INTFC_PK"               javaType="EZDSBigDecimalItem"/>
        <result property="origPrchReqLineNum_A1"         column="ORIG_PRCH_REQ_LINE_NUM"          javaType="EZDSStringItem"/>
        <result property="origPrchReqLineSubNum_A1"      column="ORIG_PRCH_REQ_LINE_SUB_NUM"      javaType="EZDSBigDecimalItem"/>
        <result property="rqstRcvTm_A1"                  column="RQST_RCV_TM"                     javaType="EZDSStringItem"/>
        <result property="shipFromSoNum_A1"              column="SHIP_FROM_SO_NUM"                javaType="EZDSStringItem"/>
        <result property="poSchdRelDt_A1"                column="PO_SCHD_REL_DT"                  javaType="EZDSDateItem"/>
        <result property="frtChrgToCd_A1"                column="FRT_CHRG_TO_CD"                  javaType="EZDSStringItem"/>
        <result property="frtChrgMethCd_A1"              column="FRT_CHRG_METH_CD"                javaType="EZDSStringItem"/>
        <result property="frtCondCd_A1"                  column="FRT_COND_CD"                     javaType="EZDSStringItem"/>
        <result property="carrAcctNum_A1"                column="CARR_ACCT_NUM"                   javaType="EZDSStringItem"/>
        <result property="prchReqFrzFlg_A1"              column="PRCH_REQ_FRZ_FLG"                javaType="EZDSStringItem"/>
        <result property="procrTpCd_A1"                  column="PROCR_TP_CD"                     javaType="EZDSStringItem"/>
        <result property="vndInvtyLocCd_A1"              column="VND_INVTY_LOC_CD"                javaType="EZDSStringItem"/>
        <result property="poMdseCmpsnTpCd_A1"            column="PO_MDSE_CMPSN_TP_CD"             javaType="EZDSStringItem"/>
        <result property="aslMdseCd_A1"                  column="ASL_MDSE_CD"                     javaType="EZDSStringItem"/>
        <result property="ordQty_A1"                     column="ORD_QTY"                         javaType="EZDSBigDecimalItem"/>
        <result property="custUomCd_A1"                  column="CUST_UOM_CD"                     javaType="EZDSStringItem"/>
        <result property="prchReqDsplUomCd_A1"           column="PRCH_REQ_DSPL_UOM_CD"            javaType="EZDSStringItem"/>
        <result property="prchReqRelQty_A1"              column="PRCH_REQ_REL_QTY"                javaType="EZDSBigDecimalItem"/>
        <result property="ropQty_A1"                     column="ROP_QTY"                         javaType="EZDSBigDecimalItem"/>
        <result property="minOrdQty_A1"                  column="MIN_ORD_QTY"                     javaType="EZDSBigDecimalItem"/>
        <result property="incrOrdQty_A1"                 column="INCR_ORD_QTY"                    javaType="EZDSBigDecimalItem"/>
        <result property="maxInvtyQty_A1"                column="MAX_INVTY_QTY"                   javaType="EZDSBigDecimalItem"/>
        <result property="curInvtyQty_A1"                column="CUR_INVTY_QTY"                   javaType="EZDSBigDecimalItem"/>
        <result property="curInvtyAvalQty_A1"            column="CUR_INVTY_AVAL_QTY"              javaType="EZDSBigDecimalItem"/>
        <result property="schdInbdQty_A1"                column="SCHD_INBD_QTY"                   javaType="EZDSBigDecimalItem"/>
        <result property="schdOtbdQty_A1"                column="SCHD_OTBD_QTY"                   javaType="EZDSBigDecimalItem"/>
        <result property="proNum_A1"                     column="PRO_NUM"                         javaType="EZDSStringItem"/>
        <result property="shipDtTmTs_A1"                 column="SHIP_DT_TM_TS"                   javaType="EZDSStringItem"/>
        <result property="rwsCloDtTmTs_A1"               column="RWS_CLO_DT_TM_TS"                javaType="EZDSStringItem"/>
        <result property="rwsPutAwayQty_A1"              column="RWS_PUT_AWAY_QTY"                javaType="EZDSBigDecimalItem"/>
        <result property="backToTechQty_A1"              column="BACK_TO_TECH_QTY"                javaType="EZDSBigDecimalItem"/>
        <result property="fromStkStsCd_A1"               column="FROM_STK_STS_CD"                 javaType="EZDSStringItem"/>
        <result property="toStkStsCd_A1"                 column="TO_STK_STS_CD"                   javaType="EZDSStringItem"/>
        <result property="aslDtlPk_A1"                   column="ASL_DTL_PK"                      javaType="EZDSBigDecimalItem"/>
        <result property="aslUnitPrcAmt_A1"              column="ASL_UNIT_PRC_AMT"                javaType="EZDSBigDecimalItem"/>
        <result property="ccyCd_A1"                      column="CCY_CD"                          javaType="EZDSStringItem"/>
        <result property="exchRate_A1"                   column="EXCH_RATE"                       javaType="EZDSBigDecimalItem"/>
        <result property="prchReqRelStsCd_A1"            column="PRCH_REQ_REL_STS_CD"             javaType="EZDSStringItem"/>
        <result property="prchReqRelErrMsgTxt_A1"        column="PRCH_REQ_REL_ERR_MSG_TXT"        javaType="EZDSStringItem"/>
        <result property="relRqstToPoOrdNum_A1"          column="REL_RQST_TO_PO_ORD_NUM"          javaType="EZDSStringItem"/>
        <result property="invtyOrdNum_A1"                column="INVTY_ORD_NUM"                   javaType="EZDSStringItem"/>
        <result property="invtyOrdLineNum_A1"            column="INVTY_ORD_LINE_NUM"              javaType="EZDSStringItem"/>
        <result property="wrkOrdNum_A1"                  column="WRK_ORD_NUM"                     javaType="EZDSStringItem"/>
        <result property="wrkOrdDtlLineNum_A1"           column="WRK_ORD_DTL_LINE_NUM"            javaType="EZDSStringItem"/>
        <result property="trxRefLineNum_A1"              column="TRX_REF_LINE_NUM"                javaType="EZDSStringItem"/>
        <result property="trxRefLineSubNum_A1"           column="TRX_REF_LINE_SUB_NUM"            javaType="EZDSStringItem"/>
        <result property="shpgPlnNum_A1"                 column="SHPG_PLN_NUM"                    javaType="EZDSStringItem"/>
        <result property="boEmlProcStsCd_A1"             column="BO_EML_PROC_STS_CD"              javaType="EZDSStringItem"/>
        <result property="prchReqSavedFlg_A1"            column="PRCH_REQ_SAVED_FLG"              javaType="EZDSStringItem"/>
        <result property="prchReqApvlFlg_A1"             column="PRCH_REQ_APVL_FLG"               javaType="EZDSStringItem"/>
        <result property="openStsFlg_A1"                 column="OPEN_STS_FLG"                    javaType="EZDSStringItem"/>
        <result property="prchReqRelDtTmTs_A1"           column="PRCH_REQ_REL_DT_TM_TS"           javaType="EZDSStringItem"/>
        <result property="defPrchReqLineTpCd_A1"         column="DEF_PRCH_REQ_LINE_TP_CD"         javaType="EZDSStringItem"/>
        <result property="openStsFlg_A2"                 column="LINE_OPEN_STS_FLG"               javaType="EZDSStringItem"/>
        <result property="rtlWhCatgCd_A1"                column="SRC_RTL_WH_CATG_CD"              javaType="EZDSStringItem"/>
        <result property="rtlWhCatgCd_A2"                column="DEST_RTL_WH_CATG_CD"             javaType="EZDSStringItem"/>
        <result property="shipToCustCd_E1"               column="DEST_INVTY_LOC_CD"               javaType="EZDSStringItem"/>
        <result property="shipToLocNm_E1"                column="DS_ACCT_NM"                      javaType="EZDSStringItem"/>
        <result property="xxRqstTs_A1"                   column="EZUPTIME"                        javaType="EZDSStringItem"/>
        <result property="xxRqstTz_A1"                   column="EZUPTIMEZONE"                    javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="checkExistenceForCPO" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(*)
         FROM
             CPO   CPO
         WHERE
             CPO.GLBL_CMPY_CD    = #glblCmpyCd#
         AND CPO.ORD_SRC_REF_NUM = #prchReqNum#
         AND CPO.CPO_CANC_FLG    = #flgOffN#
         AND CPO.EZCANCELFLAG    = '0'
         AND ROWNUM              = 1
    </statement>

    <statement id="checkExistenceForInventoryOrder" parameterClass="Map" resultClass="Integer">
        SELECT
                count(*)
         FROM
                INVTY_ORD     DIO
              , INVTY_ORD_DTL DIOD
         WHERE
                DIO.GLBL_CMPY_CD      = DIO.GLBL_CMPY_CD
            AND DIO.INVTY_ORD_NUM     = DIOD.INVTY_ORD_NUM
            AND DIO.GLBL_CMPY_CD      = #glblCmpyCd#
            AND DIOD.PRCH_REQ_NUM     = #prchReqNum#
            AND DIO.INVTY_ORD_CANC_TS IS NULL
            AND DIO.EZCANCELFLAG      = '0'
            AND DIOD.EZCANCELFLAG     = '0'
            AND ROWNUM                = 1
    </statement>

    <statement id="checkExistenceForVendorReturn" parameterClass="Map" resultClass="Integer">
        SELECT
                count(*)
         FROM
                VND_RTRN     VR
         WHERE
                VR.GLBL_CMPY_CD       = #glblCmpyCd#
            AND VR.VND_RTRN_NUM       = #prchReqNum#
            AND VR.VND_RTRN_CANC_DT   IS NULL
            AND VR.EZCANCELFLAG       = '0'
            AND ROWNUM                = 1
    </statement>

    <statement id="checkExistenceForWorkOrder" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(*)
        FROM
             WRK_ORD WO
        WHERE
            WO.GLBL_CMPY_CD   = #glblCmpyCd#
        AND WO.PRCH_REQ_NUM   = #prchReqNum#
        AND WO.WRK_ORD_STS_CD NOT IN (#wrkOrdSts_cancelled#, #wrkOrdSts_soCancelled#)
        AND WO.EZCANCELFLAG   = '0'
        AND ROWNUM            = 1
    </statement>

    <statement id="getConfigItemLineInfo" parameterClass="Map" resultClass="Map">
        SELECT
             MDSE.INSTL_BASE_CTRL_FLG
            ,MTVS.MDSE_TP_CTX_TP_CD
            ,MDSE.SHPG_SER_TAKE_FLG
        FROM
            MDSE_TP_VAL_SET MTVS
           ,MDSE            MDSE
        WHERE
            MDSE.GLBL_CMPY_CD         = #glblCmpyCd#
        AND MDSE.MDSE_CD              = #mdseCd#
        AND MDSE.GLBL_CMPY_CD         = MTVS.GLBL_CMPY_CD(+)
        AND MDSE.COA_MDSE_TP_CD       = MTVS.COA_MDSE_TP_CD(+)
        AND MTVS.MDSE_TP_CTX_TP_CD(+) = #mdseTpCtxTpCd#
        AND MTVS.EZCANCELFLAG(+)      = '0'
        AND MDSE.EZCANCELFLAG         = '0'
    </statement>

    <statement id="findPrchReqSts" parameterClass="Map" resultClass="String">
        SELECT
               PR.PRCH_REQ_STS_CD
          FROM
               PRCH_REQ PR
         WHERE
               PR.GLBL_CMPY_CD = #glblCmpyCd#
           AND PR.PRCH_REQ_NUM = #prchReqNum#
           AND PR.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getShipToCustName" parameterClass="Map" resultClass="String">
        SELECT
<!-- START 2019/09/26 T.Ogura [QC#52362,MOD] -->
<!--        DAC.DS_ACCT_NM -->
            SUBSTR(STC.LOC_NM, 1, 60)
<!-- END   2019/09/26 T.Ogura [QC#52362,MOD] -->
            ,STC.SHIP_TO_CUST_CD
        FROM
            SHIP_TO_CUST STC
           ,LOC_TP       LT
           ,SELL_TO_CUST DAC
        WHERE
            STC.GLBL_CMPY_CD    = #glblCmpyCd#
        AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
        AND STC.EZCANCELFLAG    = '0'
        AND STC.GLBL_CMPY_CD    = LT.GLBL_CMPY_CD
        AND STC.LOC_GRP_CD      = LT.LOC_GRP_CD
        AND STC.LOC_ROLE_TP_CD  = LT.LOC_ROLE_TP_CD
        AND LT.EZCANCELFLAG     = '0'
        AND STC.GLBL_CMPY_CD    = DAC.GLBL_CMPY_CD
        AND STC.SELL_TO_CUST_CD = DAC.SELL_TO_CUST_CD
        AND DAC.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getShipToCustCd" parameterClass="Map" resultClass="Map">
        SELECT
            STC.SHIP_TO_CUST_CD
        FROM
            SHIP_TO_CUST STC
           ,LOC_TP       LT
           ,SELL_TO_CUST DAC
        WHERE
            STC.GLBL_CMPY_CD    = #glblCmpyCd#
        <isNotNull property="shipToCustCd">
        AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
        </isNotNull>
        AND STC.EZCANCELFLAG    = '0'
        AND STC.GLBL_CMPY_CD    = LT.GLBL_CMPY_CD
        AND STC.LOC_GRP_CD      = LT.LOC_GRP_CD
        AND STC.LOC_ROLE_TP_CD  = LT.LOC_ROLE_TP_CD
        AND LT.EZCANCELFLAG     = '0'
        AND STC.GLBL_CMPY_CD    = DAC.GLBL_CMPY_CD
        AND STC.SELL_TO_CUST_CD = DAC.SELL_TO_CUST_CD
        <isNotNull property="dsAcctNm">
<!-- START 2019/09/26 T.Ogura [QC#52362,MOD] -->
<!--    AND DAC.DS_ACCT_NM      = #dsAcctNm# -->
        AND (SUBSTR(DAC.DS_ACCT_NM, 1, 60) = #dsAcctNm# OR STC.LOC_NM = #dsAcctNm#)
<!-- END   2019/09/26 T.Ogura [QC#52362,MOD] -->
        </isNotNull>
        AND DAC.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getCcyCd" parameterClass="Map" resultClass="BigDecimal">
        SELECT 
            C.AFT_DECL_PNT_DIGIT_NUM
        FROM
            GLBL_CMPY GC
            ,CCY C
        WHERE 
            1 = 1
        AND GC.GLBL_CMPY_CD = #glblCmpyCd#
        AND GC.GLBL_CMPY_CD = C.GLBL_CMPY_CD
        AND GC.STD_CCY_CD   = C.CCY_CD
        AND GC.EZCANCELFLAG = '0'
        AND C.EZCANCELFLAG  = '0'
    </statement>

<!-- START 2019/10/03 M.Naito [QC#52809,MOD] -->
    <statement id="getShipToCustInfo" parameterClass="Map" resultClass="Map">
        SELECT
            STC.SHIP_TO_CUST_CD     AS SHIP_TO_CUST_CD
            ,(
              CASE WHEN STC.FIRST_LINE_ADDR IS NOT NULL THEN
                  STC.FIRST_LINE_ADDR || ' ' ||
                  STC.SCD_LINE_ADDR   || ' ' ||
                  STC.THIRD_LINE_ADDR || ' ' ||
                  STC.FRTH_LINE_ADDR  || ' ' ||
                  STC.CTY_ADDR        || ',' ||
                  STC.ST_CD           || ' ' ||
                  STC.POST_CD
              END)                  AS SHIP_TO_ADDR
            ,STC.ADDL_LOC_NM        AS ADDL_LOC_NM
            ,STC.FIRST_LINE_ADDR    AS FIRST_LINE_ADDR
            ,STC.SCD_LINE_ADDR      AS SCD_LINE_ADDR
            ,STC.THIRD_LINE_ADDR    AS THIRD_LINE_ADDR
            ,STC.FRTH_LINE_ADDR     AS FRTH_LINE_ADDR
            ,STC.FIRST_REF_CMNT_TXT AS FIRST_REF_CMNT_TXT
            ,STC.SCD_REF_CMNT_TXT   AS SCD_REF_CMNT_TXT
            ,STC.CTY_ADDR           AS CTY_ADDR
            ,STC.ST_CD              AS ST_CD
            ,STC.POST_CD            AS POST_CD
            ,STC.PROV_NM            AS PROV_NM
            ,STC.CTRY_CD            AS CTRY_CD
            ,DAC.SELL_TO_CUST_CD    AS DS_ACCT_NUM
            ,DAC.DS_ACCT_NM         AS DS_ACCT_NM
            ,CNTY.CNTY_NM           AS CNTY_NM
        FROM
            SHIP_TO_CUST STC
           ,SELL_TO_CUST DAC
           ,CNTY         CNTY
           ,ACCT_LOC     AC
           ,PTY_LOC_WRK  PLW
        WHERE
            STC.GLBL_CMPY_CD          = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD   LIKE #shipToCustCd#
            AND STC.RGTN_STS_CD       = #rgtnStsCd#
            AND STC.EZCANCELFLAG      = '0'
            AND PLW.GLBL_CMPY_CD      = STC.GLBL_CMPY_CD
            AND PLW.PTY_LOC_PK        = STC.PTY_LOC_PK
            AND PLW.RGTN_STS_CD       = #rgtnStsCd#
            AND PLW.EZCANCELFLAG      = '0'
            AND AC.GLBL_CMPY_CD       = PLW.GLBL_CMPY_CD
            AND AC.LOC_NUM            = PLW.LOC_NUM
            AND AC.RGTN_STS_CD        = #rgtnStsCd#
            AND AC.EZCANCELFLAG       = '0'
            AND AC.GLBL_CMPY_CD       = DAC.GLBL_CMPY_CD
            AND AC.DS_ACCT_NUM        = DAC.SELL_TO_CUST_CD
            AND DAC.RGTN_STS_CD       = #rgtnStsCd#
            AND DAC.EZCANCELFLAG      = '0'
            AND STC.GLBL_CMPY_CD      = CNTY.GLBL_CMPY_CD (+)
            AND STC.CNTY_PK           = CNTY.CNTY_PK (+)
            AND CNTY.EZCANCELFLAG (+) = '0'
            AND ROWNUM                = 1
<!--         SELECT
             DAC.DS_ACCT_NM
            ,STC.SHIP_TO_CUST_CD
            ,STC.SELL_TO_CUST_CD
        FROM
            SHIP_TO_CUST STC
           ,LOC_TP       LT
           ,SELL_TO_CUST DAC
        WHERE
            STC.GLBL_CMPY_CD    = #glblCmpyCd#
        AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
        AND STC.EZCANCELFLAG    = '0'
        AND STC.GLBL_CMPY_CD    = LT.GLBL_CMPY_CD
        AND STC.LOC_GRP_CD      = LT.LOC_GRP_CD
        AND STC.LOC_ROLE_TP_CD  = LT.LOC_ROLE_TP_CD
        AND LT.EZCANCELFLAG     = '0'
        AND STC.GLBL_CMPY_CD    = DAC.GLBL_CMPY_CD
        AND STC.SELL_TO_CUST_CD = DAC.SELL_TO_CUST_CD
        AND DAC.EZCANCELFLAG    = '0' -->
    </statement>
<!-- END 2019/10/03 M.Naito [QC#52809,MOD] -->

    <statement id="getCoaGlCmbn4Seg" parameterClass="Map" resultClass="Map">
        SELECT
           1
        FROM
            COA_GL_CMBN_4_SEG CGC4S
        WHERE
            CGC4S.GLBL_CMPY_CD         = #glblCmpyCd#
        AND CGC4S.COA_BR_CD            = #coaBrCd#
        AND CGC4S.COA_CH_CD            = #coaChCd#
        AND CGC4S.COA_CC_CD            = #coaCcCd#
        AND CGC4S.COA_PROD_CD          = #coaProdCd#
        AND CGC4S.COA_GL_CMBN_ACTV_FLG = #coaGlCmbnActvFlg#
        AND CGC4S.EZCANCELFLAG         = '0'
    </statement>

    <statement id="checkExistenceForCPOClose" parameterClass="Map" resultClass="Integer">
        SELECT
             '1'
        FROM
             CPO   CPO
        WHERE
            CPO.GLBL_CMPY_CD       = #glblCmpyCd#
        AND CPO.ORD_SRC_REF_NUM    = #prchReqNum#
        AND CPO.ORD_HDR_STS_CD     = #closeSts#
        AND CPO.EZCANCELFLAG       = '0'
        AND ROWNUM                 = 1
    </statement>

    <statement id="checkOpenSO" parameterClass="Map" resultClass="String">
        SELECT
            '1'
        FROM
             SHPG_ORD_DTL SOD
            ,SHPG_ORD     SO
            ,SHPG_STS     SS
        WHERE
            SOD.GLBL_CMPY_CD = #glblCmpyCd#
        AND SOD.PRCH_REQ_NUM = #prchReqNum#
        <isNotNull property="prchReqLineNum">
        AND SOD.PRCH_REQ_LINE_NUM = #prchReqLineNum#
        </isNotNull>
        <isNotNull property="prchReqLineSubNum">
        AND SOD.PRCH_REQ_LINE_SUB_NUM = #prchReqLineSubNum#
        </isNotNull>
        AND SOD.GLBL_CMPY_CD = SO.GLBL_CMPY_CD
        AND SOD.SO_NUM       = SO.SO_NUM
        AND SO.GLBL_CMPY_CD  = SS.GLBL_CMPY_CD
        AND SO.SHPG_STS_CD   = SS.SHPG_STS_CD
        AND SS.SO_PRINT_FLG  = #flagY#
        AND SS.SHIP_FLG      = #flagN#
        AND SOD.EZCANCELFLAG = '0'
        AND SO.EZCANCELFLAG  = '0'
        AND SS.EZCANCELFLAG  = '0'
        AND ROWNUM           = 1
    </statement>

    <statement id="checkOpenWorkOrder" parameterClass="Map" resultClass="Integer">
        SELECT
             '1'
        FROM
             WRK_ORD  WO
        WHERE
            WO.GLBL_CMPY_CD = #glblCmpyCd#
        AND WO.PRCH_REQ_NUM = #prchReqNum#
        <iterate property="wrkOrdStsCdList" var="wrkOrdStsCd[]" open="AND WO.WRK_ORD_STS_CD NOT IN (" conjunction= ", " close=")">
            #wrkOrdStsCd[]#
        </iterate>
        AND WO.EZCANCELFLAG = '0'
        AND ROWNUM          = 1
    </statement>

    <statement id="checkItemNumber" parameterClass="Map"
        resultClass="Map">
        SELECT
            #flgN#                     AS ORD_TAKE_FLG
           ,MDSE.MDSE_DESC_SHORT_TXT   AS MDSE_DESC_SHORT_TXT
           ,MDSE.SHPG_SER_TAKE_FLG     AS SHPG_SER_TAKE_FLG
           ,MDSE.INVTY_CTRL_FLG        AS INVTY_CTRL_FLG
        FROM
            MDSE MDSE
        WHERE
            MDSE.GLBL_CMPY_CD    = #glblCmpyCd#
        AND MDSE.MDSE_CD         = #mdseCd#
        AND MDSE.EZCANCELFLAG    = '0'

        UNION ALL

        SELECT
            #flgY#    AS ORD_TAKE_FLG
            ,NULL     AS MDSE_DESC_SHORT_TXT
            ,NULL     AS SHPG_SER_TAKE_FLG
            ,NULL     AS INVTY_CTRL_FLG
        FROM
            ORD_TAKE_MDSE OTM
        WHERE
            OTM.GLBL_CMPY_CD     = #glblCmpyCd#
        AND OTM.ORD_TAKE_MDSE_CD = #mdseCd#
        AND OTM.EZCANCELFLAG     = '0'
    </statement>

    <statement id="findRtlSwhNm" parameterClass="Map" resultClass="Map">
        SELECT
            RS.RTL_SWH_NM
        FROM
            RTL_SWH RS
        WHERE
                RS.GLBL_CMPY_CD                        = #glblCmpyCd#
            AND RS.RTL_SWH_CD                          = #rtlSwhCd#
            AND RS.EFF_FROM_DT                     &lt;= #salesDate#
            AND NVL(RS.EFF_THRU_DT, '99991231')    &gt;= #salesDate#
            AND RS.EZCANCELFLAG                        = '0'
    </statement>
    <statement id="getDefaultVendorWh" parameterClass="Map" resultClass="Map">
        SELECT
             RW.RTL_WH_CD
            ,SW.RTL_SWH_CD
        FROM
             RTL_WH    RW
            ,RTL_SWH   SW
        WHERE
            RW.GLBL_CMPY_CD = #glblCmpyCd#
        AND RW.PRNT_VND_CD  = #prntVndCd#
        AND RW.VND_CD       = #vndCd#
        AND RW.GLBL_CMPY_CD = SW.GLBL_CMPY_CD
        AND RW.RTL_WH_CD    = SW.RTL_WH_CD
        AND SW.PRTY_LOC_FLG = 'Y'
        AND RW.EZCANCELFLAG = '0'
        AND SW.EZCANCELFLAG = '0'
    </statement>
    <statement id="checkVendorWh" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(*) COUNT
        FROM
             RTL_WH    RW
        WHERE
            RW.GLBL_CMPY_CD = #glblCmpyCd#
        AND RW.RTL_WH_CD    = #rtlWhCd#
        AND RW.PRNT_VND_CD  = #prntVndCd#
        AND RW.EZCANCELFLAG = '0'
    </statement>
    <statement id="getShpgSvcLvlPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
             SSL.SHPG_SVC_LVL_CD
            ,SSL.SHPG_SVC_LVL_DESC_TXT
        FROM
             SHPG_SVC_LVL SSL
            ,SHPG_SVC_FRT_CHRG_RELN SSFCR
        WHERE
            SSL.GLBL_CMPY_CD       = #glblCmpyCd#
        AND SSL.GLBL_CMPY_CD       = SSFCR.GLBL_CMPY_CD
        AND SSL.SHPG_SVC_LVL_CD    = SSFCR.SHPG_SVC_LVL_CD
        AND SSFCR.FRT_CHRG_TO_CD   = #frtChrgToCd#
        AND SSFCR.FRT_CHRG_METH_CD = #frtChrgMethCd#
        AND SSL.EZCANCELFLAG       = '0'
        AND SSFCR.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getShipToCoaMap" parameterClass="Map"
        resultClass="Map">
        SELECT
             STC.COA_CMPY_CD
            ,STC.COA_AFFL_CD
            ,STC.COA_BR_CD
            ,STC.COA_CC_CD
            ,STC.COA_ACCT_CD
            ,STC.COA_PROD_CD
            ,STC.COA_CH_CD
            ,STC.COA_PROJ_CD
            ,STC.COA_EXTN_CD
        FROM
            SHIP_TO_CUST STC
        WHERE
                STC.GLBL_CMPY_CD      = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD   = #shipToCustCd#
            AND STC.RGTN_STS_CD       = #rgtnStsCd#
            AND STC.EZCANCELFLAG      = '0'
    </statement>
    <statement id="getAddrByPost" parameterClass="Map" resultClass="Map">
    SELECT DISTINCT
           P.CTY_ADDR
          ,P.ST_CD
          ,P.POST_CD
          ,C.CNTY_NM
      FROM 
           POST P
          ,CNTY_POST_RELN R
          ,CNTY C
     WHERE 
           P.GLBL_CMPY_CD    = #glblCmpyCd#
       AND P.POST_CD         = #postCd#
       AND P.GLBL_CMPY_CD    = R.GLBL_CMPY_CD(+)
       AND P.POST_PK         = R.POST_PK(+)
       AND R.GLBL_CMPY_CD    = C.GLBL_CMPY_CD(+)
       AND R.CNTY_PK         = C.CNTY_PK(+)
       AND P.EZCANCELFLAG    = '0'
       AND R.EZCANCELFLAG(+) = '0'
       AND C.EZCANCELFLAG(+) = '0'
     ORDER BY
           P.CTY_ADDR
          ,P.ST_CD
          ,P.POST_CD
          ,C.CNTY_NM
    </statement>
<!-- START 2018/11/07 M.Naito [QC#28698,ADD] -->
    <statement id="checkExistConfig" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*)
        FROM
            SVC_MACH_MSTR SMM
        WHERE
            SMM.GLBL_CMPY_CD            = #glblCmpyCd#
        AND SMM.SVC_CONFIG_MSTR_PK      IS NOT NULL
        AND SMM.MDSE_CD                 = #mdseCd#
        AND SMM.SER_NUM                 = #serNum#
        AND SMM.CUR_LOC_NUM             = #curLocNum#
        <iterate property="svcMachMstrStsCdList" var="svcMachMstrStsCd[]" open="AND SMM.SVC_MACH_MSTR_STS_CD IN (" conjunction= ", " close=")">
            #svcMachMstrStsCd[]#
        </iterate>
        AND SMM.STK_STS_CD              = #stkStsCd#
        AND SMM.SVC_MACH_MAINT_AVAL_FLG = 'Y'
        AND SMM.EZCANCELFLAG            = '0'
    </statement>
<!-- END 2018/11/07 M.Naito [QC#28698,ADD] -->

<!-- START 2019/05/17 M.Naito [QC#50076,ADD] -->
    <statement id="getRtlWhCatgCd" parameterClass="Map" resultClass="String">
        SELECT
            RWC.RTL_WH_CATG_CD
        FROM
            RTL_WH      RW
           ,RTL_WH_CATG RWC
        WHERE
            RW.GLBL_CMPY_CD                     = #glblCmpyCd#
        AND RW.RTL_WH_CD                        = #rtlWhCd#
        AND RW.EFF_FROM_DT                  &lt;= #salesDate#
        AND NVL(RW.EFF_THRU_DT, '99991231') &gt;= #salesDate#
        AND RW.EZCANCELFLAG                     = '0'
        AND RW.GLBL_CMPY_CD                     = RWC.GLBL_CMPY_CD
        AND RW.RTL_WH_CATG_CD                   = RWC.RTL_WH_CATG_CD
        AND RWC.EZCANCELFLAG                    = '0'
    </statement>

    <statement id="checkDefSwhByWhCatg" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*) COUNT
        FROM
            DEF_SWH_BY_WH_CATG       CATG
        WHERE
            CATG.GLBL_CMPY_CD        = #glblCmpyCd#
        AND (CATG.SRC_RTL_WH_CATG_CD = #srcRtlWhCatgCd#
             OR
             CATG.SRC_RTL_WH_CATG_CD = #astr#)
        AND CATG.DEST_RTL_WH_CATG_CD = #destRtlWhCatgCd#
        AND (CATG.MDL_GRP_ID         = #mdlGrpId#
             OR
             CATG.MDL_GRP_ID         = #defMdlGrpId#)
        AND CATG.EZCANCELFLAG        = '0'
    </statement>
<!-- END 2019/05/17 M.Naito [QC#50076,ADD] -->

    <statement id="getOrdInfo" parameterClass="Map" resultClass="Map">
        SELECT
               DOTPD.DS_ORD_TP_CD
             , DOTPD.DEF_PRC_CATG_CD
             , DOT.DS_ORD_CATG_CD
          FROM
               DS_COND_CONST      DCC
             , DS_ORD_TP_PROC_DFN DOTPD
             , DS_ORD_TP          DOT
         WHERE
               DCC.GLBL_CMPY_CD             = DOTPD.GLBL_CMPY_CD
           AND DCC.DS_COND_CONST_CD         = DOTPD.DS_ORD_TP_CD
           AND DOTPD.GLBL_CMPY_CD           = DOT.GLBL_CMPY_CD
           AND DOTPD.DS_ORD_TP_CD           = DOT.DS_ORD_TP_CD
           AND DCC.GLBL_CMPY_CD             = #glblCmpyCd#
           AND DCC.DS_COND_CONST_GRP_ID     = #DS_COND_CONST_GRP_ID#
           AND DCC.DS_COND_CONST_VAL_TXT_01 = #DS_COND_CONST_VAL_TXT_01#
           <isNotNull property="DS_COND_CONST_VAL_TXT_02">
           AND DCC.DS_COND_CONST_VAL_TXT_02 = #DS_COND_CONST_VAL_TXT_02#
           </isNotNull>
           <isNull property="DS_COND_CONST_VAL_TXT_02">
           AND DCC.DS_COND_CONST_VAL_TXT_02 IS NULL
           </isNull>
           AND DCC.EZCANCELFLAG             = '0'
           AND DOTPD.EZCANCELFLAG           = '0'
           AND DOT.EZCANCELFLAG             = '0'
    </statement>

<!-- START 2019/10/03 M.Naito [QC#52809,ADD] -->    
    <statement id="getBillToCustInfo" parameterClass="Map" resultClass="Map">
        SELECT
            BTC.BILL_TO_CUST_CD AS BILL_TO_CUST_CD
            ,(
              CASE WHEN BTC.FIRST_LINE_ADDR IS NOT NULL THEN
                  BTC.FIRST_LINE_ADDR || ' ' ||
                  BTC.SCD_LINE_ADDR   || ' ' ||
                  BTC.THIRD_LINE_ADDR || ' ' ||
                  BTC.FRTH_LINE_ADDR  || ' ' ||
                  BTC.CTY_ADDR        || ',' ||
                  BTC.ST_CD           || ' ' ||
                  BTC.POST_CD
              END)               AS BILL_TO_ADDR
            ,(
              CASE WHEN BTC.FIRST_LINE_ADDR IS NOT NULL THEN
                     DECODE (BTC.FIRST_LINE_ADDR, NULL, '', CONCAT(BTC.FIRST_LINE_ADDR, CHR(13) || CHR(10)))
                  || DECODE (BTC.SCD_LINE_ADDR, NULL, '', CONCAT(BTC.SCD_LINE_ADDR, CHR(13) || CHR(10)))
                  || DECODE (BTC.THIRD_LINE_ADDR, NULL, '', CONCAT(BTC.THIRD_LINE_ADDR, CHR(13) || CHR(10)))
                  || DECODE (BTC.FRTH_LINE_ADDR, NULL, '', CONCAT(BTC.FRTH_LINE_ADDR, CHR(13) || CHR(10)))
                  || CONCAT (BTC.CTY_ADDR, ',')
                  || RPAD (BTC.ST_CD, LENGTH (BTC.ST_CD) + 1)
                  || BTC.POST_CD
              END)               AS ENT_BILL_TO_ADDR
            ,DAC.SELL_TO_CUST_CD AS DS_ACCT_NUM
            ,DAC.DS_ACCT_NM      AS DS_ACCT_NM
        FROM
            BILL_TO_CUST    BTC
           ,SELL_TO_CUST    DAC
           ,ACCT_LOC        AC
           ,PTY_LOC_WRK     PLW
        WHERE
            BTC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND BTC.BILL_TO_CUST_CD LIKE #custCd#
            AND BTC.RGTN_STS_CD     = #rgtnStsCd#
            AND BTC.EZCANCELFLAG    = '0'
            AND PLW.GLBL_CMPY_CD    = BTC.GLBL_CMPY_CD
            AND PLW.PTY_LOC_PK      = BTC.PTY_LOC_PK
            AND PLW.RGTN_STS_CD     = #rgtnStsCd#
            AND PLW.EZCANCELFLAG    = '0'
            AND AC.GLBL_CMPY_CD     = PLW.GLBL_CMPY_CD
            AND AC.LOC_NUM          = PLW.LOC_NUM
            AND AC.RGTN_STS_CD      = #rgtnStsCd#
            AND AC.EZCANCELFLAG     = '0'
            AND AC.GLBL_CMPY_CD     = DAC.GLBL_CMPY_CD
            AND AC.DS_ACCT_NUM      = DAC.SELL_TO_CUST_CD
            AND DAC.RGTN_STS_CD     = #rgtnStsCd#
            AND DAC.EZCANCELFLAG    = '0'
            AND ROWNUM              = 1
    </statement>
<!-- END 2019/10/03 M.Naito [QC#52809,ADD] -->

    <statement id="isExistDsImptOrd" parameterClass="Map" resultClass="String">
        SELECT
            DIO.GLBL_CMPY_CD
        FROM
            DS_IMPT_ORD DIO
           ,DS_IMPT_ORD_DTL DIOD
        WHERE
            DIO.GLBL_CMPY_CD              = #glblCmpyCd#
        AND DIO.ORD_SRC_REF_NUM           = #prchReqNum#
        <iterate property="imptStsList" var="imptStsList[]" open="AND DIO.IMPT_STS_CD IN (" conjunction= ", " close=")">
            #imptStsList[]#
        </iterate>
        AND DIO.GLBL_CMPY_CD              = DIOD.GLBL_CMPY_CD
        AND DIO.DS_IMPT_ORD_PK            = DIOD.DS_IMPT_ORD_PK
        AND DIOD.ORD_SRC_REF_LINE_NUM     = #prchReqLineNum#
        AND DIOD.ORD_SRC_REF_LINE_SUB_NUM = #prchReqLineSubNum#
        AND DIO.EZCANCELFLAG              = '0'
        AND DIOD.EZCANCELFLAG             = '0'
    </statement>

    <statement id="findCpoDtl" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM
           ,CD.CPO_DTL_LINE_NUM
           ,CD.CPO_DTL_LINE_SUB_NUM
           ,CD.ORD_LINE_STS_CD
           ,SP.SHPG_PLN_DPLY_STS_CD
           ,RD.RWS_STS_CD
        FROM
            CPO     C
           ,CPO_DTL CD
           ,SHPG_PLN SP
           ,RWS_DTL RD
        WHERE
            C.GLBL_CMPY_CD              = #glblCmpyCd#
        AND C.ORD_SRC_REF_NUM           = #prchReqNum#
        AND C.GLBL_CMPY_CD              = CD.GLBL_CMPY_CD
        AND C.CPO_ORD_NUM               = CD.CPO_ORD_NUM
        AND CD.ORD_SRC_REF_LINE_NUM     = #prchReqLineNum#
        AND CD.ORD_SRC_REF_LINE_SUB_NUM = #prchReqLineSubNum#
        AND CD.GLBL_CMPY_CD             = SP.GLBL_CMPY_CD
        AND CD.CPO_ORD_NUM              = SP.TRX_HDR_NUM
        AND CD.CPO_DTL_LINE_NUM         = SP.TRX_LINE_NUM
        AND CD.CPO_DTL_LINE_SUB_NUM     = SP.TRX_LINE_SUB_NUM
        AND C.GLBL_CMPY_CD              = RD.GLBL_CMPY_CD(+)
        AND C.ORD_SRC_REF_NUM           = RD.PRCH_REQ_NUM(+)
        AND CD.ORD_SRC_REF_LINE_NUM     = RD.PRCH_REQ_LINE_NUM(+)
        AND CD.ORD_SRC_REF_LINE_SUB_NUM = RD.PRCH_REQ_LINE_SUB_NUM(+)
        AND C.EZCANCELFLAG              = '0'
        AND CD.EZCANCELFLAG             = '0'
        AND SP.EZCANCELFLAG             = '0'
        AND RD.EZCANCELFLAG(+)          = '0'
    </statement>

    <!-- START 2021/11/09 R.Azucena [QC#58586, ADD] -->
    <statement id="getAvailableSingleQty" parameterClass="Map" resultClass="BigDecimal">
         SELECT
                COUNT(*)
         FROM
                SVC_MACH_MSTR SMM
         WHERE
                SMM.GLBL_CMPY_CD            = #glblCmpyCd#
            AND SMM.MDSE_CD                 = #mdseCd#
            AND SMM.STK_STS_CD              = #stkStsCd#
            AND SMM.CUR_LOC_NUM             = #curLocNum#
            AND SMM.SVC_CONFIG_MSTR_PK IS NULL
            AND SMM.SVC_MACH_MAINT_AVAL_FLG = #svcMachMaintAvalFlg#
            <iterate property="svcMachMstrStsCdList" var="svcMachMstrStsCd[]" open="AND SMM.SVC_MACH_MSTR_STS_CD IN (" conjunction= "," close=")">
                #svcMachMstrStsCd[]#
            </iterate>
            AND SMM.EZCANCELFLAG            = '0'
    </statement>
    <!-- END 2021/11/09 R.Azucena [QC#58586, ADD] -->

    <!-- START 2022/11/16 R.Azucena [QC#60808, ADD] -->
    <statement id="getServiceExchangeItemCnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             COUNT(*)
        FROM
             SVC_MACH_MSTR       SMM1
            ,SVC_CONFIG_MSTR_DTL SCMD1
            ,SVC_CONFIG_MSTR_DTL SCMD2
            ,SVC_MACH_MSTR       SMM2
            ,CPO                 CPO
            ,DS_ORD_TP           DOT
            ,ORD_CATG_BIZ_CTX    OCBC
        WHERE
            SMM1.GLBL_CMPY_CD         = #glblCmpyCd#
        AND SMM1.EZCANCELFLAG         = '0'
        AND SMM1.SVC_MACH_MSTR_PK     = #svcMachMstrPk#
        AND SCMD1.GLBL_CMPY_CD        = SMM1.GLBL_CMPY_CD
        AND SCMD1.SVC_MACH_MSTR_PK    = SMM1.SVC_MACH_MSTR_PK
        AND SCMD1.EZCANCELFLAG        = '0'
        AND SCMD2.GLBL_CMPY_CD        = SCMD1.GLBL_CMPY_CD
        AND SCMD2.SVC_CONFIG_MSTR_PK  = SCMD1.SVC_CONFIG_MSTR_PK
        AND SCMD2.EZCANCELFLAG        = '0'
        AND SMM2.GLBL_CMPY_CD         = SCMD2.GLBL_CMPY_CD
        AND SMM2.SVC_MACH_MSTR_PK     = SCMD2.SVC_MACH_MSTR_PK
        AND SMM2.EZCANCELFLAG         = '0'
        AND SMM2.SVC_MACH_MSTR_STS_CD = #svcMachMstrStsCd#
        AND CPO.GLBL_CMPY_CD          = SMM2.GLBL_CMPY_CD
        AND CPO.CPO_ORD_NUM           = SMM2.RMA_NUM
        <iterate property="ordHdrStsCdList" var="ordHdrStsCd[]" open="AND CPO.ORD_HDR_STS_CD NOT IN (" conjunction= ", " close=")">
            #ordHdrStsCd[]#
        </iterate>
        AND CPO.EZCANCELFLAG          = '0'
        AND DOT.GLBL_CMPY_CD          = CPO.GLBL_CMPY_CD
        AND DOT.DS_ORD_TP_CD          = CPO.DS_ORD_TP_CD
        AND DOT.EZCANCELFLAG          = '0'
        AND OCBC.GLBL_CMPY_CD         = DOT.GLBL_CMPY_CD
        AND OCBC.DS_ORD_CATG_CD       = DOT.DS_ORD_CATG_CD
        AND (  OCBC.DS_ORD_TP_CD      = DOT.DS_ORD_TP_CD
            OR OCBC.DS_ORD_TP_CD      IS NULL)
        AND OCBC.EZCANCELFLAG         = '0'
        AND OCBC.ORD_CATG_CTX_TP_CD   = #ordCatgCtxCd#
    </statement>
    <!-- END 2022/11/16 R.Azucena [QC#60808, ADD] -->
</sqlMap>
