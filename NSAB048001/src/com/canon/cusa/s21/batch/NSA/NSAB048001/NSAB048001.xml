<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSAB048001">
    <statement id="getMeterRead" parameterClass="Map" resultClass="Map">
<!-- START 10/13/2016 N.Arai [QC#12916, MOD] -->
<!-- <![CDATA[  -->
        SELECT
             CMV.GLBL_CMPY_CD
            ,CMV.SER_NUM
            ,CMV.MDSE_CD
            ,CMV.BLLG_MSTR_REVN_CD
            ,CMV.SVC_DLR_CD
            ,CMV.MACH_MSTR_PK
            ,CMV.PHYS_MTR_NUM
            ,CMV.PHYS_MTR_NM
            ,CMV.PHYS_MTR_READ_PK
            ,CMV.MTR_DT
            ,CMV.MTR_CNT
            ,CMV.MTR_TEST_CNT
            ,CMV.MRC_CRAT_DT
            ,CMV.MRC_MOD_DT
        FROM
            CSA_MTR_V CMV
        WHERE
            CMV.GLBL_CMPY_CD    = #GLBL_CMPY_CD#
        <isNotNull property="DS_BIZ_LAST_PROC_TS">
        AND CMV.EZINTIME        &gt; #DS_BIZ_LAST_PROC_TS#
        </isNotNull>
        AND CMV.MTR_DT          &lt;= #MTR_DT#
        AND CMV.EZCANCELFLAG    = '0'
<!--    AND NOT EXISTS (
                SELECT 1 
                FROM 
                    ROSS_INTFC_MTR_READ RIMR 
                WHERE 
                    RIMR.GLBL_CMPY_CD     = #GLBL_CMPY_CD_CSA#
                AND RIMR.PHYS_MTR_READ_PK = CMV.PHYS_MTR_READ_PK 
                AND RIMR.EZCANCELFLAG     = '0')
     ]]>    -->
<!-- END 10/13/2016 N.Arai [QC#12916, MOD] -->
	</statement>
    <statement id="getPurgeData" parameterClass="Map" resultClass="BigDecimal">
    <![CDATA[
        SELECT
            T.ROSS_INTFC_MTR_READ_PK
        FROM
            ROSS_INTFC_MTR_READ T
        WHERE
            T.GLBL_CMPY_CD   = #GLBL_CMPY_CD#
        AND T.RGTN_MTR_DT   <= #RGTN_MTR_DT#
        AND T.EZCANCELFLAG   = '0'
    ]]>
    </statement>
</sqlMap>
