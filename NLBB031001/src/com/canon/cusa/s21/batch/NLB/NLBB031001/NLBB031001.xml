<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NLBB031001">

    <statement id="getEdiRcvList" parameterClass="Map" resultClass="Map">
        SELECT
             NLB01.INTERFACE_ID
            ,NLB01.TRANSACTION_ID
            ,NLB01.UNIT_ID
            ,NLB01.EDI_FLD_TXT_38
            ,NLB01.EDI_FLD_TXT_01
            ,NLB01.EDI_FLD_TXT_02
            ,NLB01.EDI_FLD_TXT_03
            ,NLB01.EDI_FLD_TXT_04
            ,NLB01.EDI_FLD_TXT_09
            ,NLB01.EDI_FLD_TXT_18
            ,NLB01.EDI_FLD_TXT_23
            ,NLB01.EDI_FLD_TXT_24
            ,NLB01.EDI_FLD_TXT_25
            ,NLB01.EDI_FLD_TXT_26
            ,NLB01.EDI_FLD_TXT_27
            ,NLB01.EDI_FLD_TXT_46
            ,NLB01.EDI_FLD_TXT_48
            ,NLB01.EDI_FLD_TXT_50
            ,NLB01.EDI_FLD_TXT_51
            <isNotNull property="isPodWrk">
            ,NLB01.EDI_FLD_TXT_55
            </isNotNull>
            <isNull property="isPodWrk">
            ,NVL(NLB01.EDI_FLD_TXT_57, NLB01.EDI_FLD_TXT_55) AS EDI_FLD_TXT_55
            </isNull>
            ,NLB01.EDI_FLD_TXT_56
            ,NLB01.EDI_FLD_TXT_57
            ,NLB01.EDI_FLD_TXT_59
            ,NLB01.EDI_FLD_TXT_60
            ,NLB01.EDI_FLD_TXT_62
            ,NLB01.EDI_FLD_TXT_63
            ,NLB01.EDI_FLD_TXT_64
            ,NLB01.EDI_FLD_TXT_76
            ,NLB01.EDI_FLD_TXT_78
        FROM
            NLBI1320_01 NLB01
        WHERE
            NLB01.INTERFACE_ID   = #interfaceId#
        AND NLB01.TRANSACTION_ID = #transactionId#
        <isEqual property="isPodWrk" compareValue="Y">
            <iterate property="ediFldTxt55" var="elem[]" open=" AND NVL( NLB01.EDI_FLD_TXT_55 , ' ' ) NOT IN (" close=")" conjunction=",">
                #elem[]#
            </iterate>
        </isEqual>
        <isEqual property="isPodWrk" compareValue="N">
            <iterate property="ediFldTxt55" var="elem[]" open=" AND NLB01.EDI_FLD_TXT_55 IN (" close=")" conjunction=",">
                #elem[]#
            </iterate>
        </isEqual>
        <isNull property="isPodWrk">
            <iterate property="ediFldTxt57" var="elem[]" open=" AND NLB01.EDI_FLD_TXT_57 IN (" close=")" conjunction=",">
                #elem[]#
            </iterate>
        </isNull>
        AND NLB01.EZCANCELFLAG   = '0'
        ORDER BY
            NLB01.EDI_FLD_TXT_38
           ,NLB01.EDI_FLD_TXT_01
           ,NLB01.EDI_FLD_TXT_02
           ,NLB01.EDI_FLD_TXT_03
           ,NLB01.EDI_FLD_TXT_04
    </statement>

    <!-- START 2017/01/17 S.Katsuma [QC#23056,ADD] -->
    <statement id="getSoNumByTrackingNum" parameterClass="Map" resultClass="Map">
        SELECT
            SOCD.SO_NUM     TRX_HDR_NUM
           ,SOCD.SO_SLP_NUM TRX_LINE_NUM
        FROM
            SHPG_ORD_CONF_DTL SOCD
        WHERE
            SOCD.GLBL_CMPY_CD = #glblCmpyCd#
        AND SOCD.EZCANCELFLAG = '0'
        AND SOCD.PRO_NUM      = #proNum#
        AND EXISTS(
            SELECT
               1
            FROM
                 VND VN
                ,CARR_TP CT
            WHERE
                VN.GLBL_CMPY_CD  = SOCD.GLBL_CMPY_CD
            AND VN.VND_CD        = SOCD.VND_CD
            AND VN.GLBL_CMPY_CD  = CT.GLBL_CMPY_CD
            AND VN.CARR_TP_CD    = CT.CARR_TP_CD
            AND CT.CARR_TP_CD    = #carrTpCd#
            AND VN.EZCANCELFLAG  = '0'
            AND CT.EZCANCELFLAG  = '0'
        )
        ORDER BY
            SOCD.SO_NUM
           ,SOCD.SO_SLP_NUM
    </statement>

<!--
    <statement id="getRWSNumByTrackingNum" parameterClass="Map" resultClass="Map">
        SELECT
            RH.RWS_NUM          TRX_HDR_NUM
           ,RD.RWS_DTL_LINE_NUM TRX_LINE_NUM
        FROM
            RWS_HDR RH
           ,RWS_DTL RD
        WHERE
            RH.GLBL_CMPY_CD = #glblCmpyCd#
        AND RH.EZCANCELFLAG = '0'
        AND RH.GLBL_CMPY_CD = RD.GLBL_CMPY_CD
        AND RH.RWS_NUM      = RD.RWS_NUM
        AND RD.EZCANCELFLAG = '0'
        AND RH.RWS_REF_NUM IN (
                SELECT
                    SOCD.SO_NUM
                FROM
                    SHPG_ORD_CONF_DTL SOCD
                WHERE
                    SOCD.GLBL_CMPY_CD = #glblCmpyCd#
                AND SOCD.EZCANCELFLAG = '0'
                AND SOCD.PRO_NUM      = #proNum#
                AND EXISTS(
                    SELECT
                        1
                    FROM
                        VND VN
                       ,CARR_TP CT
                    WHERE
                        VN.GLBL_CMPY_CD  = SOCD.GLBL_CMPY_CD
                    AND VN.VND_CD        = SOCD.VND_CD
                    AND VN.GLBL_CMPY_CD  = CT.GLBL_CMPY_CD
                    AND VN.CARR_TP_CD    = CT.CARR_TP_CD
                    AND CT.CARR_TP_CD    = #carrTpCd#
                    AND VN.EZCANCELFLAG  = '0'
                    AND CT.EZCANCELFLAG  = '0'
               )
        )
        ORDER BY
            RH.RWS_NUM
           ,RD.RWS_DTL_LINE_NUM
    </statement>
-->
    <!-- END 2017/01/17 S.Katsuma [QC#23056,ADD] -->
</sqlMap>
