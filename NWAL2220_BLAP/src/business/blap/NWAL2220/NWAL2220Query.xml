<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NWAL2220Query">
    <typeAlias alias="NWAL2220CMsg"    type="business.blap.NWAL2220.NWAL2220CMsg"/>
    <typeAlias alias="NWAL2220_ASMsg"  type="business.blap.NWAL2220.NWAL2220_ASMsg"/>
    <statement id="getCpoSrcTpList" parameterClass="Map" resultClass="Map">
        SELECT
             A.CPO_SRC_TP_CD
            ,A.CPO_SRC_TP_DESC_TXT
        FROM
            (
            SELECT
                 CST.CPO_SRC_TP_CD
                ,CST.CPO_SRC_TP_DESC_TXT
            FROM 
                 CPO_SRC_TP     CST
            WHERE
                    CST.GLBL_CMPY_CD    = #cMsg.glblCmpyCd#
                AND CST.EZCANCELFLAG    = '0'
                AND CST.IMPT_REQ_FLG    = 'Y'
            ORDER BY
                CST.CPO_SRC_TP_SORT_NUM NULLS LAST
            ) A
        WHERE
            ROWNUM &lt;= #limitCnt#
    </statement>
    <statement id="getSearchData" parameterClass="Map" resultMap="result.getSearchData">
        <!-- Mod Start 2017/09/01 QC#20892 -->
        SELECT
             CPO_SRC_TP_DESC_TXT
            ,ORD_SRC_REF_NUM
            ,DS_IMPT_ORD_PK
            ,IMPT_STS_CD
            ,IMPT_STS_DESC_TXT
            ,CASE WHEN ORD_SRC_IMPT_TS IS NULL THEN NULL
                  ELSE SUBSTR(ORD_SRC_IMPT_TS || #formatTs#, #paramOne#, #paramFourteen#)
             END ORD_SRC_IMPT_TS_TXT
            ,ORD_SRC_IMPT_TS
            ,TOC_CD
            ,TOC_NM
            ,COA_EXTN_CD
            ,COA_EXTN_DESC_TXT
            ,COA_BR_CD
            ,COA_BR_DESC_TXT
            ,DS_ORD_CATG_CD
            ,DS_ORD_CATG_DESC_TXT
            <!-- ,DS_ORD_RSN_CD -->
            <!-- ,DS_ORD_RSN_DESC_TXT -->
            ,DS_ORD_TP_CD
            ,DS_ORD_TP_DESC_TXT
            ,CPO_ORD_NUM
            ,SOLD_TO_CUST_LOC_CD
            ,DS_ACCT_NM_AO
            ,SELL_TO_CUST_CD
            ,BILL_TO_CUST_ACCT_CD
            ,DS_ACCT_NM_AB
            ,BILL_TO_CUST_CD
            ,BILL_TO_CUST_CD
            ,SHIP_TO_CUST_ACCT_CD
            ,DS_ACCT_NM_AH
            ,SHIP_TO_CUST_CD
        FROM
            (
            SELECT
                 CST.CPO_SRC_TP_DESC_TXT
                ,DIO.ORD_SRC_REF_NUM
                ,DIO.DS_IMPT_ORD_PK
                ,DIO.IMPT_STS_CD
                ,IST.IMPT_STS_DESC_TXT
                ,DIO.ORD_SRC_IMPT_TS
                ,TOC.TOC_CD
                ,TOC.TOC_NM
                ,CEX.COA_EXTN_CD
                ,CEX.COA_EXTN_DESC_TXT
                ,CBR.COA_BR_CD
                ,CBR.COA_BR_DESC_TXT
                ,DOC.DS_ORD_CATG_CD
                ,DOC.DS_ORD_CATG_DESC_TXT
                <!-- ,DOR.DS_ORD_RSN_CD -->
                <!-- ,DOR.DS_ORD_RSN_DESC_TXT -->
                ,DOT.DS_ORD_TP_CD
                ,DOT.DS_ORD_TP_DESC_TXT
                ,DIO.CPO_ORD_NUM
                ,DIO.SOLD_TO_CUST_LOC_CD
                ,STC_OT.DS_ACCT_NM          AS DS_ACCT_NM_AO
                ,DIO.SELL_TO_CUST_CD
                ,DIO.BILL_TO_CUST_ACCT_CD
                ,STC_BT.DS_ACCT_NM          AS DS_ACCT_NM_AB
                ,DIO.BILL_TO_CUST_CD
                ,DIO.SHIP_TO_CUST_ACCT_CD
                ,DIO.SHIP_TO_LOC_NM         AS DS_ACCT_NM_AH
                ,DIO.SHIP_TO_CUST_CD
            FROM
                 DS_IMPT_ORD    DIO
                ,TOC            TOC
                ,SELL_TO_CUST   STC_OT
                ,SELL_TO_CUST   STC_BT
                ,CPO_SRC_TP     CST
                ,IMPT_STS       IST
                ,COA_BR         CBR
                ,DS_ORD_CATG    DOC
                <!-- ,DS_ORD_RSN     DOR -->
                ,DS_ORD_TP      DOT
                ,COA_EXTN       CEX
            WHERE
                    DIO.GLBL_CMPY_CD            = #cMsg.glblCmpyCd#
                <isNotNull property="cMsg.cpoSrcTpCd_SV">
                AND DIO.CPO_SRC_TP_CD           = #cMsg.cpoSrcTpCd_SV#
                </isNotNull>
                <isNotNull property="cMsg.ordSrcRefNum">
                AND DIO.ORD_SRC_REF_NUM         = #cMsg.ordSrcRefNum#
                </isNotNull>
                <isNotNull property="cMsg.imptStsCd_SV">
                AND DIO.IMPT_STS_CD             = #cMsg.imptStsCd_SV#
                </isNotNull>
                <isNotNull property="ordSrcImptTsFrom">
                AND DIO.ORD_SRC_IMPT_TS         &gt;= #ordSrcImptTsFrom#
                </isNotNull>
                <isNotNull property="ordSrcImptTsTo">
                AND DIO.ORD_SRC_IMPT_TS         &lt;= #ordSrcImptTsTo#
                </isNotNull>
                <isNotNull property="cMsg.sellToCustCd">
                AND DIO.SELL_TO_CUST_CD         = #cMsg.sellToCustCd#
                </isNotNull>
                <isNotNull property="cMsg.billToCustAcctCd">
                AND DIO.BILL_TO_CUST_ACCT_CD    = #cMsg.billToCustAcctCd#
                </isNotNull>
                <isNotNull property="cMsg.shipToCustAcctCd">
                AND DIO.SHIP_TO_CUST_ACCT_CD    = #cMsg.shipToCustAcctCd#
                </isNotNull>
                <isNotNull property="cMsg.dsAcctNm_HT">
                AND DIO.SHIP_TO_LOC_NM          LIKE #cMsg.dsAcctNm_HT#
                </isNotNull>
                <isNotNull property="cMsg.soldToCustLocCd">
                AND DIO.SOLD_TO_CUST_LOC_CD     = #cMsg.soldToCustLocCd#
                </isNotNull>
                <isNotNull property="cMsg.billToCustCd">
                AND DIO.BILL_TO_CUST_CD         = #cMsg.billToCustCd#
                </isNotNull>
                <isNotNull property="cMsg.shipToCustCd">
                AND DIO.SHIP_TO_CUST_CD         = #cMsg.shipToCustCd#
                </isNotNull>
                AND DIO.EZCANCELFLAG            = '0'
                <isNotNull property="cMsg.cpoOrdNum">
                AND DIO.CPO_ORD_NUM             = #cMsg.cpoOrdNum#
                </isNotNull>
                AND DIO.GLBL_CMPY_CD            = TOC.GLBL_CMPY_CD    (+)
                AND DIO.SLS_REP_TOC_CD          = TOC.TOC_CD          (+)
                AND TOC.EZCANCELFLAG        (+) = '0'
                <isNotNull property="cMsg.tocNm">
                AND UPPER(TOC.TOC_NM)           LIKE UPPER(#cMsg.tocNm#)  <!-- S21_NA#13627 MOD -->
                </isNotNull>
                <isNotNull property="cMsg.coaExtnCd_SV">
                AND TOC.COA_EXTN_CD             = #cMsg.coaExtnCd_SV#
                </isNotNull>
                AND DIO.GLBL_CMPY_CD            = STC_OT.GLBL_CMPY_CD (+)
                AND DIO.SELL_TO_CUST_CD         = STC_OT.SELL_TO_CUST_CD  (+)
                AND STC_OT.EZCANCELFLAG     (+) = '0'
                <isNotNull property="cMsg.dsAcctNm_OT">
                AND STC_OT.DS_ACCT_NM           LIKE #cMsg.dsAcctNm_OT#
                </isNotNull>
                AND DIO.GLBL_CMPY_CD            = STC_BT.GLBL_CMPY_CD (+)
                AND DIO.BILL_TO_CUST_ACCT_CD    = STC_BT.SELL_TO_CUST_CD  (+)
                AND STC_BT.EZCANCELFLAG     (+) = '0'
                <isNotNull property="cMsg.dsAcctNm_BT">
                AND STC_BT.DS_ACCT_NM           LIKE #cMsg.dsAcctNm_BT#
                </isNotNull>
                AND DIO.GLBL_CMPY_CD            = CST.GLBL_CMPY_CD    (+)
                AND DIO.CPO_SRC_TP_CD           = CST.CPO_SRC_TP_CD   (+)
                AND CST.EZCANCELFLAG        (+) = '0'
                AND DIO.GLBL_CMPY_CD            = IST.GLBL_CMPY_CD    (+)
                AND DIO.IMPT_STS_CD             = IST.IMPT_STS_CD     (+)
                AND IST.EZCANCELFLAG        (+) = '0'
                AND TOC.GLBL_CMPY_CD            = CBR.GLBL_CMPY_CD    (+)
                AND TOC.COA_BR_CD               = CBR.COA_BR_CD       (+)
                AND CBR.EZCANCELFLAG        (+) = '0'
                <isNotNull property="cMsg.coaBrDescTxt">
                AND CBR.COA_BR_DESC_TXT         LIKE #cMsg.coaBrDescTxt#
                </isNotNull>
                AND DIO.GLBL_CMPY_CD            = DOC.GLBL_CMPY_CD    (+)
                AND DIO.DS_ORD_CATG_CD          = DOC.DS_ORD_CATG_CD  (+)
                AND DOC.EZCANCELFLAG        (+) = '0'
                <!-- AND DIO.GLBL_CMPY_CD            = DOR.GLBL_CMPY_CD    (+) -->
                <!-- AND DIO.DS_ORD_RSN_CD           = DOR.DS_ORD_RSN_CD   (+) -->
                <!-- AND DOR.EZCANCELFLAG        (+) = '0' -->
                AND DIO.GLBL_CMPY_CD            = DOT.GLBL_CMPY_CD(+)
                AND DIO.DS_ORD_TP_CD            = DOT.DS_ORD_TP_CD(+)
                AND DOT.EZCANCELFLAG(+)         = '0' 
                AND TOC.GLBL_CMPY_CD            = CEX.GLBL_CMPY_CD    (+)
                AND TOC.COA_EXTN_CD             = CEX.COA_EXTN_CD     (+)
                AND CEX.EZCANCELFLAG        (+) = '0'
            ORDER BY
                 DIO.ORD_SRC_IMPT_TS        DESC NULLS LAST
                ,CST.CPO_SRC_TP_SORT_NUM    NULLS LAST
                ,DIO.ORD_SRC_REF_NUM        NULLS LAST
            ) A
        WHERE
                ROWNUM &lt;= #limitCnt#
        <!-- Mod End 2017/09/01 QC#20892 -->
    </statement>
    <statement id="getSavedSearchOptionList" parameterClass="Map" resultClass="Map">
        SELECT
                  SSO.SRCH_OPT_PK
                , SSO.SRCH_OPT_NM
            FROM
                SAVE_SRCH_OPT SSO 
            WHERE
                SSO.GLBL_CMPY_CD        = #glblCmpyCd#
                AND SSO.SRCH_OPT_APL_ID = #srchOptAplId#
                AND SSO.SRCH_OPT_USR_ID = #srchOptUsrId#
                AND SSO.EZCANCELFLAG    = '0'
            ORDER BY
                  SSO.SRCH_OPT_NM
    </statement>
    <resultMap id="result.getSearchData"  class="NWAL2220_ASMsg">
        <result property="cpoSrcTpDescTxt_A"     column="CPO_SRC_TP_DESC_TXT"    javaType="EZDCStringItem"/>
        <result property="ordSrcRefNum_A"        column="ORD_SRC_REF_NUM"        javaType="EZDCStringItem"/>
        <result property="dsImptOrdPk_A"         column="DS_IMPT_ORD_PK"         javaType="EZDCBigDecimalItem"/>
        <result property="imptStsCd_A"           column="IMPT_STS_CD"            javaType="EZDCStringItem"/>
        <result property="imptStsDescTxt_A"      column="IMPT_STS_DESC_TXT"      javaType="EZDCStringItem"/>
        <result property="xxTsDsp19Txt_A"        column="ORD_SRC_IMPT_TS_TXT"    javaType="EZDCStringItem"/>
        <result property="ordSrcImptTs_A"        column="ORD_SRC_IMPT_TS"        javaType="EZDCStringItem"/>
        <result property="tocCd_A"               column="TOC_CD"                 javaType="EZDCStringItem"/>
        <result property="tocNm_A"               column="TOC_NM"                 javaType="EZDCStringItem"/>
        <result property="coaExtnCd_A"           column="COA_EXTN_CD"            javaType="EZDCStringItem"/>
        <result property="coaExtnDescTxt_A"      column="COA_EXTN_DESC_TXT"      javaType="EZDCStringItem"/>
        <result property="coaBrCd_A"             column="COA_BR_CD"              javaType="EZDCStringItem"/>
        <result property="coaBrDescTxt_A"        column="COA_BR_DESC_TXT"        javaType="EZDCStringItem"/>
        <result property="dsOrdCatgCd_A"         column="DS_ORD_CATG_CD"         javaType="EZDCStringItem"/>
        <result property="dsOrdCatgDescTxt_A"    column="DS_ORD_CATG_DESC_TXT"   javaType="EZDCStringItem"/>
        <!-- Mod Start 2017/09/01 QC#20892 -->
        <!-- <result property="dsOrdRsnCd_A"          column="DS_ORD_RSN_CD"          javaType="EZDCStringItem"/> -->
        <!-- <result property="dsOrdRsnDescTxt_A"     column="DS_ORD_RSN_DESC_TXT"    javaType="EZDCStringItem"/> -->
        <result property="dsOrdTpCd_A"           column="DS_ORD_TP_CD"           javaType="EZDCStringItem"/>
        <result property="dsOrdTpDescTxt_A"      column="DS_ORD_TP_DESC_TXT"     javaType="EZDCStringItem"/>
        <!-- Mod End 2017/09/01 QC#20892 -->
        <result property="cpoOrdNum_A"           column="CPO_ORD_NUM"            javaType="EZDCStringItem"/>
        <result property="sellToCustCd_A"        column="SELL_TO_CUST_CD"        javaType="EZDCStringItem"/>
        <result property="dsAcctNm_AO"           column="DS_ACCT_NM_AO"          javaType="EZDCStringItem"/>
        <result property="soldToCustLocCd_A"     column="SOLD_TO_CUST_LOC_CD"    javaType="EZDCStringItem"/>
        <result property="billToCustAcctCd_A"    column="BILL_TO_CUST_ACCT_CD"   javaType="EZDCStringItem"/>
        <result property="dsAcctNm_AB"           column="DS_ACCT_NM_AB"          javaType="EZDCStringItem"/>
        <result property="billToCustCd_A"        column="BILL_TO_CUST_CD"        javaType="EZDCStringItem"/>
        <result property="shipToCustAcctCd_A"    column="SHIP_TO_CUST_ACCT_CD"   javaType="EZDCStringItem"/>
        <result property="dsAcctNm_AH"           column="DS_ACCT_NM_AH"          javaType="EZDCStringItem"/>
        <result property="shipToCustCd_A"        column="SHIP_TO_CUST_CD"        javaType="EZDCStringItem"/>
    </resultMap>
</sqlMap>
