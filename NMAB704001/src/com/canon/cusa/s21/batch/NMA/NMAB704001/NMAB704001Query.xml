<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NMAB704001Query">

    <statement id="truncateSomPrcBookInfo" parameterClass="Map" resultClass="Map">
           TRUNCATE TABLE SOM_PRC_BOOK_INFO
    </statement>

    <statement id="getWrk" parameterClass="Map" resultClass="Map">
           SELECT
               UPLD_CSV_RQST_PK
             , UPLD_CSV_RQST_ROW_NUM
             , SOM_PRC_BOOK_NM
             , SOM_CATG_NM
             , SOM_SUB_CATG_NM
             , SOM_SUB_TP_NM
             , SOM_ITEM_NM
             , SOM_PROD_DESC_TXT
             , SOM_COST_PRC_TXT
             , SOM_PRF_PRC_TXT 
           FROM
             ( 
               SELECT
                   WK.UPLD_CSV_RQST_PK
                 , WK.UPLD_CSV_RQST_ROW_NUM
                 , WK.SOM_PRC_BOOK_NM
                 , WK.SOM_CATG_NM
                 , WK.SOM_SUB_CATG_NM
                 , WK.SOM_SUB_TP_NM
                 , WK.SOM_ITEM_NM
                 , WK.SOM_PROD_DESC_TXT
                 , WK.SOM_COST_PRC_TXT
                 , WK.SOM_PRF_PRC_TXT
                 , ROWNUM N
               FROM
                 SOM_PRC_BOOK_INFO_WRK WK 
               WHERE
                 WK.UPLD_CSV_RQST_PK = #upldCsvRqstPk# 
                 AND WK.GLBL_CMPY_CD = #glblCmpyCd# 
                 AND WK.EZCANCELFLAG = '0' 
               ORDER BY
                 WK.UPLD_CSV_RQST_PK
                 , WK.UPLD_CSV_RQST_ROW_NUM
             ) 
           WHERE
             N BETWEEN #startIndex# AND #endIndex#
    </statement>
</sqlMap>