<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NFZC102001">

    <statement id="checkNotAllowSec" parameterClass="Map" resultClass="Map">
        SELECT
            X.RESULT
        FROM
            (
                SELECT
                    (CASE WHEN A.COA_SEG_NM = 'COA_CMPY' AND (#coaCmpyCd# BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_CMPY'
                          WHEN A.COA_SEG_NM = 'COA_BR'   AND (#coaBrCd#   BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_BR'
                          WHEN A.COA_SEG_NM = 'COA_CC'   AND (#coaCcCd#   BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_CC'
                          WHEN A.COA_SEG_NM = 'COA_ACCT' AND (#coaAcctCd# BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_ACCT'
                          WHEN A.COA_SEG_NM = 'COA_PROD' AND (#coaProdCd# BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_PROD'
                          WHEN A.COA_SEG_NM = 'COA_CH'   AND (#coaChCd#   BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_CH'
                          WHEN A.COA_SEG_NM = 'COA_AFFL' AND (#coaAfflCd# BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_AFFL'
                          WHEN A.COA_SEG_NM = 'COA_PROJ' AND (#coaProjCd# BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_PROJ'
                          WHEN A.COA_SEG_NM = 'COA_EXTN' AND (#coaExtnCd# BETWEEN A.COA_FROM_VAL_CD AND A.COA_TO_VAL_CD) THEN 'NG_COA_EXTN'
                    END) AS RESULT
                FROM
                    COA_GL_SEG_NOT_ALLW_SEC A
                WHERE
                        A.GLBL_CMPY_CD  = #glblCmpyCd#
                    AND A.RESRC_OBJ_NM  = #resrcObjNm#
                    AND A.ENBL_FLG      = 'Y'
                    AND A.EZCANCELFLAG  = '0'
            )X
        WHERE
            X.RESULT IS NOT NULL
        GROUP BY
            X.RESULT
    </statement>

    <statement id="check9Segment" parameterClass="Map" resultClass="Map">
        SELECT
            COUNT(*) AS COUNT
        FROM
            COA_GL_CMBN	CGC
        WHERE
                CGC.EZCANCELFLAG		= '0'
            AND	CGC.GLBL_CMPY_CD		= #glblCmpyCd#
            AND CGC.COA_GL_CMBN_STS_CD	= '0'
           <isNotNull property="coaCmpyCd" >
            AND	CGC.COA_CMPY_CD			= #coaCmpyCd#
           </isNotNull>
           <isNotNull property="coaBrCd" >
            AND CGC.COA_BR_CD			= #coaBrCd#
           </isNotNull>
           <isNotNull property="coaCcCd" >
            AND CGC.COA_CC_CD			= #coaCcCd#
           </isNotNull>
           <isNotNull property="coaAcctCd" >
            AND CGC.COA_ACCT_CD			= #coaAcctCd#
           </isNotNull>
           <isNotNull property="coaProdCd" >
            AND CGC.COA_PROD_CD			= #coaProdCd#
           </isNotNull>
           <isNotNull property="coaChCd" >
            AND CGC.COA_CH_CD			= #coaChCd#
           </isNotNull>
           <isNotNull property="coaAfflCd" >
            AND CGC.COA_AFFL_CD			= #coaAfflCd#
           </isNotNull>
           <isNotNull property="coaProjCd" >
            AND CGC.COA_PROJ_CD			= #coaProjCd#
           </isNotNull>
           <isNotNull property="coaExtnCd" >
            AND CGC.COA_EXTN_CD			= #coaExtnCd#
           </isNotNull>
	</statement>
</sqlMap>	
