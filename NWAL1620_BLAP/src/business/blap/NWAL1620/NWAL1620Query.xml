<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL1620Query">

    <statement id="getCntDsCpoDtl" parameterClass="Map" resultClass="Integer">
        SELECT 
            COUNT(*)
        FROM
            CPO_DTL D 
        WHERE
            D.CPO_ORD_NUM     = #cpoOrdNum#
        AND D.GLBL_CMPY_CD    = #glblCmpyCd#
        AND D.DS_ORD_POSN_NUM = #dsOrdPosnNum#
        <isNotNull property="lineNum">
        AND D.DS_CPO_LINE_NUM = #lineNum#
        </isNotNull>
        AND D.EZCANCELFLAG    = 0
        AND ROWNUM            = #rowNum#
    </statement>

    <statement id="getCntDsCpoRtrnDtl" parameterClass="Map" resultClass="Integer">
        SELECT 
            COUNT(*)
        FROM
            DS_CPO_RTRN_DTL D 
        WHERE
            D.CPO_ORD_NUM     = #cpoOrdNum#
        AND D.GLBL_CMPY_CD    = #glblCmpyCd#
        AND D.DS_ORD_POSN_NUM = #dsOrdPosnNum#
        <isNotNull property="lineNum">
        AND D.DS_CPO_LINE_NUM = #lineNum#
        </isNotNull>
        AND D.EZCANCELFLAG    = 0
        AND ROWNUM            = #rowNum#
    </statement>

    <statement id="getConfigCatg" parameterClass="Map" resultClass="Map">
        SELECT
            CC.CONFIG_CATG_CD
         ,  CC.CONFIG_CATG_DESC_TXT
        FROM
            CONFIG_CATG CC
        WHERE
            CC.GLBL_CMPY_CD =  #glblCmpyCd#
        AND CC.EZCANCELFLAG =  0
    </statement>

    <statement id="cntCreditRebillOrder" parameterClass="Map" resultClass="Map">
            SELECT 
                COUNT(DCD.CR_REBIL_CD) AS CNT
            FROM 
                CPO_DTL DCD
            WHERE 
                    DCD.GLBL_CMPY_CD  = #glblCmpyCd#
                AND DCD.CPO_ORD_NUM   = #cpoOrdNum#
                AND DCD.CR_REBIL_CD   IN (#crRebilCdCredit#, #crRebilCdRebill#)
                <isNotNull property="dsOrdPosnNum">
                AND DCD.DS_ORD_POSN_NUM = #dsOrdPosnNum#
                </isNotNull>
                <isNotNull property="dsCpoLineNum">
                AND DCD.DS_CPO_LINE_NUM = #dsCpoLineNum#
                </isNotNull>
                AND DCD.EZCANCELFLAG  = '0'
    </statement>

    <statement id="cntCreditRebillOrderRMA" parameterClass="Map" resultClass="Map">
            SELECT 
                COUNT(DCD.CR_REBIL_CD) AS CNT
            FROM 
                DS_CPO_RTRN_DTL DCD
            WHERE 
                    DCD.GLBL_CMPY_CD  = #glblCmpyCd#
                AND DCD.CPO_ORD_NUM   = #cpoOrdNum#
                AND DCD.CR_REBIL_CD   IN (#crRebilCdCredit#, #crRebilCdRebill#)
                <isNotNull property="dsOrdPosnNum">
                AND DCD.DS_ORD_POSN_NUM = #dsOrdPosnNum#
                </isNotNull>
                <isNotNull property="dsCpoLineNum">
                AND DCD.DS_CPO_LINE_NUM = #dsCpoLineNum#
                </isNotNull>
                AND DCD.EZCANCELFLAG  = '0'
    </statement>
</sqlMap>
