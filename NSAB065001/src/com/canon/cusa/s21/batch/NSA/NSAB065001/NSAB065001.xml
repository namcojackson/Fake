<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSAB065001">

    <statement id="getTrgtDtRec" parameterClass="Map" resultClass="BigDecimal">
        SELECT COUNT(1)
        FROM
            DMN_SVC_CONTR_BR         CON
        WHERE 
            CON.GLBL_CMPY_CD         = #glblCmpyCd#
        AND CON.DWH_TRGT_DT          = #trgtDt#
        AND CON.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getMainData" parameterClass="Map" resultClass="Map">
        SELECT
             CO.GLBL_CMPY_CD
            ,CO.SVC_CONTR_BR_CD
            ,BZ.LINE_BIZ_TP_CD          AS SVC_LINE_BIZ_CD
            ,BZ.LINE_BIZ_TP_DESC_TXT    AS SVC_LINE_BIZ_DESC_TXT
            ,'Y'                        AS SVC_LINE_BIZ_ACTV_FLG
            ,NULL                       AS SVC_LINE_BIZ_EFF_FROM_DT
            ,NULL                       AS SVC_LINE_BIZ_EFF_THRU_DT
            ,RG.SVC_RG_PK
            ,RG.SVC_RG_DESC_TXT
            ,RG.SVC_RG_ACTV_FLG
            ,RG.EFF_FROM_DT             AS SVC_RG_EFF_FROM_DT
            ,RG.EFF_THRU_DT             AS SVC_RG_EFF_THRU_DT
            ,RG.ORG_CD                  AS SVC_RG_ORG_CD
            ,CO.SVC_CONTR_BR_DESC_TXT
            ,CO.SVC_CONTR_BR_ACTV_FLG
            ,CO.EFF_FROM_DT             AS SVC_CONTR_BR_EFF_FROM_DT
            ,CO.EFF_THRU_DT             AS SVC_CONTR_BR_EFF_THRU_DT
        FROM
             LINE_BIZ_TP            BZ
            ,AVAL_LINE_BIZ_TP_SRC   ALB
            ,SVC_RG                 RG
            ,SVC_RG_BR_RELN         RB
            ,SVC_CONTR_BR           CO
        WHERE 
            CO.GLBL_CMPY_CD         = #glblCmpyCd#
        AND CO.GLBL_CMPY_CD         = RB.GLBL_CMPY_CD
        AND CO.SVC_CONTR_BR_CD      = RB.SVC_CONTR_BR_CD
        AND RB.GLBL_CMPY_CD         = RG.GLBL_CMPY_CD
        AND RB.SVC_RG_PK            = RG.SVC_RG_PK
        AND RG.GLBL_CMPY_CD         = BZ.GLBL_CMPY_CD
        AND RG.SVC_LINE_BIZ_CD      = BZ.LINE_BIZ_TP_CD
        AND BZ.GLBL_CMPY_CD         = ALB.GLBL_CMPY_CD
        AND BZ.LINE_BIZ_TP_CD       = ALB.LINE_BIZ_TP_CD
        AND ALB.SYS_SRC_CD          = #sysSrcCd#
        AND BZ.EZCANCELFLAG         = '0'
        AND ALB.EZCANCELFLAG        = '0'
        AND RG.EZCANCELFLAG         = '0'
        AND RB.EZCANCELFLAG         = '0'
        AND CO.EZCANCELFLAG         = '0'
        ORDER BY
            CO.SVC_CONTR_BR_CD, BZ.LINE_BIZ_TP_CD, RG.SVC_RG_PK
    </statement>

</sqlMap>
