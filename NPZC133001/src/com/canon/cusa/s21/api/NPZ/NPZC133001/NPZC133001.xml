<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NPZC133001">

    <statement id="sendPoInfo" parameterClass="Map" resultClass="Map">
        SELECT
            PO.PO_ORD_NUM
           ,PO.PO_ORD_CMNT_TXT
           ,PO.PRNT_VND_CD
           ,PO.PRNT_VND_NM
           ,PO.CARR_ACCT_NUM
           ,PO.DEST_RTL_WH_CD
           ,PO.RQST_RCV_DT
           ,PO.RQST_RCV_TM
           ,PO.VND_PMT_TERM_DESC_TXT
           ,PO.PO_QLFY_CD
           ,DPT.PO_INTFC_PO_TP_NM
           ,PMRN.PO_MSG_TXT           PO_MSG_TXT_RN
           ,PMSN.PO_MSG_TXT           PO_MSG_TXT_SN
           ,PMSI.PO_MSG_TXT           PO_MSG_TXT_SI
           ,VND.FIRST_LINE_ADDR       VND_FIRST_LINE_ADDR
           ,VND.CTY_ADDR              VND_CTY_ADDR
           ,VND.POST_CD               VND_POST_CD
           ,VND.ST_CD                 VND_ST_CD
           ,RW.RTL_WH_CD
           ,RW.RTL_WH_NM
           ,RW.FIRST_LINE_ADDR        RTL_WH_FIRST_LINE_ADDR
           ,RW.SCD_LINE_ADDR          RTL_WH_SCD_LINE_ADDR
           ,RW.THIRD_LINE_ADDR        RTL_WH_THIRD_LINE_ADDR
           ,RW.FRTH_LINE_ADDR         RTL_WH_FRTH_LINE_ADDR
           ,RW.CTY_ADDR               RTL_WH_CTY_ADDR
           ,RW.ST_CD                  RTL_WH_ST_CD
           ,RW.POST_CD                RTL_WH_POST_CD
           ,RW.CTRY_CD                RTL_WH_CTRY_CD
           ,AP.LAST_NM
           ,AP.FIRST_NM
           ,PD.CCY_CD
           ,PD.CARR_CD
           ,PD.CUST_ISS_PO_NUM
           ,PD.SHIP_TO_LOC_NM
           ,PD.SHIP_TO_FIRST_LINE_ADDR
           ,PD.SHIP_TO_SCD_LINE_ADDR
           ,PD.SHIP_TO_THIRD_LINE_ADDR
           ,PD.SHIP_TO_FRTH_LINE_ADDR
           ,PD.CTAC_PSN_NM
           ,PD.SHIP_TO_CTY_ADDR
           ,PD.SHIP_TO_POST_CD
           ,PD.SHIP_TO_CTRY_CD
           ,PD.SHIP_TO_ST_CD
           ,PD.PO_ORD_DTL_LINE_NUM
           ,PD.MDSE_CD
           ,PD.SHIP_TO_CUST_CD
           ,PD.SHIP_TO_ACCT_NM
           ,PD.PO_DISP_QTY
           ,PD.PO_DISP_UOM_CD
           ,PD.ASL_MDSE_CD
           ,PD.ENT_DEAL_NET_UNIT_PRC_AMT
           ,PD.MDSE_DESC_SHORT_TXT
           ,PD.DEST_RTL_SWH_CD
           ,OCV.CARR_NM
           ,STC.BIG_DEAL_NUM
           ,FC.FRT_CHRG_TO_CD
           ,VU.VND_UOM_NM
        FROM
            PO              PO
           ,DS_PO_TP        DPT
           ,PO_MSG          PMSI
           ,PO_MSG          PMRN
           ,PO_MSG          PMSN
           ,VND             VND
           ,RTL_WH          RW
           ,AUTH_PSN        AP
           ,PO_DTL          PD
           ,OTBD_CARR_V     OCV
           ,FRT_COND        FC
           ,VND_UOM         VU
           ,SHIP_TO_CUST    STC
        WHERE
            1=1
        AND PO.GLBL_CMPY_CD           = #glblCmpyCd#
        AND PO.PO_ORD_NUM             = #poOrdNum# 
        AND PO.GLBL_CMPY_CD           = DPT.GLBL_CMPY_CD (+)
        AND PO.DS_PO_TP_CD            = DPT.DS_PO_TP_CD (+)
        AND PO.GLBL_CMPY_CD           = RW.GLBL_CMPY_CD (+)
        AND PO.RTRN_SHIP_TO_RTL_WH_CD = RW.RTL_WH_CD (+)
        AND PO.GLBL_CMPY_CD           = VND.GLBL_CMPY_CD (+)
        AND PO.VND_CD                 = VND.VND_CD (+)
        AND PO.GLBL_CMPY_CD           = PMSI.GLBL_CMPY_CD (+)
        AND PO.PO_ORD_NUM             = PMSI.PO_ORD_NUM (+)
        AND PMSI.PO_MSG_TP_CD (+)     = #poMsgTpCdSi#
        AND PMSI.PO_MSG_SEG_ID (+)    = #poMsgSegId#
        AND PO.GLBL_CMPY_CD           = PMRN.GLBL_CMPY_CD (+)
        AND PO.PO_ORD_NUM             = PMRN.PO_ORD_NUM (+)
        AND PMRN.PO_MSG_TP_CD (+)     = #poMsgTpCdRn#
        AND PMRN.PO_MSG_SEG_ID (+)    = #poMsgSegId#
        AND PO.GLBL_CMPY_CD           = PMSN.GLBL_CMPY_CD (+)
        AND PO.PO_ORD_NUM             = PMSN.PO_ORD_NUM (+)
        AND PMSN.PO_MSG_TP_CD (+)     = #poMsgTpCdSn#
        AND PMSN.PO_MSG_SEG_ID (+)    = #poMsgSegId#
        AND PO.GLBL_CMPY_CD           = PD.GLBL_CMPY_CD
        AND PO.PO_ORD_NUM             = PD.PO_ORD_NUM
        AND PD.PO_STS_CD              = #poStsCdValidated#
        AND PD.GLBL_CMPY_CD           = OCV.GLBL_CMPY_CD (+)
        AND PD.CARR_CD                = OCV.CARR_CD (+)
        AND PD.PO_SEND_TS IS NULL
        AND PD.GLBL_CMPY_CD           = FC.GLBL_CMPY_CD (+)
        AND PD.FRT_COND_CD            = FC.FRT_COND_CD (+)
        AND PD.GLBL_CMPY_CD           = VU.GLBL_CMPY_CD (+)
        AND PD.PO_DISP_UOM_CD         = VU.VND_UOM_CD (+)
        AND PD.GLBL_CMPY_CD           = STC.GLBL_CMPY_CD (+)
        AND PD.SHIP_TO_CUST_CD        = STC.SHIP_TO_CUST_CD (+)
        AND PO.GLBL_CMPY_CD           = AP.GLBL_CMPY_CD (+)
        AND PO.PO_SUBMT_PSN_CD        = AP.USR_NM (+)
        AND PO.EZCANCELFLAG           = '0'
        AND DPT.EZCANCELFLAG (+)      = '0'
        AND PMSI.EZCANCELFLAG (+)     = '0'
        AND PMRN.EZCANCELFLAG (+)     = '0'
        AND PMSN.EZCANCELFLAG (+)     = '0'
        AND VND.EZCANCELFLAG (+)      = '0'
        AND RW.EZCANCELFLAG (+)       = '0'
        AND PD.EZCANCELFLAG           = '0'
        AND OCV.EZCANCELFLAG (+)      = '0'
        AND FC.EZCANCELFLAG (+)       = '0'
        AND VU.EZCANCELFLAG (+)       = '0'
        AND STC.EZCANCELFLAG (+)      = '0'
        ORDER BY
            PD.PO_ORD_DTL_LINE_NUM
    </statement>

    <!--QC#26074 Add Start-->
    <statement id="searchVndShipToXrefRtl" parameterClass="Map" resultClass="String">
    SELECT
        VSTX.VND_LOC_CD
    FROM
        VND_SHIP_TO_XREF VSTX
    WHERE 1=1
     AND VSTX.EZCANCELFLAG    = '0'
     AND VSTX.GLBL_CMPY_CD    = #glblCmpyCd#
     AND VSTX.VND_XREF_TP_CD  = #vndXrefTpCd#
     AND TO_DATE(NVL(VSTX.EFF_FROM_DT , #eftFromDt#), 'YYYY/MM/DD')  &lt; = TO_DATE(#slsDate# , 'YYYY/MM/DD' )
     AND TO_DATE(NVL(VSTX.EFF_THRU_DT , #eftThruDt#), 'YYYY/MM/DD')  &gt; = TO_DATE(#slsDate# , 'YYYY/MM/DD' )
    <isNotNull property="prchGrpCd">
     AND VSTX.PRCH_GRP_CD     = #prchGrpCd#
    </isNotNull>
    <isNotNull property="rtlWhCd">
     AND VSTX.RTL_WH_CD     = #rtlWhCd#
    </isNotNull>
     AND ROWNUM = 1
    </statement>
    <!--QC#26074 Add End-->
    
</sqlMap>