<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSBL0210Query">

    <typeAlias alias="NSBL0210_ASMsg"  type="business.blap.NSBL0210.NSBL0210_ASMsg"/>

    <statement id="searchData" parameterClass="Map" resultMap="result.searchData">
        SELECT
             T.MDL_GRP_NM
            ,T.MDL_GRP_DESC_TXT
            ,T.SVC_LINE_BIZ_CD
            ,T.SVC_PRC_TRVL_CHRG_FLG
            ,T.SVC_PRC_SHIFT_NUM
            ,T.SVC_PRC_SHIFT_DESC_TXT
            ,T.SVC_LBOR_UNIT_AMT
            ,T.SVC_MIN_CHRG_HRS_AOT
            ,T.INTG_MDSE_CD
            ,T.MDSE_DESC_SHORT_TXT
            ,T.SVC_LBOR_CHRG_PK
            ,T.MDL_GRP_ID
            ,ROWNUM AS XX_ROW_NUM
            ,T.EZUPTIME
            ,T.EZUPTIMEZONE
            <!-- START 2016/12/02 K.Kojima [QC#14204, ADD] -->
            ,T.XX_REC_HIST_CRAT_TS_A
            ,T.XX_REC_HIST_CRAT_BY_NM_A
            ,T.XX_REC_HIST_UPD_TS_A
            ,T.XX_REC_HIST_UPD_BY_NM_A
            ,T.XX_REC_HIST_TBL_NM_A
            <!-- END 2016/12/02 K.Kojima [QC#14204, ADD] -->
        FROM
            (SELECT
                 LBOR.MDL_GRP_NM
                ,MGRP.MDL_GRP_DESC_TXT
                ,LBOR.SVC_LINE_BIZ_CD
                ,LBOR.SVC_PRC_TRVL_CHRG_FLG
                ,LBOR.SVC_PRC_SHIFT_NUM
                ,PRCS.SVC_PRC_SHIFT_DESC_TXT
                ,LBOR.SVC_LBOR_UNIT_AMT
                ,LBOR.SVC_MIN_CHRG_HRS_AOT
                ,LBOR.INTG_MDSE_CD
                ,MDSE.MDSE_DESC_SHORT_TXT
                ,LBOR.SVC_LBOR_CHRG_PK
                ,LBOR.MDL_GRP_ID
                ,LBOR.EZUPTIME
                ,LBOR.EZUPTIMEZONE
                <!-- START 2016/12/02 K.Kojima [QC#14204, ADD] -->
                ,LBOR.EZINTIME    AS XX_REC_HIST_CRAT_TS_A
                ,LBOR.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM_A
                ,LBOR.EZUPTIME    AS XX_REC_HIST_UPD_TS_A
                ,LBOR.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM_A
                ,LBOR.EZTABLEID   AS XX_REC_HIST_TBL_NM_A
                <!-- END 2016/12/02 K.Kojima [QC#14204, ADD] -->
                FROM
                     SVC_LBOR_CHRG  LBOR
                    ,SVC_PRC_SHIFT  PRCS
                    ,DS_MDL_GRP     MGRP
                    ,LINE_BIZ_TP    LBIZ
                    ,AVAL_LINE_BIZ_TP_SRC ALB
                    ,MDSE           MDSE
                WHERE
                    LBOR.GLBL_CMPY_CD                   = #glblCmpyCd#
                    <isNotNull property="svcLineBizCd">
                    AND LBOR.SVC_LINE_BIZ_CD            = #svcLineBizCd#
                    </isNotNull>
                    <isNotNull property="mdlGrpNm">
                    AND MGRP.MDL_GRP_NM                 = #mdlGrpNm#
                    </isNotNull>
                    <isNotNull property="svcPrcShiftDescTxt">
                    AND PRCS.SVC_PRC_SHIFT_DESC_TXT LIKE #svcPrcShiftDescTxt#
                    </isNotNull>
                    AND LBOR.GLBL_CMPY_CD               = PRCS.GLBL_CMPY_CD(+)
                    AND LBOR.SVC_PRC_SHIFT_NUM          = PRCS.SVC_PRC_SHIFT_NUM(+)
                    AND LBOR.SVC_LINE_BIZ_CD            = PRCS.SVC_LINE_BIZ_CD(+)
                    AND LBOR.GLBL_CMPY_CD               = MGRP.GLBL_CMPY_CD(+)
                    AND LBOR.MDL_GRP_ID                 = MGRP.MDL_GRP_ID(+)
                    AND LBOR.GLBL_CMPY_CD               = LBIZ.GLBL_CMPY_CD(+)
                    AND LBOR.SVC_LINE_BIZ_CD            = LBIZ.LINE_BIZ_TP_CD(+)
                    AND LBIZ.GLBL_CMPY_CD               = ALB.GLBL_CMPY_CD(+)
                    AND LBIZ.LINE_BIZ_TP_CD             = ALB.LINE_BIZ_TP_CD(+)
                    AND ALB.SYS_SRC_CD(+)               = #sysSrcCd#
                    AND LBOR.GLBL_CMPY_CD               = MDSE.GLBL_CMPY_CD(+)
                    AND LBOR.INTG_MDSE_CD               = MDSE.MDSE_CD(+)
                    AND LBOR.EZCANCELFLAG               = '0'
                    AND PRCS.EZCANCELFLAG(+)            = '0'
                    AND MGRP.EZCANCELFLAG(+)            = '0'
                    AND LBIZ.EZCANCELFLAG(+)            = '0'
                    AND ALB.EZCANCELFLAG(+)             = '0'
                    AND MDSE.EZCANCELFLAG(+)            = '0'
                    ORDER BY
                         LBOR.MDL_GRP_NM ASC
                        ,LBOR.SVC_LINE_BIZ_CD ASC
                        ,PRCS.SVC_PRC_SHIFT_NUM ASC
            ) T
                WHERE
                    ROWNUM &lt;= #limitNum#
    </statement>

    <resultMap id="result.searchData"        class="NSBL0210_ASMsg">
        <result property="xxRowNum"             column="XX_ROW_NUM"             javaType="EZDSBigDecimalItem" />
        <result property="mdlGrpNm"             column="MDL_GRP_NM"             javaType="EZDSStringItem" />
        <result property="mdlGrpDescTxt"        column="MDL_GRP_DESC_TXT"       javaType="EZDSStringItem" />
        <result property="mdlGrpId"             column="MDL_GRP_ID"             javaType="EZDSBigDecimalItem" />
        <result property="svcLineBizCd"         column="SVC_LINE_BIZ_CD"        javaType="EZDSStringItem" />
        <result property="svcPrcTrvlChrgFlg"    column="SVC_PRC_TRVL_CHRG_FLG"  javaType="EZDSStringItem" />
        <result property="svcPrcShiftNum"       column="SVC_PRC_SHIFT_NUM"      javaType="EZDSStringItem" />
        <result property="svcPrcShiftDescTxt"   column="SVC_PRC_SHIFT_DESC_TXT" javaType="EZDSStringItem" />
        <result property="svcLborUnitAmt"       column="SVC_LBOR_UNIT_AMT"      javaType="EZDSBigDecimalItem" />
        <result property="svcMinChrgHrsAot"     column="SVC_MIN_CHRG_HRS_AOT"   javaType="EZDSBigDecimalItem" />
        <result property="intgMdseCd"           column="INTG_MDSE_CD"           javaType="EZDSStringItem" />
        <result property="mdseDescShortTxt"     column="MDSE_DESC_SHORT_TXT"    javaType="EZDSStringItem" />
        <result property="svcLborChrgPk"        column="SVC_LBOR_CHRG_PK"       javaType="EZDSBigDecimalItem" />
        <result property="ezUpTime"             column="EZUPTIME"               javaType="EZDSStringItem" />
        <result property="ezUpTimeZone"         column="EZUPTIMEZONE"           javaType="EZDSStringItem" />
        <!-- START 2016/12/02 K.Kojima [QC#14204, ADD] -->
        <result property="xxRecHistCratTs_A"           column="XX_REC_HIST_CRAT_TS_A"           javaType="EZDSStringItem"/>
        <result property="xxRecHistCratByNm_A"         column="XX_REC_HIST_CRAT_BY_NM_A"        javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdTs_A"            column="XX_REC_HIST_UPD_TS_A"            javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdByNm_A"          column="XX_REC_HIST_UPD_BY_NM_A"         javaType="EZDSStringItem"/>
        <result property="xxRecHistTblNm_A"            column="XX_REC_HIST_TBL_NM_A"            javaType="EZDSStringItem"/>
        <!-- END 2016/12/02 K.Kojima [QC#14204, ADD] -->
    </resultMap>

    <statement id="getSvcLineBizList" parameterClass="Map" resultClass="Map">
        SELECT
             A.LINE_BIZ_TP_CD           LINE_BIZ_TP_CD
            ,A.LINE_BIZ_TP_DESC_TXT     LINE_BIZ_TP_DESC_TXT
        FROM
             LINE_BIZ_TP          A
            ,AVAL_LINE_BIZ_TP_SRC B
        WHERE
                A.GLBL_CMPY_CD         = #glblCmpyCd#
            AND A.EZCANCELFLAG         = '0'
            AND A.GLBL_CMPY_CD         = B.GLBL_CMPY_CD
            AND A.LINE_BIZ_TP_CD       = B.LINE_BIZ_TP_CD
            AND B.SYS_SRC_CD           = #sysSrcCd#
            AND B.EZCANCELFLAG         = '0'
        ORDER BY
            A.LINE_BIZ_TP_SORT_NUM
    </statement>
</sqlMap>
