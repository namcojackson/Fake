<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="ZZOL0600Query">

	<typeAlias alias="ZZOL0600CMsg"		type="business.blap.ZZOL0600.ZZOL0600CMsg"/>
	<typeAlias alias="ZZOL0600_ASMsg"	type="business.blap.ZZOL0600.ZZOL0600_ASMsg"/>
	
	<statement id="getAbendLogLimitedDetails" parameterClass="Map" resultMap="result.getAbendLogLimitedData">
	SELECT
	        EZINTIME
	    ,   EZINTIMEZONE
	    ,	GLBL_CMPY_CD
	    ,   ALMS_UNIVS_UNIQ_ID
	    ,   ALMS_SYS_NM
	    ,   ALMS_HOST_NM
	    ,   ALMS_USR_ID
	    ,	ALMS_MSG_ID
	    ,   ALMS_FWK_VRSN_TXT
	    ,	ALMS_APP_VRSN_TXT
	    ,	ALMS_REL_VRSN_TXT
	    ,	ALMS_DB_VRSN_TXT
	    ,   ALMS_PGM_ID
	    ,	ALMS_JOB_ID
	    ,	ALMS_ONL_BAT_FLG
	    ,	ALMS_JVM_NM
	    ,	ALMS_BAT_PROC_ID
	    ,	ALMS_SEVTY_LVL_TXT
	    ,	ALMS_MSG_TXT
		    
		FROM
		        ABEND_LOG

		WHERE
			EZCANCELFLAG = 0 
		<isNotNull property="cMsg.glblCmpyCd">
			AND GLBL_CMPY_CD = #cMsg.glblCmpyCd#
		</isNotNull>
		
		<isNotNull property="cMsg.ezInTime_FR">
			AND EZINTIME &gt;= #cMsg.ezInTime_FR#
		</isNotNull>
		
		<isNotNull property="cMsg.ezInTime_TO">
			AND EZINTIME &lt;= #cMsg.ezInTime_TO#
		</isNotNull>
		
		<isNotNull property="cMsg.almsUnivsUniqId">
			AND ALMS_UNIVS_UNIQ_ID LIKE #cMsg.almsUnivsUniqId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsMsgId">
			AND ALMS_MSG_ID LIKE #cMsg.almsMsgId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsJobId">
			AND ALMS_JOB_ID LIKE #cMsg.almsJobId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsBatProcId">
			AND ALMS_BAT_PROC_ID LIKE #cMsg.almsBatProcId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsOnlBatFlg_F2">
			AND ALMS_ONL_BAT_FLG LIKE #cMsg.almsOnlBatFlg_F2#
		</isNotNull>
		
		<isNotNull property="cMsg.almsPgmId">
			AND ALMS_PGM_ID LIKE #cMsg.almsPgmId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsHostNm">
			AND ALMS_HOST_NM LIKE #cMsg.almsHostNm#
		</isNotNull>
		
		<isNotNull property="cMsg.almsUsrId">
			AND ALMS_USR_ID LIKE #cMsg.almsUsrId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsRelVrsnTxt">
			AND ALMS_REL_VRSN_TXT LIKE #cMsg.almsRelVrsnTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsDbVrsnTxt">
			AND ALMS_DB_VRSN_TXT LIKE #cMsg.almsDbVrsnTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsAppVrsnTxt">
			AND ALMS_APP_VRSN_TXT LIKE #cMsg.almsAppVrsnTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsFwkVrsnTxt">
			AND ALMS_FWK_VRSN_TXT LIKE #cMsg.almsFwkVrsnTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsSevtyLvlTxt">
			AND ALMS_SEVTY_LVL_TXT LIKE #cMsg.almsSevtyLvlTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsSysNm">
			AND ALMS_SYS_NM LIKE #cMsg.almsSysNm#
		</isNotNull>
		
		<isNotNull property="cMsg.almsMsgTxt">
			AND ALMS_MSG_TXT LIKE #cMsg.almsMsgTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsJvmNm">
			AND ALMS_JVM_NM LIKE #cMsg.almsJvmNm#
		</isNotNull>
		
		AND ALMS_MSG_TXT NOT LIKE 'User cannot be authenticated.'
		AND ALMS_MSG_TXT NOT LIKE 'Timeout'
		AND ALMS_MSG_TXT NOT LIKE '[S21WfAsyncJobBusinessHandler.doProcess closeJbpmC'
		AND ALMS_MSG_TXT NOT LIKE 'ScreenDuplication'
			
		AND ROWNUM &lt;= 1001
				
		ORDER BY
			EZINTIME DESC,
			EZINTIMEZONE DESC,
			GLBL_CMPY_CD DESC,
			ALMS_MSG_ID DESC,
			ALMS_JOB_ID DESC,
			ALMS_ONL_BAT_FLG DESC,
			ALMS_BAT_PROC_ID DESC,
			ALMS_UNIVS_UNIQ_ID DESC,
			ALMS_SEVTY_LVL_TXT DESC,
			ALMS_PGM_ID DESC,
			ALMS_FWK_VRSN_TXT DESC,
			ALMS_APP_VRSN_TXT DESC,
			ALMS_REL_VRSN_TXT DESC,
			ALMS_DB_VRSN_TXT
	</statement>
	
	<resultMap id="result.getAbendLogLimitedData"     class="ZZOL0600_ASMsg">
		<result property="ezInTime_TR"			column="EZINTIME"        	javaType="EZDSStringItem"/>
		<result property="ezInTimeZone_TR"		column="EZINTIMEZONE"       javaType="EZDSStringItem"/>
		<result property="glblCmpyCd_TR"		column="GLBL_CMPY_CD"    javaType="EZDSStringItem"/>
		<result property="almsUnivsUniqId_TR"		column="ALMS_UNIVS_UNIQ_ID"        	javaType="EZDSStringItem"/>
		<result property="almsSysNm_TR"			column="ALMS_SYS_NM"       	javaType="EZDSStringItem"/>
		<result property="almsHostNm_TR"			column="ALMS_HOST_NM"      	javaType="EZDSStringItem"/>
		<result property="almsUsrId_TR"      	column="ALMS_USR_ID"        	javaType="EZDSStringItem"/>
		<result property="almsMsgId_TR"      	column="ALMS_MSG_ID"      javaType="EZDSStringItem"/>
		<result property="almsFwkVrsnTxt_TR"      	column="ALMS_FWK_VRSN_TXT"        javaType="EZDSStringItem"/>
		<result property="almsAppVrsnTxt_TR"      column="ALMS_APP_VRSN_TXT"   javaType="EZDSStringItem"/>
		<result property="almsRelVrsnTxt_TR"      	column="ALMS_REL_VRSN_TXT"        javaType="EZDSStringItem"/>
		<result property="almsDbVrsnTxt_TR"      	column="ALMS_DB_VRSN_TXT"        javaType="EZDSStringItem"/>
		<result property="almsPgmId_TR"      column="ALMS_PGM_ID"   javaType="EZDSStringItem"/>
		<result property="almsJobId_TR"      column="ALMS_JOB_ID"   javaType="EZDSStringItem"/>
		<result property="almsOnlBatFlg_TR"      column="ALMS_ONL_BAT_FLG"   javaType="EZDSStringItem"/>
		<result property="almsJvmNm_TR"      column="ALMS_JVM_NM"   javaType="EZDSStringItem"/>
		<result property="almsBatProcId_TR"      column="ALMS_BAT_PROC_ID"   javaType="EZDSStringItem"/>
		<result property="almsSevtyLvlTxt_TR"      column="ALMS_SEVTY_LVL_TXT"   javaType="EZDSStringItem"/>
		<result property="almsMsgTxt_TR"      column="ALMS_MSG_TXT"   javaType="EZDSStringItem"/>
		
	</resultMap>
	
	
	<statement id="getAbendLogCompleteDetails" parameterClass="Map" resultMap="result.getAbendLogCompleteData">
		SELECT
	        EZINTIME
	    ,   EZINTIMEZONE
	    ,	GLBL_CMPY_CD
	    ,   ALMS_UNIVS_UNIQ_ID
	    ,   ALMS_SYS_NM
	    ,   ALMS_HOST_NM
	    ,   ALMS_USR_ID
	    ,	ALMS_MSG_ID
	    ,   ALMS_FWK_VRSN_TXT
	    ,	ALMS_APP_VRSN_TXT
	    ,	ALMS_REL_VRSN_TXT
	    ,	ALMS_DB_VRSN_TXT
	    ,   ALMS_PGM_ID
	    ,	ALMS_JOB_ID
	    ,	ALMS_ONL_BAT_FLG
	    ,	ALMS_JVM_NM
	    ,	ALMS_BAT_PROC_ID
	    ,	ALMS_SEVTY_LVL_TXT
	    ,	ALMS_MSG_TXT
		    
		FROM
		        ABEND_LOG

		WHERE
			EZCANCELFLAG = 0 
		<isNotNull property="cMsg.glblCmpyCd">
			AND GLBL_CMPY_CD = #cMsg.glblCmpyCd#
		</isNotNull>
		
		<isNotNull property="cMsg.ezInTime_FR">
			AND EZINTIME &gt;= #cMsg.ezInTime_FR#
		</isNotNull>
		
		<isNotNull property="cMsg.ezInTime_TO">
			AND EZINTIME &lt;= #cMsg.ezInTime_TO#
		</isNotNull>
		
		<isNotNull property="cMsg.almsUnivsUniqId">
			AND ALMS_UNIVS_UNIQ_ID LIKE #cMsg.almsUnivsUniqId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsMsgId">
			AND ALMS_MSG_ID LIKE #cMsg.almsMsgId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsJobId">
			AND ALMS_JOB_ID LIKE #cMsg.almsJobId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsBatProcId">
			AND ALMS_BAT_PROC_ID LIKE #cMsg.almsBatProcId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsOnlBatFlg_F2">
			AND ALMS_ONL_BAT_FLG LIKE #cMsg.almsOnlBatFlg_F2#
		</isNotNull>
		
		<isNotNull property="cMsg.almsPgmId">
			AND ALMS_PGM_ID LIKE #cMsg.almsPgmId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsHostNm">
			AND ALMS_HOST_NM LIKE #cMsg.almsHostNm#
		</isNotNull>
		
		<isNotNull property="cMsg.almsUsrId">
			AND ALMS_USR_ID LIKE #cMsg.almsUsrId#
		</isNotNull>
		
		<isNotNull property="cMsg.almsRelVrsnTxt">
			AND ALMS_REL_VRSN_TXT LIKE #cMsg.almsRelVrsnTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsDbVrsnTxt">
			AND ALMS_DB_VRSN_TXT LIKE #cMsg.almsDbVrsnTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsAppVrsnTxt">
			AND ALMS_APP_VRSN_TXT LIKE #cMsg.almsAppVrsnTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsFwkVrsnTxt">
			AND ALMS_FWK_VRSN_TXT LIKE #cMsg.almsFwkVrsnTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsSevtyLvlTxt">
			AND ALMS_SEVTY_LVL_TXT LIKE #cMsg.almsSevtyLvlTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsSysNm">
			AND ALMS_SYS_NM LIKE #cMsg.almsSysNm#
		</isNotNull>
		
		<isNotNull property="cMsg.almsMsgTxt">
			AND ALMS_MSG_TXT LIKE #cMsg.almsMsgTxt#
		</isNotNull>
		
		<isNotNull property="cMsg.almsJvmNm">
			AND ALMS_JVM_NM LIKE #cMsg.almsJvmNm#
		</isNotNull>
			
		AND ROWNUM &lt;= 1001
				
		ORDER BY
			EZINTIME DESC,
			EZINTIMEZONE DESC,
			GLBL_CMPY_CD DESC,
			ALMS_MSG_ID DESC,
			ALMS_JOB_ID DESC,
			ALMS_ONL_BAT_FLG DESC,
			ALMS_BAT_PROC_ID DESC,
			ALMS_UNIVS_UNIQ_ID DESC,
			ALMS_SEVTY_LVL_TXT DESC,
			ALMS_PGM_ID DESC,
			ALMS_FWK_VRSN_TXT DESC,
			ALMS_APP_VRSN_TXT DESC,
			ALMS_REL_VRSN_TXT DESC,
			ALMS_DB_VRSN_TXT
	</statement>
	
	<resultMap id="result.getAbendLogCompleteData"     class="ZZOL0600_ASMsg">
		<result property="ezInTime_TR"			column="EZINTIME"        	javaType="EZDSStringItem"/>
		<result property="ezInTimeZone_TR"		column="EZINTIMEZONE"       javaType="EZDSStringItem"/>
		<result property="glblCmpyCd_TR"		column="GLBL_CMPY_CD"    javaType="EZDSStringItem"/>
		<result property="almsUnivsUniqId_TR"		column="ALMS_UNIVS_UNIQ_ID"        	javaType="EZDSStringItem"/>
		<result property="almsSysNm_TR"			column="ALMS_SYS_NM"       	javaType="EZDSStringItem"/>
		<result property="almsHostNm_TR"			column="ALMS_HOST_NM"      	javaType="EZDSStringItem"/>
		<result property="almsUsrId_TR"      	column="ALMS_USR_ID"        	javaType="EZDSStringItem"/>
		<result property="almsMsgId_TR"      	column="ALMS_MSG_ID"      javaType="EZDSStringItem"/>
		<result property="almsFwkVrsnTxt_TR"      	column="ALMS_FWK_VRSN_TXT"        javaType="EZDSStringItem"/>
		<result property="almsAppVrsnTxt_TR"      column="ALMS_APP_VRSN_TXT"   javaType="EZDSStringItem"/>
		<result property="almsRelVrsnTxt_TR"      	column="ALMS_REL_VRSN_TXT"        javaType="EZDSStringItem"/>
		<result property="almsDbVrsnTxt_TR"      	column="ALMS_DB_VRSN_TXT"        javaType="EZDSStringItem"/>
		<result property="almsPgmId_TR"      column="ALMS_PGM_ID"   javaType="EZDSStringItem"/>
		<result property="almsJobId_TR"      column="ALMS_JOB_ID"   javaType="EZDSStringItem"/>
		<result property="almsOnlBatFlg_TR"      column="ALMS_ONL_BAT_FLG"   javaType="EZDSStringItem"/>
		<result property="almsJvmNm_TR"      column="ALMS_JVM_NM"   javaType="EZDSStringItem"/>
		<result property="almsBatProcId_TR"      column="ALMS_BAT_PROC_ID"   javaType="EZDSStringItem"/>
		<result property="almsSevtyLvlTxt_TR"      column="ALMS_SEVTY_LVL_TXT"   javaType="EZDSStringItem"/>
		<result property="almsMsgTxt_TR"      column="ALMS_MSG_TXT"   javaType="EZDSStringItem"/>
	</resultMap>


    <statement id="getJobLogPathName" parameterClass="Map" resultClass="Map">
		SELECT
	        BAT_PROC_JOB_LOG_PATH_NM
		FROM
		    BAT_PROC_LOG
		WHERE
			EZCANCELFLAG = 0 
		<isNotNull property="cMsg.glblCmpyCd">
			AND GLBL_CMPY_CD = #cMsg.glblCmpyCd#
		</isNotNull>
			
		AND BAT_PROC_LOG_PK = #BAT_PROC_LOG_PK#
			
		ORDER BY
			EZINTIME ASC,
			EZINTIMEZONE ASC,
			GLBL_CMPY_CD ASC,
			BAT_PROC_LOG_PK ASC
	</statement>
	
	<statement id="getClobData" parameterClass="Map" resultClass="Map">
		SELECT
	          ALMS_MSG_DTL_CLOD
			, DBMS_LOB.GETCHUNKSIZE(ALMS_MSG_DTL_CLOD) AS CHUNK_SIZE
		FROM
		    ABEND_LOG
		WHERE
			EZCANCELFLAG = 0 
			AND GLBL_CMPY_CD = #GLBL_CMPY_CD#
			AND ALMS_UNIVS_UNIQ_ID = #ALMS_UNIVS_UNIQ_ID#
	</statement>
	

</sqlMap>
