<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAB055001">
    <statement id="getSkipBllgSchd" parameterClass="Map" resultClass="Map">
        SELECT
             C.DS_CONTR_PK                 AS DS_CONTR_PK
            ,A.DS_CONTR_BLLG_SCHD_PK       AS DS_CONTR_BLLG_SCHD_PK
        FROM
             DS_CONTR_BLLG_SCHD    A
            ,DS_CONTR_DTL          B
            ,DS_CONTR              C
        WHERE
                A.EZCANCELFLAG                     =  '0'
            AND A.GLBL_CMPY_CD                     =  #glblCmpyCd#
            AND A.SKIP_RECOV_TP_CD                 =  #skipRecovTpCdSkip#
            AND NVL(A.RVS_SCHD_DT, A.NEXT_BLLG_DT) &lt;= #salesDate#
            AND A.DS_BLLG_SCHD_STS_CD              &lt;&gt; #dsBllgSchdStsCdClose#
            AND A.BLLBL_FLG                        =  'N'
            AND B.EZCANCELFLAG                     =  '0'
            AND A.GLBL_CMPY_CD                     =  B.GLBL_CMPY_CD
            AND A.DS_CONTR_DTL_PK                  =  B.DS_CONTR_DTL_PK
            AND C.EZCANCELFLAG                     =  '0'
            AND B.GLBL_CMPY_CD                     =  C.GLBL_CMPY_CD
            AND B.DS_CONTR_PK                      =  C.DS_CONTR_PK
            AND EXISTS(
                    SELECT
                        1
                    FROM
                        DUAL
                    WHERE
                        MOD(
                            NVL(
                                (SELECT
                                     X.SELL_TO_CUST_PK
                                 FROM
                                     SELL_TO_CUST X
                                 WHERE
                                     X.EZCANCELFLAG    = '0'
                                 AND X.GLBL_CMPY_CD    = C.GLBL_CMPY_CD
                                 AND X.SELL_TO_CUST_CD = C.DS_ACCT_NUM)
                            ,0)
                        ,#multiCnt#) = #usrVar1#
            )
        ORDER BY
             C.DS_CONTR_NUM
            ,A.DS_CONTR_DTL_PK
            ,A.USG_CHRG_FLG
            ,A.DS_CONTR_BLLG_MTR_PK
            ,A.NEXT_BLLG_DT
    </statement>
</sqlMap>
