<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAL1220Query">
    <typeAlias alias="NSAL1220_ACMsg" type="business.blap.NSAL1220.NSAL1220_ACMsg"/>

    <statement id="getContrInfo" parameterClass="Map" resultMap="result.getContrInfo">
        SELECT
             DS_CONTR_PK                    AS DS_CONTR_PK
            ,DS_CONTR_DTL_PK                AS DS_CONTR_DTL_Pk
            ,SVC_INV_CHRG_TP_CD             AS SVC_INV_CHRG_TP_CD
            ,COA_BR_CD                      AS COA_BR_CD
            ,PRC_ALLOC_RATE                 AS PRC_ALLOC_RATE
            <!-- START 2016/12/02 K.Kojima [QC#14204, ADD] -->
            ,XX_REC_HIST_CRAT_TS_A
            ,XX_REC_HIST_CRAT_BY_NM_A
            ,XX_REC_HIST_UPD_TS_A
            ,XX_REC_HIST_UPD_BY_NM_A
            ,XX_REC_HIST_TBL_NM_A
            <!-- END 2016/12/02 K.Kojima [QC#14204, ADD] -->
        FROM (
            SELECT
                 DCB.DS_CONTR_PK            AS DS_CONTR_PK
                ,DCB.DS_CONTR_DTL_PK        AS DS_CONTR_DTL_Pk
                ,DCB.SVC_INV_CHRG_TP_CD     AS SVC_INV_CHRG_TP_CD
                ,DCB.COA_BR_CD              AS COA_BR_CD
                ,DCB.PRC_ALLOC_RATE         AS PRC_ALLOC_RATE
                <!-- START 2016/12/02 K.Kojima [QC#14204, ADD] -->
                ,DCB.EZINTIME    AS XX_REC_HIST_CRAT_TS_A
                ,DCB.EZINUSERID  AS XX_REC_HIST_CRAT_BY_NM_A
                ,DCB.EZUPTIME    AS XX_REC_HIST_UPD_TS_A
                ,DCB.EZUPUSERID  AS XX_REC_HIST_UPD_BY_NM_A
                ,DCB.EZTABLEID   AS XX_REC_HIST_TBL_NM_A
                <!-- END 2016/12/02 K.Kojima [QC#14204, ADD] -->
            FROM
                 DS_CONTR_BR_ALLOC   DCB
            WHERE
                    DCB.GLBL_CMPY_CD        = #glblCmpyCd#
                AND DCB.DS_CONTR_PK         = #dsContrPk#
                <isNotNull property="dsContrDtlPk">
                AND DCB.DS_CONTR_DTL_PK     = #dsContrDtlPk#
                </isNotNull>
                <isNull property="dsContrDtlPk">
                AND DCB.DS_CONTR_DTL_PK     IS NULL
                </isNull>
                <isNotNull property="svcInvChrgTpCd">
                AND DCB.SVC_INV_CHRG_TP_CD  = #svcInvChrgTpCd#
                </isNotNull>
                <isNull property="svcInvChrgTpCd">
                AND DCB.SVC_INV_CHRG_TP_CD  IS NULL
                </isNull>
                AND DCB.EZCANCELFLAG        = '0'
            ORDER BY
                 DCB.COA_BR_CD ASC NULLS LAST
        )
        WHERE
            ROWNUM                  &lt;= #limitCnt#
    </statement>
    <resultMap id="result.getContrInfo" class="NSAL1220_ACMsg">
        <result property="coaBrCd_A"              column="COA_BR_CD"              javaType="EZDCStringItem" />
        <result property="prcAllocRate_A"         column="PRC_ALLOC_RATE"         javaType="EZDCBigDecimalItem" />
        <!-- START 2016/12/02 K.Kojima [QC#14204, ADD] -->
        <result property="xxRecHistCratTs_A"      column="XX_REC_HIST_CRAT_TS_A"    javaType="EZDSStringItem"/>
        <result property="xxRecHistCratByNm_A"    column="XX_REC_HIST_CRAT_BY_NM_A" javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdTs_A"       column="XX_REC_HIST_UPD_TS_A"     javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdByNm_A"     column="XX_REC_HIST_UPD_BY_NM_A"  javaType="EZDSStringItem"/>
        <result property="xxRecHistTblNm_A"       column="XX_REC_HIST_TBL_NM_A"     javaType="EZDSStringItem"/>
        <!-- END 2016/12/02 K.Kojima [QC#14204, ADD] -->
    </resultMap>
</sqlMap>
