<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAL0010Query">

    <typeAlias alias="NSAL0010CMsg" type="business.blap.NSAL0010.NSAL0010CMsg"/>
    <typeAlias alias="NSAL0010_ASMsg" type="business.blap.NSAL0010.NSAL0010_ASMsg"/>
    <typeAlias alias="NSAL0010_BSMsg" type="business.blap.NSAL0010.NSAL0010_BSMsg"/>
    <typeAlias alias="NSAL0010_CSMsg" type="business.blap.NSAL0010.NSAL0010_CSMsg"/>
    <typeAlias alias="NSAL0010_ESMsg" type="business.blap.NSAL0010.NSAL0010_ESMsg"/>
    <typeAlias alias="NSAL0010_GSMsg" type="business.blap.NSAL0010.NSAL0010_GSMsg"/>
    <typeAlias alias="NSAL0010_ISMsg" type="business.blap.NSAL0010.NSAL0010_ISMsg"/>
    <typeAlias alias="NSAL0010_JSMsg" type="business.blap.NSAL0010.NSAL0010_JSMsg"/>
    <typeAlias alias="NSAL0010_KSMsg" type="business.blap.NSAL0010.NSAL0010_KSMsg"/>
    <typeAlias alias="NSAL0010_LSMsg" type="business.blap.NSAL0010.NSAL0010_LSMsg"/>

<!-- START 2016/05/16 T.Tomita [QC#4578, MOD] -->
    <statement id="getSvcMachMstr" parameterClass="Map" resultMap="result.getSvcMachMstr">
           SELECT
                 GLBL_CMPY_CD
                ,SVC_MACH_MSTR_PK_H1
                ,EZUPTIME_H1
                ,EZUPTIMEZONE_H1
                ,SVC_MACH_TP_CD
                ,SER_NUM_H1
                ,MDSE_CD_H1
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--            ,MDSE_NM_H1     -->
                ,MDSE_DESC_SHORT_TXT_H1
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
                ,MKT_MDL_NM_H1
                ,T_MDL_NM_H1
                ,SVC_MACH_QTY_H1
                ,ISTL_DT_H1
                ,START_DT_H1
                ,SVC_MACH_RMV_DT_H1
                ,SVC_MACH_MSTR_STS_CD_H3
                ,SVC_MACH_USG_STS_CD_H3
                ,STK_STS_CD_H3
                ,PRNT_SER_NUM_H1
                ,CUST_MACH_CTRL_NUM_H1
                ,SVC_MACH_TRX_TP_CD_H3
                ,SVC_MACH_MSTR_LOC_STS_CD_H3
                ,DECODE(IWR_ENBL_FLG_H1, 'Y', #yes#, 'N', #no#) XX_YES_NO_NM_H1
                ,IWR_ENBL_FLG_H1
                ,IWR_COND_DESC_TXT_H1
                ,CASE
                     WHEN IWR_LAST_COMM_TS_H1 IS NOT NULL THEN SUBSTR(IWR_LAST_COMM_TS_H1, #yyyymmddStartIndex#, #yyyymmddLength#)
                     ELSE ''
                 END LAST_UPD_DT_H1
                ,IWR_LAST_COMM_TS_H1
                ,IWR_RGTN_DT_H1
                ,IWR_DEINS_DT_H1
                ,IWR_RGTN_STS_CD_H1
                ,OWNR_ACCT_NUM_M1
                ,DS_ACCT_NM_M1
                ,BILL_TO_ACCT_NUM_M2
                ,DS_ACCT_NM_M2
                ,XX_COMN_SCR_COL_VAL_TXT_M2
                ,IND_BILL_TO_LOC_NUM_M2
                ,CUR_LOC_ACCT_NUM_M3
                ,DS_ACCT_NM_M3
                ,XX_COMN_SCR_COL_VAL_TXT_M3
                ,IND_CUR_LOC_NUM_M3
                ,CTRL_FLD_TXT_01
                ,CTRL_FLD_TXT_02
                ,CTRL_FLD_TXT_03
                ,CTRL_FLD_TXT_04
                ,CTRL_FLD_TXT_05
                ,CTRL_FLD_TXT_06
                ,PRC_CONTR_NUM_D
                ,CORP_ADVTG_STS_CD_DS
<!-- START 2016/12/13 K.Ochiai [QC#16563, MOD] -->
                ,CUST_ISS_PO_NUM_D
<!-- END 2016/12/13 K.Ochiai [QC#16563, MOD] -->
                ,DS_PO_EXPR_DT_D
                ,XX_CHK_BOX_D1
                ,XX_CHK_BOX_D2
                ,XX_CHK_BOX_D3
                ,XX_CHK_BOX_D4
                ,SVC_BR_CD_D
                ,IWR_COND_CD_DS
                ,SVC_NTWK_CONN_STS_CD_DS
                ,SLD_BY_LINE_BIZ_TP_CD_DS
                ,SVC_BY_LINE_BIZ_TP_CD_DS
                ,PRF_TECH_CD_D
                ,REQ_TECH_CD_D
                ,SVC_LIC_CNT_D
                ,FIN_BR_CD_D
                ,XX_CHK_BOX_D5
                ,ENET_CMNT_TXT_01
                ,ENET_CMNT_TXT_02
                ,BIZ_HRS_SUN_FROM_TM_D
                ,BIZ_HRS_SUN_TO_TM_D
                ,BIZ_HRS_MON_FRI_FROM_TM_D
                ,BIZ_HRS_MON_FRI_TO_TM_D
                ,BIZ_HRS_SAT_FROM_TM_D
                ,BIZ_HRS_SAT_TO_TM_D
<!-- START 2023/07/10 Y.Nagasawa [QC#61524, DEL] -->
<!--                ,LOC_NM_F -->
<!--               ,ADDL_LOC_NM_F--> 
<!--                ,CTRY_CD_FS -->
<!--                ,FIRST_LINE_ADDR_F -->
<!--                ,SCD_LINE_ADDR_F -->
<!--                ,THIRD_LINE_ADDR_F -->
<!--                ,FRTH_LINE_ADDR_F -->
<!--                ,SVC_MACH_FL_NM_F -->
<!--                ,POST_CD_F -->
<!--                ,CTY_ADDR_F -->
<!--                ,ST_CD_F -->
<!--                ,CNTY_NM_F -->
<!--                ,PROV_NM_F -->
<!-- END 2023/07/10 Y.Nagasawa [QC#61524, DEL] -->
                ,SVC_MACH_MAINT_AVAL_FLG
<!-- START 2016/02/29 [QC#947, ADD] -->
                ,TECH_NM_D1
                ,TECH_NM_D2
<!-- END 2016/02/29 [QC#947, ADD] -->
<!-- START 2023/07/31 Y.Nagasawa [QC#61632, ADD] -->
                ,SW_LIC_ID
<!-- END 2023/07/31 Y.Nagasawa [QC#61632, ADD] -->
<!-- START 2023/10/06 K.Ishizuka [QC#54186, ADD] -->
                ,ISTL_BY_SVC_PRVD_PTY_CD_DS
                ,SVC_BY_SVC_PRVD_PTY_CD_DS
<!-- END 2023/10/06 K.Ishizuka [QC#54186, ADD] -->
            FROM (
                SELECT
                      SMM.GLBL_CMPY_CD                    GLBL_CMPY_CD
                     ,SMM.SVC_MACH_MSTR_PK                SVC_MACH_MSTR_PK_H1
                     ,SMM.EZUPTIME                        EZUPTIME_H1
                     ,SMM.EZUPTIMEZONE                    EZUPTIMEZONE_H1
                     ,SMM.SVC_MACH_TP_CD                  SVC_MACH_TP_CD
                     ,SMM.SER_NUM                         SER_NUM_H1
                     ,SMM.MDSE_CD                         MDSE_CD_H1
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--                 ,MDS.MDSE_NM                         MDSE_NM_H1        -->
                     ,MDS.MDSE_DESC_SHORT_TXT             MDSE_DESC_SHORT_TXT_H1
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
                     ,MKM.MKT_MDL_NM                      MKT_MDL_NM_H1
                     ,MLN.T_MDL_NM                        T_MDL_NM_H1
                     ,SMM.SVC_MACH_QTY                    SVC_MACH_QTY_H1
                     ,SMM.ISTL_DT                         ISTL_DT_H1
                     ,SMM.EFF_FROM_DT                     START_DT_H1
                     ,SMM.EFF_THRU_DT                     SVC_MACH_RMV_DT_H1
                     ,SMS.SVC_MACH_MSTR_STS_CD            SVC_MACH_MSTR_STS_CD_H3
                     ,SUS.SVC_MACH_USG_STS_CD             SVC_MACH_USG_STS_CD_H3
                     ,STS.STK_STS_CD                      STK_STS_CD_H3
                     ,SMM.PRNT_SER_NUM                    PRNT_SER_NUM_H1
                     ,SMM.CUST_MACH_CTRL_NUM              CUST_MACH_CTRL_NUM_H1
                     ,SMT.SVC_MACH_TRX_TP_CD              SVC_MACH_TRX_TP_CD_H3
                     ,SMM.SVC_MACH_MSTR_LOC_STS_CD        SVC_MACH_MSTR_LOC_STS_CD_H3
                     ,MDS.IWR_ENBL_FLG                    IWR_ENBL_FLG_H1
                     ,IWC.IWR_COND_DESC_TXT               IWR_COND_DESC_TXT_H1
                     ,IWR.IWR_LAST_COMM_TS                IWR_LAST_COMM_TS_H1
                     ,IWR.IWR_RGTN_DT                     IWR_RGTN_DT_H1
                     ,IWR.IWR_DEINS_DT                    IWR_DEINS_DT_H1
                     ,SMM.IWR_RGTN_STS_CD                 IWR_RGTN_STS_CD_H1
                     ,SMM.OWNR_ACCT_NUM                   OWNR_ACCT_NUM_M1
                     ,DAC1.DS_ACCT_NM                     DS_ACCT_NM_M1
                     ,SMM.BILL_TO_ACCT_NUM                BILL_TO_ACCT_NUM_M2
                     ,DAC2.DS_ACCT_NM                     DS_ACCT_NM_M2
                     ,BTC2.FIRST_LINE_ADDR
                         || DECODE(BTC2.SCD_LINE_ADDR,   null, '', ' ' || BTC2.SCD_LINE_ADDR)
                         || DECODE(BTC2.THIRD_LINE_ADDR, null, '', ' ' || BTC2.THIRD_LINE_ADDR)
                         || DECODE(BTC2.FRTH_LINE_ADDR,  null, '', ' ' || BTC2.FRTH_LINE_ADDR)
                         || DECODE(BTC2.CTY_ADDR,        null, '', ',' || BTC2.CTY_ADDR)
                         || DECODE(BTC2.ST_CD,           null, '', ',' || BTC2.ST_CD)
                         || DECODE(BTC2.POST_CD,         null, '', ' ' || BTC2.POST_CD)
                                                          XX_COMN_SCR_COL_VAL_TXT_M2
                     ,SMM.IND_BILL_TO_LOC_NUM             IND_BILL_TO_LOC_NUM_M2
                     ,SMM.CUR_LOC_ACCT_NUM                CUR_LOC_ACCT_NUM_M3
                     ,DAC3.DS_ACCT_NM                     DS_ACCT_NM_M3
                     ,STC.FIRST_LINE_ADDR
                         || DECODE(STC.SCD_LINE_ADDR,    null, '', ' ' || STC.SCD_LINE_ADDR)
                         || DECODE(STC.THIRD_LINE_ADDR,  null, '', ' ' || STC.THIRD_LINE_ADDR)
                         || DECODE(STC.FRTH_LINE_ADDR,   null, '', ' ' || STC.FRTH_LINE_ADDR)
                         || DECODE(STC.CTY_ADDR,         null, '', ',' || STC.CTY_ADDR)
                         || DECODE(STC.ST_CD,            null, '', ',' || STC.ST_CD)
                         || DECODE(STC.POST_CD,          null, '', ' ' || STC.POST_CD)
                                                          XX_COMN_SCR_COL_VAL_TXT_M3
                     ,SMM.IND_CUR_LOC_NUM                 IND_CUR_LOC_NUM_M3
                     ,SMM.CTRL_FLD_TXT_01                 CTRL_FLD_TXT_01
                     ,SMM.CTRL_FLD_TXT_02                 CTRL_FLD_TXT_02
                     ,SMM.CTRL_FLD_TXT_03                 CTRL_FLD_TXT_03
                     ,SMM.CTRL_FLD_TXT_04                 CTRL_FLD_TXT_04
                     ,SMM.CTRL_FLD_TXT_05                 CTRL_FLD_TXT_05
                     ,SMM.CTRL_FLD_TXT_06                 CTRL_FLD_TXT_06
                     ,SMM.PRC_CONTR_NUM                   PRC_CONTR_NUM_D
                     ,SMM.CORP_ADVTG_STS_CD               CORP_ADVTG_STS_CD_DS
<!-- START 2016/12/13 K.Ochiai [QC#16563, MOD] -->
                     ,SMM.CUST_ISS_PO_NUM                 CUST_ISS_PO_NUM_D
<!-- END 2016/12/13 K.Ochiai [QC#16563, MOD] -->
                     ,SMM.DS_PO_EXPR_DT                   DS_PO_EXPR_DT_D
                     ,SMM.HARD_DRIVE_RMV_INCL_FLG         XX_CHK_BOX_D1
                     ,SMM.HARD_DRIVE_ERASE_INCL_FLG       XX_CHK_BOX_D2
                     ,SMM.LEASE_RTRN_FEE_INCL_FLG         XX_CHK_BOX_D3
                     ,SMM.DS_KEY_ACCT_FLG                 XX_CHK_BOX_D4
                     ,SMM.FLD_SVC_BR_CD                   SVC_BR_CD_D
                     ,SMM.IWR_COND_CD                     IWR_COND_CD_DS
                     ,SMM.SVC_NTWK_CONN_STS_CD            SVC_NTWK_CONN_STS_CD_DS
                     ,SMM.SLD_BY_LINE_BIZ_TP_CD           SLD_BY_LINE_BIZ_TP_CD_DS
                     ,SMM.SVC_BY_LINE_BIZ_TP_CD           SVC_BY_LINE_BIZ_TP_CD_DS
                     ,SMM.PRF_TECH_CD                     PRF_TECH_CD_D
                     ,SMM.REQ_TECH_CD                     REQ_TECH_CD_D
                     ,SMM.SVC_LIC_CNT                     SVC_LIC_CNT_D
                     ,SMM.FIN_BR_CD                       FIN_BR_CD_D
                     ,SMM.ENET_PLOT_FLG                   XX_CHK_BOX_D5
                     ,SMM.ENET_CMNT_TXT_01                ENET_CMNT_TXT_01
                     ,SMM.ENET_CMNT_TXT_02                ENET_CMNT_TXT_02
                     ,SMM.BIZ_HRS_SUN_FROM_TM             BIZ_HRS_SUN_FROM_TM_D
                     ,SMM.BIZ_HRS_SUN_TO_TM               BIZ_HRS_SUN_TO_TM_D
                     ,SMM.BIZ_HRS_MON_FRI_FROM_TM         BIZ_HRS_MON_FRI_FROM_TM_D
                     ,SMM.BIZ_HRS_MON_FRI_TO_TM           BIZ_HRS_MON_FRI_TO_TM_D
                     ,SMM.BIZ_HRS_SAT_FROM_TM             BIZ_HRS_SAT_FROM_TM_D
                     ,SMM.BIZ_HRS_SAT_TO_TM               BIZ_HRS_SAT_TO_TM_D
<!-- START 2023/10/06 K.Ishizuka [QC#54186, ADD] -->
                     ,SMM.ISTL_BY_SVC_PRVD_PTY_CD         ISTL_BY_SVC_PRVD_PTY_CD_DS
                     ,SMM.SVC_BY_SVC_PRVD_PTY_CD          SVC_BY_SVC_PRVD_PTY_CD_DS
<!-- END 2023/10/06 K.Ishizuka [QC#54186, ADD] -->
<!-- START 2023/07/10 Y.Nagasawa [QC#61524, DEL] -->
<!--                     ,SMM.LOC_NM                          LOC_NM_F -->
<!--                     ,SMM.ADDL_LOC_NM                     ADDL_LOC_NM_F -->
<!--                     ,SMM.CTRY_CD                         CTRY_CD_FS -->
<!--                     ,SMM.FIRST_LINE_ADDR                 FIRST_LINE_ADDR_F -->
<!--                     ,SMM.SCD_LINE_ADDR                   SCD_LINE_ADDR_F -->
<!--                     ,SMM.THIRD_LINE_ADDR                 THIRD_LINE_ADDR_F -->
<!--                     ,SMM.FRTH_LINE_ADDR                  FRTH_LINE_ADDR_F -->
<!--                     ,SMM.SVC_MACH_FL_NM                  SVC_MACH_FL_NM_F -->
<!--                     ,SMM.POST_CD                         POST_CD_F -->
<!--                     ,SMM.CTY_ADDR                        CTY_ADDR_F -->
<!--                     ,SMM.ST_CD                           ST_CD_F -->
<!--                     ,SMM.CNTY_NM                         CNTY_NM_F -->
<!--                     ,SMM.PROV_NM                         PROV_NM_F -->
<!-- END 2023/07/10 Y.Nagasawa [QC#61524, DEL] -->
                     ,SMM.SVC_MACH_MAINT_AVAL_FLG         SVC_MACH_MAINT_AVAL_FLG 

<!-- START 2016/02/29 [QC#947, ADD] -->
                     ,TMS1.TECH_NM                        TECH_NM_D1
                     ,TMS2.TECH_NM                        TECH_NM_D2
<!-- END 2016/02/29 [QC#947, ADD] -->
<!-- START 2023/07/31 Y.Nagasawa [QC#61632, ADD] -->
                     ,SMM.SW_LIC_ID                       SW_LIC_ID
<!-- END 2023/07/31 Y.Nagasawa [QC#61632, ADD] -->
                 FROM
                      SVC_MACH_MSTR      SMM
                     ,SVC_CONFIG_MSTR    SCM
                     ,MDSE               MDS
                     ,SELL_TO_CUST       DAC1
                     ,SELL_TO_CUST       DAC2
                     ,SELL_TO_CUST       DAC3
                     ,BILL_TO_CUST       BTC2
                     ,SHIP_TO_CUST       STC
                     ,IWR_COND           IWC
                     ,IWR_RGTN_COND      IWR
                     ,MKT_MDL            MKM
                     ,SVC_MACH_MSTR_STS  SMS
                     ,SVC_MACH_USG_STS   SUS
                     ,STK_STS            STS
                     ,MDL_NM             MLN
                     ,SVC_MACH_TRX_TP    SMT
<!-- START 2016/02/29 [QC#947, ADD] -->
                     ,TECH_MSTR          TMS1
                     ,TECH_MSTR          TMS2
<!-- END 2016/02/29 [QC#947, ADD] -->
                 WHERE
                      SMM.GLBL_CMPY_CD           = #glblCmpyCd#
                  <isNotNull property="svcMachMstrPk">
                  AND SMM.SVC_MACH_MSTR_PK       = #svcMachMstrPk#
                  </isNotNull>
                  <isNotNull property="serNum">
                  AND SMM.SER_NUM                LIKE #serNum#
                  </isNotNull>
                  AND SMM.EZCANCELFLAG           = '0'
                  AND SMM.GLBL_CMPY_CD           = SCM.GLBL_CMPY_CD(+)
                  AND SMM.SVC_CONFIG_MSTR_PK     = SCM.SVC_CONFIG_MSTR_PK(+)
                  AND SCM.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = MDS.GLBL_CMPY_CD(+)
                  AND SMM.MDSE_CD                = MDS.MDSE_CD(+)
                  AND MDS.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = DAC1.GLBL_CMPY_CD(+)
                  AND SMM.OWNR_ACCT_NUM          = DAC1.SELL_TO_CUST_CD(+)
                  AND DAC1.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = DAC2.GLBL_CMPY_CD(+)
                  AND SMM.BILL_TO_ACCT_NUM       = DAC2.SELL_TO_CUST_CD(+)
                  AND DAC2.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = DAC3.GLBL_CMPY_CD(+)
                  AND SMM.CUR_LOC_ACCT_NUM       = DAC3.SELL_TO_CUST_CD(+)
                  AND DAC3.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = BTC2.GLBL_CMPY_CD(+)
                  AND SMM.BILL_TO_LOC_NUM        = BTC2.BILL_TO_CUST_CD(+)
                  AND BTC2.EZCANCELFLAG(+)       = '0'
                  AND SMM.GLBL_CMPY_CD           = STC.GLBL_CMPY_CD(+)
                  AND SMM.CUR_LOC_NUM            = STC.SHIP_TO_CUST_CD(+)
                  AND STC.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = IWC.GLBL_CMPY_CD(+)
                  AND SMM.IWR_COND_CD            = IWC.IWR_COND_CD(+)
                  AND IWC.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = IWR.GLBL_CMPY_CD(+)
                  AND SMM.SVC_MACH_MSTR_PK       = IWR.SVC_MACH_MSTR_PK(+)
                  AND (   IWR.IWR_RGTN_DT  IS NULL
                       OR IWR.IWR_RGTN_DT  = (SELECT
                                                  MAX(IRC.IWR_RGTN_DT)
                                              FROM
                                                  IWR_RGTN_COND IRC
                                              WHERE
                                                  IWR.GLBL_CMPY_CD          = IRC.GLBL_CMPY_CD(+)
                                                  AND IWR.SVC_MACH_MSTR_PK  = IRC.SVC_MACH_MSTR_PK(+)
                                                  AND IRC.EZCANCELFLAG(+)   = '0')
                  )
                  AND IWR.EZCANCELFLAG(+)        = '0'
                  AND MDS.GLBL_CMPY_CD           = MKM.GLBL_CMPY_CD(+)
                  AND MDS.MKT_MDL_CD             = MKM.MKT_MDL_CD(+)
                  AND MKM.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = SMS.GLBL_CMPY_CD
                  AND SMM.SVC_MACH_MSTR_STS_CD   = SMS.SVC_MACH_MSTR_STS_CD
                  AND SMS.EZCANCELFLAG           = '0'
                  AND SMM.GLBL_CMPY_CD           = SUS.GLBL_CMPY_CD
                  AND SMM.SVC_MACH_USG_STS_CD    = SUS.SVC_MACH_USG_STS_CD
                  AND SUS.EZCANCELFLAG           = '0'
                  AND SMM.GLBL_CMPY_CD           = STS.GLBL_CMPY_CD(+)
                  AND SMM.STK_STS_CD             = STS.STK_STS_CD(+)
                  AND STS.EZCANCELFLAG(+)        = '0'
                  AND SCM.GLBL_CMPY_CD           = MLN.T_GLBL_CMPY_CD(+)
                  AND SCM.MDL_ID                 = MLN.T_MDL_ID(+)
                  AND MLN.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = SMT.GLBL_CMPY_CD(+)
                  AND SMM.SVC_MACH_TRX_TP_CD     = SMT.SVC_MACH_TRX_TP_CD(+)
                  AND SMT.EZCANCELFLAG(+)        = '0'
<!-- START 2016/02/29 [QC#947, ADD] -->
                  AND SMM.GLBL_CMPY_CD           = TMS1.GLBL_CMPY_CD(+)
                  AND SMM.PRF_TECH_CD            = TMS1.TECH_TOC_CD(+)
                  AND TMS1.EZCANCELFLAG(+)       = '0'
                  AND SMM.GLBL_CMPY_CD           = TMS2.GLBL_CMPY_CD(+)
                  AND SMM.REQ_TECH_CD            = TMS2.TECH_TOC_CD(+)
                  AND TMS2.EZCANCELFLAG(+)       = '0'
<!-- END 2016/02/29 [QC#947, ADD] -->
            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getSvcMachMstr" class="NSAL0010CMsg">
        <result property="glblCmpyCd" column="GLBL_CMPY_CD"  javaType="EZDCStringItem" />
        <result property="ezUpTime_H1"            column="EZUPTIME_H1"            javaType="EZDCStringItem"/>
        <result property="ezUpTimeZone_H1"        column="EZUPTIMEZONE_H1"        javaType="EZDCStringItem"/>
        <result property="svcMachMstrPk_H1" column="SVC_MACH_MSTR_PK_H1"  javaType="EZDCBigDecimalItem" />
        <result property="svcMachTpCd_H1" column="SVC_MACH_TP_CD"  javaType="EZDCStringItem"/>
        <result property="serNum_H1" column="SER_NUM_H1"  javaType="EZDCStringItem"/>
        <result property="mdseCd_H1" column="MDSE_CD_H1"  javaType="EZDCStringItem"/>
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--    <result property="mdseNm_H1" column="MDSE_NM_H1"  javaType="EZDCStringItem"/>       -->
<!-- START 2016/10/26 K.Kojima [QC#15527, MOD] -->
<!--    <result property="mdseDescShortTxt_H1" column="MDSE_DESC_SHORT_TXTH1"  javaType="EZDCStringItem"/> -->
        <result property="mdseDescShortTxt_H1" column="MDSE_DESC_SHORT_TXT_H1"  javaType="EZDCStringItem"/>
<!-- END 2016/10/26 K.Kojima [QC#15527, MOD] -->
<!--    <result property="mktMdlNm_H1" column="MKT_MDL_NM_H1"  javaType="EZDCStringItem"/>  -->
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
        <result property="mktMdlNm_H1" column="MKT_MDL_NM_H1"  javaType="EZDCStringItem" />
        <result property="t_MdlNm_H1" column="T_MDL_NM_H1"  javaType="EZDCStringItem" />
        <result property="svcMachQty_H1" column="SVC_MACH_QTY_H1"  javaType="EZDCBigDecimalItem" />
        <result property="istlDt_H1" column="ISTL_DT_H1"  javaType="EZDCDateItem" />
        <result property="startDt_H1" column="START_DT_H1"  javaType="EZDCDateItem" />
        <result property="svcMachRmvDt_H1" column="SVC_MACH_RMV_DT_H1"  javaType="EZDCDateItem" />
        <result property="svcMachMstrStsCd_H3" column="SVC_MACH_MSTR_STS_CD_H3"  javaType="EZDCStringItem" />
        <result property="svcMachUsgStsCd_H3" column="SVC_MACH_USG_STS_CD_H3"  javaType="EZDCStringItem" />
        <result property="stkStsCd_H3" column="STK_STS_CD_H3"  javaType="EZDCStringItem" />
        <result property="prntSerNum_H1" column="PRNT_SER_NUM_H1"  javaType="EZDCStringItem" />
        <result property="custMachCtrlNum_H1" column="CUST_MACH_CTRL_NUM_H1"  javaType="EZDCStringItem" />
        <result property="svcMachTrxTpCd_H3" column="SVC_MACH_TRX_TP_CD_H3"  javaType="EZDCStringItem" />
        <result property="svcMachMstrLocStsCd_H3" column="SVC_MACH_MSTR_LOC_STS_CD_H3"  javaType="EZDCStringItem" />
        <result property="ownrAcctNum_M1" column="OWNR_ACCT_NUM_M1"  javaType="EZDCStringItem" />
        <result property="dsAcctNm_M1" column="DS_ACCT_NM_M1"  javaType="EZDCStringItem" />
        <result property="billToAcctNum_M2" column="BILL_TO_ACCT_NUM_M2"  javaType="EZDCStringItem" />
        <result property="dsAcctNm_M2" column="DS_ACCT_NM_M2"  javaType="EZDCStringItem" />
        <result property="xxComnScrColValTxt_M2" column="XX_COMN_SCR_COL_VAL_TXT_M2"  javaType="EZDCStringItem" />
        <result property="indBillToLocNum_M2" column="IND_BILL_TO_LOC_NUM_M2"  javaType="EZDCStringItem" />
        <result property="curLocAcctNum_M3" column="CUR_LOC_ACCT_NUM_M3"  javaType="EZDCStringItem" />
        <result property="dsAcctNm_M3" column="DS_ACCT_NM_M3"  javaType="EZDCStringItem" />
        <result property="xxComnScrColValTxt_M3" column="XX_COMN_SCR_COL_VAL_TXT_M3"  javaType="EZDCStringItem" />
        <result property="indCurLocNum_M3" column="IND_CUR_LOC_NUM_M3"  javaType="EZDCStringItem" />
        <result property="xxYesNoNm_H1" column="XX_YES_NO_NM_H1"  javaType="EZDCStringItem" />
        <result property="iwrEnblFlg_H1" column="IWR_ENBL_FLG_H1"  javaType="EZDCStringItem" />
        <result property="iwrCondDescTxt_H1" column="IWR_COND_DESC_TXT_H1"  javaType="EZDCStringItem" />
        <result property="lastUpdDt_H1" column="LAST_UPD_DT_H1"  javaType="EZDCStringItem" />
        <result property="iwrLastCommTs_H1" column="IWR_LAST_COMM_TS_H1"  javaType="EZDCStringItem" />
        <result property="iwrRgtnDt_H1" column="IWR_RGTN_DT_H1"  javaType="EZDCDateItem" />
        <result property="iwrDeinsDt_H1" column="IWR_DEINS_DT_H1"  javaType="EZDCDateItem" />
        <result property="iwrRgtnStsCd_H1" column="IWR_RGTN_STS_CD_H1"  javaType="EZDCDateItem" />
        <result property="ctrlFldTxt_01" column="CTRL_FLD_TXT_01"  javaType="EZDCStringItem" />
        <result property="ctrlFldTxt_02" column="CTRL_FLD_TXT_02"  javaType="EZDCStringItem" />
        <result property="ctrlFldTxt_03" column="CTRL_FLD_TXT_03"  javaType="EZDCStringItem" />
        <result property="ctrlFldTxt_04" column="CTRL_FLD_TXT_04"  javaType="EZDCStringItem" />
        <result property="ctrlFldTxt_05" column="CTRL_FLD_TXT_05"  javaType="EZDCStringItem" />
        <result property="ctrlFldTxt_06" column="CTRL_FLD_TXT_06"  javaType="EZDCStringItem" />
        <result property="prcContrNum_D" column="PRC_CONTR_NUM_D"  javaType="EZDCStringItem" />
        <result property="corpAdvtgStsCd_DS" column="CORP_ADVTG_STS_CD_DS"  javaType="EZDCStringItem" />
<!-- START 2016/12/13 K.Ochiai [QC#16563, MOD] -->
        <result property="custIssPoNum_D" column="CUST_ISS_PO_NUM_D"  javaType="EZDCStringItem" />
<!-- END 2016/12/13 K.Ochiai [QC#16563, MOD] -->
        <result property="dsPoExprDt_D" column="DS_PO_EXPR_DT_D"  javaType="EZDCDateItem" />
        <result property="xxChkBox_D1" column="XX_CHK_BOX_D1"  javaType="EZDCStringItem" />
        <result property="xxChkBox_D2" column="XX_CHK_BOX_D2"  javaType="EZDCStringItem" />
        <result property="xxChkBox_D3" column="XX_CHK_BOX_D3"  javaType="EZDCStringItem" />
        <result property="xxChkBox_D4" column="XX_CHK_BOX_D4"  javaType="EZDCStringItem" />
        <result property="svcBrCd_D" column="SVC_BR_CD_D"  javaType="EZDCStringItem" />
        <result property="iwrCondCd_DS" column="IWR_COND_CD_DS"  javaType="EZDCStringItem" />
        <result property="svcNtwkConnStsCd_DS" column="SVC_NTWK_CONN_STS_CD_DS"  javaType="EZDCStringItem" />
        <result property="sldByLineBizTpCd_DS" column="SLD_BY_LINE_BIZ_TP_CD_DS"  javaType="EZDCStringItem" />
        <result property="svcByLineBizTpCd_DS" column="SVC_BY_LINE_BIZ_TP_CD_DS"  javaType="EZDCStringItem" />
<!-- START 2023/10/06 K.Ishizuka [QC#54186, ADD] -->
        <result property="istlBySvcPrvdPtyCd_DS" column="ISTL_BY_SVC_PRVD_PTY_CD_DS"  javaType="EZDCStringItem" />
        <result property="svcBySvcPrvdPtyCd_DS" column="SVC_BY_SVC_PRVD_PTY_CD_DS"  javaType="EZDCStringItem" />
<!-- END 2023/10/06 K.Ishizuka [QC#54186, ADD] -->
        <result property="prfTechCd_D" column="PRF_TECH_CD_D"  javaType="EZDCStringItem" />
        <result property="reqTechCd_D" column="REQ_TECH_CD_D"  javaType="EZDCStringItem" />
        <result property="svcLicCnt_D" column="SVC_LIC_CNT_D"  javaType="EZDCBigDecimalItem" />
        <result property="finBrCd_D" column="FIN_BR_CD_D"  javaType="EZDCStringItem" />
        <result property="xxChkBox_D5" column="XX_CHK_BOX_D5"  javaType="EZDCStringItem" />
        <result property="enetCmntTxt_01" column="ENET_CMNT_TXT_01"  javaType="EZDCStringItem" />
        <result property="enetCmntTxt_02" column="ENET_CMNT_TXT_02"  javaType="EZDCStringItem" />
        <result property="bizHrsSunFromTm_D" column="BIZ_HRS_SUN_FROM_TM_D"  javaType="EZDCStringItem" />
        <result property="bizHrsSunToTm_D" column="BIZ_HRS_SUN_TO_TM_D"  javaType="EZDCStringItem" />
        <result property="bizHrsMonFriFromTm_D" column="BIZ_HRS_MON_FRI_FROM_TM_D"  javaType="EZDCStringItem" />
        <result property="bizHrsMonFriToTm_D" column="BIZ_HRS_MON_FRI_TO_TM_D"  javaType="EZDCStringItem" />
        <result property="bizHrsSatFromTm_D" column="BIZ_HRS_SAT_FROM_TM_D"  javaType="EZDCStringItem" />
        <result property="bizHrsSatToTm_D" column="BIZ_HRS_SAT_TO_TM_D"  javaType="EZDCStringItem" />
<!-- START 2023/07/10 Y.Nagasawa [QC#61524, DEL] -->
<!--        <result property="locNm_F" column="LOC_NM_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="addlLocNm_F" column="ADDL_LOC_NM_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="ctryCd_FS" column="CTRY_CD_FS"  javaType="EZDCStringItem" /> -->
<!--        <result property="firstLineAddr_F" column="FIRST_LINE_ADDR_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="scdLineAddr_F" column="SCD_LINE_ADDR_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="thirdLineAddr_F" column="THIRD_LINE_ADDR_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="frthLineAddr_F" column="FRTH_LINE_ADDR_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="svcMachFlNm_F" column="SVC_MACH_FL_NM_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="postCd_F" column="POST_CD_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="ctyAddr_F" column="CTY_ADDR_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="stCd_F" column="ST_CD_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="cntyNm_F" column="CNTY_NM_F"  javaType="EZDCStringItem" /> -->
<!--        <result property="provNm_F" column="PROV_NM_F"  javaType="EZDCStringItem" /> -->
<!-- END 2023/07/10 Y.Nagasawa [QC#61524, DEL] -->
        <result property="svcMachMaintAvalFlg" column="SVC_MACH_MAINT_AVAL_FLG"  javaType="EZDCStringItem" />
<!-- START 2016/02/29 [QC#947, ADD] -->
        <result property="techNm_D1" column="TECH_NM_D1"  javaType="EZDSStringItem" />
        <result property="techNm_D2" column="TECH_NM_D2"  javaType="EZDSStringItem" />
<!-- END 2016/02/29 [QC#947, ADD] -->
<!-- START 2023/07/31 Y.Nagasawa [QC#61632, ADD] -->
        <result property="swLicId_H1" column="SW_LIC_ID"  javaType="EZDSStringItem" />
<!-- END 2023/07/31 Y.Nagasawa [QC#61632, ADD] -->
    </resultMap>
<!-- END 2016/05/16 T.Tomita [QC#4578, MOD] -->

    <statement id="getSvcNonPrfTech" parameterClass="Map" resultMap="result.getSvcNonPrfTech">
            SELECT
                 SVC_NON_PRF_TECH_PK_E
                ,EZUPTIME_E
                ,EZUPTIMEZONE_E
                ,NON_PRF_TECH_CD_E
                ,TECH_NM_E
                ,EFF_THRU_DT_E
            FROM (
                SELECT
                     SNP.SVC_NON_PRF_TECH_PK             SVC_NON_PRF_TECH_PK_E
                    ,SNP.EZUPTIME                        EZUPTIME_E
                    ,SNP.EZUPTIMEZONE                    EZUPTIMEZONE_E
                    ,SNP.NON_PRF_TECH_CD                 NON_PRF_TECH_CD_E
                    ,TMS.TECH_NM                         TECH_NM_E
                    ,SNP.EFF_THRU_DT                     EFF_THRU_DT_E
                FROM
                     SVC_NON_PRF_TECH   SNP
                    ,TECH_MSTR          TMS
                WHERE
                     SNP.GLBL_CMPY_CD           = #glblCmpyCd#
                 <isNotNull property="svcMachMstrPk">
                 AND SNP.SVC_MACH_MSTR_PK       = #svcMachMstrPk#
                 </isNotNull>
                 AND SNP.EZCANCELFLAG           = '0'
                 AND SNP.GLBL_CMPY_CD           = TMS.GLBL_CMPY_CD
                 AND SNP.NON_PRF_TECH_CD        = TMS.TECH_TOC_CD
                 AND TMS.EZCANCELFLAG        = '0'
            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getSvcNonPrfTech" class="NSAL0010_ESMsg">
        <result property="svcNonPrfTechPk_E" column="SVC_NON_PRF_TECH_PK_E"  javaType="EZDSBigDecimalItem" />
        <result property="svcNonPrfTechPk_E" column="SVC_NON_PRF_TECH_PK_E"  javaType="EZDSBigDecimalItem" />
        <result property="nonPrfTechCd_E" column="NON_PRF_TECH_CD_E"  javaType="EZDSStringItem" />
        <result property="techNm_E" column="TECH_NM_E"  javaType="EZDSStringItem" />
        <result property="effThruDt_E" column="EFF_THRU_DT_E"  javaType="EZDSDateItem" />
        <result property="ezUpTime_E" column="EZUPTIME_E"  javaType="EZDSStringItem" />
        <result property="ezUpTimeZone_E" column="EZUPTIMEZONE_E"  javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getMachConfig" parameterClass="Map" resultMap="result.getSvcConfig">
            SELECT
                 SVC_CONFIG_MSTR_PK_A
                ,EZUPTIME_A
                ,EZUPTIMEZONE_A
                ,SVC_MACH_TP_CD
                ,MDSE_CD_A
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--            ,MDSE_NM_A      -->
                ,MDSE_DESC_SHORT_TXT_A
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
                ,MKT_MDL_NM_A
                ,SER_NUM_A
                ,ISTL_DT_A
                ,SVC_MACH_MSTR_STS_DESC_TXT_A
                ,SVC_MACH_MSTR_PK_A1
                ,SVC_MACH_MSTR_PK_A2
                ,RDD_DT_A
            FROM (
                 SELECT
                      SCM.SVC_CONFIG_MSTR_PK              SVC_CONFIG_MSTR_PK_A
                     ,SCM.EZUPTIME                        EZUPTIME_A
                     ,SCM.EZUPTIMEZONE                    EZUPTIMEZONE_A
                     ,SMM.SVC_MACH_TP_CD                  SVC_MACH_TP_CD
                     ,SMM.MDSE_CD                         MDSE_CD_A
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--                 ,MDS.MDSE_NM                         MDSE_NM_A     -->
                     ,MDS.MDSE_DESC_SHORT_TXT             MDSE_DESC_SHORT_TXT_A
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
                     ,MKM.MKT_MDL_NM                      MKT_MDL_NM_A
                     ,SMM.SER_NUM                         SER_NUM_A
                     ,SMM.ISTL_DT                         ISTL_DT_A
                     ,SMS.SVC_MACH_MSTR_STS_DESC_TXT      SVC_MACH_MSTR_STS_DESC_TXT_A
                     ,SMM.SVC_MACH_MSTR_PK                SVC_MACH_MSTR_PK_A1
<!-- START 2017/01/17 N.Arai [QC#14614, MOD] -->
<!--                 ,#svcMachMstrPk#                     SVC_MACH_MSTR_PK_A2   -->
                     ,SCM.SVC_MACH_MSTR_PK                SVC_MACH_MSTR_PK_A2
<!-- END 2017/01/17 N.Arai [QC#14614, MOD] -->
                     ,CPD.RDD_DT                          RDD_DT_A
                 FROM
                      SVC_MACH_MSTR      SMM1
                     ,SVC_CONFIG_MSTR    SCM
                     ,SVC_MACH_MSTR      SMM
                     ,MDSE               MDS
                     ,MKT_MDL            MKM
                     ,CPO_DTL            CPD
                     ,SVC_MACH_MSTR_STS  SMS
                 WHERE
                      SMM1.GLBL_CMPY_CD          = #glblCmpyCd#
                  <isNotNull property="svcMachMstrPk">
                  AND SMM1.SVC_MACH_MSTR_PK      = #svcMachMstrPk#
                  </isNotNull>
                  AND SMM1.EZCANCELFLAG          = '0'
                  AND SMM1.GLBL_CMPY_CD          = SCM.GLBL_CMPY_CD
                  AND SMM1.SVC_CONFIG_MSTR_PK    = SCM.SVC_CONFIG_MSTR_PK
                  AND SCM.EZCANCELFLAG           = '0'
                  AND SCM.GLBL_CMPY_CD           = SMM.GLBL_CMPY_CD
                  AND SCM.SVC_CONFIG_MSTR_PK     = SMM.SVC_CONFIG_MSTR_PK
                  AND SMM.EZCANCELFLAG           = '0'
                  AND SMM.GLBL_CMPY_CD           = MDS.GLBL_CMPY_CD
                  AND SMM.MDSE_CD                = MDS.MDSE_CD
                  AND MDS.EZCANCELFLAG           = '0'
                  AND MDS.GLBL_CMPY_CD           = MKM.GLBL_CMPY_CD(+)
                  AND MDS.MKT_MDL_CD             = MKM.MKT_MDL_CD(+)
                  AND MKM.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = CPD.GLBL_CMPY_CD(+)
                  AND SMM.CPO_ORD_NUM            = CPD.CPO_ORD_NUM(+)
                  AND SMM.CPO_DTL_LINE_NUM       = CPD.CPO_DTL_LINE_NUM(+)
                  AND SMM.CPO_DTL_LINE_SUB_NUM   = CPD.CPO_DTL_LINE_SUB_NUM(+)
                  AND CPD.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = SMS.GLBL_CMPY_CD
                  AND SMM.SVC_MACH_MSTR_STS_CD   = SMS.SVC_MACH_MSTR_STS_CD
                  AND SMS.EZCANCELFLAG        = '0'
                 ORDER BY
                      SMM.SVC_MACH_TP_CD
                     ,SMM.SVC_MACH_SQ_NUM
            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getSvcConfig" class="NSAL0010_ASMsg">
        <result property="svcConfigMstrPk_A" column="SVC_CONFIG_MSTR_PK_A"  javaType="EZDSBigDecimalItem" />
        <result property="svcMachTpCd_A" column="SVC_MACH_TP_CD"  javaType="EZDCStringItem" />
        <result property="mdseCd_A" column="MDSE_CD_A"  javaType="EZDSStringItem" />
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--    <result property="mdseNm_A" column="MDSE_NM_A"  javaType="EZDSStringItem" />        -->
        <result property="mdseDescShortTxt_A" column="MDSE_DESC_SHORT_TXT_A"  javaType="EZDSStringItem" />
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
        <result property="mktMdlNm_A" column="MKT_MDL_NM_A"  javaType="EZDSStringItem" />
        <result property="serNum_A" column="SER_NUM_A"  javaType="EZDSStringItem" />
        <result property="istlDt_A" column="ISTL_DT_A"  javaType="EZDSDateItem" />
        <result property="svcMachMstrStsDescTxt_A" column="SVC_MACH_MSTR_STS_DESC_TXT_A"  javaType="EZDSStringItem" />
        <result property="svcMachMstrPk_A1" column="SVC_MACH_MSTR_PK_A1"  javaType="EZDSBigDecimalItem" />
        <result property="svcMachMstrPk_A2" column="SVC_MACH_MSTR_PK_A2"  javaType="EZDSBigDecimalItem" />
        <result property="rddDt_A" column="RDD_DT_A"  javaType="EZDSDateItem" />
        <result property="ezUpTime_A" column="EZUPTIME_A"  javaType="EZDSStringItem" />
        <result property="ezUpTimeZone_A" column="EZUPTIMEZONE_A"  javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getSvcMachCtacPsn" parameterClass="Map" resultMap="result.getSvcMachCtacPsn">
<!-- QC#8598 Add DISTINCT Statement. Add ORDER BY Satement With Last Row -->
            SELECT DISTINCT
                 SVC_MACH_CTAC_PSN_PK
                ,EZUPTIME_C
                ,EZUPTIMEZONE_C
                ,CTAC_PSN_LAST_NM_C
                ,CTAC_PSN_FIRST_NM_C
                ,DS_CTAC_PNT_TP_CD_CS
                ,DS_CTAC_PNT_TP_NM
                ,DS_CTAC_PNT_VAL_TXT_C
                ,DS_CTAC_PSN_EXTN_NUM_C
                ,SVC_CTAC_TP_DESC_TXT
                ,SVC_CTAC_TP_CD_CS
                ,CTAC_PSN_PK_C
                ,XX_CHK_BOX_C
                ,DS_CTAC_PNT_PK_C
                ,EFF_FROM_DT_C
                ,EFF_THRU_DT_C
                ,CTAC_PSN_NUM_C
            FROM (
                 SELECT
                      SMC.SVC_MACH_CTAC_PSN_PK            SVC_MACH_CTAC_PSN_PK
                     ,SMC.EZUPTIME                        EZUPTIME_C
                     ,SMC.EZUPTIMEZONE                    EZUPTIMEZONE_C
<!-- START 2016/05/12 M.Gotou [QC#8013, MOD] -->
                     ,CPN.CTAC_PSN_LAST_NM                CTAC_PSN_LAST_NM_C
                     ,CPN.CTAC_PSN_FIRST_NM               CTAC_PSN_FIRST_NM_C
<!-- END 2016/05/12 M.Gotou [QC#8013, MOD] -->
                     ,DPT.DS_CTAC_PNT_TP_CD               DS_CTAC_PNT_TP_CD_CS
                     ,DPT.DS_CTAC_PNT_TP_NM               DS_CTAC_PNT_TP_NM
                     ,DCP.DS_CTAC_PNT_VAL_TXT             DS_CTAC_PNT_VAL_TXT_C
                     ,DCP.DS_CTAC_PSN_EXTN_NUM            DS_CTAC_PSN_EXTN_NUM_C
                     ,SCT.SVC_CTAC_TP_DESC_TXT            SVC_CTAC_TP_DESC_TXT
                     ,SMC.SVC_CTAC_TP_CD                  SVC_CTAC_TP_CD_CS
                     ,CPN.CTAC_PSN_PK                     CTAC_PSN_PK_C
<!-- START 2016/10/27 [QC#15607, MOD] -->
<!-- mod start 2018/08/29 QC#27788 -->
<!--                 ,DPR.DS_PRIM_LOC_FLG                 XX_CHK_BOX_C -->
<!-- mod start 2018/09/27 QC#27788 -->
<!--                 ,'N'                                 XX_CHK_BOX_C -->
                     ,SMC.DS_PRIM_LOC_FLG                 XX_CHK_BOX_C
<!-- mod end 2018/09/27 QC#27788 -->
<!-- mod end 2018/08/29 QC#27788 -->
<!-- END 2016/10/27 [QC#15607, MOD] -->
                     ,DCP.DS_CTAC_PNT_PK                  DS_CTAC_PNT_PK_C
                     ,SMC.EFF_FROM_DT                     EFF_FROM_DT_C
                     ,SMC.EFF_THRU_DT                     EFF_THRU_DT_C
                     ,CPN.CTAC_PSN_NUM                    CTAC_PSN_NUM_C
                 FROM
                      SVC_MACH_CTAC_PSN  SMC
                     ,DS_CTAC_PNT        DCP
                     ,CTAC_PSN           CPN
                     ,DS_CTAC_PNT_TP     DPT
<!-- START 2016/10/27 [QC#15607, ADD] -->
<!-- del start 2018/08/29 QC#27788 -->
<!--                 ,DS_CTAC_PSN_RELN   DPR -->
<!-- del end 2018/08/29 QC#27788 -->
<!-- END 2016/10/27 [QC#15607, ADD] -->
                     ,SVC_CTAC_TP        SCT
                 WHERE
                      SMC.GLBL_CMPY_CD           = #glblCmpyCd#
                  AND SMC.SVC_MACH_MSTR_PK       = #svcMachMstrPk#
<!-- START 2016/03/24 M.Gotou [QC#4951, DEL] -->
<!--              AND NVL(SMC.EFF_FROM_DT, #minDt#) &lt;= #slsDt# -->
<!--              AND NVL(SMC.EFF_THRU_DT, #maxDt#) &gt;= #slsDt# -->
<!-- END 2016/03/24 M.Gotou [QC#4951, DEL] -->
                  AND SMC.EZCANCELFLAG           = '0'
                  AND SMC.GLBL_CMPY_CD           = DCP.GLBL_CMPY_CD(+)
                  AND SMC.DS_CTAC_PNT_PK         = DCP.DS_CTAC_PNT_PK(+)
                  AND DCP.EZCANCELFLAG(+)        = '0'
                  AND DCP.GLBL_CMPY_CD           = CPN.GLBL_CMPY_CD(+)
                  AND DCP.CTAC_PSN_PK            = CPN.CTAC_PSN_PK(+)
                  AND CPN.EZCANCELFLAG(+)        = '0'
                  AND DCP.GLBL_CMPY_CD           = DPT.GLBL_CMPY_CD(+)
                  AND DCP.DS_CTAC_PNT_TP_CD      = DPT.DS_CTAC_PNT_TP_CD(+)
                  AND DPT.EZCANCELFLAG(+)        = '0'
<!-- START 2016/10/27 [QC#15607, ADD] -->
<!-- del start 2018/08/29 QC#27788 -->
<!--              AND DCP.GLBL_CMPY_CD           = DPR.GLBL_CMPY_CD(+)
                  AND DCP.CTAC_PSN_PK            = DPR.CTAC_PSN_PK(+)
                  AND DPR.EZCANCELFLAG(+)        = '0' -->
<!-- del end 2018/08/29 QC#27788 -->
<!-- END 2016/10/27 [QC#15607, ADD] -->
                  AND SMC.GLBL_CMPY_CD           = SCT.GLBL_CMPY_CD
                  AND SMC.SVC_CTAC_TP_CD         = SCT.SVC_CTAC_TP_CD
                  AND SCT.EZCANCELFLAG           = '0'
                 ORDER BY
                      CPN.CTAC_PSN_LAST_NM
                     ,CPN.CTAC_PSN_FIRST_NM
                     ,DCP.DS_CTAC_PNT_TP_CD
            ) WHERE
                ROWNUM        &lt;= #rowNum#
            ORDER BY
                CTAC_PSN_LAST_NM_C
               ,CTAC_PSN_FIRST_NM_C
               ,DS_CTAC_PNT_TP_CD_CS
    </statement>
    <resultMap id="result.getSvcMachCtacPsn" class="NSAL0010_CSMsg">
        <result property="svcMachCtacPsnPk_C" column="SVC_MACH_CTAC_PSN_PK"  javaType="EZDSBigDecimalItem" />
        <result property="ctacPsnLastNm_C" column="CTAC_PSN_LAST_NM_C"  javaType="EZDSStringItem" />
        <result property="ctacPsnFirstNm_C" column="CTAC_PSN_FIRST_NM_C"  javaType="EZDSStringItem" />
        <result property="dsCtacPntTpCd_CS" column="DS_CTAC_PNT_TP_CD_CS"  javaType="EZDSStringItem" />
        <result property="dsCtacPntValTxt_C" column="DS_CTAC_PNT_VAL_TXT_C"  javaType="EZDSStringItem" />
        <result property="dsCtacPsnExtnNum_C" column="DS_CTAC_PSN_EXTN_NUM_C"  javaType="EZDSStringItem" />
        <result property="svcCtacTpCd_CS" column="SVC_CTAC_TP_CD_CS"  javaType="EZDSStringItem" />
        <result property="ctacPsnPk_C" column="CTAC_PSN_PK_C"  javaType="EZDSBigDecimalItem" />
        <result property="ctacPsnNum_C" column="CTAC_PSN_NUM_C"  javaType="EZDSStringItem" />
        <result property="xxChkBox_C" column="XX_CHK_BOX_C"  javaType="EZDSStringItem" />
        <result property="dsCtacPntPk_C" column="DS_CTAC_PNT_PK_C"  javaType="EZDSBigDecimalItem" />
        <result property="effFromDt_C" column="EFF_FROM_DT_C"  javaType="EZDSDateItem" />
        <result property="effThruDt_C" column="EFF_THRU_DT_C"  javaType="EZDSDateItem" />
        <result property="ezUpTime_C" column="EZUPTIME_C"  javaType="EZDSStringItem" />
        <result property="ezUpTimeZone_C" column="EZUPTIMEZONE_C"  javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getSvcMachCtacPsnIncTerm" parameterClass="Map" resultMap="result.getSvcMachCtacPsnIncTerm">
<!-- QC#8598 Add DISTINCT Statement. Add ORDER BY Satement With Last Row -->
            SELECT DISTINCT
                 SVC_MACH_CTAC_PSN_PK
                ,EZUPTIME_C
                ,EZUPTIMEZONE_C
                ,CTAC_PSN_LAST_NM_C
                ,CTAC_PSN_FIRST_NM_C
                ,DS_CTAC_PNT_TP_CD_CS
                ,DS_CTAC_PNT_TP_NM
                ,DS_CTAC_PNT_VAL_TXT_C
                ,DS_CTAC_PSN_EXTN_NUM_C
                ,SVC_CTAC_TP_DESC_TXT
                ,SVC_CTAC_TP_CD_CS
                ,CTAC_PSN_PK_C
                ,XX_CHK_BOX_C
                ,DS_CTAC_PNT_PK_C
                ,EFF_FROM_DT_C
                ,EFF_THRU_DT_C
                ,CTAC_PSN_NUM_C
            FROM (
                 SELECT
                      SMC.SVC_MACH_CTAC_PSN_PK            SVC_MACH_CTAC_PSN_PK
                     ,SMC.EZUPTIME                        EZUPTIME_C
                     ,SMC.EZUPTIMEZONE                    EZUPTIMEZONE_C
<!-- START 2016/05/12 M.Gotou [QC#8013, MOD] -->
                     ,CPN.CTAC_PSN_LAST_NM                CTAC_PSN_LAST_NM_C
                     ,CPN.CTAC_PSN_FIRST_NM               CTAC_PSN_FIRST_NM_C
<!-- END 2016/05/12 M.Gotou [QC#8013, MOD] -->
                     ,DPT.DS_CTAC_PNT_TP_CD               DS_CTAC_PNT_TP_CD_CS
                     ,DPT.DS_CTAC_PNT_TP_NM               DS_CTAC_PNT_TP_NM
                     ,DCP.DS_CTAC_PNT_VAL_TXT             DS_CTAC_PNT_VAL_TXT_C
                     ,DCP.DS_CTAC_PSN_EXTN_NUM            DS_CTAC_PSN_EXTN_NUM_C
                     ,SCT.SVC_CTAC_TP_DESC_TXT            SVC_CTAC_TP_DESC_TXT
                     ,SMC.SVC_CTAC_TP_CD                  SVC_CTAC_TP_CD_CS
                     ,CPN.CTAC_PSN_PK                     CTAC_PSN_PK_C
<!-- START 2016/10/27 [QC#15607, MOD] -->
<!-- mod start 2018/08/29 QC#27788 -->
<!--                 ,DPR.DS_PRIM_LOC_FLG                 XX_CHK_BOX_C -->
<!-- mod start 2018/09/27 QC#27788 -->
<!--                 ,'N'                                 XX_CHK_BOX_C -->
                     ,SMC.DS_PRIM_LOC_FLG                 XX_CHK_BOX_C
<!-- mod end   2018/09/27 QC#27788 -->
<!-- mod end 2018/08/29 QC#27788 -->
<!-- END 2016/10/27 [QC#15607, MOD] -->
                     ,DCP.DS_CTAC_PNT_PK                  DS_CTAC_PNT_PK_C
                     ,SMC.EFF_FROM_DT                     EFF_FROM_DT_C
                     ,SMC.EFF_THRU_DT                     EFF_THRU_DT_C
                     ,CPN.CTAC_PSN_NUM                    CTAC_PSN_NUM_C
                 FROM
                      SVC_MACH_CTAC_PSN  SMC
                     ,DS_CTAC_PNT        DCP
                     ,CTAC_PSN           CPN
                     ,DS_CTAC_PNT_TP     DPT
<!-- START 2016/10/27 [QC#15607, ADD] -->
<!-- del start 2018/08/29 QC#27788 -->
<!--                 ,DS_CTAC_PSN_RELN   DPR -->
<!-- del end 2018/08/29 QC#27788 -->
<!-- END 2016/10/27 [QC#15607, ADD] -->
                     ,SVC_CTAC_TP        SCT
                 WHERE
                      SMC.GLBL_CMPY_CD           = #glblCmpyCd#
                  AND SMC.SVC_MACH_MSTR_PK       = #svcMachMstrPk#
                  AND NVL(SMC.EFF_FROM_DT, #minDt#) &lt;= #slsDt#
                  AND SMC.EZCANCELFLAG           = '0'
                  AND SMC.GLBL_CMPY_CD           = DCP.GLBL_CMPY_CD
                  AND SMC.DS_CTAC_PNT_PK         = DCP.DS_CTAC_PNT_PK
                  AND DCP.EZCANCELFLAG           = '0'
                  AND DCP.GLBL_CMPY_CD           = CPN.GLBL_CMPY_CD
                  AND DCP.CTAC_PSN_PK            = CPN.CTAC_PSN_PK
                  AND CPN.EZCANCELFLAG           = '0'
                  AND DCP.GLBL_CMPY_CD           = DPT.GLBL_CMPY_CD(+)
                  AND DCP.DS_CTAC_PNT_TP_CD      = DPT.DS_CTAC_PNT_TP_CD(+)
                  AND DPT.EZCANCELFLAG(+)        = '0'
<!-- START 2016/10/27 [QC#15607, ADD] -->
<!-- del start 2018/08/29 QC#27788 -->
<!--              AND DCP.GLBL_CMPY_CD           = DPR.GLBL_CMPY_CD(+)
                  AND DCP.CTAC_PSN_PK            = DPR.CTAC_PSN_PK(+)
                  AND DPR.EZCANCELFLAG(+)        = '0' -->
<!-- del end 2018/08/29 QC#27788 -->
<!-- END 2016/10/27 [QC#15607, ADD] -->
                  AND SMC.GLBL_CMPY_CD           = SCT.GLBL_CMPY_CD
                  AND SMC.SVC_CTAC_TP_CD         = SCT.SVC_CTAC_TP_CD
                  AND SCT.EZCANCELFLAG           = '0'
                 ORDER BY
                      CPN.CTAC_PSN_LAST_NM
                     ,CPN.CTAC_PSN_FIRST_NM
                     ,DCP.DS_CTAC_PNT_TP_CD
            ) WHERE
                ROWNUM        &lt;= #rowNum#
            ORDER BY
                CTAC_PSN_LAST_NM_C
               ,CTAC_PSN_FIRST_NM_C
               ,DS_CTAC_PNT_TP_CD_CS
    </statement>
    <resultMap id="result.getSvcMachCtacPsnIncTerm" class="NSAL0010_CSMsg">
        <result property="svcMachCtacPsnPk_C" column="SVC_MACH_CTAC_PSN_PK"  javaType="EZDSBigDecimalItem" />
        <result property="ctacPsnLastNm_C" column="CTAC_PSN_LAST_NM_C"  javaType="EZDSStringItem" />
        <result property="ctacPsnFirstNm_C" column="CTAC_PSN_FIRST_NM_C"  javaType="EZDSStringItem" />
        <result property="dsCtacPntTpCd_CS" column="DS_CTAC_PNT_TP_CD_CS"  javaType="EZDSStringItem" />
        <result property="dsCtacPntValTxt_C" column="DS_CTAC_PNT_VAL_TXT_C"  javaType="EZDSStringItem" />
        <result property="dsCtacPsnExtnNum_C" column="DS_CTAC_PSN_EXTN_NUM_C"  javaType="EZDSStringItem" />
        <result property="svcCtacTpCd_CS" column="SVC_CTAC_TP_CD_CS"  javaType="EZDSStringItem" />
        <result property="ctacPsnPk_C" column="CTAC_PSN_PK_C"  javaType="EZDSBigDecimalItem" />
        <result property="ctacPsnNum_C" column="CTAC_PSN_NUM_C"  javaType="EZDSStringItem" />
        <result property="xxChkBox_C" column="XX_CHK_BOX_C"  javaType="EZDSStringItem" />
        <result property="dsCtacPntPk_C" column="DS_CTAC_PNT_PK_C"  javaType="EZDSBigDecimalItem" />
        <result property="effFromDt_C" column="EFF_FROM_DT_C"  javaType="EZDSDateItem" />
        <result property="effThruDt_C" column="EFF_THRU_DT_C"  javaType="EZDSDateItem" />
        <result property="ezUpTime_C" column="EZUPTIME_C"  javaType="EZDSStringItem" />
        <result property="ezUpTimeZone_C" column="EZUPTIMEZONE_C"  javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getSlsHistory" parameterClass="Map" resultMap="result.getSlsHistory">
            SELECT
                 CPO_ORD_NUM
                ,CPO_ORD_TS
                ,DS_ORD_CATG_CD
                ,DS_ORD_CATG_DESC_TXT
                ,DS_ORD_TP_CD
                ,DS_ORD_TP_DESC_TXT
                ,DS_ORD_LINE_CATG_CD
                ,DS_ORD_LINE_CATG_DESC_TXT
                ,SELL_TO_CUST_CD
                ,SELL_TO_LOC_NM
                ,BILL_TO_CUST_CD
                ,BILL_TO_LOC_NM
                ,SHIP_TO_CUST_CD
                ,SHIP_TO_LOC_NM
                ,SHIP_TO_ADDR
                ,P_BILL_TO_CUST_CD
                ,P_SHIP_TO_CUST_CD
<!-- START 2017/02/06 N.Arai [QC#17197, MOD] -->
                ,CASE WHEN LENGTH(CPO_ORD_TS) > 8 THEN SUBSTR(CPO_ORD_TS,0,8)
                      ELSE CPO_ORD_TS END CPO_ORD_DT
<!-- END 2017/02/06 N.Arai [QC#17197, MOD] -->
            FROM (
                 SELECT
                      D.CPO_ORD_NUM
                     ,D.CPO_ORD_TS
                     ,D.DS_ORD_CATG_CD
                     ,F.DS_ORD_CATG_DESC_TXT
                     ,D.DS_ORD_TP_CD
                     ,G.DS_ORD_TP_DESC_TXT
                     ,B.DS_ORD_LINE_CATG_CD
                     ,H.DS_ORD_LINE_CATG_DESC_TXT
                     ,D.SELL_TO_CUST_CD
                     ,I.LOC_NM               AS SELL_TO_LOC_NM
                     ,D.BILL_TO_CUST_CD
                     ,J.LOC_NM AS BILL_TO_LOC_NM
                     ,B.SHIP_TO_CUST_CD
                     ,CASE
                         WHEN B.SHIP_TO_LOC_NM IS NOT NULL
                         THEN
                             B.SHIP_TO_LOC_NM
                         ELSE
                             L.LOC_NM
                      END AS SHIP_TO_LOC_NM
                     ,TRIM(B.SHIP_TO_FIRST_LINE_ADDR 
                         || ' ' || B.SHIP_TO_SCD_LINE_ADDR
                         || ' ' || B.SHIP_TO_THIRD_LINE_ADDR
                         || ' ' || B.SHIP_TO_FRTH_LINE_ADDR
                         || ' ' || B.SHIP_TO_CTY_ADDR
                         || ' ' || B.SHIP_TO_ST_CD
                         || ' ' || B.SHIP_TO_POST_CD) AS SHIP_TO_ADDR
                     ,CASE
                         WHEN
                             K.BILL_TO_CUST_LOC_CD IS NULL
                         THEN
                             D.BILL_TO_CUST_CD
                         ELSE
                             K.BILL_TO_CUST_LOC_CD
                      END AS P_BILL_TO_CUST_CD
                     ,CASE
                         WHEN
                             K.SHIP_TO_CUST_LOC_CD IS NULL
                         THEN
                             D.ADD_SHIP_TO_CUST_CD
                         ELSE
                             K.SHIP_TO_CUST_LOC_CD
                      END AS P_SHIP_TO_CUST_CD
                 FROM
                     <!-- START 2019/03/14 [QC#30748, DEL] -->
                     <!-- SVC_MACH_MSTR A -->
                     <!-- END 2019/03/14 [QC#30748, DEL] -->
                     CPO_DTL B
                     ,CPO D
                     ,DS_ORD_CATG F
                     ,DS_ORD_TP G
                     ,DS_ORD_LINE_CATG H
                     ,BILL_TO_CUST I
                     ,BILL_TO_CUST J
                     ,DS_CPO_CONFIG K
                     ,SHIP_TO_CUST L
                 WHERE
                     <!-- START 2019/03/14 [QC#30748, DEL] -->
                     <!--     A.GLBL_CMPY_CD          = #glblCmpyCd#           -->
                     <!-- AND A.SVC_MACH_MSTR_PK      = #svcMachMstrPk#        -->
                     <!-- AND A.GLBL_CMPY_CD          = B.GLBL_CMPY_CD         -->
                     <!-- AND A.CPO_ORD_NUM           = B.CPO_ORD_NUM          -->
                     <!-- AND A.CPO_DTL_LINE_NUM      = B.CPO_DTL_LINE_NUM     -->
                     <!-- AND A.CPO_DTL_LINE_SUB_NUM  = B.CPO_DTL_LINE_SUB_NUM -->
                     <!-- END 2019/03/14 [QC#30748, DEL] -->
                         B.GLBL_CMPY_CD          = #glblCmpyCd#
                     AND B.GLBL_CMPY_CD          = D.GLBL_CMPY_CD
                     AND B.CPO_ORD_NUM           = D.CPO_ORD_NUM
                     AND D.GLBL_CMPY_CD          = F.GLBL_CMPY_CD(+)
                     AND D.DS_ORD_CATG_CD        = F.DS_ORD_CATG_CD(+)
                     AND D.GLBL_CMPY_CD          = G.GLBL_CMPY_CD
                     AND D.DS_ORD_TP_CD          = G.DS_ORD_TP_CD
                     AND B.GLBL_CMPY_CD          = H.GLBL_CMPY_CD(+)
                     AND B.DS_ORD_LINE_CATG_CD   = H.DS_ORD_LINE_CATG_CD(+)
                     AND D.GLBL_CMPY_CD          = I.GLBL_CMPY_CD
                     AND D.SOLD_TO_CUST_LOC_CD   = I.BILL_TO_CUST_CD
                     AND D.GLBL_CMPY_CD          = J.GLBL_CMPY_CD
                     AND D.BILL_TO_CUST_CD       = J.BILL_TO_CUST_CD
                     AND B.GLBL_CMPY_CD          = K.GLBL_CMPY_CD(+)
                     AND B.DS_CPO_CONFIG_PK      = K.DS_CPO_CONFIG_PK(+)
                     AND B.GLBL_CMPY_CD          = L.GLBL_CMPY_CD
                     AND B.SHIP_TO_CUST_CD       = L.SHIP_TO_CUST_CD
                     <!-- START 2019/03/14 [QC#30748, MOD] -->
                     AND EXISTS (
                         SELECT
                              1
                         FROM
                              SVC_MACH_MSTR_HIST A
                         WHERE
                                 A.GLBL_CMPY_CD         = #glblCmpyCd#
                             AND A.EZCANCELFLAG         = '0'
                             AND A.SVC_MACH_MSTR_PK     = #svcMachMstrPk#
                             AND A.CPO_ORD_NUM          = B.CPO_ORD_NUM
                             AND A.CPO_DTL_LINE_NUM     = B.CPO_DTL_LINE_NUM
                             AND A.CPO_DTL_LINE_SUB_NUM = B.CPO_DTL_LINE_SUB_NUM
                     )
                     <!-- AND A.EZCANCELFLAG          = '0' -->
                     <!-- END 2019/03/14 [QC#30748, MOD] -->
                     AND B.EZCANCELFLAG          = '0'
                     AND D.EZCANCELFLAG          = '0'
                     AND F.EZCANCELFLAG(+)       = '0'
                     AND G.EZCANCELFLAG          = '0'
                     AND H.EZCANCELFLAG(+)       = '0'
                     AND I.EZCANCELFLAG          = '0'
                     AND J.EZCANCELFLAG          = '0'
                     AND K.EZCANCELFLAG(+)       = '0'
                     AND L.EZCANCELFLAG          = '0'
                 UNION ALL
                 SELECT
                      D.CPO_ORD_NUM
                     ,D.CPO_ORD_TS
                     ,D.DS_ORD_CATG_CD
                     ,F.DS_ORD_CATG_DESC_TXT
                     ,D.DS_ORD_TP_CD
                     ,G.DS_ORD_TP_DESC_TXT
                     ,B.DS_ORD_LINE_CATG_CD
                     ,H.DS_ORD_LINE_CATG_DESC_TXT
                     ,D.SELL_TO_CUST_CD
                     ,I.LOC_NM               AS SELL_TO_LOC_NM
                     ,D.BILL_TO_CUST_CD
                     ,J.LOC_NM AS BILL_TO_LOC_NM
                     ,B.SHIP_TO_CUST_CD
                     ,CASE
                         WHEN B.SHIP_TO_LOC_NM IS NOT NULL
                         THEN
                             B.SHIP_TO_LOC_NM
                         ELSE
                             L.LOC_NM
                      END AS SHIP_TO_LOC_NM
                     ,TRIM(B.SHIP_TO_FIRST_LINE_ADDR 
                         || ' ' || B.SHIP_TO_SCD_LINE_ADDR
                         || ' ' || B.SHIP_TO_THIRD_LINE_ADDR
                         || ' ' || B.SHIP_TO_FRTH_LINE_ADDR
                         || ' ' || B.SHIP_TO_CTY_ADDR
                         || ' ' || B.SHIP_TO_ST_CD
                         || ' ' || B.SHIP_TO_POST_CD) AS SHIP_TO_ADDR
                     ,CASE
                         WHEN
                             K.BILL_TO_CUST_LOC_CD IS NULL
                         THEN
                             D.BILL_TO_CUST_CD
                         ELSE
                             K.BILL_TO_CUST_LOC_CD
                      END AS P_BILL_TO_CUST_CD
                     ,CASE
                         WHEN
                             K.SHIP_TO_CUST_LOC_CD IS NULL
                         THEN
                             D.ADD_SHIP_TO_CUST_CD
                         ELSE
                             K.SHIP_TO_CUST_LOC_CD
                      END AS P_SHIP_TO_CUST_CD
                 FROM
                     <!-- START 2019/03/14 [QC#30748, MOD] -->
                     <!-- SVC_MACH_MSTR A -->
                     <!-- ,CPO_DTL B -->
                     DS_CPO_RTRN_DTL B
                     <!-- END 2019/03/14 [QC#30748, MOD] -->
                     ,CPO D
                     ,DS_ORD_CATG F
                     ,DS_ORD_TP G
                     ,DS_ORD_LINE_CATG H
                     ,BILL_TO_CUST I
                     ,BILL_TO_CUST J
                     ,DS_CPO_CONFIG K
                     ,SHIP_TO_CUST L
                 WHERE
                     <!-- START 2019/03/14 [QC#30748, DEL] -->
                     <!--     A.GLBL_CMPY_CD          = #glblCmpyCd#           -->
                     <!-- AND A.SVC_MACH_MSTR_PK      = #svcMachMstrPk#        -->
                     <!-- AND A.GLBL_CMPY_CD          = B.GLBL_CMPY_CD         -->
                     <!-- AND A.RMA_NUM               = B.CPO_ORD_NUM          -->
                     <!-- AND A.RMA_LINE_NUM          = B.CPO_DTL_LINE_NUM     -->
                     <!-- AND A.RMA_LINE_SUB_NUM      = B.CPO_DTL_LINE_SUB_NUM -->
                     <!-- END 2019/03/14 [QC#30748, DEL] -->
                         B.GLBL_CMPY_CD          = #glblCmpyCd#
                     AND B.GLBL_CMPY_CD          = D.GLBL_CMPY_CD
                     AND B.CPO_ORD_NUM           = D.CPO_ORD_NUM
                     AND D.GLBL_CMPY_CD          = F.GLBL_CMPY_CD(+)
                     AND D.DS_ORD_CATG_CD        = F.DS_ORD_CATG_CD(+)
                     AND D.GLBL_CMPY_CD          = G.GLBL_CMPY_CD
                     AND D.DS_ORD_TP_CD          = G.DS_ORD_TP_CD
                     AND B.GLBL_CMPY_CD          = H.GLBL_CMPY_CD(+)
                     AND B.DS_ORD_LINE_CATG_CD   = H.DS_ORD_LINE_CATG_CD(+)
                     AND D.GLBL_CMPY_CD          = I.GLBL_CMPY_CD
                     AND D.SOLD_TO_CUST_LOC_CD   = I.BILL_TO_CUST_CD
                     AND D.GLBL_CMPY_CD          = J.GLBL_CMPY_CD
                     AND D.BILL_TO_CUST_CD       = J.BILL_TO_CUST_CD
                     AND B.GLBL_CMPY_CD          = K.GLBL_CMPY_CD(+)
                     AND B.DS_CPO_CONFIG_PK      = K.DS_CPO_CONFIG_PK(+)
                     AND B.GLBL_CMPY_CD          = L.GLBL_CMPY_CD
                     AND B.SHIP_TO_CUST_CD       = L.SHIP_TO_CUST_CD
                     <!-- START 2019/03/14 [QC#30748, MOD] -->
                     <!-- mod start 2019/09/03 QC#52960 -->
                     AND B.SVC_MACH_MSTR_PK      = #svcMachMstrPk#
                     <!-- AND EXISTS (    -->
                     <!--     SELECT    -->
                     <!--          1    -->
                     <!--     FROM    -->
                     <!--          SVC_MACH_MSTR_HIST A    -->
                     <!--     WHERE    -->
                     <!--             A.GLBL_CMPY_CD         = #glblCmpyCd#               -->
                     <!--         AND A.EZCANCELFLAG         = '0'                        -->
                     <!--         AND A.SVC_MACH_MSTR_PK     = #svcMachMstrPk#            -->
                     <!--         AND A.RMA_NUM              = B.CPO_ORD_NUM              -->
                     <!--         AND A.RMA_LINE_NUM         = B.DS_CPO_RTRN_LINE_NUM     -->
                     <!--         AND A.RMA_LINE_SUB_NUM     = B.DS_CPO_RTRN_LINE_SUB_NUM -->
                     <!-- )                                                               -->
                     <!-- mod end 2019/09/03 QC#52960 -->
                     <!-- AND A.EZCANCELFLAG          = '0' -->
                     <!-- END 2019/03/14 [QC#30748, MOD] -->
                     AND B.EZCANCELFLAG          = '0'
                     AND D.EZCANCELFLAG          = '0'
                     AND F.EZCANCELFLAG(+)       = '0'
                     AND G.EZCANCELFLAG          = '0'
                     AND H.EZCANCELFLAG(+)       = '0'
                     AND I.EZCANCELFLAG          = '0'
                     AND J.EZCANCELFLAG          = '0'
                     AND K.EZCANCELFLAG(+)       = '0'
                     AND L.EZCANCELFLAG          = '0'
                 ORDER BY
                     CPO_ORD_TS
                     ,CPO_ORD_NUM
            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getSlsHistory" class="NSAL0010_GSMsg">
        <result property="cpoOrdNum_G" column="CPO_ORD_NUM"  javaType="EZDSStringItem" />
        <result property="cpoOrdTs_G" column="CPO_ORD_TS"  javaType="EZDSStringItem" />
<!-- START 2017/02/06 N.Arai [QC#17197, MOD] -->
        <result property="cpoOrdDt_G" column="CPO_ORD_DT"  javaType="EZDSStringItem" />
<!-- END 2017/02/06 N.Arai [QC#17197, MOD] -->
        <result property="dsOrdCatgCd_G" column="DS_ORD_CATG_CD"  javaType="EZDSStringItem" />
        <result property="dsOrdCatgDescTxt_G" column="DS_ORD_CATG_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="dsOrdTpCd_G" column="DS_ORD_TP_CD"  javaType="EZDSStringItem" />
        <result property="dsOrdTpDescTxt_G" column="DS_ORD_TP_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="dsOrdLineCatgCd_G" column="DS_ORD_LINE_CATG_CD"  javaType="EZDSStringItem" />
        <result property="dsOrdLineCatgDescTxt_G" column="DS_ORD_LINE_CATG_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="sellToCustCd_G" column="SELL_TO_CUST_CD"  javaType="EZDSStringItem" />
        <result property="locNm_G1" column="SELL_TO_LOC_NM"  javaType="EZDSStringItem" />
        <result property="billToCustCd_G" column="BILL_TO_CUST_CD"  javaType="EZDSStringItem" />
        <result property="locNm_G2" column="BILL_TO_LOC_NM"  javaType="EZDSStringItem" />
        <result property="shipToCustCd_G" column="SHIP_TO_CUST_CD"  javaType="EZDSStringItem" />
        <result property="shipToLocNm_G" column="SHIP_TO_LOC_NM"  javaType="EZDSStringItem" />
        <result property="shipToAddr_G" column="SHIP_TO_ADDR"  javaType="EZDSStringItem" />
        <result property="billToCustCd_GP" column="P_BILL_TO_CUST_CD"  javaType="EZDSStringItem" />
        <result property="shipToCustCd_GP" column="P_SHIP_TO_CUST_CD"  javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getSolution" parameterClass="Map" resultMap="result.getSolution">
            SELECT
                 SVC_SLN_SQ
                ,SVC_CONFIG_MSTR_PK
                ,MDSE_CD
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--            ,MDSE_NM        -->
                ,MDSE_DESC_SHORT_TXT
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
                ,T_MDL_NM
                ,SVC_MACH_MSTR_PK_1
                ,SVC_MACH_MSTR_PK_2
                ,ISTL_DT
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--            ,BILL_TO_LOC_NM -->
                ,OWNR_ACCT_NM
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
                ,BILL_TO_ACCT_NM
                ,CUR_LOC_ACCT_NM
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
                ,ORD_SQ
                ,SVC_MACH_TP_CD
                ,SVC_MACH_SQ_NUM
                ,EZUPTIME
                ,EZUPTIMEZONE
            FROM (
                 SELECT
                      SCM.SVC_SLN_SQ                      SVC_SLN_SQ
                     ,SCM.SVC_CONFIG_MSTR_PK              SVC_CONFIG_MSTR_PK
                     ,SMM.MDSE_CD                         MDSE_CD
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--                 ,MDS.MDSE_NM                         MDSE_NM       -->
                     ,MDS.MDSE_DESC_SHORT_TXT             MDSE_DESC_SHORT_TXT
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
                     ,MDN.T_MDL_NM                        T_MDL_NM
                     ,SMM.SVC_MACH_MSTR_PK                SVC_MACH_MSTR_PK_1
<!-- START 2017/01/17 N.Arai [QC#14614, MOD] -->
<!--                 ,#svcMachMstrPk#                     SVC_MACH_MSTR_PK_2   -->
                     ,SCM.SVC_MACH_MSTR_PK                SVC_MACH_MSTR_PK_2
<!-- END 2017/01/17 N.Arai [QC#14614, MOD] -->
                     ,SMM.ISTL_DT                         ISTL_DT
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--                 ,BTC.LOC_NM                          BILL_TO_LOC_NM -->
<!--                 ,BTC2.LOC_NM                         DS_ACCT_LOC_NM -->
<!--                 ,STC.LOC_NM                          SHIP_TO_LOC_NM -->
                     ,DAC1.DS_ACCT_NM                     OWNR_ACCT_NM
                     ,DAC2.DS_ACCT_NM                     BILL_TO_ACCT_NM
                     ,DAC3.DS_ACCT_NM                     CUR_LOC_ACCT_NM
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
                     ,1                                   ORD_SQ
                     ,SMM.SVC_MACH_TP_CD                  SVC_MACH_TP_CD
                     ,SMM.SVC_MACH_SQ_NUM                 SVC_MACH_SQ_NUM
                     ,SCM.EZUPTIME                        EZUPTIME
                     ,SCM.EZUPTIMEZONE                    EZUPTIMEZONE
                 FROM
                      SVC_MACH_MSTR      SMM1
                     ,SVC_CONFIG_MSTR    SCM
                     ,SVC_MACH_MSTR      SMM
                     ,MDSE               MDS
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--                 ,BILL_TO_CUST       BTC -->
                     ,SELL_TO_CUST       DAC1
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
                     ,SELL_TO_CUST       DAC2
                     ,SELL_TO_CUST       DAC3
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
                     ,MDL_NM             MDN
                 WHERE
                      SMM1.GLBL_CMPY_CD          = #glblCmpyCd#
                  AND SMM1.SVC_MACH_MSTR_PK      = #svcMachMstrPk#
                  AND SMM1.EZCANCELFLAG          = '0'
                  AND SMM1.GLBL_CMPY_CD          = SCM.GLBL_CMPY_CD
                  AND SMM1.SVC_CONFIG_MSTR_PK    = SCM.SVC_CONFIG_MSTR_PK
                  AND SCM.EZCANCELFLAG           = '0'
                  AND SCM.GLBL_CMPY_CD           = SMM.GLBL_CMPY_CD
                  AND SCM.SVC_CONFIG_MSTR_PK     = SMM.SVC_CONFIG_MSTR_PK
                  AND SMM.EZCANCELFLAG           = '0'
                  AND SMM.GLBL_CMPY_CD           = MDS.GLBL_CMPY_CD
                  AND SMM.MDSE_CD                = MDS.MDSE_CD
                  AND MDS.EZCANCELFLAG           = '0'
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--              AND SMM.GLBL_CMPY_CD           = BTC.GLBL_CMPY_CD(+) -->
<!--              AND SMM.OWNR_LOC_NUM           = BTC.BILL_TO_CUST_CD(+) -->
<!--              AND BTC.EZCANCELFLAG(+)        = '0' -->
                  AND SMM.GLBL_CMPY_CD           = DAC1.GLBL_CMPY_CD(+)
                  AND SMM.OWNR_ACCT_NUM          = DAC1.SELL_TO_CUST_CD(+)
                  AND DAC1.EZCANCELFLAG(+)       = '0'
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
                  AND SMM.GLBL_CMPY_CD           = DAC2.GLBL_CMPY_CD(+)
                  AND SMM.BILL_TO_ACCT_NUM       = DAC2.SELL_TO_CUST_CD(+)
                  AND DAC2.EZCANCELFLAG(+)       = '0'
                  AND SMM.GLBL_CMPY_CD           = DAC3.GLBL_CMPY_CD(+)
                  AND SMM.CUR_LOC_ACCT_NUM       = DAC3.SELL_TO_CUST_CD(+)
                  AND DAC3.EZCANCELFLAG(+)       = '0'
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
                  AND SCM.GLBL_CMPY_CD           = MDN.T_GLBL_CMPY_CD(+)
                  AND SCM.MDL_ID                 = MDN.T_MDL_ID(+)
                  AND MDN.EZCANCELFLAG(+)        = '0'
            UNION ALL
                 SELECT
                      SCM.SVC_SLN_SQ                                    SVC_SLN_SQ
                     ,SCM.SVC_CONFIG_MSTR_PK                            SVC_CONFIG_MSTR_PK
                     ,SMM.MDSE_CD                                       MDSE_CD
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--                 ,MDS.MDSE_NM                                       MDSE_NM       -->
                     ,MDS.MDSE_DESC_SHORT_TXT                           MDSE_DESC_SHORT_TXT
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
                     ,MDN.T_MDL_NM                                      T_MDL_NM
                     ,SMM.SVC_MACH_MSTR_PK                              SVC_MACH_MSTR_PK_1
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--                 ,NVL(SM2.SVC_MACH_MSTR_PK, SMM.SVC_MACH_MSTR_PK)   SVC_MACH_MSTR_PK_2 -->
                     ,SCM.SVC_MACH_MSTR_PK                              SVC_MACH_MSTR_PK_2
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
                     ,SMM.ISTL_DT                                       ISTL_DT
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--                 ,BTC.LOC_NM                                        BILL_TO_LOC_NM -->
<!--                 ,DAC.LOC_NM                                        DS_ACCT_LOC_NM -->
<!--                 ,STC.LOC_NM                                        SHIP_TO_LOC_NM -->
                     ,DAC1.DS_ACCT_NM                                   OWNR_ACCT_NM
                     ,DAC2.DS_ACCT_NM                                   BILL_TO_ACCT_NM
                     ,DAC3.DS_ACCT_NM                                   CUR_LOC_ACCT_NM
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
                     ,2                                                 ORD_SQ
                     ,SMM.SVC_MACH_TP_CD                                SVC_MACH_TP_CD
                     ,SMM.SVC_MACH_SQ_NUM                               SVC_MACH_SQ_NUM
                     ,SCM.EZUPTIME                                      EZUPTIME
                     ,SCM.EZUPTIMEZONE                                  EZUPTIMEZONE
                     
                 FROM
                      SVC_CONFIG_MSTR    SCM
                     ,SVC_MACH_MSTR      SMM
                     ,MDSE               MDS
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--                 ,BILL_TO_CUST       BTC -->
                     ,SELL_TO_CUST       DAC1
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
                     ,SELL_TO_CUST       DAC2
                     ,SELL_TO_CUST       DAC3
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
                     ,MDL_NM             MDN
<!-- START 2018/05/31 H.Nagashima [QC#18307, DEL] -->
<!--                 ,SVC_MACH_MSTR      SM2 -->
<!-- END 2018/05/31 H.Nagashima [QC#18307, DEL] -->
                 WHERE
                      SCM.GLBL_CMPY_CD           = #glblCmpyCd#
                  AND SCM.EZCANCELFLAG           = '0'
                  AND SCM.GLBL_CMPY_CD           = SMM.GLBL_CMPY_CD
                  AND SCM.SVC_CONFIG_MSTR_PK     = SMM.SVC_CONFIG_MSTR_PK
                  AND SMM.EZCANCELFLAG           = '0'
                  AND EXISTS (
                        SELECT
                            SC1.SVC_SLN_SQ
                        FROM
                            SVC_MACH_MSTR       SM1
                           ,SVC_CONFIG_MSTR     SC1
                        WHERE
                            SM1.GLBL_CMPY_CD        = #glblCmpyCd#
                        AND SM1.SVC_MACH_MSTR_PK    = #svcMachMstrPk#
                        AND SM1.EZCANCELFLAG        = '0'
                        AND SM1.GLBL_CMPY_CD        = SC1.GLBL_CMPY_CD
                        AND SM1.SVC_CONFIG_MSTR_PK  = SC1.SVC_CONFIG_MSTR_PK
<!-- START 2018/05/31 H.Nagashima [QC#18307, ADD] -->
                        AND SC1.SVC_CONFIG_MSTR_PK  != SCM.SVC_CONFIG_MSTR_PK
<!-- END 2018/05/31 H.Nagashima [QC#18307, ADD] -->
                        AND SC1.SVC_SLN_SQ          = SCM.SVC_SLN_SQ
                        AND SC1.EZCANCELFLAG        = '0'
                      )
<!-- START 2018/05/31 H.Nagashima [QC#18307, DEL] -->
<!--
                  AND NOT EXISTS (
                        SELECT
                            SC3.SVC_SLN_SQ
                        FROM
                            SVC_MACH_MSTR       SM3
                           ,SVC_CONFIG_MSTR     SC3
                        WHERE
                            SM3.GLBL_CMPY_CD        = #glblCmpyCd#
                        AND SM3.SVC_MACH_MSTR_PK    = #svcMachMstrPk#
                        AND SM3.EZCANCELFLAG        = '0'
                        AND SM3.GLBL_CMPY_CD        = SC3.GLBL_CMPY_CD
                        AND SM3.SVC_CONFIG_MSTR_PK  = SC3.SVC_CONFIG_MSTR_PK
                        AND SC3.SVC_CONFIG_MSTR_PK  = SCM.SVC_CONFIG_MSTR_PK
                        AND SC3.EZCANCELFLAG        = '0'
                      )
-->
<!-- END 2018/05/31 H.Nagashima [QC#18307, DEL] -->
                  AND SMM.GLBL_CMPY_CD           = MDS.GLBL_CMPY_CD
                  AND SMM.MDSE_CD                = MDS.MDSE_CD
                  AND MDS.EZCANCELFLAG           = '0'
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--              AND SMM.GLBL_CMPY_CD           = BTC.GLBL_CMPY_CD(+) -->
<!--              AND SMM.OWNR_LOC_NUM           = BTC.BILL_TO_CUST_CD(+) -->
<!--              AND BTC.EZCANCELFLAG(+)        = '0' -->
                  AND SMM.GLBL_CMPY_CD           = DAC1.GLBL_CMPY_CD(+)
                  AND SMM.OWNR_ACCT_NUM          = DAC1.SELL_TO_CUST_CD(+)
                  AND DAC1.EZCANCELFLAG(+)       = '0'
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
                  AND SMM.GLBL_CMPY_CD           = DAC2.GLBL_CMPY_CD(+)
                  AND SMM.BILL_TO_ACCT_NUM       = DAC2.SELL_TO_CUST_CD(+)
                  AND DAC2.EZCANCELFLAG(+)       = '0'
                  AND SMM.GLBL_CMPY_CD           = DAC3.GLBL_CMPY_CD(+)
                  AND SMM.CUR_LOC_ACCT_NUM       = DAC3.SELL_TO_CUST_CD(+)
                  AND DAC3.EZCANCELFLAG(+)       = '0'
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
                  AND SCM.GLBL_CMPY_CD           = MDN.T_GLBL_CMPY_CD(+)
                  AND SCM.MDL_ID                 = MDN.T_MDL_ID(+)
                  AND MDN.EZCANCELFLAG(+)        = '0'
<!-- START 2018/05/31 H.Nagashima [QC#18307, DEL] -->
<!--
                  AND SMM.GLBL_CMPY_CD           = SM2.GLBL_CMPY_CD(+)
                  AND SMM.PRNT_SER_NUM           = SM2.PRNT_SER_NUM(+)
                  AND SM2.EZCANCELFLAG(+)        = '0'
-->
<!-- END 2018/05/31 H.Nagashima [QC#18307, DEL] -->
                 ORDER BY
                      ORD_SQ
                     ,SVC_CONFIG_MSTR_PK
                     ,SVC_MACH_TP_CD
                     ,SVC_MACH_SQ_NUM

            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getSolution" class="NSAL0010_BSMsg">
        <result property="svcSlnSq_B"         column="SVC_SLN_SQ"          javaType="EZDSBigDecimalItem" />
        <result property="svcConfigMstrPk_B"  column="SVC_CONFIG_MSTR_PK"  javaType="EZDSBigDecimalItem" />
        <result property="mdseCd_B"           column="MDSE_CD"             javaType="EZDSStringItem" />
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--    <result property="mdseNm_B" column="MDSE_NM"  javaType="EZDSStringItem" />      -->
        <result property="mdseDescShortTxt_B" column="MDSE_DESC_SHORT_TXT" javaType="EZDSStringItem" />
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
        <result property="t_MdlNm_B"          column="T_MDL_NM"            javaType="EZDSStringItem" />
        <result property="svcMachMstrPk_B1"   column="SVC_MACH_MSTR_PK_1"  javaType="EZDSBigDecimalItem" />
        <result property="svcMachMstrPk_B2"   column="SVC_MACH_MSTR_PK_2"  javaType="EZDSBigDecimalItem" />
        <result property="istlDt_B"           column="ISTL_DT"             javaType="EZDSDateItem" />
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
<!-- START 2018/05/31 H.Nagashima [QC#18307, MOD] -->
<!--    <result property="locNm_B1" column="BILL_TO_LOC_NM"  javaType="EZDSStringItem" /> -->
        <result property="dsAcctNm_B1"        column="OWNR_ACCT_NM"        javaType="EZDSStringItem" />
<!-- END 2018/05/31 H.Nagashima [QC#18307, MOD] -->
        <result property="dsAcctNm_B2"        column="BILL_TO_ACCT_NM"     javaType="EZDSStringItem" />
        <result property="dsAcctNm_B3"        column="CUR_LOC_ACCT_NM"     javaType="EZDSStringItem" />
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
        <result property="ezUpTime_B"         column="EZUPTIME"            javaType="EZDSStringItem" />
        <result property="ezUpTimeZone_B"     column="EZUPTIMEZONE"        javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getIbHist" parameterClass="Map" resultMap="result.getIbHist">
            SELECT
                 SVC_MACH_MSTR_TRK_PK
                ,TRX_RGTN_DT
<!-- START 2016/04/04 M.Gotou [QC#4953, MOD] -->
<!--            ,UPD_FLD_TXT -->
                ,MACH_HIST_ATTRB_LONG_NM
<!-- END 2016/04/04 M.Gotou [QC#4953, MOD] -->
                ,OLD_VAL_TXT
                ,NEW_VAL_TXT
                ,UPD_USR_ID
                ,CASE WHEN SVC_MEMO_CNT = 0
                    THEN 'N'
                    ELSE 'Y'
                 END AS EXIST_SVC_MEMO
            FROM (
                 SELECT
                      SMT.SVC_MACH_MSTR_TRK_PK
                     ,SMT.TRX_RGTN_DT
<!-- START 2016/04/04 M.Gotou [QC#4953, MOD] -->
<!--                 ,SMT.UPD_FLD_TXT -->
                     ,NVL(MHCM.MACH_HIST_ATTRB_LONG_NM, SMT.UPD_FLD_TXT) AS MACH_HIST_ATTRB_LONG_NM
<!-- END 2016/04/04 M.Gotou [QC#4953, MOD] -->
                     ,SMT.OLD_VAL_TXT
                     ,SMT.NEW_VAL_TXT
                     ,SMT.UPD_USR_ID
                     ,(
                        SELECT
                            COUNT(*)
                        FROM
                            SVC_MEMO SVM
                        WHERE
                            SVM.GLBL_CMPY_CD     = SMT.GLBL_CMPY_CD
                        AND SVM.SVC_MACH_MSTR_PK = SMT.SVC_MACH_MSTR_PK
                        AND SVM.SVC_MEMO_TRX_NUM = SMT.SVC_MACH_MSTR_TRK_PK
                        AND SVM.SVC_MEMO_TRX_NM  = #svcMachMstrTrkPk#
                        AND SVM.EZCANCELFLAG     = '0'
                      ) AS SVC_MEMO_CNT
                 FROM
                      SVC_MACH_MSTR_TRK  SMT
<!-- START 2016/04/04 M.Gotou [QC#4953, ADD] -->
                     ,MACH_HIST_COL_MAP  MHCM
<!-- END 2016/04/04 M.Gotou [QC#4953, ADD] -->
                 WHERE
                      SMT.GLBL_CMPY_CD           = #glblCmpyCd#
                  AND SMT.SVC_MACH_MSTR_PK       = #svcMachMstrPk#
                  AND SMT.EZCANCELFLAG           = '0'
<!-- START 2023/10/06 K.Ishizuka [QC#54186, MOD] -->
<!-- START 2016/04/04 M.Gotou [QC#4953, ADD] -->
<!--              AND SMT.GLBL_CMPY_CD           = MHCM.GLBL_CMPY_CD       (+) -->
<!--              AND SMT.UPD_FLD_TXT            = MHCM.MACH_HIST_ATTRB_NM (+) -->
<!--              AND MHCM.ENBL_FLG          (+) = 'Y'-->
<!--              AND MHCM.EZCANCELFLAG      (+) = '0'-->
<!-- END 2016/04/04 M.Gotou [QC#4953, ADD] -->
                  AND SMT.GLBL_CMPY_CD           = MHCM.GLBL_CMPY_CD
                  AND SMT.UPD_FLD_TXT            = MHCM.MACH_HIST_ATTRB_NM
                  AND MHCM.ENBL_FLG              = 'Y'
                  AND MHCM.EZCANCELFLAG          = '0'
<!-- END 2023/10/06 K.Ishizuka [QC#54186, MOD] -->
                 ORDER BY
<!-- START 2016/03/24 M.Gotou [QC#4897, MOD] -->
                      SMT.TRX_RGTN_DT          DESC
                     ,SMT.SVC_MACH_MSTR_TRK_PK DESC
<!-- END 2016/03/24 M.Gotou [QC#4897, MOD] -->
            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getIbHist" class="NSAL0010_ISMsg">
        <result property="svcMachMstrTrkPk_I" column="SVC_MACH_MSTR_TRK_PK"  javaType="EZDSBigDecimalItem" />
        <result property="trxRgtnDt_I" column="TRX_RGTN_DT"  javaType="EZDCDateItem" />
<!-- START 2016/04/04 M.Gotou [QC#4953, MOD] -->
<!--    <result property="updFldTxt_I" column="UPD_FLD_TXT"  javaType="EZDCStringItem" /> -->
        <result property="machHistAttrbLongNm_I" column="MACH_HIST_ATTRB_LONG_NM"  javaType="EZDCStringItem" />
<!-- START 2016/04/04 M.Gotou [QC#4953, MOD] -->
        <result property="oldValTxt_I" column="OLD_VAL_TXT"  javaType="EZDCStringItem" />
        <result property="newValTxt_I" column="NEW_VAL_TXT"  javaType="EZDCStringItem" />
        <result property="updUsrId_I" column="UPD_USR_ID"  javaType="EZDCStringItem" />
        <result property="xxYesNoCd_I" column="EXIST_SVC_MEMO"  javaType="EZDCStringItem" />
    </resultMap>

    <statement id="getContrSmry" parameterClass="Map" resultMap="result.getContrSmry">
            SELECT
                 DS_CONTR_PK
                ,DS_CONTR_NUM
                ,DS_CONTR_CTRL_STS_NM
                ,CONTR_EFF_FROM_DT
                ,CONTR_EFF_THRU_DT
                ,DS_CONTR_CATG_DESC_TXT
                ,BLLG_CYCLE_DESC_TXT
                ,MTR_READ_METH_DESC_TXT
                ,SVC_CONTR_REF_CMNT_TXT
                ,SVC_CONTR_BR_DESC_TXT
                ,SVC_PGM_MDSE_CD
            FROM (
                 SELECT
                      CHD.DS_CONTR_PK
                     ,CHD.DS_CONTR_NUM
                     ,CSV.DS_CONTR_CTRL_STS_NM
                     ,CDT.CONTR_EFF_FROM_DT
                     ,CDT.CONTR_EFF_THRU_DT
                     ,CCG.DS_CONTR_CATG_DESC_TXT
                     ,BLC.BLLG_CYCLE_DESC_TXT
                     ,MRM.MTR_READ_METH_DESC_TXT
                     ,CHD.SVC_CONTR_REF_CMNT_TXT
                     ,SCB.SVC_CONTR_BR_DESC_TXT
                     ,CDT.SVC_PGM_MDSE_CD
                 FROM
                      DS_CONTR_DTL           CDT
                     ,DS_CONTR               CHD
                     ,DS_CONTR_DTL_STS_V     CSV
                     ,DS_CONTR_CATG          CCG
                     ,BLLG_CYCLE             BLC
                     ,MTR_READ_METH          MRM
                     ,SVC_CONTR_BR           SCB
                 WHERE
                      CDT.GLBL_CMPY_CD           = #glblCmpyCd#
                  AND CDT.SVC_MACH_MSTR_PK       = #svcMachMstrPk#
                  AND CDT.EZCANCELFLAG           = '0'
                  AND CDT.GLBL_CMPY_CD           = CHD.GLBL_CMPY_CD
                  AND CDT.DS_CONTR_PK            = CHD.DS_CONTR_PK
                  AND CHD.EZCANCELFLAG           = '0'
                  AND CDT.GLBL_CMPY_CD           = CSV.GLBL_CMPY_CD
                  AND CDT.DS_CONTR_DTL_PK        = CSV.DS_CONTR_DTL_PK
                  AND CSV.EZCANCELFLAG           = '0'
                  AND CHD.GLBL_CMPY_CD           = CCG.GLBL_CMPY_CD
                  AND CHD.DS_CONTR_CATG_CD       = CCG.DS_CONTR_CATG_CD
                  AND CCG.EZCANCELFLAG           = '0'
                  AND CDT.GLBL_CMPY_CD           = BLC.GLBL_CMPY_CD     (+)
                  AND CDT.BASE_BLLG_CYCLE_CD     = BLC.BLLG_CYCLE_CD    (+)
                  AND BLC.EZCANCELFLAG       (+) = '0'
                  AND CDT.GLBL_CMPY_CD           = MRM.GLBL_CMPY_CD     (+)
                  AND CDT.MTR_READ_METH_CD       = MRM.MTR_READ_METH_CD (+)
                  AND MRM.EZCANCELFLAG       (+) = '0'
                  AND CHD.GLBL_CMPY_CD           = SCB.GLBL_CMPY_CD
                  AND CHD.SVC_CONTR_BR_CD        = SCB.SVC_CONTR_BR_CD
                  AND SCB.EZCANCELFLAG           = '0'
                 ORDER BY
                      CHD.CONTR_VRSN_EFF_FROM_DT    DESC
                     ,CHD.DS_CONTR_NUM
            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getContrSmry" class="NSAL0010_JSMsg">
        <result property="dsContrPk_J" column="DS_CONTR_PK"  javaType="EZDSBigDecimalItem" />
        <result property="dsContrNum_J" column="DS_CONTR_NUM"  javaType="EZDSStringItem" />
        <result property="dsContrCtrlStsNm_J" column="DS_CONTR_CTRL_STS_NM"  javaType="EZDSStringItem" />
        <result property="contrEffFromDt_J" column="CONTR_EFF_FROM_DT"  javaType="EZDSDateItem" />
        <result property="contrEffThruDt_J" column="CONTR_EFF_THRU_DT"  javaType="EZDSDateItem" />
        <result property="dsContrCatgDescTxt_J" column="DS_CONTR_CATG_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="bllgCycleDescTxt_J" column="BLLG_CYCLE_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="mtrReadMethDescTxt_J" column="MTR_READ_METH_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="svcContrRefCmntTxt_J" column="SVC_CONTR_REF_CMNT_TXT"  javaType="EZDSStringItem" />
        <result property="svcContrBrDescTxt_J" column="SVC_CONTR_BR_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="svcPgmMdseCd_J" column="SVC_PGM_MDSE_CD"  javaType="EZDSStringItem" />
    </resultMap>

    <statement id="getSvcCallHist" parameterClass="Map" resultMap="result.getSvcCallHist">
            SELECT
                 FSR_NUM
                ,LOC_NM
                ,TASK_STS_NM
                ,SVC_TASK_RCV_DT
                ,SVC_PBLM_TP_DESC_TXT
                ,SVC_PBLM_CRCT_TP_DESC_TXT
                ,SVC_TASK_SCHD_DT
                ,SVC_TASK_CLO_DT
                ,SVC_MNGR
                ,SVC_TASK_NUM
<!-- START 2017/07/20 U.Kim [QC#19995, ADD] -->
<!-- START 2017/08/03 U.Kim [QC#19995, MOD] -->
<!--            ,DS_SVC_CALL_TP_DESC_TXT -->
                ,XX_SCR_ITEM_54_TXT
<!-- END 2017/08/03 U.Kim [QC#19995, MOD] -->
<!-- END 2017/07/20 U.Kim [QC#19995, ADD] -->
            FROM (
                 SELECT
                      SVT.FSR_NUM
                     ,STC.LOC_NM
                     ,NVL(ST1.SVC_TASK_STS_DESC_TXT, ST2.SVC_TASK_STS_DESC_TXT)
                      AS TASK_STS_NM
                     ,SVT.SVC_TASK_RCV_DT
                     ,SPT.SVC_PBLM_TP_DESC_TXT
                     ,SPC.SVC_PBLM_CRCT_TP_DESC_TXT
                     ,SVT.SVC_TASK_SCHD_DT
                     ,SVT.SVC_TASK_CLO_DT
                     ,TRIM(SPN.PSN_CD
                         || ' ' || SPN.PSN_FIRST_NM
                         || ' ' || SPN.PSN_LAST_NM) AS SVC_MNGR
                     ,SVT.SVC_TASK_NUM
<!-- START 2017/07/20 U.Kim [QC#19995, ADD] -->
<!-- START 2017/08/03 U.Kim [QC#19995, MOD] -->
<!--                 ,DSCT.DS_SVC_CALL_TP_DESC_TXT -->
                     ,DSCT.DS_SVC_CALL_TP_CD
                         || '-' || DSCT.DS_SVC_CALL_TP_DESC_TXT AS XX_SCR_ITEM_54_TXT
<!-- END 2017/08/03 U.Kim [QC#19995, MOD] -->
<!-- END 2017/07/20 U.Kim [QC#19995, ADD] -->
                 FROM
                      SVC_TASK              SVT
                     ,FSR                   FSR
                     ,FSR_VISIT             FVI
                     ,FSR_VISIT_TASK        FVT
                     ,SHIP_TO_CUST          STC
                     ,SVC_PBLM_TP           SPT
                     ,SVC_PBLM_CRCT_TP      SPC
                     ,TECH_MSTR             TCM
                     ,S21_PSN               SPN
                     ,SVC_TASK_STS          ST1
                     ,SVC_TASK_STS          ST2
<!-- START 2017/07/20 U.Kim [QC#19995, ADD] -->
                     ,DS_SVC_CALL_TP        DSCT
<!-- END 2017/07/20 U.Kim [QC#19995, ADD] -->
                     
                 WHERE
                      SVT.GLBL_CMPY_CD           = #glblCmpyCd#
                  AND SVT.SVC_MACH_MSTR_PK       = #svcMachMstrPk#
                  AND SVT.EZCANCELFLAG           = '0'
                  AND SVT.GLBL_CMPY_CD           = FSR.GLBL_CMPY_CD(+)
                  AND SVT.FSR_NUM                = FSR.FSR_NUM(+)
                  AND FSR.EZCANCELFLAG(+)        = '0'
                  AND SVT.GLBL_CMPY_CD           = FVI.GLBL_CMPY_CD(+)
                  AND SVT.SVC_TASK_NUM           = FVI.SVC_TASK_NUM(+)
                  AND FVI.EZCANCELFLAG(+)        = '0'
                  AND SVT.GLBL_CMPY_CD           = FVT.GLBL_CMPY_CD(+)
                  AND SVT.SVC_TASK_NUM           = FVT.SVC_TASK_NUM(+)
                  AND FVT.EZCANCELFLAG(+)        = '0'
                  AND FSR.GLBL_CMPY_CD           = STC.GLBL_CMPY_CD(+)
                  AND FSR.SHIP_TO_CUST_CD        = STC.SHIP_TO_CUST_CD(+)
                  AND STC.EZCANCELFLAG(+)        = '0'
                  AND FVT.GLBL_CMPY_CD           = SPT.GLBL_CMPY_CD(+)
                  AND FVT.SVC_PBLM_TP_CD         = SPT.SVC_PBLM_TP_CD(+)
                  AND SPT.EZCANCELFLAG(+)        = '0'
                  AND FVT.GLBL_CMPY_CD           = SPC.GLBL_CMPY_CD(+)
                  AND FVT.SVC_PBLM_CRCT_TP_CD    = SPC.SVC_PBLM_CRCT_TP_CD(+)
                  AND SPC.EZCANCELFLAG(+)        = '0'
                  AND SVT.GLBL_CMPY_CD           = TCM.GLBL_CMPY_CD(+)
                  AND SVT.TECH_CD                = TCM.TECH_TOC_CD(+)
                  AND TCM.EZCANCELFLAG(+)        = '0'
<!-- START 2017/09/07 U.Kim [QC#19619, MOD] -->
<!--              AND TCM.GLBL_CMPY_CD           = SPN.GLBL_CMPY_CD(+) -->
<!--              AND TCM.FLD_SVC_MGR_CD         = SPN.PSN_CD(+) -->
                  AND SVT.GLBL_CMPY_CD           = SPN.GLBL_CMPY_CD(+)
                  AND SVT.SVC_BR_MGR_PSN_CD      = SPN.PSN_CD(+)
<!-- END 2017/09/07 U.Kim [QC#19619, MOD] -->
                  AND SPN.EZCANCELFLAG(+)        = '0'
                  AND FVI.GLBL_CMPY_CD           = ST1.GLBL_CMPY_CD(+)
                  AND FVI.FSR_VISIT_STS_CD       = ST1.SVC_TASK_STS_CD(+)
                  AND ST1.EZCANCELFLAG(+)        = '0'
<!-- START 2017/07/20 U.Kim [QC#19995, MOD] -->
<!--              AND SVT.GLBL_CMPY_CD           = ST2.GLBL_CMPY_CD -->
<!--              AND SVT.SVC_TASK_STS_CD        = ST2.SVC_TASK_STS_CD-->
<!--              AND ST2.EZCANCELFLAG           = '0' -->
                  AND SVT.GLBL_CMPY_CD           = ST2.GLBL_CMPY_CD(+)
                  AND SVT.SVC_TASK_STS_CD        = ST2.SVC_TASK_STS_CD(+)
                  AND ST2.EZCANCELFLAG(+)        = '0'
<!-- END 2017/07/20 U.Kim [QC#19995, MOD] -->
<!-- START 2017/07/20 U.Kim [QC#19995, ADD] -->
                  AND SVT.GLBL_CMPY_CD           = DSCT.GLBL_CMPY_CD
                  AND SVT.DS_SVC_CALL_TP_CD      = DSCT.DS_SVC_CALL_TP_CD
                  AND DSCT.EZCANCELFLAG          = '0'
<!-- END 2017/07/20 U.Kim [QC#19995, ADD] -->
                 ORDER BY
                      SVT.SVC_TASK_RCV_DT    DESC
<!-- START 2016/08/01 T.Tomita [QC#12539, MOD] -->
                     ,SVT.SVC_TASK_RCV_TM    DESC
<!--                 ,SVT.FSR_NUM            ASC -->
                     ,SVT.FSR_NUM            DESC
<!-- END 2016/08/01 T.Tomita [QC#12539, MOD] -->

            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getSvcCallHist" class="NSAL0010_KSMsg">
        <result property="fsrNum_K" column="FSR_NUM"  javaType="EZDSStringItem" />
        <result property="locNm_K" column="LOC_NM"  javaType="EZDSStringItem" />
        <result property="svcTaskStsNm_K" column="TASK_STS_NM"  javaType="EZDSStringItem" />
        <result property="svcTaskRcvDt_K" column="SVC_TASK_RCV_DT"  javaType="EZDSDateItem" />
        <result property="svcPblmTpDescTxt_K" column="SVC_PBLM_TP_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="svcPblmCrctTpDescTxt_K" column="SVC_PBLM_CRCT_TP_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="svcTaskSchdDt_K" column="SVC_TASK_SCHD_DT"  javaType="EZDSDateItem" />
        <result property="svcTaskCloDt_K" column="SVC_TASK_CLO_DT"  javaType="EZDSDateItem" />
        <result property="xxFullNm_K" column="SVC_MNGR"  javaType="EZDSStringItem" />
        <result property="svcTaskNum_K" column="SVC_TASK_NUM"  javaType="EZDSStringItem" />
<!-- START 2017/08/03 U.Kim [QC#19995, MOD] -->
<!-- END 2017/07/20 U.Kim [QC#19995, ADD] -->
        <result property="xxScrItem54Txt_K" column="XX_SCR_ITEM_54_TXT"  javaType="EZDSStringItem" />
<!--    <result property="dsSvcCallTpDescTxt_K" column="DS_SVC_CALL_TP_DESC_TXT"  javaType="EZDSStringItem" /> -->
<!-- END 2017/07/20 U.Kim [QC#19995, ADD] -->
<!-- END 2017/08/03 U.Kim [QC#19995, MOD] -->
    </resultMap>

    <statement id="getInvHist" parameterClass="Map" resultMap="result.getInvHist">
            SELECT
                 INV_NUM
                ,SYS_SRC_DESC_TXT
                ,DS_CONTR_NUM
                ,BILL_TO_LOC_NM
                ,SHIP_TO_LOC_NM
                ,INV_TP_DESC_TXT
                ,INV_TOT_DEAL_NET_AMT
                ,DEAL_RMNG_BAL_GRS_AMT
                ,APPL_AMT
                ,NET_DUE_DT
                ,CPO_ORD_NUM
                ,INV_DT
                ,ACCT_DT
                ,DS_CONTR_PK
                ,EIP_RPT_RQST_PK
            FROM (
                 SELECT
                      DISTINCT
                      INV.INV_NUM
                     ,SSR.SYS_SRC_DESC_TXT
                     ,DIL.DS_CONTR_NUM
                     ,BTC.LOC_NM AS BILL_TO_LOC_NM
                     ,NVL(ST1.LOC_NM, ST2.LOC_NM)  AS SHIP_TO_LOC_NM
                     ,ITP.INV_TP_DESC_TXT
                     ,INV.INV_TOT_DEAL_NET_AMT
                     ,ATB.DEAL_RMNG_BAL_GRS_AMT
                     ,ATB.DEAL_ORIG_GRS_AMT - ATB.DEAL_RMNG_BAL_GRS_AMT AS APPL_AMT
                     ,INV.NET_DUE_DT
                     ,SMM.CPO_ORD_NUM
                     ,INV.INV_DT
                     ,INV.ACCT_DT
                     ,DCD.DS_CONTR_PK
                     ,NVL(IPC.INV_FTP_RQST_NUM, IPC.INV_PRINT_RQST_NUM) EIP_RPT_RQST_PK
                 FROM
                      SVC_MACH_MSTR         SMM
                     ,INV_LINE              DIL
                     ,INV                   INV
                     ,SYS_SRC               SSR
                     ,INV_TP                ITP
                     ,BILL_TO_CUST          BTC
                     ,DS_CPO_CONFIG         DC1
                     ,SHIP_TO_CUST          ST1
                     ,CPO                   CPO
                     ,SHIP_TO_CUST          ST2
                     ,AR_TRX_BAL            ATB
                     ,DS_CONTR_DTL          DCD
                     ,INV_PRT_CTRL          IPC
                 WHERE
                      SMM.GLBL_CMPY_CD           = #glblCmpyCd#
                  AND SMM.SVC_MACH_MSTR_PK       = #svcMachMstrPk#
                  AND SMM.EZCANCELFLAG           = '0'
                  AND SMM.GLBL_CMPY_CD           = DIL.GLBL_CMPY_CD
                  <!-- START 2018/07/10 K.Kitachi [QC#22788, MOD] -->
                  <!-- AND SMM.SVC_CONFIG_MSTR_PK     = DIL.SVC_CONFIG_MSTR_PK -->
                  AND SMM.SVC_MACH_MSTR_PK       = DIL.SVC_MACH_MSTR_PK
                  <!-- END 2018/07/10 K.Kitachi [QC#22788, MOD] -->
                  AND DIL.EZCANCELFLAG           = '0'
                  AND DIL.GLBL_CMPY_CD           = INV.GLBL_CMPY_CD
                  AND DIL.INV_NUM                = INV.INV_NUM
                  AND INV.EZCANCELFLAG           = '0'
                  AND INV.GLBL_CMPY_CD           = SSR.GLBL_CMPY_CD
                  AND INV.SYS_SRC_CD             = SSR.SYS_SRC_CD
                  AND SSR.EZCANCELFLAG           = '0'
                  AND INV.GLBL_CMPY_CD           = ITP.GLBL_CMPY_CD
                  AND INV.INV_TP_CD              = ITP.INV_TP_CD
                  AND ITP.EZCANCELFLAG           = '0'
                  AND INV.GLBL_CMPY_CD           = BTC.GLBL_CMPY_CD
                  AND INV.BILL_TO_CUST_CD        = BTC.BILL_TO_CUST_CD
                  AND BTC.EZCANCELFLAG           = '0'
                  AND SMM.GLBL_CMPY_CD           = DC1.GLBL_CMPY_CD(+)
                  AND SMM.CPO_ORD_NUM            = DC1.CPO_ORD_NUM(+)
                  AND SMM.SVC_CONFIG_MSTR_PK     = DC1.SVC_CONFIG_MSTR_PK(+)
                  AND DC1.EZCANCELFLAG(+)        = '0'
                  AND DC1.GLBL_CMPY_CD           = ST1.GLBL_CMPY_CD(+)
                  AND DC1.SHIP_TO_CUST_LOC_CD    = ST1.SHIP_TO_CUST_CD(+)
                  AND ST1.EZCANCELFLAG(+)        = '0'
                  AND SMM.GLBL_CMPY_CD           = CPO.GLBL_CMPY_CD(+)
                  AND SMM.CPO_ORD_NUM            = CPO.CPO_ORD_NUM(+)
                  AND CPO.EZCANCELFLAG(+)        = '0'
                  AND CPO.GLBL_CMPY_CD           = ST2.GLBL_CMPY_CD(+)
                  AND CPO.ADD_SHIP_TO_CUST_CD    = ST2.SHIP_TO_CUST_CD(+)
                  AND ST2.EZCANCELFLAG(+)        = '0'
                  AND DIL.GLBL_CMPY_CD           = ATB.GLBL_CMPY_CD(+)
                  AND DIL.INV_NUM                = ATB.AR_TRX_NUM(+)
                  AND ATB.EZCANCELFLAG(+)        = '0'
                  AND DIL.GLBL_CMPY_CD           = DCD.GLBL_CMPY_CD(+)
                  AND DIL.DS_CONTR_DTL_PK        = DCD.DS_CONTR_DTL_PK(+)
                  AND DCD.EZCANCELFLAG(+)        = '0'
                  AND INV.GLBL_CMPY_CD           = IPC.GLBL_CMPY_CD
                  AND INV.INV_NUM                = IPC.INV_NUM
                  AND IPC.EZCANCELFLAG           = '0'
                 ORDER BY
                      INV.INV_NUM
            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getInvHist" class="NSAL0010_LSMsg">
        <result property="invNum_L" column="INV_NUM"  javaType="EZDSStringItem" />
        <result property="sysSrcDescTxt_L" column="SYS_SRC_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="dsContrNum_L" column="DS_CONTR_NUM"  javaType="EZDSStringItem" />
        <result property="locNm_L1" column="BILL_TO_LOC_NM"  javaType="EZDSStringItem" />
        <result property="locNm_L2" column="SHIP_TO_LOC_NM"  javaType="EZDSStringItem" />
        <result property="invTpDescTxt_L" column="INV_TP_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="invTotDealNetAmt_L" column="INV_TOT_DEAL_NET_AMT"  javaType="EZDSBigDecimalItem" />
        <result property="dealRmngBalGrsAmt_L" column="DEAL_RMNG_BAL_GRS_AMT"  javaType="EZDSBigDecimalItem" />
        <result property="xxApplyGrsAmt_L" column="APPL_AMT"  javaType="EZDSBigDecimalItem" />
        <result property="netDueDt_L" column="NET_DUE_DT"  javaType="EZDSDateItem" />
        <result property="cpoOrdNum_L" column="CPO_ORD_NUM"  javaType="EZDSStringItem" />
        <result property="invDt_L" column="INV_DT"  javaType="EZDSDateItem" />
        <result property="acctDt_L" column="ACCT_DT"  javaType="EZDSDateItem" />
        <result property="dsContrPk_L" column="DS_CONTR_PK"  javaType="EZDSBigDecimalItem" />
        <result property="eipRptRqstPk_L" column="EIP_RPT_RQST_PK"  javaType="EZDSBigDecimalItem" />
    </resultMap>

    <statement id="getCurrentVersion" parameterClass="Map" resultClass="BigDecimal">
            SELECT
                 MAX(S.SVC_CONFIG_VRSN_NUM)
            FROM
                 SVC_CONFIG_MSTR_VRSN S
            WHERE
                 S.GLBL_CMPY_CD  =  #glblCmpyCd#
             AND S.SVC_CONFIG_MSTR_PK  = #svcConfigMastrPk#
             AND S.EZCANCELFLAG = '0'
    </statement>

    <statement id="cntPost" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*)
        FROM
            POST POS
        WHERE
                POS.GLBL_CMPY_CD = #glblCmpyCd#
            AND (
                       POS.POST_CD = #postCd#
                    OR POS.POST_CD = SUBSTR(#postCd#, 0, 5)
                )
            AND POS.EZCANCELFLAG = '0'
            AND ROWNUM <![CDATA[ <= ]]> 1
    </statement>

    <statement id="getDsMdl" parameterClass="Map" resultClass="Map">
            SELECT
                 DM.MDL_ID
                ,DM.RGTN_STS_CD
            FROM
                 MDL_MDSE_RELN_V MMRV
                ,DS_MDL DM
            WHERE
                 MMRV.GLBL_CMPY_CD  =  #glblCmpyCd#
             AND MMRV.MDSE_CD  = #mdseCd#
             AND MMRV.EZCANCELFLAG = '0'
             AND MMRV.GLBL_CMPY_CD  = DM.GLBL_CMPY_CD
             AND MMRV.MDL_ID  = DM.MDL_ID
             AND DM.EZCANCELFLAG = '0'
    </statement>

    <statement id="getOrgNm" parameterClass="Map" resultClass="String">
        SELECT
            CASE
                WHEN DSO.ORG_LAYER_NUM = '1' THEN DSO.FIRST_ORG_NM
                WHEN DSO.ORG_LAYER_NUM = '2' THEN DSO.SCD_ORG_NM
                WHEN DSO.ORG_LAYER_NUM = '3' THEN DSO.THIRD_ORG_NM
                WHEN DSO.ORG_LAYER_NUM = '4' THEN DSO.FRTH_ORG_NM
                WHEN DSO.ORG_LAYER_NUM = '5' THEN DSO.FIFTH_ORG_NM
                WHEN DSO.ORG_LAYER_NUM = '6' THEN DSO.SIXTH_ORG_NM
                WHEN DSO.ORG_LAYER_NUM = '7' THEN DSO.SVNTH_ORG_NM
                WHEN DSO.ORG_LAYER_NUM = '8' THEN DSO.EIGHTH_ORG_NM
            END AS ORG_NM
        FROM
            ORG_STRU DSO
        WHERE
            DSO.GLBL_CMPY_CD       = #glblCmpyCd#
        AND DSO.ORG_LAYER_NUM      = #orgLayerNum#
        AND DSO.ORG_STRU_TP_CD     = #orgStruTp#
        AND DSO.EZCANCELFLAG       = '0'
        AND ROWNUM                 = 1
        <isEqual property="orgLayerNum" compareValue="1">
        AND DSO.FIRST_ORG_CD  = #orgCd#
        </isEqual>
        <isEqual property="orgLayerNum" compareValue="2">
        AND DSO.SCD_ORG_CD    = #orgCd#
        </isEqual>
        <isEqual property="orgLayerNum" compareValue="3">
        AND DSO.THIRD_ORG_CD  = #orgCd#
        </isEqual>
        <isEqual property="orgLayerNum" compareValue="4">
        AND DSO.FRTH_ORG_CD   = #orgCd#
        </isEqual>
        <isEqual property="orgLayerNum" compareValue="5">
        AND DSO.FIFTH_ORG_CD  = #orgCd#
        </isEqual>
        <isEqual property="orgLayerNum" compareValue="6">
        AND DSO.SIXTH_ORG_CD  = #orgCd#
        </isEqual>
        <isEqual property="orgLayerNum" compareValue="7">
        AND DSO.SVNTH_ORG_CD  = #orgCd#
        </isEqual>
        <isEqual property="orgLayerNum" compareValue="8">
        AND DSO.EIGHTH_ORG_CD = #orgCd#
        </isEqual>
    </statement>

    <!-- QC1936 -->
    <statement id="getMdlMdseRelnV" parameterClass="Map" resultClass="Map">
        SELECT
             MMRV.MDSE_NM
            ,MMRV.MDL_NM
        FROM
             MDL_MDSE_RELN_V MMRV
        WHERE
             MMRV.GLBL_CMPY_CD  =  #glblCmpyCd#
        AND MMRV.EZCANCELFLAG = '0'
        AND MMRV.MDSE_CD  = #mdseCd#
        AND MMRV.RGTN_STS_CD = 'P20'
        AND MMRV.LTST_IND = 'Y'
    </statement>

    <statement id="countRtrnAssetWh" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(*)
        FROM
             WH W
            ,LOC_USG L
        WHERE
            W.GLBL_CMPY_CD = #glblCmpyCd#
        AND W.WH_CD = #whCd#
        AND W.RGTN_STS_CD = #rgtnStsCd#
        AND W.EZCANCELFLAG = '0'
        AND L.LOC_ROLE_TP_CD = #locRoleTpCd#
        AND W.GLBL_CMPY_CD = L.GLBL_CMPY_CD
        AND W.PTY_LOC_PK = L.PTY_LOC_PK
        AND L.EZCANCELFLAG = '0'
    </statement>
    <statement id="countActiveContract" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(*)
        FROM
             DS_CONTR_DTL D
        WHERE
            D.GLBL_CMPY_CD         = #glblCmpyCd#
        AND D.DS_CONTR_PK          = #dsContrPk#
        AND (D.DS_CONTR_DTL_STS_CD = #ACTV#
         OR D.DS_CONTR_DTL_STS_CD  = #W4FB#)
        AND D.EZCANCELFLAG = '0'
    </statement>
    <statement id="countDsAsstMstr" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(*)
        FROM
             DS_ASSET_MSTR DA
        WHERE
            DA.GLBL_CMPY_CD       = #glblCmpyCd#
        AND DA.MDSE_CD            = #mdseCd#
        AND DA.SER_NUM            = #serNum#
        AND DA.ACTV_ASSET_FLG     = 'Y'
        AND DA.SVC_MACH_MSTR_PK   IS NULL
        AND DA.EZCANCELFLAG = '0'
    </statement>
    <statement id="getConfigInfo" parameterClass="Map" resultClass="Map">
        SELECT
             SCM.SVC_SLN_SQ                      SVC_SLN_SQ
            ,SCM.SVC_CONFIG_MSTR_PK              SVC_CONFIG_MSTR_PK
            ,SMM.MDSE_CD                         MDSE_CD
<!-- START 2016/09/21 N.Arai [QC#11616, MOD] -->
<!--        ,MDS.MDSE_NM                         MDSE_NM        -->
            ,MDS.MDSE_DESC_SHORT_TXT             MDSE_DESC_SHORT_TXT
<!-- END 2016/09/21 N.Arai [QC#11616, MOD] -->
            ,MDN.T_MDL_NM                        T_MDL_NM
            ,SMM.SVC_MACH_MSTR_PK                SVC_MACH_MSTR_PK_1
            ,SCM.SVC_MACH_MSTR_PK                SVC_MACH_MSTR_PK_2
            ,SMM.ISTL_DT                         ISTL_DT
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
            ,DAC1.DS_ACCT_NM                     OWNR_ACCT_NM
            ,DAC2.DS_ACCT_NM                     BILL_TO_ACCT_NM
            ,DAC3.DS_ACCT_NM                     CUR_LOC_ACCT_NM
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
        FROM
             SVC_CONFIG_MSTR    SCM
            ,SVC_MACH_MSTR      SMM
            ,MDSE               MDS
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
            ,SELL_TO_CUST       DAC1
            ,SELL_TO_CUST       DAC2
            ,SELL_TO_CUST       DAC3
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
            ,MDL_NM             MDN
        WHERE
             SCM.GLBL_CMPY_CD           = #glblCmpyCd#
         AND SCM.SVC_CONFIG_MSTR_PK     = #svcConfigMstrPk#
         AND SCM.EZCANCELFLAG           = '0'
         AND SCM.GLBL_CMPY_CD           = SMM.GLBL_CMPY_CD
         AND SCM.SVC_CONFIG_MSTR_PK     = SMM.SVC_CONFIG_MSTR_PK
         AND SMM.EZCANCELFLAG           = '0'
         AND SMM.GLBL_CMPY_CD           = MDS.GLBL_CMPY_CD
         AND SMM.MDSE_CD                = MDS.MDSE_CD
         AND MDS.EZCANCELFLAG           = '0'
<!-- START 2018/10/09 K.Kitachi [QC#28703, MOD] -->
         AND SMM.GLBL_CMPY_CD           = DAC1.GLBL_CMPY_CD(+)
         AND SMM.OWNR_ACCT_NUM          = DAC1.SELL_TO_CUST_CD(+)
         AND DAC1.EZCANCELFLAG(+)       = '0'
         AND SMM.GLBL_CMPY_CD           = DAC2.GLBL_CMPY_CD(+)
         AND SMM.BILL_TO_ACCT_NUM       = DAC2.SELL_TO_CUST_CD(+)
         AND DAC2.EZCANCELFLAG(+)       = '0'
         AND SMM.GLBL_CMPY_CD           = DAC3.GLBL_CMPY_CD(+)
         AND SMM.CUR_LOC_ACCT_NUM       = DAC3.SELL_TO_CUST_CD(+)
         AND DAC3.EZCANCELFLAG(+)       = '0'
<!-- END 2018/10/09 K.Kitachi [QC#28703, MOD] -->
         AND SCM.GLBL_CMPY_CD           = MDN.T_GLBL_CMPY_CD(+)
         AND SCM.MDL_ID                 = MDN.T_MDL_ID(+)
         AND MDN.EZCANCELFLAG(+)        = '0'
        ORDER BY
            SMM.SVC_MACH_MSTR_PK
    </statement>
    <statement id="getOpenOrder" parameterClass="Map" resultClass="String">
        SELECT
            B.CPO_ORD_NUM
        FROM
            SVC_MACH_MSTR A
            ,CPO_DTL B
        WHERE
            A.GLBL_CMPY_CD          = #glblCmpyCd#
        AND A.EZCANCELFLAG          = '0'
        AND A.SVC_MACH_MSTR_PK      = #svcMachMstrPk#
        AND A.GLBL_CMPY_CD          = B.GLBL_CMPY_CD
        AND B.EZCANCELFLAG          = '0'
        AND A.CPO_ORD_NUM           = B.CPO_ORD_NUM
        AND A.CPO_DTL_LINE_NUM      = B.CPO_DTL_LINE_NUM
        AND A.CPO_DTL_LINE_SUB_NUM  = B.CPO_DTL_LINE_SUB_NUM
        AND B.ORD_LINE_STS_CD       NOT IN (#closed#, #cancelled#)

    </statement>
    <statement id="getDsContrDtlCtrlSts" parameterClass="Map" resultClass="Map">
        SELECT
             A.DS_CONTR_CTRL_STS_CD
            ,B.DS_CONTR_NUM
        FROM
             DS_CONTR_DTL_STS_V A
            ,DS_CONTR           B
        WHERE
            A.GLBL_CMPY_CD      = #glblCmpyCd#
        AND A.EZCANCELFLAG      = '0'
        AND A.DS_CONTR_DTL_PK   = #dsContrDtlPk#
        AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD
        AND A.DS_CONTR_PK       = B.DS_CONTR_PK
        AND B.EZCANCELFLAG      = '0'
    </statement>
<!-- START 2016/02/04 T.Tomita [QC#3312, ADD] -->
    <statement id="countSvcMachMstr" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            SVC_MACH_MSTR   SMM
        WHERE
                SMM.GLBL_CMPY_CD      = #glblCmpyCd#
            AND SMM.SER_NUM        LIKE #serNum#
            AND SMM.EZCANCELFLAG      = '0'
    </statement>
<!-- END 2016/02/04 T.Tomita [QC#3312, ADD] -->
    <statement id="getCtacPsnPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            B.CTAC_PSN_PK
        FROM
            CTAC_PSN    B
        WHERE
            B.GLBL_CMPY_CD = #glblCmpyCd#
        AND B.CTAC_PSN_NUM = #ctacPsnNum#
        AND B.EZCANCELFLAG = '0'

    </statement>
<!-- START 2016/03/28 M.Gotou [QC#4888, ADD] -->
    <statement id="countRtlSWH" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            RTL_SWH RS
        WHERE
                RS.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND RS.INVTY_LOC_CD                  = #invtyLocCd#
            AND RS.RTL_SWH_DSBL_FLG              = 'N'
            AND RS.EFF_FROM_DT               &lt;= #slsDt#
            AND NVL(RS.EFF_THRU_DT, #endDt#) &gt;= #slsDt#
            AND RS.EZCANCELFLAG                  = '0'
            AND ROWNUM                           = 1
    </statement>
<!-- END 2016/03/28 M.Gotou [QC#4888, ADD] -->
<!-- START 2016/04/20 T.Tomita [QC#4892, ADD] -->
    <statement id="getSvcLineBiz" parameterClass="Map" resultClass="Map">
        SELECT
             A.LINE_BIZ_TP_CD           LINE_BIZ_TP_CD
            ,A.LINE_BIZ_TP_DESC_TXT     LINE_BIZ_TP_DESC_TXT
        FROM
             LINE_BIZ_TP          A
            ,AVAL_LINE_BIZ_TP_SRC B
        WHERE
                A.GLBL_CMPY_CD         = #glblCmpyCd#
            AND A.EZCANCELFLAG         = '0'
            AND A.GLBL_CMPY_CD         = B.GLBL_CMPY_CD
            AND A.LINE_BIZ_TP_CD       = B.LINE_BIZ_TP_CD
            AND B.SYS_SRC_CD           = #sysSrcCd#
            AND B.EZCANCELFLAG         = '0'
        ORDER BY
            A.LINE_BIZ_TP_SORT_NUM
    </statement>
<!-- END 2016/04/20 T.Tomita [QC#4892, ADD] -->
<!-- START 2016/04/25 T.Tomita [QC#6672, ADD] -->
    <statement id="getEffDtInfo" parameterClass="Map" resultClass="Map">
        SELECT
             DCPR.CTAC_PSN_PK
            ,MIN(DCPR.EFF_FROM_DT) AS EFF_FROM_DT
            ,MAX(DCPR.EFF_THRU_DT) AS EFF_THRU_DT
        FROM
            (
                SELECT
                     A.CTAC_PSN_PK
                    ,NVL(A.EFF_FROM_DT, #slsDt#) AS EFF_FROM_DT
                    ,NVL(A.EFF_THRU_DT, #endDt#) AS EFF_THRU_DT
                FROM
                    DS_CTAC_PSN_RELN A
                WHERE
                        A.GLBL_CMPY_CD = #glblCmpyCd#
                    AND A.CTAC_PSN_PK  = #ctacPsnPk#
                    AND (
                        <isNotNull property="dsAcctNum">
                            A.DS_ACCT_NUM  = #dsAcctNum#
                        </isNotNull>
                        <isNotNull property="locNum">
                            <isNotNull property="dsAcctNum">
                            OR
                            </isNotNull>
                            A.LOC_NUM      = #locNum#
                        </isNotNull>
                        )
                    AND A.EZCANCELFLAG = '0'
            ) DCPR
        GROUP BY
             DCPR.CTAC_PSN_PK
    </statement>
<!-- END 2016/04/25 T.Tomita [QC#6672, ADD] -->
<!-- START 2016/08/08 T.Tomita [QC#7794, ADD] -->
    <statement id="getCtacInfo" parameterClass="Map" resultClass="Map">
        SELECT
             SMC.SVC_MACH_CTAC_PSN_PK AS SVC_MACH_CTAC_PSN_PK
            ,CPN.CTAC_PSN_LAST_NM     AS CTAC_PSN_LAST_NM
            ,CPN.CTAC_PSN_FIRST_NM    AS CTAC_PSN_FIRST_NM
            ,DCP.DS_CTAC_PNT_TP_CD    AS DS_CTAC_PNT_TP_CD
            ,DCP.DS_CTAC_PNT_VAL_TXT  AS DS_CTAC_PNT_VAL_TXT
            ,DCP.DS_CTAC_PSN_EXTN_NUM AS DS_CTAC_PSN_EXTN_NUM
            ,SMC.SVC_CTAC_TP_CD       AS SVC_CTAC_TP_CD
            ,SMC.EFF_FROM_DT          AS EFF_FROM_DT
            ,SMC.EFF_THRU_DT          AS EFF_THRU_DT
        FROM
             SVC_MACH_CTAC_PSN SMC
            ,DS_CTAC_PNT       DCP
            ,CTAC_PSN          CPN
        WHERE
                SMC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND SMC.SVC_MACH_MSTR_PK     = #svcMachMstrPk#
            AND SMC.EZCANCELFLAG         = '0'
            AND SMC.GLBL_CMPY_CD         = DCP.GLBL_CMPY_CD   (+)
            AND SMC.DS_CTAC_PNT_PK       = DCP.DS_CTAC_PNT_PK (+)
            AND DCP.EZCANCELFLAG     (+) = '0'
            AND DCP.GLBL_CMPY_CD         = CPN.GLBL_CMPY_CD   (+)
            AND DCP.CTAC_PSN_PK          = CPN.CTAC_PSN_PK    (+)
            AND CPN.EZCANCELFLAG     (+) = '0'
    </statement>
<!-- END 2016/08/08 T.Tomita [QC#7794, ADD] -->

    <!-- START 08/10/2016 Y.Imazu QC12496 -->
    <statement id="getSvcIstlReqFlg" parameterClass="Map" resultClass="String">
        SELECT
            DM.SVC_ISTL_REQ_FLG
        FROM
            SVC_MACH_MSTR   SMM
           ,SVC_CONFIG_MSTR SCM
           ,DS_MDL          DM
        WHERE
            SMM.GLBL_CMPY_CD       = #glblCmpyCd#
        AND SMM.SVC_MACH_MSTR_PK   = #svcMachMstrPk#
        AND SMM.EZCANCELFLAG       = '0'
        AND SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD
        AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK
        AND SCM.EZCANCELFLAG       = '0'
        AND SCM.GLBL_CMPY_CD       = DM.GLBL_CMPY_CD
        AND SCM.MDL_ID             = DM.MDL_ID
        AND DM.EZCANCELFLAG        = '0'
    </statement>
    <!-- END 08/10/2016 Y.Imazu QC12496 -->

    <!-- START 2016/12/14 K.Kojima [QC#15653,ADD] -->
    <statement id="getTechMstr" parameterClass="Map" resultClass="String">
        SELECT
            TM.TECH_TOC_CD
        FROM
             TECH_MSTR TM
        WHERE
                TM.GLBL_CMPY_CD                   = #glblCmpyCd#
            AND TM.TECH_TOC_CD                    = #techTocCd#
            AND TM.EZCANCELFLAG                   = '0'
            AND EXISTS(
                SELECT
                    1
                FROM
                     ORG_FUNC_ASG     OFA
                    ,TOC              T
                    ,ORG_FUNC_ROLE_TP OFRT
                WHERE
                        OFA.GLBL_CMPY_CD                  = TM.GLBL_CMPY_CD
                    AND OFA.PSN_CD                        = TM.TECH_TOC_CD
                    AND OFA.EFF_FROM_DT               &lt;= #slsDt#
                    AND NVL(OFA.EFF_THRU_DT, #maxDt#) &gt;= #slsDt#
                    AND OFA.GLBL_CMPY_CD                  = T.GLBL_CMPY_CD
                    AND OFA.TOC_CD                        = T.TOC_CD
                    AND T.GLBL_CMPY_CD                    = OFRT.GLBL_CMPY_CD
                    AND T.ORG_FUNC_ROLE_TP_CD             = OFRT.ORG_FUNC_ROLE_TP_CD
                    AND OFRT.TECH_MSTR_REQ_FLG            = #flgY#
                    AND OFRT.ACTV_FLG                     = #flgY#
                    AND OFA.EZCANCELFLAG                  = '0'
                    AND T.EZCANCELFLAG                    = '0'
                    AND OFRT.EZCANCELFLAG                 = '0'
            )
    </statement>
    <!-- END 2016/12/14 K.Kojima [QC#15653,ADD] -->
    <statement id="getSvcMachMstrSts" parameterClass="Map" resultClass="Map">
        SELECT
             A.SVC_MACH_MSTR_STS_CD
            ,A.SVC_MACH_MSTR_STS_DESC_TXT
        FROM
            SVC_MACH_MSTR_STS A
        WHERE
            A.GLBL_CMPY_CD = #glblCmpyCd#
        AND A.EZCANCELFLAG = '0'
        <iterate property="svcMachMstrStsCdList" var="svcMachMstrStsCd[]" open="AND A.SVC_MACH_MSTR_STS_CD IN (" close=")" conjunction=",">
        #svcMachMstrStsCd[]#
        </iterate>
        ORDER BY
            SVC_MACH_MSTR_STS_SORT_NUM
    </statement>
    <statement id="getSvcMachUsgSts" parameterClass="Map" resultClass="Map">
        SELECT
             A.SVC_MACH_USG_STS_CD
            ,A.SVC_MACH_USG_STS_DESC_TXT
        FROM
            SVC_MACH_USG_STS A
        WHERE
            A.GLBL_CMPY_CD = #glblCmpyCd#
        AND A.EZCANCELFLAG = '0'
        <iterate property="svcMachUsgStsCdList" var="svcMachUsgStsCd[]" open="AND A.SVC_MACH_USG_STS_CD IN (" close=")" conjunction=",">
        #svcMachUsgStsCd[]#
        </iterate>
        ORDER BY
            SVC_MACH_USG_STS_SORT_NUM
    </statement>
    <!-- START 2018/05/28 K.Kitachi [QC#19932, ADD] -->
    <statement id="getSvcMachMstrQty" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            NVL(SUM(A.SVC_MACH_QTY), 0)
        FROM
            SVC_MACH_MSTR A
        WHERE
                A.GLBL_CMPY_CD             = #glblCmpyCd#
            <isNotNull property="serNum">
            AND A.SER_NUM                  = #serNum#
            </isNotNull>
            AND A.MDSE_CD                  = #mdseCd#
            AND A.IND_CUR_LOC_NUM          = #invtyLocCd#
            AND A.SVC_MACH_MSTR_LOC_STS_CD = #locStsCd#
            AND A.STK_STS_CD               = #stkStsCd#
            <iterate property="svcMachMstrStsCdList" var="svcMachMstrStsCd[]" open="AND A.SVC_MACH_MSTR_STS_CD IN (" close=")" conjunction=",">
                #svcMachMstrStsCd[]#
            </iterate>
            AND A.EZCANCELFLAG             = '0'
    </statement>
    <statement id="getInvtyDtlDlyQty" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            NVL(SUM(A.INVTY_QTY), 0)
        FROM
            INVTY_DTL_DLY A
        WHERE
                A.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="serNum">
            AND A.SER_NUM      = #serNum#
            </isNotNull>
            AND A.MDSE_CD      = #mdseCd#
            AND A.INVTY_LOC_CD = #invtyLocCd#
            AND A.LOC_STS_CD   = #locStsCd#
            AND A.STK_STS_CD   = #stkStsCd#
            AND A.EZCANCELFLAG = '0'
    </statement>
    <!-- END 2018/05/28 K.Kitachi [QC#19932, ADD] -->
    <!-- START 2018/06/05 T.Tomita [QC#23428, ADD] -->
    <statement id="cntExchOrd" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
             SVC_MACH_MSTR     A
            ,CPO               B
            ,DS_ORD_TP         C
            ,ORD_CATG_BIZ_CTX  D
        WHERE
            A.GLBL_CMPY_CD       =  #glblCmpyCd#
        AND A.EZCANCELFLAG       =  '0'
        AND A.SVC_MACH_MSTR_PK   =  #svcMachMstrPk#
        AND A.GLBL_CMPY_CD       =  B.GLBL_CMPY_CD
        AND A.CPO_ORD_NUM        =  B.CPO_ORD_NUM
        AND B.EZCANCELFLAG       =  '0'
        <iterate property="ordHdrStsCdList" var="ordHdrStsCd[]" open="AND B.ORD_HDR_STS_CD NOT IN (" close=")" conjunction=",">
            #ordHdrStsCd[]#
        </iterate>
        AND B.GLBL_CMPY_CD       =  C.GLBL_CMPY_CD
        AND B.DS_ORD_TP_CD       =  C.DS_ORD_TP_CD
        AND C.EZCANCELFLAG       =  '0'
        AND C.GLBL_CMPY_CD       =  D.GLBL_CMPY_CD
        AND C.DS_ORD_CATG_CD     =  D.DS_ORD_CATG_CD
        <!-- START 2019/06/17 W.Honda [QC#50842, ADD] -->
        AND (C.DS_ORD_TP_CD      =  D.DS_ORD_TP_CD
            OR  D.DS_ORD_TP_CD   IS NULL)
        <!-- END 2019/06/17 W.Honda [QC#50842, ADD] -->
        AND D.EZCANCELFLAG       =  '0'
        AND D.ORD_CATG_CTX_TP_CD =  #ordCatgCtxTpCd#
        AND NOT EXISTS (
            SELECT
                *
            FROM
                DS_CONTR_INTFC Z
            WHERE
                Z.GLBL_CMPY_CD           =  A.GLBL_CMPY_CD
            AND Z.SVC_MACH_MSTR_PK       =  A.SVC_MACH_MSTR_PK
            AND Z.EZCANCELFLAG           =  '0'
            AND Z.CONTR_INTFC_SRC_TP_CD  =  #contrIntfcSrcTpCd#
            AND Z.DS_CONTR_INTFC_ACT_CD  =  #dsContrIntfcActCd#
            )
    </statement>
    <!-- END 2018/06/05 T.Tomita [QC#23428, ADD] -->
    <!-- START 2018/08/23 K.Kitachi [QC#27773, ADD] -->
    <statement id="countMdse" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
             MDSE         DMI
            ,SVC_WTY_TP   SWT
        WHERE
                DMI.GLBL_CMPY_CD  = #glblCmpyCd#
            AND DMI.MDSE_CD       = #mdseCd#
            AND DMI.EZCANCELFLAG  = '0'
            AND DMI.GLBL_CMPY_CD  = SWT.GLBL_CMPY_CD
            AND DMI.SVC_WTY_TP_CD = SWT.SVC_WTY_TP_CD
            AND SWT.STD_WTY_FLG   = 'Y'
            AND SWT.EZCANCELFLAG  = '0'
    </statement>
    <statement id="getDsContrWty" parameterClass="Map" resultClass="Map">
        SELECT
             DCH.DS_CONTR_NUM
            ,DCH.SVC_CONTR_REF_CMNT_TXT
        FROM
             SVC_MACH_MSTR SMM
            ,DS_CONTR_DTL  DCD
            ,DS_CONTR      DCH
        WHERE
                SMM.GLBL_CMPY_CD                                 = #glblCmpyCd#
            AND SMM.SVC_CONFIG_MSTR_PK                           = #svcConfigMstrPk#
            AND SMM.EZCANCELFLAG                                 = '0'
            AND SMM.GLBL_CMPY_CD                                 = DCD.GLBL_CMPY_CD
            AND SMM.SVC_MACH_MSTR_PK                             = DCD.SVC_MACH_MSTR_PK
            AND NVL(DCD.CONTR_CLO_DT, DCD.CONTR_EFF_THRU_DT) &gt;= #slsDt#
            <iterate property="dsContrCtrlStsCdList" var="dsContrCtrlStsCdList[]" open="AND DCD.DS_CONTR_DTL_STS_CD NOT IN (" close=")" conjunction=",">
                #dsContrCtrlStsCdList[]#
            </iterate>
            AND DCD.EZCANCELFLAG                                 = '0'
            AND DCD.GLBL_CMPY_CD                                 = DCH.GLBL_CMPY_CD
            AND DCD.DS_CONTR_PK                                  = DCH.DS_CONTR_PK
            AND DCH.DS_CONTR_CATG_CD                             = #dsContrCatgCd#
            AND DCH.EZCANCELFLAG                                 = '0'
    </statement>
    <statement id="getDsContrIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM
        FROM
             SVC_MACH_MSTR  SMM
            ,DS_CONTR_INTFC DCI
        WHERE
                SMM.GLBL_CMPY_CD                = #glblCmpyCd#
            AND SMM.SVC_CONFIG_MSTR_PK          = #svcConfigMstrPk#
            AND SMM.EZCANCELFLAG                = '0'
            AND SMM.GLBL_CMPY_CD                = DCI.GLBL_CMPY_CD
            AND SMM.SVC_MACH_MSTR_PK            = DCI.SVC_MACH_MSTR_PK
            AND DCI.DS_CONTR_CATG_CD            = #dsContrCatgCd#
            AND DCI.DS_CONTR_PROC_STS_CD &lt;&gt; #dsContrProcStsCd#
            AND DCI.EZCANCELFLAG                = '0'
    </statement>
    <statement id="countDsContrWtyForAcc" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
             DS_CONTR     DCH
            ,DS_CONTR_DTL DCD
        WHERE
                DCH.GLBL_CMPY_CD                                 = #glblCmpyCd#
            AND DCH.DS_CONTR_NUM                                 = #dsContrNum#
            AND DCH.EZCANCELFLAG                                 = '0'
            AND DCH.GLBL_CMPY_CD                                 = DCD.GLBL_CMPY_CD
            AND DCH.DS_CONTR_PK                                  = DCD.DS_CONTR_PK
            AND DCD.SVC_MACH_MSTR_PK                             = #svcMachMstrPk#
            AND NVL(DCD.CONTR_CLO_DT, DCD.CONTR_EFF_THRU_DT) &gt;= #slsDt#
            <iterate property="dsContrCtrlStsCdList" var="dsContrCtrlStsCdList[]" open="AND DCD.DS_CONTR_DTL_STS_CD NOT IN (" close=")" conjunction=",">
                #dsContrCtrlStsCdList[]#
            </iterate>
            AND DCD.EZCANCELFLAG                                 = '0'
    </statement>
    <statement id="countDsContrIntfcForAcc" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            DS_CONTR_INTFC DCI
        WHERE
                DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM        = #dsContrSrcRefNum#
            AND DCI.SVC_MACH_MSTR_PK            = #svcMachMstrPk#
            AND DCI.DS_CONTR_PROC_STS_CD &lt;&gt; #dsContrProcStsCd#
            AND DCI.EZCANCELFLAG                = '0'
    </statement>
    <!-- END 2018/08/23 K.Kitachi [QC#27773, ADD] -->
    <!-- START 2021/08/17 R.Cabral [QC#59010, ADD] -->
    <statement id="checkTransitionFlags" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(DCC.DS_COND_CONST_GRP_ID)
        FROM
            DS_COND_CONST DCC
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.DS_COND_CONST_GRP_ID = #trxTpUpdateMap#
            AND (
                (
                        DCC.DS_COND_CONST_VAL_TXT_01 = #allText#
                    AND DCC.DS_COND_CONST_VAL_TXT_02 = #allText#
                )
                OR (
                        DCC.DS_COND_CONST_VAL_TXT_01 = #beforeValue#
                    AND DCC.DS_COND_CONST_VAL_TXT_02 = #allText#
                )
                OR (
                        DCC.DS_COND_CONST_VAL_TXT_01 = #allText#
                    AND DCC.DS_COND_CONST_VAL_TXT_02 = #afterValue#
                )
                OR (
                        DCC.DS_COND_CONST_VAL_TXT_01 = #beforeValue#
                    AND DCC.DS_COND_CONST_VAL_TXT_02 = #afterValue#
                )
            )
            AND DCC.EZCANCELFLAG         = '0'
    </statement>
    <!-- END 2021/08/17 R.Cabral [QC#59010, ADD] -->
    <!-- START 2023/10/06 K.Ishizuka [QC#54186, ADD] -->
    <statement id ="getSvcPrvdPty" parameterClass="Map"  resultClass="Map">
        SELECT 
            SPP.SVC_PRVD_PTY_CD
            , SPP.SVC_PRVD_PTY_DESC_TXT
            , SPP.LINE_BIZ_TP_CD
        FROM 
            SVC_PRVD_PTY     SPP
        WHERE 
                SPP.EZCANCELFLAG          = '0'
            AND SPP.GLBL_CMPY_CD          = #glblCmpyCd#
            <isNotNull property="toBeIstlByFlg">
            AND SPP.TO_BE_ISTL_BY_FLG     = #toBeIstlByFlg#
            </isNotNull>
            <isNotNull property="svcPrvdByFlg">
            AND SPP.SVC_PRVD_BY_FLG       = #svcPrvdByFlg#
            </isNotNull>             
            <isNotNull property="svcPrvdPtyCd">
            AND SPP.SVC_PRVD_PTY_CD       = #svcPrvdPtyCd#
            </isNotNull>
    </statement>
    <!-- END 2023/10/06 K.Ishizuka [QC#54186, ADD] -->
    <!-- START 2023/12/19 T.Fukuta [CSA-QC#61841,ADD] -->
    <statement id="countLocStsMndFlgByStsCd" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*) COUNT
        FROM
            SVC_MACH_MSTR_STS A
        WHERE
                A.GLBL_CMPY_CD         = #glblCmpyCd#
            AND A.EZCANCELFLAG         = '0'
            AND A.LOC_STS_MND_FLG      = #locStsMndFlg#
            AND A.SVC_MACH_MSTR_STS_CD = #svcMachMstrStsCd#
    </statement>
    <!-- END 2023/12/19 T.Fukuta [CSA-QC#61841,ADD] -->
</sqlMap>
