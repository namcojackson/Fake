<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSBB083001">
    <statement id="getInputData" parameterClass="Map" resultClass="Map">
        SELECT
             A.DS_CONTR_NUM                     AS DS_CONTR_NUM
            ,D.SVC_CONFIG_MSTR_PK               AS SVC_CONFIG_MSTR_PK
            ,F.MDL_GRP_NM                       AS MDL_GRP_NM
            ,B.MDL_NM                           AS MDL_NM
            ,B.SER_NUM                          AS SER_NUM
            ,SUBSTR(A.INV_DT,1,6)               AS INV_YR_MTH
        FROM
             SVC_INV              A
            ,SVC_INV_LINE         B
            ,SVC_MACH_MSTR        C
            ,SVC_CONFIG_MSTR      D
            ,DS_MDL               E
            ,DS_MDL_GRP           F
            ,DS_CONTR_DTL         G
            ,DS_CONTR_DTL_TP      H
            ,DS_CONTR_BLLG_MTR    I
            ,CONTR_XS_COPY        J
        WHERE
                B.GLBL_CMPY_CD             = #glblCmpyCd#
            AND B.GLBL_CMPY_CD             = A.GLBL_CMPY_CD
            AND B.SVC_INV_NUM              = A.SVC_INV_NUM
            AND B.GLBL_CMPY_CD             = C.GLBL_CMPY_CD
            AND B.SVC_MACH_MSTR_PK         = C.SVC_MACH_MSTR_PK
            AND C.EZUPTIME             &gt; TO_CHAR(TO_TIMESTAMP(ADD_MONTHS(LAST_DAY(TO_DATE(#slsDt#, 'YYYYMMDD')), #addMonth#)), 'YYYYMMDDHH24MISSFF3')
            AND C.EZUPTIME             &lt; TO_CHAR(TO_TIMESTAMP(TO_DATE(#slsDt#, 'YYYYMMDD') + 1), 'YYYYMMDDHH24MISSFF3')
            AND B.GLBL_CMPY_CD             = D.GLBL_CMPY_CD
            AND B.SVC_MACH_MSTR_PK         = D.SVC_MACH_MSTR_PK
            AND D.GLBL_CMPY_CD             = E.GLBL_CMPY_CD
            AND D.MDL_ID                   = E.MDL_ID
            AND E.GLBL_CMPY_CD             = F.GLBL_CMPY_CD
            AND E.MDL_GRP_ID               = F.MDL_GRP_ID
            AND B.GLBL_CMPY_CD             = G.GLBL_CMPY_CD
            AND B.DS_CONTR_DTL_PK          = G.DS_CONTR_DTL_PK
            AND G.GLBL_CMPY_CD             = H.GLBL_CMPY_CD
            AND G.DS_CONTR_DTL_TP_CD       = H.DS_CONTR_DTL_TP_CD
            AND G.GLBL_CMPY_CD             = I.GLBL_CMPY_CD
            AND G.DS_CONTR_DTL_PK          = I.DS_CONTR_DTL_PK
            AND I.GLBL_CMPY_CD             = J.GLBL_CMPY_CD
            AND I.DS_CONTR_BLLG_MTR_PK     = J.DS_CONTR_BLLG_MTR_PK
            AND A.EZCANCELFLAG             = '0'
            AND B.EZCANCELFLAG             = '0'
            AND C.EZCANCELFLAG             = '0'
            AND D.EZCANCELFLAG             = '0'
            AND E.EZCANCELFLAG             = '0'
            AND F.EZCANCELFLAG             = '0'
            AND G.EZCANCELFLAG             = '0'
            AND H.EZCANCELFLAG             = '0'
            AND I.EZCANCELFLAG             = '0'
            AND J.EZCANCELFLAG             = '0'
        ORDER BY
             A.DS_CONTR_NUM
            ,D.SVC_CONFIG_MSTR_PK
            ,B.SER_NUM
            ,G.DS_CONTR_DTL_PK
    </statement>
</sqlMap>
