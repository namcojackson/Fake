<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NWZC169001">

    <statement id="getQuoteHeader" parameterClass="Map"  resultClass="Map">
    SELECT
         CASE WHEN SQRC.FIRST_LINE_ADDR IS NOT NULL THEN
              (SQRC.FIRST_LINE_ADDR
              || SQRC.SCD_LINE_ADDR
              || SQRC.THIRD_LINE_ADDR
              || SQRC.FRTH_LINE_ADDR
              || DECODE(SQRC.CTY_ADDR, NULL, ' ', ', ')
              ||  SQRC.CTY_ADDR || DECODE(SQRC.ST_CD, NULL, ' ', ', ')
              || SQRC.ST_CD
              || ' '
              || SQRC.POST_CD)
              ELSE NULL END AS GLBL_FULL_CMPY_ADDR
         ,'Quote Confirmation' AS RPT_TTL_TXT
         ,SQ.SPLY_QUOTE_NUM AS TRX_HDR_NUM
         ,TO_CHAR(TO_DATE(SQ.SPLY_QUOTE_DT, 'YYYY/MM/DD'), 'MM/DD/YYYY') AS TRX_DT_TXT
         ,TO_CHAR(TO_DATE(SQ.SPLY_QUOTE_VLD_THRU_DT, 'YYYY/MM/DD'), 'MM/DD/YYYY') AS SPLY_QUOTE_VLD_THRU_DT_TXT
         ,SQ.CUST_ISS_PO_NUM AS CUST_ISS_PO_NUM
         ,PT.PMT_TERM_CASH_DISC_DESC_TXT AS PMT_TERM_CASH_DISC_DESC_TXT
         ,AP.FIRST_NM || ' ' || AP.LAST_NM AS FULL_ADMIN_PSN_NM
         ,FC.FRT_COND_NM AS FRT_COND_NM
         ,CASE WHEN SQ.FRT_COND_CD = #frtCondCd# THEN CSL.CARR_SVC_LVL_NM
               ELSE SSL.SHPG_SVC_LVL_NM END AS SVC_LVL_RPT_NM
         <!-- 2017/10/23 J.Kim [QC#21117,MOD] -->
         <!-- ,SQ.SHIP_TO_01_REF_CMNT_TXT AS SHIP_TO_01_REF_CMNT_TXT -->
         <!-- ,SQ.SHIP_TO_02_REF_CMNT_TXT AS SHIP_TO_02_REF_CMNT_TXT -->
         ,SQ.SHPG_CMNT_TXT AS SHPG_CMNT_TXT
         ,SQ.SELL_TO_CUST_CD AS SELL_TO_CUST_CD
         <!-- 2018/02/02 S21_NA#23881 Mod Start -->
         <!-- ,DAC1.DS_ACCT_NM AS SELL_TO_LOC_NM -->
         ,DAC1.LOC_NM AS SELL_TO_LOC_NM
         <!-- 2018/02/02 S21_NA#23881 Mod End -->
         ,CASE WHEN SEBTC.FIRST_LINE_ADDR IS NOT NULL THEN
               SEBTC.FIRST_LINE_ADDR || ' '
               || SEBTC.SCD_LINE_ADDR || ' '
               || SEBTC.THIRD_LINE_ADDR || ' '
               || SEBTC.FRTH_LINE_ADDR
               ELSE NULL END AS SELL_TO_ADDR_01
         ,SEBTC.CTY_ADDR || DECODE(SEBTC.ST_CD, NULL, ' ', ', ') || SEBTC.ST_CD || ' ' || SEBTC.POST_CD AS SELL_TO_ADDR_02
         ,C_CTAC.CTAC_PSN_NM AS FULL_CTAC_PSN_NM
         ,'Tel' AS CTAC_RPT_TTL_TXT
         ,C_CTAC.DS_CTAC_PNT_VAL_TXT AS DS_CTAC_PNT_VAL_TXT
         ,SQ.BILL_TO_CUST_ACCT_CD AS BILL_TO_CUST_CD
         <!-- 2018/02/02 S21_NA#23881 Mod Start -->
         ,DAC2.LOC_NM AS BILL_TO_LOC_NM
         <!-- 2018/02/02 S21_NA#23881 Mod End -->
         ,CASE WHEN BTC.FIRST_LINE_ADDR IS NOT NULL THEN 
               BTC.FIRST_LINE_ADDR || ' '
               || BTC.SCD_LINE_ADDR || ' '
               || BTC.THIRD_LINE_ADDR || ' '
               || BTC.FRTH_LINE_ADDR
               ELSE NULL END AS BILL_TO_ADDR_01
         ,BTC.CTY_ADDR || DECODE(BTC.ST_CD, NULL, ' ', ', ') || BTC.ST_CD || ' ' || BTC.POST_CD AS BILL_TO_ADDR_02
         ,SQ.SHIP_TO_CUST_ACCT_CD AS SHIP_TO_CUST_CD
         <!-- 2017/08/02 S21_NA#20331 Mod Start -->
         -- ,DAC3.DS_ACCT_NM AS SHIP_TO_LOC_NM
         <!-- 2018/02/02 S21_NA#23881 Mod Start -->
         <!-- ,CASE WHEN SQ.DROP_SHIP_FLG = 'Y' THEN -->
         <!--        DECODE(SQ.SHIP_TO_LOC_NM, NULL, DAC3.DS_ACCT_NM, SQ.SHIP_TO_LOC_NM) || DECODE(SQ.SHIP_TO_ADDL_LOC_NM, NULL, '', CHR(13) || CHR(10) || SQ.SHIP_TO_ADDL_LOC_NM) -->
         <!--       ELSE -->
         <!--        DAC3.DS_ACCT_NM -->
         <!-- END AS SHIP_TO_LOC_NM -->
         ,CASE WHEN SQ.DROP_SHIP_FLG = 'Y' THEN
                DECODE(SQ.SHIP_TO_LOC_NM, NULL, DAC3.LOC_NM, SQ.SHIP_TO_LOC_NM) || DECODE(SQ.SHIP_TO_ADDL_LOC_NM, NULL, '', CHR(13) || CHR(10) || SQ.SHIP_TO_ADDL_LOC_NM)
               ELSE
                DAC3.LOC_NM
         END AS SHIP_TO_LOC_NM
         <!-- 2018/02/02 S21_NA#23881 Mod End -->
         <!-- 2017/08/02 S21_NA#20331 Mod End -->
         ,SQ.SHIP_TO_FIRST_LINE_ADDR || ' ' || SQ.SHIP_TO_SCD_LINE_ADDR || ' ' || SQ.SHIP_TO_THIRD_LINE_ADDR || ' ' || SQ.SHIP_TO_FRTH_LINE_ADDR AS SHIP_TO_ADDR_01
         ,SQ.SHIP_TO_CTY_ADDR || ', ' || SQ.SHIP_TO_ST_CD || ' ' || SQ.SHIP_TO_POST_CD AS SHIP_TO_ADDR_02
         ,CONCAT (SQD.DPLY_QUOTE_LINE_NUM,
                  DECODE (SQD.DPLY_QUOTE_LINE_SUB_NUM, NULL, '', '.'))
                  || SQD.DPLY_QUOTE_LINE_SUB_NUM AS CPO_WRK_LINE_NUM
         ,SQD.MDSE_CD AS MDSE_CD
         ,DMI.MNF_ITEM_CD AS MNF_ITEM_CD
         ,DMI.MDSE_DESC_SHORT_TXT AS MDSE_DESC_SHORT_TXT
         ,NVL(DMSP1.BASE_PKG_UOM_CD, DMSP2.BASE_PKG_UOM_CD) AS PKG_UOM_CD
         ,TO_CHAR(SQD.ORD_QTY, 'FM9,999,999,990') AS ORD_QTY_TXT
         ,SQD.ORD_QTY AS ORD_QTY
         ,SQD.DEAL_PRC_LIST_PRC_AMT AS PRC_LIST_PRC_AMT
         ,SQD.DEAL_NET_UNIT_PRC_AMT AS NET_UNIT_PRC_AMT
         ,SQ.SPLY_QUOTE_CMNT_TXT AS SPLY_QUOTE_CMNT_TXT
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_01 AS SPLY_QUOTE_RPT_NOTE_TXT_01
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_02 AS SPLY_QUOTE_RPT_NOTE_TXT_02
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_03 AS SPLY_QUOTE_RPT_NOTE_TXT_03
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_04 AS SPLY_QUOTE_RPT_NOTE_TXT_04
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_05 AS SPLY_QUOTE_RPT_NOTE_TXT_05
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_06 AS SPLY_QUOTE_RPT_NOTE_TXT_06
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_07 AS SPLY_QUOTE_RPT_NOTE_TXT_07
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_08 AS SPLY_QUOTE_RPT_NOTE_TXT_08
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_09 AS SPLY_QUOTE_RPT_NOTE_TXT_09
         ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_10 AS SPLY_QUOTE_RPT_NOTE_TXT_10
         ,(
           SELECT
               VCC.VAR_CHAR_CONST_VAL
           FROM
               VAR_CHAR_CONST VCC
           WHERE
               VCC.GLBL_CMPY_CD          = #glblCmpyCd#
               AND VCC.VAR_CHAR_CONST_NM = #glblCmpyNm#
               AND VCC.EZCANCELFLAG      = '0'
          ) AS GLBL_CMPY_NM
         <!-- 2018/05/11 S21_NA#22139 Add Start -->
         ,CASE WHEN CTX.ORD_CATG_BIZ_CTX_PK IS NOT NULL THEN
                #flgY#
               ELSE #flgN#
          END AS EASY_PACK_FLG
         <!-- 2018/05/22 S21_NA#22139-2 Mod Start -->
         ,CASE WHEN CTX.ORD_CATG_BIZ_CTX_PK IS NOT NULL
                AND SQD.DPLY_QUOTE_LINE_SUB_NUM IS NULL
          THEN
               SQD.ORD_QTY * DMI.AREA_OF_PAPER_NUM
          ELSE NULL
          END AS EASY_PAC_QTY
         <!-- 2018/05/22 S21_NA#22139-2 Mod End -->
         ,SQ.QUOTE_PRINT_CMNT_TXT AS PRINT_CMNT_TXT
         ,SQ.SHPG_CMNT_PRINT_CD AS SHPG_CMNT_PRINT_CD
         <!-- 2018/05/11 S21_NA#22139 Add End -->
         <!-- 2018/12/06 QC#27362 Add Start -->
         ,SQ.SELL_TO_FIRST_REF_CMNT_TXT AS SELL_TO_FIRST_REF_CMNT_TXT
         <!-- 2018/12/06 QC#27362 Add End -->
         <!-- START 2023/07/28 R.Takau [QC#60676,ADD] -->
         ,SHT.SPCL_HDLG_TP_DESC_TXT
         <!-- END 2023/07/28 R.Takau [QC#60676,ADD] -->
    FROM
         SPLY_QUOTE SQ
         ,SPLY_QUOTE_DTL SQD
         ,SPLY_QUOTE_RPT_COND SQRC
         ,BILL_TO_CUST SEBTC
         ,(SELECT
               GLBL_CMPY_CD
              ,SPLY_QUOTE_NUM
              ,CTAC_PSN_NM
              ,DS_CTAC_PNT_VAL_TXT
              ,EZCANCELFLAG
           FROM
               (SELECT
                    SQCP.GLBL_CMPY_CD
                   ,SQCP.SPLY_QUOTE_NUM AS SPLY_QUOTE_NUM
                   ,SQCP.CTAC_PSN_FIRST_NM  || ' ' || SQCP.CTAC_PSN_LAST_NM AS CTAC_PSN_NM
                   ,SQCP.CTAC_PSN_TEL_NUM AS DS_CTAC_PNT_VAL_TXT
                   ,SQCP.EZCANCELFLAG
                FROM
                    SPLY_QUOTE_CTAC_PSN SQCP
                WHERE
                    SQCP.GLBL_CMPY_CD       = #glblCmpyCd#
                    AND SQCP.SPLY_QUOTE_NUM = #splyQuoteNum#
                    AND SQCP.CTAC_PSN_TP_CD = #outputCtacTpCd#
                    AND SQCP.EZCANCELFLAG   = '0'
                ORDER BY
                    SQCP.SPLY_QUOTE_CTAC_PSN_PK
               )
           WHERE
               ROWNUM = 1
          ) C_CTAC
         ,BILL_TO_CUST BTC
         ,PMT_TERM_CASH_DISC PT
         ,AUTH_PSN AP
         ,FRT_COND FC
         ,SHPG_SVC_LVL SSL
         ,CARR_SVC_LVL CSL
         ,ORD_TAKE_MDSE OTM
         ,MDSE_STORE_PKG DMSP1
         ,MDSE_STORE_PKG DMSP2
         ,SELL_TO_CUST DAC1
         <!-- 2018/02/02 S21_NA#23881 Mod Start -->
         <!-- ,SELL_TO_CUST DAC2 -->
         <!-- ,SELL_TO_CUST DAC3 -->
         ,BILL_TO_CUST DAC2
         ,SHIP_TO_CUST DAC3
         <!-- 2018/02/02 S21_NA#23881 Mod End -->
         ,MDSE DMI
         <!-- 2018/05/11 S21_NA#22139 Add Start -->
         ,ORD_CATG_BIZ_CTX CTX
         <!-- 2018/05/11 S21_NA#22139 Add End -->
         <!-- START 2023/07/28 R.Takau [QC#60676,ADD] -->
         ,SPCL_HDLG_TP SHT
         <!-- END 2023/07/28 R.Takau [QC#60676,ADD] -->
    WHERE
         SQ.GLBL_CMPY_CD       = #glblCmpyCd#
         AND SQ.SPLY_QUOTE_NUM = #splyQuoteNum#
         AND SQ.EZCANCELFLAG   = '0'

         AND SQ.GLBL_CMPY_CD            = SQD.GLBL_CMPY_CD
         AND SQ.SPLY_QUOTE_NUM          = SQD.SPLY_QUOTE_NUM
         AND SQD.SPLY_QUOTE_LINE_STS_CD != #cancelSts#
         AND SQD.EZCANCELFLAG           = '0'

         AND SQ.GLBL_CMPY_CD         = C_CTAC.GLBL_CMPY_CD (+)
         AND SQ.SPLY_QUOTE_NUM       = C_CTAC.SPLY_QUOTE_NUM (+)
         AND C_CTAC.EZCANCELFLAG (+) = '0'

         AND SQ.GLBL_CMPY_CD               = SQRC.GLBL_CMPY_CD (+)
         AND SQ.DS_ORD_CATG_CD             = SQRC.DS_ORD_CATG_CD (+)
         AND SQ.DS_ORD_TP_CD               = SQRC.DS_ORD_TP_CD (+)
         AND SQRC.SPLY_QUOTE_RPT_TP_CD (+) = #splyQuoteRptTpCd#
         AND SQRC.EZCANCELFLAG (+)         = '0'

         AND SQ.GLBL_CMPY_CD        = SEBTC.GLBL_CMPY_CD (+)
         AND SQ.SOLD_TO_CUST_LOC_CD = SEBTC.BILL_TO_CUST_CD (+)
         AND SEBTC.EZCANCELFLAG (+) = '0'

         AND SQ.GLBL_CMPY_CD      = BTC.GLBL_CMPY_CD (+)
         AND SQ.BILL_TO_CUST_CD   = BTC.BILL_TO_CUST_CD (+)
         AND BTC.EZCANCELFLAG (+) = '0'

         AND SQ.GLBL_CMPY_CD          = PT.GLBL_CMPY_CD (+)
         AND SQ.PMT_TERM_CASH_DISC_CD = PT.PMT_TERM_CASH_DISC_CD (+)
         AND PT.EZCANCELFLAG (+)      = '0'

         AND SQ.GLBL_CMPY_CD     = AP.GLBL_CMPY_CD (+)
         AND SQ.ADMIN_PSN_CD     = AP.USR_NM (+)
         AND AP.EZCANCELFLAG (+) = '0'

         AND SQ.GLBL_CMPY_CD     = FC.GLBL_CMPY_CD (+)
         AND SQ.FRT_COND_CD      = FC.FRT_COND_CD (+)
         AND FC.EZCANCELFLAG (+) = '0'

         AND SQ.GLBL_CMPY_CD      = SSL.GLBL_CMPY_CD (+)
         AND SQ.SHPG_SVC_LVL_CD   = SSL.SHPG_SVC_LVL_CD (+)
         AND SSL.EZCANCELFLAG (+) = '0'

         AND SQ.GLBL_CMPY_CD      = CSL.GLBL_CMPY_CD (+)
         AND SQ.CARR_SVC_LVL_CD   = CSL.CARR_SVC_LVL_CD (+)
         AND CSL.EZCANCELFLAG (+) = '0'

         AND SQ.GLBL_CMPY_CD       = DAC1.GLBL_CMPY_CD (+)
         AND SQ.SELL_TO_CUST_CD    = DAC1.SELL_TO_CUST_CD (+)
         AND DAC1.EZCANCELFLAG (+) = '0'

         AND SQ.GLBL_CMPY_CD         = DAC2.GLBL_CMPY_CD (+)
         <!-- 2018/02/02 S21_NA#23881 Mod Start -->
         <!-- AND SQ.BILL_TO_CUST_ACCT_CD = DAC2.SELL_TO_CUST_CD (+) -->
         AND SQ.BILL_TO_CUST_CD      = DAC2.BILL_TO_CUST_CD (+)
         <!-- 2018/02/02 S21_NA#23881 Mod End -->
         AND DAC2.EZCANCELFLAG (+)   = '0'

         AND SQ.GLBL_CMPY_CD         = DAC3.GLBL_CMPY_CD (+)
         <!-- 2018/02/02 S21_NA#23881 Mod Start -->
         <!-- AND SQ.SHIP_TO_CUST_ACCT_CD = DAC3.SELL_TO_CUST_CD (+) -->
         AND SQ.SHIP_TO_CUST_CD      = DAC3.SHIP_TO_CUST_CD (+)
         <!-- 2018/02/02 S21_NA#23881 Mod End -->
         AND DAC3.EZCANCELFLAG (+)   = '0'

         AND SQD.GLBL_CMPY_CD     = OTM.GLBL_CMPY_CD (+)
         AND SQD.MDSE_CD          = OTM.ORD_TAKE_MDSE_CD (+)
         AND OTM.EZCANCELFLAG (+) = '0'

         AND OTM.GLBL_CMPY_CD          = DMSP1.GLBL_CMPY_CD (+)
         AND OTM.MDSE_CD               = DMSP1.MDSE_CD (+)
         AND DMSP1.BASE_PKG_UOM_CD (+) IS NOT NULL
         AND DMSP1.EZCANCELFLAG (+)    = '0'

         AND SQD.GLBL_CMPY_CD          = DMSP2.GLBL_CMPY_CD (+)
         AND SQD.MDSE_CD               = DMSP2.MDSE_CD (+)
         AND DMSP2.BASE_PKG_UOM_CD (+) IS NOT NULL
         AND DMSP2.EZCANCELFLAG (+)    = '0'

         AND SQD.GLBL_CMPY_CD              = DMI.GLBL_CMPY_CD
         AND NVL(OTM.MDSE_CD, SQD.MDSE_CD) = DMI.MDSE_CD
         AND DMI.EZCANCELFLAG              = '0'

         <!-- 2018/05/11 S21_NA#22139 Add Start -->
         AND SQ.GLBL_CMPY_CD           = CTX.GLBL_CMPY_CD (+)
         AND SQ.DS_ORD_CATG_CD         = CTX.DS_ORD_CATG_CD (+)
         AND SQ.DS_ORD_TP_CD           = CTX.DS_ORD_TP_CD (+)
         AND CTX.ORD_CATG_CTX_TP_CD(+) = #ordCatgCtxTpCdeasyPack#
         AND CTX.EZCANCELFLAG (+)      = '0'
         <!-- 2018/05/11 S21_NA#22139 Add End -->

         <!-- START 2023/07/28 R.Takau [QC#60676,ADD] -->
         AND SQ.GLBL_CMPY_CD           = SHT.GLBL_CMPY_CD (+)
         AND SQ.SPCL_HDLG_TP_CD        = SHT.SPCL_HDLG_TP_CD (+)
         AND SHT.EZCANCELFLAG (+)      = '0'
         <!-- END 2023/07/28 R.Takau [QC#60676,ADD] -->
    ORDER BY
         SQD.DPLY_QUOTE_LINE_NUM
        ,SQD.DPLY_QUOTE_LINE_SUB_NUM NULLS FIRST
    </statement>

    <statement id="getOrderConfHeader" parameterClass="Map"  resultClass="Map">
    SELECT
        CASE WHEN SQRC.FIRST_LINE_ADDR IS NOT NULL THEN 
                  SQRC.FIRST_LINE_ADDR
                  || SQRC.SCD_LINE_ADDR
                  || SQRC.THIRD_LINE_ADDR
                  || SQRC.FRTH_LINE_ADDR
                  || DECODE(SQRC.CTY_ADDR, NULL, ' ', ', ')
                  ||  SQRC.CTY_ADDR
                  || DECODE(SQRC.ST_CD, NULL, ' ', ', ')
                  || SQRC.ST_CD || ' ' || SQRC.POST_CD
             ELSE NULL END AS GLBL_FULL_CMPY_ADDR
        ,'Order Confirmation' AS RPT_TTL_TXT
        ,C.CPO_ORD_NUM AS TRX_HDR_NUM
        ,TO_CHAR(TO_DATE(substr(C.CPO_ORD_TS, 1, 8), 'YYYY/MM/DD'), 'MM/DD/YYYY') AS TRX_DT_TXT
        ,NULL AS SPLY_QUOTE_VLD_THRU_DT_TXT
        ,C.CUST_ISS_PO_NUM AS CUST_ISS_PO_NUM
        ,PT.PMT_TERM_CASH_DISC_DESC_TXT AS PMT_TERM_CASH_DISC_DESC_TXT
        ,NULL AS FULL_ADMIN_PSN_NM
        ,FC.FRT_COND_NM AS FRT_COND_NM
        ,CASE WHEN C.FRT_COND_CD = #frtCondCd# THEN CSL.CARR_SVC_LVL_NM
              ELSE SSL.SHPG_SVC_LVL_NM END AS SVC_LVL_RPT_NM
         <!-- 2017/10/23 J.Kim [QC#21117,MOD] -->
         <!-- ,C.ADD_SHIP_TO_01_REF_CMNT_TXT AS SHIP_TO_01_REF_CMNT_TXT -->
         <!-- ,C.ADD_SHIP_TO_02_REF_CMNT_TXT AS SHIP_TO_02_REF_CMNT_TXT -->
        ,DCD.DELY_ADDL_CMNT_TXT AS SHPG_CMNT_TXT
        ,C.SELL_TO_CUST_CD AS SELL_TO_CUST_CD
        <!-- 2018/02/02 S21_NA#23881 Mod Start -->
        <!-- ,DAC1.DS_ACCT_NM AS SELL_TO_LOC_NM -->
        ,DAC1.LOC_NM AS SELL_TO_LOC_NM
        <!-- 2018/02/02 S21_NA#23881 Mod End -->
        ,CASE WHEN SEBTC.FIRST_LINE_ADDR IS NOT NULL THEN 
              SEBTC.FIRST_LINE_ADDR || ' '
              || SEBTC.SCD_LINE_ADDR || ' '
              || SEBTC.THIRD_LINE_ADDR || ' '
              || SEBTC.FRTH_LINE_ADDR
              ELSE NULL END AS SELL_TO_ADDR_01
        ,SEBTC.CTY_ADDR || DECODE(SEBTC.ST_CD, NULL, ' ', ', ') || SEBTC.ST_CD || ' ' || SEBTC.POST_CD AS SELL_TO_ADDR_02
        ,C_CTAC.CTAC_PSN_NM AS FULL_CTAC_PSN_NM
        ,'Tel' AS CTAC_RPT_TTL_TXT
        ,C_CTAC.DS_CTAC_PNT_VAL_TXT AS DS_CTAC_PNT_VAL_TXT
        ,C.BILL_TO_CUST_ACCT_CD AS BILL_TO_CUST_CD
        <!-- 2018/02/02 S21_NA#23881 Mod Start -->
        <!-- ,DAC2.DS_ACCT_NM AS BILL_TO_LOC_NM -->
        ,DAC2.LOC_NM AS BILL_TO_LOC_NM
        <!-- 2018/02/02 S21_NA#23881 Mod End -->
        ,CASE WHEN BTC.FIRST_LINE_ADDR IS NOT NULL THEN
              BTC.FIRST_LINE_ADDR || ' '
              || BTC.SCD_LINE_ADDR || ' '
              || BTC.THIRD_LINE_ADDR || ' '
              || BTC.FRTH_LINE_ADDR
              ELSE NULL END AS BILL_TO_ADDR_01
        ,BTC.CTY_ADDR || DECODE(BTC.ST_CD, NULL, ' ', ', ') || BTC.ST_CD || ' ' || BTC.POST_CD AS BILL_TO_ADDR_02
        ,C.SHIP_TO_CUST_ACCT_CD AS SHIP_TO_CUST_CD
        <!-- 2017/08/02 S21_NA#20331 Mod Start -->
        --,DAC3.DS_ACCT_NM AS SHIP_TO_LOC_NM
        <!-- 2018/02/02 S21_NA#23881 Mod Start -->
        <!-- ,CASE WHEN C.ADD_DROP_SHIP_FLG = 'Y' THEN -->
        <!--         DECODE(C.ADD_SHIP_TO_LOC_NM, NULL, DAC3.DS_ACCT_NM, C.ADD_SHIP_TO_LOC_NM) || DECODE(C.ADD_SHIP_TO_ADDL_LOC_NM, NULL, '', CHR(13) || CHR(10) || C.ADD_SHIP_TO_ADDL_LOC_NM) -->
        <!--        ELSE -->
        <!--         DAC3.DS_ACCT_NM -->
        <!--  END AS SHIP_TO_LOC_NM -->
        ,CASE WHEN C.ADD_DROP_SHIP_FLG = 'Y' THEN
                DECODE(C.ADD_SHIP_TO_LOC_NM, NULL, DAC3.LOC_NM, C.ADD_SHIP_TO_LOC_NM) || DECODE(C.ADD_SHIP_TO_ADDL_LOC_NM, NULL, '', CHR(13) || CHR(10) || C.ADD_SHIP_TO_ADDL_LOC_NM)
               ELSE
                DAC3.LOC_NM
         END AS SHIP_TO_LOC_NM
        <!-- 2018/02/02 S21_NA#23881 Mod End -->
         <!-- 2017/08/02 S21_NA#20331 Mod End -->
        ,C.ADD_SHIP_TO_FIRST_LINE_ADDR || ' ' || C.ADD_SHIP_TO_SCD_LINE_ADDR || ' ' || C.ADD_SHIP_TO_THIRD_LINE_ADDR || ' ' || C.ADD_SHIP_TO_FRTH_LINE_ADDR AS SHIP_TO_ADDR_01
        ,C.ADD_SHIP_TO_CTY_ADDR || ', ' || C.ADD_SHIP_TO_ST_CD || ' ' || C.ADD_SHIP_TO_POST_CD AS SHIP_TO_ADDR_02
        ,CONCAT (CD.DS_ORD_POSN_NUM, '.')
                 || CONCAT (CD.DS_CPO_LINE_NUM, DECODE (CD.DS_CPO_LINE_SUB_NUM, NULL, '', '.'))
                 || CD.DS_CPO_LINE_SUB_NUM AS CPO_WRK_LINE_NUM
        ,CD.MDSE_CD AS MDSE_CD
        ,DMI.MNF_ITEM_CD AS MNF_ITEM_CD
        ,DMI.MDSE_DESC_SHORT_TXT AS MDSE_DESC_SHORT_TXT
        ,NVL(DMSP1.BASE_PKG_UOM_CD, DMSP2.BASE_PKG_UOM_CD) AS PKG_UOM_CD
        ,TO_CHAR(CD.ORD_QTY, 'FM9,999,999,990') AS ORD_QTY_TXT
        ,CD.ORD_QTY AS ORD_QTY
        <!-- 2018/08/28 S21_NA#27811 Mod Start -->
        <!-- ,(CD.CPO_DTL_DEAL_SLS_AMT / CD.ORD_QTY) AS PRC_LIST_PRC_AMT -->
        ,NVL (PRCAMT.UNIT_PRC_AMT, 0) AS PRC_LIST_PRC_AMT
        <!-- 2018/08/28 S21_NA#27811 Mod End -->
        ,CD.ENT_DEAL_NET_UNIT_PRC_AMT AS NET_UNIT_PRC_AMT
        <!-- START 2018/09/26 Hd.Sugawara [QC#28486,DEL] -->
        <!-- ,((CASE WHEN MTD1.MSG_TXT_INFO_TXT IS NOT NULL THEN CONCAT(MTD1.MSG_TXT_INFO_TXT, CHR(13) || CHR(10)) END) -->
        <!--   || (CASE WHEN MTD2.MSG_TXT_INFO_TXT IS NOT NULL THEN CONCAT(MTD2.MSG_TXT_INFO_TXT, CHR(13) || CHR(10)) END) -->
        <!--   || (CASE WHEN MTD3.MSG_TXT_INFO_TXT IS NOT NULL THEN CONCAT(MTD3.MSG_TXT_INFO_TXT, CHR(13) || CHR(10)) END) -->
        <!--   || (CASE WHEN MTD4.MSG_TXT_INFO_TXT IS NOT NULL THEN CONCAT(MTD4.MSG_TXT_INFO_TXT, CHR(13) || CHR(10)) END)) AS SPLY_QUOTE_CMNT_TXT -->
        <!-- END 2018/09/26 Hd.Sugawara [QC#28486,DEL] -->
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_01 AS SPLY_QUOTE_RPT_NOTE_TXT_01
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_02 AS SPLY_QUOTE_RPT_NOTE_TXT_02
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_03 AS SPLY_QUOTE_RPT_NOTE_TXT_03
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_04 AS SPLY_QUOTE_RPT_NOTE_TXT_04
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_05 AS SPLY_QUOTE_RPT_NOTE_TXT_05
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_06 AS SPLY_QUOTE_RPT_NOTE_TXT_06
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_07 AS SPLY_QUOTE_RPT_NOTE_TXT_07
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_08 AS SPLY_QUOTE_RPT_NOTE_TXT_08
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_09 AS SPLY_QUOTE_RPT_NOTE_TXT_09
        ,SQRC.SPLY_QUOTE_RPT_NOTE_TXT_10 AS SPLY_QUOTE_RPT_NOTE_TXT_10
        ,(
          SELECT
              VCC.VAR_CHAR_CONST_VAL
          FROM
              VAR_CHAR_CONST VCC
          WHERE
              VCC.GLBL_CMPY_CD          = #glblCmpyCd#
              AND VCC.VAR_CHAR_CONST_NM = #glblCmpyNm#
              AND VCC.EZCANCELFLAG      = '0'
         ) AS GLBL_CMPY_NM
         <!-- 2018/05/11 S21_NA#22139 Add Start -->
         ,CASE WHEN CTX.ORD_CATG_BIZ_CTX_PK IS NOT NULL THEN
                #flgY#
               ELSE #flgN#
          END AS EASY_PACK_FLG
          <!-- 2018/05/22 S21_NA#22139-2 Mod Start -->
         ,CASE WHEN CTX.ORD_CATG_BIZ_CTX_PK IS NOT NULL
                AND CD.SET_MDSE_CD IS NULL
          THEN
               CD.ORD_QTY * DMI.AREA_OF_PAPER_NUM
          ELSE NULL
          END AS EASY_PAC_QTY
          <!-- 2018/05/22 S21_NA#22139-2 Mod End -->
         ,C.ORD_PRINT_CMNT_TXT AS PRINT_CMNT_TXT
         ,C.SHPG_CMNT_PRINT_CD AS SHPG_CMNT_PRINT_CD
         <!-- 2018/05/11 S21_NA#22139 Add End -->
         <!-- 2018/11/13 QC#29006 Add Start -->
         ,DCD.DS_CPO_CONFIG_PK AS DS_CPO_CONFIG_PK
         <!-- 2018/11/13 QC#29006 Add End -->
         <!-- 2018/12/06 QC#27362 Add Start -->
         ,C.SELL_TO_FIRST_REF_CMNT_TXT AS SELL_TO_FIRST_REF_CMNT_TXT
         <!-- 2018/12/06 QC#27362 Add End -->
         <!-- START 2023/07/28 R.Takau [QC#60676,ADD] -->
         ,SHT.SPCL_HDLG_TP_DESC_TXT
         <!-- END 2023/07/28 R.Takau [QC#60676,ADD] -->
    FROM
        CPO C
        ,CPO_DTL CD
        ,SPLY_QUOTE_RPT_COND SQRC
        ,BILL_TO_CUST SEBTC
        ,(SELECT
              GLBL_CMPY_CD
             ,CPO_ORD_NUM
             ,CTAC_PSN_NM
             ,DS_CTAC_PNT_VAL_TXT
             ,EZCANCELFLAG
          FROM
              (SELECT
                   DCCP.GLBL_CMPY_CD
                  ,DCCP.CPO_ORD_NUM 
                  ,DCCP.CTAC_PSN_FIRST_NM  || ' ' || DCCP.CTAC_PSN_LAST_NM AS CTAC_PSN_NM
                  ,DCCP.CTAC_PSN_TEL_NUM AS DS_CTAC_PNT_VAL_TXT
                  ,DCCP.EZCANCELFLAG
               FROM
                   DS_CPO_CTAC_PSN DCCP
               WHERE
                   DCCP.GLBL_CMPY_CD       = #glblCmpyCd#
                   AND DCCP.CPO_ORD_NUM    = #cpoOrdNum#
                   AND DCCP.CTAC_PSN_TP_CD = #outputCtacTpCd#
                   AND DCCP.EZCANCELFLAG   = '0'
               ORDER BY
                   DCCP.DS_CPO_CTAC_PSN_PK
              )
          WHERE
              ROWNUM = 1
         ) C_CTAC
        <!-- 2018/08/28 S21_NA#27811 ADD Start -->
        ,(SELECT
              PRC.GLBL_CMPY_CD
             ,PRC.CPO_ORD_NUM
             ,PRC.CPO_DTL_LINE_NUM
             ,PRC.CPO_DTL_LINE_SUB_NUM
             ,SUM(
                  CASE PRC.PRC_DTL_GRP_CD
                      WHEN 'BASE' THEN PRC.UNIT_PRC_AMT
                      ELSE 0
                  END
             ) AS UNIT_PRC_AMT
          FROM
              ORD_PRC_CALC_BASE PRC
          WHERE
              PRC.EZCANCELFLAG = '0'
              AND PRC.PRC_COND_MAN_DEL_FLG = 'N'
          GROUP BY
              PRC.GLBL_CMPY_CD
             ,PRC.CPO_ORD_NUM
             ,PRC.CPO_DTL_LINE_NUM
             ,PRC.CPO_DTL_LINE_SUB_NUM
          ) PRCAMT
        <!-- 2018/08/28 S21_NA#27811 Add End -->
        ,BILL_TO_CUST BTC
        ,PMT_TERM_CASH_DISC PT
        ,FRT_COND FC
        ,SHPG_SVC_LVL SSL
        ,CARR_SVC_LVL CSL
        <!-- START 2018/09/26 Hd.Sugawara [QC#28486,DEL] -->
        <!-- ,MSG_TXT_DTL MTD1 -->
        <!-- ,MSG_TXT_DTL MTD2 -->
        <!-- ,MSG_TXT_DTL MTD3 -->
        <!-- ,MSG_TXT_DTL MTD4 -->
        <!-- END 2018/09/26 Hd.Sugawara [QC#28486,DEL] -->
        ,ORD_TAKE_MDSE OTM
        ,MDSE_STORE_PKG DMSP1
        ,MDSE_STORE_PKG DMSP2
        ,SELL_TO_CUST DAC1
        <!-- 2018/02/02 S21_NA#23881 Mod Start -->
        <!-- ,SELL_TO_CUST DAC2 -->
        <!-- ,SELL_TO_CUST DAC3 -->
        ,BILL_TO_CUST DAC2
        ,SHIP_TO_CUST DAC3
        <!-- 2018/02/02 S21_NA#23881 Mod End -->
        ,MDSE DMI
        ,DS_CPO_DELY_INFO   DCD
        <!-- 2018/05/11 S21_NA#22139 Add Start -->
        ,ORD_CATG_BIZ_CTX CTX
        <!-- 2018/05/11 S21_NA#22139 Add End -->
        <!-- START 2023/07/28 R.Takau [QC#60676,ADD] -->
        ,SPCL_HDLG_TP SHT
        <!-- END 2023/07/28 R.Takau [QC#60676,ADD] -->
    WHERE
        C.GLBL_CMPY_CD     = #glblCmpyCd#
        AND C.CPO_ORD_NUM  = #cpoOrdNum#
        AND C.EZCANCELFLAG = '0'

        AND C.GLBL_CMPY_CD  = CD.GLBL_CMPY_CD
        AND C.CPO_ORD_NUM   = CD.CPO_ORD_NUM
        AND CD.EZCANCELFLAG = '0'
        <!-- 2019/08/01 QC#52297 Add Start -->
        AND CD.ORD_LINE_STS_CD != '99' 
        <!-- 2019/08/01 QC#52297 Add End -->

        AND C.GLBL_CMPY_CD          = C_CTAC.GLBL_CMPY_CD (+)
        AND C.CPO_ORD_NUM           = C_CTAC.CPO_ORD_NUM (+)
        AND C_CTAC.EZCANCELFLAG (+) = '0'

        AND C.GLBL_CMPY_CD                = SQRC.GLBL_CMPY_CD (+)
        AND C.DS_ORD_CATG_CD              = SQRC.DS_ORD_CATG_CD (+)
        AND C.DS_ORD_TP_CD                = SQRC.DS_ORD_TP_CD (+)
        AND SQRC.SPLY_QUOTE_RPT_TP_CD (+) = #splyQuoteRptTpCd#
        AND SQRC.EZCANCELFLAG (+)         = '0'

        AND C.GLBL_CMPY_CD         = SEBTC.GLBL_CMPY_CD (+)
        AND C.SOLD_TO_CUST_LOC_CD  = SEBTC.BILL_TO_CUST_CD (+)
        AND SEBTC.EZCANCELFLAG (+) = '0'

        AND C.GLBL_CMPY_CD       = BTC.GLBL_CMPY_CD (+)
        AND C.BILL_TO_CUST_CD    = BTC.BILL_TO_CUST_CD (+)
        AND BTC.EZCANCELFLAG (+) = '0'

        AND C.GLBL_CMPY_CD              = PT.GLBL_CMPY_CD (+)
        AND C.ADD_PMT_TERM_CASH_DISC_CD = PT.PMT_TERM_CASH_DISC_CD (+)
        AND PT.EZCANCELFLAG (+)         = '0'

        AND C.GLBL_CMPY_CD      = FC.GLBL_CMPY_CD (+)
        AND C.FRT_COND_CD       = FC.FRT_COND_CD (+)
        AND FC.EZCANCELFLAG (+) = '0'

        AND C.GLBL_CMPY_CD        = SSL.GLBL_CMPY_CD (+)
        AND C.ADD_SHPG_SVC_LVL_CD = SSL.SHPG_SVC_LVL_CD (+)
        AND SSL.EZCANCELFLAG (+)  = '0'

        AND C.GLBL_CMPY_CD       = CSL.GLBL_CMPY_CD (+)
        AND C.CARR_SVC_LVL_CD    = CSL.CARR_SVC_LVL_CD (+)
        AND CSL.EZCANCELFLAG (+) = '0'

        <!-- START 2018/09/26 Hd.Sugawara [QC#28486,DEL] -->
        <!-- AND C.GLBL_CMPY_CD                = MTD1.GLBL_CMPY_CD (+) -->
        <!-- AND C.CPO_ORD_NUM                 = MTD1.CPO_ORD_NUM (+) -->
        <!-- AND MTD1.CPO_DTL_LINE_NUM (+)     IS NULL -->
        <!-- AND MTD1.CPO_DTL_LINE_SUB_NUM (+) IS NULL -->
        <!-- AND MTD1.TXT_TP_CD (+)            = #txtTpCd1# -->
        <!-- AND MTD1.EZCANCELFLAG (+)         = '0' -->

        <!-- AND C.GLBL_CMPY_CD                = MTD2.GLBL_CMPY_CD (+) -->
        <!-- AND C.CPO_ORD_NUM                 = MTD2.CPO_ORD_NUM (+) -->
        <!-- AND MTD2.CPO_DTL_LINE_NUM (+)     IS NULL -->
        <!-- AND MTD2.CPO_DTL_LINE_SUB_NUM (+) IS NULL -->
        <!-- AND MTD2.TXT_TP_CD (+)            = #txtTpCd2# -->
        <!-- AND MTD2.EZCANCELFLAG (+)         = '0' -->

        <!-- AND C.GLBL_CMPY_CD                = MTD3.GLBL_CMPY_CD (+) -->
        <!-- AND C.CPO_ORD_NUM                 = MTD3.CPO_ORD_NUM (+) -->
        <!-- AND MTD3.CPO_DTL_LINE_NUM (+)     IS NULL -->
        <!-- AND MTD3.CPO_DTL_LINE_SUB_NUM (+) IS NULL -->
        <!-- AND MTD3.TXT_TP_CD (+)            = #txtTpCd3# -->
        <!-- AND MTD3.EZCANCELFLAG (+)         = '0' -->

        <!-- AND C.GLBL_CMPY_CD                = MTD4.GLBL_CMPY_CD (+) -->
        <!-- AND C.CPO_ORD_NUM                 = MTD4.CPO_ORD_NUM (+) -->
        <!-- AND MTD4.CPO_DTL_LINE_NUM (+)     IS NULL -->
        <!-- AND MTD4.CPO_DTL_LINE_SUB_NUM (+) IS NULL -->
        <!-- AND MTD4.TXT_TP_CD (+)            = #txtTpCd4# -->
        <!-- AND MTD4.EZCANCELFLAG (+)         = '0' -->
        <!-- END 2018/09/26 Hd.Sugawara [QC#28486,DEL] -->

        AND CD.GLBL_CMPY_CD      = OTM.GLBL_CMPY_CD (+)
        AND CD.MDSE_CD           = OTM.ORD_TAKE_MDSE_CD (+)
        AND OTM.EZCANCELFLAG (+) = '0'

        AND OTM.GLBL_CMPY_CD          = DMSP1.GLBL_CMPY_CD (+)
        AND OTM.MDSE_CD               = DMSP1.MDSE_CD (+)
        AND DMSP1.BASE_PKG_UOM_CD (+) IS NOT NULL
        AND DMSP1.EZCANCELFLAG (+)    = '0'

        AND CD.GLBL_CMPY_CD           = DMSP2.GLBL_CMPY_CD (+)
        AND CD.MDSE_CD                = DMSP2.MDSE_CD (+)
        AND DMSP2.BASE_PKG_UOM_CD (+) IS NOT NULL
        AND DMSP2.EZCANCELFLAG (+)    = '0'

        AND C.GLBL_CMPY_CD        = DAC1.GLBL_CMPY_CD (+)
        AND C.SELL_TO_CUST_CD     = DAC1.SELL_TO_CUST_CD (+)
        AND DAC1.EZCANCELFLAG (+) = '0'

        AND C.GLBL_CMPY_CD          = DAC2.GLBL_CMPY_CD (+)
        <!-- 2018/02/02 S21_NA#23881 Mod Start -->
        <!-- AND C.BILL_TO_CUST_ACCT_CD  = DAC2.SELL_TO_CUST_CD (+) -->
        AND C.BILL_TO_CUST_CD       = DAC2.BILL_TO_CUST_CD (+)
        <!-- 2018/02/02 S21_NA#23881 Mod End -->
        AND DAC2.EZCANCELFLAG (+)   = '0'

        AND C.GLBL_CMPY_CD          = DAC3.GLBL_CMPY_CD (+)
        <!-- 2018/02/02 S21_NA#23881 Mod Start -->
        <!-- AND C.SHIP_TO_CUST_ACCT_CD  = DAC3.SELL_TO_CUST_CD (+) -->
        AND C.ADD_SHIP_TO_CUST_CD   = DAC3.SHIP_TO_CUST_CD (+)
        <!-- 2018/02/02 S21_NA#23881 Mod End -->
        AND DAC3.EZCANCELFLAG (+)   = '0'

        AND CD.GLBL_CMPY_CD              = DMI.GLBL_CMPY_CD
        AND NVL(OTM.MDSE_CD, CD.MDSE_CD) = DMI.MDSE_CD
        AND DMI.EZCANCELFLAG             = '0'

        AND C.GLBL_CMPY_CD          = DCD.GLBL_CMPY_CD (+)
        AND C.CPO_ORD_NUM           = DCD.CPO_ORD_NUM (+)
        <!-- 2018/11/13 QC#29006 Del Start -->
        <!-- AND DCD.DS_CPO_CONFIG_PK(+) IS NULL -->
        <!-- 2018/11/13 QC#29006 Del End -->
        AND DCD.EZCANCELFLAG (+)    = '0'

         <!-- 2018/05/11 S21_NA#22139 Add Start -->
         AND C.GLBL_CMPY_CD             = CTX.GLBL_CMPY_CD (+)
         AND C.DS_ORD_CATG_CD           = CTX.DS_ORD_CATG_CD (+)
         AND C.DS_ORD_TP_CD             = CTX.DS_ORD_TP_CD (+)
         AND CTX.ORD_CATG_CTX_TP_CD (+) = #ordCatgCtxTpCdeasyPack#
         AND CTX.EZCANCELFLAG (+)       = '0'
         <!-- 2018/05/11 S21_NA#22139 Add End -->

         <!-- 2018/08/28 S21_NA#27811 Add Start -->
         AND CD.GLBL_CMPY_CD         = PRCAMT.GLBL_CMPY_CD (+)
         AND CD.CPO_ORD_NUM          = PRCAMT.CPO_ORD_NUM (+)
         AND CD.CPO_DTL_LINE_NUM     = PRCAMT.CPO_DTL_LINE_NUM (+)
         AND CD.CPO_DTL_LINE_SUB_NUM = PRCAMT.CPO_DTL_LINE_SUB_NUM (+)
         <!-- 2018/08/28 S21_NA#27811 Add End -->
         <!-- START 2023/07/28 R.Takau [QC#60676,ADD] -->
         AND C.GLBL_CMPY_CD           = SHT.GLBL_CMPY_CD (+)
         AND C.SPCL_HDLG_TP_CD        = SHT.SPCL_HDLG_TP_CD (+)
         AND SHT.EZCANCELFLAG (+)     = '0'
        <!-- END 2023/07/28 R.Takau [QC#60676,ADD] -->
    ORDER BY
        <!-- 2018/11/13 QC#29006 Mod Start -->
        DCD.DS_CPO_CONFIG_PK
        ,CONCAT (CD.DS_ORD_POSN_NUM, '.')
                  || CONCAT (CD.DS_CPO_LINE_NUM, DECODE (CD.DS_CPO_LINE_SUB_NUM, NULL, '', '.'))
                  || CD.DS_CPO_LINE_SUB_NUM
        <!-- 2018/11/13 QC#29006 Mod End -->
    </statement>

    <statement id="getQuoteCharge" parameterClass="Map"  resultClass="Map">
    SELECT
        PRD.PRC_RULE_DTL_CHRG_NM
       ,SUM(NVL(SQPCB.CALC_PRC_AMT_RATE,0)) AS CHRG_AMT
    FROM
        SPLY_QUOTE               SQ
       ,SPLY_QUOTE_DTL           SQD
       ,SPLY_QUOTE_PRC_CALC_BASE SQPCB
       ,SPEC_COND_PRC            SCP
       ,PRC_RULE_DTL             PRD
    WHERE 
        SQ.GLBL_CMPY_CD       = #glblCmpyCd#
        AND SQ.SPLY_QUOTE_NUM = #splyQuoteNum#
        AND SQ.EZCANCELFLAG   = '0'

        AND SQ.GLBL_CMPY_CD             = SQD.GLBL_CMPY_CD
        AND SQ.SPLY_QUOTE_NUM           = SQD.SPLY_QUOTE_NUM
        AND SQD.SPLY_QUOTE_LINE_STS_CD  != #cancelSts#
        AND SQD.EZCANCELFLAG            = '0'

        AND SQD.GLBL_CMPY_CD                = SQPCB.GLBL_CMPY_CD
        AND SQD.SPLY_QUOTE_NUM              = SQPCB.SPLY_QUOTE_NUM
        AND SQD.SPLY_QUOTE_DTL_LINE_NUM     = SQPCB.SPLY_QUOTE_DTL_LINE_NUM
        AND SQD.SPLY_QUOTE_DTL_LINE_SUB_NUM = SQPCB.SPLY_QUOTE_DTL_LINE_SUB_NUM
        <!-- 2018/05/22 S21_NA#21841 Mod Start -->
        <!-- AND SQPCB.PRC_DTL_GRP_CD            IN (#prcDtlGrpFrt#, #prcDtlGrpRnd1#) -->
        <!-- AND SQPCB.PRC_DTL_GRP_CD            IN (#prcDtlGrpFrt#, #prcDtlGrpRnd1#, #prcDtlGrpHndf#, #prcDtlGrpFsc#, #prcDtlGrpShpf#, #prcDtlGrpRnd2#) -->
        <!-- 2018/05/22 S21_NA#21841 Mod End -->
        <!-- 2018/08/03 QC#27479 Mod Start -->
        AND SQPCB.PRC_DTL_GRP_CD            IN
             <iterate property="prcDtlGrpCdList" var="prcDtlGrpCd[]" open="(" close=")" conjunction=",">
                 #prcDtlGrpCd[]#
             </iterate>
        <!-- 2018/08/03 QC#27479 Mod End -->
        AND SQPCB.EZCANCELFLAG              = '0'
        AND SQPCB.PRC_COND_MAN_DEL_FLG      = 'N'

        AND SQPCB.GLBL_CMPY_CD     = SCP.GLBL_CMPY_CD
        AND SQPCB.SPEC_COND_PRC_PK = SCP.SPEC_COND_PRC_PK
        AND SCP.EZCANCELFLAG       = '0'

        AND SCP.GLBL_CMPY_CD    = PRD.GLBL_CMPY_CD
        AND SCP.PRC_RULE_DTL_PK = PRD.PRC_RULE_DTL_PK
        AND PRD.EZCANCELFLAG    = '0'
    GROUP BY 
        PRD.PRC_RULE_DTL_CHRG_NM
    </statement>

    <statement id="getOrderConfCharge" parameterClass="Map"  resultClass="Map">
    SELECT 
        PRD.PRC_RULE_DTL_CHRG_NM
       ,SUM(NVL(OPCB.CALC_PRC_AMT_RATE,0)) AS CHRG_AMT
    FROM
        CPO               C
       ,CPO_DTL           CD
       ,ORD_PRC_CALC_BASE OPCB
       ,SPEC_COND_PRC     SCP
       ,PRC_RULE_DTL      PRD
    WHERE 
        C.GLBL_CMPY_CD     = #glblCmpyCd#
        AND C.CPO_ORD_NUM  = #cpoOrdNum#
        AND C.EZCANCELFLAG = '0'

        AND C.GLBL_CMPY_CD  = CD.GLBL_CMPY_CD
        AND C.CPO_ORD_NUM   = CD.CPO_ORD_NUM
        AND CD.EZCANCELFLAG = '0'

        AND CD.GLBL_CMPY_CD         = OPCB.GLBL_CMPY_CD
        AND CD.CPO_ORD_NUM          = OPCB.CPO_ORD_NUM
        AND CD.CPO_DTL_LINE_NUM     = OPCB.CPO_DTL_LINE_NUM
        AND CD.CPO_DTL_LINE_SUB_NUM = OPCB.CPO_DTL_LINE_SUB_NUM
        <!-- 2018/05/22 S21_NA#21841 Mod Start-->
        <!-- AND OPCB.PRC_DTL_GRP_CD     IN (#prcDtlGrpFrt#, #prcDtlGrpRnd1#) -->
        AND OPCB.PRC_DTL_GRP_CD     IN (#prcDtlGrpFrt#, #prcDtlGrpRnd1#, #prcDtlGrpHndf#, #prcDtlGrpFsc#, #prcDtlGrpShpf#, #prcDtlGrpRnd2#)
        <!-- 2018/05/22 S21_NA#21841 Mod End-->
        AND OPCB.EZCANCELFLAG       = '0'
        AND OPCB.PRC_COND_MAN_DEL_FLG = 'N'

        AND OPCB.GLBL_CMPY_CD     = SCP.GLBL_CMPY_CD
        AND OPCB.SPEC_COND_PRC_PK = SCP.SPEC_COND_PRC_PK
        AND SCP.EZCANCELFLAG      = '0'

        AND SCP.GLBL_CMPY_CD    = PRD.GLBL_CMPY_CD
        AND SCP.PRC_RULE_DTL_PK = PRD.PRC_RULE_DTL_PK
        AND PRD.EZCANCELFLAG    = '0'
    GROUP BY 
        PRD.PRC_RULE_DTL_CHRG_NM
    </statement>

    <statement id="getQuoteTax" parameterClass="Map"  resultClass="Map">
    SELECT
        SUM(NVL(SQPCB.AUTO_PRC_AMT_RATE,0)) AS TAX_RATE
       ,SUM(NVL(SQPCB.CALC_PRC_AMT_RATE,0)) AS TAX_AMT
       ,'Sales Tax (' || TO_CHAR(NVL(SQPCB.AUTO_PRC_AMT_RATE,0), 'FM999,999,999,999,990.0000') || '%)' AS PRC_RULE_DTL_CHRG_NM
    FROM
        SPLY_QUOTE               SQ
       ,SPLY_QUOTE_DTL           SQD
       ,SPLY_QUOTE_PRC_CALC_BASE SQPCB
    WHERE
        SQ.GLBL_CMPY_CD       = #glblCmpyCd#
        AND SQ.SPLY_QUOTE_NUM = #splyQuoteNum#
        AND SQ.EZCANCELFLAG   = '0'

        AND SQ.GLBL_CMPY_CD            = SQD.GLBL_CMPY_CD
        AND SQ.SPLY_QUOTE_NUM          = SQD.SPLY_QUOTE_NUM
        AND SQD.SPLY_QUOTE_LINE_STS_CD != #cancelSts#
        AND SQD.EZCANCELFLAG           = '0'

        AND SQD.GLBL_CMPY_CD                = SQPCB.GLBL_CMPY_CD
        AND SQD.SPLY_QUOTE_NUM              = SQPCB.SPLY_QUOTE_NUM
        AND SQD.SPLY_QUOTE_DTL_LINE_NUM     = SQPCB.SPLY_QUOTE_DTL_LINE_NUM
        AND SQD.SPLY_QUOTE_DTL_LINE_SUB_NUM = SQPCB.SPLY_QUOTE_DTL_LINE_SUB_NUM
        AND SQPCB.PRC_DTL_GRP_CD            = #prcDtlGrpCd#
        AND SQPCB.EZCANCELFLAG              = '0'
    GROUP BY
        SQPCB.AUTO_PRC_AMT_RATE
    </statement>

    <statement id="getOrderConfTax" parameterClass="Map"  resultClass="Map">
<!-- QC#55513 2020/01/20 Mod  -->
<!--     SELECT  -->
<!--        SUM(NVL(OPCB.AUTO_PRC_AMT_RATE,0)) AS TAX_RATE -->
<!--       ,SUM(NVL(OPCB.CALC_PRC_AMT_RATE,0)) AS TAX_AMT -->
<!--       ,'Sales Tax (' || TO_CHAR(NVL(OPCB.AUTO_PRC_AMT_RATE,0), 'FM999,999,999,999,990.0000') || '%)' AS PRC_RULE_DTL_CHRG_NM -->
<!--    FROM -->
<!--        CPO C -->
<!--        ,CPO_DTL CD -->
<!--        ,ORD_PRC_CALC_BASE OPCB -->
<!--    WHERE -->
<!--        C.GLBL_CMPY_CD     = #glblCmpyCd# -->
<!--        AND C.CPO_ORD_NUM  = #cpoOrdNum# -->
<!--        AND C.EZCANCELFLAG = '0' -->
<!--        AND C.GLBL_CMPY_CD  = CD.GLBL_CMPY_CD  -->
<!--        AND C.CPO_ORD_NUM   = CD.CPO_ORD_NUM  -->
<!--        AND CD.EZCANCELFLAG = '0'  -->
<!--        AND CD.GLBL_CMPY_CD         = OPCB.GLBL_CMPY_CD -->
<!--        AND CD.CPO_ORD_NUM          = OPCB.CPO_ORD_NUM -->
<!--        AND CD.CPO_DTL_LINE_NUM     = OPCB.CPO_DTL_LINE_NUM -->
<!--        AND CD.CPO_DTL_LINE_SUB_NUM = OPCB.CPO_DTL_LINE_SUB_NUM -->
<!--        AND OPCB.PRC_DTL_GRP_CD     = #prcDtlGrpCd# -->
<!--        AND OPCB.EZCANCELFLAG       = '0' -->
<!--    GROUP BY -->
<!--        OPCB.AUTO_PRC_AMT_RATE -->
    SELECT
         SUM(RATE)  AS TAX_RATE
       , SUM(AMT)   AS TAX_AMT
       , 'Sales Tax (' || TO_CHAR(SUM(RATE), 'FM999,999,999,999,990.0000') || '%)' AS PRC_RULE_DTL_CHRG_NM
    FROM (
        SELECT
            MAX(OPCB.AUTO_PRC_AMT_RATE) RATE
           ,SUM(NVL(OPCB.CALC_PRC_AMT_RATE,0)) AMT
        FROM
            S21_CSA_APPS.CPO C
            ,S21_CSA_APPS.CPO_DTL CD
            ,S21_CSA_APPS.ORD_PRC_CALC_BASE OPCB
        WHERE
            C.GLBL_CMPY_CD              = #glblCmpyCd#
            AND C.CPO_ORD_NUM           = #cpoOrdNum#
            AND C.EZCANCELFLAG          = '0'
            AND C.GLBL_CMPY_CD          = CD.GLBL_CMPY_CD
            AND C.CPO_ORD_NUM           = CD.CPO_ORD_NUM
            AND CD.EZCANCELFLAG         = '0'
            AND CD.GLBL_CMPY_CD         = OPCB.GLBL_CMPY_CD
            AND CD.CPO_ORD_NUM          = OPCB.CPO_ORD_NUM
            AND CD.CPO_DTL_LINE_NUM     = OPCB.CPO_DTL_LINE_NUM
            AND CD.CPO_DTL_LINE_SUB_NUM = OPCB.CPO_DTL_LINE_SUB_NUM
            AND OPCB.PRC_DTL_GRP_CD     = #prcDtlGrpCd#
            AND OPCB.EZCANCELFLAG       = '0'
        GROUP BY
            SUBSTR(OPCB.PRC_COND_TP_CD, 4, 1)
    )
    HAVING SUM(RATE) IS NOT NULL
    </statement>

    <statement id="getQuoteEasyPacMlyComitQty" parameterClass="Map"  resultClass="Map">
    SELECT
        SPC.SPLY_PGM_MLY_QUOT_QTY AS SPLY_PGM_MLY_QUOT_QTY
        ,SQ.BILL_TO_CUST_ACCT_CD  AS BILL_TO_CUST_ACCT_CD
    FROM
        SPLY_QUOTE                SQ
        ,SPLY_PGM_CONTR           SPC
    WHERE
        SQ.GLBL_CMPY_CD           = #glblCmpyCd#
    AND SQ.SPLY_QUOTE_NUM         = #splyQuoteNum#
    AND SQ.EZCANCELFLAG           = '0'
    AND SPC.GLBL_CMPY_CD          = SQ.GLBL_CMPY_CD
    AND SPC.BILL_TO_CUST_ACCT_CD  = SQ.BILL_TO_CUST_ACCT_CD
    AND SPC.EFF_FROM_DT       &lt;= #slsDt#
    AND (SPC.EFF_THRU_DT      &gt;= #slsDt#
        OR  SPC.EFF_THRU_DT      IS NULL)
    AND SPC.EZCANCELFLAG          = '0'
    AND ROWNUM                &lt;= 1
    </statement>

    <statement id="getOrderEasyPacMlyComitQty" parameterClass="Map"  resultClass="Map">
    SELECT
        SPC.SPLY_PGM_MLY_QUOT_QTY AS SPLY_PGM_MLY_QUOT_QTY
        ,CPO.BILL_TO_CUST_ACCT_CD AS BILL_TO_CUST_ACCT_CD
    FROM
        CPO                       CPO
        ,SPLY_PGM_CONTR           SPC
    WHERE
        CPO.GLBL_CMPY_CD          = #glblCmpyCd#
    AND CPO.CPO_ORD_NUM           = #cpoOrdNum#
    AND CPO.EZCANCELFLAG          = '0'
    AND SPC.GLBL_CMPY_CD          = CPO.GLBL_CMPY_CD
    AND SPC.BILL_TO_CUST_ACCT_CD  = CPO.BILL_TO_CUST_ACCT_CD
    AND SPC.EFF_FROM_DT       &lt;= #slsDt#
    AND (SPC.EFF_THRU_DT      &gt;= #slsDt#
        OR  SPC.EFF_THRU_DT      IS NULL)
    AND SPC.EZCANCELFLAG          = '0'
    AND ROWNUM                &lt;= 1
    </statement>

    <statement id="getEasyPacShipQty" parameterClass="Map">
        SELECT
             INV.BILL_TO_CUST_CD
            ,INV.BILL_TO_CUST_ACCT_CD
            ,INV.INV_TP_CD
            ,IL.ORD_QTY
            ,MDSE.AREA_OF_PAPER_NUM
        FROM
             INV                 INV
            ,ORD_CATG_BIZ_CTX    CTX
            ,SPLY_PGM_CONTR      SPC
            ,INV_BOL             IB
            ,INV_LINE            IL
            ,MDSE                MDSE
        WHERE
                INV.GLBL_CMPY_CD         = #glblCmpyCd#
            AND INV.BILL_TO_CUST_ACCT_CD = #billToCustAcctCd#
            AND INV.INV_DT            LIKE #slsDtLike#
            AND INV.FNLZ_INV_FLG         = #fnlzInvFlg#
            AND INV.EZCANCELFLAG         = '0'

            AND CTX.GLBL_CMPY_CD         = INV.GLBL_CMPY_CD
            AND CTX.ORD_CATG_CTX_TP_CD   IN 
            <iterate property="ordCatgCtxTpCdList" var="ordCatgCtxTpCd[]" open="(" close=")" conjunction=",">
                #ordCatgCtxTpCd[]#
            </iterate>
            AND CTX.DS_ORD_CATG_CD       = INV.DS_ORD_CATG_CD
            AND (CTX.DS_ORD_TP_CD        = INV.DS_ORD_TP_CD
                OR CTX.DS_ORD_TP_CD     IS NULL)
            AND CTX.EZCANCELFLAG         = '0'

            AND SPC.GLBL_CMPY_CD         = INV.GLBL_CMPY_CD
            AND SPC.BILL_TO_CUST_ACCT_CD = INV.BILL_TO_CUST_ACCT_CD
            AND SPC.EFF_FROM_DT      &lt;= #slsDt#
            AND (SPC.EFF_THRU_DT     &gt;= #slsDt#
                OR SPC.EFF_THRU_DT      IS NULL )
            AND SPC.EZCANCELFLAG         = '0'

            AND IB.GLBL_CMPY_CD          = INV.GLBL_CMPY_CD
            AND IB.INV_NUM               = INV.INV_NUM
            AND IB.EZCANCELFLAG          = '0'

            AND IL.GLBL_CMPY_CD          = IB.GLBL_CMPY_CD
            AND IL.INV_NUM               = IB.INV_NUM
            AND IL.INV_BOL_LINE_NUM      = IB.INV_BOL_LINE_NUM
            AND IL.SET_MDSE_CD          IS NULL
            AND IL.EZCANCELFLAG          = '0'
            
            AND MDSE.GLBL_CMPY_CD        = IL.GLBL_CMPY_CD
            AND MDSE.MDSE_CD             = IL.MDSE_CD
            AND MDSE.EASY_PACK_TP_CD     = #easyPackTpCd#
            AND MDSE.EZCANCELFLAG        = '0'
        ORDER BY
             INV.BILL_TO_CUST_ACCT_CD   ASC
            ,INV.INV_TP_CD              ASC
            ,INV.INV_NUM                ASC
            ,IL.INV_BOL_LINE_NUM        ASC
            ,IL.INV_LINE_NUM            ASC
            ,IL.INV_LINE_SUB_NUM        ASC
            ,IL.INV_LINE_SUB_TRX_NUM    ASC
    </statement>

    <statement id="getDeleteWrk" parameterClass="Map"  resultClass="Map">
        SELECT
            O.ORD_CONF_RPT_WRK_PK
        FROM
            ORD_CONF_RPT_WRK O
        WHERE
            O.GLBL_CMPY_CD     = #glblCmpyCd#
            AND O.BIZ_APP_ID   = #bizAppId#
            AND O.OTPT_OP_CD   = #otptOpCd#
            AND O.TRX_HDR_NUM  = #trxHdrNum#
            AND O.EZCANCELFLAG = '0'
    </statement>

</sqlMap>
