<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NMAL2500Query">

    <typeAlias alias="NMAL2500SMsg"		type="business.blap.NMAL2500.NMAL2500SMsg"/>
    <typeAlias alias="NMAL2500_ASMsg"	type="business.blap.NMAL2500.NMAL2500_ASMsg"/>
    <typeAlias alias="NMAL2500_TSMsg"	type="business.blap.NMAL2500.NMAL2500_TSMsg"/>
    <typeAlias alias="NMAL2500_OSMsg"   type="business.blap.NMAL2500.NMAL2500_OSMsg"/>
    <typeAlias alias="NMAL2500_RSMsg"   type="business.blap.NMAL2500.NMAL2500_RSMsg"/>

    <resultMap id="result.getContact"  class="NMAL2500_ASMsg">
        <result property="psnNum_A1"         column="PSN_NUM"              javaType="EZDSStringItem"/>
        <result property="psnTpCd_A1"        column="PSN_TP_CD"            javaType="EZDSStringItem"/>
        <result property="psnTpNm_A1"        column="PSN_TP_NM"            javaType="EZDSStringItem"/>
        <result property="psnFirstNm_A1"     column="PSN_FIRST_NM"         javaType="EZDSStringItem"/>
        <result property="psnLastNm_A1"      column="PSN_LAST_NM"          javaType="EZDSStringItem"/>
        <result property="jobTtlCd_A1"       column="JOB_TTL_CD"           javaType="EZDSStringItem"/>
        <result property="hrTtlNm_A1"        column="HR_TTL_NM"            javaType="EZDSStringItem"/>
        <result property="jobTtlNm_A1"       column="JOB_TTL_NM"           javaType="EZDSStringItem"/>
        <result property="psnCd_A1"          column="PSN_CD"               javaType="EZDSStringItem"/>
        <result property="hrSupvNm_A1"       column="HR_SUPV_NM"           javaType="EZDSStringItem"/>
        <result property="effFromDt_A1"      column="EFF_FROM_DT"          javaType="EZDCDateItem"/>
        <result property="effThruDt_A1"      column="EFF_THRU_DT"          javaType="EZDCDateItem"/>
    </resultMap>
    
    <resultMap id="result.getHierarchy"  class="NMAL2500_TSMsg">
        <result property="orgCd_T"              column="ORG_CD"                 javaType="EZDSStringItem"/>
        <result property="orgTierCd_T"          column="ORG_TIER_CD"            javaType="EZDSStringItem"/>
        <result property="orgNm_1"              column="FIRST_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_2"              column="SCD_ORG_NM"             javaType="EZDSStringItem"/>
        <result property="orgNm_3"              column="THIRD_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_4"              column="FRTH_ORG_NM"            javaType="EZDSStringItem"/>
        <result property="orgNm_5"              column="FIFTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_6"              column="SIXTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_7"              column="SVNTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_8"              column="EIGHTH_ORG_NM"          javaType="EZDSStringItem"/>
        <result property="orgNm_9"              column="NINTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_10"             column="TENTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="xxFullNm_T"           column="PSN_NM"                 javaType="EZDSStringItem"/>
        <result property="xxPsnNm_T"            column="PSN_NM_MGR"             javaType="EZDSStringItem"/>
        <result property="orgFuncRoleTpNm_T"    column="ORG_FUNC_ROLE_TP_NM"    javaType="EZDSStringItem"/>
        <result property="mgrFlg_T"             column="MGR_FLG"                javaType="EZDSStringItem"/>
        <result property="psnNum_T"             column="PSN_NUM"                javaType="EZDSStringItem"/>
        <result property="psnCd_T"              column="PSN_CD"                 javaType="EZDSStringItem"/>
    </resultMap>

    <resultMap id="result.getTargetOrg"  class="NMAL2500_OSMsg">
        <result property="orgCd_O1"              column="ORG_CD"                javaType="EZDSStringItem"/>
        <result property="orgNm_O1"              column="ORG_NM"                javaType="EZDSStringItem"/>
    </resultMap>

    <resultMap id="result.getTargetResource"  class="NMAL2500_RSMsg">
        <result property="psnCd_R1"              column="PSN_CD"                javaType="EZDSStringItem"/>
        <result property="xxPsnNm_R1"            column="XX_PSN_NM"             javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getVarCharConstPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               CONST.VAR_CHAR_CONST_VAL
              ,CONST.VAR_CHAR_CONST_DESC_TXT
          FROM
               VAR_CHAR_CONST CONST
         WHERE
               CONST.GLBL_CMPY_CD   = #globalCmpyCd#
           AND CONST.EZCANCELFLAG   = '0'
           AND CONST.VAR_CHAR_CONST_NM LIKE #modeCd#
         ORDER BY
               CONST.VAR_CHAR_CONST_VAL
    </statement>

    <statement id="getBizAreaOrgPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               ORG.BIZ_AREA_ORG_CD
              ,ORG.BIZ_AREA_ORG_NM
          FROM
               BIZ_AREA_ORG ORG
              ,ORG_STRU_TP STRU
         WHERE
               ORG.GLBL_CMPY_CD   = #globalCmpyCd#
           AND ORG.EZCANCELFLAG   = '0'
           AND STRU.GLBL_CMPY_CD  = #globalCmpyCd#
           AND STRU.EZCANCELFLAG  = '0'
           AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
           AND TRTY_STRU_FLG = 'N'
         ORDER BY
               ORG.BIZ_AREA_ORG_SORT_NUM
    </statement>

    <statement id="getOrgTierPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TIER.ORG_TIER_CD
              ,TIER.ORG_TIER_NM
          FROM
               ORG_TIER TIER
         WHERE
               TIER.GLBL_CMPY_CD  = #globalCmpyCd#
           AND TIER.EZCANCELFLAG  = '0'
           AND TIER.ORG_TIER_CD &gt; 0
         ORDER BY
               TIER.ORG_TIER_SORT_NUM
    </statement>

    <statement id="getCsrRgTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               CSR.CSR_RG_TP_CD
              ,CSR.CSR_RG_TP_NM
          FROM
               CSR_RG_TP CSR
         WHERE
               CSR.GLBL_CMPY_CD  = #globalCmpyCd#
           AND CSR.EZCANCELFLAG  = '0'
         ORDER BY
               CSR.CSR_RG_TP_SORT_NUM
    </statement>

    <statement id="getOrgFuncRoleTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               FUNC.ORG_FUNC_ROLE_TP_CD
              ,FUNC.ORG_FUNC_ROLE_TP_NM
          FROM
               ORG_FUNC_ROLE_TP FUNC
              ,BIZ_AREA_ORG BIZ
         WHERE
               FUNC.GLBL_CMPY_CD  = #globalCmpyCd#
           AND FUNC.EZCANCELFLAG  = '0'
           AND BIZ.GLBL_CMPY_CD  = #globalCmpyCd#
           AND BIZ.EZCANCELFLAG  = '0'
           AND FUNC.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
           AND BIZ.BIZ_AREA_ORG_SORT_NUM = #defaultBusinessArea#
         ORDER BY
               FUNC.ORG_FUNC_ROLE_TP_SORT_NUM
    </statement>
    
    <statement id="getOrgFuncRoleTpWithBusinessAreaPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               FUNC.ORG_FUNC_ROLE_TP_CD
              ,FUNC.ORG_FUNC_ROLE_TP_NM
          FROM
               ORG_FUNC_ROLE_TP FUNC
              ,BIZ_AREA_ORG BIZ
         WHERE
               FUNC.GLBL_CMPY_CD  = #globalCmpyCd#
           AND FUNC.EZCANCELFLAG  = '0'
           AND BIZ.GLBL_CMPY_CD  = #globalCmpyCd#
           AND BIZ.EZCANCELFLAG  = '0'
           AND FUNC.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
           <isNotNull property="cMsg.bizAreaOrgCd_P1">
           AND BIZ.BIZ_AREA_ORG_CD = #cMsg.bizAreaOrgCd_P1#
           </isNotNull>
         ORDER BY
               FUNC.ORG_FUNC_ROLE_TP_SORT_NUM
    </statement>

    <!-- CSA-QC#11652 Add Start -->
    <statement id="getTargetOrgForTopTierSearch" parameterClass="Map" resultMap="result.getTargetOrg">
    WITH ORG AS
    (
        SELECT
            ORG.ORG_CD
         ,  ORG.ORG_NM
        FROM
            DS_ORG_UNIT ORG
         ,  ORG_STRU_TP STRU
       <isEqual property="rsrcSearch" compareValue='Y'>
         ,  TOC_ORG_STRU_RELN RELN
         ,  ORG_FUNC_ASG      ASG
         ,  S21_PSN           PSN
        <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
         ,  ORG_TOC_CHNG_RQST RQST
        </isNotNull>
        <isNotNull property="cMsg.orgNm_H3">
         ,  DS_ORG_RESRC_RELN DORR
         ,  DS_ORG_UNIT       TRTY
         ,  ORG_STRU_TP       TRTY_TP
        </isNotNull>
       </isEqual>
        WHERE
            ORG.GLBL_CMPY_CD   = #glblCmpyCd#
        AND ORG.EZCANCELFLAG   = '0'
        AND STRU.GLBL_CMPY_CD  = #glblCmpyCd#
        AND STRU.EZCANCELFLAG  = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.EFF_FROM_DT   &lt;= #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD   = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        <isNotNull property="cMsg.orgTierCd_P2">
        AND ORG.ORG_TIER_CD    = #cMsg.orgTierCd_P2#
        </isNotNull>
        <isNotNull property ="cMsg.csrRgTpCd_P2">
        AND ORG.CSR_RG_TP_CD   = #cMsg.csrRgTpCd_P2#
        </isNotNull>
        <isNotNull property ="cMsg.orgNm_H2">
        AND ORG.ORG_NM      LIKE #cMsg.orgNm_H2#
        </isNotNull>
        <isEqual property ="rsrcSearch" compareValue='Y'>
            AND ORG.GLBL_CMPY_CD     =  RELN.GLBL_CMPY_CD
            AND ORG.ORG_CD           =  RELN.ORG_CD
            AND RELN.EZCANCELFLAG    =  '0'
            AND RELN.GLBL_CMPY_CD    =  ASG.GLBL_CMPY_CD
            AND RELN.TOC_CD          =  ASG.TOC_CD
            AND ASG.EZCANCELFLAG     =  '0'
            AND ASG.GLBL_CMPY_CD     =  PSN.GLBL_CMPY_CD
            AND ASG.PSN_CD           =  PSN.PSN_CD
            AND PSN.EZCANCELFLAG     =  '0'
            <!-- MOD START S21_NA QC#16481 -->
            <isNotNull property="cMsg.effFromDt_FR">
            AND RELN.EFF_FROM_DT &gt;=  #cMsg.effFromDt_FR#
            AND ASG.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_FR#
            AND PSN.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_FR#
            </isNotNull>
            <isNotNull property="cMsg.effFromDt_TO">
            AND RELN.EFF_FROM_DT &lt;=  #cMsg.effFromDt_TO#
            AND ASG.EFF_FROM_DT  &lt;=  #cMsg.effFromDt_TO#
            AND PSN.EFF_FROM_DT  &lt;=  #cMsg.effFromDt_TO#
            </isNotNull>
            <isNull property="cMsg.effFromDt_FR">
            <isNull property="cMsg.effFromDt_TO">
            AND RELN.EFF_FROM_DT &lt;=  #slsDt#
            AND ASG.EFF_FROM_DT  &lt;=  #slsDt#
            AND PSN.EFF_FROM_DT  &lt;=  #slsDt#
            </isNull>
            </isNull>
            <!-- MOD END S21_NA QC#16481 -->
            AND NVL(RELN.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#
            AND NVL(ASG.EFF_THRU_DT ,#maxeffThruDt#)  &gt;= #slsDt#
            AND NVL(PSN.EFF_THRU_DT ,#maxeffThruDt#)  &gt;= #slsDt#
            <isNotNull property="cMsg.xxPsnNm_H3">
            AND
                (
                    UPPER(PSN.PSN_LAST_NM)  LIKE UPPER(#cMsg.xxPsnNm_H3#)
                OR  UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
                OR  UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
                )
            </isNotNull>
            <isNotNull property="cMsg.psnCd_H3">
            AND PSN.PSN_CD     LIKE #cMsg.psnCd_H3#
            </isNotNull>
            <isNotNull property="cMsg.xxPsnNum_H3">
            AND PSN.PSN_NUM    LIKE #cMsg.xxPsnNum_H3#
            </isNotNull>
            <isNotNull property="cMsg.jobTtlCd_H3">
            AND PSN.JOB_TTL_CD LIKE #cMsg.jobTtlCd_H3#
            </isNotNull>
            <isNotNull property ="cMsg.hrTtlNm_H3">
            AND PSN.HR_TTL_NM  LIKE #cMsg.hrTtlNm_H3#
            </isNotNull>
            <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
            AND ASG.GLBL_CMPY_CD          = RQST.GLBL_CMPY_CD
            AND ASG.TOC_CD                = RQST.TOC_CD
            AND RQST.EZCANCELFLAG         = 0
            AND (RQST.RGTN_STS_CD = #rgtnStsCdP01# OR RQST.RGTN_STS_CD = #rgtnStsCdP20#)
            AND RQST.ORG_FUNC_ROLE_TP_CD  = #cMsg.orgFuncRoleTpCd_P3#
            </isNotNull>
            <isNotNull property="cMsg.orgNm_H3">
            AND PSN.GLBL_CMPY_CD      =  DORR.GLBL_CMPY_CD
            AND PSN.PSN_CD            =  DORR.PSN_CD
            AND DORR.EZCANCELFLAG     =  '0'
            AND DORR.EFF_FROM_DT  &lt;=  #slsDt#
            AND NVL(DORR.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#

            AND DORR.GLBL_CMPY_CD     =  TRTY.GLBL_CMPY_CD
            AND DORR.ORG_CD           =  TRTY.ORG_CD
            AND TRTY.EZCANCELFLAG     =  '0'
            AND TRTY.EFF_FROM_DT  &lt;=  #slsDt#
            AND NVL(TRTY.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#

            AND TRTY.GLBL_CMPY_CD     =  TRTY_TP.GLBL_CMPY_CD
            AND TRTY.ORG_STRU_TP_CD   =  TRTY_TP.ORG_STRU_TP_CD
            AND TRTY_TP.TRTY_STRU_FLG =  'Y'
            AND TRTY_TP.EZCANCELFLAG  =  0

            AND TRTY.ORG_NM        LIKE  #cMsg.orgNm_H3#
            </isNotNull>
        </isEqual>
    )
    , RELN AS
    (
        (
            SELECT
                DISTINCT ORG.ORG_CD
              , ORG.ORG_NM
            FROM
                DS_ORG_UNIT ORG
             ,  DS_ORG_RELN RELN
            WHERE
                ORG.GLBL_CMPY_CD    = #glblCmpyCd#
            AND ORG.EZCANCELFLAG    = '0'
            AND ORG.ORG_TIER_CD     = #orgTierCd_1#
            AND ORG.GLBL_CMPY_CD    = RELN.GLBL_CMPY_CD
            AND ORG.ORG_CD          = RELN.ORG_CD
            AND RELN.EZCANCELFLAG   = '0'
            START WITH RELN.ORG_CD IN (SELECT ORG_CD FROM ORG)
            CONNECT BY NOCYCLE PRIOR
                RELN.PRNT_ORG_CD  = RELN.ORG_CD
                AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
                AND RELN.EZCANCELFLAG = 0
                AND ( RELN.EFF_FROM_DT                      &lt;= #slsDt#
                      AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt# )
                AND RELN.GNRN_TP_CD IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
        ) UNION (
            SELECT
                DISTINCT ORG.ORG_CD
              , ORG.ORG_NM
            FROM
                ORG
            WHERE
                ORG.ORG_CD   NOT IN
                         (
                           SELECT
                               RELN.ORG_CD
                           FROM
                               DS_ORG_RELN RELN
                            ,  ORG_STRU_TP STRU
                           WHERE RELN.GLBL_CMPY_CD = #glblCmpyCd#
                           AND RELN.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
                           AND RELN.GLBL_CMPY_CD   = STRU.GLBL_CMPY_CD 
                           AND ( RELN.EFF_FROM_DT                          &lt;= #slsDt#
                                 AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt# )
                           AND RELN.GNRN_TP_CD IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
                           AND STRU.TRTY_STRU_FLG  = 'N'
                           AND RELN.EZCANCELFLAG   = '0'
                           AND STRU.EZCANCELFLAG   = '0'
                         )
          )
    )

    SELECT
        DISTINCT RELN.ORG_CD
     ,  RELN.ORG_NM
    FROM
        RELN        RELN
    ORDER BY
        RELN.ORG_CD
    </statement>
    <!-- CSA-QC#11652 Add End -->

    <statement id="getTargetOrg" parameterClass="Map" resultMap="result.getTargetOrg">
    SELECT
        ORG.ORG_CD
        ,ORG.ORG_NM
    FROM
        DS_ORG_UNIT ORG
        ,ORG_STRU_TP STRU
        <isEqual property="rsrcSearch" compareValue='Y'>
        ,TOC_ORG_STRU_RELN RELN
        ,ORG_FUNC_ASG      ASG
        ,S21_PSN           PSN
           <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
           ,ORG_TOC_CHNG_RQST RQST
           </isNotNull>
           <isNotNull property="cMsg.orgNm_H3">
           ,DS_ORG_RESRC_RELN DORR
           ,DS_ORG_UNIT       TRTY
           ,ORG_STRU_TP       TRTY_TP
           </isNotNull>
        </isEqual>
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'N'
    <isNotNull property="cMsg.bizAreaOrgCd_P1">
    AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.orgTierCd_P2">
    AND ORG.ORG_TIER_CD = #cMsg.orgTierCd_P2#
    </isNotNull>
    <isNotNull property="cMsg.csrRgTpCd_P2">
    AND ORG.CSR_RG_TP_CD = #cMsg.csrRgTpCd_P2#
    </isNotNull>
    <isNotNull property="cMsg.orgNm_H2">
    AND ORG.ORG_NM LIKE #cMsg.orgNm_H2#
    </isNotNull>
    <isEqual property="rsrcSearch" compareValue='Y'>
        AND ORG.GLBL_CMPY_CD     =  RELN.GLBL_CMPY_CD
        AND ORG.ORG_CD           =  RELN.ORG_CD
        AND RELN.EZCANCELFLAG    =  '0'
        AND RELN.GLBL_CMPY_CD    =  ASG.GLBL_CMPY_CD
        AND RELN.TOC_CD          =  ASG.TOC_CD
        AND ASG.EZCANCELFLAG     =  '0'
        AND ASG.GLBL_CMPY_CD     =  PSN.GLBL_CMPY_CD
        AND ASG.PSN_CD           =  PSN.PSN_CD
        AND PSN.EZCANCELFLAG     =  '0'
        <!-- MOD START S21_NA QC#16481 -->
        <isNotNull property="cMsg.effFromDt_FR">
        AND RELN.EFF_FROM_DT &gt;=  #cMsg.effFromDt_FR#
        AND ASG.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_FR#
        AND PSN.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_FR#
        </isNotNull>
        <isNotNull property="cMsg.effFromDt_TO">
        AND RELN.EFF_FROM_DT &lt;=  #cMsg.effFromDt_TO#
        AND ASG.EFF_FROM_DT  &lt;=  #cMsg.effFromDt_TO#
        AND PSN.EFF_FROM_DT  &lt;=  #cMsg.effFromDt_TO#
        </isNotNull>
        <isNull property="cMsg.effFromDt_FR">
        <isNull property="cMsg.effFromDt_TO">
        AND RELN.EFF_FROM_DT &lt;=  #slsDt#
        AND ASG.EFF_FROM_DT  &lt;=  #slsDt#
        AND PSN.EFF_FROM_DT  &lt;=  #slsDt#
        </isNull>
        </isNull>
        <!-- MOD END S21_NA QC#16481 -->
        AND NVL(RELN.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#
        AND NVL(ASG.EFF_THRU_DT ,#maxeffThruDt#)  &gt;= #slsDt#
        AND NVL(PSN.EFF_THRU_DT ,#maxeffThruDt#)  &gt;= #slsDt#
        <isNotNull property="cMsg.xxPsnNm_H3">
        AND
            (
                UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
            OR  UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
            OR  UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
            )
        </isNotNull>
        <isNotNull property="cMsg.psnCd_H3">
        AND PSN.PSN_CD LIKE #cMsg.psnCd_H3#
        </isNotNull>
        <isNotNull property="cMsg.psnNum_H3">
        AND PSN.PSN_NUM LIKE #cMsg.psnNum_H3#
        </isNotNull>
        <isNotNull property="cMsg.jobTtlCd_H3">
        AND PSN.JOB_TTL_CD LIKE #cMsg.jobTtlCd_H3#
        </isNotNull>
        <isNotNull property ="cMsg.hrTtlNm_H3">
        AND PSN.HR_TTL_NM LIKE #cMsg.hrTtlNm_H3#
        </isNotNull>
        <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
        AND ASG.GLBL_CMPY_CD          = RQST.GLBL_CMPY_CD
        AND ASG.TOC_CD                = RQST.TOC_CD
        AND RQST.EZCANCELFLAG         = 0
        AND (RQST.RGTN_STS_CD = #rgtnStsCdP01# OR RQST.RGTN_STS_CD = #rgtnStsCdP20#)
        AND RQST.ORG_FUNC_ROLE_TP_CD  = #cMsg.orgFuncRoleTpCd_P3#
        </isNotNull>
        <isNotNull property="cMsg.orgNm_H3">
        AND PSN.GLBL_CMPY_CD      =  DORR.GLBL_CMPY_CD
        AND PSN.PSN_CD            =  DORR.PSN_CD
        AND DORR.EZCANCELFLAG     =  '0'
        AND DORR.EFF_FROM_DT  &lt;=  #slsDt#
        AND NVL(DORR.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#

        AND DORR.GLBL_CMPY_CD     =  TRTY.GLBL_CMPY_CD
        AND DORR.ORG_CD           =  TRTY.ORG_CD
        AND TRTY.EZCANCELFLAG     =  '0'
        AND TRTY.EFF_FROM_DT  &lt;=  #slsDt#
        AND NVL(TRTY.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#

        AND TRTY.GLBL_CMPY_CD     =  TRTY_TP.GLBL_CMPY_CD
        AND TRTY.ORG_STRU_TP_CD   =  TRTY_TP.ORG_STRU_TP_CD
        AND TRTY_TP.TRTY_STRU_FLG =  'Y'
        AND TRTY_TP.EZCANCELFLAG  =  0

        AND TRTY.ORG_NM        LIKE  #cMsg.orgNm_H3#
        </isNotNull>
    </isEqual>
    ORDER BY
        ORG.ORG_TIER_CD, ORG.ORG_CD
    </statement>

    <statement id="getTargetResource" parameterClass="Map" resultMap="result.getTargetResource">
        SELECT
            PSN.PSN_CD PSN_CD
            , NVL(PSN.PSN_FIRST_NM,'') || ' ' || NVL(PSN.PSN_LAST_NM,'') AS XX_PSN_NM
        FROM
            S21_PSN           PSN
           ,ORG_FUNC_ASG      ASG
           ,TOC_ORG_STRU_RELN RELN
           ,DS_ORG_UNIT       ORG
        WHERE
            PSN.GLBL_CMPY_CD = #glblCmpyCd#
        AND PSN.EZCANCELFLAG = '0'
        <isNotNull property="cMsg.xxPsnNm_H3">
            AND
                (
                    UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#xxPsnNm#)
                OR  UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#xxPsnNm#)
                OR  UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#xxPsnNm#)
                )
        </isNotNull>
        
        <isNotNull property="cMsg.psnCd_H3">
            AND PSN.PSN_CD LIKE #psnCd#
        </isNotNull>
        <isNotNull property="cMsg.jobTtlCd_H3">
            AND PSN.JOB_TTL_CD LIKE #jobTtlCd#
        </isNotNull>
        <isNotNull property="cMsg.hrTtlNm_H3">
            AND UPPER(PSN.HR_TTL_NM) LIKE UPPER(#jobTtlNm#)
        </isNotNull>
        <isNotNull property="cMsg.psnNum_H3">
            AND PSN.PSN_NUM LIKE #psnNum#
        </isNotNull>
        <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
            AND EXISTS(
                    SELECT
                        1
                    FROM
                        ORG_FUNC_ASG ASG
                        ,ORG_TOC_CHNG_RQST CHNG
                        ,ORG_FUNC_ROLE_TP ROLE
                    WHERE
                        ASG.GLBL_CMPY_CD = #glblCmpyCd#
                    AND ASG.EZCANCELFLAG = '0'
                    AND CHNG.GLBL_CMPY_CD = #glblCmpyCd#
                    AND CHNG.EZCANCELFLAG = '0'
                    AND ROLE.GLBL_CMPY_CD = #glblCmpyCd#
                    AND ROLE.EZCANCELFLAG = '0'
                    AND PSN.PSN_CD = ASG.PSN_CD
                    AND ASG.TOC_CD = CHNG.TOC_CD
                    AND CHNG.ORG_FUNC_ROLE_TP_CD = ROLE.ORG_FUNC_ROLE_TP_CD
                    AND ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
                    AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD = #gnrnTpCdFuture#)
                    AND (CHNG.RGTN_STS_CD = #rgtnStsCdP01# OR CHNG.RGTN_STS_CD = #rgtnStsCdP20#)
                )
        </isNotNull>
        
        <isNotNull property="cMsg.orgNm_H3">
            AND EXISTS(
                    SELECT
                        1
                    FROM
                        DS_ORG_RESRC_RELN RELN
                       ,DS_ORG_UNIT ORG
                    WHERE
                        RELN.GLBL_CMPY_CD = #glblCmpyCd#
                    AND RELN.EZCANCELFLAG = '0'
                    AND ORG.GLBL_CMPY_CD = #glblCmpyCd#
                    AND ORG.EZCANCELFLAG = '0'
                    AND RELN.EFF_FROM_DT &lt;= #slsDt#
                    AND (RELN.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL)
                    AND RELN.PSN_CD = PSN.PSN_CD
                    AND RELN.ORG_CD = ORG.ORG_CD
                    AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD = #gnrnTpCdFuture#)
                    AND ORG.ORG_NM LIKE #orgNm#
                )
        </isNotNull>
        
        <!-- MOD START S21_NA QC#16481 -->
        <isNotNull property="cMsg.effFromDt_FR">
            AND PSN.EFF_FROM_DT &gt;= #effFromDt_FR#
        </isNotNull>
        <isNotNull property="cMsg.effFromDt_TO">
            AND PSN.EFF_FROM_DT &lt;= #effFromDt_TO#
        </isNotNull>
        <isNotNull property="cMsg.effThruDt_FR">
            AND (PSN.EFF_THRU_DT &gt;= #effThruDt_FR# OR PSN.EFF_THRU_DT IS NULL)
        </isNotNull>
        <isNotNull property="cMsg.effThruDt_TO">
            AND (PSN.EFF_THRU_DT &gt;= #effThruDt_TO# OR PSN.EFF_THRU_DT IS NULL)            
        </isNotNull>
        <!-- MOD END S21_NA QC#16481 -->
        AND PSN.GLBL_CMPY_CD = ASG.GLBL_CMPY_CD
        AND PSN.PSN_CD       = ASG.PSN_CD
        AND ASG.EZCANCELFLAG = '0'
        AND ASG.GNRN_TP_CD  IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
        AND ASG.GLBL_CMPY_CD = RELN.GLBL_CMPY_CD
        AND ASG.TOC_CD       = RELN.TOC_CD
        AND RELN.GLBL_CMPY_CD = ORG.GLBL_CMPY_CD
        AND RELN.ORG_CD       = ORG.ORG_CD
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD = #gnrnTpCdFuture#)
        AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD = #gnrnTpCdFuture#)
            <!-- MOD START S21_NA QC#16481 -->
            <isNull property="cMsg.effFromDt_FR">
            <isNull property="cMsg.effFromDt_TO">
            AND PSN.EFF_FROM_DT &lt;= #slsDt#
            AND RELN.EFF_FROM_DT  &lt;= #slsDt#
            AND ORG.EFF_FROM_DT  &lt;= #slsDt#
            </isNull>
            </isNull>
            <isNull property="cMsg.effThruDt_FR">
            <isNull property="cMsg.effThruDt_TO">
            AND (PSN.EFF_THRU_DT &gt;= #slsDt# OR PSN.EFF_THRU_DT IS NULL)
            AND (RELN.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL)
            AND (ORG.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL)
            </isNull>
            </isNull>
            <!-- MOD END S21_NA QC#16481 -->
        </isNotEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        <isNotNull property="cMsg.orgTierCd_P2">
        AND ORG.ORG_TIER_CD = #cMsg.orgTierCd_P2#
        </isNotNull>
        <isNotNull property="cMsg.csrRgTpCd_P2">
        AND ORG.CSR_RG_TP_CD = #cMsg.csrRgTpCd_P2#
        </isNotNull>
        <isNotNull property="cMsg.orgNm_H2">
        AND ORG.ORG_NM LIKE #cMsg.orgNm_H2#
        </isNotNull>

        AND ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="getResource" parameterClass="Map" resultMap="result.getContact">
    WITH ORG AS (
    SELECT
        PSN.PSN_CD
       ,BIZ.BIZ_AREA_ORG_CD
       ,ORG.ORG_NM
       ,ORG.ORG_TIER_CD
       ,ORG.CSR_RG_TP_CD
    FROM
         DS_ORG_UNIT ORG
        ,TOC_ORG_STRU_RELN RELN
        ,ORG_STRU_TP STRU
        ,BIZ_AREA_ORG BIZ
        ,ORG_TOC_CHNG_RQST RQST
        ,ORG_FUNC_ASG ASG
        ,S21_PSN PSN
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
    AND RELN.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND BIZ.GLBL_CMPY_CD = #glblCmpyCd#
    AND BIZ.EZCANCELFLAG = '0'
    AND RQST.GLBL_CMPY_CD = #glblCmpyCd#
    AND RQST.EZCANCELFLAG = '0'
    AND ASG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ASG.EZCANCELFLAG = '0'
    AND PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    <isNotNull property="cMsg.bizAreaOrgCd_P1">
    AND BIZ.BIZ_AREA_ORG_CD = #bizAreaOrgCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.orgNm_H2">
    AND ORG.ORG_NM LIKE #orgNm_H2#
    </isNotNull>
    <isNotNull property="cMsg.orgTierCd_P2">
    AND ORG.ORG_TIER_CD = #orgTierCd_P2#
    </isNotNull>
    <isNotNull property="cMsg.csrRgTpCd_P2">
    AND ORG.CSR_RG_TP_CD = #csrRgTpCd_P2#
    </isNotNull>
    <isNotEqual property="includeInactive" compareValue='Y'>
    AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD = #gnrnTpCdFuture#)
    AND RELN.EFF_FROM_DT &lt;= #slsDt#
    AND (RELN.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL)
    AND (RQST.RGTN_STS_CD = #rgtnStsCdP01# OR RQST.RGTN_STS_CD = #rgtnStsCdP20#)
    AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD = #gnrnTpCdFuture#)
    </isNotEqual>
    AND ORG.ORG_CD = RELN.ORG_CD
    AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'N'
    AND ORG.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
    AND STRU.ORG_STRU_TP_CD = BIZ.ORG_STRU_TP_CD
    AND RQST.TOC_CD = RELN.TOC_CD
    AND RQST.ORG_CD = RELN.ORG_CD
    AND RQST.TOC_CD = ASG.TOC_CD
    AND ASG.PSN_CD = PSN.PSN_CD
    )

    SELECT
         DISTINCT(PSN.PSN_CD)
        ,TP.PSN_TP_CD
        ,TP.PSN_TP_NM
        ,PSN.PSN_LAST_NM
        ,PSN.PSN_FIRST_NM
        ,PSN.JOB_TTL_CD
        ,PSN.HR_TTL_NM
        ,NVL(PSN.JOB_TTL_CD,'') || ' ' || NVL(PSN.HR_TTL_NM,'') AS JOB_TTL_NM
        ,PSN.PSN_NUM
        ,PSN.HR_SUPV_NM
        ,PSN.EFF_FROM_DT
        ,PSN.EFF_THRU_DT
    FROM
        S21_PSN PSN
        ,PSN_TP TP
        ,ORG
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND TP.GLBL_CMPY_CD = #glblCmpyCd#
    AND TP.EZCANCELFLAG = '0'
    AND PSN.PSN_TP_CD = TP.PSN_TP_CD
    <isNotEqual property="cMsg.xxModeCd_P1" compareValue='10'>
    AND PSN.PSN_CD = ORG.PSN_CD(+)
    </isNotEqual>
    <isNotEqual property="cMsg.xxModeCd_P1" compareValue='20'>
    AND PSN.PSN_CD = ORG.PSN_CD
    </isNotEqual>
    <isNotNull property="cMsg.orgNm_H2">
    AND PSN.PSN_CD = ORG.PSN_CD
    </isNotNull>
    <isNotNull property="cMsg.orgTierCd_P2">
    AND PSN.PSN_CD = ORG.PSN_CD
    </isNotNull>
    <isNotNull property="cMsg.csrRgTpCd_P2">
    AND PSN.PSN_CD = ORG.PSN_CD
    </isNotNull>
    <isNotNull property="cMsg.xxPsnNm_H3">
    AND
        (
            UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#xxPsnNm#)
        OR  UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#xxPsnNm#)
        OR  UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#xxPsnNm#)
        )
    </isNotNull>
    <isNotNull property="cMsg.psnCd_H3">
    AND PSN.PSN_CD LIKE #psnCd#
    </isNotNull>
    <isNotNull property="cMsg.jobTtlCd_H3">
    AND PSN.JOB_TTL_CD = #jobTtlCd#
    </isNotNull>
    <isNotNull property="cMsg.hrTtlNm_H3">
    AND UPPER(PSN.HR_TTL_NM) = UPPER(#jobTtlNm#)
    </isNotNull>
    <isNotNull property="cMsg.psnNum_H3">
    AND PSN.PSN_NUM = #psnNum#
    </isNotNull>
    <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
    AND EXISTS(
            SELECT
                1
            FROM
                ORG_FUNC_ASG ASG
                ,ORG_TOC_CHNG_RQST CHNG
                ,ORG_FUNC_ROLE_TP ROLE
            WHERE
                ASG.GLBL_CMPY_CD = #glblCmpyCd#
            AND ASG.EZCANCELFLAG = '0'
            AND CHNG.GLBL_CMPY_CD = #glblCmpyCd#
            AND CHNG.EZCANCELFLAG = '0'
            AND ROLE.GLBL_CMPY_CD = #glblCmpyCd#
            AND ROLE.EZCANCELFLAG = '0'
            AND PSN.PSN_CD = ASG.PSN_CD
            AND ASG.TOC_CD = CHNG.TOC_CD
            AND CHNG.ORG_FUNC_ROLE_TP_CD = ROLE.ORG_FUNC_ROLE_TP_CD
            AND ROLE.ORG_FUNC_ROLE_TP_CD = #orgFuncRoleTpCd#
            AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD = #gnrnTpCdFuture#)
            AND (CHNG.RGTN_STS_CD = #rgtnStsCdP01# OR CHNG.RGTN_STS_CD = #rgtnStsCdP20#)
        )
    </isNotNull>
    <isNotNull property="cMsg.orgNm_H3">
    AND EXISTS(
            SELECT
                1
            FROM
                DS_ORG_RESRC_RELN RELN
               ,DS_ORG_UNIT ORG
            WHERE
                RELN.GLBL_CMPY_CD = #glblCmpyCd#
            AND RELN.EZCANCELFLAG = '0'
            AND ORG.GLBL_CMPY_CD = #glblCmpyCd#
            AND ORG.EZCANCELFLAG = '0'
            AND RELN.EFF_FROM_DT &lt;= #slsDt#
            AND (RELN.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL)
            AND RELN.PSN_CD = PSN.PSN_CD
            AND RELN.ORG_CD = ORG.ORG_CD
            AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD = #gnrnTpCdFuture#)
            AND ORG.ORG_NM LIKE #orgNm#
        )
    </isNotNull>
    <!-- MOD START S21_NA QC#16481 -->
    <isNotNull property="cMsg.effFromDt_FR">
    AND PSN.EFF_FROM_DT &gt;= #effFromDt_FR#
    </isNotNull>
    <isNotNull property="cMsg.effFromDt_TO">
    AND PSN.EFF_FROM_DT &lt;= #effFromDt_TO#
    </isNotNull>
    <isNotNull property="cMsg.effThruDt_FR">
    AND (PSN.EFF_THRU_DT &gt;= #effThruDt_FR# OR PSN.EFF_THRU_DT IS NULL)
    </isNotNull>
    <isNotNull property="cMsg.effThruDt_TO">
    AND (PSN.EFF_THRU_DT &lt;= #effThruDt_TO# OR PSN.EFF_THRU_DT IS NULL)
    <!-- MOD END S21_NA QC#16481 -->
    </isNotNull>
    ORDER BY
        PSN.PSN_CD
    </statement>

    <statement id="getHierarchyTopTier" parameterClass="Map" resultMap="result.getHierarchy">
    SELECT
        ORG.ORG_CD AS ORG_CD
       ,ORG.ORG_TIER_CD AS ORG_TIER_CD
       ,ORG.ORG_NM AS FIRST_ORG_NM
    FROM
        DS_ORG_UNIT        ORG
        ,ORG_STRU_TP       TP
        ,BIZ_AREA_ORG      BIZ
        <isEqual property="rsrcSearch" compareValue='Y'>
        ,TOC_ORG_STRU_RELN RELN
        ,ORG_FUNC_ASG      ASG
        ,S21_PSN           PSN
           <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
           ,ORG_TOC_CHNG_RQST RQST
           </isNotNull>
           <isNotNull property="cMsg.orgNm_H3">
           ,DS_ORG_RESRC_RELN DORR
           ,DS_ORG_UNIT       TRTY
           ,ORG_STRU_TP       TRTY_TP
           </isNotNull>
        </isEqual>
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.GLBL_CMPY_CD = TP.GLBL_CMPY_CD
    AND ORG.GLBL_CMPY_CD = BIZ.GLBL_CMPY_CD
    AND ORG.EZCANCELFLAG = '0'
    AND TP.EZCANCELFLAG  = '0'
    AND BIZ.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = TP.ORG_STRU_TP_CD
    AND TP.TRTY_STRU_FLG = 'N'
    AND ORG.ORG_TIER_CD  = #orgTierCd#
    AND ORG.FIRST_ORG_CD = BIZ.BIZ_AREA_ORG_CD
    <isNotEqual property="includeInactive" compareValue='Y'>
    AND ORG.EFF_FROM_DT &lt;= #slsDt#
    AND NVL(ORG.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#
    AND ORG.GNRN_TP_CD IN(#gnrnTpCdCurrent# ,#gnrnTpCdFuture#)
    </isNotEqual>
    <isNotNull property="cMsg.bizAreaOrgCd_P1">
    AND BIZ.BIZ_AREA_ORG_CD = #cMsg.bizAreaOrgCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.orgNm_H2">
    AND ORG.ORG_NM       LIKE #cMsg.orgNm_H2#
    </isNotNull>
    <isNotNull property="cMsg.orgTierCd_P2">
    AND ORG.ORG_TIER_CD  = #cMsg.orgTierCd_P2#
    </isNotNull>
    <isNotNull property="cMsg.csrRgTpCd_P2">
    AND ORG.CSR_RG_TP_CD = #cMsg.csrRgTpCd_P2#
    </isNotNull>
    <isEqual property="rsrcSearch" compareValue='Y'>
        AND ORG.GLBL_CMPY_CD     =  RELN.GLBL_CMPY_CD
        AND ORG.ORG_CD           =  RELN.ORG_CD
        AND RELN.EZCANCELFLAG    =  '0'
        AND RELN.GLBL_CMPY_CD    =  ASG.GLBL_CMPY_CD
        AND RELN.TOC_CD          =  ASG.TOC_CD
        AND ASG.EZCANCELFLAG     =  '0'
        AND ASG.GLBL_CMPY_CD     =  PSN.GLBL_CMPY_CD
        AND ASG.PSN_CD           =  PSN.PSN_CD
        AND PSN.EZCANCELFLAG     =  '0'
        <!-- MOD START S21_NA QC#16481 -->
        <isNotNull property="cMsg.effFromDt_FR">
        AND RELN.EFF_FROM_DT &gt;=  #cMsg.effFromDt_FR#
        AND ASG.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_FR#
        AND PSN.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_FR#
        </isNotNull>
        <isNotNull property="cMsg.effFromDt_TO">
        AND RELN.EFF_FROM_DT &gt;=  #cMsg.effFromDt_TO#
        AND ASG.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_TO#
        AND PSN.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_TO#
        </isNotNull>
        <isNull property="cMsg.effFromDt_FR">
        <isNull property="cMsg.effFromDt_TO">
        AND RELN.EFF_FROM_DT &lt;=  #slsDt#
        AND ASG.EFF_FROM_DT  &lt;=  #slsDt#
        AND PSN.EFF_FROM_DT  &lt;=  #slsDt#
        </isNull>
        </isNull>
        <!-- MOD END S21_NA QC#16481 -->
        AND NVL(RELN.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#
        AND NVL(ASG.EFF_THRU_DT ,#maxeffThruDt#)  &gt;= #slsDt#
        AND NVL(PSN.EFF_THRU_DT ,#maxeffThruDt#)  &gt;= #slsDt#
        <isNotNull property="cMsg.xxPsnNm_H3">
        AND
            (
                UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
            OR  UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
            OR  UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
            )
        </isNotNull>
        <isNotNull property="cMsg.psnCd_H3">
        AND PSN.PSN_CD LIKE #cMsg.psnCd_H3#
        </isNotNull>
        <isNotNull property="cMsg.xxPsnNum_H3">
        AND PSN.PSN_NUM LIKE #cMsg.xxPsnNum_H3#
        </isNotNull>
        <isNotNull property="cMsg.jobTtlCd_H3">
        AND PSN.JOB_TTL_CD LIKE #cMsg.jobTtlCd_H3#
        </isNotNull>
        <isNotNull property ="cMsg.hrTtlNm_H3">
        AND PSN.HR_TTL_NM LIKE #cMsg.hrTtlNm_H3#
        </isNotNull>
        <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
        AND ASG.GLBL_CMPY_CD          = RQST.GLBL_CMPY_CD
        AND ASG.TOC_CD                = RQST.TOC_CD
        AND RQST.EZCANCELFLAG         = 0
        AND (RQST.RGTN_STS_CD = #rgtnStsCdP01# OR RQST.RGTN_STS_CD = #rgtnStsCdP20#)
        AND RQST.ORG_FUNC_ROLE_TP_CD  = #cMsg.orgFuncRoleTpCd_P3#
        </isNotNull>

        <isNotNull property="cMsg.orgNm_H3">
        AND PSN.GLBL_CMPY_CD      =  DORR.GLBL_CMPY_CD
        AND PSN.PSN_CD            =  DORR.PSN_CD
        AND DORR.EZCANCELFLAG     =  '0'
        AND DORR.EFF_FROM_DT  &lt;=  #slsDt#
        AND NVL(DORR.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#

        AND DORR.GLBL_CMPY_CD     =  TRTY.GLBL_CMPY_CD
        AND DORR.ORG_CD           =  TRTY.ORG_CD
        AND TRTY.EZCANCELFLAG     =  '0'
        AND TRTY.EFF_FROM_DT  &lt;=  #slsDt#
        AND NVL(TRTY.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#

        AND TRTY.GLBL_CMPY_CD     =  TRTY_TP.GLBL_CMPY_CD
        AND TRTY.ORG_STRU_TP_CD   =  TRTY_TP.ORG_STRU_TP_CD
        AND TRTY_TP.TRTY_STRU_FLG =  'Y'
        AND TRTY_TP.EZCANCELFLAG  =  0

        AND TRTY.ORG_NM        LIKE  #cMsg.orgNm_H3#
        </isNotNull>
    </isEqual>
    </statement>

    <statement id="getHierarchy" parameterClass="Map" resultMap="result.getHierarchy">
    WITH WRK AS(
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,RELN.PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.CSR_RG_TP_CD
        FROM
            DS_ORG_UNIT ORG
            ,DS_ORG_RELN RELN
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
        AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
       <isNotEqual property="includeInactive" compareValue='Y'>
       <!-- 2018/03/07 QC#20233-1 add start -->
        AND RELN.GNRN_TP_CD != #gnrnTpCdPast#
       <!-- 2018/03/07 QC#20233-1 add end -->
        AND RELN.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
        AND ORG.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
       </isNotEqual>
      <!--
        AND (RELN.GNRN_TP_CD = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD = #gnrnTpCdFuture#)
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
        </isNotEqual>
      -->
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        UNION ALL
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,ORG.ORG_CD AS PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.CSR_RG_TP_CD
        FROM
            DS_ORG_UNIT ORG
           ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG ='N'
        AND ORG.ORG_TIER_CD = '0'
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
    )


    , NORELN_TOPTIER AS(
        SELECT
            RELN.ORG_CD
          , ORG.ORG_TIER_CD
          , ORG.ORG_NM
          , ORG.FIRST_ORG_CD
          , ORG.TRTY_GRP_TP_CD
          , ORG.TRTY_TP_CD
          , RELN.PRNT_ORG_CD
          , ORG.ORG_STRU_TP_CD
          , ORG.CSR_RG_TP_CD
        FROM
            DS_ORG_RELN RELN
          , DS_ORG_UNIT ORG
          , ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD                      = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD                     = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD                     = #glblCmpyCd#
        AND ORG.EZCANCELFLAG                      = 0
        AND RELN.EZCANCELFLAG                     = 0
        AND STRU.EZCANCELFLAG                     = 0

       <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD                      = #cMsg.bizAreaOrgCd_P1#
       </isNotNull>
        AND ORG.EFF_FROM_DT                   &lt;= #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
        AND (   ORG.GNRN_TP_CD                    = #gnrnTpCdCurrent#
             OR ORG.GNRN_TP_CD                    = #gnrnTpCdFuture#)

        AND ORG.ORG_CD                            = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD                    = RELN.ORG_STRU_TP_CD
        AND RELN.GNRN_TP_CD                      != #gnrnTpCdDelete#
        AND RELN.GNRN_TP_CD                      != #gnrnTpCdTerminated#
        AND RELN.EFF_FROM_DT                  &lt;= #slsDt#
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
        AND (   RELN.GNRN_TP_CD                   = #gnrnTpCdCurrent#
             OR RELN.GNRN_TP_CD                   = #gnrnTpCdFuture#)

        AND ORG.ORG_STRU_TP_CD                    = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG                    = 'N'

        START WITH
            RELN.ORG_CD IN (
                SELECT
                    U.ORG_CD
                FROM
                    DS_ORG_UNIT U
                WHERE
                    U.EZCANCELFLAG  = 0
               <isNotNull property="cMsg.bizAreaOrgCd_P1">
                AND U.FIRST_ORG_CD  =  #cMsg.bizAreaOrgCd_P1#
                AND U.ORG_CD       !=  #cMsg.bizAreaOrgCd_P1#
               </isNotNull> 
                AND U.GNRN_TP_CD  IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
                AND U.ORG_CD  NOT IN (
                    SELECT
                        R.ORG_CD
                    FROM
                        DS_ORG_RELN R
                     ,  ORG_STRU_TP STRU
                    WHERE
                        R.ORG_STRU_TP_CD    = STRU.ORG_STRU_TP_CD
                    AND STRU.TRTY_STRU_FLG  = 'N'
                    AND R.GNRN_TP_CD       IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
                    AND R.GLBL_CMPY_CD      = #glblCmpyCd#
                    AND STRU.GLBL_CMPY_CD   = #glblCmpyCd#
                    AND R.EZCANCELFLAG      = 0
                    AND STRU.EZCANCELFLAG   = 0
                )
            )

        CONNECT BY NOCYCLE PRIOR
                RELN.ORG_CD                           =  RELN.PRNT_ORG_CD
            AND RELN.EZCANCELFLAG                     =  0
            AND RELN.GLBL_CMPY_CD                     =  #glblCmpyCd#
            AND RELN.EFF_FROM_DT                  &lt;=  #slsDt#
            AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
            AND RELN.GNRN_TP_CD                      IN  (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
    )


    ,ORG1 AS(SELECT * FROM WRK)
    ,ORG2 AS(SELECT * FROM WRK)
    ,ORG3 AS(SELECT * FROM WRK)
    ,ORG4 AS(SELECT * FROM WRK)
    ,ORG5 AS(SELECT * FROM WRK)
    ,ORG6 AS(SELECT * FROM WRK)
    ,ORG7 AS(SELECT * FROM WRK)
    ,ORG8 AS(SELECT * FROM WRK)
    ,ORG9 AS(SELECT * FROM WRK)
    ,ORG10 AS(SELECT * FROM WRK)
    
    ,HIERARCHY AS(
        SELECT
            ORG1.ORG_CD
            ,ORG1.ORG_TIER_CD
            ,ORG1.ORG_STRU_TP_CD
            --FIRST   
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.ORG_NM
            END AS FIRST_ORG_NM
            --THIRD          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.ORG_NM
            END AS SCD_ORG_NM
            --FRTH          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.ORG_NM
            END AS THIRD_ORG_NM
            --FIFTH         
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.ORG_NM
            END AS FRTH_ORG_NM
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.ORG_NM
            END AS FIFTH_ORG_NM
            --SVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.ORG_NM
            END AS SIXTH_ORG_NM
            --EIGHTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.ORG_NM
            END AS SVNTH_ORG_NM
            --NINTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.ORG_NM
            END AS EIGHTH_ORG_NM
            --TENTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.ORG_NM
            END AS NINTH_ORG_NM
            --ELEVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.ORG_NM
            END AS TENTH_ORG_NM

            <isNotNull property="cMsg.csrRgTpCd_P2">
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.CSR_RG_TP_CD
            END AS FIRST_CSR_RG_TP_CD
            --THIRD          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.CSR_RG_TP_CD
            END AS SCD_CSR_RG_TP_CD
            --FRTH          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.CSR_RG_TP_CD
            END AS THIRD_CSR_RG_TP_CD
            --FIFTH         
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.CSR_RG_TP_CD
            END AS FRTH_CSR_RG_TP_CD
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.CSR_RG_TP_CD
            END AS FIFTH_CSR_RG_TP_CD
            --SVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.CSR_RG_TP_CD
            END AS SIXTH_CSR_RG_TP_CD
            --EIGHTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.CSR_RG_TP_CD
            END AS SVNTH_CSR_RG_TP_CD
            --NINTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.CSR_RG_TP_CD
            END AS EIGHTH_CSR_RG_TP_CD
            --TENTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.CSR_RG_TP_CD
            END AS NINTH_CSR_RG_TP_CD
            --ELEVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.CSR_RG_TP_CD
            END AS TENTH_CSR_RG_TP_CD
            </isNotNull>

        FROM
            ORG1
            ,ORG2
            ,ORG3
            ,ORG4
            ,ORG5
            ,ORG6
            ,ORG7
            ,ORG8
            ,ORG9
            ,ORG10
        WHERE
            ORG1.PRNT_ORG_CD = ORG2.ORG_CD
        AND ORG2.PRNT_ORG_CD = ORG3.ORG_CD
        AND ORG3.PRNT_ORG_CD = ORG4.ORG_CD
        AND ORG4.PRNT_ORG_CD = ORG5.ORG_CD
        AND ORG5.PRNT_ORG_CD = ORG6.ORG_CD
        AND ORG6.PRNT_ORG_CD = ORG7.ORG_CD
        AND ORG7.PRNT_ORG_CD = ORG8.ORG_CD
        AND ORG8.PRNT_ORG_CD = ORG9.ORG_CD
        AND ORG9.PRNT_ORG_CD = ORG10.ORG_CD
        UNION ALL
        -- Obtain Organization that do not have parent
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
            <isNotNull property="cMsg.csrRgTpCd_P2">
            ,ORG.CSR_RG_TP_CD AS FIRST_CSR_RG_TP_CD
            ,NULL AS SCD_CSR_RG_TP_CD
            ,NULL AS THIRD_CSR_RG_TP_CD
            ,NULL AS FRTH_CSR_RG_TP_CD
            ,NULL AS FIFTH_CSR_RG_TP_CD
            ,NULL AS SIXTH_CSR_RG_TP_CD
            ,NULL AS SVNTH_CSR_RG_TP_CD
            ,NULL AS EIGHTH_CSR_RG_TP_CD
            ,NULL AS NINTH_CSR_RG_TP_CD
            ,NULL AS TENTH_CSR_RG_TP_CD
            </isNotNull>
        FROM
            DS_ORG_UNIT ORG
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
        </isNotEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        <isNotNull property="cMsg.orgTierCd_P2">
        AND ORG.ORG_TIER_CD = #cMsg.orgTierCd_P2#
        </isNotNull>
        <isNotNull property="cMsg.csrRgTpCd_P2">
        AND ORG.CSR_RG_TP_CD = #cMsg.csrRgTpCd_P2#
        </isNotNull>
        AND NOT EXISTS(
                SELECT
                    1
                FROM
                    DS_ORG_RELN RELN
                WHERE
                    RELN.GLBL_CMPY_CD = #glblCmpyCd#
                AND RELN.EZCANCELFLAG = '0'
                AND RELN.ORG_CD = ORG.ORG_CD
                AND RELN.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
                AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
                AND ORG.ORG_TIER_CD &gt;= #firstTierCd#
            )
        UNION ALL

        -- Obtain Organization that are not connected with top tier(BIZ_AREA)
        SELECT
            NOR.ORG_CD
            ,NOR.ORG_TIER_CD
            ,NOR.ORG_STRU_TP_CD
            ,NOR.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
            <isNotNull property="cMsg.csrRgTpCd_P2">
            ,NOR.CSR_RG_TP_CD AS FIRST_CSR_RG_TP_CD
            ,NULL AS SCD_CSR_RG_TP_CD
            ,NULL AS THIRD_CSR_RG_TP_CD
            ,NULL AS FRTH_CSR_RG_TP_CD
            ,NULL AS FIFTH_CSR_RG_TP_CD
            ,NULL AS SIXTH_CSR_RG_TP_CD
            ,NULL AS SVNTH_CSR_RG_TP_CD
            ,NULL AS EIGHTH_CSR_RG_TP_CD
            ,NULL AS NINTH_CSR_RG_TP_CD
            ,NULL AS TENTH_CSR_RG_TP_CD
            </isNotNull>
        FROM
            NORELN_TOPTIER NOR
    )

    SELECT
         H.ORG_CD
        ,H.ORG_TIER_CD
        ,H.FIRST_ORG_NM
        ,H.SCD_ORG_NM
        ,H.THIRD_ORG_NM
        ,H.FRTH_ORG_NM
        ,H.FIFTH_ORG_NM
        ,H.SIXTH_ORG_NM
        ,H.SVNTH_ORG_NM
        ,H.EIGHTH_ORG_NM
        ,H.NINTH_ORG_NM
        ,H.TENTH_ORG_NM
    FROM
        HIERARCHY H
    WHERE
         H.ORG_TIER_CD &gt;= #firstTierCd#
   <isNotNull property="cMsg.orgNm_H2">
    <isNotNull property="topTiersOnly">
    AND H.FIRST_ORG_NM     LIKE #cMsg.orgNm_H2#
    </isNotNull>
    <isNotNull property="orgLevelChildrenOnly">
    AND ( H.FIRST_ORG_NM     LIKE #cMsg.orgNm_H2#
         OR H.SCD_ORG_NM     LIKE #cMsg.orgNm_H2#
         OR H.THIRD_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.FRTH_ORG_NM    LIKE #cMsg.orgNm_H2#
         OR H.FIFTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.SIXTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.SVNTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.EIGHTH_ORG_NM  LIKE #cMsg.orgNm_H2#
         OR H.NINTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.TENTH_ORG_NM   LIKE #cMsg.orgNm_H2#
        )
    </isNotNull>
   </isNotNull>

   <isNotNull property="cMsg.csrRgTpCd_P2">
    AND ( H.FIRST_CSR_RG_TP_CD    = #cMsg.csrRgTpCd_P2#
         OR H.SCD_CSR_RG_TP_CD    = #cMsg.csrRgTpCd_P2#
         OR H.THIRD_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.FRTH_CSR_RG_TP_CD   = #cMsg.csrRgTpCd_P2#
         OR H.FIFTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.SIXTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.SVNTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.EIGHTH_CSR_RG_TP_CD = #cMsg.csrRgTpCd_P2#
         OR H.NINTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.TENTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
        )
   </isNotNull>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='1'>
    AND H.FIRST_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='2'>
    AND H.SCD_ORG_NM      IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='3'>
    AND H.THIRD_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='4'>
    AND H.FRTH_ORG_NM     IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='5'>
    AND H.FIFTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='6'>
    AND H.SIXTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='7'>
    AND H.SVNTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='8'>
    AND H.EIGHTH_ORG_NM   IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='9'>
    AND H.NINTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='10'>
    AND H.TENTH_ORG_NM    IS NOT NULL
   </isEqual>
    ORDER BY
        FIRST_ORG_NM NULLS FIRST
        ,SCD_ORG_NM NULLS FIRST
        ,THIRD_ORG_NM NULLS FIRST
        ,FRTH_ORG_NM NULLS FIRST
        ,FIFTH_ORG_NM NULLS FIRST
        ,SIXTH_ORG_NM NULLS FIRST
        ,SVNTH_ORG_NM NULLS FIRST
        ,EIGHTH_ORG_NM NULLS FIRST
        ,NINTH_ORG_NM NULLS FIRST
        ,TENTH_ORG_NM NULLS FIRST
        ,ORG_TIER_CD
    </statement>

    <statement id="getHierarchyWithResource" parameterClass="Map" resultMap="result.getHierarchy">
    WITH WRK AS(
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,RELN.PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.CSR_RG_TP_CD
        FROM
            DS_ORG_UNIT ORG
            ,DS_ORG_RELN RELN
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
        AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
        <isNotEqual property="includeInactive" compareValue='Y'>
       <!-- 2018/03/07 QC#20233-1 add start -->
        AND RELN.GNRN_TP_CD != #gnrnTpCdPast#
       <!-- 2018/03/07 QC#20233-1 add end -->
        AND RELN.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
        </isNotEqual>
      <!--
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND (RELN.GNRN_TP_CD = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD = #gnrnTpCdFuture#)
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD = #gnrnTpCdFuture#)
        </isNotEqual>
      -->
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        UNION ALL
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,ORG.ORG_CD AS PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.CSR_RG_TP_CD
        FROM
            DS_ORG_UNIT ORG
           ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG ='N'
        AND ORG.ORG_TIER_CD = '0'
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        
    )

    , NORELN_TOPTIER AS(
        SELECT
            RELN.ORG_CD
          , ORG.ORG_TIER_CD
          , ORG.ORG_NM
          , ORG.FIRST_ORG_CD
          , ORG.TRTY_GRP_TP_CD
          , ORG.TRTY_TP_CD
          , RELN.PRNT_ORG_CD
          , ORG.ORG_STRU_TP_CD
          , ORG.CSR_RG_TP_CD
        FROM
            DS_ORG_RELN RELN
          , DS_ORG_UNIT ORG
          , ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD                      = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD                     = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD                     = #glblCmpyCd#
        AND ORG.EZCANCELFLAG                      = 0
        AND RELN.EZCANCELFLAG                     = 0
        AND STRU.EZCANCELFLAG                     = 0

       <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD                      = #cMsg.bizAreaOrgCd_P1#
       </isNotNull>
        AND ORG.EFF_FROM_DT                   &lt;= #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#)  &gt;= #slsDt#
        AND (   ORG.GNRN_TP_CD                    = #gnrnTpCdCurrent#
             OR ORG.GNRN_TP_CD                    = #gnrnTpCdFuture#)

        AND ORG.ORG_CD                            = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD                    = RELN.ORG_STRU_TP_CD
        AND RELN.GNRN_TP_CD                      != #gnrnTpCdDelete#
        AND RELN.GNRN_TP_CD                      != #gnrnTpCdTerminated#
        AND RELN.EFF_FROM_DT                  &lt;= #slsDt#
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
        AND (   RELN.GNRN_TP_CD                   = #gnrnTpCdCurrent#
             OR RELN.GNRN_TP_CD                   = #gnrnTpCdFuture#)

        AND ORG.ORG_STRU_TP_CD                    = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG                    = 'N'

        START WITH
            RELN.ORG_CD IN (
                SELECT
                    U.ORG_CD
                FROM
                    DS_ORG_UNIT U
                WHERE
                    U.EZCANCELFLAG  = 0
               <isNotNull property="cMsg.bizAreaOrgCd_P1">
                AND U.FIRST_ORG_CD  =  #cMsg.bizAreaOrgCd_P1#
                AND U.ORG_CD       !=  #cMsg.bizAreaOrgCd_P1#
               </isNotNull> 
               <isNotEqual property ="includeInactive" compareValue='Y'>
                AND U.GNRN_TP_CD    IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
               </isNotEqual>
               <isEqual property="includeInactive" compareValue='Y'>
                AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
               </isEqual>
                AND U.ORG_CD  NOT IN (
                    SELECT
                        R.ORG_CD
                    FROM
                        DS_ORG_RELN R
                     ,  ORG_STRU_TP STRU
                    WHERE
                        R.ORG_STRU_TP_CD    = STRU.ORG_STRU_TP_CD
                    AND STRU.TRTY_STRU_FLG  = 'N'
                    AND R.GNRN_TP_CD       IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
                    AND R.GLBL_CMPY_CD      = #glblCmpyCd#
                    AND STRU.GLBL_CMPY_CD   = #glblCmpyCd#
                    AND R.EZCANCELFLAG      = 0
                    AND STRU.EZCANCELFLAG   = 0
                )
            )

        CONNECT BY NOCYCLE PRIOR
                RELN.ORG_CD                           =  RELN.PRNT_ORG_CD
            AND RELN.EZCANCELFLAG                     =  0
            AND RELN.GLBL_CMPY_CD                     =  #glblCmpyCd#
            AND RELN.EFF_FROM_DT                  &lt;=  #slsDt#
            AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
            AND RELN.GNRN_TP_CD                      IN  (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
    )


   , RESRC AS (SELECT
         ORG.ORG_CD
        ,ORG.ORG_NM
        ,PSN.PSN_CD
        ,PSN.PSN_FIRST_NM
        ,PSN.PSN_LAST_NM
        ,ROLE.MGR_FLG
        ,ROLE.ORG_FUNC_ROLE_TP_CD
        ,ROLE.ORG_FUNC_ROLE_TP_NM
        ,RQST.TOC_CD
        ,PSN.PSN_NUM
        ,PSN.JOB_TTL_CD
        ,PSN.HR_TTL_NM
    FROM
         DS_ORG_UNIT ORG
        ,ORG_STRU_TP STRU
        ,TOC_ORG_STRU_RELN RELN
        ,ORG_TOC_CHNG_RQST RQST
        ,ORG_FUNC_ASG ASG
        ,S21_PSN PSN
        ,ORG_FUNC_ROLE_TP ROLE
        <isNotNull property="cMsg.orgNm_H3">
        ,DS_ORG_RESRC_RELN DORR
        ,DS_ORG_UNIT       TRTY
        ,ORG_STRU_TP       TRTY_TP
        </isNotNull>
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
    AND RQST.GLBL_CMPY_CD = #glblCmpyCd#
    AND ASG.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.EZCANCELFLAG = '0'
    AND RELN.EZCANCELFLAG = '0'
    AND RQST.EZCANCELFLAG = '0'
    AND ASG.EZCANCELFLAG = '0'
    AND PSN.EZCANCELFLAG = '0'
    AND ROLE.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'N'
    AND RELN.ORG_CD = ORG.ORG_CD
    AND RELN.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND RQST.ORG_CD = RELN.ORG_CD
    AND RQST.TOC_CD = RELN.TOC_CD
    AND ASG.TOC_CD = RQST.TOC_CD
    AND ASG.PSN_CD = PSN.PSN_CD    
    AND RQST.ORG_FUNC_ROLE_TP_CD = ROLE.ORG_FUNC_ROLE_TP_CD
    AND STRU.ORG_STRU_TP_CD = ROLE.ORG_STRU_TP_CD
    AND ASG.GNRN_TP_CD != #gnrnTpCdDelete#
    AND ASG.GNRN_TP_CD != #gnrnTpCdTerminated#
    <isNotEqual property="includeInactive" compareValue='Y'>
    AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD = #gnrnTpCdFuture#)
    AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD = #gnrnTpCdFuture#)
    AND (RQST.RGTN_STS_CD = #rgtnStsCdP01# OR RQST.RGTN_STS_CD = #rgtnStsCdP20#)
        <!-- MOD START S21_NA QC#16481 -->
        <isNull property="cMsg.effFromDt_FR">
        <isNull property="cMsg.effFromDt_TO">
        AND RELN.EFF_FROM_DT &lt;=  #slsDt#
        AND ASG.EFF_FROM_DT  &lt;=  #slsDt#
        AND PSN.EFF_FROM_DT  &lt;=  #slsDt#
        </isNull>
        </isNull>
    AND (RELN.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL)
    AND (ASG.EFF_THRU_DT &gt;= #slsDt# OR ASG.EFF_THRU_DT IS NULL)
    AND (PSN.EFF_THRU_DT &gt;= #slsDt# OR PSN.EFF_THRU_DT IS NULL)
    </isNotEqual>
    <isNotNull property="cMsg.effFromDt_FR">
    AND RELN.EFF_FROM_DT &gt;=  #cMsg.effFromDt_FR#
    AND ASG.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_FR#
    AND PSN.EFF_FROM_DT  &gt;=  #cMsg.effFromDt_FR#
    </isNotNull>
    <isNotNull property="cMsg.effFromDt_TO">
    AND RELN.EFF_FROM_DT &lt;=  #cMsg.effFromDt_TO#
    AND ASG.EFF_FROM_DT  &lt;=  #cMsg.effFromDt_TO#
    AND PSN.EFF_FROM_DT  &lt;=  #cMsg.effFromDt_TO#
    <!-- MOD END S21_NA QC#16481 -->
    </isNotNull>

    <isNotNull property="cMsg.orgNm_H3">
    AND PSN.GLBL_CMPY_CD      =  DORR.GLBL_CMPY_CD
    AND PSN.PSN_CD            =  DORR.PSN_CD
    AND DORR.EZCANCELFLAG     =  '0'
    AND DORR.EFF_FROM_DT  &lt;=  #slsDt#
    AND NVL(DORR.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#

    AND DORR.GLBL_CMPY_CD     =  TRTY.GLBL_CMPY_CD
    AND DORR.ORG_CD           =  TRTY.ORG_CD
    AND TRTY.EZCANCELFLAG     =  '0'
    AND TRTY.EFF_FROM_DT  &lt;=  #slsDt#
    AND NVL(TRTY.EFF_THRU_DT ,#maxeffThruDt#) &gt;= #slsDt#

    AND TRTY.GLBL_CMPY_CD     =  TRTY_TP.GLBL_CMPY_CD
    AND TRTY.ORG_STRU_TP_CD   =  TRTY_TP.ORG_STRU_TP_CD
    AND TRTY_TP.TRTY_STRU_FLG =  'Y'
    AND TRTY_TP.EZCANCELFLAG  =  0

    AND TRTY.ORG_NM        LIKE  #cMsg.orgNm_H3#
    </isNotNull>
    )
    
    ,ORG1 AS(SELECT * FROM WRK)
    ,ORG2 AS(SELECT * FROM WRK)
    ,ORG3 AS(SELECT * FROM WRK)
    ,ORG4 AS(SELECT * FROM WRK)
    ,ORG5 AS(SELECT * FROM WRK)
    ,ORG6 AS(SELECT * FROM WRK)
    ,ORG7 AS(SELECT * FROM WRK)
    ,ORG8 AS(SELECT * FROM WRK)
    ,ORG9 AS(SELECT * FROM WRK)
    ,ORG10 AS(SELECT * FROM WRK)
    
    ,HIERARCHY AS(
        SELECT
            ORG1.ORG_CD
            ,ORG1.ORG_TIER_CD
            ,ORG1.ORG_STRU_TP_CD
            --FIRST   
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.ORG_NM
            END AS FIRST_ORG_NM
            --THIRD          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.ORG_NM
            END AS SCD_ORG_NM
            --FRTH          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.ORG_NM
            END AS THIRD_ORG_NM
            --FIFTH         
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.ORG_NM
            END AS FRTH_ORG_NM
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.ORG_NM
            END AS FIFTH_ORG_NM
            --SVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.ORG_NM
            END AS SIXTH_ORG_NM
            --EIGHTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.ORG_NM
            END AS SVNTH_ORG_NM
            --NINTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.ORG_NM
            END AS EIGHTH_ORG_NM
            --TENTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.ORG_NM
            END AS NINTH_ORG_NM
            --ELEVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.ORG_NM
            END AS TENTH_ORG_NM

            <isNotNull property="cMsg.csrRgTpCd_P2">
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.CSR_RG_TP_CD
            END AS FIRST_CSR_RG_TP_CD
            --THIRD          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.CSR_RG_TP_CD
            END AS SCD_CSR_RG_TP_CD
            --FRTH          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.CSR_RG_TP_CD
            END AS THIRD_CSR_RG_TP_CD
            --FIFTH         
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.CSR_RG_TP_CD
            END AS FRTH_CSR_RG_TP_CD
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.CSR_RG_TP_CD
            END AS FIFTH_CSR_RG_TP_CD
            --SVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.CSR_RG_TP_CD
            END AS SIXTH_CSR_RG_TP_CD
            --EIGHTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.CSR_RG_TP_CD
            END AS SVNTH_CSR_RG_TP_CD
            --NINTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.CSR_RG_TP_CD
            END AS EIGHTH_CSR_RG_TP_CD
            --TENTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.CSR_RG_TP_CD
            END AS NINTH_CSR_RG_TP_CD
            --ELEVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.CSR_RG_TP_CD
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.CSR_RG_TP_CD
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.CSR_RG_TP_CD
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.CSR_RG_TP_CD
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.CSR_RG_TP_CD
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.CSR_RG_TP_CD
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.CSR_RG_TP_CD
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.CSR_RG_TP_CD
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.CSR_RG_TP_CD
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.CSR_RG_TP_CD
            END AS TENTH_CSR_RG_TP_CD
            </isNotNull>

        FROM
            ORG1
            ,ORG2
            ,ORG3
            ,ORG4
            ,ORG5
            ,ORG6
            ,ORG7
            ,ORG8
            ,ORG9
            ,ORG10
        WHERE
            ORG1.PRNT_ORG_CD = ORG2.ORG_CD
        AND ORG2.PRNT_ORG_CD = ORG3.ORG_CD
        AND ORG3.PRNT_ORG_CD = ORG4.ORG_CD
        AND ORG4.PRNT_ORG_CD = ORG5.ORG_CD
        AND ORG5.PRNT_ORG_CD = ORG6.ORG_CD
        AND ORG6.PRNT_ORG_CD = ORG7.ORG_CD
        AND ORG7.PRNT_ORG_CD = ORG8.ORG_CD
        AND ORG8.PRNT_ORG_CD = ORG9.ORG_CD
        AND ORG9.PRNT_ORG_CD = ORG10.ORG_CD
        UNION ALL
        -- Obtain Organization that do not have parent
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
            <isNotNull property="cMsg.csrRgTpCd_P2">
            ,ORG.CSR_RG_TP_CD AS FIRST_CSR_RG_TP_CD
            ,NULL AS SCD_CSR_RG_TP_CD
            ,NULL AS THIRD_CSR_RG_TP_CD
            ,NULL AS FRTH_CSR_RG_TP_CD
            ,NULL AS FIFTH_CSR_RG_TP_CD
            ,NULL AS SIXTH_CSR_RG_TP_CD
            ,NULL AS SVNTH_CSR_RG_TP_CD
            ,NULL AS EIGHTH_CSR_RG_TP_CD
            ,NULL AS NINTH_CSR_RG_TP_CD
            ,NULL AS TENTH_CSR_RG_TP_CD
            </isNotNull>
        FROM
            DS_ORG_UNIT ORG
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND ORG.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
       <!--
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
         -->
        </isNotEqual>
        <isEqual property="includeInactive" compareValue='Y'>
        AND ORG.GNRN_TP_CD     != #gnrnTpCdDelete#
        AND ORG.GNRN_TP_CD     != #gnrnTpCdTerminated#
        </isEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        <isNotNull property="cMsg.orgTierCd_P2">
        AND ORG.ORG_TIER_CD = #cMsg.orgTierCd_P2#
        </isNotNull>
        <isNotNull property="cMsg.csrRgTpCd_P2">
        AND ORG.CSR_RG_TP_CD = #cMsg.csrRgTpCd_P2#
        </isNotNull>
        AND NOT EXISTS(
                SELECT
                    1
                FROM
                    DS_ORG_RELN RELN
                WHERE
                    RELN.GLBL_CMPY_CD = #glblCmpyCd#
                AND RELN.EZCANCELFLAG = '0'
                AND RELN.ORG_CD = ORG.ORG_CD
                AND RELN.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
                AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
                AND ORG.ORG_TIER_CD &gt;= #firstTierCd#
            )

        UNION ALL
        -- Obtain Organization that are not connected with top tier(BIZ_AREA)
        SELECT
            NOR.ORG_CD
            ,NOR.ORG_TIER_CD
            ,NOR.ORG_STRU_TP_CD
            ,NOR.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
            <isNotNull property="cMsg.csrRgTpCd_P2">
            ,NOR.CSR_RG_TP_CD AS FIRST_CSR_RG_TP_CD
            ,NULL AS SCD_CSR_RG_TP_CD
            ,NULL AS THIRD_CSR_RG_TP_CD
            ,NULL AS FRTH_CSR_RG_TP_CD
            ,NULL AS FIFTH_CSR_RG_TP_CD
            ,NULL AS SIXTH_CSR_RG_TP_CD
            ,NULL AS SVNTH_CSR_RG_TP_CD
            ,NULL AS EIGHTH_CSR_RG_TP_CD
            ,NULL AS NINTH_CSR_RG_TP_CD
            ,NULL AS TENTH_CSR_RG_TP_CD
            </isNotNull>
        FROM
            NORELN_TOPTIER NOR
    )

    SELECT
         H.ORG_CD
        ,H.ORG_TIER_CD
        ,H.FIRST_ORG_NM
        ,H.SCD_ORG_NM
        ,H.THIRD_ORG_NM
        ,H.FRTH_ORG_NM
        ,H.FIFTH_ORG_NM
        ,H.SIXTH_ORG_NM
        ,H.SVNTH_ORG_NM
        ,H.EIGHTH_ORG_NM
        ,H.NINTH_ORG_NM
        ,H.TENTH_ORG_NM
        ,'' AS PSN_NM
        , (SELECT  MAX(DECODE(R.MGR_FLG,'Y',NVL(R.PSN_FIRST_NM,'') || ' ' || NVL(R.PSN_LAST_NM,''),'')) AS PSN_NM_MGR FROM RESRC R WHERE H.ORG_CD = R.ORG_CD ) AS PSN_NM_MGR
        ,'' AS ORG_FUNC_ROLE_TP_NM 
        ,'' AS MGR_FLG 
        ,'' AS PSN_NUM 
        ,'' AS PSN_CD 
    FROM
        HIERARCHY H
    WHERE
        H.ORG_TIER_CD &gt;= #firstTierCd#
   <isNotNull property="cMsg.orgNm_H2">
    AND ( H.FIRST_ORG_NM     LIKE #cMsg.orgNm_H2#
         OR H.SCD_ORG_NM     LIKE #cMsg.orgNm_H2#
         OR H.THIRD_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.FRTH_ORG_NM    LIKE #cMsg.orgNm_H2#
         OR H.FIFTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.SIXTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.SVNTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.EIGHTH_ORG_NM  LIKE #cMsg.orgNm_H2#
         OR H.NINTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.TENTH_ORG_NM   LIKE #cMsg.orgNm_H2#
        )
   </isNotNull>

   <isNotNull property="cMsg.csrRgTpCd_P2">
    AND ( H.FIRST_CSR_RG_TP_CD    = #cMsg.csrRgTpCd_P2#
         OR H.SCD_CSR_RG_TP_CD    = #cMsg.csrRgTpCd_P2#
         OR H.THIRD_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.FRTH_CSR_RG_TP_CD   = #cMsg.csrRgTpCd_P2#
         OR H.FIFTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.SIXTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.SVNTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.EIGHTH_CSR_RG_TP_CD = #cMsg.csrRgTpCd_P2#
         OR H.NINTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.TENTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
        )
   </isNotNull>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='1'>
    AND H.FIRST_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='2'>
    AND H.SCD_ORG_NM      IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='3'>
    AND H.THIRD_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='4'>
    AND H.FRTH_ORG_NM     IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='5'>
    AND H.FIFTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='6'>
    AND H.SIXTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='7'>
    AND H.SVNTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='8'>
    AND H.EIGHTH_ORG_NM   IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='9'>
    AND H.NINTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='10'>
    AND H.TENTH_ORG_NM    IS NOT NULL
   </isEqual>
    UNION ALL
    
    SELECT
         H.ORG_CD
        ,H.ORG_TIER_CD
        ,H.FIRST_ORG_NM
        ,H.SCD_ORG_NM
        ,H.THIRD_ORG_NM
        ,H.FRTH_ORG_NM
        ,H.FIFTH_ORG_NM
        ,H.SIXTH_ORG_NM
        ,H.SVNTH_ORG_NM
        ,H.EIGHTH_ORG_NM
        ,H.NINTH_ORG_NM
        ,H.TENTH_ORG_NM
        ,NVL(R.PSN_FIRST_NM,'') || ' ' || NVL(R.PSN_LAST_NM,'') AS PSN_NM
        ,'' AS PSN_NM_MGR
        ,R.ORG_FUNC_ROLE_TP_NM AS ORG_FUNC_ROLE_TP_NM
        ,R.MGR_FLG AS MGR_FLG
        ,R.PSN_NUM AS PSN_NUM
        ,R.PSN_CD  AS PSN_CD
    FROM
        HIERARCHY H, RESRC R
    WHERE
    <isNotEqual property="rsrcSearch" compareValue='Y'>
        H.ORG_CD = R.ORG_CD(+)
    </isNotEqual>
    <isEqual property="rsrcSearch" compareValue='Y'>
        H.ORG_CD = R.ORG_CD
    </isEqual>
    AND H.ORG_TIER_CD &gt;= #firstTierCd#
   <isNotNull property="cMsg.orgNm_H2">
    AND ( H.FIRST_ORG_NM     LIKE #cMsg.orgNm_H2#
         OR H.SCD_ORG_NM     LIKE #cMsg.orgNm_H2#
         OR H.THIRD_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.FRTH_ORG_NM    LIKE #cMsg.orgNm_H2#
         OR H.FIFTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.SIXTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.SVNTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.EIGHTH_ORG_NM  LIKE #cMsg.orgNm_H2#
         OR H.NINTH_ORG_NM   LIKE #cMsg.orgNm_H2#
         OR H.TENTH_ORG_NM   LIKE #cMsg.orgNm_H2#
        )
   </isNotNull>

   <isNotNull property="cMsg.csrRgTpCd_P2">
    AND ( H.FIRST_CSR_RG_TP_CD    = #cMsg.csrRgTpCd_P2#
         OR H.SCD_CSR_RG_TP_CD    = #cMsg.csrRgTpCd_P2#
         OR H.THIRD_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.FRTH_CSR_RG_TP_CD   = #cMsg.csrRgTpCd_P2#
         OR H.FIFTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.SIXTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.SVNTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.EIGHTH_CSR_RG_TP_CD = #cMsg.csrRgTpCd_P2#
         OR H.NINTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
         OR H.TENTH_CSR_RG_TP_CD  = #cMsg.csrRgTpCd_P2#
        )
   </isNotNull>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='1'>
    AND H.FIRST_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='2'>
    AND H.SCD_ORG_NM      IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='3'>
    AND H.THIRD_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='4'>
    AND H.FRTH_ORG_NM     IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='5'>
    AND H.FIFTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='6'>
    AND H.SIXTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='7'>
    AND H.SVNTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='8'>
    AND H.EIGHTH_ORG_NM   IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='9'>
    AND H.NINTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="cMsg.orgTierCd_P2" compareValue='10'>
    AND H.TENTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isNotNull property="cMsg.xxPsnNm_H3">
    AND
       (
           UPPER(R.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
       OR  UPPER(R.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
       OR  UPPER(R.PSN_FIRST_NM) || ' ' || UPPER(R.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H3#)
       )
    </isNotNull>
    <isNotNull property="cMsg.psnCd_H3">
    AND R.PSN_CD LIKE #cMsg.psnCd_H3#
    </isNotNull>
    <isNotNull property="cMsg.psnNum_H3">
    AND R.PSN_NUM LIKE #cMsg.psnNum_H3#
    </isNotNull>
    <isNotNull property="cMsg.jobTtlCd_H3">
    AND R.JOB_TTL_CD LIKE #cMsg.jobTtlCd_H3#
    </isNotNull>
    <isNotNull property ="cMsg.hrTtlNm_H3">
    AND R.HR_TTL_NM LIKE #cMsg.hrTtlNm_H3#
    </isNotNull>
    <isNotNull property="cMsg.orgFuncRoleTpCd_P3">
    AND R.ORG_FUNC_ROLE_TP_CD  = #cMsg.orgFuncRoleTpCd_P3#
    </isNotNull>
    ORDER BY
        FIRST_ORG_NM NULLS FIRST
        ,SCD_ORG_NM NULLS FIRST
        ,THIRD_ORG_NM NULLS FIRST
        ,FRTH_ORG_NM NULLS FIRST
        ,FIFTH_ORG_NM NULLS FIRST
        ,SIXTH_ORG_NM NULLS FIRST
        ,SVNTH_ORG_NM NULLS FIRST
        ,EIGHTH_ORG_NM NULLS FIRST
        ,NINTH_ORG_NM NULLS FIRST
        ,TENTH_ORG_NM NULLS FIRST
        ,ORG_TIER_CD
        ,PSN_NM NULLS FIRST
    </statement>

    <statement id="getActiveChildOrganization" parameterClass="Map" resultClass="Map">
        SELECT
             ORG.ORG_CD AS PRNT_ORG_CD
            ,RELN.ORG_CD AS CHLD_ORG_CD
        FROM
            DS_ORG_UNIT ORG
            ,DS_ORG_RELN RELN
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_CD = #cMsg.orgCd_G1#
        AND ORG.ORG_CD = RELN.PRNT_ORG_CD
        AND RELN.ORG_CD != RELN.PRNT_ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        AND (RELN.GNRN_TP_CD = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD =#gnrnTpCdFuture#)
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
    </statement>
    
    <statement id="getActiveParentOrganization" parameterClass="Map" resultClass="Map">
        SELECT
             RELN.ORG_CD
            ,RELN.PRNT_ORG_CD
            ,RELN.ORG_STRU_TP_CD
            ,RELN.EFF_FROM_DT
            ,RELN.EZUPTIME AS EZUPTIME
            ,RELN.EZUPTIMEZONE AS EZUPTIMEZONE
            ,RELN.DS_ORG_RELN_PK <!-- 2017/03/06 S21_NA#17671 Add  -->
        FROM
            DS_ORG_UNIT ORG
            ,DS_ORG_RELN RELN
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'N'
        AND ORG.ORG_CD = #cMsg.orgCd_G1#
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        AND (RELN.GNRN_TP_CD = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD =#gnrnTpCdFuture#)
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
    </statement>

    <statement id="getActiveResource" parameterClass="Map" resultClass="Map">
    SELECT
         ORG.ORG_CD
        ,ORG.ORG_NM
        ,PSN.PSN_CD
        ,PSN.PSN_FIRST_NM
        ,PSN.PSN_LAST_NM
        ,RQST.TOC_CD
    FROM
         DS_ORG_UNIT ORG
        ,ORG_STRU_TP STRU
        ,TOC_ORG_STRU_RELN RELN
        ,ORG_TOC_CHNG_RQST RQST
        ,ORG_FUNC_ASG ASG
        ,S21_PSN PSN
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
    AND RQST.GLBL_CMPY_CD = #glblCmpyCd#
    AND ASG.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.EZCANCELFLAG = '0'
    AND RELN.EZCANCELFLAG = '0'
    AND RQST.EZCANCELFLAG = '0'
    AND ASG.EZCANCELFLAG = '0'
    AND PSN.EZCANCELFLAG = '0'
    AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'N'
    AND ORG.ORG_CD = #cMsg.orgCd_G1#
    AND RELN.ORG_CD = ORG.ORG_CD
    AND RELN.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND RELN.EFF_FROM_DT &lt;= #slsDt#
    AND (RELN.EFF_THRU_DT &gt;= #slsDt# OR RELN.EFF_THRU_DT IS NULL)
    AND (RQST.RGTN_STS_CD = #rgtnStsCdP01# OR RQST.RGTN_STS_CD = #rgtnStsCdP20#)
    AND RQST.ORG_CD = RELN.ORG_CD
    AND RQST.TOC_CD = RELN.TOC_CD
    AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD =#gnrnTpCdFuture#)
    AND ASG.TOC_CD = RQST.TOC_CD
    AND ASG.PSN_CD = PSN.PSN_CD
    AND PSN.EFF_FROM_DT &lt;= #slsDt#
    AND (PSN.EFF_THRU_DT &gt;= #slsDt# OR PSN.EFF_THRU_DT IS NULL)
    AND ROWNUM = 1
    </statement>
    
    <statement id="getPsnNum" parameterClass="Map" resultClass="Map">
    SELECT
        PSN.PSN_NUM AS PSN_NUM
    FROM
        S21_PSN PSN
    WHERE
        PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.EZCANCELFLAG = '0'
    AND NVL(PSN.PSN_FIRST_NM,'') || ' ' || NVL(PSN.PSN_LAST_NM,'') = #cMsg.xxPopPrm_8#
    </statement>
    
    <statement id="getAdditionalOrg" parameterClass="Map" resultClass="Map">
    SELECT
        ORG.ORG_CD AS ORG_CD
       ,ORG.ORG_STRU_TP_CD AS ORG_STRU_TP_CD
       ,ORG.EFF_FROM_DT AS EFF_FROM_DT
       ,ORG.EZUPTIME AS EZUPTIME
       ,ORG.EZUPTIMEZONE AS EZUPTIMEZONE
    FROM
        DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'N'
    AND ORG.ORG_NM = #cMsg.orgNm_G1#
    </statement>

</sqlMap>
