<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NSAB022001">
    <typeAlias alias="DS_ACTL_CNT_INTFCTMsg"         type="business.db.DS_ACTL_CNT_INTFCTMsg"/>
    <typeAlias alias="DS_XS_COPY_INTFCTMsg"          type="business.db.DS_XS_COPY_INTFCTMsg"/>
    <typeAlias alias="DS_ADDL_CHRG_INTFCTMsg"        type="business.db.DS_ADDL_CHRG_INTFCTMsg"/>
    <typeAlias alias="PRC_ALLOC_INTFCTMsg"           type="business.db.PRC_ALLOC_INTFCTMsg"/>
    <typeAlias alias="DS_CONTR_INTFCTMsg"            type="business.db.DS_CONTR_INTFCTMsg"/>
    <typeAlias alias="DS_SUB_CONTR_INTFCTMsg"        type="business.db.DS_SUB_CONTR_INTFCTMsg"/>
    <typeAlias alias="SVC_TERM_CONDTMsg"             type="business.db.SVC_TERM_CONDTMsg"/>

    <statement id="getDsContrIntfcList" parameterClass="Map" resultClass="Map"> 
        SELECT DISTINCT
             DCI.DS_CONTR_SRC_REF_NUM    AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD   AS CONTR_INTFC_SRC_TP
            ,DCI.DS_CONTR_INTFC_BAT_NUM  AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_INTFC_ACT_CD   AS DS_CONTR_INTFC_ACT_CD
        FROM
            DS_CONTR_INTFC DCI
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.EZCANCELFLAG            = '0'
        <!-- START 2018/03/15 T.Tomita [QC#23427, MOD] -->
        <!-- ORDER BY DS_CONTR_SRC_REF_NUM, CONTR_INTFC_SRC_TP, DS_CONTR_INTFC_BAT_NUM, DS_CONTR_INTFC_ACT_CD -->
        ORDER BY DS_CONTR_SRC_REF_NUM, CONTR_INTFC_SRC_TP, DS_CONTR_INTFC_ACT_CD, DS_CONTR_INTFC_BAT_NUM
        <!-- END 2018/03/15 T.Tomita [QC#23427, MOD] -->
    </statement>

    <statement id="getActlCntIntfc" parameterClass="Map" resultMap="result.DS_ACTL_CNT_INTFCTMsg">
        SELECT
             DACI.GLBL_CMPY_CD            AS GLBL_CMPY_CD
            ,DACI.DS_ACTL_CNT_INTFC_PK    AS DS_ACTL_CNT_INTFC_PK
            ,DACI.DS_CONTR_INTFC_BAT_NUM  AS DS_CONTR_INTFC_BAT_NUM
            ,DACI.DS_CONTR_SRC_REF_NUM    AS DS_CONTR_SRC_REF_NUM
            ,DACI.CONTR_INTFC_SRC_TP_CD   AS CONTR_INTFC_SRC_TP_CD
            ,DACI.ACTL_CNT_INTFC_STS_CD   AS ACTL_CNT_INTFC_STS_CD
            ,DACI.INTFC_ERR_MSG_TXT       AS INTFC_ERR_MSG_TXT
            ,DACI.SER_NUM                 AS SER_NUM
            ,DACI.SVC_MACH_MSTR_PK        AS SVC_MACH_MSTR_PK
            ,DACI.MDSE_CD                 AS MDSE_CD
            ,DACI.PHYS_MTR_LB_CD          AS PHYS_MTR_LB_CD
            ,DACI.PHYS_MTR_LB_NM          AS PHYS_MTR_LB_NM
            ,DACI.BLLBL_FLG               AS BLLBL_FLG
            ,DACI.CONTR_MTR_MULT_RATE     AS CONTR_MTR_MULT_RATE
            ,DACI.BLLG_MTR_LB_CD          AS BLLG_MTR_LB_CD
            ,DACI.BLLG_MTR_LB_NM          AS BLLG_MTR_LB_NM
            ,DACI.INTG_MDSE_CD            AS INTG_MDSE_CD
            ,DACI.EZUPTIME                AS EZUPTIME
            ,DACI.EZUPTIMEZONE            AS EZUPTIMEZONE
        FROM
            DS_ACTL_CNT_INTFC DACI
        WHERE
                DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.CONTR_INTFC_SRC_TP_CD       = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_SRC_REF_NUM        = #dsContrSrcRefNum#
            AND DACI.DS_CONTR_INTFC_BAT_NUM      = #dsContrIntfcBatNum#
            AND DACI.EZCANCELFLAG                = '0'
    </statement>

    <resultMap id="result.DS_ACTL_CNT_INTFCTMsg" class="DS_ACTL_CNT_INTFCTMsg">
        <result property="glblCmpyCd"                  column="GLBL_CMPY_CD"                    javaType="EZDTStringItem"/>
        <result property="dsActlCntIntfcPk"            column="DS_ACTL_CNT_INTFC_PK"            javaType="EZDTBigDecimalItem"/>
        <result property="dsContrIntfcBatNum"          column="DS_CONTR_INTFC_BAT_NUM"          javaType="EZDTStringItem"/>
        <result property="dsContrSrcRefNum"            column="DS_CONTR_SRC_REF_NUM"            javaType="EZDTStringItem"/>
        <result property="contrIntfcSrcTpCd"           column="CONTR_INTFC_SRC_TP_CD"           javaType="EZDTStringItem"/>
        <result property="actlCntIntfcStsCd"           column="ACTL_CNT_INTFC_STS_CD"           javaType="EZDTStringItem"/>
        <result property="intfcErrMsgTxt"              column="INTFC_ERR_MSG_TXT"               javaType="EZDTStringItem"/>
        <result property="serNum"                      column="SER_NUM"                         javaType="EZDTStringItem"/>
        <result property="svcMachMstrPk"               column="SVC_MACH_MSTR_PK"                javaType="EZDTBigDecimalItem"/>
        <result property="mdseCd"                      column="MDSE_CD"                         javaType="EZDTStringItem"/>
        <result property="physMtrLbCd"                 column="PHYS_MTR_LB_CD"                  javaType="EZDTStringItem"/>
        <result property="physMtrLbNm"                 column="PHYS_MTR_LB_NM"                  javaType="EZDTStringItem"/>
        <result property="bllblFlg"                    column="BLLBL_FLG"                       javaType="EZDTStringItem"/>
        <result property="contrMtrMultRate"            column="CONTR_MTR_MULT_RATE"             javaType="EZDTBigDecimalItem"/>
        <result property="bllgMtrLbCd"                 column="BLLG_MTR_LB_CD"                  javaType="EZDTStringItem"/>
        <result property="bllgMtrLbNm"                 column="BLLG_MTR_LB_NM"                  javaType="EZDTStringItem"/>
        <result property="intgMdseCd"                  column="INTG_MDSE_CD"                    javaType="EZDTStringItem"/>
        <result property="ezUpTime"                    column="EZUPTIME"                        javaType="EZDTStringItem"/>
        <result property="ezUpTimeZone"                column="EZUPTIMEZONE"                    javaType="EZDTStringItem"/>
    </resultMap>
    
    <statement id="getDsXsCopyIntfc" parameterClass="Map" resultMap="result.DS_XS_COPY_INTFCTMsg"> 
        SELECT
             DXCI.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,DXCI.DS_XS_COPY_INTFC_PK    AS DS_XS_COPY_INTFC_PK
            ,DXCI.DS_CONTR_INTFC_BAT_NUM AS DS_CONTR_INTFC_BAT_NUM
            ,DXCI.DS_CONTR_SRC_REF_NUM   AS DS_CONTR_SRC_REF_NUM
            ,DXCI.CONTR_INTFC_SRC_TP_CD  AS CONTR_INTFC_SRC_TP_CD
            ,DXCI.XS_COPY_INTFC_STS_CD   AS XS_COPY_INTFC_STS_CD
            ,DXCI.INTFC_ERR_MSG_TXT      AS INTFC_ERR_MSG_TXT
            ,DXCI.SER_NUM                AS SER_NUM
            ,DXCI.SVC_MACH_MSTR_PK       AS SVC_MACH_MSTR_PK
            ,DXCI.MDSE_CD                AS MDSE_CD
            ,DXCI.BLLG_MTR_LB_CD         AS BLLG_MTR_LB_CD
            ,DXCI.BLLG_MTR_LB_NM         AS BLLG_MTR_LB_NM
            ,DXCI.XS_MTR_COPY_QTY        AS XS_MTR_COPY_QTY
            ,DXCI.XS_MTR_AMT_RATE        AS XS_MTR_AMT_RATE
            ,DXCI.XS_MTR_LVL_NUM         AS XS_MTR_LVL_NUM
            ,DXCI.EZUPTIME               AS EZUPTIME
            ,DXCI.EZUPTIMEZONE           AS EZUPTIMEZONE
        FROM
            DS_XS_COPY_INTFC DXCI
        WHERE
                DXCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DXCI.CONTR_INTFC_SRC_TP_CD       = #dsContrSrcTpCd#
            AND DXCI.DS_CONTR_SRC_REF_NUM        = #dsContrSrcRefNum#
            AND DXCI.DS_CONTR_INTFC_BAT_NUM      = #dsContrIntfcBatNum#
            AND DXCI.EZCANCELFLAG                = '0'
   </statement>

   <resultMap id="result.DS_XS_COPY_INTFCTMsg" class="DS_XS_COPY_INTFCTMsg">
        <result property="glblCmpyCd"                  column="GLBL_CMPY_CD"                    javaType="EZDTStringItem"/>
        <result property="dsXsCopyIntfcPk"             column="DS_XS_COPY_INTFC_PK"             javaType="EZDTBigDecimalItem"/>
        <result property="dsContrIntfcBatNum"          column="DS_CONTR_INTFC_BAT_NUM"          javaType="EZDTStringItem"/>
        <result property="dsContrSrcRefNum"            column="DS_CONTR_SRC_REF_NUM"            javaType="EZDTStringItem"/>
        <result property="contrIntfcSrcTpCd"           column="CONTR_INTFC_SRC_TP_CD"           javaType="EZDTStringItem"/>
        <result property="xsCopyIntfcStsCd"            column="XS_COPY_INTFC_STS_CD"            javaType="EZDTStringItem"/>
        <result property="intfcErrMsgTxt"              column="INTFC_ERR_MSG_TXT"               javaType="EZDTStringItem"/>
        <result property="serNum"                      column="SER_NUM"                         javaType="EZDTStringItem"/>
        <result property="svcMachMstrPk"               column="SVC_MACH_MSTR_PK"                javaType="EZDTBigDecimalItem"/>
        <result property="mdseCd"                      column="MDSE_CD"                         javaType="EZDTStringItem"/>
        <result property="bllgMtrLbCd"                 column="BLLG_MTR_LB_CD"                  javaType="EZDTStringItem"/>
        <result property="bllgMtrLbNm"                 column="BLLG_MTR_LB_NM"                  javaType="EZDTStringItem"/>
        <result property="xsMtrCopyQty"                column="XS_MTR_COPY_QTY"                 javaType="EZDTBigDecimalItem"/>
        <result property="xsMtrAmtRate"                column="XS_MTR_AMT_RATE"                 javaType="EZDTBigDecimalItem"/>
        <result property="xsMtrLvlNum"                 column="XS_MTR_LVL_NUM"                  javaType="EZDTStringItem"/>
        <result property="ezUpTime"                    column="EZUPTIME"                        javaType="EZDTStringItem"/>
        <result property="ezUpTimeZone"                column="EZUPTIMEZONE"                    javaType="EZDTStringItem"/>
    </resultMap>

    <statement id="getDsAddlChrgIntfc" parameterClass="Map" resultMap="result.DS_ADDL_CHRG_INTFCTMsg"> 
        SELECT
             DACI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DACI.DS_ADDL_CHRG_INTFC_PK        AS DS_ADDL_CHRG_INTFC_PK
            ,DACI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DACI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DACI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DACI.ADD_CHRG_INTFC_STS_CD        AS ADD_CHRG_INTFC_STS_CD
            ,DACI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DACI.SER_NUM                      AS SER_NUM
            ,DACI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DACI.MDSE_CD                      AS MDSE_CD
            ,DACI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DACI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DACI.EFF_FROM_DT                  AS EFF_FROM_DT
            ,DACI.EFF_THRU_DT                  AS EFF_THRU_DT
            ,DACI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DACI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DACI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DACI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DACI.PRINT_DTL_FLG                AS PRINT_DTL_FLG
            ,DACI.EZUPTIME                     AS EZUPTIME
            ,DACI.EZUPTIMEZONE                 AS EZUPTIMEZONE
        FROM
            DS_ADDL_CHRG_INTFC DACI
        WHERE
                DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.CONTR_INTFC_SRC_TP_CD       = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_SRC_REF_NUM        = #dsContrSrcRefNum#
            AND DACI.DS_CONTR_INTFC_BAT_NUM      = #dsContrIntfcBatNum#
            AND DACI.EZCANCELFLAG                = '0'
    </statement>

    <resultMap id="result.DS_ADDL_CHRG_INTFCTMsg" class="DS_ADDL_CHRG_INTFCTMsg">
        <result property="glblCmpyCd"                  column="GLBL_CMPY_CD"                    javaType="EZDTStringItem"/>
        <result property="dsAddlChrgIntfcPk"           column="DS_ADDL_CHRG_INTFC_PK"           javaType="EZDTBigDecimalItem"/>
        <result property="dsContrIntfcBatNum"          column="DS_CONTR_INTFC_BAT_NUM"          javaType="EZDTStringItem"/>
        <result property="dsContrSrcRefNum"            column="DS_CONTR_SRC_REF_NUM"            javaType="EZDTStringItem"/>
        <result property="contrIntfcSrcTpCd"           column="CONTR_INTFC_SRC_TP_CD"           javaType="EZDTStringItem"/>
        <result property="addChrgIntfcStsCd"           column="ADD_CHRG_INTFC_STS_CD"           javaType="EZDTStringItem"/>
        <result property="intfcErrMsgTxt"              column="INTFC_ERR_MSG_TXT"               javaType="EZDTStringItem"/>
        <result property="serNum"                      column="SER_NUM"                         javaType="EZDTStringItem"/>
        <result property="svcMachMstrPk"               column="SVC_MACH_MSTR_PK"                javaType="EZDTBigDecimalItem"/>
        <result property="mdseCd"                      column="MDSE_CD"                         javaType="EZDTStringItem"/>
        <result property="chrgLvlTpCd"                 column="CHRG_LVL_TP_CD"                  javaType="EZDTStringItem"/>
        <result property="addlChrgTpCd"                column="ADDL_CHRG_TP_CD"                 javaType="EZDTStringItem"/>
        <result property="effFromDt"                   column="EFF_FROM_DT"                     javaType="EZDTStringItem"/>
        <result property="effThruDt"                   column="EFF_THRU_DT"                     javaType="EZDTStringItem"/>
        <result property="bllgCycleCd"                 column="BLLG_CYCLE_CD"                   javaType="EZDTStringItem"/>
        <result property="addlChrgFlatDealPrcAmt"      column="ADDL_CHRG_FLAT_DEAL_PRC_AMT"     javaType="EZDTBigDecimalItem"/>
        <result property="addlChrgAplcPct"             column="ADDL_CHRG_APLC_PCT"              javaType="EZDTBigDecimalItem"/>
        <result property="addlChrgInvTpCd"             column="ADDL_CHRG_INV_TP_CD"             javaType="EZDTStringItem"/>
        <result property="printDtlFlg"                 column="PRINT_DTL_FLG"                   javaType="EZDTStringItem"/>
        <result property="ezUpTime"                    column="EZUPTIME"                        javaType="EZDTStringItem"/>
        <result property="ezUpTimeZone"                column="EZUPTIMEZONE"                    javaType="EZDTStringItem"/>
   </resultMap>

    <statement id="getPrcAllocIntfc" parameterClass="Map" resultMap="result.PRC_ALLOC_INTFCTMsg"> 
        SELECT
             PAI.GLBL_CMPY_CD            AS GLBL_CMPY_CD
            ,PAI.PRC_ALLOC_INTFC_PK      AS PRC_ALLOC_INTFC_PK
            ,PAI.DS_CONTR_INTFC_BAT_NUM  AS DS_CONTR_INTFC_BAT_NUM
            ,PAI.DS_CONTR_SRC_REF_NUM    AS DS_CONTR_SRC_REF_NUM
            ,PAI.CONTR_INTFC_SRC_TP_CD   AS CONTR_INTFC_SRC_TP_CD
            ,PAI.ALLOC_INTFC_STS_CD      AS ALLOC_INTFC_STS_CD
            ,PAI.INTFC_ERR_MSG_TXT       AS INTFC_ERR_MSG_TXT
            ,PAI.PRC_ALLOC_INTFC_TP_CD   AS PRC_ALLOC_INTFC_TP_CD
            ,PAI.SER_NUM                 AS SER_NUM
            ,PAI.SVC_MACH_MSTR_PK        AS SVC_MACH_MSTR_PK
            ,PAI.MDSE_CD                 AS MDSE_CD
            ,PAI.TOC_CD                  AS TOC_CD
            ,PAI.TOC_NM                  AS TOC_NM
            ,PAI.PRC_ALLOC_RATE          AS PRC_ALLOC_RATE
            ,PAI.EZUPTIME                AS EZUPTIME
            ,PAI.EZUPTIMEZONE            AS EZUPTIMEZONE
        FROM
            PRC_ALLOC_INTFC PAI
        WHERE
                PAI.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND PAI.CONTR_INTFC_SRC_TP_CD        = #dsContrSrcTpCd#
            AND PAI.DS_CONTR_SRC_REF_NUM         = #dsContrSrcRefNum#
            AND PAI.DS_CONTR_INTFC_BAT_NUM       = #dsContrIntfcBatNum#
            AND PAI.EZCANCELFLAG                 = '0'
    </statement>

    <resultMap id="result.PRC_ALLOC_INTFCTMsg" class="PRC_ALLOC_INTFCTMsg">
        <result property="glblCmpyCd"                  column="GLBL_CMPY_CD"                    javaType="EZDTStringItem"/>
        <result property="prcAllocIntfcPk"             column="PRC_ALLOC_INTFC_PK"              javaType="EZDTBigDecimalItem"/>
        <result property="dsContrIntfcBatNum"          column="DS_CONTR_INTFC_BAT_NUM"          javaType="EZDTStringItem"/>
        <result property="dsContrSrcRefNum"            column="DS_CONTR_SRC_REF_NUM"            javaType="EZDTStringItem"/>
        <result property="contrIntfcSrcTpCd"           column="CONTR_INTFC_SRC_TP_CD"           javaType="EZDTStringItem"/>
        <result property="allocIntfcStsCd"             column="ALLOC_INTFC_STS_CD"              javaType="EZDTStringItem"/>
        <result property="intfcErrMsgTxt"              column="INTFC_ERR_MSG_TXT"               javaType="EZDTStringItem"/>
        <result property="prcAllocIntfcTpCd"           column="PRC_ALLOC_INTFC_TP_CD"           javaType="EZDTStringItem"/>
        <result property="serNum"                      column="SER_NUM"                         javaType="EZDTStringItem"/>
        <result property="svcMachMstrPk"               column="SVC_MACH_MSTR_PK"                javaType="EZDTBigDecimalItem"/>
        <result property="mdseCd"                      column="MDSE_CD"                         javaType="EZDTStringItem"/>
        <result property="tocCd"                       column="TOC_CD"                          javaType="EZDTStringItem"/>
        <result property="tocNm"                       column="TOC_NM"                          javaType="EZDTStringItem"/>
        <result property="prcAllocRate"                column="PRC_ALLOC_RATE"                  javaType="EZDTBigDecimalItem"/>
        <result property="ezUpTime"                    column="EZUPTIME"                        javaType="EZDTStringItem"/>
        <result property="ezUpTimeZone"                column="EZUPTIMEZONE"                    javaType="EZDTStringItem"/>
   </resultMap>

    <statement id="getDsContrIntfc" parameterClass="Map" resultMap="result.DS_CONTR_INTFCTMsg"> 
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.CONTR_ADMIN_PSN_CD           AS CONTR_ADMIN_PSN_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DCI.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
            ,DCI.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,DCI.MAN_CONTR_OVRD_FLG           AS MAN_CONTR_OVRD_FLG
            ,DCI.EZUPTIME                     AS EZUPTIME
            ,DCI.EZUPTIMEZONE                 AS EZUPTIMEZONE
            <!-- START 2019/05/31 K.Fujimoto [QC#50613, ADD] -->
            ,DCI.OLD_DS_CONTR_DTL_PK          AS OLD_DS_CONTR_DTL_PK
            <!-- END   2019/05/31 K.Fujimoto [QC#50613, ADD] -->
        FROM
            DS_CONTR_INTFC DCI
            ,SVC_MACH_MSTR SMM
        WHERE
                DCI.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND DCI.CONTR_INTFC_SRC_TP_CD        = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_SRC_REF_NUM         = #dsContrSrcRefNum#
            AND DCI.DS_CONTR_INTFC_BAT_NUM       = #dsContrIntfcBatNum#
            AND DCI.EZCANCELFLAG                 = '0'
            AND DCI.GLBL_CMPY_CD                 = SMM.GLBL_CMPY_CD(+)
            AND DCI.SVC_MACH_MSTR_PK             = SMM.SVC_MACH_MSTR_PK(+)
            AND SMM.EZCANCELFLAG(+)              = '0'
        ORDER BY
            SMM.SVC_CONFIG_MSTR_PK ASC NULLS FIRST, SMM.SVC_MACH_TP_CD, DCI.CONTR_INTFC_DTL_TP_CD
    </statement>

    <statement id="getDsContrIntfcForDefaultRule" parameterClass="Map" resultMap="result.DS_CONTR_INTFCTMsg"> 
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DCI.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
            ,DCI.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,DCI.EZUPTIME                     AS EZUPTIME
            ,DCI.EZUPTIMEZONE                 AS EZUPTIMEZONE
        FROM
            DS_CONTR_INTFC DCI
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.DS_CONTR_INTFC_ACT_CD   = #dsContrIntfcActCd#
            AND DCI.EZCANCELFLAG            = '0'
    </statement>

    <resultMap id="result.DS_CONTR_INTFCTMsg" class="DS_CONTR_INTFCTMsg">
        <result property="glblCmpyCd"                  column="GLBL_CMPY_CD"                    javaType="EZDTStringItem"/>
        <result property="dsContrIntfcPk"              column="DS_CONTR_INTFC_PK"               javaType="EZDTBigDecimalItem"/>
        <result property="dsContrIntfcBatNum"          column="DS_CONTR_INTFC_BAT_NUM"          javaType="EZDTStringItem"/>
        <result property="dsContrSrcRefNum"            column="DS_CONTR_SRC_REF_NUM"            javaType="EZDTStringItem"/>
        <result property="contrIntfcSrcTpCd"           column="CONTR_INTFC_SRC_TP_CD"           javaType="EZDTStringItem"/>
        <result property="dsContrIntfcActCd"           column="DS_CONTR_INTFC_ACT_CD"           javaType="EZDTStringItem"/>
        <result property="dsContrProcStsCd"            column="DS_CONTR_PROC_STS_CD"            javaType="EZDTStringItem"/>
        <result property="dsContrIntfcStsCd"           column="DS_CONTR_INTFC_STS_CD"           javaType="EZDTStringItem"/>
        <result property="intfcErrMsgTxt"              column="INTFC_ERR_MSG_TXT"               javaType="EZDTStringItem"/>
        <result property="dsContrNum"                  column="DS_CONTR_NUM"                    javaType="EZDTStringItem"/>
        <result property="serNum"                      column="SER_NUM"                         javaType="EZDTStringItem"/>
        <result property="svcMachMstrPk"               column="SVC_MACH_MSTR_PK"                javaType="EZDTBigDecimalItem"/>
        <result property="contrIntfcDtlTpCd"           column="CONTR_INTFC_DTL_TP_CD"           javaType="EZDTStringItem"/>
        <result property="dsAcctNum"                   column="DS_ACCT_NUM"                     javaType="EZDTStringItem"/>
        <result property="billToCustCd"                column="BILL_TO_CUST_CD"                 javaType="EZDTStringItem"/>
        <result property="billToLocNum"                column="BILL_TO_LOC_NUM"                 javaType="EZDTStringItem"/>
        <result property="leaseCmpyCd"                 column="LEASE_CMPY_CD"                   javaType="EZDTStringItem"/>
        <result property="svcContrBrCd"                column="SVC_CONTR_BR_CD"                 javaType="EZDTStringItem"/>
        <result property="contrAdminPsnCd"             column="CONTR_ADMIN_PSN_CD"              javaType="EZDTStringItem"/>
        <result property="tocCd"                       column="TOC_CD"                          javaType="EZDTStringItem"/>
        <result property="custPoNum"                   column="CUST_PO_NUM"                     javaType="EZDTStringItem"/>
        <result property="poDt"                        column="PO_DT"                           javaType="EZDTStringItem"/>
        <result property="crCardCustRefNum"            column="CR_CARD_CUST_REF_NUM"            javaType="EZDTStringItem"/>
        <result property="crCardExprYrMth"             column="CR_CARD_EXPR_YR_MTH"             javaType="EZDTStringItem"/>
        <result property="mtrEstTpCd"                  column="MTR_EST_TP_CD"                   javaType="EZDTStringItem"/>
        <result property="svcPgmMdseCd"                column="SVC_PGM_MDSE_CD"                 javaType="EZDTStringItem"/>
        <result property="mdseCd"                      column="MDSE_CD"                         javaType="EZDTStringItem"/>
        <result property="mdlId"                       column="MDL_ID"                          javaType="EZDTBigDecimalItem"/>
        <result property="mdlNm"                       column="MDL_NM"                          javaType="EZDTStringItem"/>
        <result property="contrFromDt"                 column="CONTR_FROM_DT"                   javaType="EZDTStringItem"/>
        <result property="contrThruDt"                 column="CONTR_THRU_DT"                   javaType="EZDTStringItem"/>
        <result property="bllgCycleCd"                 column="BLLG_CYCLE_CD"                   javaType="EZDTStringItem"/>
        <result property="prcAllocByMachQtyFlg"        column="PRC_ALLOC_BY_MACH_QTY_FLG"       javaType="EZDTStringItem"/>
        <result property="contrAutoRnwTpCd"            column="CONTR_AUTO_RNW_TP_CD"            javaType="EZDTStringItem"/>
        <result property="rnwPrcMethCd"                column="RNW_PRC_METH_CD"                 javaType="EZDTStringItem"/>
        <result property="befEndRnwDaysAot"            column="BEF_END_RNW_DAYS_AOT"            javaType="EZDTBigDecimalItem"/>
        <result property="rnwPrcUpRatio"               column="RNW_PRC_UP_RATIO"                javaType="EZDTBigDecimalItem"/>
        <result property="contrUplftTpCd"              column="CONTR_UPLFT_TP_CD"               javaType="EZDTStringItem"/>
        <result property="uplftPrcMethCd"              column="UPLFT_PRC_METH_CD"               javaType="EZDTStringItem"/>
        <result property="uplftPrcUpRatio"             column="UPLFT_PRC_UP_RATIO"              javaType="EZDTBigDecimalItem"/>
        <result property="mtrReadMethCd"               column="MTR_READ_METH_CD"                javaType="EZDTStringItem"/>
        <result property="basePrcDealAmt"              column="BASE_PRC_DEAL_AMT"               javaType="EZDTBigDecimalItem"/>
        <result property="contrCloDay"                 column="CONTR_CLO_DAY"                   javaType="EZDTStringItem"/>
        <result property="contrBllgDay"                column="CONTR_BLLG_DAY"                  javaType="EZDTStringItem"/>
        <result property="bllgThruDt"                  column="BLLG_THRU_DT"                    javaType="EZDTStringItem"/>
        <result property="bllgMtrLbCd"                 column="BLLG_MTR_LB_CD"                  javaType="EZDTStringItem"/>
        <result property="bllgMtrLbNm"                 column="BLLG_MTR_LB_NM"                  javaType="EZDTStringItem"/>
        <result property="startMtrCnt"                 column="START_MTR_CNT"                   javaType="EZDTBigDecimalItem"/>
        <result property="bllgRollOverRatio"           column="BLLG_ROLL_OVER_RATIO"            javaType="EZDTBigDecimalItem"/>
        <result property="dsContrCatgCd"               column="DS_CONTR_CATG_CD"                javaType="EZDTStringItem"/>
        <result property="dsContrStsCd"                column="DS_CONTR_STS_CD"                 javaType="EZDTStringItem"/>
        <result property="xsChrgTpCd"                  column="XS_CHRG_TP_CD"                   javaType="EZDTStringItem"/>
        <result property="xsMtrCopyQty"                column="XS_MTR_COPY_QTY"                 javaType="EZDTBigDecimalItem"/>
        <result property="xsMtrAmtRate"                column="XS_MTR_AMT_RATE"                 javaType="EZDTBigDecimalItem"/>
        <result property="addlChrgTpCd"                column="ADDL_CHRG_TP_CD"                 javaType="EZDTStringItem"/>
        <result property="addlChrgFlatDealPrcAmt"      column="ADDL_CHRG_FLAT_DEAL_PRC_AMT"     javaType="EZDTBigDecimalItem"/>
        <result property="addlChrgAplcPct"             column="ADDL_CHRG_APLC_PCT"              javaType="EZDTStringItem"/>
        <result property="chrgLvlTpCd"                 column="CHRG_LVL_TP_CD"                  javaType="EZDTStringItem"/>
        <result property="addlChrgInvTpCd"             column="ADDL_CHRG_INV_TP_CD"             javaType="EZDTStringItem"/>
        <result property="basePrcTermDealAmtRate"      column="BASE_PRC_TERM_DEAL_AMT_RATE"     javaType="EZDTBigDecimalItem"/>
        <result property="dsContrClsCd"                column="DS_CONTR_CLS_CD"                 javaType="EZDTStringItem"/>
        <result property="ctacPsnPk"                   column="CTAC_PSN_PK"                     javaType="EZDTBigDecimalItem"/>
        <result property="ctacPsnNm"                   column="CTAC_PSN_NM"                     javaType="EZDTStringItem"/>
 <!--  Start 2022/03/22 [QC#59683, Add] -->
        <result property="dsInvTgtrTpCd"               column="DS_INV_TGTR_TP_CD"               javaType="EZDTStringItem"/>
 <!--  Start 2022/03/22 [QC#59683, Add] -->
        <result property="invSeptBaseUsgFlg"           column="INV_SEPT_BASE_USG_FLG"           javaType="EZDTStringItem"/>
        <result property="contrCloDt"                  column="CONTR_CLO_DT"                    javaType="EZDTStringItem"/>
        <result property="contrDurnAot"                column="CONTR_DURN_AOT"                  javaType="EZDTBigDecimalItem"/>
        <result property="pmtTermCashDiscCd"           column="PMT_TERM_CASH_DISC_CD"           javaType="EZDTStringItem"/>
        <result property="svcLineBizCd"                column="SVC_LINE_BIZ_CD"                 javaType="EZDTStringItem"/>
        <result property="bllgTmgTpCd"                 column="BLLG_TMG_TP_CD"                  javaType="EZDTStringItem"/>
        <result property="dsContrEdiCd"                column="DS_CONTR_EDI_CD"                 javaType="EZDTStringItem"/>
        <result property="dsContrIntfcDt"              column="DS_CONTR_INTFC_DT"               javaType="EZDTStringItem"/>
        <result property="dsContrDescTxt"              column="DS_CONTR_DESC_TXT"               javaType="EZDTStringItem"/>
        <result property="baseChrgToLeaseCmpyFlg"      column="BASE_CHRG_TO_LEASE_CMPY_FLG"     javaType="EZDTStringItem"/>
        <result property="usgChrgToLeaseCmpyFlg"       column="USG_CHRG_TO_LEASE_CMPY_FLG"      javaType="EZDTStringItem"/>
        <result property="intgMdseCd"                  column="INTG_MDSE_CD"                    javaType="EZDTStringItem"/>
        <result property="capBwOrigQty"                column="CAP_BW_ORIG_QTY"                 javaType="EZDTBigDecimalItem"/>
        <result property="capColorOrigQty"             column="CAP_COLOR_ORIG_QTY"              javaType="EZDTBigDecimalItem"/>
        <result property="capTotOrigQty"               column="CAP_TOT_ORIG_QTY"                javaType="EZDTBigDecimalItem"/>
        <result property="capBwRunQty"                 column="CAP_BW_RUN_QTY"                  javaType="EZDTBigDecimalItem"/>
        <result property="capColorRunQty"              column="CAP_COLOR_RUN_QTY"               javaType="EZDTBigDecimalItem"/>
        <result property="capTotRunQty"                column="CAP_TOT_RUN_QTY"                 javaType="EZDTBigDecimalItem"/>
        <result property="dsContrIntfcBatSq"           column="DS_CONTR_INTFC_BAT_SQ"           javaType="EZDTBigDecimalItem"/>
        <result property="prcSvcPlnTpCd"               column="PRC_SVC_PLN_TP_CD"               javaType="EZDTStringItem"/>
        <result property="manContrOvrdFlg"             column="MAN_CONTR_OVRD_FLG"              javaType="EZDTStringItem"/>
        <result property="ezUpTime"                    column="EZUPTIME"                        javaType="EZDTStringItem"/>
        <result property="ezUpTimeZone"                column="EZUPTIMEZONE"                    javaType="EZDTStringItem"/>
        <!-- START 2019/05/31 K.Fujimoto [QC#50613, ADD] -->
        <result property="oldDsContrDtlPk"             column="OLD_DS_CONTR_DTL_PK"             javaType="EZDTBigDecimalItem"/>
        <!-- END   2019/05/31 K.Fujimoto [QC#50613, ADD] -->
    </resultMap>

    <statement id="getDsContrIntfcDefRule" parameterClass="Map" resultClass="Map">
        SELECT
             DCIDR.LEASE_CMPY_CD                 LEASE_CMPY_CD
            ,MRM.MTR_READ_METH_CD                MTR_READ_METH_CD
            ,DCIDR.DS_CONTR_CLS_CD               DS_CONTR_CLS_CD
            ,DCIDR.PRINT_DTL_FLG                 PRINT_DTL_FLG
            ,CART.CONTR_AUTO_RNW_TP_CD           CONTR_AUTO_RNW_TP_CD
            ,RPM.RNW_PRC_METH_CD                 RNW_PRC_METH_CD
            ,DCIDR.BEF_END_RNW_DAYS_AOT          BEF_END_RNW_DAYS_AOT
            ,DCIDR.BASE_PRC_UP_RATIO             BASE_PRC_UP_RATIO
            ,DCIDR.MTR_PRC_UP_RATIO              MTR_PRC_UP_RATIO
            ,MET.MTR_EST_TP_CD                   MTR_EST_TP_CD
            ,MET.MTR_EST_TP_DESC_TXT             MTR_EST_TP_DESC_TXT
            ,BC_B.BLLG_CYCLE_CD                  BASE_BLLG_CYCLE_CD
            ,BC_U.BLLG_CYCLE_CD                  MTR_BLLG_CYCLE_CD
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCIDR.DS_INV_TGTR_TP_CD             DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCIDR.INV_SEPT_BASE_USG_FLG         INV_SEPT_BASE_USG_FLG
            ,DCIDR.PRC_ALLOC_BY_MACH_QTY_FLG     PRC_ALLOC_BY_MACH_QTY_FLG
            ,CUT.CONTR_UPLFT_TP_CD               CONTR_UPLFT_TP_CD
            ,CUT.CONTR_UPLFT_TP_DESC_TXT         CONTR_UPLFT_TP_DESC_TXT
            ,UPM.UPLFT_PRC_METH_CD               UPLFT_PRC_METH_CD
            ,UPM.UPLFT_PRC_METH_DESC_TXT         UPLFT_PRC_METH_DESC_TXT
            ,DCIDR.UPLFT_BASE_PRC_UP_RATIO       UPLFT_BASE_PRC_UP_RATIO
            ,DCIDR.UPLFT_MTR_PRC_UP_RATIO        UPLFT_MTR_PRC_UP_RATIO
            ,DCIDR.BLLG_THRU_DT                  BLLG_THRU_DT
            ,DCIDR.BLLG_THRU_TP_CD               BLLG_THRU_TP_CD
            ,DCIDR.START_READ_VLD_TP_CD          START_READ_VLD_TP_CD
            ,DCIDR.MTR_READ_WIN_DAYS_AOT         MTR_READ_WIN_DAYS_AOT
            ,DCIDR.BASE_BLLG_CYCLE_CD            BASE_BLLG_CYCLE_CD
            ,DCIDR.MTR_BLLG_CYCLE_CD             MTR_BLLG_CYCLE_CD
            ,DCIDR.STUB_PREP_FROM_TP_CD          STUB_PREP_FROM_TP_CD
            ,DCIDR.STUB_PREP_THRU_TP_CD          STUB_PREP_THRU_TP_CD
            ,DCIDR.AUTO_EFF_FLEET_FLG            AUTO_EFF_FLEET_FLG
            ,DCIDR.AUTO_EFF_AGGR_FLG             AUTO_EFF_AGGR_FLG
        FROM
             DS_CONTR_INTFC_DEF_RULE     DCIDR
            ,BILL_TO_CUST                BTC
            ,MTR_READ_METH               MRM
            ,CONTR_AUTO_RNW_TP           CART
            ,RNW_PRC_METH                RPM
            ,MTR_EST_TP                  MET
            ,BLLG_CYCLE                  BC_B
            ,BLLG_CYCLE                  BC_U
            ,CONTR_UPLFT_TP              CUT
            ,UPLFT_PRC_METH              UPM
        WHERE
            <!-- DS_CONTR_INTFC_DEF_RULE -->
            DCIDR.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DCIDR.CONTR_INTFC_SRC_TP_CD = #contrIntfcSrcTpCd#
            AND DCIDR.DS_CONTR_CLS_CD       = #dsContrClsCd#
            AND DCIDR.SVC_LINE_BIZ_CD       = #svcLineBizCd#
            AND DCIDR.EFF_FROM_DT           &lt;= #salesDate#
            AND DCIDR.ENBL_FLG              = 'Y'
            <!-- BILL_TO_CUST -->
            AND BTC.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCIDR.LEASE_CMPY_CD         = BTC.BILL_TO_CUST_CD(+)
            <!-- MTR_READ_METH -->
            AND MRM.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCIDR.MTR_READ_METH_CD      = MRM.MTR_READ_METH_CD(+)
            <!-- CONTR_AUTO_RNW_TP -->
            AND CART.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCIDR.CONTR_AUTO_RNW_TP_CD  = CART.CONTR_AUTO_RNW_TP_CD(+)
            <!-- RNW_PRC_METH -->
            AND RPM.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCIDR.RNW_PRC_METH_CD       = RPM.RNW_PRC_METH_CD(+)
            <!-- MTR_EST_TP -->
            AND MET.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCIDR.MTR_EST_TP_CD         = MET.MTR_EST_TP_CD(+)
            <!-- BLLG_CYCLE(Base) -->
            AND BC_B.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCIDR.BASE_BLLG_CYCLE_CD    = BC_B.BLLG_CYCLE_CD(+)
            <!-- BLLG_CYCLE(Usage) -->
            AND BC_U.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCIDR.MTR_BLLG_CYCLE_CD     = BC_U.BLLG_CYCLE_CD(+)
            <!-- CONTR_UPLFT_TP -->
            AND CUT.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCIDR.CONTR_UPLFT_TP_CD     = CUT.CONTR_UPLFT_TP_CD(+)
            <!-- UPLFT_PRC_METH -->
            AND UPM.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCIDR.UPLFT_PRC_METH_CD     = UPM.UPLFT_PRC_METH_CD(+)
            <!-- EZCANCELFLAG -->
            AND DCIDR.EZCANCELFLAG          = '0'
            AND BTC.EZCANCELFLAG(+)         = '0'
            AND MRM.EZCANCELFLAG(+)         = '0'
            AND CART.EZCANCELFLAG(+)        = '0'
            AND RPM.EZCANCELFLAG(+)         = '0'
            AND MET.EZCANCELFLAG(+)         = '0'
            AND BC_B.EZCANCELFLAG(+)        = '0'
            AND BC_U.EZCANCELFLAG(+)        = '0'
            AND CUT.EZCANCELFLAG(+)         = '0'
            AND UPM.EZCANCELFLAG(+)         = '0'
    </statement>

    <statement id="getDsContrHeader" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.EZUPUSERID                  AS EZUPUSERID
            ,DC.DS_CONTR_PK                  AS DS_CONTR_PK
            ,DCI.DS_CONTR_NUM                AS DS_CONTR_NUM
            ,DCI.DS_CONTR_STS_CD             AS DS_CONTR_STS_CD
            ,DCI.CONTR_FROM_DT               AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT               AS CONTR_THRU_DT
            ,DCI.BILL_TO_CUST_CD             AS BILL_TO_CUST_CD
            ,DCI.DS_CONTR_CATG_CD            AS DS_CONTR_CATG_CD
            ,DCI.CUST_PO_NUM                 AS CUST_PO_NUM
            ,DCI.PO_DT                       AS PO_DT
            ,DCI.PMT_TERM_CASH_DISC_CD       AS PMT_TERM_CASH_DISC_CD
            ,DCI.CONTR_AUTO_RNW_TP_CD        AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD             AS RNW_PRC_METH_CD
            ,DCI.RNW_PRC_UP_RATIO            AS RNW_PRC_UP_RATIO
            ,DC.CCY_CD                       AS CCY_CD
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD           AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG       AS INV_SEPT_BASE_USG_FLG
            ,DCI.EZINTIME                    AS EZINTIME
            ,DCI.EZINUSERID                  AS EZINUSERID
            ,DCI.EZUPTIME                    AS EZUPTIME
            ,DCI.EZUPUSERID                  AS EZUPUSERID
            ,DCI.LEASE_CMPY_CD               AS LEASE_CMPY_CD
            ,DCI.CONTR_UPLFT_TP_CD           AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD           AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO          AS UPLFT_PRC_UP_RATIO
            ,DCI.DS_ACCT_NUM                 AS DS_ACCT_NUM
            ,NVL(DCI.CONTR_ADMIN_PSN_CD, DC.CONTR_ADMIN_PSN_CD) AS CONTR_ADMIN_PSN_CD
            ,DCI.TOC_CD                      AS TOC_CD
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG  AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.MTR_EST_TP_CD               AS MTR_EST_TP_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG   AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.SVC_CONTR_BR_CD             AS SVC_CONTR_BR_CD
            ,DCI.DS_CONTR_CLS_CD             AS DS_CONTR_CLS_CD
            ,NVL(DCI.CTAC_PSN_PK, CP.CTAC_PSN_PK) AS CTAC_PSN_PK
            ,DCI.SVC_LINE_BIZ_CD             AS SVC_LINE_BIZ_CD
            ,DCI.DS_CONTR_EDI_CD             AS DS_CONTR_EDI_CD
            ,DC.QLTY_ASRN_HLD_FLG            AS QLTY_ASRN_HLD_FLG
            ,DC.MTR_HLD_FLG                  AS MTR_HLD_FLG
            ,DC.CONTR_HLD_FLG                AS CONTR_HLD_FLG
            ,DC.BLLG_HLD_FLG                 AS BLLG_HLD_FLG
            ,DCI.SVC_PGM_MDSE_CD             AS SVC_PGM_MDSE_CD
            ,DCI.BLLG_CYCLE_CD               AS BASE_BLLG_CYCLE_CD
            ,DC.CONTR_VRSN_EFF_FROM_DT       AS CONTR_VRSN_EFF_FROM_DT
            ,DC.CONTR_VRSN_EFF_THRU_DT       AS CONTR_VRSN_EFF_THRU_DT
        FROM
             DS_CONTR_INTFC DCI
            ,DS_CONTR       DC
            ,DS_CONTR_DTL   DCD
            ,GLBL_CMPY      GC
            ,BILL_TO_CUST   BTC
            ,CTAC_PSN       CP
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            
            AND DCI.GLBL_CMPY_CD            = DC.GLBL_CMPY_CD(+)
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            
            AND DC.GLBL_CMPY_CD             = DCD.GLBL_CMPY_CD(+)
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            
            AND GC.GLBL_CMPY_CD             = #glblCmpyCd#
            
            AND DCI.GLBL_CMPY_CD            = BTC.GLBL_CMPY_CD(+)
            AND DCI.BILL_TO_CUST_CD         = BTC.BILL_TO_CUST_CD(+)
            
            AND BTC.GLBL_CMPY_CD            = CP.GLBL_CMPY_CD(+)
            AND BTC.PTY_LOC_PK              = CP.PTY_LOC_PK(+)
            AND CP.CTAC_PSN_ACTV_FLG(+)     = 'Y'
            
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND GC.EZCANCELFLAG             = '0'
            AND BTC.EZCANCELFLAG(+)         = '0'
            AND CP.EZCANCELFLAG(+)          = '0'
        ORDER BY DCI.SVC_MACH_MSTR_PK NULLS FIRST, DCI.CONTR_INTFC_DTL_TP_CD
    </statement>

    <statement id="getDsContrDetail" parameterClass="Map" resultClass="Map">
        SELECT
             DCD.DS_CONTR_DTL_PK               AS DS_CONTR_DTL_PK
            ,DC.DS_CONTR_PK                    AS DS_CONTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD         AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_CONTR_CATG_CD              AS DS_CONTR_CATG_CD
            ,DCD.DS_CONTR_DTL_STS_CD           AS DS_CONTR_DTL_STS_CD
            ,SMM.CPO_ORD_NUM                   AS CPO_ORD_NUM
            ,SMM.CPO_DTL_LINE_NUM              AS CPO_DTL_LINE_NUM
            ,SMM.CPO_DTL_LINE_SUB_NUM          AS CPO_DTL_LINE_SUB_NUM
            ,CPO.DS_ORD_TP_CD                  AS DS_ORD_TP_CD
            ,CPO.DS_ORD_RSN_CD                 AS DS_ORD_RSN_CD
            ,SMM.SVC_CONFIG_MSTR_PK            AS SVC_CONFIG_MSTR_PK
            ,SMM.SVC_MACH_MSTR_PK              AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_CLO_DAY                 AS CONTR_CLO_DAY
            ,DCI.BLLG_CYCLE_CD                 AS BASE_BLLG_CYCLE_CD
            ,DCI.BLLG_TMG_TP_CD                AS BASE_BLLG_TMG_TP_CD
            ,DCI.CONTR_BLLG_DAY                AS CONTR_BLLG_DAY
            ,DCI2.BLLG_CYCLE_CD                AS MTR_BLLG_CYCLE_CD
            ,DCI2.BLLG_TMG_TP_CD               AS MTR_BLLG_TMG_CD
            ,DCI.BASE_PRC_DEAL_AMT             AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_FROM_DT                 AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                 AS CONTR_THRU_DT
            ,DCI.CONTR_CLO_DT                  AS CONTR_CLO_DT
            ,DCI.BILL_TO_CUST_CD               AS BASE_BILL_TO_CUST_CD
            ,DCI2.BILL_TO_CUST_CD              AS USG_BILL_TO_CUST_CD
            <!-- START 2023/02/16 K.Watanabe [QC#60913, MOD] -->
            <!-- ,DCI.MTR_READ_METH_CD              AS MTR_READ_METH_CD -->
            ,DCI2.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            <!-- END 2023/02/16 K.Watanabe [QC#60913, MOD] -->
            ,NVL(DCI.CTAC_PSN_PK, CP.CTAC_PSN_PK) AS CTAC_PSN_PK
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE   AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCD.QLTY_ASRN_HLD_FLG             AS QLTY_ASRN_HLD_FLG
            ,DCD.MTR_HLD_FLG                   AS MTR_HLD_FLG
            ,DCD.CONTR_HLD_FLG                 AS CONTR_HLD_FLG
            ,DCD.BLLG_HLD_FLG                  AS BLLG_HLD_FLG
            ,DCD.PRNT_DS_CONTR_DTL_PK          AS PRNT_DS_CONTR_DTL_PK
            ,DCI.SVC_PGM_MDSE_CD               AS SVC_PGM_MDSE_CD
            ,CASE WHEN SMM.SVC_MACH_MSTR_PK &lt;&gt; SCM.SVC_MACH_MSTR_PK THEN SCM.SVC_MACH_MSTR_PK
                  ELSE NULL END                AS PRNT_SVC_MACH_MSTR_PK
            ,DCI.BLLG_THRU_DT                  AS BLLG_THRU_DT
            ,SMM.SVC_CONFIG_MSTR_PK            AS SVC_CONFIG_MSTR_PK
            ,SMM.SVC_MACH_TP_CD                AS SVC_MACH_TP_CD
            ,DCD.SUPPR_CR_FLG                  AS SUPPR_CR_FLG
            ,DCI.MAN_CONTR_OVRD_FLG            AS MAN_CONTR_OVRD_FLG
            ,DMD.MTR_REQ_MDL_FLG               AS MTR_REQ_MDL_FLG
            ,DCI.DS_CONTR_SRC_REF_NUM          AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD         AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_BAT_NUM        AS DS_CONTR_INTFC_BAT_NUM
<!-- add start 2018/08/30 QC#27102 -->
            ,DC.DS_CONTR_CLS_CD                AS DS_CONTR_CLS_CD
            ,DC.SVC_LINE_BIZ_CD                AS SVC_LINE_BIZ_CD
<!-- add end   2018/08/30 QC#27102 -->
        FROM
             DS_CONTR_INTFC  DCI
            ,SVC_MACH_MSTR   SMM
            ,SVC_CONFIG_MSTR SCM
            ,DS_CONTR        DC
            ,DS_CONTR_DTL    DCD
            ,CPO             CPO
            ,BILL_TO_CUST    BTC
            ,CTAC_PSN        CP
            ,DS_MDL          DMD
            ,(SELECT
                  DCI_M.*
              FROM
                  DS_CONTR_INTFC DCI_M
              WHERE
                      DCI_M.GLBL_CMPY_CD            = #glblCmpyCd#
                  AND DCI_M.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
                  AND DCI_M.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                  AND DCI_M.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                  AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
                  AND DCI_M.CONTR_INTFC_DTL_TP_CD   = #usage#
                  AND DCI_M.DS_CONTR_INTFC_PK = (SELECT
                                                     MIN(A.DS_CONTR_INTFC_PK)
                                                 FROM
                                                     DS_CONTR_INTFC A
                                                 WHERE
                                                     DCI_M.GLBL_CMPY_CD                = A.GLBL_CMPY_CD
                                                     AND DCI_M.DS_CONTR_PROC_STS_CD    = A.DS_CONTR_PROC_STS_CD
                                                     AND DCI_M.DS_CONTR_SRC_REF_NUM    = A.DS_CONTR_SRC_REF_NUM
                                                     AND DCI_M.CONTR_INTFC_SRC_TP_CD   = A.CONTR_INTFC_SRC_TP_CD
                                                     AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = A.DS_CONTR_INTFC_BAT_NUM
                                                     AND DCI_M.CONTR_INTFC_DTL_TP_CD   = A.CONTR_INTFC_DTL_TP_CD
                                                     AND NVL(DCI_M.SVC_MACH_MSTR_PK, 0)= NVL(A.SVC_MACH_MSTR_PK, 0)
                                                     AND A.EZCANCELFLAG                = '0'
                                                )
                  AND DCI_M.EZCANCELFLAG            = '0'
            ) DCI2
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.CONTR_INTFC_DTL_TP_CD   = #base#
            <!-- SVC_MACH_MSTR -->
            AND DCI.GLBL_CMPY_CD            = SMM.GLBL_CMPY_CD(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(SMM.SVC_MACH_MSTR_PK(+), 0)
            <!-- SVC_CONFIG_MSTR -->
            AND SMM.GLBL_CMPY_CD            = SCM.GLBL_CMPY_CD(+)
            AND SMM.SVC_CONFIG_MSTR_PK      = SCM.SVC_CONFIG_MSTR_PK(+)
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DC.GLBL_CMPY_CD             = DCD.GLBL_CMPY_CD(+)
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            <!-- add start 2019/10/09 QC#54022 -->
            AND DCI.OLD_DS_CONTR_DTL_PK     = DCD.DS_CONTR_DTL_PK(+)
            <!-- add end 2019/10/09 QC#54022 -->
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            AND DCD.DS_CONTR_DTL_STS_CD(+)  NOT IN (#canc#, #trmd#, #expd#)
            <!-- CPO -->
            AND CPO.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = CPO.CPO_ORD_NUM(+)
            <!-- BILL_TO_CUST -->
            AND BTC.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCI.BILL_TO_CUST_CD         = BTC.BILL_TO_CUST_CD(+)
            <!-- CTAC_PSN -->
            AND CP.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND BTC.PTY_LOC_PK              = CP.PTY_LOC_PK(+)
            AND CP.CTAC_PSN_ACTV_FLG(+)     = 'Y'
            <!-- DS_CONTR_INTFC (Usage) -->
            AND DCI2.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCI2.DS_CONTR_PROC_STS_CD(+) IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = DCI2.DS_CONTR_SRC_REF_NUM(+)
            AND DCI.CONTR_INTFC_SRC_TP_CD   = DCI2.CONTR_INTFC_SRC_TP_CD(+)
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = DCI2.DS_CONTR_INTFC_BAT_NUM(+)
            AND DCI2.CONTR_INTFC_DTL_TP_CD(+)
                                            = #usage#
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCI2.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_MDL -->
            AND SCM.GLBL_CMPY_CD            = DMD.GLBL_CMPY_CD(+)
            AND SCM.MDL_ID                  = DMD.MDL_ID(+)
            AND DCI.EZCANCELFLAG            = '0'
            AND SMM.EZCANCELFLAG(+)         = '0'
            AND SCM.EZCANCELFLAG(+)         = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND CPO.EZCANCELFLAG(+)         = '0'
            AND BTC.EZCANCELFLAG(+)         = '0'
            AND CP.EZCANCELFLAG(+)          = '0'
            AND DCI2.EZCANCELFLAG(+)        = '0'
            AND DMD.EZCANCELFLAG(+)         = '0'
          ORDER BY SMM.SVC_CONFIG_MSTR_PK ASC NULLS FIRST, SMM.SVC_MACH_TP_CD
    </statement>

    <statement id="getDsContrRenewalEscalation" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DCI.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
            ,DCI.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCRE.DS_CONTR_RNW_ESCL_PK        AS DS_CONTR_RNW_ESCL_PK
            ,DCD.DS_CONTR_PK                  AS DS_CONTR_PK
            ,DCD.DS_CONTR_DTL_PK              AS DS_CONTR_DTL_PK
            ,DCD.DS_CONTR_DTL_TP_CD           AS DS_CONTR_DTL_TP_CD
            ,DCRE.DS_CONTR_RNW_ESCL_PK        AS DS_CONTR_RNW_ESCL_PK
            ,DCRE.DS_CONTR_BASE_USG_NM        AS DS_CONTR_BASE_USG_NM
            ,DCRE.FIRST_YR_CONTR_UPLFT_FLG    AS FIRST_YR_CONTR_UPLFT_FLG
            ,DCRE.SCD_YR_CONTR_UPLFT_FLG      AS SCD_YR_CONTR_UPLFT_FLG
            ,DCRE.THIRD_YR_CONTR_UPLFT_FLG    AS THIRD_YR_CONTR_UPLFT_FLG
            ,DCRE.FRTH_YR_CONTR_UPLFT_FLG     AS FRTH_YR_CONTR_UPLFT_FLG
            ,DCRE.FIFTH_YR_CONTR_UPLFT_FLG    AS FIFTH_YR_CONTR_UPLFT_FLG
            ,DCRE.SIXTH_YR_CONTR_UPLFT_FLG    AS SIXTH_YR_CONTR_UPLFT_FLG
            ,DCRE.SVNTH_YR_CONTR_UPLFT_FLG    AS SVNTH_YR_CONTR_UPLFT_FLG
            ,DCRE.EIGHTH_YR_CONTR_UPLFT_FLG   AS EIGHTH_YR_CONTR_UPLFT_FLG
            ,DCRE.NINTH_YR_CONTR_UPLFT_FLG    AS NINTH_YR_CONTR_UPLFT_FLG
            ,DCRE.TENTH_YR_CONTR_UPLFT_FLG    AS TENTH_YR_CONTR_UPLFT_FLG
            ,DCIDR.BEF_END_UPLFT_DAYS_AOT     AS BEF_END_UPLFT_DAYS_AOT
        FROM
             DS_CONTR_INTFC     DCI
            ,DS_CONTR           DC
            ,DS_CONTR_DTL       DCD
            ,CONTR_INTFC_SRC_TP CIST
            ,DS_CONTR_RNW_ESCL  DCRE
            ,DS_CONTR_INTFC_DEF_RULE  DCIDR
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- CONTR_INTFC_SRC_TP -->
            AND CIST.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = CIST.CONTR_INTFC_SRC_TP_CD(+)
            <!-- DS_CONTR_RNW_ESCL -->
            AND DCRE.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCRE.DS_CONTR_PK(+)
            AND (   (DCRE.DS_CONTR_MACH_LVL_NUM(+)  &lt;&gt; #lvl1# AND DCD.DS_CONTR_DTL_PK = DCRE.DS_CONTR_DTL_PK(+))
                 OR (DCRE.DS_CONTR_MACH_LVL_NUM(+)    = #lvl1#))
            AND (   (DCRE.DS_CONTR_MACH_LVL_NUM(+)    = #lvl3# AND CIST.CONTR_INTFC_SRC_TP_NM = DCRE.DS_CONTR_BASE_USG_NM(+))
                 OR (DCRE.DS_CONTR_MACH_LVL_NUM(+)  &lt;&gt; #lvl3#))
            <!-- DS_CONTR_INTFC_DEF_RULE -->
            AND DCI.GLBL_CMPY_CD            = DCIDR.GLBL_CMPY_CD(+)
            AND DCI.CONTR_INTFC_SRC_TP_CD   = DCIDR.CONTR_INTFC_SRC_TP_CD(+)
            AND DCI.DS_CONTR_CLS_CD         = DCIDR.DS_CONTR_CLS_CD(+)
            AND DCI.SVC_LINE_BIZ_CD         = DCIDR.SVC_LINE_BIZ_CD(+)
            AND DCIDR.EFF_FROM_DT(+)        &lt;= #salesDate#
            AND DCIDR.ENBL_FLG(+)           = 'Y'
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND CIST.EZCANCELFLAG(+)        = '0'
            AND DCRE.EZCANCELFLAG(+)        = '0'
            AND DCIDR.EZCANCELFLAG(+)       = '0'
          ORDER BY
             DCI.CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD
            ,DCI.CONTR_INTFC_DTL_TP_CD
    </statement>
 
     <statement id="getContractCreditCardPo" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
             DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCCCP.DS_CONTR_CR_CARD_PO_PK     AS DS_CONTR_CR_CARD_PO_PK
            ,DC.DS_CONTR_PK                   AS DS_CONTR_PK
            ,DCD.DS_CONTR_DTL_PK              AS DS_CONTR_DTL_PK
            ,DACL.LEASE_CMPY_FLG              AS LEASE_CMPY_FLG
        FROM
             DS_CONTR_INTFC      DCI
            ,DS_CONTR            DC
            ,DS_CONTR_DTL        DCD
            ,DS_CONTR_CR_CARD_PO DCCCP
            ,SELL_TO_CUST        STC
            ,DS_ACCT_CLS         DACL
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.CONTR_INTFC_DTL_TP_CD   = #base#
            AND DCI.SVC_MACH_MSTR_PK        IS NOT NULL
            AND (
                   DCI.CUST_PO_NUM          IS NOT NULL
                OR DCI.PO_DT                IS NOT NULL
                OR DCI.CR_CARD_CUST_REF_NUM IS NOT NULL
                OR DCI.CR_CARD_EXPR_YR_MTH  IS NOT NULL
            )
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_CONTR_CR_CARD_PO -->
            AND DCCCP.GLBL_CMPY_CD(+)       = #glblCmpyCd#
            AND DCD.DS_CONTR_DTL_PK         = DCCCP.DS_CONTR_DTL_PK(+)
            <!-- SELL_TO_CUST -->
            AND STC.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCI.DS_ACCT_NUM             = STC.SELL_TO_CUST_CD(+)
            <!-- DS_ACCT_CLS -->
            AND DACL.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND STC.DS_ACCT_CLS_CD          = DACL.DS_ACCT_CLS_CD(+)
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND DCCCP.EZCANCELFLAG(+)       = '0'
            AND STC.EZCANCELFLAG(+)         = '0'
            AND DACL.EZCANCELFLAG(+)        = '0'
          ORDER BY DCI.SVC_MACH_MSTR_PK
    </statement>

    <statement id="getContrFleetAggregateLineForPoCard" parameterClass="Map" resultClass="Map">
        SELECT
             DCD.DS_CONTR_DTL_PK
            ,DCCCP.DS_CONTR_CR_CARD_PO_PK
        FROM
             DS_CONTR_DTL        DCD
            ,DS_CONTR_CR_CARD_PO DCCCP
        WHERE
                DCD.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DCD.DS_CONTR_PK               = #dsContrPk#
            AND DCD.DS_CONTR_DTL_TP_CD        IN (#dsContrDtlTpCd_Fleet#, #dsContrDtlTpCd_Aggregate#)
            AND DCD.EZCANCELFLAG              = '0'
            AND DCD.GLBL_CMPY_CD              = DCCCP.GLBL_CMPY_CD(+)
            AND DCD.DS_CONTR_DTL_PK           = DCCCP.DS_CONTR_DTL_PK(+)
            AND DCCCP.DS_CONTR_BLLG_MTR_PK(+) IS NULL
            AND DCCCP.EZCANCELFLAG(+)         = '0'
    </statement>

    <statement id="getContrAdditionalCharge" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCAC.DS_CONTR_ADDL_CHRG_PK       AS DS_CONTR_ADDL_CHRG_PK
            ,DCAC.DS_CONTR_PK                 AS DS_CONTR_PK
            ,DCAC.DS_CONTR_DTL_PK             AS DS_CONTR_DTL_PK
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DC.CCY_CD                        AS CCY_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCAC.ADDL_CHRG_FLAT_FUNC_PRC_AMT AS ADDL_CHRG_FLAT_FUNC_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCAC.PRINT_DTL_FLG               AS PRINT_DTL_FLG
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.CONTR_FROM_DT                AS EFF_FROM_DT
            ,DCI.CONTR_THRU_DT                AS EFF_THRU_DT
            ,DCAC.TRMN_DT                     AS TRMN_DT
            ,DCAC.ADDL_CHRG_INVD_FLG          AS ADDL_CHRG_INVD_FLG
            ,DCAC.INV_UP_TO_DT                AS INV_UP_TO_DT
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
        FROM
             DS_CONTR_INTFC      DCI
            ,DS_CONTR            DC
            ,GLBL_CMPY           GC
            ,DS_CONTR_ADDL_CHRG  DCAC
            ,DS_CONTR_DTL        DCD
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.ADDL_CHRG_INV_TP_CD     IS NOT NULL
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- GLBL_CMPY -->
            AND GC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            <!-- DS_CONTR_ADDL_CHRG -->
            AND DCAC.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCAC.DS_CONTR_PK(+)
            AND DCI.CHRG_LVL_TP_CD          = DCAC.SVC_BILL_BY_TP_CD(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCAC.DS_CONTR_DTL_PK        = DCD.DS_CONTR_DTL_PK(+)
            AND ((    DCI.CHRG_LVL_TP_CD           = #contra#
                  AND NVL(DCI.SVC_MACH_MSTR_PK, 0) = NVL(DCD.SVC_MACH_MSTR_PK, 0)
                  OR (DCI.CHRG_LVL_TP_CD      &lt;&gt; #contra#)))
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND GC.EZCANCELFLAG(+)          = '0'
            AND DCAC.EZCANCELFLAG(+)        = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
          ORDER BY DCI.DS_CONTR_SRC_REF_NUM, DCI.CONTR_INTFC_SRC_TP_CD, DCI.SVC_MACH_MSTR_PK
    </statement>

    <statement id="getContrAdditionalChargeList" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCAC.DS_CONTR_ADDL_CHRG_PK       AS DS_CONTR_ADDL_CHRG_PK
            ,DCAC.DS_CONTR_PK                 AS DS_CONTR_PK
            ,DCAC.DS_CONTR_DTL_PK             AS DS_CONTR_DTL_PK
            ,DACI.ADDL_CHRG_TP_CD             AS ADDL_CHRG_TP_CD
            ,DACI.CHRG_LVL_TP_CD              AS CHRG_LVL_TP_CD
            ,DACI.ADDL_CHRG_INV_TP_CD         AS ADDL_CHRG_INV_TP_CD
            ,DC.CCY_CD                        AS CCY_CD
            ,DACI.ADDL_CHRG_FLAT_DEAL_PRC_AMT AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCAC.ADDL_CHRG_FLAT_FUNC_PRC_AMT AS ADDL_CHRG_FLAT_FUNC_PRC_AMT
            ,DACI.ADDL_CHRG_APLC_PCT          AS ADDL_CHRG_APLC_PCT
            ,DACI.PRINT_DTL_FLG               AS PRINT_DTL_FLG
            ,DACI.BLLG_CYCLE_CD               AS BLLG_CYCLE_CD
            ,DCI.CONTR_FROM_DT                AS EFF_FROM_DT
            ,DCI.CONTR_THRU_DT                AS EFF_THRU_DT
            ,DCAC.TRMN_DT                     AS TRMN_DT
            ,DCAC.ADDL_CHRG_INVD_FLG          AS ADDL_CHRG_INVD_FLG
            ,DCAC.INV_UP_TO_DT                AS INV_UP_TO_DT
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
        FROM
             DS_CONTR_INTFC      DCI
            ,DS_ADDL_CHRG_INTFC  DACI
            ,DS_CONTR            DC
            ,GLBL_CMPY           GC
            ,DS_CONTR_ADDL_CHRG  DCAC
            ,DS_CONTR_DTL        DCD
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_ADDL_CHRG_INTFC -->
            AND DACI.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = DACI.DS_CONTR_SRC_REF_NUM
            AND DCI.CONTR_INTFC_SRC_TP_CD   = DACI.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = DACI.DS_CONTR_INTFC_BAT_NUM
            <!--AND ((    DCI.CHRG_LVL_TP_CD           = #contra# -->
            <!--      AND NVL(DCI.SVC_MACH_MSTR_PK, 0) = NVL(DACI.SVC_MACH_MSTR_PK, 0)) -->
            <!--      OR (DCI.CHRG_LVL_TP_CD      &lt;&gt; #contra#)) -->
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DACI.SVC_MACH_MSTR_PK, 0)
            AND DCI.CONTR_INTFC_DTL_TP_CD   = #contrIntfcDtlTpCd#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- GLBL_CMPY -->
            AND GC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            <!-- DS_CONTR_ADDL_CHRG -->
            AND DCAC.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCAC.DS_CONTR_PK(+)
            AND DCI.CHRG_LVL_TP_CD          = DCAC.SVC_BILL_BY_TP_CD(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCAC.DS_CONTR_DTL_PK        = DCD.DS_CONTR_DTL_PK(+)
            <!-- AND ((    DCI.CHRG_LVL_TP_CD           = #contra# -->
            <!--       AND NVL(DCI.SVC_MACH_MSTR_PK, 0) = NVL(DCD.SVC_MACH_MSTR_PK, 0)) -->
            <!--       OR (DCI.CHRG_LVL_TP_CD      &lt;&gt; #contra#)) -->
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            AND DCI.EZCANCELFLAG            = '0'
            AND DACI.EZCANCELFLAG           = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND GC.EZCANCELFLAG(+)          = '0'
            AND DCAC.EZCANCELFLAG(+)        = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
          ORDER BY DCI.DS_CONTR_SRC_REF_NUM, DCI.CONTR_INTFC_SRC_TP_CD, DCI.SVC_MACH_MSTR_PK
    </statement>

    <statement id="getContrBillingMeter" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DCI.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
            ,DCI.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,DCBM.DS_CONTR_BLLG_MTR_PK        AS DS_CONTR_BLLG_MTR_PK
            ,DCD.DS_CONTR_DTL_PK              AS DS_CONTR_DTL_PK
            ,DCBM.DS_CONTR_BLLG_MTR_ID        AS DS_CONTR_BLLG_MTR_ID
            ,DCBM.MLY_COPY_INCL_PRC_QTY       AS MLY_COPY_INCL_PRC_QTY
            ,DCBM.DS_CONTR_BLLG_MTR_STS_CD    AS DS_CONTR_BLLG_MTR_STS_CD
            ,DCBM.ROLL_OVER_CNT               AS ROLL_OVER_CNT
            ,DCD.QLTY_ASRN_HLD_FLG            AS QLTY_ASRN_HLD_FLG
            ,DCD.MTR_HLD_FLG                  AS MTR_HLD_FLG
            ,DCD.CONTR_HLD_FLG                AS CONTR_HLD_FLG
            ,DCD.BLLG_HLD_FLG                 AS BLLG_HLD_FLG
        FROM
             DS_CONTR_INTFC      DCI
            ,DS_CONTR            DC
            ,DS_CONTR_DTL        DCD
            ,DS_CONTR_BLLG_MTR   DCBM
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
<!-- mod start 2016/10/27 CSA Defect#14338 -->
            AND NOT EXISTS (SELECT
                                'NG'
                            FROM
                                DS_MDL DMD
                            WHERE
                                    DCI.GLBL_CMPY_CD     = DMD.GLBL_CMPY_CD
                                AND DCI.MDL_ID           = DMD.MDL_ID
                                AND DMD.MTR_REQ_MDL_FLG  = 'N'
                                AND DMD.EZCANCELFLAG     = '0'
                            )
<!-- mod end 2016/10/27 CSA Defect#14338 -->
            AND NOT EXISTS (SELECT
                                'NG'
                            FROM
                                DS_ACTL_CNT_INTFC    DACI
                            WHERE
                                DCI.GLBL_CMPY_CD                 = DACI.GLBL_CMPY_CD
                                AND DCI.DS_CONTR_SRC_REF_NUM     = DACI.DS_CONTR_SRC_REF_NUM
                                AND DCI.CONTR_INTFC_SRC_TP_CD    = DACI.CONTR_INTFC_SRC_TP_CD
                                AND DCI.DS_CONTR_INTFC_BAT_NUM   = DACI.DS_CONTR_INTFC_BAT_NUM
                                AND DCI.BLLG_MTR_LB_CD           = DACI.BLLG_MTR_LB_CD
                                AND NVL(DCI.SVC_MACH_MSTR_PK, 0) = NVL(DACI.SVC_MACH_MSTR_PK, 0)
                                AND DACI.BLLBL_FLG               = 'N'
                                AND DACI.EZCANCELFLAG            = '0'
                            )
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_CONTR_BLLG_MTR -->
            AND DCBM.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCD.DS_CONTR_DTL_PK         = DCBM.DS_CONTR_DTL_PK(+)
            AND DCI.BLLG_MTR_LB_CD          = DCBM.BLLG_MTR_LB_CD(+)
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND DCBM.EZCANCELFLAG(+)        = '0'
          ORDER BY DCI.DS_CONTR_SRC_REF_NUM, DCI.CONTR_INTFC_SRC_TP_CD, DCI.SVC_MACH_MSTR_PK NULLS FIRST, DCI.BLLG_MTR_LB_CD
    </statement>

    <statement id="getContrPhysicalBillingMeterRelation" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DCI.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
            ,DCI.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,CPBMR.CONTR_PHYS_BLLG_MTR_RELN_PK  AS CONTR_PHYS_BLLG_MTR_RELN_PK
            ,CPBMR.DS_CONTR_DTL_PK            AS DS_CONTR_DTL_PK
            ,DACI.SVC_MACH_MSTR_PK            AS SVC_MACH_MSTR_PK
            ,DACI.CONTR_MTR_MULT_RATE         AS CONTR_MTR_MULT_RATE
            ,DACI.BLLG_MTR_LB_CD              AS BLLG_MTR_LB_CD
            ,CPBMR.DS_CONTR_BLLG_MTR_PK       AS DS_CONTR_BLLG_MTR_PK
            ,SPM.SVC_PHYS_MTR_PK              AS SVC_PHYS_MTR_PK
            ,DACI.BLLBL_FLG                   AS BLLBL_FLG
            ,ML.BLLG_MTR_LVL_NUM              AS BLLG_MTR_LVL_NUM
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_ACTL_CNT_INTFC        DACI
            ,SVC_PHYS_MTR             SPM
            ,MTR_LB                   ML
            ,DS_CONTR                 DC
            ,DS_CONTR_DTL             DCD
            ,CONTR_PHYS_BLLG_MTR_RELN CPBMR
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
<!-- mod start 2016/10/27 CSA Defect#14338 -->
            AND NOT EXISTS (SELECT
                                'NG'
                            FROM
                                DS_MDL DMD
                            WHERE
                                    DCI.GLBL_CMPY_CD     = DMD.GLBL_CMPY_CD
                                AND DCI.MDL_ID           = DMD.MDL_ID
                                AND DMD.MTR_REQ_MDL_FLG  = 'N'
                                AND DMD.EZCANCELFLAG     = '0'
                           )
<!-- mod end 2016/10/27 CSA Defect#14338 -->
            <!-- DS_ACTL_CNT_INTFC -->
            AND DACI.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = DACI.DS_CONTR_SRC_REF_NUM
            AND DCI.CONTR_INTFC_SRC_TP_CD   = DACI.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = DACI.DS_CONTR_INTFC_BAT_NUM
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DACI.SVC_MACH_MSTR_PK, 0)
            AND DCI.BLLG_MTR_LB_CD          = DACI.BLLG_MTR_LB_CD 
            <!-- SVC_PHYS_MTR -->
            AND SPM.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(SPM.SVC_MACH_MSTR_PK(+), 0)
            AND DACI.PHYS_MTR_LB_CD         = SPM.MDL_MTR_LB_CD(+)
            <!-- MTR_LB -->
            AND ML.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DACI.BLLG_MTR_LB_CD         = ML.MTR_LB_CD
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- CONTR_PHYS_BLLG_MTR_RELN -->
            AND CPBMR.GLBL_CMPY_CD(+)       = #glblCmpyCd#
            AND DCD.DS_CONTR_DTL_PK         = CPBMR.DS_CONTR_DTL_PK(+)
            AND DCI.BLLG_MTR_LB_CD          = CPBMR.BLLG_MTR_LB_CD(+)
            AND DCI.EZCANCELFLAG            = '0'
            AND DACI.EZCANCELFLAG           = '0'
            AND SPM.EZCANCELFLAG(+)         = '0'
            AND ML.EZCANCELFLAG             = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND CPBMR.EZCANCELFLAG(+)       = '0'
          ORDER BY DCI.DS_CONTR_SRC_REF_NUM, DCI.CONTR_INTFC_SRC_TP_CD, DCI.SVC_MACH_MSTR_PK NULLS FIRST, DCI.BLLG_MTR_LB_CD
    </statement>

    <statement id="getContractExcessCopy" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DCI.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
            ,DCI.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,CXC.CONTR_XS_COPY_PK             AS CONTR_XS_COPY_PK
            ,DCBM.DS_CONTR_BLLG_MTR_PK        AS DS_CONTR_BLLG_MTR_PK
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_DTL             DCD
            ,DS_CONTR_BLLG_MTR        DCBM
            ,CONTR_XS_COPY            CXC
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.XS_MTR_COPY_QTY        IS NOT NULL
<!-- mod start 2016/10/27 CSA Defect#14338 -->
            AND NOT EXISTS (SELECT
                                'NG'
                            FROM
                                DS_MDL DMD
                            WHERE
                                    DCI.GLBL_CMPY_CD     = DMD.GLBL_CMPY_CD
                                AND DCI.MDL_ID           = DMD.MDL_ID
                                AND DMD.MTR_REQ_MDL_FLG  = 'N'
                                AND DMD.EZCANCELFLAG     = '0'
                           )
<!-- mod end 2016/10/27 CSA Defect#14338 -->
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_CONTR_BLLG_MTR -->
            AND DCBM.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCD.DS_CONTR_DTL_PK         = DCBM.DS_CONTR_DTL_PK(+)
            AND DCI.BLLG_MTR_LB_CD          = DCBM.BLLG_MTR_LB_CD(+)
            <!-- CONTR_XS_COPY -->
            AND CXC.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCBM.DS_CONTR_BLLG_MTR_PK   = CXC.DS_CONTR_BLLG_MTR_PK(+)
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND DCBM.EZCANCELFLAG(+)        = '0'
            AND CXC.EZCANCELFLAG(+)         = '0'
          ORDER BY DCI.DS_CONTR_SRC_REF_NUM, DCI.CONTR_INTFC_SRC_TP_CD, DCI.SVC_MACH_MSTR_PK NULLS FIRST, DCI.BLLG_MTR_LB_CD
    </statement>

    <statement id="getContractExcessCopyList" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DXCI.XS_MTR_COPY_QTY             AS XS_MTR_COPY_QTY
            ,DXCI.XS_MTR_AMT_RATE             AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,CXC.CONTR_XS_COPY_PK             AS CONTR_XS_COPY_PK
            ,DCBM.DS_CONTR_BLLG_MTR_PK        AS DS_CONTR_BLLG_MTR_PK
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_XS_COPY_INTFC         DXCI
            ,DS_CONTR                 DC
            ,DS_CONTR_DTL             DCD
            ,DS_CONTR_BLLG_MTR        DCBM
            ,CONTR_XS_COPY            CXC
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
<!-- mod start 2016/10/27 CSA Defect#14338 -->
            AND NOT EXISTS (SELECT
                                'NG'
                            FROM
                                DS_MDL DMD
                            WHERE
                                    DCI.GLBL_CMPY_CD     = DMD.GLBL_CMPY_CD
                                AND DCI.MDL_ID           = DMD.MDL_ID
                                AND DMD.MTR_REQ_MDL_FLG  = 'N'
                                AND DMD.EZCANCELFLAG     = '0'
                           )
<!-- mod end 2016/10/27 CSA Defect#14338 -->
            <!-- DS_XS_COPY_INTFC -->
            AND DXCI.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = DXCI.DS_CONTR_SRC_REF_NUM
            AND DCI.CONTR_INTFC_SRC_TP_CD   = DXCI.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = DXCI.DS_CONTR_INTFC_BAT_NUM
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DXCI.SVC_MACH_MSTR_PK, 0)
            AND DCI.BLLG_MTR_LB_CD          = DXCI.BLLG_MTR_LB_CD
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_CONTR_BLLG_MTR -->
            AND DCBM.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCD.DS_CONTR_DTL_PK         = DCBM.DS_CONTR_DTL_PK(+)
            AND DCI.BLLG_MTR_LB_CD          = DCBM.BLLG_MTR_LB_CD(+)
            <!-- CONTR_XS_COPY -->
            AND CXC.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DCBM.DS_CONTR_BLLG_MTR_PK   = CXC.DS_CONTR_BLLG_MTR_PK(+)
            AND DCI.EZCANCELFLAG            = '0'
            AND DXCI.EZCANCELFLAG           = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND DCBM.EZCANCELFLAG(+)        = '0'
            AND CXC.EZCANCELFLAG(+)         = '0'
          ORDER BY DCI.DS_CONTR_SRC_REF_NUM, DCI.CONTR_INTFC_SRC_TP_CD, DCI.SVC_MACH_MSTR_PK NULLS FIRST, DCI.BLLG_MTR_LB_CD
    </statement>

    <statement id="getContractExcessCopyListForUpdate" parameterClass="Map" resultClass="Map">
        SELECT
            A.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,A.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,A.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,A.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,A.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,A.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,A.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,A.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,A.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,A.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,A.SER_NUM                      AS SER_NUM
            ,A.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,A.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,A.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,A.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,A.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,A.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,A.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,A.TOC_CD                       AS TOC_CD
            ,A.CUST_PO_NUM                  AS CUST_PO_NUM
            ,A.PO_DT                        AS PO_DT
            ,A.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,A.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,A.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,A.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,A.MDSE_CD                      AS MDSE_CD
            ,A.MDL_ID                       AS MDL_ID
            ,A.MDL_NM                       AS MDL_NM
            ,A.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,A.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,A.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,A.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,A.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,A.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,A.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,A.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,A.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,A.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,A.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,A.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,A.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,A.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,A.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,A.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,A.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,A.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,A.START_MTR_CNT                AS START_MTR_CNT
            ,A.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,A.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,A.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,A.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,A.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
            ,A.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
            ,A.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,A.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,A.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,A.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,A.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,A.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,A.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,A.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,A.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,A.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,A.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,A.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,A.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,A.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,A.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,A.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,A.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,A.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,A.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,A.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,A.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,A.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,A.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,A.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,A.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,A.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,A.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,A.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,A.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,A.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,A.CONTR_XS_COPY_PK             AS CONTR_XS_COPY_PK
            ,A.DS_CONTR_BLLG_MTR_PK         AS DS_CONTR_BLLG_MTR_PK
        FROM(
            SELECT
                 DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
                ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
                ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
                ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
                ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
                ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
                ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
                ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
                ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
                ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
                ,DCI.SER_NUM                      AS SER_NUM
                ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
                ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
                ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
                ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
                ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
                ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
                ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
                ,DCI.TOC_CD                       AS TOC_CD
                ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
                ,DCI.PO_DT                        AS PO_DT
                ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
                ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
                ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
                ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
                ,DCI.MDSE_CD                      AS MDSE_CD
                ,DCI.MDL_ID                       AS MDL_ID
                ,DCI.MDL_NM                       AS MDL_NM
                ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
                ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
                ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
                ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
                ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
                ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
                ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
                ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
                ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
                ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
                ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
                ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
                ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
                ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
                ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
                ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
                ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
                ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
                ,DCI.START_MTR_CNT                AS START_MTR_CNT
                ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
                ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
                ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
                ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
                ,CXC.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
                ,CXC.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
                ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
                ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
                ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
                ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
                ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
                ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
                ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
                ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
                ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
                ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
                ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
                ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
                ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
                ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
                ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
                ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
                ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
                ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
                ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
                ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
                ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
                ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
                ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
                ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
                ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
                ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
                ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
                ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
                ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
                ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
                ,CXC.CONTR_XS_COPY_PK             AS CONTR_XS_COPY_PK
                ,DCBM.DS_CONTR_BLLG_MTR_PK        AS DS_CONTR_BLLG_MTR_PK
            FROM
                 DS_CONTR_INTFC           DCI
                ,DS_CONTR                 DC
                ,DS_CONTR_DTL             DCD
                ,DS_CONTR_BLLG_MTR        DCBM
                ,CONTR_XS_COPY            CXC
            WHERE
                <!-- DS_CONTR_INTFC -->
                DCI.GLBL_CMPY_CD                = #glblCmpyCd#
                AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
                AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
                AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
<!-- mod start 2016/10/27 CSA Defect#14338 -->
                AND NOT EXISTS (SELECT
                                    'NG'
                                FROM
                                    DS_MDL DMD
                                WHERE
                                        DCI.GLBL_CMPY_CD     = DMD.GLBL_CMPY_CD
                                    AND DCI.MDL_ID           = DMD.MDL_ID
                                    AND DMD.MTR_REQ_MDL_FLG  = 'N'
                                    AND DMD.EZCANCELFLAG     = '0'
                               )
<!-- mod end 2016/10/27 CSA Defect#14338 -->
                <!-- DS_CONTR -->
                AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
                AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
                <!-- DS_CONTR_DTL -->
                AND DCD.GLBL_CMPY_CD            = #glblCmpyCd#
                AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK
                AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK, 0)
                <!-- DS_CONTR_BLLG_MTR -->
                AND DCBM.GLBL_CMPY_CD           = #glblCmpyCd#
                AND DCD.DS_CONTR_DTL_PK         = DCBM.DS_CONTR_DTL_PK
                AND DCI.BLLG_MTR_LB_CD          = DCBM.BLLG_MTR_LB_CD
                <!-- CONTR_XS_COPY -->
                AND CXC.GLBL_CMPY_CD            = #glblCmpyCd#
                AND DCBM.DS_CONTR_BLLG_MTR_PK   = CXC.DS_CONTR_BLLG_MTR_PK
                AND DCI.EZCANCELFLAG            = '0'
                AND DC.EZCANCELFLAG             = '0'
                AND DCD.EZCANCELFLAG            = '0'
                AND DCBM.EZCANCELFLAG           = '0'
                AND CXC.EZCANCELFLAG            = '0'
            UNION ALL
            SELECT
                 DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
                ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
                ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
                ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
                ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
                ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
                ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
                ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
                ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
                ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
                ,DCI.SER_NUM                      AS SER_NUM
                ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
                ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
                ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
                ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
                ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
                ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
                ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
                ,DCI.TOC_CD                       AS TOC_CD
                ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
                ,DCI.PO_DT                        AS PO_DT
                ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
                ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
                ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
                ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
                ,DCI.MDSE_CD                      AS MDSE_CD
                ,DCI.MDL_ID                       AS MDL_ID
                ,DCI.MDL_NM                       AS MDL_NM
                ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
                ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
                ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
                ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
                ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
                ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
                ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
                ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
                ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
                ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
                ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
                ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
                ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
                ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
                ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
                ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
                ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
                ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
                ,DCI.START_MTR_CNT                AS START_MTR_CNT
                ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
                ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
                ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
                ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
                ,DXCI.XS_MTR_COPY_QTY             AS XS_MTR_COPY_QTY
                ,DXCI.XS_MTR_AMT_RATE             AS XS_MTR_AMT_RATE
                ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
                ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
                ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
                ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
                ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
                ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
                ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
                ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
                ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
                ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
                ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
                ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
                ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
                ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
                ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
                ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
                ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
                ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
                ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
                ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
                ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
                ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
                ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
                ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
                ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
                ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
                ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
                ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
                ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
                ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
                ,NULL                             AS CONTR_XS_COPY_PK
                ,DCBM.DS_CONTR_BLLG_MTR_PK        AS DS_CONTR_BLLG_MTR_PK
            FROM
                 DS_CONTR_INTFC           DCI
                ,DS_XS_COPY_INTFC         DXCI
                ,DS_CONTR                 DC
                ,DS_CONTR_DTL             DCD
                ,DS_CONTR_BLLG_MTR        DCBM
            WHERE
                <!-- DS_CONTR_INTFC -->
                DCI.GLBL_CMPY_CD                = #glblCmpyCd#
                AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
                AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
                AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
<!-- mod start 2016/10/27 CSA Defect#14338 -->
                AND NOT EXISTS (SELECT
                                    'NG'
                                FROM
                                    DS_MDL DMD
                                WHERE
                                        DCI.GLBL_CMPY_CD     = DMD.GLBL_CMPY_CD
                                    AND DCI.MDL_ID           = DMD.MDL_ID
                                    AND DMD.MTR_REQ_MDL_FLG  = 'N'
                                    AND DMD.EZCANCELFLAG     = '0'
                               )
<!-- mod end 2016/10/27 CSA Defect#14338 -->
                <!-- DS_XS_COPY_INTFC -->
                AND DXCI.GLBL_CMPY_CD           = #glblCmpyCd#
                AND DCI.DS_CONTR_SRC_REF_NUM    = DXCI.DS_CONTR_SRC_REF_NUM
                AND DCI.CONTR_INTFC_SRC_TP_CD   = DXCI.CONTR_INTFC_SRC_TP_CD
                AND DCI.DS_CONTR_INTFC_BAT_NUM  = DXCI.DS_CONTR_INTFC_BAT_NUM
                AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DXCI.SVC_MACH_MSTR_PK, 0)
                AND DCI.BLLG_MTR_LB_CD          = DXCI.BLLG_MTR_LB_CD
                <!-- DS_CONTR -->
                AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
                AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
                <!-- DS_CONTR_DTL -->
                AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
                AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
                AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
                <!-- DS_CONTR_BLLG_MTR -->
                AND DCBM.GLBL_CMPY_CD(+)        = #glblCmpyCd#
                AND DCD.DS_CONTR_DTL_PK         = DCBM.DS_CONTR_DTL_PK(+)
                AND DCI.BLLG_MTR_LB_CD          = DCBM.BLLG_MTR_LB_CD(+)
            ) A
        ORDER BY A.CONTR_XS_COPY_PK, A.DS_CONTR_SRC_REF_NUM, A.CONTR_INTFC_SRC_TP_CD, A.SVC_MACH_MSTR_PK NULLS FIRST, A.BLLG_MTR_LB_CD
    </statement>

    <statement id="getContractExcessCopyListForAddToContract" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DXCI.XS_MTR_COPY_QTY             AS XS_MTR_COPY_QTY
            ,DXCI.XS_MTR_AMT_RATE             AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,DCBM.DS_CONTR_BLLG_MTR_PK        AS DS_CONTR_BLLG_MTR_PK
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_XS_COPY_INTFC         DXCI
            ,DS_CONTR                 DC
            ,DS_CONTR_DTL             DCD
            ,DS_CONTR_BLLG_MTR        DCBM
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
<!-- mod start 2016/10/27 CSA Defect#14338 -->
            AND NOT EXISTS (SELECT
                                'NG'
                            FROM
                                DS_MDL DMD
                            WHERE
                                    DCI.GLBL_CMPY_CD     = DMD.GLBL_CMPY_CD
                                AND DCI.MDL_ID           = DMD.MDL_ID
                                AND DMD.MTR_REQ_MDL_FLG  = 'N'
                                AND DMD.EZCANCELFLAG     = '0'
                           )
<!-- mod end 2016/10/27 CSA Defect#14338 -->
            <!-- DS_XS_COPY_INTFC -->
            AND DXCI.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = DXCI.DS_CONTR_SRC_REF_NUM
            AND DCI.CONTR_INTFC_SRC_TP_CD   = DXCI.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = DXCI.DS_CONTR_INTFC_BAT_NUM
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DXCI.SVC_MACH_MSTR_PK, 0)
            AND DCI.BLLG_MTR_LB_CD          = DXCI.BLLG_MTR_LB_CD
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_CONTR_BLLG_MTR -->
            AND DCBM.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DCD.DS_CONTR_DTL_PK         = DCBM.DS_CONTR_DTL_PK(+)
            AND DCI.BLLG_MTR_LB_CD          = DCBM.BLLG_MTR_LB_CD(+)
            AND DCI.EZCANCELFLAG            = '0'
            AND DXCI.EZCANCELFLAG           = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND DCBM.EZCANCELFLAG(+)        = '0'
          ORDER BY DCI.DS_CONTR_SRC_REF_NUM, DCI.CONTR_INTFC_SRC_TP_CD, DCI.SVC_MACH_MSTR_PK NULLS FIRST, DCI.BLLG_MTR_LB_CD
    </statement>

    <statement id="getTermCondition" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_BAT_NUM       AS DS_CONTR_INTFC_BAT_NUM
            ,DCI.DS_CONTR_SRC_REF_NUM         AS DS_CONTR_SRC_REF_NUM
            ,DCI.CONTR_INTFC_SRC_TP_CD        AS CONTR_INTFC_SRC_TP_CD
            ,DCI.DS_CONTR_INTFC_ACT_CD        AS DS_CONTR_INTFC_ACT_CD
            ,DCI.DS_CONTR_PROC_STS_CD         AS DS_CONTR_PROC_STS_CD
            ,DCI.DS_CONTR_INTFC_STS_CD        AS DS_CONTR_INTFC_STS_CD
            ,DCI.INTFC_ERR_MSG_TXT            AS INTFC_ERR_MSG_TXT
            ,DCI.DS_CONTR_NUM                 AS DS_CONTR_NUM
            ,DCI.SER_NUM                      AS SER_NUM
            ,DCI.SVC_MACH_MSTR_PK             AS SVC_MACH_MSTR_PK
            ,DCI.CONTR_INTFC_DTL_TP_CD        AS CONTR_INTFC_DTL_TP_CD
            ,DCI.DS_ACCT_NUM                  AS DS_ACCT_NUM
            ,DCI.BILL_TO_CUST_CD              AS BILL_TO_CUST_CD
            ,DCI.BILL_TO_LOC_NUM              AS BILL_TO_LOC_NUM
            ,DCI.LEASE_CMPY_CD                AS LEASE_CMPY_CD
            ,DCI.SVC_CONTR_BR_CD              AS SVC_CONTR_BR_CD
            ,DCI.TOC_CD                       AS TOC_CD
            ,DCI.CUST_PO_NUM                  AS CUST_PO_NUM
            ,DCI.PO_DT                        AS PO_DT
            ,DCI.CR_CARD_CUST_REF_NUM         AS CR_CARD_CUST_REF_NUM
            ,DCI.CR_CARD_EXPR_YR_MTH          AS CR_CARD_EXPR_YR_MTH
            ,DCI.MTR_EST_TP_CD                AS MTR_EST_TP_CD
            ,DCI.SVC_PGM_MDSE_CD              AS SVC_PGM_MDSE_CD
            ,DCI.MDSE_CD                      AS MDSE_CD
            ,DCI.MDL_ID                       AS MDL_ID
            ,DCI.MDL_NM                       AS MDL_NM
            ,DCI.CONTR_FROM_DT                AS CONTR_FROM_DT
            ,DCI.CONTR_THRU_DT                AS CONTR_THRU_DT
            ,DCI.BLLG_CYCLE_CD                AS BLLG_CYCLE_CD
            ,DCI.PRC_ALLOC_BY_MACH_QTY_FLG    AS PRC_ALLOC_BY_MACH_QTY_FLG
            ,DCI.CONTR_AUTO_RNW_TP_CD         AS CONTR_AUTO_RNW_TP_CD
            ,DCI.RNW_PRC_METH_CD              AS RNW_PRC_METH_CD
            ,DCI.BEF_END_RNW_DAYS_AOT         AS BEF_END_RNW_DAYS_AOT
            ,DCI.RNW_PRC_UP_RATIO             AS RNW_PRC_UP_RATIO
            ,DCI.CONTR_UPLFT_TP_CD            AS CONTR_UPLFT_TP_CD
            ,DCI.UPLFT_PRC_METH_CD            AS UPLFT_PRC_METH_CD
            ,DCI.UPLFT_PRC_UP_RATIO           AS UPLFT_PRC_UP_RATIO
            ,DCI.MTR_READ_METH_CD             AS MTR_READ_METH_CD
            ,DCI.BASE_PRC_DEAL_AMT            AS BASE_PRC_DEAL_AMT
            ,DCI.CONTR_CLO_DAY                AS CONTR_CLO_DAY
            ,DCI.CONTR_BLLG_DAY               AS CONTR_BLLG_DAY
            ,DCI.BLLG_THRU_DT                 AS BLLG_THRU_DT
            ,DCI.BLLG_MTR_LB_CD               AS BLLG_MTR_LB_CD
            ,DCI.BLLG_MTR_LB_NM               AS BLLG_MTR_LB_NM
            ,DCI.START_MTR_CNT                AS START_MTR_CNT
            ,DCI.BLLG_ROLL_OVER_RATIO         AS BLLG_ROLL_OVER_RATIO
            ,DCI.DS_CONTR_CATG_CD             AS DS_CONTR_CATG_CD
            ,DCI.DS_CONTR_STS_CD              AS DS_CONTR_STS_CD
            ,DCI.XS_CHRG_TP_CD                AS XS_CHRG_TP_CD
            ,DCI.XS_MTR_COPY_QTY              AS XS_MTR_COPY_QTY
            ,DCI.XS_MTR_AMT_RATE              AS XS_MTR_AMT_RATE
            ,DCI.ADDL_CHRG_TP_CD              AS ADDL_CHRG_TP_CD
            ,DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT  AS ADDL_CHRG_FLAT_DEAL_PRC_AMT
            ,DCI.ADDL_CHRG_APLC_PCT           AS ADDL_CHRG_APLC_PCT
            ,DCI.CHRG_LVL_TP_CD               AS CHRG_LVL_TP_CD
            ,DCI.ADDL_CHRG_INV_TP_CD          AS ADDL_CHRG_INV_TP_CD
            ,DCI.BASE_PRC_TERM_DEAL_AMT_RATE  AS BASE_PRC_TERM_DEAL_AMT_RATE
            ,DCI.DS_CONTR_CLS_CD              AS DS_CONTR_CLS_CD
            ,DCI.CTAC_PSN_PK                  AS CTAC_PSN_PK
            ,DCI.CTAC_PSN_NM                  AS CTAC_PSN_NM
 <!--  Start 2022/03/22 [QC#59683, Add] -->
            ,DCI.DS_INV_TGTR_TP_CD            AS DS_INV_TGTR_TP_CD
 <!--  End   2022/03/22 [QC#59683, Add] -->
            ,DCI.INV_SEPT_BASE_USG_FLG        AS INV_SEPT_BASE_USG_FLG
            ,DCI.CONTR_CLO_DT                 AS CONTR_CLO_DT
            ,DCI.CONTR_DURN_AOT               AS CONTR_DURN_AOT
            ,DCI.PMT_TERM_CASH_DISC_CD        AS PMT_TERM_CASH_DISC_CD
            ,DCI.SVC_LINE_BIZ_CD              AS SVC_LINE_BIZ_CD
            ,DCI.BLLG_TMG_TP_CD               AS BLLG_TMG_TP_CD
            ,DCI.DS_CONTR_EDI_CD              AS DS_CONTR_EDI_CD
            ,DCI.DS_CONTR_INTFC_DT            AS DS_CONTR_INTFC_DT
            ,DCI.DS_CONTR_DESC_TXT            AS DS_CONTR_DESC_TXT
            ,DCI.BASE_CHRG_TO_LEASE_CMPY_FLG  AS BASE_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.USG_CHRG_TO_LEASE_CMPY_FLG   AS USG_CHRG_TO_LEASE_CMPY_FLG
            ,DCI.INTG_MDSE_CD                 AS INTG_MDSE_CD
            ,DCI.CAP_BW_ORIG_QTY              AS CAP_BW_ORIG_QTY
            ,DCI.CAP_COLOR_ORIG_QTY           AS CAP_COLOR_ORIG_QTY
            ,DCI.CAP_TOT_ORIG_QTY             AS CAP_TOT_ORIG_QTY
            ,DCI.CAP_BW_RUN_QTY               AS CAP_BW_RUN_QTY
            ,DCI.CAP_COLOR_RUN_QTY            AS CAP_COLOR_RUN_QTY
            ,DCI.CAP_TOT_RUN_QTY              AS CAP_TOT_RUN_QTY
            ,DCI.DS_CONTR_INTFC_BAT_SQ        AS DS_CONTR_INTFC_BAT_SQ
            ,DCI.PRC_SVC_PLN_TP_CD            AS PRC_SVC_PLN_TP_CD
            ,STC.SVC_TERM_COND_PK             AS SVC_TERM_COND_PK
            ,STC.DS_CONTR_PK                  AS DS_CONTR_PK
            ,STC.DS_CONTR_DTL_PK              AS DS_CONTR_DTL_PK
            ,STC.SVC_TERM_COND_ATTRB_PK       AS SVC_TERM_COND_ATTRB_PK
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_DTL             DCD
            ,SVC_TERM_COND            STC
            ,SVC_TERM_COND_ATTRB      STCA
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- SVC_TERM_COND -->
            AND STC.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = STC.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = STC.DS_CONTR_DTL_PK(+)
            AND STCA.SVC_TERM_COND_ATTRB_PK = STC.SVC_TERM_COND_ATTRB_PK(+)
            <!-- SVC_TERM_COND_ATTRB -->
            AND STCA.GLBL_CMPY_CD           = #glblCmpyCd#
            AND STCA.SVC_TERM_COND_ATTRB_NM IN
                            <iterate property="svcTermCondAttrb" var="svcTermCondAttrb[]"  open="(" close=" )" conjunction=",">
                                #svcTermCondAttrb[]#
                            </iterate>
            AND STCA.SVC_TERM_ATTRB_ACTV_FLG = 'Y'
            AND STCA.EFF_FROM_DT          &lt;=    #slsDt#
<!-- START 2016/11/04 N.Arai [QC#14840, MOD] -->
            AND NVL(STCA.EFF_THRU_DT,#slsDt#)      &gt;= #slsDt#
<!-- END 2016/11/04 N.Arai [QC#14840, MOD] -->
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND STC.EZCANCELFLAG(+)         = '0'
            AND STCA.EZCANCELFLAG           = '0'
          ORDER BY DCI.DS_CONTR_SRC_REF_NUM, DCI.CONTR_INTFC_SRC_TP_CD, DCI.SVC_MACH_MSTR_PK
    </statement>

    <statement id="getDsContrIntfcStatusClearList" parameterClass="Map" resultClass="Map"> 
        SELECT
             DCI.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK      AS DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC DCI
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.EZCANCELFLAG            = '0'
        ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>
    
    <statement id="getDsActlCntIntfcStatusClearList" parameterClass="Map" resultClass="Map">
        SELECT
             DACI.GLBL_CMPY_CD             AS GLBL_CMPY_CD
            ,DACI.DS_ACTL_CNT_INTFC_PK     AS DS_ACTL_CNT_INTFC_PK
        FROM
            DS_ACTL_CNT_INTFC DACI
        WHERE
            DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DACI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DACI.EZCANCELFLAG            = '0'
        ORDER BY DACI.DS_ACTL_CNT_INTFC_PK
    </statement>

    <statement id="getContrXsCopyIntfcStatusClearList" parameterClass="Map" resultClass="Map">
        SELECT
             DXCI.GLBL_CMPY_CD             AS GLBL_CMPY_CD
            ,DXCI.DS_XS_COPY_INTFC_PK      AS DS_XS_COPY_INTFC_PK
        FROM
            DS_XS_COPY_INTFC DXCI
        WHERE
            DXCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DXCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DXCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DXCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DXCI.EZCANCELFLAG            = '0'
        ORDER BY DXCI.DS_XS_COPY_INTFC_PK
    </statement>

    <statement id="getDsContrAddlChrgIntfcStatusClearList" parameterClass="Map" resultClass="Map">
        SELECT
             DACI.GLBL_CMPY_CD               AS GLBL_CMPY_CD
            ,DACI.DS_ADDL_CHRG_INTFC_PK      AS DS_ADDL_CHRG_INTFC_PK
        FROM
            DS_ADDL_CHRG_INTFC DACI
        WHERE
            DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DACI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DACI.EZCANCELFLAG            = '0'
        ORDER BY DACI.DS_ADDL_CHRG_INTFC_PK
    </statement>

    <statement id="getPrcAllocIntfcStatusClearList" parameterClass="Map" resultClass="Map"> 
        SELECT
             PAI.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,PAI.PRC_ALLOC_INTFC_PK     AS PRC_ALLOC_INTFC_PK
        FROM
            PRC_ALLOC_INTFC PAI
        WHERE
            PAI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND PAI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND PAI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND PAI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND PAI.EZCANCELFLAG            = '0'
        ORDER BY PAI.PRC_ALLOC_INTFC_PK
    </statement>

    <statement id="getPrcAllocIntfcStatusErrorList" parameterClass="Map" resultClass="Map"> 
        SELECT
             PAI.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,PAI.PRC_ALLOC_INTFC_PK     AS PRC_ALLOC_INTFC_PK
        FROM
            PRC_ALLOC_INTFC PAI
        WHERE
            PAI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND PAI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND PAI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND PAI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND PAI.ALLOC_INTFC_STS_CD     &lt;&gt; #error#
            <isNotNull property="svcMachMasterPk">
            AND NVL(PAI.SVC_MACH_MSTR_PK, 0)= NVL(#svcMachMasterPk#, 0)
            </isNotNull>
            AND PAI.PRC_ALLOC_INTFC_TP_CD   = #prcAllocIntfcTpCd#
            AND PAI.TOC_CD                  = #tocCd#
            AND PAI.EZCANCELFLAG            = '0'
        ORDER BY PAI.PRC_ALLOC_INTFC_PK
    </statement>

    <statement id="getDsContrAddlChrgStatusErrorList" parameterClass="Map" resultClass="Map">
        SELECT
             DACI.GLBL_CMPY_CD               AS GLBL_CMPY_CD
            ,DACI.DS_ADDL_CHRG_INTFC_PK      AS DS_ADDL_CHRG_INTFC_PK
        FROM
            DS_ADDL_CHRG_INTFC DACI
        WHERE
            DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DACI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DACI.ADD_CHRG_INTFC_STS_CD  &lt;&gt; #error#
            <isNotNull property="svcMachMasterFlg">
            AND NVL(DACI.SVC_MACH_MSTR_PK, 0)= NVL(#svcMachMasterPk#, 0)
            </isNotNull>
            AND DACI.CHRG_LVL_TP_CD          = #chagLvlTpCd#
            AND DACI.ADDL_CHRG_FLAT_DEAL_PRC_AMT= #addlChrgFlatDealPrcAmt#
            AND DACI.EZCANCELFLAG            = '0'
        ORDER BY DACI.DS_ADDL_CHRG_INTFC_PK
     </statement>

    <statement id="getDsContrIntfcForCommonStatusErrorList" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK      AS DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC DCI
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.DS_CONTR_INTFC_STS_CD   &lt;&gt; #error#
            <isNotNull property="svcMachMasterFlg">
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(#svcMachMasterPk#, 0)
            </isNotNull>
            <isNotNull property="bllgMtrLbCdFlg">
            AND NVL(DCI.BLLG_MTR_LB_CD, '0')= NVL(#bllgMtrLbCd#, '0')
            </isNotNull>
            <isNotNull property="xsMtrCopyQty">
            AND DCI.XS_MTR_COPY_QTY         = #xsMtrCopyQty#
            </isNotNull>
            <isNotNull property="chagLvlTpCd">
            AND DCI.CHRG_LVL_TP_CD          = #chagLvlTpCd#
            </isNotNull>
            <isNotNull property="addlChrgFlatDealPrcAmt">
            AND DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT= #addlChrgFlatDealPrcAmt#
            </isNotNull>
            AND DCI.EZCANCELFLAG            = '0'
        ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcForCommonBllgMtrStatusErrorList" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK      AS DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC DCI
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.DS_CONTR_INTFC_STS_CD   &lt;&gt; #error#
            <isNotNull property="svcMachMasterFlg">
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(#svcMachMasterPk#, 0)
            </isNotNull>
            AND DCI.BLLG_MTR_LB_CD          = #bllgMtrLbCd#
            <isNotNull property="xsMtrCopyQty">
            AND DCI.XS_MTR_COPY_QTY         = #xsMtrCopyQty#
            </isNotNull>
            <isNotNull property="chagLvlTpCd">
            AND DCI.CHRG_LVL_TP_CD          = #chagLvlTpCd#
            </isNotNull>
            <isNotNull property="addlChrgFlatDealPrcAmt">
            AND DCI.ADDL_CHRG_FLAT_DEAL_PRC_AMT= #addlChrgFlatDealPrcAmt#
            </isNotNull>
            AND DCI.EZCANCELFLAG            = '0'
        ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcForDsContrStatusErrorList" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK      AS DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC DCI
        WHERE
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.DS_CONTR_INTFC_STS_CD   &lt;&gt; #error#
            AND DCI.EZCANCELFLAG            = '0'
        ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsAddlChrgStatusErrorList" parameterClass="Map" resultClass="Map">
        SELECT
             DACI.GLBL_CMPY_CD             AS GLBL_CMPY_CD
            ,DACI.DS_ADDL_CHRG_INTFC_PK    AS DS_ADDL_CHRG_INTFC_PK
        FROM
            DS_ADDL_CHRG_INTFC  DACI
        WHERE
            DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DACI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DACI.ADD_CHRG_INTFC_STS_CD    &lt;&gt; #error#
            <isNotNull property="svcMachMasterFlg">
            AND NVL(DACI.SVC_MACH_MSTR_PK, 0)= NVL(#svcMachMasterPk#, 0)
            </isNotNull>
            AND DACI.EZCANCELFLAG            = '0'
        ORDER BY DACI.DS_ADDL_CHRG_INTFC_PK
    </statement>

    <statement id="getContrXsCopyIntfcStatusErrorList" parameterClass="Map" resultClass="Map">
        SELECT
             DXCI.GLBL_CMPY_CD             AS GLBL_CMPY_CD
            ,DXCI.DS_XS_COPY_INTFC_PK      AS DS_XS_COPY_INTFC_PK
        FROM
            DS_XS_COPY_INTFC DXCI
        WHERE
            DXCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DXCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DXCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DXCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DXCI.XS_COPY_INTFC_STS_CD    &lt;&gt; #error#
            <isNotNull property="svcMachMasterFlg">
            AND NVL(DXCI.SVC_MACH_MSTR_PK, 0)= NVL(#svcMachMasterPk#, 0)
            </isNotNull>
            AND DXCI.BLLG_MTR_LB_CD          = #bllgMtrLbCd#
            AND DXCI.XS_MTR_COPY_QTY         = #xsMtrCopyQty#
            AND DXCI.EZCANCELFLAG            = '0'
        ORDER BY DXCI.DS_XS_COPY_INTFC_PK
    </statement>
    
    <statement id="getDsActlCntIntfcStatusErrorList" parameterClass="Map" resultClass="Map">
        SELECT
             DACI.GLBL_CMPY_CD             AS GLBL_CMPY_CD
            ,DACI.DS_ACTL_CNT_INTFC_PK     AS DS_ACTL_CNT_INTFC_PK
        FROM
            DS_ACTL_CNT_INTFC DACI
        WHERE
            DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DACI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DACI.ACTL_CNT_INTFC_STS_CD   &lt;&gt; #error#
            AND NVL(DACI.SVC_MACH_MSTR_PK, 0)= NVL(#svcMachMasterPk#, 0)
            AND DACI.BLLG_MTR_LB_CD          = #bllgMtrLbCd#
            <!-- TODO: AND DACI.PHYS_MTR_LB_CD          = #physMtrLbCd# -->
            AND DACI.EZCANCELFLAG            = '0'
        ORDER BY DACI.DS_ACTL_CNT_INTFC_PK
    </statement>

    <statement id="getAdditionalChargeQaDsContrIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT  AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.ADDL_CHRG_TP_CD         IS NOT NULL
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_PK                 = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM = #dsContrVldErrPkNm#
            AND DCI.EZCANCELFLAG               = '0'
            AND DC.EZCANCELFLAG                = '0'
            AND DCVRW.EZCANCELFLAG             = '0'
          ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getAdditionalChargeQa" parameterClass="Map" resultClass="Map">
        SELECT
             DACI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DACI.DS_ADDL_CHRG_INTFC_PK        AS DS_ADDL_CHRG_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT   AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             DS_ADDL_CHRG_INTFC       DACI
            ,(SELECT
                  DCI_M.*
              FROM
                  DS_CONTR_INTFC DCI_M
              WHERE
                      DCI_M.GLBL_CMPY_CD            = #glblCmpyCd#
                  AND DCI_M.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                  AND DCI_M.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                  AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
                  AND DCI_M.DS_CONTR_INTFC_PK = (SELECT
                                                     MIN(A.DS_CONTR_INTFC_PK)
                                                 FROM
                                                     DS_CONTR_INTFC A
                                                 WHERE
                                                     DCI_M.GLBL_CMPY_CD                = A.GLBL_CMPY_CD
                                                     AND DCI_M.DS_CONTR_SRC_REF_NUM    = A.DS_CONTR_SRC_REF_NUM
                                                     AND DCI_M.CONTR_INTFC_SRC_TP_CD   = A.CONTR_INTFC_SRC_TP_CD
                                                     AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = A.DS_CONTR_INTFC_BAT_NUM
                                                     AND A.EZCANCELFLAG                = '0'
                                                )
                  AND DCI_M.EZCANCELFLAG            = '0'
            
            )                         DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_ADDL_CHRG_INTFC -->
            DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DACI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR_INTFC -->
            AND DCI.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = DCI.DS_CONTR_SRC_REF_NUM
            AND DACI.CONTR_INTFC_SRC_TP_CD   = DCI.CONTR_INTFC_SRC_TP_CD
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = DCI.DS_CONTR_INTFC_BAT_NUM
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_PK                 = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM = #dsContrVldErrPkNm#
            AND DACI.EZCANCELFLAG              = '0'
            AND DCI.EZCANCELFLAG               = '0'
            AND DC.EZCANCELFLAG                = '0'
            AND DCVRW.EZCANCELFLAG             = '0'
          ORDER BY DACI.DS_ADDL_CHRG_INTFC_PK
    </statement>

    <statement id="getDsActlCntIntfcQaDsActlCntrIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DACI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DACI.DS_ACTL_CNT_INTFC_PK         AS DS_ACTL_CNT_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT   AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             DS_ACTL_CNT_INTFC        DACI
            ,(SELECT
                  DCI_M.*
              FROM
                  DS_CONTR_INTFC DCI_M
              WHERE
                      DCI_M.GLBL_CMPY_CD            = #glblCmpyCd#
                  AND DCI_M.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                  AND DCI_M.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                  AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
                  AND DCI_M.DS_CONTR_INTFC_PK = (SELECT
                                                     MIN(A.DS_CONTR_INTFC_PK)
                                                 FROM
                                                     DS_CONTR_INTFC A
                                                 WHERE
                                                     DCI_M.GLBL_CMPY_CD                = A.GLBL_CMPY_CD
                                                     AND DCI_M.DS_CONTR_SRC_REF_NUM    = A.DS_CONTR_SRC_REF_NUM
                                                     AND DCI_M.CONTR_INTFC_SRC_TP_CD   = A.CONTR_INTFC_SRC_TP_CD
                                                     AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = A.DS_CONTR_INTFC_BAT_NUM
                                                     AND NVL(DCI_M.SVC_MACH_MSTR_PK, 0)= NVL(A.SVC_MACH_MSTR_PK, 0)
                                                     AND A.EZCANCELFLAG                = '0'
                                                )
                  AND DCI_M.EZCANCELFLAG            = '0'
            
            )                         DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_ADDL_CHRG_INTFC -->
            DACI.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM      = #dsContrSrcRefNum#
            AND DACI.CONTR_INTFC_SRC_TP_CD     = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_INTFC_BAT_NUM    = #dsContrIntfcBatNum#
            <!-- DS_CONTR_INTFC -->
            AND DCI.GLBL_CMPY_CD               = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM      = DCI.DS_CONTR_SRC_REF_NUM
            AND DACI.CONTR_INTFC_SRC_TP_CD     = DCI.CONTR_INTFC_SRC_TP_CD
            AND DACI.DS_CONTR_INTFC_BAT_NUM    = DCI.DS_CONTR_INTFC_BAT_NUM
            AND NVL(DACI.SVC_MACH_MSTR_PK, 0)  = NVL(DCI.SVC_MACH_MSTR_PK, 0)
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DC.DS_CONTR_NUM                = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_PK                 = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM = #dsContrVldErrPkNm#
            AND DACI.EZCANCELFLAG              = '0'
            AND DCI.EZCANCELFLAG               = '0'
            AND DC.EZCANCELFLAG                = '0'
            AND DCVRW.EZCANCELFLAG             = '0'
          ORDER BY DACI.DS_ACTL_CNT_INTFC_PK
    </statement>

    <statement id="getDsActlCntIntfcQaSvcPhysMtrPk" parameterClass="Map" resultClass="Map">
        SELECT
             DACI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DACI.DS_ACTL_CNT_INTFC_PK         AS DS_ACTL_CNT_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT   AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             DS_ACTL_CNT_INTFC        DACI
            ,DS_CONTR_INTFC           DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_ADDL_CHRG_INTFC -->
            DACI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DACI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR_INTFC -->
            AND DCI.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DACI.DS_CONTR_SRC_REF_NUM    = DCI.DS_CONTR_SRC_REF_NUM
            AND DACI.CONTR_INTFC_SRC_TP_CD   = DCI.CONTR_INTFC_SRC_TP_CD
            AND DACI.DS_CONTR_INTFC_BAT_NUM  = DCI.DS_CONTR_INTFC_BAT_NUM
            AND DACI.SVC_MACH_MSTR_PK        = DCI.SVC_MACH_MSTR_PK
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DC.DS_CONTR_PK                  = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM  = #dsContrVldErrPkNm#
            AND DACI.EZCANCELFLAG               = '0'
            AND DCI.EZCANCELFLAG                = '0'
            AND DC.EZCANCELFLAG                 = '0'
            AND DCVRW.EZCANCELFLAG              = '0'
          ORDER BY DACI.DS_ACTL_CNT_INTFC_PK
    </statement>

    <statement id="getDsXsCopyIntfcQaDsContrIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT  AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.XS_CHRG_TP_CD          IS NOT NULL
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_PK                 = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM = #dsContrVldErrPkNm#
            AND DCI.EZCANCELFLAG               = '0'
            AND DC.EZCANCELFLAG                = '0'
            AND DCVRW.EZCANCELFLAG             = '0'
          ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsXsCopyIntfcQaDsXpCopyIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DXCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DXCI.DS_XS_COPY_INTFC_PK          AS DS_XS_COPY_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT   AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             DS_XS_COPY_INTFC         DXCI
            ,(SELECT
                  DCI_M.*
              FROM
                  DS_CONTR_INTFC DCI_M
              WHERE
                      DCI_M.GLBL_CMPY_CD            = #glblCmpyCd#
                  AND DCI_M.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                  AND DCI_M.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                  AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
                  AND DCI_M.DS_CONTR_INTFC_PK = (SELECT
                                                     MIN(A.DS_CONTR_INTFC_PK)
                                                 FROM
                                                     DS_CONTR_INTFC A
                                                 WHERE
                                                     DCI_M.GLBL_CMPY_CD                = A.GLBL_CMPY_CD
                                                     AND DCI_M.DS_CONTR_SRC_REF_NUM    = A.DS_CONTR_SRC_REF_NUM
                                                     AND DCI_M.CONTR_INTFC_SRC_TP_CD   = A.CONTR_INTFC_SRC_TP_CD
                                                     AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = A.DS_CONTR_INTFC_BAT_NUM
                                                     AND NVL(DCI_M.SVC_MACH_MSTR_PK, 0)= NVL(A.SVC_MACH_MSTR_PK, 0)
                                                     AND A.EZCANCELFLAG                = '0'
                                                )
                  AND DCI_M.EZCANCELFLAG            = '0'
            
            )                         DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_XS_COPY_INTFC -->
            DXCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DXCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DXCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DXCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR_INTFC -->
            AND DCI.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DXCI.DS_CONTR_SRC_REF_NUM    = DCI.DS_CONTR_SRC_REF_NUM
            AND DXCI.CONTR_INTFC_SRC_TP_CD   = DCI.CONTR_INTFC_SRC_TP_CD
            AND DXCI.DS_CONTR_INTFC_BAT_NUM  = DCI.DS_CONTR_INTFC_BAT_NUM
            AND NVL(DXCI.SVC_MACH_MSTR_PK, 0)= NVL(DCI.SVC_MACH_MSTR_PK, 0)
            AND DXCI.BLLG_MTR_LB_CD          = DCI.BLLG_MTR_LB_CD
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_PK                 = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM = #dsContrVldErrPkNm#
            AND DXCI.EZCANCELFLAG              = '0'
            AND DCI.EZCANCELFLAG               = '0'
            AND DC.EZCANCELFLAG                = '0'
            AND DCVRW.EZCANCELFLAG             = '0'
          ORDER BY DXCI.DS_XS_COPY_INTFC_PK
    </statement>

    <statement id="getPrcAllocIntfcQaPrcAllocIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             PAI.GLBL_CMPY_CD                  AS GLBL_CMPY_CD
            ,PAI.PRC_ALLOC_INTFC_PK            AS PRC_ALLOC_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT   AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             PRC_ALLOC_INTFC          PAI
            ,(SELECT
                  DCI_M.*
              FROM
                  DS_CONTR_INTFC DCI_M
              WHERE
                      DCI_M.GLBL_CMPY_CD            = #glblCmpyCd#
                  AND DCI_M.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                  AND DCI_M.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                  AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
                  AND DCI_M.DS_CONTR_INTFC_PK = (SELECT
                                                     MIN(A.DS_CONTR_INTFC_PK)
                                                 FROM
                                                     DS_CONTR_INTFC A
                                                 WHERE
                                                     DCI_M.GLBL_CMPY_CD                = A.GLBL_CMPY_CD
                                                     AND DCI_M.DS_CONTR_SRC_REF_NUM    = A.DS_CONTR_SRC_REF_NUM
                                                     AND DCI_M.CONTR_INTFC_SRC_TP_CD   = A.CONTR_INTFC_SRC_TP_CD
                                                     AND DCI_M.DS_CONTR_INTFC_BAT_NUM  = A.DS_CONTR_INTFC_BAT_NUM
                                                     AND A.EZCANCELFLAG                = '0'
                                                )
                  AND DCI_M.EZCANCELFLAG            = '0'
            
            )                         DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_XS_COPY_INTFC -->
            PAI.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND PAI.DS_CONTR_SRC_REF_NUM     = #dsContrSrcRefNum#
            AND PAI.CONTR_INTFC_SRC_TP_CD    = #dsContrSrcTpCd#
            AND PAI.DS_CONTR_INTFC_BAT_NUM   = #dsContrIntfcBatNum#
            <!-- DS_CONTR_INTFC -->
            AND DCI.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PAI.DS_CONTR_SRC_REF_NUM     = DCI.DS_CONTR_SRC_REF_NUM
            AND PAI.CONTR_INTFC_SRC_TP_CD    = DCI.CONTR_INTFC_SRC_TP_CD
            AND PAI.DS_CONTR_INTFC_BAT_NUM   = DCI.DS_CONTR_INTFC_BAT_NUM
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM             = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_PK                 = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM = #dsContrVldErrPkNm#
            AND PAI.EZCANCELFLAG               = '0'
            AND DCI.EZCANCELFLAG               = '0'
            AND DC.EZCANCELFLAG                = '0'
            AND DCVRW.EZCANCELFLAG             = '0'
          ORDER BY PAI.PRC_ALLOC_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcQa" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT  AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_PK                 = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM = #dsContrVldErrPkNm#
            AND DCI.EZCANCELFLAG               = '0'
            AND DC.EZCANCELFLAG                = '0'
            AND DCVRW.EZCANCELFLAG             = '0'
          ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcQaOthers" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
            ,DCVRW.DS_CONTR_VLD_RSLT_MSG_TXT  AS DS_CONTR_VLD_RSLT_MSG_TXT
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM             = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DC.DS_CONTR_PK               = DCVRW.DS_CONTR_PK
            AND DCVRW.DS_CONTR_VLD_ERR_TRX_NUM NOT IN
                            <iterate property="dsContrVldErrPkNm" var="dsContrVldErrPkNm[]"  open="(" close=" )" conjunction=",">
                                #dsContrVldErrPkNm[]#
                            </iterate>
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG             = '0'
            AND DCVRW.EZCANCELFLAG          = '0'
          ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcQaDsContrIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
        FROM
             DS_CONTR_INTFC           DCI
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM      = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD     = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM    = #dsContrIntfcBatNum#
            AND EXISTS (SELECT
                            'OK'
                        FROM
                            DS_CONTR_INTFC    DCIO
                        WHERE
                                DCIO.GLBL_CMPY_CD             = #glblCmpyCd#
                            AND DCI.DS_CONTR_SRC_REF_NUM      = DCIO.DS_CONTR_SRC_REF_NUM
                            AND DCI.CONTR_INTFC_SRC_TP_CD     = DCIO.CONTR_INTFC_SRC_TP_CD
                            AND DCI.DS_CONTR_INTFC_BAT_NUM    = DCIO.DS_CONTR_INTFC_BAT_NUM
                            AND DCIO.DS_CONTR_INTFC_STS_CD    = #error#
                            AND DCIO.EZCANCELFLAG             = '0'
                        )
            AND DCI.EZCANCELFLAG              = '0'
          ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcQaDsActlCntIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
        FROM
             DS_CONTR_INTFC           DCI
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM      = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD     = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM    = #dsContrIntfcBatNum#
            AND EXISTS (SELECT
                            'OK'
                        FROM
                            DS_ACTL_CNT_INTFC    DACI
                        WHERE
                                DACI.GLBL_CMPY_CD             = #glblCmpyCd#
                            AND DCI.DS_CONTR_SRC_REF_NUM      = DACI.DS_CONTR_SRC_REF_NUM
                            AND DCI.CONTR_INTFC_SRC_TP_CD     = DACI.CONTR_INTFC_SRC_TP_CD
                            AND DCI.DS_CONTR_INTFC_BAT_NUM    = DACI.DS_CONTR_INTFC_BAT_NUM
                            AND DACI.ACTL_CNT_INTFC_STS_CD    = #error#
                            AND DACI.EZCANCELFLAG             = '0'
                        )
            AND DCI.EZCANCELFLAG              = '0'
          ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcQaDsXsCoppIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
        FROM
             DS_CONTR_INTFC           DCI
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM      = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD     = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM    = #dsContrIntfcBatNum#
            AND EXISTS (SELECT
                            'OK'
                        FROM
                            DS_XS_COPY_INTFC    DXCI
                        WHERE
                                DXCI.GLBL_CMPY_CD             = #glblCmpyCd#
                            AND DCI.DS_CONTR_SRC_REF_NUM      = DXCI.DS_CONTR_SRC_REF_NUM
                            AND DCI.CONTR_INTFC_SRC_TP_CD     = DXCI.CONTR_INTFC_SRC_TP_CD
                            AND DCI.DS_CONTR_INTFC_BAT_NUM    = DXCI.DS_CONTR_INTFC_BAT_NUM
                            AND DXCI.XS_COPY_INTFC_STS_CD     = #error#
                            AND DXCI.EZCANCELFLAG             = '0'
                        )
            AND DCI.EZCANCELFLAG              = '0'
          ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcQaDsAddlChrgIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
        FROM
             DS_CONTR_INTFC           DCI
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM      = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD     = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM    = #dsContrIntfcBatNum#
            AND EXISTS (SELECT
                            'OK'
                        FROM
                            DS_ADDL_CHRG_INTFC    DACI
                        WHERE
                                DACI.GLBL_CMPY_CD             = #glblCmpyCd#
                            AND DCI.DS_CONTR_SRC_REF_NUM      = DACI.DS_CONTR_SRC_REF_NUM
                            AND DCI.CONTR_INTFC_SRC_TP_CD     = DACI.CONTR_INTFC_SRC_TP_CD
                            AND DCI.DS_CONTR_INTFC_BAT_NUM    = DACI.DS_CONTR_INTFC_BAT_NUM
                            AND DACI.ADD_CHRG_INTFC_STS_CD    = #error#
                            AND DACI.EZCANCELFLAG             = '0'
                        )
            AND DCI.EZCANCELFLAG              = '0'
          ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrIntfcQaPrcAllocIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD                 AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK            AS DS_CONTR_INTFC_PK
        FROM
             DS_CONTR_INTFC           DCI
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM      = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD     = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM    = #dsContrIntfcBatNum#
            AND EXISTS (SELECT
                            'OK'
                        FROM
                            PRC_ALLOC_INTFC    PAI
                        WHERE
                                PAI.GLBL_CMPY_CD              = #glblCmpyCd#
                            AND DCI.DS_CONTR_SRC_REF_NUM      = PAI.DS_CONTR_SRC_REF_NUM
                            AND DCI.CONTR_INTFC_SRC_TP_CD     = PAI.CONTR_INTFC_SRC_TP_CD
                            AND DCI.DS_CONTR_INTFC_BAT_NUM    = PAI.DS_CONTR_INTFC_BAT_NUM
                            AND PAI.ALLOC_INTFC_STS_CD        = #error#
                            AND PAI.EZCANCELFLAG              = '0'
                        )
           ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getDsContrListForNSZC0520" parameterClass="Map" resultClass="Map">
        SELECT
             DSC.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,DSC.DS_SUB_CONTR_PK        AS DS_SUB_CONTR_PK
            ,DSC.DS_CONTR_DTL_PK        AS DS_CONTR_DTL_PK
            ,DSC.VND_CD                 AS VND_CD
            ,DSC.TECH_TOC_CD            AS TECH_CD
            ,DSC.DS_ACCT_NUM            AS DS_ACCT_NUM
            ,DSC.CONTR_TRMN_FLG         AS CONTR_TRMN_FLG
            ,DSC.EFF_FROM_DT            AS EFF_FROM_DT
            ,DSC.EFF_THRU_DT            AS EFF_THRU_DT
            ,DSC.BASE_PRC_DEAL_AMT      AS BASE_PRC_DEAL_AMT
            ,DSC.ADMIN_PRC_DEAL_AMT     AS ADMIN_PRC_DEAL_AMT
            ,DSC.PREPD_MAINT_FLG        AS PREPD_MAINT_FLG
            ,DSC.BW_MTR_ALWNC_CNT       AS BW_MTR_ALWNC_CNT
            ,DSC.COLOR_MTR_ALWNC_CNT    AS COLOR_MTR_ALWNC_CNT
            ,DSC.BW_MTR_PRC_AMT_RATE    AS BW_MTR_PRC_AMT_RATE
            ,DSC.COLOR_MTR_PRC_AMT_RATE AS COLOR_MTR_PRC_AMT_RATE
            ,DSC.SPLY_INCL_FLG          AS SPLY_INCL_FLG
            ,DSC.BLLG_CYCLE_CD          AS BLLG_CYCLE_CD
            ,DSC.DLR_FLEET_FLG          AS DLR_FLEET_FLG
            ,DSC.DLR_FLEET_NUM          AS DLR_FLEET_NUM
            ,DSC.ATT_FILE_NM            AS ATT_FILE_NM
        FROM
             DS_CONTR        DC
            ,DS_CONTR_DTL    DCD
            ,DS_SUB_CONTR    DSC
            ,SVC_MACH_MSTR   SMM
        WHERE
            <!-- DS_CONTR -->
                DC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_NUM             = #dsContrNum#
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK
            <!-- DS_SUB_CONTR -->
            AND DSC.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCD.DS_CONTR_DTL_PK         = DSC.DS_CONTR_DTL_PK
            <!-- SVC_MACH_MSTR -->
            AND SMM.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCD.SVC_MACH_MSTR_PK        = SMM.SVC_MACH_MSTR_PK
            AND SMM.SER_NUM                 = #serNum#
            AND DC.EZCANCELFLAG             = '0'
            AND DCD.EZCANCELFLAG            = '0'
            AND DSC.EZCANCELFLAG            = '0'
            AND SMM.EZCANCELFLAG            = '0'
        UNION ALL
        SELECT
             DSC.GLBL_CMPY_CD           AS GLBL_CMPY_CD
            ,DSC.DS_SUB_CONTR_PK        AS DS_SUB_CONTR_PK
            ,DSC.DS_CONTR_DTL_PK        AS DS_CONTR_DTL_PK
            ,DSC.VND_CD                 AS VND_CD
            ,DSC.TECH_TOC_CD            AS TECH_CD
            ,DSC.DS_ACCT_NUM            AS DS_ACCT_NUM
            ,DSC.CONTR_TRMN_FLG         AS CONTR_TRMN_FLG
            ,DSC.EFF_FROM_DT            AS EFF_FROM_DT
            ,DSC.EFF_THRU_DT            AS EFF_THRU_DT
            ,DSC.BASE_PRC_DEAL_AMT      AS BASE_PRC_DEAL_AMT
            ,DSC.ADMIN_PRC_DEAL_AMT     AS ADMIN_PRC_DEAL_AMT
            ,DSC.PREPD_MAINT_FLG        AS PREPD_MAINT_FLG
            ,DSC.BW_MTR_ALWNC_CNT       AS BW_MTR_ALWNC_CNT
            ,DSC.COLOR_MTR_ALWNC_CNT    AS COLOR_MTR_ALWNC_CNT
            ,DSC.BW_MTR_PRC_AMT_RATE    AS BW_MTR_PRC_AMT_RATE
            ,DSC.COLOR_MTR_PRC_AMT_RATE AS COLOR_MTR_PRC_AMT_RATE
            ,DSC.SPLY_INCL_FLG          AS SPLY_INCL_FLG
            ,DSC.BLLG_CYCLE_CD          AS BLLG_CYCLE_CD
            ,DSC.DLR_FLEET_FLG          AS DLR_FLEET_FLG
            ,DSC.DLR_FLEET_NUM          AS DLR_FLEET_NUM
            ,DSC.ATT_FILE_NM            AS ATT_FILE_NM
        FROM
             DS_CONTR        DC
            ,DS_CONTR_DTL    DCD
            ,DS_SUB_CONTR    DSC
        WHERE
            <!-- DS_CONTR -->
                DC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND DC.DS_CONTR_NUM             = #dsContrNum#
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK
            AND DCD.SVC_MACH_MSTR_PK        IS NULL
            <!-- DS_SUB_CONTR -->
            AND DSC.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCD.DS_CONTR_DTL_PK         = DSC.DS_CONTR_DTL_PK
            AND DC.EZCANCELFLAG             = '0'
            AND DCD.EZCANCELFLAG            = '0'
            AND DSC.EZCANCELFLAG            = '0'
    </statement>

    <statement id="getDsContrListForNSZC0100" parameterClass="Map" resultClass="Map">
        <!-- START 2017/06/26 K.Kojima [QC#18532, ADD] -->
        SELECT
            SVC_MACH_MSTR_PK
            ,DS_CONTR_DTL_PK
            ,CONTR_EFF_FROM_DT
            ,MTR_READ_DT
            ,START_MTR_CNT
            ,SVC_PHYS_MTR_PK
            ,VLD_MTR_FLG
        FROM
            (
        <!-- END 2017/06/26 K.Kojima [QC#18532, ADD] -->
        SELECT
            SVC_MACH_MSTR_PK
            ,DS_CONTR_DTL_PK
            ,CONTR_EFF_FROM_DT
            ,MTR_READ_DT
            ,START_MTR_CNT
            ,SVC_PHYS_MTR_PK
            ,VLD_MTR_FLG
        FROM
        (
            SELECT
                 DCD.SVC_MACH_MSTR_PK                 AS SVC_MACH_MSTR_PK
                ,DCD.DS_CONTR_DTL_PK                  AS DS_CONTR_DTL_PK
                ,DCD.CONTR_EFF_FROM_DT                AS CONTR_EFF_FROM_DT
<!-- START 2017/09/21 K.Kim [QC#21226, MOD] -->
                <!-- ,TO_CHAR(TO_DATE(NVL(DCD.CONTR_EFF_FROM_DT, #maxDate#), #format#) - 1, #format#) -->
                <!--                                       AS MTR_READ_DT -->
                ,TO_CHAR(TO_DATE(NVL(DCD.CONTR_EFF_FROM_DT, #maxDate#), #format#), #format#)
                                                      AS MTR_READ_DT
<!-- END 2017/09/21 K.Kim [QC#21226, MOD] -->
                ,CASE WHEN DCI.START_MTR_CNT IS NOT NULL THEN DCI.START_MTR_CNT
                      WHEN READ.READ_MTR_CNT IS NOT NULL THEN READ.READ_MTR_CNT
                      ELSE SRM.START_MTR_CNT END      AS START_MTR_CNT
                ,SPM.SVC_PHYS_MTR_PK                  AS SVC_PHYS_MTR_PK
                ,ROW_NUMBER() OVER (PARTITION BY SPM.SVC_PHYS_MTR_PK ORDER BY READ.MTR_READ_DT DESC,READ.SVC_PHYS_MTR_READ_GRP_SQ DESC) AS ROW_NUM
                ,READ.VLD_MTR_FLG                     AS VLD_MTR_FLG
            FROM
                 DS_CONTR_INTFC          DCI
                ,DS_CONTR                DC
                ,DS_CONTR_DTL            DCD
                ,SVC_PHYS_MTR            SPM
                ,START_READ_MAP          SRM
                ,SVC_PHYS_MTR_READ       READ
            WHERE
                <!-- DS_CONTR_INTFC -->
                DCI.GLBL_CMPY_CD                = #glblCmpyCd#
                AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
                AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
                <!-- DS_CONTR -->
                AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
                AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
                <!-- DS_CONTR_DTL -->
                AND DCD.GLBL_CMPY_CD            = #glblCmpyCd#
                AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK
                AND DCI.SVC_MACH_MSTR_PK        = DCD.SVC_MACH_MSTR_PK
                <!-- SVC_PHYS_MTR -->
                AND SPM.GLBL_CMPY_CD            = #glblCmpyCd#
                AND DCI.SVC_MACH_MSTR_PK        = SPM.SVC_MACH_MSTR_PK
                AND SPM.ACTV_FLG                = 'Y'
                <!-- START_READ_MAP -->
                AND SRM.GLBL_CMPY_CD(+)         = #glblCmpyCd#
                AND SPM.MDL_MTR_LB_CD           = SRM.MTR_LB_CD(+)
<!-- add start 2017/09/19 QC#19775 -->
                AND SPM.MTR_GRP_PK              = SRM.MTR_GRP_PK
<!-- add end 2017/09/19 QC#19775 -->
                <!-- SVC_PHYS_MTR_READ -->
                AND READ.GLBL_CMPY_CD(+)        = #glblCmpyCd#
                AND SPM.SVC_PHYS_MTR_PK         = READ.SVC_PHYS_MTR_PK(+)
                AND READ.VLD_MTR_FLG(+)         = 'Y'
                AND DCI.EZCANCELFLAG            = '0'
                AND DC.EZCANCELFLAG             = '0'
                AND DCD.EZCANCELFLAG            = '0'
                AND SPM.EZCANCELFLAG            = '0'
                AND SRM.EZCANCELFLAG(+)         = '0'
                AND READ.EZCANCELFLAG(+)        = '0'
                AND NOT EXISTS
                    (SELECT 1 FROM
                        SVC_PHYS_MTR_READ       SPMR
                    WHERE
                        SPMR.GLBL_CMPY_CD           = #glblCmpyCd#
                        AND SPM.SVC_PHYS_MTR_PK     = SPMR.SVC_PHYS_MTR_PK
                        AND SPMR.DS_CONTR_DTL_PK    = DCD.DS_CONTR_DTL_PK
                        AND SPMR.EZCANCELFLAG       = '0')

        )
        WHERE
            ROW_NUM = 1
        <!-- START 2017/06/26 K.Kojima [QC#18532, ADD] -->
            )
        WHERE
            START_MTR_CNT IS NOT NULL
        <!-- END 2017/06/26 K.Kojima [QC#18532, ADD] -->
        ORDER BY
            DS_CONTR_DTL_PK
    </statement>

    <statement id="getContractPriceAllocationHeader" parameterClass="Map" resultClass="Map">
        SELECT
             DC.DS_CONTR_PK              AS DS_CONTR_PK
            ,''                          AS DS_CONTR_DTL_PK
            ,PAI.PRC_ALLOC_INTFC_TP_CD   AS PRC_ALLOC_INTFC_TP_CD
            ,PAI.SVC_MACH_MSTR_PK        AS SVC_MACH_MSTR_PK
            ,DCBA.DS_CONTR_BR_ALLOC_PK   AS DS_CONTR_BR_ALLOC_PK
            ,DCSA.DS_CONTR_SEG_ALLOC_PK  AS DS_CONTR_SEG_ALLOC_PK
            ,DCI.MDSE_CD                 AS MDSE_CD
            ,DCI.DS_ACCT_NUM             AS DS_ACCT_NUM
            ,DCI.TOC_CD                  AS TOC_CD
            ,DCI.SVC_PGM_MDSE_CD         AS SVC_PGM_MDSE_CD
            ,DCI.DS_CONTR_CATG_CD        AS DS_CONTR_CATG_CD
            ,DCI.SVC_LINE_BIZ_CD         AS SVC_LINE_BIZ_CD
        FROM
             DS_CONTR_INTFC          DCI
            ,PRC_ALLOC_INTFC         PAI
            ,DS_CONTR                DC
            ,DS_CONTR_PRC_ALLOC      DCPA
            ,DS_CONTR_BR_ALLOC       DCBA
            ,DS_CONTR_SEG_ALLOC      DCSA
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD    IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- PRC_ALLOC_INTFC -->
            AND PAI.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = PAI.DS_CONTR_SRC_REF_NUM
            AND DCI.CONTR_INTFC_SRC_TP_CD   = PAI.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = PAI.DS_CONTR_INTFC_BAT_NUM
            AND PAI.PRC_ALLOC_INTFC_TP_CD   = #contract#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_PRC_ALLOC -->
            AND DCPA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCPA.DS_CONTR_PK(+)
            AND DCPA.DS_CONTR_DTL_PK(+)     IS NULL
            <!-- DS_CONTR_BR_ALLOC -->
            AND DCBA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCBA.DS_CONTR_PK(+)
            AND DCBA.DS_CONTR_DTL_PK(+)     IS NULL
            <!-- DS_CONTR_SEG_ALLOC -->
            AND DCSA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCSA.DS_CONTR_PK(+)
            AND DCSA.DS_CONTR_DTL_PK(+)     IS NULL
            AND DCI.EZCANCELFLAG            = '0'
            AND PAI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCPA.EZCANCELFLAG(+)        = '0'
            AND DCBA.EZCANCELFLAG(+)        = '0'
            AND DCSA.EZCANCELFLAG(+)        = '0'
    </statement>

    <statement id="getContractPriceAllocationDetailMachine" parameterClass="Map" resultClass="Map">
        SELECT
             DC.DS_CONTR_PK              AS DS_CONTR_PK
            ,DCD.DS_CONTR_DTL_PK         AS DS_CONTR_DTL_PK
            ,PAI.PRC_ALLOC_INTFC_TP_CD   AS PRC_ALLOC_INTFC_TP_CD
            ,PAI.SVC_MACH_MSTR_PK        AS SVC_MACH_MSTR_PK
            ,DCBA.DS_CONTR_BR_ALLOC_PK   AS DS_CONTR_BR_ALLOC_PK
            ,DCSA.DS_CONTR_SEG_ALLOC_PK  AS DS_CONTR_SEG_ALLOC_PK
            ,DCI.MDSE_CD                 AS MDSE_CD
            ,DCI.DS_ACCT_NUM             AS DS_ACCT_NUM
            ,DCI.TOC_CD                  AS TOC_CD
            ,DCI.SVC_PGM_MDSE_CD         AS SVC_PGM_MDSE_CD
            ,DCI.DS_CONTR_CATG_CD        AS DS_CONTR_CATG_CD
            ,DCI.SVC_LINE_BIZ_CD         AS SVC_LINE_BIZ_CD
        FROM
             DS_CONTR_INTFC          DCI
            ,PRC_ALLOC_INTFC         PAI
            ,DS_CONTR                DC
            ,DS_CONTR_DTL            DCD
            ,DS_CONTR_PRC_ALLOC      DCPA
            ,DS_CONTR_BR_ALLOC       DCBA
            ,DS_CONTR_SEG_ALLOC      DCSA
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD    IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- PRC_ALLOC_INTFC -->
            AND PAI.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = PAI.DS_CONTR_SRC_REF_NUM
            AND DCI.CONTR_INTFC_SRC_TP_CD   = PAI.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = PAI.DS_CONTR_INTFC_BAT_NUM
            AND PAI.PRC_ALLOC_INTFC_TP_CD   = #prcAllocIntfcTpCd#
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(PAI.SVC_MACH_MSTR_PK, 0)
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_CONTR_PRC_ALLOC -->
            AND DCPA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCPA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCPA.DS_CONTR_DTL_PK(+)
            <!-- DS_CONTR_BR_ALLOC -->
            AND DCBA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCBA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCBA.DS_CONTR_DTL_PK(+)
            <!-- DS_CONTR_SEG_ALLOC -->
            AND DCSA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCSA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCSA.DS_CONTR_DTL_PK(+)
            AND DCI.EZCANCELFLAG            = '0'
            AND PAI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND DCPA.EZCANCELFLAG(+)        = '0'
            AND DCBA.EZCANCELFLAG(+)        = '0'
    </statement>

    <statement id="getContractPriceAllocationDetailBaseAndUsage" parameterClass="Map" resultClass="Map">
        SELECT
             DC.DS_CONTR_PK              AS DS_CONTR_PK
            ,DCD.DS_CONTR_DTL_PK         AS DS_CONTR_DTL_PK
            ,PAI.PRC_ALLOC_INTFC_TP_CD   AS PRC_ALLOC_INTFC_TP_CD
            ,PAI.SVC_MACH_MSTR_PK        AS SVC_MACH_MSTR_PK
            ,DCBA.DS_CONTR_BR_ALLOC_PK   AS DS_CONTR_BR_ALLOC_PK
            ,DCSA.DS_CONTR_SEG_ALLOC_PK  AS DS_CONTR_SEG_ALLOC_PK
            ,DCI.MDSE_CD                 AS MDSE_CD
            ,DCI.DS_ACCT_NUM             AS DS_ACCT_NUM
            ,DCI.TOC_CD                  AS TOC_CD
            ,DCI.SVC_PGM_MDSE_CD         AS SVC_PGM_MDSE_CD
            ,DCI.DS_CONTR_CATG_CD        AS DS_CONTR_CATG_CD
            ,DCI.SVC_LINE_BIZ_CD         AS SVC_LINE_BIZ_CD
        FROM
             DS_CONTR_INTFC          DCI
            ,PRC_ALLOC_INTFC         PAI
            ,DS_CONTR                DC
            ,DS_CONTR_DTL            DCD
            ,DS_CONTR_PRC_ALLOC      DCPA
            ,DS_CONTR_BR_ALLOC       DCBA
            ,DS_CONTR_SEG_ALLOC      DCSA
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD    IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- PRC_ALLOC_INTFC -->
            AND PAI.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = PAI.DS_CONTR_SRC_REF_NUM
            AND DCI.CONTR_INTFC_SRC_TP_CD   = PAI.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = PAI.DS_CONTR_INTFC_BAT_NUM
            AND PAI.PRC_ALLOC_INTFC_TP_CD   = #prcAllocIntfcTpCd#
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(PAI.SVC_MACH_MSTR_PK, 0)
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_CONTR_PRC_ALLOC -->
            AND DCPA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCPA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCPA.DS_CONTR_DTL_PK(+)
            AND DCPA.SVC_INV_CHRG_TP_CD(+)  = #bc#
            <!-- DS_CONTR_BR_ALLOC -->
            AND DCBA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCBA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCBA.DS_CONTR_DTL_PK(+)
            AND DCBA.SVC_INV_CHRG_TP_CD(+)  = #bc#
            <!-- DS_CONTR_SEG_ALLOC -->
            AND DCSA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCSA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCSA.DS_CONTR_DTL_PK(+)
            AND DCSA.SVC_INV_CHRG_TP_CD(+)  = #bc#
            AND DCI.EZCANCELFLAG            = '0'
            AND PAI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND DCPA.EZCANCELFLAG(+)        = '0'
            AND DCBA.EZCANCELFLAG(+)        = '0'
        UNION ALL
        SELECT
             DC.DS_CONTR_PK              AS DS_CONTR_PK
            ,DCD.DS_CONTR_DTL_PK         AS DS_CONTR_DTL_PK
            ,PAI.PRC_ALLOC_INTFC_TP_CD   AS PRC_ALLOC_INTFC_TP_CD
            ,PAI.SVC_MACH_MSTR_PK        AS SVC_MACH_MSTR_PK
            ,DCBA.DS_CONTR_BR_ALLOC_PK   AS DS_CONTR_BR_ALLOC_PK
            ,DCSA.DS_CONTR_SEG_ALLOC_PK  AS DS_CONTR_SEG_ALLOC_PK
            ,DCI.MDSE_CD                 AS MDSE_CD
            ,DCI.DS_ACCT_NUM             AS DS_ACCT_NUM
            ,DCI.TOC_CD                  AS TOC_CD
            ,DCI.SVC_PGM_MDSE_CD         AS SVC_PGM_MDSE_CD
            ,DCI.DS_CONTR_CATG_CD        AS DS_CONTR_CATG_CD
            ,DCI.SVC_LINE_BIZ_CD         AS SVC_LINE_BIZ_CD
        FROM
             DS_CONTR_INTFC          DCI
            ,PRC_ALLOC_INTFC         PAI
            ,DS_CONTR                DC
            ,DS_CONTR_DTL            DCD
            ,DS_CONTR_PRC_ALLOC      DCPA
            ,DS_CONTR_BR_ALLOC       DCBA
            ,DS_CONTR_SEG_ALLOC      DCSA
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD    IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- PRC_ALLOC_INTFC -->
            AND PAI.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = PAI.DS_CONTR_SRC_REF_NUM
            AND DCI.CONTR_INTFC_SRC_TP_CD   = PAI.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = PAI.DS_CONTR_INTFC_BAT_NUM
            AND PAI.PRC_ALLOC_INTFC_TP_CD   = #prcAllocIntfcTpCd#
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(PAI.SVC_MACH_MSTR_PK, 0)
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD(+)          = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM(+)
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD(+)         = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK(+)
            AND NVL(DCI.SVC_MACH_MSTR_PK, 0)= NVL(DCD.SVC_MACH_MSTR_PK(+), 0)
            <!-- DS_CONTR_PRC_ALLOC -->
            AND DCPA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCPA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCPA.DS_CONTR_DTL_PK(+)
            AND DCPA.SVC_INV_CHRG_TP_CD(+)  = #mc#
            <!-- DS_CONTR_BR_ALLOC -->
            AND DCBA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCBA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCBA.DS_CONTR_DTL_PK(+)
            AND DCBA.SVC_INV_CHRG_TP_CD(+)  = #mc#
            <!-- DS_CONTR_SEG_ALLOC -->
            AND DCSA.GLBL_CMPY_CD(+)        = #glblCmpyCd#
            AND DC.DS_CONTR_PK              = DCSA.DS_CONTR_PK(+)
            AND DCD.DS_CONTR_DTL_PK         = DCSA.DS_CONTR_DTL_PK(+)
            AND DCSA.SVC_INV_CHRG_TP_CD(+)  = #mc#
            AND DCI.EZCANCELFLAG            = '0'
            AND PAI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG(+)          = '0'
            AND DCD.EZCANCELFLAG(+)         = '0'
            AND DCPA.EZCANCELFLAG(+)        = '0'
            AND DCBA.EZCANCELFLAG(+)        = '0'
    </statement>

    <statement id="getDsContrIntfcBaseAndUsage" parameterClass="Map" resultClass="Map">
       SELECT
           DCI.DS_CONTR_SRC_REF_NUM
          ,DCI.CONTR_INTFC_SRC_TP_CD
          ,DCI.DS_CONTR_INTFC_BAT_NUM
          ,DCI.CONTR_INTFC_DTL_TP_CD
       FROM
           DS_CONTR_INTFC   DCI
       WHERE
           DCI.GLBL_CMPY_CD               = #glblCmpyCd#
           AND DCI.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
           AND DCI.CONTR_INTFC_SRC_TP_CD  = #dsContrSrcTpCd#
           AND DCI.DS_CONTR_PROC_STS_CD IN (#reprocess#, #inProcess#)
           AND DCI.DS_CONTR_INTFC_BAT_NUM = #dsContrIntfcBatNum#
           AND DCI.EZCANCELFLAG           = '0'
           GROUP BY
               DCI.DS_CONTR_SRC_REF_NUM
              ,DCI.CONTR_INTFC_SRC_TP_CD
              ,DCI.DS_CONTR_INTFC_BAT_NUM
              ,DCI.CONTR_INTFC_DTL_TP_CD
    </statement>

    <statement id="getDsContrIntfcListForUpdateComplete" parameterClass="Map" resultClass="Map">
        SELECT
             DCI.GLBL_CMPY_CD        AS GLBL_CMPY_CD
            ,DCI.DS_CONTR_INTFC_PK   AS DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC DCI
        WHERE
           DCI.GLBL_CMPY_CD               = #glblCmpyCd#
           AND DCI.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
           AND DCI.CONTR_INTFC_SRC_TP_CD  = #dsContrSrcTpCd#
           AND DCI.DS_CONTR_PROC_STS_CD IN (#reprocess#, #inProcess#)
           AND DCI.DS_CONTR_INTFC_BAT_NUM = #dsContrIntfcBatNum#
           AND DCI.EZCANCELFLAG           = '0'
    </statement>

<!-- del start 2017/09/19 QC#19775 -->
<!--
    <statement id="getStartMtrCntData" parameterClass="Map" resultClass="Map">
       SELECT
            SRM.START_MTR_CNT         START_MTR_CNT
        FROM
            DS_CONTR_INTFC   DCI
           ,SVC_PHYS_MTR     SPM
           ,START_READ_MAP   SRM
        WHERE
            DCI.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DCI.DS_CONTR_INTFC_PK     = #dsContrIntfcPk#
            AND DCI.START_MTR_CNT         IS NOT NULL
            AND SPM.GLBL_CMPY_CD          = #glblCmpyCd#
            AND DCI.SVC_MACH_MSTR_PK      = SPM.SVC_MACH_MSTR_PK
            AND SPM.ACTV_FLG              = 'Y'
            AND SRM.GLBL_CMPY_CD          = #glblCmpyCd#
            AND SPM.MDL_MTR_LB_CD         = SRM.MTR_LB_CD
            AND DCI.EZCANCELFLAG          = '0'
            AND SPM.EZCANCELFLAG          = '0'
            AND SRM.EZCANCELFLAG          = '0'
    </statement>
-->
<!-- del end 2017/09/19 QC#19775 -->

    <statement id="getSameDsContrDtlList" parameterClass="Map" resultClass="Map">
        SELECT
            DCD.CONTR_EFF_FROM_DT         CONTR_EFF_FROM_DT
           ,DCD.CONTR_EFF_THRU_DT         CONTR_EFF_THRU_DT
        FROM
            DS_CONTR_INTFC   DCI
           ,DS_CONTR         DC
           ,DS_CONTR_DTL     DCD
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DCI.DS_CONTR_INTFC_PK     = #dsContrIntfcPk#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM          = DC.DS_CONTR_NUM
            <!-- DS_CONTR_DTL -->
            AND DCD.GLBL_CMPY_CD          = #glblCmpyCd#
            AND DC.DS_CONTR_PK            = DCD.DS_CONTR_PK
            AND DCD.DS_CONTR_DTL_STS_CD   = #active#
            <!-- EZCANCELFLAG -->
            AND DCI.EZCANCELFLAG          = '0'
            AND DC.EZCANCELFLAG           = '0'
            AND DCD.EZCANCELFLAG          = '0'
    </statement>

    <statement id="getDsSubContrIntfcList" parameterClass="Map" resultMap="result.DS_SUB_CONTR_INTFCTMsg">
        SELECT
             DSCI.GLBL_CMPY_CD
            ,DSCI.DS_SUB_CONTR_INTFC_PK
            ,DSCI.DS_CONTR_INTFC_BAT_NUM
            ,DSCI.DS_CONTR_SRC_REF_NUM
            ,DSCI.CONTR_INTFC_SRC_TP_CD
            ,DSCI.DS_CONTR_INTFC_ACT_CD
            ,DSCI.DS_CONTR_PROC_STS_CD
            ,DSCI.SUB_CONTR_INTFC_STS_CD
            ,DSCI.DS_CONTR_VLD_RSLT_WRK_PK
            ,DSCI.SER_NUM
            ,DSCI.DS_CONTR_NUM
            ,DSCI.VND_CD
            ,DSCI.TECH_CD
            ,DSCI.EFF_FROM_DT
            ,DSCI.EFF_THRU_DT
            ,DSCI.CONTR_TRMN_FLG
            ,DSCI.BASE_PRC_DEAL_AMT
            ,DSCI.ADMIN_PRC_DEAL_AMT
            ,DSCI.PREPD_MAINT_FLG
            ,DSCI.BW_MTR_ALWNC_CNT
            ,DSCI.COLOR_MTR_ALWNC_CNT
            ,DSCI.BW_MTR_PRC_AMT_RATE
            ,DSCI.COLOR_MTR_PRC_AMT_RATE
            ,DSCI.SPLY_INCL_FLG
            ,DSCI.BLLG_CYCLE_CD
            ,DSCI.DLR_FLEET_FLG
            ,DSCI.DLR_FLEET_NUM
            ,DSCI.SVC_CMNT_TXT
        FROM
            DS_SUB_CONTR_INTFC    DSCI
        WHERE
           DSCI.GLBL_CMPY_CD               = #glblCmpyCd#
           AND DSCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
           AND DSCI.EZCANCELFLAG           = '0'
    </statement>

    <resultMap id="result.DS_SUB_CONTR_INTFCTMsg" class="DS_SUB_CONTR_INTFCTMsg">
        <result property="glblCmpyCd"           column="GLBL_CMPY_CD"             javaType="EZDTStringItem"/>
        <result property="dsSubContrIntfcPk"    column="DS_SUB_CONTR_INTFC_PK"    javaType="EZDTBigDecimalItem"/>
        <result property="dsContrIntfcBatNum"   column="DS_CONTR_INTFC_BAT_NUM"   javaType="EZDTStringItem"/>
        <result property="dsContrSrcRefNum"     column="DS_CONTR_SRC_REF_NUM"     javaType="EZDTStringItem"/>
        <result property="contrIntfcSrcTpCd"    column="CONTR_INTFC_SRC_TP_CD"    javaType="EZDTStringItem"/>
        <result property="dsContrIntfcActCd"    column="DS_CONTR_INTFC_ACT_CD"    javaType="EZDTStringItem"/>
        <result property="dsContrProcStsCd"     column="DS_CONTR_PROC_STS_CD"     javaType="EZDTStringItem"/>
        <result property="subContrIntfcStsCd"   column="SUB_CONTR_INTFC_STS_CD"   javaType="EZDTStringItem"/>
        <result property="dsContrVldRsltWrkPk"  column="DS_CONTR_VLD_RSLT_WRK_PK" javaType="EZDTBigDecimalItem"/>
        <result property="serNum"               column="SER_NUM"                  javaType="EZDTStringItem"/>
        <result property="dsContrNum"           column="DS_CONTR_NUM"             javaType="EZDTStringItem"/>
        <result property="vndCd"                column="VND_CD"                   javaType="EZDTStringItem"/>
        <result property="techCd"               column="TECH_CD"                  javaType="EZDTStringItem"/>
        <result property="effFromDt"            column="EFF_FROM_DT"              javaType="EZDTStringItem"/>
        <result property="effThruDt"            column="EFF_THRU_DT"              javaType="EZDTStringItem"/>
        <result property="contrTrmnFlg"         column="CONTR_TRMN_FLG"           javaType="EZDTStringItem"/>
        <result property="basePrcDealAmt"       column="BASE_PRC_DEAL_AMT"        javaType="EZDTBigDecimalItem"/>
        <result property="adminPrcDealAmt"      column="ADMIN_PRC_DEAL_AMT"       javaType="EZDTBigDecimalItem"/>
        <result property="prepdMaintFlg"        column="PREPD_MAINT_FLG"          javaType="EZDTStringItem"/>
        <result property="bwMtrAlwncCnt"        column="BW_MTR_ALWNC_CNT"         javaType="EZDTBigDecimalItem"/>
        <result property="colorMtrAlwncCnt"     column="COLOR_MTR_ALWNC_CNT"      javaType="EZDTBigDecimalItem"/>
        <result property="bwMtrPrcAmtRate"      column="BW_MTR_PRC_AMT_RATE"      javaType="EZDTBigDecimalItem"/>
        <result property="colorMtrPrcAmtRate"   column="COLOR_MTR_PRC_AMT_RATE"   javaType="EZDTBigDecimalItem"/>
        <result property="splyInclFlg"          column="SPLY_INCL_FLG"            javaType="EZDTStringItem"/>
        <result property="bllgCycleCd"          column="BLLG_CYCLE_CD"            javaType="EZDTStringItem"/>
        <result property="dlrFleetFlg"          column="DLR_FLEET_FLG"            javaType="EZDTStringItem"/>
        <result property="dlrFleetNum"          column="DLR_FLEET_NUM"            javaType="EZDTStringItem"/>
        <result property="svcCmntTxt"           column="SVC_CMNT_TXT"             javaType="EZDTStringItem"/>
    </resultMap>

    <statement id="getUsageListForDsContrIntfc"  parameterClass="Map" resultClass="Map">
        SELECT
             DCIB.GLBL_CMPY_CD
            ,DCIB.DS_CONTR_INTFC_PK
        FROM
             DS_CONTR_INTFC          DCIB
            ,DS_CONTR_INTFC          DCIU
        WHERE
            DCIB.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCIB.DS_CONTR_PROC_STS_CD    IN (#reprocess#, #inProcess#)
            AND DCIB.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCIB.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCIB.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCIB.DS_CONTR_INTFC_PK       = #dsContrIntfcPk#
            AND DCIB.GLBL_CMPY_CD            = DCIU.GLBL_CMPY_CD
            AND DCIB.DS_CONTR_PROC_STS_CD    = DCIU.DS_CONTR_PROC_STS_CD
            AND DCIB.DS_CONTR_SRC_REF_NUM    = DCIU.DS_CONTR_SRC_REF_NUM
            AND DCIB.CONTR_INTFC_SRC_TP_CD   = DCIU.CONTR_INTFC_SRC_TP_CD
            AND DCIB.DS_CONTR_INTFC_BAT_NUM  = DCIU.DS_CONTR_INTFC_BAT_NUM
            AND NVL(DCIB.SVC_MACH_MSTR_PK, 0)= NVL(DCIU.SVC_MACH_MSTR_PK, 0)
            AND DCIU.CONTR_INTFC_DTL_TP_CD   = #usage#
    </statement>

    <statement id="countupContrVldRsltWrk"  parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(DISTINCT DCVRW.DS_CONTR_VLD_RSLT_WRK_PK) AS CNT
        FROM
             DS_CONTR_INTFC           DCI
            ,DS_CONTR                 DC
            ,DS_CONTR_VLD_RSLT_WRK    DCVRW
        WHERE
            <!-- DS_CONTR_INTFC -->
            DCI.GLBL_CMPY_CD                = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            <!-- DS_CONTR -->
            AND DC.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DCI.DS_CONTR_NUM             = DC.DS_CONTR_NUM
            <!-- DS_CONTR_VLD_RSLT_WRK -->
            AND DCVRW.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCVRW.DS_CONTR_VLD_STS_CD    = #dsContrVldStsCd#
            AND DC.DS_CONTR_PK               = DCVRW.DS_CONTR_PK
            AND DCI.EZCANCELFLAG            = '0'
            AND DC.EZCANCELFLAG             = '0'
            AND DCVRW.EZCANCELFLAG          = '0'
        ORDER BY DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getOldMachInfoForIntfc"  parameterClass="Map" resultClass="Map">
        SELECT
             DCI.DS_CONTR_INTFC_PK
            ,DCI.DS_CONTR_INTFC_ACT_CD
            ,DCI.SVC_MACH_MSTR_PK
            ,DCI.SER_NUM
            ,DCI.DS_CONTR_NUM
            ,DCI.OLD_DS_CONTR_DTL_PK
            ,DCI.OLD_SVC_MACH_MSTR_PK
            ,SMM.SVC_MACH_TP_CD
        FROM
             DS_CONTR_INTFC   DCI
            ,SVC_MACH_MSTR    SMM
        WHERE
            DCI.GLBL_CMPY_CD            = #glblCmpyCd#
        AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
        AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
        AND DCI.DS_CONTR_PROC_STS_CD    IN (#reprocess#, #inProcess#)
        AND DCI.CONTR_INTFC_SRC_TP_CD   = #contrIntfcSrcTpCd#
        AND DCI.CONTR_INTFC_DTL_TP_CD   = #contrIntfcDtlTpCd#
        AND DCI.OLD_DS_CONTR_DTL_PK     IS NOT NULL
        AND DCI.EZCANCELFLAG            = '0'
        AND DCI.GLBL_CMPY_CD            = SMM.GLBL_CMPY_CD
        AND DCI.SVC_MACH_MSTR_PK        = SMM.SVC_MACH_MSTR_PK
        AND SMM.EZCANCELFLAG            = '0'
        ORDER BY
            DCI.DS_CONTR_INTFC_PK
    </statement>

    <statement id="getTermConditionForOldMach"  parameterClass="Map" resultMap="result.SVC_TERM_CONDTMsg">
        SELECT
             STC.GLBL_CMPY_CD              AS GLBL_CMPY_CD
            ,STC.SVC_TERM_COND_PK          AS SVC_TERM_COND_PK
            ,STC.DS_CONTR_PK               AS DS_CONTR_PK
            ,STC.DS_CONTR_DTL_PK           AS DS_CONTR_DTL_PK
            ,STC.SVC_TERM_COND_ATTRB_PK    AS SVC_TERM_COND_ATTRB_PK
            ,STC.SVC_TERM_ATTRB_MAP_VAL_CD AS SVC_TERM_ATTRB_MAP_VAL_CD
        FROM
             SVC_TERM_COND            STC
            ,SVC_TERM_COND_ATTRB      STCA
        WHERE
            STC.GLBL_CMPY_CD              = #glblCmpyCd#
        AND STC.DS_CONTR_DTL_PK           = #dsContrDtlPk#
        AND STC.EZCANCELFLAG              = '0'
        AND STC.GLBL_CMPY_CD              = STCA.GLBL_CMPY_CD
        AND STC.SVC_TERM_COND_ATTRB_PK    = STCA.SVC_TERM_COND_ATTRB_PK
        AND STC.SVC_TERM_ATTRB_MAP_VAL_CD IS NOT NULL
        AND STCA.EZCANCELFLAG             = '0'
        AND STCA.EFF_FROM_DT          &lt;= #slsDt#
<!-- START 2016/11/04 N.Arai [QC#14840, MOD] -->
        AND NVL(STCA.EFF_THRU_DT,#slsDt#)   &gt;= #slsDt#
<!-- END 2016/11/04 N.Arai [QC#14840, MOD] -->
    </statement>
    <resultMap id="result.SVC_TERM_CONDTMsg" class="SVC_TERM_CONDTMsg">
        <result property="glblCmpyCd"           column="GLBL_CMPY_CD"              javaType="EZDTStringItem"/>
        <result property="svcTermCondPk"        column="SVC_TERM_COND_PK"          javaType="EZDTBigDecimalItem"/>
        <result property="dsContrPk"            column="DS_CONTR_PK"               javaType="EZDTBigDecimalItem"/>
        <result property="dsContrDtlPk"         column="DS_CONTR_DTL_PK"           javaType="EZDTBigDecimalItem"/>
        <result property="svcTermCondAttrbPk"   column="SVC_TERM_COND_ATTRB_PK"    javaType="EZDTBigDecimalItem"/>
        <result property="svcTermAttrbMapValCd" column="SVC_TERM_ATTRB_MAP_VAL_CD" javaType="EZDTStringItem"/>
    </resultMap>

    <statement id="getDsContrDtlPk"  parameterClass="Map" resultClass="BigDecimal">
        SELECT
             DCD.DS_CONTR_DTL_PK
        FROM
             DS_CONTR_INTFC          DCI
            ,DS_CONTR                DC
            ,DS_CONTR_DTL            DCD
        WHERE
            DCI.GLBL_CMPY_CD            = #glblCmpyCd#
        AND DCI.DS_CONTR_INTFC_PK       = #dsContrIntfcPk#
        AND DCI.EZCANCELFLAG            = '0'
        AND DCI.GLBL_CMPY_CD            = DC.GLBL_CMPY_CD
        AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
        AND DC.EZCANCELFLAG             = '0'
        AND DC.GLBL_CMPY_CD             = DCD.GLBL_CMPY_CD
        AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK
        AND DCI.SVC_MACH_MSTR_PK        = DCD.SVC_MACH_MSTR_PK
        AND DCD.EZCANCELFLAG            = '0'
    </statement>

<!-- START 2016/11/09 T.Tomita [QC#15453, ADD] -->
    <statement id="getMinContrFromDt" parameterClass="Map" resultClass="String">
        SELECT
            MIN(DCI.CONTR_FROM_DT)
        FROM
            DS_CONTR_INTFC DCI
        WHERE
                DCI.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.EZCANCELFLAG            = '0'
    </statement>

    <statement id="getMaxContrThruDt" parameterClass="Map" resultClass="String">
        SELECT
            MAX(DCI.CONTR_THRU_DT)
        FROM
            DS_CONTR_INTFC DCI
        WHERE
                DCI.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCI.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.EZCANCELFLAG            = '0'
    </statement>
<!-- END 2016/11/09 T.Tomita [QC#15453, ADD] -->

    <statement id="getMachContrThruDtByIntfc" parameterClass="Map" resultClass="String">
        SELECT
            DCI.CONTR_THRU_DT
        FROM
             SVC_MACH_MSTR   SMM
            ,SVC_CONFIG_MSTR SCM
            ,DS_CONTR_INTFC  DCI
        WHERE
                SMM.GLBL_CMPY_CD            = #glblCmpyCd#
            AND SMM.SVC_MACH_MSTR_PK        = #svcMachMstrPk#
            AND SMM.EZCANCELFLAG            = '0'
            AND SMM.GLBL_CMPY_CD            = SCM.GLBL_CMPY_CD
            AND SMM.SVC_CONFIG_MSTR_PK      = SCM.SVC_CONFIG_MSTR_PK
            AND SCM.EZCANCELFLAG            = '0'
            AND SCM.GLBL_CMPY_CD            = DCI.GLBL_CMPY_CD
            AND SCM.SVC_MACH_MSTR_PK        = DCI.SVC_MACH_MSTR_PK
            AND DCI.DS_CONTR_PROC_STS_CD    IN (#reprocess#, #inProcess#)
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.EZCANCELFLAG            = '0'
    </statement>

    <statement id="getMachContrThruDtByContr" parameterClass="Map" resultClass="String">
        SELECT
            DCD.CONTR_EFF_THRU_DT
        FROM
             SVC_MACH_MSTR   SMM
            ,SVC_CONFIG_MSTR SCM
            ,DS_CONTR_DTL    DCD
        WHERE
                SMM.GLBL_CMPY_CD            = #glblCmpyCd#
            AND SMM.SVC_MACH_MSTR_PK        = #svcMachMstrPk#
            AND SMM.EZCANCELFLAG            = '0'
            AND SMM.GLBL_CMPY_CD            = SCM.GLBL_CMPY_CD
            AND SMM.SVC_CONFIG_MSTR_PK      = SCM.SVC_CONFIG_MSTR_PK
            AND SCM.EZCANCELFLAG            = '0'
            AND SCM.GLBL_CMPY_CD            = DCD.GLBL_CMPY_CD
            AND SCM.SVC_MACH_MSTR_PK        = DCD.SVC_MACH_MSTR_PK
            AND SCM.SVC_CONFIG_MSTR_PK      = DCD.SVC_CONFIG_MSTR_PK
            AND DCD.DS_CONTR_PK             = #dsContrPk#
            AND DCD.EZCANCELFLAG            = '0'
    </statement>

<!-- add start 2017/08/17 QC#18799 -->
<!-- mod start 2017/09/19 QC#19775 -->
    <statement id="getDsContrIntfcDefRuleForMtrRead" parameterClass="Map" resultClass="Map">
        SELECT
             DCIDR.START_READ_VLD_TP_CD
            ,DCIDR.ISTL_CALL_MTR_READ_USE_FLG
        FROM
             DS_CONTR_INTFC     DCI
            ,DS_CONTR_INTFC_DEF_RULE  DCIDR
        WHERE
                DCI.GLBL_CMPY_CD            = #glblCmpyCd#
            AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
            AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
            AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
            AND DCI.EZCANCELFLAG            = '0'
            AND DCI.GLBL_CMPY_CD            = DCIDR.GLBL_CMPY_CD
            AND DCI.CONTR_INTFC_SRC_TP_CD   = DCIDR.CONTR_INTFC_SRC_TP_CD
            AND DCI.DS_CONTR_CLS_CD         = DCIDR.DS_CONTR_CLS_CD
            AND DCI.SVC_LINE_BIZ_CD         = DCIDR.SVC_LINE_BIZ_CD
            AND DCIDR.EFF_FROM_DT           &lt;= #salesDate#
            AND DCIDR.ENBL_FLG              = 'Y'
            AND DCIDR.EZCANCELFLAG          = '0'
        ORDER BY
             DCI.DS_CONTR_INTFC_PK
    </statement>
<!-- mod end 2017/09/19 QC#19775 -->

    <statement id="getDsContrListForNSZC0100IstlCall" parameterClass="Map" resultClass="Map">
        SELECT
            SVC_MACH_MSTR_PK
            ,DS_CONTR_DTL_PK
            ,CONTR_EFF_FROM_DT
            ,MTR_READ_DT
            ,START_MTR_CNT
            ,SVC_PHYS_MTR_PK
            ,VLD_MTR_FLG
        FROM
            (
            SELECT
                SVC_MACH_MSTR_PK
                ,DS_CONTR_DTL_PK
                ,CONTR_EFF_FROM_DT
                ,MTR_READ_DT
                ,START_MTR_CNT
                ,SVC_PHYS_MTR_PK
                ,VLD_MTR_FLG
            FROM
                (
                SELECT
                     DCD.SVC_MACH_MSTR_PK                 AS SVC_MACH_MSTR_PK
                    ,DCD.DS_CONTR_DTL_PK                  AS DS_CONTR_DTL_PK
                    ,DCD.CONTR_EFF_FROM_DT                AS CONTR_EFF_FROM_DT
<!-- START 2017/09/21 K.Kim [QC#21226, MOD] -->
                    <!-- ,CASE WHEN DCI.START_MTR_CNT IS NOT NULL -->
                    <!--         THEN TO_CHAR(TO_DATE(NVL(DCD.CONTR_EFF_FROM_DT, #maxDate#), #format#) - 1, #format#) -->
                    <!--         ELSE READ.MTR_READ_DT -->
                    <!--  END                                  AS MTR_READ_DT -->
                    ,CASE WHEN DCI.START_MTR_CNT IS NOT NULL 
                            THEN TO_CHAR(TO_DATE(NVL(DCD.CONTR_EFF_FROM_DT, #maxDate#), #format#), #format#)
                            ELSE READ.MTR_READ_DT
                     END                                  AS MTR_READ_DT
<!-- END 2017/09/21 K.Kim [QC#21226, MOD] -->
                    ,CASE WHEN DCI.START_MTR_CNT IS NOT NULL 
                            THEN DCI.START_MTR_CNT
                            ELSE READ.READ_MTR_CNT
                     END                                  AS START_MTR_CNT
                    ,SPM.SVC_PHYS_MTR_PK                  AS SVC_PHYS_MTR_PK
                    ,ROW_NUMBER() OVER (PARTITION BY SPM.SVC_PHYS_MTR_PK ORDER BY READ.MTR_READ_DT DESC,READ.SVC_PHYS_MTR_READ_GRP_SQ DESC) AS ROW_NUM
                    ,READ.VLD_MTR_FLG                     AS VLD_MTR_FLG
                FROM
                     DS_CONTR_INTFC          DCI
                    ,DS_CONTR                DC
                    ,DS_CONTR_DTL            DCD
                    ,SVC_PHYS_MTR            SPM
                    ,SVC_PHYS_MTR_READ       READ
                    ,FSR                     FSR
                WHERE
                    <!-- DS_CONTR_INTFC -->
                    DCI.GLBL_CMPY_CD                = #glblCmpyCd#
                    AND DCI.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
                    AND DCI.CONTR_INTFC_SRC_TP_CD   = #dsContrSrcTpCd#
                    AND DCI.CONTR_INTFC_DTL_TP_CD   = #usage#
                    AND DCI.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
                    <!-- DS_CONTR -->
                    AND DC.GLBL_CMPY_CD             = #glblCmpyCd#
                    AND DCI.DS_CONTR_NUM            = DC.DS_CONTR_NUM
                    <!-- DS_CONTR_DTL -->
                    AND DCD.GLBL_CMPY_CD            = #glblCmpyCd#
                    AND DC.DS_CONTR_PK              = DCD.DS_CONTR_PK
                    AND DCI.SVC_MACH_MSTR_PK        = DCD.SVC_MACH_MSTR_PK
                    <!-- SVC_PHYS_MTR -->
                    AND SPM.GLBL_CMPY_CD            = #glblCmpyCd#
                    AND DCI.SVC_MACH_MSTR_PK        = SPM.SVC_MACH_MSTR_PK
                    AND SPM.ACTV_FLG                = 'Y'
                    <!-- SVC_PHYS_MTR_READ -->
                    AND READ.GLBL_CMPY_CD(+)        = #glblCmpyCd#
                    AND SPM.SVC_PHYS_MTR_PK         = READ.SVC_PHYS_MTR_PK(+)
                    AND READ.VLD_MTR_FLG(+)         = 'Y'
                    AND READ.DS_CONTR_DTL_PK(+)     IS NULL
                    <!-- FSR -->
                    AND READ.GLBL_CMPY_CD           = FSR.GLBL_CMPY_CD(+)
                    AND READ.FSR_NUM                = FSR.FSR_NUM(+)
                    AND FSR.FSR_TP_CD(+)            = #fsrTpCd#
                    AND DCI.EZCANCELFLAG            = '0'
                    AND DC.EZCANCELFLAG             = '0'
                    AND DCD.EZCANCELFLAG            = '0'
                    AND SPM.EZCANCELFLAG            = '0'
                    AND READ.EZCANCELFLAG(+)        = '0'
                    AND FSR.EZCANCELFLAG(+)         = '0'
                    AND NOT EXISTS
                        (SELECT 1 FROM
                            SVC_PHYS_MTR_READ       SPMR
                        WHERE
                            SPMR.GLBL_CMPY_CD           = #glblCmpyCd#
                            AND SPM.SVC_PHYS_MTR_PK     = SPMR.SVC_PHYS_MTR_PK
                            AND SPMR.DS_CONTR_DTL_PK    = DCD.DS_CONTR_DTL_PK
                            AND SPMR.EZCANCELFLAG       = '0')
                )
            WHERE
                ROW_NUM = 1
            )
        WHERE
            START_MTR_CNT IS NOT NULL
        ORDER BY
            DS_CONTR_DTL_PK
    </statement>
<!-- add end 2017/08/17 QC#18799 -->
<!-- START 2018/05/15 T.Tomita [QC#25438, MOD] -->
    <statement id="getTermCpoOrdNumForSvcEchng" parameterClass="Map" resultClass="String">
<!-- START 2024/02/26 R.Tamura [QC#63393, MOD] -->
        SELECT
            UNI.CPO_ORD_NUM
        FROM
            (
            SELECT
                 A.CPO_ORD_NUM
                ,A.ORD_BOOK_TS
            FROM
                 CPO              A
                ,ORD_CATG_BIZ_CTX B
            WHERE
                A.GLBL_CMPY_CD           = #glblCmpyCd#
            AND A.EZCANCELFLAG           = '0'
            AND A.GLBL_CMPY_CD           = B.GLBL_CMPY_CD
            AND A.DS_ORD_CATG_CD         = B.DS_ORD_CATG_CD
<!-- START 2019/06/17 W.Honda [QC#50842, ADD] -->
            AND (A.DS_ORD_TP_CD          = B.DS_ORD_TP_CD
                OR  B.DS_ORD_TP_CD       IS NULL)
<!-- END 2019/06/17 W.Honda [QC#50842, MOD] -->
            AND B.EZCANCELFLAG           = '0'
            AND B.ORD_CATG_CTX_TP_CD     = #ordCatgCtxTpCd#
            AND EXISTS (
                    SELECT
                        *
                    FROM
                         DS_CONTR_INTFC   C
                        ,SVC_MACH_MSTR    D
                        ,DS_CPO_RTRN_DTL  E
                    WHERE
                        C.GLBL_CMPY_CD           = #glblCmpyCd#
                    AND C.EZCANCELFLAG           = '0'
                    AND C.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
                    AND C.CONTR_INTFC_SRC_TP_CD  = #contrIntfcSrcTpCd#
                    AND C.DS_CONTR_INTFC_BAT_NUM = #dsContrIntfcBatNum#
                    AND C.GLBL_CMPY_CD           = D.GLBL_CMPY_CD
                    AND C.SVC_MACH_MSTR_PK       = D.SVC_MACH_MSTR_PK
                    AND D.EZCANCELFLAG           = '0'
                    AND D.GLBL_CMPY_CD           = E.GLBL_CMPY_CD
                    AND D.SVC_MACH_MSTR_PK       = E.SVC_MACH_MSTR_PK
                    AND (
                        (
                                D.TRX_HDR_NUM        = E.CPO_ORD_NUM
                            AND D.TRX_LINE_NUM       = E.DS_CPO_RTRN_LINE_NUM
                            AND D.TRX_LINE_SUB_NUM   = E.DS_CPO_RTRN_LINE_SUB_NUM
                        ) OR (
                                D.RMA_NUM            = E.CPO_ORD_NUM
                            AND D.RMA_LINE_NUM       = E.DS_CPO_RTRN_LINE_NUM
                            AND D.RMA_LINE_SUB_NUM   = E.DS_CPO_RTRN_LINE_SUB_NUM
                        )
                    )
                    AND E.EZCANCELFLAG           = '0'
                    AND E.CPO_ORD_NUM            = A.CPO_ORD_NUM
                )
            <!-- ORDER BY -->
                <!-- A.ORD_BOOK_TS DESC -->
        UNION
            SELECT
                 A.CPO_ORD_NUM
                ,A.ORD_BOOK_TS
            FROM
                 CPO              A
                ,ORD_CATG_BIZ_CTX B
            WHERE
                A.GLBL_CMPY_CD           = #glblCmpyCd#
            AND A.EZCANCELFLAG           = '0'
            AND A.GLBL_CMPY_CD           = B.GLBL_CMPY_CD
            AND A.DS_ORD_CATG_CD         = B.DS_ORD_CATG_CD
            AND (A.DS_ORD_TP_CD          = B.DS_ORD_TP_CD
                OR  B.DS_ORD_TP_CD       IS NULL)
            AND B.EZCANCELFLAG           = '0'
            AND B.ORD_CATG_CTX_TP_CD     = #ordCatgCtxTpCd#
            AND EXISTS (
                    SELECT
                        *
                    FROM
                         DS_CONTR_INTFC   C
                        ,SVC_MACH_MSTR    D
                        ,DS_CPO_RTRN_DTL  E
                        ,MDSE             F
                    WHERE
                        C.GLBL_CMPY_CD           = #glblCmpyCd#
                    AND C.EZCANCELFLAG           = '0'
                    AND C.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
                    AND C.CONTR_INTFC_SRC_TP_CD  = #contrIntfcSrcTpCd#
                    AND C.DS_CONTR_INTFC_BAT_NUM = #dsContrIntfcBatNum#
                    AND C.GLBL_CMPY_CD           = D.GLBL_CMPY_CD
                    AND C.SVC_MACH_MSTR_PK       = D.SVC_MACH_MSTR_PK
                    AND D.EZCANCELFLAG           = '0'
                    AND D.GLBL_CMPY_CD           = E.GLBL_CMPY_CD
                    AND D.SVC_MACH_MSTR_PK       = E.SVC_MACH_MSTR_PK
                    AND E.EZCANCELFLAG           = '0'
                    AND E.RTRN_LINE_STS_CD       = #rtrnLineStsCd#
                    AND E.CPO_ORD_NUM            = A.CPO_ORD_NUM
                    AND D.GLBL_CMPY_CD           = F.GLBL_CMPY_CD
                    AND D.MDSE_CD                = F.MDSE_CD
                    AND F.INVTY_CTRL_FLG         = 'N'
                )
        ) UNI
        ORDER BY
            UNI.ORD_BOOK_TS DESC
<!-- END 2024/02/26 R.Tamura [QC#63393, MOD] -->
    </statement>
    <statement id="getAddContrIntfcPkForSvcEchng" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            A.DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC A
        WHERE
            A.GLBL_CMPY_CD           = #glblCmpyCd#
        AND A.EZCANCELFLAG           = '0'
        AND A.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD  = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_INTFC_ACT_CD  = #dsContrIntfcActCd#
        AND EXISTS (
            SELECT
                *
            FROM
                DS_CONTR_INTFC B
            WHERE
                B.GLBL_CMPY_CD           = #glblCmpyCd#
            AND B.EZCANCELFLAG           = '0'
            AND B.DS_CONTR_INTFC_BAT_NUM = #dsContrIntrfcBatNum#
            AND B.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
            AND B.SVC_MACH_MSTR_PK       = A.OLD_SVC_MACH_MSTR_PK
            )
        ORDER BY
            A.DS_CONTR_INTFC_PK
    </statement>
    <statement id="getAddContrCpoOrdNumForSvcEchng" parameterClass="Map" resultClass="String">
        SELECT
            A.CPO_ORD_NUM
        FROM
             CPO              A
            ,ORD_CATG_BIZ_CTX B
        WHERE
            A.GLBL_CMPY_CD           = #glblCmpyCd#
        AND A.EZCANCELFLAG           = '0'
        AND A.GLBL_CMPY_CD           = B.GLBL_CMPY_CD
        AND A.DS_ORD_CATG_CD         = B.DS_ORD_CATG_CD
<!-- START 2019/06/17 W.Honda [QC#50842, ADD] -->
        AND (A.DS_ORD_TP_CD          = B.DS_ORD_TP_CD
            OR  B.DS_ORD_TP_CD       IS NULL)
<!-- END 2019/06/17 W.Honda [QC#50842, MOD] -->
        AND B.EZCANCELFLAG           = '0'
        AND B.ORD_CATG_CTX_TP_CD     = #ordCatgCtxTpCd#
        AND EXISTS (
                SELECT
                    *
                FROM
                     DS_CONTR_INTFC   C
                    ,SVC_MACH_MSTR    D
                    ,CPO_DTL          E
                WHERE
                    C.GLBL_CMPY_CD           = #glblCmpyCd#
                AND C.EZCANCELFLAG           = '0'
                AND C.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
                AND C.CONTR_INTFC_SRC_TP_CD  = #contrIntfcSrcTpCd#
                AND C.DS_CONTR_INTFC_BAT_NUM = #dsContrIntfcBatNum#
                AND C.GLBL_CMPY_CD           = D.GLBL_CMPY_CD
                AND C.SVC_MACH_MSTR_PK       = D.SVC_MACH_MSTR_PK
                AND D.EZCANCELFLAG           = '0'
                AND D.GLBL_CMPY_CD           = E.GLBL_CMPY_CD
                AND D.CPO_ORD_NUM            = E.CPO_ORD_NUM
                AND D.CPO_DTL_LINE_NUM       = E.CPO_DTL_LINE_NUM
                AND D.CPO_DTL_LINE_SUB_NUM   = E.CPO_DTL_LINE_SUB_NUM
                AND E.EZCANCELFLAG           = '0'
                AND E.CPO_ORD_NUM            = A.CPO_ORD_NUM
            )
        ORDER BY
            A.ORD_BOOK_TS DESC
    </statement>
    <statement id="getTrmdIntfcPkForSvcEchng" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            A.DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC A
        WHERE
            A.GLBL_CMPY_CD           = #glblCmpyCd#
        AND A.EZCANCELFLAG           = '0'
        AND A.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD  = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_INTFC_ACT_CD  = #dsContrIntfcActCd#
        AND EXISTS (
            SELECT
                *
            FROM
                DS_CONTR_INTFC B
            WHERE
                B.GLBL_CMPY_CD           = #glblCmpyCd#
            AND B.EZCANCELFLAG           = '0'
            AND B.DS_CONTR_INTFC_BAT_NUM = #dsContrIntrfcBatNum#
            AND B.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
            AND B.OLD_SVC_MACH_MSTR_PK   = A.SVC_MACH_MSTR_PK
            )
        ORDER BY
            A.DS_CONTR_INTFC_PK
    </statement>
    <statement id="getAddContrIntfcPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            A.DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC A
        WHERE
            A.GLBL_CMPY_CD            = #glblCmpyCd#
        AND A.EZCANCELFLAG            = '0'
        AND A.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
        AND A.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD   = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_PROC_STS_CD   IN (#reprocess#, #inProcess#)
        AND A.CONTR_INTFC_DTL_TP_CD   = #base#
        ORDER BY
            A.DS_CONTR_INTFC_PK
    </statement>
    <statement id="getTrmdIntfcPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            D.DS_CONTR_INTFC_PK
        FROM
            DS_CONTR_INTFC D
        WHERE
            D.GLBL_CMPY_CD = #glblCmpyCd#
        AND D.EZCANCELFLAG = '0'
        <iterate property="intfcPkList" var="intfcPk[]"  open="AND D.DS_CONTR_INTFC_PK IN (" close=" )" conjunction=",">
            #intfcPk[]#
        </iterate>
        AND D.DS_CONTR_INTFC_ACT_CD = #dsContrIntfcActCd#
        AND D.CONTR_INTFC_DTL_TP_CD = #dsContrIntfcDtlTpCd#
        AND D.OLD_SVC_MACH_MSTR_PK  = #oldSvcMachMstrPk#
    </statement>
<!-- END 2018/05/15 T.Tomita [QC#25438, MOD] -->
<!-- START 2018/05/18 T.Tomita [QC#23433, ADD] -->
    <statement id="getBillWithEquipFlg" parameterClass="Map" resultClass="Map">
        SELECT
             B.BILL_WITH_EQUIP_FLG
            ,B.BILL_WITH_EQUIP_INVD_FLG
        FROM
             DS_CONTR_INTFC A
            ,DS_CONTR_DTL   B
        WHERE
            A.GLBL_CMPY_CD             = #glblCmpyCd#
        AND A.EZCANCELFLAG             = '0'
        AND A.DS_CONTR_INTFC_BAT_NUM   = #dsContrIntfcBatNum#
        AND A.DS_CONTR_SRC_REF_NUM     = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD    = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_INTFC_ACT_CD    = #dsContrIntfcActCd#
        AND A.SVC_MACH_MSTR_PK         = #svcMachMstrPk#
        AND A.GLBL_CMPY_CD             = B.GLBL_CMPY_CD
        AND A.OLD_DS_CONTR_DTL_PK      = B.DS_CONTR_DTL_PK
        AND B.EZCANCELFLAG             = '0'
    </statement>
<!-- END 2018/05/18 T.Tomita [QC#23433, ADD] -->
<!-- START 2018/05/24 T.Tomita [QC#26196, ADD] -->
    <statement id="getCpoOrdNumForExch" parameterClass="Map" resultClass="String">
        SELECT
            B.CPO_ORD_NUM   AS CPO_ORD_NUM
        FROM
             DS_CONTR_INTFC A
            ,SVC_MACH_MSTR  B
        WHERE
            A.GLBL_CMPY_CD                = #glblCmpyCd#
        AND A.EZCANCELFLAG                = '0'
        AND A.DS_CONTR_INTFC_BAT_NUM      = #dsContrIntfcBatNum#
        AND A.DS_CONTR_SRC_REF_NUM        = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD       = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_INTFC_ACT_CD       = #dsContrIntfcActCd#
        AND A.GLBL_CMPY_CD                = B.GLBL_CMPY_CD
        AND A.SVC_MACH_MSTR_PK            = B.SVC_MACH_MSTR_PK
        AND B.EZCANCELFLAG                = '0'
        GROUP BY
            B.CPO_ORD_NUM
    </statement>
    <statement id="getAddContrFromDt" parameterClass="Map" resultClass="String">
        SELECT
            B.CONTR_FROM_DT
        FROM
             DS_CONTR_INTFC  A
            ,DS_CONTR_INTFC  B
        WHERE
            A.GLBL_CMPY_CD                = #glblCmpyCd#
        AND A.EZCANCELFLAG                = '0'
        AND A.DS_CONTR_INTFC_BAT_NUM      = #dsContrIntfcBatNum#
        AND A.DS_CONTR_SRC_REF_NUM        = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD       = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_INTFC_ACT_CD       = #trmdActCd#
        AND A.SVC_MACH_MSTR_PK            = #svcMachMstrPk#
        AND A.GLBL_CMPY_CD                = B.GLBL_CMPY_CD
        AND A.DS_CONTR_SRC_REF_NUM        = B.DS_CONTR_SRC_REF_NUM
        AND A.CONTR_INTFC_SRC_TP_CD       = B.CONTR_INTFC_SRC_TP_CD
        AND A.SVC_MACH_MSTR_PK            = B.OLD_SVC_MACH_MSTR_PK
        AND A.CONTR_INTFC_DTL_TP_CD       = B.CONTR_INTFC_DTL_TP_CD
        AND B.EZCANCELFLAG                = '0'
        AND B.DS_CONTR_INTFC_ACT_CD       = #addContrActCd#
        GROUP BY
            B.CONTR_FROM_DT
        ORDER BY
            B.CONTR_FROM_DT
    </statement>
<!-- END 2018/05/24 T.Tomita [QC#26196, ADD] -->
<!-- START 2018/05/28 T.Tomita [QC#26380, ADD] -->
    <statement id="getOldDsContrDtlPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             B.DS_CONTR_DTL_PK   AS DS_CONTR_DTL_PK
        FROM
             DS_CONTR_INTFC A
            ,DS_CONTR_DTL   B
        WHERE
            A.GLBL_CMPY_CD             = #glblCmpyCd#
        AND A.EZCANCELFLAG             = '0'
        AND A.DS_CONTR_INTFC_BAT_NUM   = #dsContrIntfcBatNum#
        AND A.DS_CONTR_SRC_REF_NUM     = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD    = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_INTFC_ACT_CD    = #dsContrIntfcActCd#
        AND A.SVC_MACH_MSTR_PK         = #svcMachMstrPk#
        AND A.GLBL_CMPY_CD             = B.GLBL_CMPY_CD
        AND A.OLD_DS_CONTR_DTL_PK      = B.DS_CONTR_DTL_PK
        AND B.EZCANCELFLAG             = '0'
    </statement>
<!-- END 2018/05/28 T.Tomita [QC#26380, ADD] -->
<!-- START 2018/05/29 T.Tomita [QC#26379, ADD] -->
    <statement id="getDsContrDtlPkForAccNoExch" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             ACC_DTL.DS_CONTR_DTL_PK
        FROM
             SVC_MACH_MSTR  MAC
            ,SVC_MACH_MSTR  ACC
            ,DS_CONTR_DTL   ACC_DTL
        WHERE
            MAC.GLBL_CMPY_CD              = #glblCmpyCd#
        AND MAC.EZCANCELFLAG              = '0'
        AND MAC.SVC_MACH_MSTR_PK          = #svcMachMstrPk#
        AND MAC.SVC_MACH_TP_CD            = #mach#
        AND MAC.GLBL_CMPY_CD              = ACC.GLBL_CMPY_CD
        AND MAC.SVC_CONFIG_MSTR_PK        = ACC.SVC_CONFIG_MSTR_PK
        AND ACC.EZCANCELFLAG              = '0'
        AND ACC.SVC_MACH_TP_CD            = #acc#
        AND ACC.GLBL_CMPY_CD              = ACC_DTL.GLBL_CMPY_CD
        AND ACC.SVC_MACH_MSTR_PK          = ACC_DTL.SVC_MACH_MSTR_PK
        AND ACC_DTL.EZCANCELFLAG          = '0'
        AND ACC_DTL.DS_CONTR_PK           = #dsContrPk#
        AND ACC_DTL.PRNT_DS_CONTR_DTL_PK &lt;&gt; #dsContrDtlPk#
        AND NOT EXISTS (
            SELECT
                *
            FROM
                DS_CONTR_INTFC IFC
            WHERE
                IFC.GLBL_CMPY_CD           = ACC_DTL.GLBL_CMPY_CD
            AND IFC.EZCANCELFLAG           = '0'
            AND IFC.DS_CONTR_INTFC_BAT_NUM = #dsContrIntfcBatNum#
            AND IFC.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
            AND IFC.CONTR_INTFC_SRC_TP_CD  = #contrIntfcSrcTpCd#
            AND IFC.DS_CONTR_INTFC_ACT_CD  = #dsContrIntfcActCd#
            AND IFC.SVC_MACH_MSTR_PK       = ACC_DTL.SVC_MACH_MSTR_PK
            )
    </statement>
    <statement id="getDsContrBllgSchdSmryPkForAccNoExch" parameterClass="Map" resultClass="BigDecimal">
        SELECT
             A.DS_CONTR_BLLG_SCHD_SMRY_PK
        FROM
             DS_CONTR_BLLG_SCHD_SMRY  A
        WHERE
            A.GLBL_CMPY_CD     = #glblCmpyCd#
        AND A.EZCANCELFLAG     = '0'
        AND A.DS_CONTR_DTL_PK  = #dsContrDtlPk#
        AND A.BASE_CHRG_FLG    = #baseChrgFlg#
        ORDER BY
            A.BLLG_SCHD_FROM_DT
    </statement>
<!-- END 2018/05/29 T.Tomita [QC#26379, ADD] -->
<!-- START 2018/06/01 T.Tomita [QC#26379, ADD] -->
    <statement id="getConfigPkForMachIntfc" parameterClass="Map" resultClass="Map">
        SELECT
             B.SVC_CONFIG_MSTR_PK
            ,B.SVC_MACH_MSTR_PK
            <!-- START 2023/09/04 t.aizawa [QC#60739, ADD] -->
            ,B.ISTL_DT
            <!-- END   2023/09/04 t.aizawa [QC#60739, ADD] -->
        FROM
             DS_CONTR_INTFC A
            ,SVC_MACH_MSTR  B
        WHERE
            A.GLBL_CMPY_CD           = #glblCmpyCd#
        AND A.EZCANCELFLAG           = '0'
        AND A.DS_CONTR_INTFC_BAT_NUM = #dsContrIntfcBatNum#
        AND A.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD  = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_INTFC_ACT_CD  = #dsContrIntfcActCd#
        AND A.GLBL_CMPY_CD           = B.GLBL_CMPY_CD
        AND A.SVC_MACH_MSTR_PK       = B.SVC_MACH_MSTR_PK
        AND B.EZCANCELFLAG           = '0'
        AND B.SVC_MACH_TP_CD         = #mach#
        GROUP BY
             B.SVC_CONFIG_MSTR_PK
            ,B.SVC_MACH_MSTR_PK
            <!-- START 2023/09/04 t.aizawa [QC#60739, ADD] -->
            ,B.ISTL_DT
            <!-- END   2023/09/04 t.aizawa [QC#60739, ADD] -->
    </statement>
    <statement id="getNoExchAccPkMapList" parameterClass="Map" resultClass="Map">
        SELECT
             B.DS_CONTR_PK        AS DS_CONTR_PK
            ,B.DS_CONTR_DTL_PK    AS DS_CONTR_DTL_PK
            ,B.SVC_CONFIG_MSTR_PK AS SVC_CONFIG_MSTR_PK
            ,B.SVC_MACH_MSTR_PK   AS SVC_MACH_MSTR_PK
        FROM
             SVC_MACH_MSTR A
            ,DS_CONTR_DTL  B
        WHERE
            A.GLBL_CMPY_CD       = #glblCmpyCd#
        AND A.EZCANCELFLAG       = '0'
        AND A.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
        AND NOT EXISTS (
            SELECT
                *
            FROM
                 DS_CONTR_INTFC Z
            WHERE
                Z.GLBL_CMPY_CD           = #glblCmpyCd#
            AND Z.EZCANCELFLAG           = '0'
            AND Z.DS_CONTR_INTFC_BAT_NUM = #dsContrIntfcBatNum#
            AND Z.DS_CONTR_SRC_REF_NUM   = #dsContrSrcRefNum#
            AND Z.CONTR_INTFC_SRC_TP_CD  = #contrIntfcSrcTpCd#
            AND Z.DS_CONTR_INTFC_ACT_CD  = #dsContrIntfcActCd#
            AND Z.SVC_MACH_MSTR_PK       = A.SVC_MACH_MSTR_PK
        )
        AND A.GLBL_CMPY_CD        = B.GLBL_CMPY_CD
        AND A.SVC_MACH_MSTR_PK    = B.SVC_MACH_MSTR_PK
        AND A.SVC_CONFIG_MSTR_PK  = B.SVC_CONFIG_MSTR_PK
        AND B.EZCANCELFLAG        = '0'
        AND B.DS_CONTR_PK         = #dsContrPk#
    </statement>
<!-- END 2018/06/01 T.Tomita [QC#26379, ADD] -->
<!-- START 2018/06/18 T.Tomita [QC#25872, ADD] -->
    <statement id="getOldMachMstrPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            A.OLD_SVC_MACH_MSTR_PK
        FROM
            DS_CONTR_INTFC A
        WHERE
            A.GLBL_CMPY_CD            = #glblCmpyCd#
        AND A.EZCANCELFLAG            = '0'
        AND A.SVC_MACH_MSTR_PK        = #svcMachMstrPk#
        AND A.DS_CONTR_INTFC_BAT_NUM  = #dsContrIntfcBatNum#
        AND A.DS_CONTR_SRC_REF_NUM    = #dsContrSrcRefNum#
        AND A.CONTR_INTFC_SRC_TP_CD   = #contrIntfcSrcTpCd#
        AND A.DS_CONTR_INTFC_ACT_CD   = #dsContrIntfcActCd#
        GROUP BY
            A.OLD_SVC_MACH_MSTR_PK
    </statement>
<!-- END 2018/06/18 T.Tomita [QC#25872, ADD] -->
<!-- START 2018/12/12 [QC#29079, ADD] -->
    <statement id="getOldSubContrMtrList" parameterClass="Map" resultClass="Map">
        SELECT
            DSCM.BLLG_MTR_LB_CD AS BLLG_MTR_LB_CD
           ,DSCM.MTR_ALWNC_CNT  AS MTR_ALWNC_CNT
           ,DSCM.PRC_MTR_RATE   AS PRC_MTR_RATE
        FROM 
            DS_SUB_CONTR_MTR DSCM
        WHERE 
            DSCM.GLBL_CMPY_CD    = #glblCmpyCd#
        AND DSCM.DS_SUB_CONTR_PK = #dsSubContrPk#
        AND DSCM.EZCANCELFLAG    = '0'
        AND EXISTS (
            SELECT
                1
            FROM
                DS_CONTR_BLLG_MTR       DCBM
               ,DS_CONTR_BLLG_MTR_STS_V DCBMS
            WHERE 
                DCBM.GLBL_CMPY_CD           = #glblCmpyCd#
            AND DCBM.DS_CONTR_DTL_PK        = #dsContrDtlPk#
            AND DCBM.BLLG_MTR_LB_CD         = DSCM.BLLG_MTR_LB_CD
            AND DCBM.GLBL_CMPY_CD           = DCBMS.GLBL_CMPY_CD
            AND DCBM.DS_CONTR_BLLG_MTR_PK   = DCBMS.DS_CONTR_BLLG_MTR_PK
            AND DCBMS.DS_CONTR_CTRL_STS_CD  &lt;&gt; #dsContrCtrlStsCd#
            AND DCBM.EZCANCELFLAG           = '0'
            AND DCBMS.EZCANCELFLAG          = '0'
        )
    </statement>
<!-- END 2018/12/12 [QC#29079, ADD] -->
<!-- START 2019/01/15 S.Kitamura [QC#26928, ADD] -->
    <statement id="getPoListForExch" parameterClass="Map" resultClass="Map">
        SELECT
            DCCP.DS_CONTR_PK           AS DS_CONTR_PK
           ,DCCP.DS_CONTR_BLLG_MTR_PK  AS DS_CONTR_BLLG_MTR_PK
           ,DCCP.CUST_PO_NUM           AS CUST_PO_NUM
           ,DCCP.PO_DT                 AS PO_DT
           ,DCCP.LEASE_CMPY_FLG        AS LEASE_CMPY_FLG
           ,DCCP.DS_CONTR_MACH_LVL_NUM AS DS_CONTR_MACH_LVL_NUM
           ,DCCP.CUST_ISS_PO_DT        AS CUST_ISS_PO_DT
           ,DCCP.PO_FROM_DT            AS PO_FROM_DT
        FROM
            DS_CONTR_CR_CARD_PO DCCP
        WHERE 
            DCCP.GLBL_CMPY_CD         = #glblCmpyCd#
        AND DCCP.EZCANCELFLAG         = '0'
        AND DCCP.DS_CONTR_PK          = #oldDsContrPk#
        AND DCCP.DS_CONTR_DTL_PK      = #oldDsContrDtlPk#
        AND DCCP.DS_CONTR_BLLG_MTR_PK IS NULL
        AND DCCP.CR_CARD_FLG          = 'N'
        AND ((DCCP.PO_FROM_DT &lt;= #newMachineFromDt# AND DCCP.PO_DT &gt;= #newMachineFromDt#)
            OR DCCP.PO_FROM_DT &gt; #newMachineFromDt#)
        
        UNION ALL
        
        SELECT
            DCCP.DS_CONTR_PK           AS DS_CONTR_PK
           ,NMTR.DS_CONTR_BLLG_MTR_PK  AS DS_CONTR_BLLG_MTR_PK
           ,DCCP.CUST_PO_NUM           AS CUST_PO_NUM
           ,DCCP.PO_DT                 AS PO_DT
           ,DCCP.LEASE_CMPY_FLG        AS LEASE_CMPY_FLG
           ,DCCP.DS_CONTR_MACH_LVL_NUM AS DS_CONTR_MACH_LVL_NUM
           ,DCCP.CUST_ISS_PO_DT        AS CUST_ISS_PO_DT
           ,DCCP.PO_FROM_DT            AS PO_FROM_DT
        FROM
            DS_CONTR_CR_CARD_PO DCCP
           ,DS_CONTR_BLLG_MTR   OMTR
           ,DS_CONTR_BLLG_MTR   NMTR
        WHERE 
            DCCP.GLBL_CMPY_CD         = #glblCmpyCd#
        AND DCCP.EZCANCELFLAG         = '0'
        AND DCCP.DS_CONTR_PK          = #oldDsContrPk#
        AND DCCP.DS_CONTR_DTL_PK      = #oldDsContrDtlPk#
        AND DCCP.CR_CARD_FLG          = 'N'
        AND ((DCCP.PO_FROM_DT &lt;= #newMachineFromDt# AND DCCP.PO_DT &gt;= #newMachineFromDt#)
            OR DCCP.PO_FROM_DT &gt; #newMachineFromDt#)
        AND OMTR.GLBL_CMPY_CD         = #glblCmpyCd#
        AND OMTR.EZCANCELFLAG         = '0'
        AND OMTR.DS_CONTR_DTL_PK      = DCCP.DS_CONTR_DTL_PK
        AND OMTR.DS_CONTR_BLLG_MTR_PK = DCCP.DS_CONTR_BLLG_MTR_PK
        AND NMTR.GLBL_CMPY_CD         = #glblCmpyCd#
        AND NMTR.EZCANCELFLAG         = '0'
        AND NMTR.DS_CONTR_DTL_PK      = #newDsContrDtlPk#
        AND NMTR.BLLG_MTR_LB_CD       = OMTR.BLLG_MTR_LB_CD
    </statement>
    <statement id="getCrCardListForExch" parameterClass="Map" resultClass="Map">
        SELECT
            DCCP.DS_CONTR_PK           AS DS_CONTR_PK
           ,DCCP.DS_CONTR_BLLG_MTR_PK  AS DS_CONTR_BLLG_MTR_PK
           ,DCCP.CR_CARD_CUST_REF_NUM  AS CR_CARD_CUST_REF_NUM
           ,DCCP.CR_CARD_EXPR_YR_MTH   AS CR_CARD_EXPR_YR_MTH
           ,DCCP.LEASE_CMPY_FLG        AS LEASE_CMPY_FLG
           ,DCCP.DS_CONTR_MACH_LVL_NUM AS DS_CONTR_MACH_LVL_NUM
        FROM
            DS_CONTR_CR_CARD_PO DCCP
        WHERE 
            DCCP.GLBL_CMPY_CD         = #glblCmpyCd#
        AND DCCP.EZCANCELFLAG         = '0'
        AND DCCP.DS_CONTR_PK          = #oldDsContrPk#
        AND DCCP.DS_CONTR_DTL_PK      = #oldDsContrDtlPk#
        AND DCCP.DS_CONTR_BLLG_MTR_PK IS NULL
        AND DCCP.CR_CARD_FLG          = 'Y'

        UNION ALL

        SELECT
            DCCP.DS_CONTR_PK           AS DS_CONTR_PK
           ,NMTR.DS_CONTR_BLLG_MTR_PK  AS DS_CONTR_BLLG_MTR_PK
           ,DCCP.CR_CARD_CUST_REF_NUM  AS CR_CARD_CUST_REF_NUM
           ,DCCP.CR_CARD_EXPR_YR_MTH   AS CR_CARD_EXPR_YR_MTH
           ,DCCP.LEASE_CMPY_FLG        AS LEASE_CMPY_FLG
           ,DCCP.DS_CONTR_MACH_LVL_NUM AS DS_CONTR_MACH_LVL_NUM
        FROM
            DS_CONTR_CR_CARD_PO DCCP
           ,DS_CONTR_BLLG_MTR   OMTR
           ,DS_CONTR_BLLG_MTR   NMTR
        WHERE 
            DCCP.GLBL_CMPY_CD         = #glblCmpyCd#
        AND DCCP.EZCANCELFLAG         = '0'
        AND DCCP.DS_CONTR_PK          = #oldDsContrPk#
        AND DCCP.DS_CONTR_DTL_PK      = #oldDsContrDtlPk#
        AND DCCP.CR_CARD_FLG          = 'Y'
        AND OMTR.GLBL_CMPY_CD         = #glblCmpyCd#
        AND OMTR.EZCANCELFLAG         = '0'
        AND OMTR.DS_CONTR_DTL_PK      = DCCP.DS_CONTR_DTL_PK
        AND OMTR.DS_CONTR_BLLG_MTR_PK = DCCP.DS_CONTR_BLLG_MTR_PK
        AND NMTR.GLBL_CMPY_CD         = #glblCmpyCd#
        AND NMTR.EZCANCELFLAG         = '0'
        AND NMTR.DS_CONTR_DTL_PK      = #newDsContrDtlPk#
        AND NMTR.BLLG_MTR_LB_CD       = OMTR.BLLG_MTR_LB_CD
    </statement>
<!-- END 2019/01/15 S.Kitamura [QC#26928, ADD] -->
<!-- START 2019/04/15  K.Fujimoto [QC#31137/50058, ADD] -->
    <statement id="getSchdList" parameterClass="Map" resultClass="Map">
        SELECT
               DCBS.BLLG_SCHD_THRU_DT
              ,DCBS.BASE_ACTL_PRC_DEAL_AMT
          FROM DS_CONTR_BLLG_SCHD DCBS
         WHERE DCBS.GLBL_CMPY_CD = #glblCmpyCd#
           AND DCBS.EZCANCELFLAG = '0'
           AND DCBS.DS_CONTR_DTL_PK = #dsContrDtlPk#
           AND DCBS.BLLG_SCHD_THRU_DT  &lt; #cloDt#
           AND DCBS.DS_BLLG_SCHD_TP_CD IN (#regular#, #rebill#)
           AND DCBS.DS_CONTR_PRC_EFF_PK IS NOT NULL
           AND DCBS.BASE_CHRG_FLG = 'Y'
     </statement>
     <statement id="getLastSchd" parameterClass="Map" resultClass="Map">
        SELECT
                DCBS.INV_FLG
               ,DCBS.BASE_ACTL_PRC_DEAL_AMT
          FROM DS_CONTR_BLLG_SCHD DCBS
         WHERE DCBS.GLBL_CMPY_CD = #glblCmpyCd#
           AND DCBS.EZCANCELFLAG = '0'
           AND DCBS.DS_CONTR_DTL_PK = #dsContrDtlPk#
           AND DCBS.BLLG_SCHD_FROM_DT  &lt;= #cloDt#
           AND DCBS.BLLG_SCHD_THRU_DT  &gt;= #cloDt#
           AND DCBS.DS_BLLG_SCHD_TP_CD IN (#regular#, #rebill#)
           AND DCBS.DS_CONTR_PRC_EFF_PK IS NOT NULL
           AND DCBS.BASE_CHRG_FLG = 'Y'
     </statement>
     <statement id="getPrcEffCntForExch" parameterClass="Map" resultClass="BigDecimal">
        SELECT
               COUNT(*)
          FROM
               DS_CONTR_PRC_EFF DCPE
         WHERE
               DCPE.GLBL_CMPY_CD = #glblCmpyCd#
           AND DCPE.EZCANCELFLAG = '0'
           AND DCPE.DS_CONTR_DTL_PK = #dsContrDtlPk#
           AND (
                   (
                        DCPE.CONTR_PRC_EFF_FROM_DT  &lt;= #exchDt#
                    AND DCPE.CONTR_PRC_EFF_THRU_DT  &gt;= #exchDt#
                   )
                    OR  DCPE.CONTR_PRC_EFF_FROM_DT  &gt;= #exchDt#
               )
           AND DCPE.DS_CONTR_PRC_EFF_STS_CD &lt;&gt; #canc#
           GROUP BY DCPE.DS_CONTR_BLLG_MTR_PK
           HAVING COUNT(*) > 1
      </statement>
     <statement id="getPrcEffForNoExchAcc" parameterClass="Map" resultClass="Map">
         SELECT
                DCPE.DS_CONTR_PRC_EFF_PK
               ,DCPE.DS_CONTR_PRC_EFF_SQ_NUM
               ,DCPE.CONTR_PRC_EFF_FROM_DT
               ,DCPE.CONTR_PRC_EFF_THRU_DT
               ,DCPE.BLLG_CYCLE_CD
               ,DCPE.BASE_PRC_DEAL_AMT
               ,DCPE.BASE_PRC_TERM_DEAL_AMT_RATE
               ,DCPE.QLTY_ASRN_HLD_FLG
               ,DCPE.MTR_HLD_FLG
               ,DCPE.CONTR_HLD_FLG
               ,DCPE.BLLG_HLD_FLG
               ,DCPE.DS_CONTR_PRC_EFF_STS_CD
               ,DCPE.QLTY_ASRN_HLD_PEND_APVL_FLG
          FROM 
                DS_CONTR_PRC_EFF DCPE
          WHERE
                DCPE.GLBL_CMPY_CD = #glblCmpyCd#
            AND DCPE.EZCANCELFLAG = '0'
            AND DCPE.DS_CONTR_DTL_PK = #dsContrDtlPk#
            AND DCPE.BASE_CHRG_FLG = 'Y'
            AND (
                    (
                        DCPE.CONTR_PRC_EFF_FROM_DT &lt;= #exchDt#
                    AND DCPE.CONTR_PRC_EFF_THRU_DT &gt;= #exchDt#
                    )
                    OR DCPE.CONTR_PRC_EFF_FROM_DT &gt; #exchDt#
                )
           AND DCPE.DS_CONTR_PRC_EFF_STS_CD &lt;&gt; #canc#
          ORDER BY DCPE.DS_CONTR_PRC_EFF_SQ_NUM
    </statement>
<!-- END   2019/04/15 K.Fujimoto [QC#31137/50058, ADD] -->
<!-- START 2019/12/17 [QC#54974, ADD] -->
    <statement id="getBilledAmtAfterTrmnDt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            NVL(SUM(A.BASE_ACTL_PRC_DEAL_AMT), 0)
        FROM
            DS_CONTR_BLLG_SCHD A
        WHERE
                A.GLBL_CMPY_CD         = #glblCmpyCd#
            AND A.DS_CONTR_DTL_PK      = #dsContrDtlPk#
            AND A.BASE_CHRG_FLG        = 'Y'
            AND A.BLLG_SCHD_FROM_DT    &gt; #bllgSchdThruDt#
            AND A.INV_FLG              = 'Y'
            AND A.INV_TP_CD            = #invoice#
            AND A.DS_CONTR_PRC_EFF_PK  IS NOT NULL
            AND A.SVC_INV_NUM          IS NOT NULL
            AND A.EZCANCELFLAG         = '0'
    </statement>
<!-- END   2019/12/17 [QC#54974, ADD] -->
<!-- START 2022/07/14 R.Jin [QC#60276, ADD] -->
    <statement id="getAGGAndContrCloDtNullDtlCnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            DS_CONTR_DTL A
        WHERE
            A.GLBL_CMPY_CD           = #glblCmpyCd#
            AND A.DS_CONTR_PK        = #dsContrPk#
            AND A.EZCANCELFLAG       = '0'
            <iterate property="dsContrDtlPkList" var="dsContrDtlPk[]"  open="AND A.DS_CONTR_DTL_PK NOT IN  (" close=" )" conjunction=",">
                #dsContrDtlPk[]#
            </iterate>
            AND A.DS_CONTR_DTL_TP_CD != #dsContrDtlTpCd#
            AND A.CONTR_CLO_DT IS NULL 
            AND A.DS_CONTR_DTL_STS_CD  NOT IN (#cancelled#,#terminated#,#expired#)
            <!-- START 2023/02/13 R.Jin [QC#61172, ADD] -->
            AND A.DS_CONTR_DTL_TP_CD &lt;&gt; #shell#
            <!-- END 2023/02/13 R.Jin [QC#61172, ADD] -->
    </statement>
    <statement id="getMaxCloDt" parameterClass="Map" resultClass="String">
        SELECT
            MAX(CONTR_CLO_DT)
        FROM
            DS_CONTR_DTL A
        WHERE
            A.GLBL_CMPY_CD      = #glblCmpyCd#
            AND A.DS_CONTR_PK   = #dsContrPk#
            AND A.EZCANCELFLAG  = '0'
    </statement>
<!-- END 2022/07/14 R.Jin [QC#60276, ADD] -->
<!-- START 2023/02/16 K.Watanabe [QC#60913, ADD] -->
    <statement id="getSvcPkgMap" parameterClass="Map" resultClass="Map">
        SELECT
             C.PRC_MTR_PKG_PK
            ,C.PRC_MTR_PKG_NM
        FROM
            (
                SELECT
                     B.PRC_MTR_PKG_PK
                    ,B.PRC_MTR_PKG_NM
                    ,A.EFF_FROM_DT          AS PKG_MDL_EFF_FROM_DT
                    ,CASE
                        WHEN A.EFF_THRU_DT IS NOT NULL
                            THEN A.EFF_THRU_DT
                            ELSE #endDt#
                     END                    AS PKG_MDL_EFF_THRU_DT
                    ,B.EFF_FROM_DT          AS PKG_EFF_FROM_DT
                    ,CASE
                        WHEN B.EFF_THRU_DT IS NOT NULL
                            THEN B.EFF_THRU_DT
                            ELSE #endDt#
                     END                    AS PKG_EFF_THRU_DT
                FROM
                     PRC_MTR_PKG_MDL A
                    ,PRC_MTR_PKG     B
                WHERE 
                        A.GLBL_CMPY_CD   =  #glblCmpyCd#
                    AND A.MDL_ID         =  #mdlId#
                    AND A.EZCANCELFLAG   = '0'
                    AND A.GLBL_CMPY_CD   =  B.GLBL_CMPY_CD
                    AND A.PRC_MTR_PKG_PK =  B.PRC_MTR_PKG_PK
                    AND B.EZCANCELFLAG   = '0'
            ) C
        WHERE
                C.PKG_MDL_EFF_FROM_DT   &lt;= #slsDt#
            AND C.PKG_MDL_EFF_THRU_DT   &gt;= #slsDt#
            AND C.PKG_EFF_FROM_DT       &lt;= #slsDt#
            AND C.PKG_EFF_THRU_DT       &gt;= #slsDt#
        ORDER BY
            C.PRC_MTR_PKG_PK

    </statement>
<!-- END 2023/02/16 K.Watanabe [QC#60913, MOD] -->

    <!-- START 2023/09/04 t.aizawa [QC#60739, ADD] -->
    <statement id="getAddContrIstlDt" parameterClass="Map" resultClass="String">
        SELECT
            MAX(SMM.ISTL_DT) AS ISTL_DT
        FROM
             DS_CONTR_INTFC DCI1
            ,DS_CONTR_INTFC DCI2
            ,SVC_MACH_MSTR  SMM
        WHERE
                DCI1.GLBL_CMPY_CD               = #glblCmpyCd#
            AND DCI1.EZCANCELFLAG               = '0'
            AND DCI1.DS_CONTR_INTFC_BAT_NUM     = #dsContrIntfcBatNum#
            AND DCI1.DS_CONTR_SRC_REF_NUM       = #dsContrSrcRefNum#
            AND DCI1.CONTR_INTFC_SRC_TP_CD      = #contrIntfcSrcTpCd#
            AND DCI1.DS_CONTR_INTFC_ACT_CD      = #trmdActCd#
            AND DCI1.SVC_MACH_MSTR_PK           = #svcMachMstrPk#
            AND DCI1.GLBL_CMPY_CD               = DCI2.GLBL_CMPY_CD
            AND DCI1.DS_CONTR_SRC_REF_NUM       = DCI2.DS_CONTR_SRC_REF_NUM
            AND DCI1.CONTR_INTFC_SRC_TP_CD      = DCI2.CONTR_INTFC_SRC_TP_CD
            AND DCI1.SVC_MACH_MSTR_PK           = DCI2.OLD_SVC_MACH_MSTR_PK
            AND DCI1.CONTR_INTFC_DTL_TP_CD      = DCI2.CONTR_INTFC_DTL_TP_CD
            AND DCI2.EZCANCELFLAG               = '0'
            AND DCI2.DS_CONTR_INTFC_ACT_CD      = #addContrActCd#
            AND DCI2.GLBL_CMPY_CD               = SMM.GLBL_CMPY_CD
            AND DCI2.SVC_MACH_MSTR_PK           = SMM.SVC_MACH_MSTR_PK
            AND SMM.EZCANCELFLAG                = '0'
    </statement>
    <statement id="getTrmdIntfcContrCloDt" parameterClass="Map" resultClass="String">
        SELECT
            MAX(DCI2.CONTR_CLO_DT) AS CONTR_CLO_DT
        FROM
             DS_CONTR_INTFC DCI1
            ,DS_CONTR_INTFC DCI2
        WHERE
                DCI1.GLBL_CMPY_CD               = #glblCmpyCd#
            AND DCI1.EZCANCELFLAG               = '0'
            AND DCI1.DS_CONTR_INTFC_BAT_NUM     = #dsContrIntfcBatNum#
            AND DCI1.DS_CONTR_SRC_REF_NUM       = #dsContrSrcRefNum#
            AND DCI1.CONTR_INTFC_SRC_TP_CD      = #contrIntfcSrcTpCd#
            AND DCI1.DS_CONTR_INTFC_ACT_CD      = #addContrActCd#
            AND DCI1.SVC_MACH_MSTR_PK           = #svcMachMstrPk#
            AND DCI1.GLBL_CMPY_CD               = DCI2.GLBL_CMPY_CD
            AND DCI1.DS_CONTR_SRC_REF_NUM       = DCI2.DS_CONTR_SRC_REF_NUM
            AND DCI1.CONTR_INTFC_SRC_TP_CD      = DCI2.CONTR_INTFC_SRC_TP_CD
            AND DCI1.OLD_SVC_MACH_MSTR_PK       = DCI2.SVC_MACH_MSTR_PK
            AND DCI1.CONTR_INTFC_DTL_TP_CD      = DCI2.CONTR_INTFC_DTL_TP_CD
            AND DCI2.EZCANCELFLAG               = '0'
            AND DCI2.DS_CONTR_INTFC_ACT_CD      = #trmdActCd#
    </statement>
    <!-- END   2023/09/04 t.aizawa [QC#60739, ADD] -->

</sqlMap>