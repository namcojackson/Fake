<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NFAB008001">

<!-- #################### Type Alias #################### -->

<!-- #################### Statement #################### -->

   	<statement id="getIntfcTrxPtrn" parameterClass="Map" resultClass="Map">
        SELECT ATI.SYS_SRC_CD AS SYS_SRC_CD,
               ATI.TRX_CD     AS TRX_CD,         
               ATI.TRX_RSN_CD AS TRX_RSN_CD
          FROM AJE_ASSET_TRX_INTFC ATI
         WHERE ATI.EZCANCELFLAG = '0'
           AND ATI.GLBL_CMPY_CD = #glblCmpyCd#
           AND NOT EXISTS (
                           SELECT '*'
                             FROM AJE_INTFC_CTRL      AIC
                            WHERE AIC.EZCANCELFLAG    = '0'
                              AND AIC.GLBL_CMPY_CD    = #glblCmpyCd#
                              AND AIC.AJE_INTFC_TP_CD = #ajeIntfcTpCd#
                              AND AIC.JRNL_CPLT_FLG   = #jrnlCpltFlg#
                              AND AIC.GLBL_CMPY_CD    = ATI.GLBL_CMPY_CD
                              AND AIC.AJE_INTFC_PK    = ATI.AJE_ASSET_TRX_INTFC_PK
                          )
         GROUP BY ATI.SYS_SRC_CD,
                  ATI.TRX_CD,         
                  ATI.TRX_RSN_CD
         ORDER BY ATI.TRX_CD,         
                  ATI.TRX_RSN_CD,
                  ATI.SYS_SRC_CD
    </statement>

    <statement id="getAjeIntfcNotJrnlized" parameterClass="Map" resultClass="Map">
        SELECT ATI.GLBL_CMPY_CD           AS GLBL_CMPY_CD,
               ATI.AJE_ASSET_TRX_INTFC_PK  AS AJE_ASSET_TRX_INTFC_PK,
               ATI.DS_ASSET_TRX_PK         AS DS_ASSET_TRX_PK,
               ATI.GL_DT                   AS GL_DT,
               ATI.SYS_SRC_CD              AS SYS_SRC_CD,
               SS.SYS_SRC_NM               AS SYS_SRC_NM,
               ATI.TRX_CD                  AS TRX_CD,
               TRX.TRX_NM                  AS TRX_NM,
               ATI.TRX_RSN_CD              AS TRX_RSN_CD,
               TRX_RSN.TRX_RSN_NM          AS TRX_RSN_NM,
               ATI.ASSET_TP_CD             AS ASSET_TP_CD,
               ATI.BILL_TO_CUST_CD         AS BILL_TO_CUST_CD,
               ATI.MDSE_CD                 AS MDSE_CD,
               MDSE.MDSE_NM                AS MDSE_NM,
               ATI.TOC_CD                  AS TOC_CD,
               ATI.INV_QTY                 AS INV_QTY,
               ATI.SER_NUM                 AS SER_NUM,
               NVL(ATI.ORIG_VAL_AMT, 0)    AS ORIG_VAL_AMT,
               NVL(ATI.CUR_VAL_AMT, 0)     AS CUR_VAL_AMT,
               NVL(ATI.CUR_DEPC_AMT, 0)    AS CUR_DEPC_AMT,
               ATI.AJE_INTFC_CMNT_TXT      AS AJE_INTFC_CMNT_TXT,
               #invtyIndTp#                AS INV_INVTY_IND_TP_CD,
               ATI.AJE_INV_NUM             AS INV_NUM
               <!-- start add 2016/06/24 -->
               ,ATI.PRNT_DS_ASSET_MSTR_PK  AS PRNT_DS_ASSET_MSTR_PK
               <!-- end 2016/06/24 -->
               
               -- CSA_NEW
              ,NVL(ATI.ASSET_ADJ_AMT, 0)   AS ASSET_ADJ_AMT
              ,ATI.SELL_TO_CUST_CD         AS SELL_TO_CUST_CD
              ,ATI.SHIP_TO_CUST_CD         AS SHIP_TO_CUST_CD 
              ,ATI.SLD_TO_CUST_LOC_CD      AS SLD_TO_CUST_LOC_CD
              ,ATI.SHIP_TO_CUST_ACCT_CD    AS SHIP_TO_CUST_ACCT_CD
              ,ATI.VND_CD                  AS VND_CD
              ,ATI.CPO_ORD_NUM             AS CPO_ORD_NUM
              ,ATI.PO_ORD_NUM              AS PO_ORD_NUM
              ,ATI.SVC_MACH_MSTR_PK        AS SVC_MACH_MSTR_PK
              ,ATI.RTRN_WH_CD              AS RTRN_WH_CD
               
               -- LINK
              ,ATI.COA_CMPY_CD             AS "LINK_CMPY_CD"
              ,ATI.COA_ACCT_CD             AS "LINK_ACCT_CD"
              ,ATI.COA_BR_CD               AS "LINK_BR_CD"
              ,ATI.COA_CC_CD               AS "LINK_CC_CD"
              ,ATI.COA_PROD_CD             AS "LINK_PROD_CD"
              ,ATI.COA_CH_CD               AS "LINK_CH_CD"
              ,ATI.COA_AFFL_CD             AS "LINK_AFFL_CD"
              ,ATI.COA_PROJ_CD             AS "LINK_PROJ_CD"
              ,ATI.COA_EXTN_CD             AS "LINK_EXTN_CD"
              
               -- at TOC
              ,ORG.COA_BR_CD               AS "TOC_BR_CD"
              ,ORG.COA_CC_CD               AS "TOC_CC_CD"
              ,ORG.COA_CH_CD               AS "TOC_CH_CD"
              ,ORG.COA_EXTN_CD             AS "TOC_EXTN_CD"
              ,ORG.COA_PROD_CD             AS "TOC_PROD_CD"
              
               -- at ITEM
              ,MDSE.COA_PROD_CD            AS "ITEM_PROD_CD" 
              ,MDSE.REV_COA_ACCT_CD        AS "ITEM-REV_ACCT_CD"
              ,MDSE.COGS_COA_ACCT_CD       AS "ITEM-COS_ACCT_CD"
              ,MDSE.EXP_COA_ACCT_CD        AS "ITEM-EXP_ACCT_CD"
              ,MDSE.COA_MDSE_TP_CD         AS "ITEM_PROJ_CD"
              ,MDSE.COA_CC_CD              AS "ITEM_CC_CD"
              ,MDSE.INVTY_COA_ACCT_CD      AS "ITEM-INV_ACCT_CD"
              ,MDSE.ACRL_COA_ACCT_CD       AS "ITEM-ACRL_ACCT_CD"
              
              <!-- start 2018/06/12 mod QC#26288 -->
              <!-- start 2018/08/30 mod QC#27627 -->
              -- at CUST-ACCT
              ,NVL(STC.COA_CMPY_CD, STC2.COA_CMPY_CD)   AS "CUST-ACCT_CMPY_CD"
              ,NVL(STC.COA_BR_CD, STC2.COA_BR_CD)       AS "CUST-ACCT_BR_CD"
              ,NVL(STC.COA_CC_CD, STC2.COA_CC_CD)       AS "CUST-ACCT_CC_CD"
              ,NVL(STC.COA_ACCT_CD, STC2.COA_ACCT_CD)   AS "CUST-ACCT_ACCT_CD"
              ,NVL(STC.COA_CH_CD, STC2.COA_CH_CD)       AS "CUST-ACCT_CH_CD"
              ,NVL(STC.COA_PROD_CD, STC2.COA_PROD_CD)   AS "CUST-ACCT_PROD_CD"
              ,NVL(STC.COA_AFFL_CD, STC2.COA_AFFL_CD)   AS "CUST-ACCT_AFFL_CD"
              ,NVL(STC.COA_PROJ_CD, STC2.COA_PROJ_CD)   AS "CUST-ACCT_PROJ_CD"
              ,NVL(STC.COA_EXTN_CD, STC2.COA_EXTN_CD)   AS "CUST-ACCT_EXTN_CD"
              <!-- end 2018/08/30 mod QC#27627 -->
              
              -- at SELL-CUST
              ,AC.COA_CMPY_CD              AS "SELL-CUST_CMPY_CD"
              ,AC.COA_BR_CD                AS "SELL-CUST_BR_CD"
              ,AC.COA_CC_CD                AS "SELL-CUST_CC_CD"
              ,AC.COA_ACCT_CD              AS "SELL-CUST_ACCT_CD"
              ,AC.COA_CH_CD                AS "SELL-CUST_CH_CD"
              ,AC.COA_PROD_CD              AS "SELL-CUST_PROD_CD"
              ,AC.COA_AFFL_CD              AS "SELL-CUST_AFFL_CD"
              ,AC.COA_PROJ_CD              AS "SELL-CUST_PROJ_CD"
              ,AC.COA_EXTN_CD              AS "SELL-CUST_EXTN_CD"
              
              -- at SELL-SITE
              ,NVL(BTC2.COA_CH_CD, AC.COA_CH_CD)     AS "SELL-SITE_CH_CD"
              ,NVL(BTC2.COA_AFFL_CD, AC.COA_AFFL_CD) AS "SELL-SITE_AFFL_CD"
              <!-- end 2018/06/12 mod QC#26288 -->
              <!-- start 2018/08/30 mod QC#27627 -->
              <!-- start 2016/09/12 add QC#13561 -->
              ,NVL(BTC.COA_CH_CD, NVL(STC.COA_CH_CD, STC2.COA_CH_CD))       AS "CUST-SITE_CH_CD"
              ,NVL(BTC.COA_AFFL_CD, NVL(STC.COA_AFFL_CD, STC2.COA_AFFL_CD)) AS "CUST-SITE_AFFL_CD"
              <!-- end 2016/09/12 add QC#13561 -->
              <!-- end 2018/08/30 mod QC#27627 -->
              -- at AT
              ,ABC.ASSET_COA_ACCT_CD          AS "AT-ASSET_ACCT_CD"
              ,ABC.DEPC_COA_ACCT_CD           AS "AT-DEPR_EXP_ACCT_CD"
              ,ABC.ACCUM_DEPC_COA_ACCT_CD     AS "AT-ACCUM_DEPR_ACCT_CD"
              ,ABC.DEPC_ADJ_COA_ACCT_CD       AS "AT-DEPR_ADJ_ACCT_CD"
              ,ABC.SLS_PRCD_COA_ACCT_CD       AS "AT-SLS_PROC_ACCT_CD"
              ,ABC.RMV_COST_COA_ACCT_CD       AS "AT-RMV_COST_ACCT_CD"
              ,ABC.GAIN_LOSS_COA_ACCT_CD      AS "AT-GAIN_LOSS_ACCT_CD"
              ,ABC.CLING_COA_ACCT_CD          AS "AT-CLING_ACCT_CD"
              ,ABC.ADJ_COA_ACCT_CD            AS "AT-ADJ_ACCT_CD"
              
              -- at NEWCORE
              ,(CASE WHEN CB.COA_BR_TP_CD = #newcore# THEN ORG.COA_BR_CD
                     ELSE #defBrNewcore# END) AS "NEWCORE_BR_CD"
              ,(CASE WHEN CB.COA_BR_TP_CD = #newcore# THEN ORG.COA_CC_CD
                     WHEN ATI.CPO_ORD_NUM IS NULL     THEN LBT3.ASSET_COA_CC_CD
                     ELSE NVL(LBT1.ASSET_COA_CC_CD, LBT2.ASSET_COA_CC_CD) END) AS "NEWCORE_CC_CD"
               -- at MACH
              ,MDSS.COA_PROD_CD            AS "MACH_PROD_CD" 
              ,MDSS.REV_COA_ACCT_CD        AS "MACH-REV_ACCT_CD"
              ,MDSS.COGS_COA_ACCT_CD       AS "MACH-COS_ACCT_CD"
              ,MDSS.EXP_COA_ACCT_CD        AS "MACH-EXP_ACCT_CD"
              ,MDSS.COA_MDSE_TP_CD         AS "MACH_PROJ_CD"
              ,MDSS.COA_CC_CD              AS "MACH_CC_CD"
              ,MDSS.INVTY_COA_ACCT_CD      AS "MACH-INV_ACCT_CD"
              ,MDSS.ACRL_COA_ACCT_CD       AS "MACH-ACRL_ACCT_CD"
              ,(CASE WHEN ATI.ASSET_TP_CD = #assetTpE# AND ATI.SVC_MACH_MSTR_PK IS NULL THEN #assetTpEmsdPo#
                     WHEN ATI.ASSET_TP_CD = #assetTpE# AND ATI.SVC_MACH_MSTR_PK IS NOT NULL THEN #assetTpEmsdOrd#
                     ELSE #assetTpRe#  END) AS "AJE_ASSET_TP_CD"
              <!-- START 2019/08/10 S.Takami [QC#51897,ADD] -->
              ,SMM.SVC_CONFIG_MSTR_PK      AS "SVC_CONFIG_MSTR_PK"
              <!-- END 2019/08/10 S.Takami [QC#51897,ADD] -->

          FROM AJE_ASSET_TRX_INTFC  ATI,
               SYS_SRC              SS,
               TRX                  TRX,
               TRX_RSN              TRX_RSN,
               MDSE_DLY_SNAP_SHOT   MDSE,
               TOC_DLY_SNAP_SHOT    ORG,
               SELL_TO_CUST         AC,
               ASSET_BOOK_CTRL      ABC,
               COA_BR               CB,
               COA_CC               CC,
               <!-- start 2016/09/12 add QC#13561 -->
               BILL_TO_CUST         BTC,
               <!-- end 2016/09/12 add QC#13561 -->
               DS_ASSET_MSTR        DAM,
               MDSE_DLY_SNAP_SHOT   MDSS,
               CPO                  C,
               DS_ORD_TP_PROC_DFN   OTP,
               LINE_BIZ_TP          LBT1,
               SVC_MACH_MSTR        SMM,
               LINE_BIZ_TP          LBT2,
               LINE_BIZ_TP          LBT3,
               COA_LINE_BIZ_TP      CLBT,
               <!-- start 2018/06/12 add QC#26288 -->
               SELL_TO_CUST         STC,
               BILL_TO_CUST         BTC2,
               <!-- end 2018/06/12 add QC#26288 -->
               <!-- start 2018/08/30 add QC#27627 -->
               SELL_TO_CUST         STC2
               <!-- end 2018/08/30 add QC#27627 -->

         WHERE ATI.EZCANCELFLAG     = '0'
           AND SS.EZCANCELFLAG      = '0'
           AND TRX.EZCANCELFLAG     = '0'
           AND TRX_RSN.EZCANCELFLAG = '0'
           AND (MDSE.EZCANCELFLAG   = '0'  OR MDSE.EZCANCELFLAG IS NULL)
           AND (ORG.EZCANCELFLAG    = '0'  OR ORG.EZCANCELFLAG  IS NULL)
           AND (AC.EZCANCELFLAG     = '0'  OR AC.EZCANCELFLAG  IS NULL)
           AND (ABC.EZCANCELFLAG    = '0'  OR ABC.EZCANCELFLAG  IS NULL)
           AND (CB.EZCANCELFLAG     = '0'  OR CB.EZCANCELFLAG  IS NULL)
           AND ATI.GLBL_CMPY_CD     = #glblCmpyCd#
           AND ATI.GLBL_CMPY_CD     = SS.GLBL_CMPY_CD
           AND ATI.SYS_SRC_CD       = SS.SYS_SRC_CD
           AND TRX.GLBL_CMPY_CD     = TRX_RSN.GLBL_CMPY_CD
           AND TRX.TRX_CD           = TRX_RSN.TRX_CD
           AND ATI.GLBL_CMPY_CD     = TRX.GLBL_CMPY_CD
           AND ATI.TRX_CD           = TRX.TRX_CD
           AND ATI.GLBL_CMPY_CD     = TRX_RSN.GLBL_CMPY_CD
           AND ATI.TRX_RSN_CD       = TRX_RSN.TRX_RSN_CD
           AND ATI.GLBL_CMPY_CD     = MDSE.GLBL_CMPY_CD(+)
           AND ATI.MDSE_CD          = MDSE.MDSE_CD(+)
           AND ATI.GLBL_CMPY_CD     = ORG.GLBL_CMPY_CD(+)
           AND ATI.TOC_CD           = ORG.TOC_CD(+)
           AND ATI.GLBL_CMPY_CD     = AC.GLBL_CMPY_CD(+)
           AND ATI.SELL_TO_CUST_CD  = AC.SELL_TO_CUST_CD(+)
           AND ATI.GLBL_CMPY_CD     = ABC.GLBL_CMPY_CD(+)
           AND ATI.ASSET_TP_CD      = ABC.ASSET_TP_CD(+)
           AND ABC.EFF_FROM_DT      &lt;= #batProcDt#
           AND NVL(ABC.EFF_THRU_DT, '99991231') &gt;= #batProcDt#
           AND ORG.GLBL_CMPY_CD     = CB.GLBL_CMPY_CD(+)
           AND ORG.COA_BR_CD        = CB.COA_BR_CD(+)
           AND MDSE.LTST_REC_FLG(+) = #flgY#
           <!-- start 2016/09/12 add QC#13561 -->
           AND ATI.EZCANCELFLAG     = BTC.EZCANCELFLAG(+)
           AND ATI.GLBL_CMPY_CD     = BTC.GLBL_CMPY_CD(+)
           AND ATI.BILL_TO_CUST_CD  = BTC.BILL_TO_CUST_CD(+)
           <!-- end 2016/09/12 add QC#13561 -->
           AND ATI.GLBL_CMPY_CD          = DAM.GLBL_CMPY_CD
           AND ATI.PRNT_DS_ASSET_MSTR_PK = DAM.DS_ASSET_MSTR_PK
           AND DAM.EZCANCELFLAG          = '0'
           AND DAM.GLBL_CMPY_CD          = MDSS.GLBL_CMPY_CD(+)
           AND DAM.MDSE_CD               = MDSS.MDSE_CD(+)
           AND MDSS.LTST_REC_FLG(+)      = #flgY#
           AND MDSS.EZCANCELFLAG(+)      = '0'
           AND ATI.GLBL_CMPY_CD          = C.GLBL_CMPY_CD(+)
           AND ATI.CPO_ORD_NUM           = C.CPO_ORD_NUM(+)
           AND C.EZCANCELFLAG(+)         = '0'
           AND C.GLBL_CMPY_CD            = OTP.GLBL_CMPY_CD(+)
           AND C.DS_ORD_TP_CD            = OTP.DS_ORD_TP_CD(+)
           <!-- start 2018/06/12 add QC#26288 -->
           AND C.EZCANCELFLAG            = STC.EZCANCELFLAG(+)
           AND C.GLBL_CMPY_CD            = STC.GLBL_CMPY_CD(+)
           AND C.BILL_TO_CUST_ACCT_CD    = STC.SELL_TO_CUST_CD(+)
           AND ATI.EZCANCELFLAG          = BTC2.EZCANCELFLAG(+)
           AND ATI.GLBL_CMPY_CD          = BTC2.GLBL_CMPY_CD(+)
           AND ATI.SLD_TO_CUST_LOC_CD    = BTC2.BILL_TO_CUST_CD(+)
           <!-- start 2018/06/12 add QC#26288 -->
           AND OTP.EZCANCELFLAG(+)       = '0'
           AND OTP.GLBL_CMPY_CD          = LBT1.GLBL_CMPY_CD(+)
           AND OTP.LINE_BIZ_TP_CD        = LBT1.LINE_BIZ_TP_CD(+)
           AND LBT1.EZCANCELFLAG(+)      = '0'
           AND ATI.GLBL_CMPY_CD          = SMM.GLBL_CMPY_CD(+)
           AND ATI.SVC_MACH_MSTR_PK      = SMM.SVC_MACH_MSTR_PK(+)
           AND SMM.EZCANCELFLAG(+)       = '0'
           AND SMM.GLBL_CMPY_CD          = LBT2.GLBL_CMPY_CD(+)
           AND SMM.SVC_BY_LINE_BIZ_TP_CD = LBT2.LINE_BIZ_TP_CD(+)
           AND LBT2.EZCANCELFLAG(+)      = '0'
           <!-- start 2018/08/30 add QC#27627 -->
           AND SMM.GLBL_CMPY_CD          = STC2.GLBL_CMPY_CD(+)
           AND SMM.BILL_TO_ACCT_NUM      = STC2.SELL_TO_CUST_CD(+)
           AND STC2.EZCANCELFLAG(+)      = '0'
           <!-- end 2018/08/30 add QC#27627 -->
           AND ORG.GLBL_CMPY_CD          = CC.GLBL_CMPY_CD(+)
           AND ORG.COA_CC_CD             = CC.COA_CC_CD(+)
           AND CC.EZCANCELFLAG(+)        = '0'
           AND CC.GLBL_CMPY_CD           = CLBT.GLBL_CMPY_CD(+)
           AND CC.COA_LINE_BIZ_TP_CD     = CLBT.COA_LINE_BIZ_TP_CD(+)
           AND CLBT.EZCANCELFLAG(+)      = '0'
           AND CLBT.GLBL_CMPY_CD         = LBT3.GLBL_CMPY_CD(+)
           AND CLBT.COA_LINE_BIZ_TP_NM   = LBT3.LINE_BIZ_TP_CD(+)
           AND LBT3.EZCANCELFLAG(+)      = '0'
           AND NOT EXISTS (
                           SELECT '*'
                             FROM AJE_INTFC_CTRL      AIC
                            WHERE AIC.EZCANCELFLAG    = '0'
                              AND AIC.GLBL_CMPY_CD    = #glblCmpyCd#
                              AND AIC.AJE_INTFC_TP_CD = #ajeIntfcTpCd#
                              AND AIC.JRNL_CPLT_FLG   = #jrnlCpltFlg#
                              AND AIC.GLBL_CMPY_CD    = ATI.GLBL_CMPY_CD
                              AND AIC.AJE_INTFC_PK    = ATI.AJE_ASSET_TRX_INTFC_PK
                          )
    ORDER BY ATI.AJE_ASSET_TRX_INTFC_PK
    </statement>
    
    <statement id="back_getAjeIntfcNotJrnlized" parameterClass="Map" resultClass="Map">
        SELECT W1.*,
               DPC.COA_BR_CD                AS COA_BR_CD_DPC,
               DPC.COA_CC_CD                AS COA_CC_CD_DPC,
               DPC.COA_CH_CD                AS COA_CH_CD_DPC,
               DPAC1.COA_CH_CD              AS CH_PTRN_CUST,
               DPAC2.COA_CH_CD              AS CH_ITEM_CUST,
               DPAC3.COA_CH_CD              AS CH_ITEM_PTRN,
               NVL(CSPP.COA_CC_CD, CSPP_ANY.COA_CC_CD)  AS COA_CC_CD_PR,
               NVL(CSPP.COA_CH_CD, CSPP_ANY.COA_CH_CD)  AS COA_CH_CD_PR
         FROM
        (SELECT ATI.GLBL_CMPY_CD           AS GLBL_CMPY_CD,
               ATI.AJE_ASSET_TRX_INTFC_PK  AS AJE_ASSET_TRX_INTFC_PK,
               ATI.GL_DT                   AS GL_DT,
               ATI.SYS_SRC_CD              AS SYS_SRC_CD,
               SS.SYS_SRC_NM               AS SYS_SRC_NM,
               ATI.TRX_CD                  AS TRX_CD,
               TRX.TRX_NM                  AS TRX_NM,
               ATI.TRX_RSN_CD              AS TRX_RSN_CD,
               TRX_RSN.TRX_RSN_NM          AS TRX_RSN_NM,
               ATI.ASSET_TP_CD             AS ASSET_TP_CD,
               ATI.BILL_TO_CUST_CD         AS BILL_TO_CUST_CD,
               BTC.COA_AFFL_CD             AS COA_AFFL_CD,
               BTC.COA_CH_CD               AS COA_CH_CD_CUST,
               ATI.MDSE_CD                 AS MDSE_CD,
               MDSE.MDSE_NM                AS MDSE_NM,
               NVL(MDSE.COA_PROD_CD, #prodCdZZ#) AS COA_PROD_CD_MDSE, 
               ORG.COA_PROD_CD             AS COA_PROD_CD_ORG,
               ATI.TOC_CD                  AS TOC_CD,
               ORG.COA_BR_CD               AS COA_BR_CD,
               ORG.COA_CC_CD               AS COA_CC_CD,
               ORG.COA_CH_CD               AS COA_CH_CD,
               ATI.INV_QTY                 AS INV_QTY,
               ATI.SER_NUM                 AS SER_NUM,
               ATI.ORIG_VAL_AMT            AS ORIG_VAL_AMT,
               ATI.CUR_VAL_AMT             AS CUR_VAL_AMT,
               ATI.CUR_DEPC_AMT            AS CUR_DEPC_AMT,
               ATI.AJE_INTFC_CMNT_TXT      AS AJE_INTFC_CMNT_TXT,
               #invtyIndTp#                AS INV_INVTY_IND_TP_CD,
               MDSE.FIRST_PROD_CTRL_CD     AS FIRST_PROD_CTRL_CD,
               ORG.FRTH_ORG_CD             AS FRTH_ORG_CD,
               ATI.AJE_INV_NUM             AS INV_NUM,
               ATI.COA_ACCT_CD             AS COA_ACCT_CD,
               ATI.COA_BR_CD               AS COA_BR_CD_LINK,
               ATI.COA_CC_CD               AS COA_CC_CD_LINK,
               ATI.COA_PROD_CD             AS COA_PROD_CD_LINK,
               ATI.COA_CH_CD               AS COA_CH_CD_LINK,
               NVL(ATI.COA_PROJ_CD, #proj0000#)  AS COA_PROJ_CD_LINK
          FROM AJE_ASSET_TRX_INTFC  ATI,
               SYS_SRC              SS,
               TRX                  TRX,
               TRX_RSN              TRX_RSN,
               MDSE_DLY_SNAP_SHOT   MDSE,
               TOC_DLY_SNAP_SHOT    ORG,
               CUST_DLY_SNAP_SHOT   BTC
         WHERE ATI.EZCANCELFLAG     = '0'
           AND SS.EZCANCELFLAG      = '0'
           AND TRX.EZCANCELFLAG     = '0'
           AND TRX_RSN.EZCANCELFLAG = '0'
           AND (MDSE.EZCANCELFLAG   = '0'  OR MDSE.EZCANCELFLAG IS NULL)
           AND (ORG.EZCANCELFLAG    = '0'  OR ORG.EZCANCELFLAG  IS NULL)
           AND (BTC.EZCANCELFLAG    = '0'  OR BTC.EZCANCELFLAG  IS NULL)
           AND ATI.GLBL_CMPY_CD     = #glblCmpyCd#
           AND ATI.GLBL_CMPY_CD     = SS.GLBL_CMPY_CD
           AND ATI.SYS_SRC_CD       = SS.SYS_SRC_CD
           AND TRX.GLBL_CMPY_CD     = TRX_RSN.GLBL_CMPY_CD
           AND TRX.TRX_CD           = TRX_RSN.TRX_CD
           AND ATI.GLBL_CMPY_CD     = TRX.GLBL_CMPY_CD
           AND ATI.TRX_CD           = TRX.TRX_CD
           AND ATI.GLBL_CMPY_CD     = TRX_RSN.GLBL_CMPY_CD
           AND ATI.TRX_RSN_CD       = TRX_RSN.TRX_RSN_CD
           AND ATI.GLBL_CMPY_CD     = MDSE.GLBL_CMPY_CD(+)
           AND ATI.MDSE_CD          = MDSE.MDSE_CD(+)
           AND ATI.GLBL_CMPY_CD     = ORG.GLBL_CMPY_CD(+)
           AND ATI.TOC_CD           = ORG.TOC_CD(+)
           AND ATI.GLBL_CMPY_CD     = BTC.GLBL_CMPY_CD(+)
           AND ATI.BILL_TO_CUST_CD  = BTC.BILL_TO_CUST_CD(+)
           AND NOT EXISTS (
                           SELECT '*'
                             FROM AJE_INTFC_CTRL      AIC
                            WHERE AIC.EZCANCELFLAG    = '0'
                              AND AIC.GLBL_CMPY_CD    = #glblCmpyCd#
                              AND AIC.AJE_INTFC_TP_CD = #ajeIntfcTpCd#
                              AND AIC.JRNL_CPLT_FLG   = #jrnlCpltFlg#
                              AND AIC.GLBL_CMPY_CD    = ATI.GLBL_CMPY_CD
                              AND AIC.AJE_INTFC_PK    = ATI.AJE_ASSET_TRX_INTFC_PK
                          )
          ) W1,
          DEPT_PROD_COA      DPC,
          DEPT_PROD_AFFL_CH  DPAC1,
          DEPT_PROD_AFFL_CH  DPAC2,
          DEPT_PROD_AFFL_CH  DPAC3,
         (SELECT SYS_SRC_CD,
                 TRX_CD,
                 TRX_RSN_CD,
                 MDSE_OR_PRT_CD,
                 FIRST_PROD_CTRL_CD,
                 COA_PROD_CD,
                 COA_CC_CD,
                 COA_CH_CD
            FROM COA_SEG_PROD_PTRN
           WHERE EZCANCELFLAG = '0'
                 AND GLBL_CMPY_CD = #glblCmpyCd# 
         ) CSPP,
         (SELECT SYS_SRC_CD,
                 TRX_CD,
                 TRX_RSN_CD,
                 MDSE_OR_PRT_CD,
                 FIRST_PROD_CTRL_CD,
                 COA_PROD_CD,
                 COA_CC_CD,
                 COA_CH_CD
            FROM COA_SEG_PROD_PTRN
           WHERE EZCANCELFLAG = '0'
             AND GLBL_CMPY_CD = #glblCmpyCd# 
             AND COA_PROD_CD  = #anyProdCd#
         ) CSPP_ANY
         WHERE
               (DPC.EZCANCELFLAG       = '0'  OR DPC.EZCANCELFLAG IS NULL)
           AND (DPAC1.EZCANCELFLAG     = '0'  OR DPAC1.EZCANCELFLAG IS NULL)
           AND (DPAC2.EZCANCELFLAG     = '0'  OR DPAC2.EZCANCELFLAG IS NULL)
           AND (DPAC3.EZCANCELFLAG     = '0'  OR DPAC3.EZCANCELFLAG IS NULL)
           AND W1.GLBL_CMPY_CD         = DPC.GLBL_CMPY_CD(+)
           AND W1.FRTH_ORG_CD          = DPC.DEPT_ID(+)
           AND W1.FIRST_PROD_CTRL_CD   = DPC.FIRST_PROD_CTRL_CD(+)
           AND W1.GLBL_CMPY_CD         = DPAC1.GLBL_CMPY_CD(+)
           AND W1.FRTH_ORG_CD          = DPAC1.DEPT_ID(+)
           AND #prodCdZ#               = DPAC1.FIRST_PROD_CTRL_CD(+)
           AND W1.COA_AFFL_CD          = DPAC1.COA_AFFL_CD(+)
           AND W1.GLBL_CMPY_CD         = DPAC2.GLBL_CMPY_CD(+)
           AND W1.FRTH_ORG_CD          = DPAC2.DEPT_ID(+)
           AND W1.FIRST_PROD_CTRL_CD   = DPAC2.FIRST_PROD_CTRL_CD(+)
           AND W1.COA_AFFL_CD          = DPAC2.COA_AFFL_CD(+)
           AND W1.GLBL_CMPY_CD         = DPAC3.GLBL_CMPY_CD(+)
           AND W1.FRTH_ORG_CD          = DPAC3.DEPT_ID(+)
           AND W1.FIRST_PROD_CTRL_CD   = DPAC3.FIRST_PROD_CTRL_CD(+)
           AND #afflCd000#             = DPAC3.COA_AFFL_CD(+) 

           AND W1.SYS_SRC_CD           = CSPP.SYS_SRC_CD(+)
           AND W1.TRX_CD               = CSPP.TRX_CD(+)
           AND W1.TRX_RSN_CD           = CSPP.TRX_RSN_CD(+)
           AND #mdseOrPrtCd#           = CSPP.MDSE_OR_PRT_CD(+)
           AND W1.COA_PROD_CD_MDSE     = CSPP.COA_PROD_CD(+)
           AND W1.SYS_SRC_CD           = CSPP_ANY.SYS_SRC_CD(+)
           AND W1.TRX_CD               = CSPP_ANY.TRX_CD(+)
           AND W1.TRX_RSN_CD           = CSPP_ANY.TRX_RSN_CD(+)
           AND #mdseOrPrtCd#           = CSPP_ANY.MDSE_OR_PRT_CD(+)
           AND W1.FIRST_PROD_CTRL_CD   = CSPP_ANY.FIRST_PROD_CTRL_CD(+)

         ORDER BY W1.AJE_ASSET_TRX_INTFC_PK
    </statement>
    
<!--
   	<statement id="getAllTrialMachTp" parameterClass="Map" resultClass="Map">
        SELECT TMIT.TRIAL_MACH_IND_TP_CD AS TRIAL_MACH_IND_TP_CD
          FROM TRIAL_MACH_IND_TP TMIT
         WHERE TMIT.EZCANCELFLAG    = '0'
           AND TMIT.GLBL_CMPY_CD    = #glblCmpyCd#
         ORDER BY TMIT.TRIAL_MACH_IND_TP_SORT_NUM 
    </statement>
-->    
</sqlMap>	
