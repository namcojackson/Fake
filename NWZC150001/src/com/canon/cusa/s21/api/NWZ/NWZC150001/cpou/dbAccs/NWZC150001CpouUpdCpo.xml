<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWZC150001CpouUpdCpo">

    <!-- 2017/06/20 S21_NA#19288-2 Del Start -->
    <!-- statement id="getRtrnDtlCnt" parameterClass="Map" resultClass="Integer" -->
<!--         SELECT -->
<!--             COUNT(R.GLBL_CMPY_CD) -->
<!--         FROM -->
<!--             DS_CPO_RTRN_DTL R -->
<!--         WHERE -->
<!--             R.GLBL_CMPY_CD          = #glblCmpyCd# -->
<!--             AND R.CPO_ORD_NUM       = #cpoOrdNum# -->
<!--             AND R.RTRN_LINE_STS_CD NOT IN (#closed#, #cancelled#) -->
<!--             AND R.EZCANCELFLAG = '0' -->
    <!-- /statement -->

    <!-- statement id="hasOpenCpoDtl" parameterClass="Map" resultClass="Integer" -->
<!--         SELECT -->
<!--             COUNT(CD.GLBL_CMPY_CD) -->
<!--         FROM -->
<!--             CPO_DTL CD -->
<!--         WHERE -->
<!--             CD.GLBL_CMPY_CD          = #glblCmpyCd# -->
<!--             AND CD.CPO_ORD_NUM       = #cpoOrdNum# -->
<!--             AND CD.ORD_LINE_STS_CD NOT IN (#closed#, #cancelled#) -->
<!--             AND CD.EZCANCELFLAG = '0' -->
    <!-- /statement -->
    <!-- 2017/06/20 S21_NA#19288-2 Del End -->

    <statement id="hasDetectedStsDtl" parameterClass="Map" resultClass="Map">
        SELECT
            COUNT(CD.GLBL_CMPY_CD)  CNT_DAT
            ,'CPO_DTL'              DTL_TP
        FROM
            CPO_DTL CD
        WHERE
            CD.GLBL_CMPY_CD          = #glblCmpyCd#
            AND CD.CPO_ORD_NUM       = #cpoOrdNum#
            AND CD.ORD_LINE_STS_CD   = #ordLineSts#
            AND CD.EZCANCELFLAG = '0'
        UNION
        SELECT
            COUNT(R.GLBL_CMPY_CD)   CNT_DAT
            ,'RTN_DTL'              DTL_TP
        FROM
            DS_CPO_RTRN_DTL R
        WHERE
            R.GLBL_CMPY_CD          = #glblCmpyCd#
            AND R.CPO_ORD_NUM       = #cpoOrdNum#
            AND R.RTRN_LINE_STS_CD  = #rtrnLineStsCd#
            AND R.EZCANCELFLAG = '0'
    </statement>

</sqlMap>
