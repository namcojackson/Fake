<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWZC150001CpouUpdateOrderData">


    <statement id="getLineFrtAmt" parameterClass="Map" resultClass="BigDecimal">
      SELECT
                NVL(SUM(SP.SP_TOT_DEAL_FRT_AMT),'0') AS LINE_TOT_FRT_AMT
        FROM
                SHPG_PLN SP
        WHERE
                 SP.GLBL_CMPY_CD     = #glblCmpyCd#
             AND SP.TRX_HDR_NUM      = #trxHdrNum#
             AND SP.TRX_LINE_NUM     = #trxLineNum# 
             AND SP.TRX_LINE_SUB_NUM = #trxLineSubNum#
             AND SP.TRX_SRC_TP_CD    = #trxSrcTpCd#
             AND SP.SHPG_STS_CD     != #canShpgStsCd#
             AND SP.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getSoNumList" parameterClass="Map" resultClass="Map">
      SELECT
           SP.TRX_HDR_NUM         TRX_HDR_NUM
          ,CD.DS_CPO_CONFIG_PK    DS_CPO_CONFIG_PK
          ,SP.SO_NUM              SO_NUM
          ,MAX(SP.SHPG_PLN_NUM)   SHPG_PLN_NUM
      FROM
          SHPG_PLN SP
         ,CPO_DTL  CD
      WHERE
              SP.GLBL_CMPY_CD     = #glblCmpyCd#
          AND SP.TRX_HDR_NUM      = #cpoOrdNum#
          AND SP.EZCANCELFLAG     = '0'
          AND SP.GLBL_CMPY_CD     = CD.GLBL_CMPY_CD
          AND SP.TRX_HDR_NUM      = CD.CPO_ORD_NUM
          AND SP.TRX_LINE_NUM     = CD.CPO_DTL_LINE_NUM
          AND SP.TRX_LINE_SUB_NUM = CD.CPO_DTL_LINE_SUB_NUM
          AND CD.DS_CPO_CONFIG_PK = #dsCpoConfigPk#
          AND CD.EZCANCELFLAG     = '0'
      GROUP BY
           SP.TRX_HDR_NUM
          ,CD.DS_CPO_CONFIG_PK
          ,SP.SO_NUM
    </statement>
</sqlMap>
