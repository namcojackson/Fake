<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAB244001">
    <typeAlias alias="SCHD_AGMT_PLNTMsg"    type="business.db.SCHD_AGMT_PLNTMsg"/>
    <typeAlias alias="BILL_TO_CUSTTMsg"  type="business.db.BILL_TO_CUSTTMsg"/>
    <typeAlias alias="SHIP_TO_CUSTTMsg"  type="business.db.SHIP_TO_CUSTTMsg"/>
    
    <statement id="getSchdAgmtPln" parameterClass="Map" resultMap="result.getSchdAgmtPln">
          SELECT 
                 PLN.GLBL_CMPY_CD           GLBL_CMPY_CD
                ,PLN.SCHD_AGMT_NUM          SCHD_AGMT_NUM
                ,PLN.SCHD_AGMT_LINE_NUM     SCHD_AGMT_LINE_NUM
                ,PLN.SCHD_AGMT_SCHD_LINE_NUM SCHD_AGMT_SCHD_LINE_NUM
                ,PLN.RDD_DT                 RDD_DT
                ,PLN.ORD_QTY                ORD_QTY
                ,PLN.CPO_ORD_NUM            CPO_ORD_NUM
                ,PLN.CPO_DTL_LINE_NUM       CPO_DTL_LINE_NUM
                ,PLN.CPO_DTL_LINE_SUB_NUM   CPO_DTL_LINE_SUB_NUM
                ,PLN.DS_ORD_POSN_NUM        DS_ORD_POSN_NUM
                ,PLN.ORD_CRAT_TS            ORD_CRAT_TS
                ,PLN.SCHD_AGMT_PLN_CANC_FLG SCHD_AGMT_PLN_CANC_FLG
                ,PLN.ORD_MDSE_CD            ORD_MDSE_CD
          FROM 
                 SCHD_AGMT_PLN  PLN
               , SCHD_AGMT      SAH
               , SCHD_AGMT_LINE SAL
          WHERE 
                 PLN.GLBL_CMPY_CD            = #glblCmpyCd#
             AND PLN.RDD_DT                  &lt;= #rddDt#
             AND PLN.SCHD_AGMT_PLN_CANC_FLG  = #schdAgmtCancFlg#
             AND PLN.CPO_ORD_NUM             IS NULL
             AND PLN.EZCANCELFLAG            = '0'
             AND PLN.GLBL_CMPY_CD            = SAH.GLBL_CMPY_CD
             AND PLN.SCHD_AGMT_NUM           = SAH.SCHD_AGMT_NUM
             AND SAH.SCHD_AGMT_DELY_HLD_CD   IS NULL
             AND SAH.SCHD_AGMT_STS_CD        = #schdAgmtSts#
             AND SAH.EZCANCELFLAG            = '0'
             AND PLN.GLBL_CMPY_CD            = SAL.GLBL_CMPY_CD
             AND PLN.SCHD_AGMT_NUM           = SAL.SCHD_AGMT_NUM
             AND PLN.SCHD_AGMT_LINE_NUM      = SAL.SCHD_AGMT_LINE_NUM
             AND SAL.SCHD_AGMT_LINE_CANC_FLG = #schdAgmtCancFlg#
             AND SAL.EZCANCELFLAG            = '0'
      	ORDER BY
             SCHD_AGMT_NUM
           , RDD_DT
           , SCHD_AGMT_LINE_NUM
           , SCHD_AGMT_SCHD_LINE_NUM
               
    </statement>

    <resultMap id="result.getSchdAgmtPln" class="SCHD_AGMT_PLNTMsg">
        <result property="glblCmpyCd"          column="GLBL_CMPY_CD"            javaType="EZDSStringItem"/>
        <result property="schdAgmtNum"         column="SCHD_AGMT_NUM"           javaType="EZDSStringItem"/>
        <result property="schdAgmtLineNum"     column="SCHD_AGMT_LINE_NUM"      javaType="EZDSBigDecimalItem"/>
        <result property="schdAgmtSchdLineNum" column="SCHD_AGMT_SCHD_LINE_NUM" javaType="EZDSBigDecimalItem"/>
        <result property="rddDt"               column="RDD_DT"                  javaType="EZDSStringItem"/>
        <result property="ordQty"              column="ORD_QTY"                 javaType="EZDSBigDecimalItem"/>
        <result property="cpoOrdNum"           column="CPO_ORD_NUM"             javaType="EZDSStringItem"/>
        <result property="cpoDtlLineNum"       column="CPO_DTL_LINE_NUM"        javaType="EZDSStringItem"/>
        <result property="cpoDtlLineSubNum"    column="CPO_DTL_LINE_SUB_NUM"    javaType="EZDSStringItem"/>
        <result property="dsOrdPosnNum"        column="DS_ORD_POSN_NUM"         javaType="EZDSStringItem"/>
        <result property="ordCratTs"           column="ORD_CRAT_TS"             javaType="EZDSStringItem"/>
        <result property="schdAgmtPlnCancFlg"  column="SCHD_AGMT_PLN_CANC_FLG"  javaType="EZDSStringItem"/>
        <result property="ordMdseCd"           column="ORD_MDSE_CD"             javaType="EZDSStringItem"/>
    </resultMap>
    
    <statement id="getShipToAddrInfo" parameterClass="Map" resultClass="Map">
          SELECT 
                 SHIP.FIRST_LINE_ADDR
               , SHIP.SCD_LINE_ADDR
               , SHIP.CTY_ADDR
               , SHIP.ST_CD
               , SHIP.POST_CD
               , SHIP.CTRY_CD
               , SHIP.DS_INSD_CTY_LIMIT_FLG
               , SHIP.LOC_NUM
               , CNTY.CNTY_NM
          FROM 
                 SHIP_TO_CUST     SHIP
               , CNTY             CNTY
          WHERE 
                 SHIP.GLBL_CMPY_CD     = #glblCmpyCd#
             AND SHIP.SHIP_TO_CUST_CD  = #shipToCustCd#
             AND SHIP.RGTN_STS_CD      = #rgtnStsCd#
             AND SHIP.EZCANCELFLAG     = '0'
             AND SHIP.GLBL_CMPY_CD     = CNTY.GLBL_CMPY_CD(+)
             AND SHIP.CNTY_PK          = CNTY.CNTY_PK(+)
             AND CNTY.EZCANCELFLAG(+)  = '0'
             AND ROWNUM                = 1
    </statement>
    
    <statement id="getRtlWhInfo" parameterClass="Map" resultClass="Map">
          SELECT 
                 RWH.FIRST_LINE_ADDR
               , RWH.SCD_LINE_ADDR
               , RWH.CTY_ADDR
               , RWH.ST_CD
               , RWH.POST_CD
               , RWH.CTRY_CD
               , CNTY.CNTY_NM
          FROM 
                 RTL_WH   RWH
               , CNTY     CNTY
          WHERE 
                 RWH.GLBL_CMPY_CD      = #glblCmpyCd#
             AND RWH.RTL_WH_CD         = #rtlWhCd#
             AND RWH.EZCANCELFLAG      = '0'
             AND RWH.GLBL_CMPY_CD      = CNTY.GLBL_CMPY_CD(+)
             AND RWH.CNTY_PK           = CNTY.CNTY_PK(+)
             AND CNTY.EZCANCELFLAG(+)  = '0'
             AND ROWNUM                = 1
    </statement>
    
    <statement id="getSlsRepInfo" parameterClass="Map" resultClass="Map">
          SELECT 
                 PSN.FIRST_LINE_ADDR
               , PSN.SCD_LINE_ADDR
               , PSN.CTY_ADDR
               , PSN.ST_CD
               , PSN.POST_CD
               , PSN.CTRY_CD
               , PSN.DS_INSD_CTY_LIMIT_FLG
               , CNTY.CNTY_NM
          FROM 
                 TOC          TOC
               , ORG_FUNC_ASG ORG
               , S21_PSN      PSN
               , CNTY         CNTY
          WHERE 
                 TOC.GLBL_CMPY_CD     = #glblCmpyCd#
             AND TOC.TOC_CD           = #tocCd#
             AND TOC.EZCANCELFLAG     = '0'
             AND TOC.GLBL_CMPY_CD     = ORG.GLBL_CMPY_CD
             AND TOC.TOC_CD           = ORG.TOC_CD
             AND ORG.EFF_FROM_DT      &lt;= #slsDt#
             AND (ORG.EFF_THRU_DT     &gt;= #slsDt# OR ORG.EFF_THRU_DT IS NULL)
             AND ORG.EZCANCELFLAG     = '0'
             AND ORG.GLBL_CMPY_CD     = PSN.GLBL_CMPY_CD
             AND ORG.PSN_CD           = PSN.PSN_CD
             AND PSN.EZCANCELFLAG     = '0'
             AND PSN.GLBL_CMPY_CD     = CNTY.GLBL_CMPY_CD(+)
             AND PSN.CNTY_PK          = CNTY.CNTY_PK(+)
             AND CNTY.EZCANCELFLAG(+) = '0'
             AND ROWNUM               = 1
    </statement>
    
    <statement id="getDsBillToCust" parameterClass="Map" resultMap="result.getDsBillToCust">
          SELECT 
                  BILL.DS_TAX_GRP_EXEM_CD
                , BILL.DS_TAX_EXEM_FLG
          FROM 
                  BILL_TO_CUST    BILL
          WHERE 
                  BILL.GLBL_CMPY_CD    = #glblCmpyCd#
              AND BILL.BILL_TO_CUST_CD = #billToCustCd#
              AND BILL.RGTN_STS_CD     = #rgtnStsCd#
              AND BILL.EZCANCELFLAG    = '0'
              AND ROWNUM = 1
    </statement>
    
    <resultMap id="result.getDsBillToCust" class="BILL_TO_CUSTTMsg">
        <result property="dsTaxGrpExemCd"   column="DS_TAX_GRP_EXEM_CD"           javaType="EZDSStringItem"/>
        <result property="dsTaxExemFlg"     column="DS_TAX_EXEM_FLG"              javaType="EZDSStringItem"/>
    </resultMap>
    
    <statement id="getDsShipToCust" parameterClass="Map" resultMap="result.getDsShipToCust">
          SELECT 
                  SHIP.DS_TAX_GRP_EXEM_CD
                , SHIP.DS_TAX_EXEM_FLG
          FROM 
                  SHIP_TO_CUST    SHIP
          WHERE 
                  SHIP.GLBL_CMPY_CD    = #glblCmpyCd#
              AND SHIP.SHIP_TO_CUST_CD = #shipToCustCd#
              AND SHIP.RGTN_STS_CD     = #rgtnStsCd#
              AND SHIP.EZCANCELFLAG    = '0'
              AND ROWNUM = 1
    </statement>
    
    <resultMap id="result.getDsShipToCust" class="SHIP_TO_CUSTTMsg">
        <result property="dsTaxGrpExemCd"   column="DS_TAX_GRP_EXEM_CD"           javaType="EZDSStringItem"/>
        <result property="dsTaxExemFlg"     column="DS_TAX_EXEM_FLG"              javaType="EZDSStringItem"/>
    </resultMap>

    <!-- START 2017/09/26 K.Kim [QC#18744, ADD] -->
    <statement id="getSplyInclFlg" parameterClass="Map" resultMap="String">
          SELECT
                 DSC.SPLY_INCL_FLG
          FROM
                 DS_SUB_CONTR    DSC
          WHERE
                 DSC.GLBL_CMPY_CD     = #glblCmpyCd#
             AND DSC.DS_CONTR_DTL_PK  = #dsContrDtlPk#
             AND DSC.EZCANCELFLAG     = '0'
             AND ROWNUM               = 1
    </statement>
    <!-- END 2017/09/26 K.Kim [QC#18744, ADD] -->
</sqlMap>