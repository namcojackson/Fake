<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NLCL1030Query">

    <typeAlias alias="NLCL1030CMsg"      type="business.blap.NLCL1030.NLCL1030CMsg"/>
    <typeAlias alias="NLCL1030SMsg"      type="business.blap.NLCL1030.NLCL1030SMsg"/>
    <typeAlias alias="NLCL1030_ASMsg"    type="business.blap.NLCL1030.NLCL1030_ASMsg"/>

   <statement id="getSrchOptnPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               SSO.SRCH_OPT_PK AS SRCH_OPT_PK
              ,SSO.SRCH_OPT_NM AS SRCH_OPT_NM
          FROM
               SAVE_SRCH_OPT SSO
         WHERE
               1=1
           AND SSO.GLBL_CMPY_CD     = #glblCmpyCd#
           AND SSO.SRCH_OPT_APL_ID  = #srchOptAplId#
           AND SSO.SRCH_OPT_USR_ID  = #srchOptUsrId#
         ORDER BY
               SSO.SRCH_OPT_NM
    </statement>

    <statement id="searchABCAssignment" parameterClass="Map" resultMap="result.NLCL1030_ASMsg">
        SELECT ABC.ABC_ASG_NM
              ,ABC.ABC_ASG_PK
              ,ABC.ABC_ASG_DESC_TXT
              ,ABC.RTL_WH_CATG_DESC_TXT
              ,ABC.RTL_WH_CD
              ,ABC.RTL_WH_NM
              ,ABC.ABC_ANLS_CRIT_NM
              ,ABC.EFF_FROM_DT
              ,ABC.EFF_THRU_DT
              ,ABC.ABC_ANLS_CLS_NM
        FROM (
        SELECT
              AA.ABC_ASG_NM             AS ABC_ASG_NM
             ,AA.ABC_ASG_PK             AS ABC_ASG_PK
             ,AA.ABC_ASG_DESC_TXT       AS ABC_ASG_DESC_TXT
             ,RWC.RTL_WH_CATG_DESC_TXT  AS RTL_WH_CATG_DESC_TXT
             ,AAW.RTL_WH_CD             AS RTL_WH_CD
             ,RW.RTL_WH_NM              AS RTL_WH_NM
             ,AACR.ABC_ANLS_CRIT_NM     AS ABC_ANLS_CRIT_NM
             ,AA.EFF_FROM_DT            AS EFF_FROM_DT
             ,AA.EFF_THRU_DT            AS EFF_THRU_DT
             ,AACL.ABC_ANLS_CLS_NM      AS ABC_ANLS_CLS_NM
        FROM
              ABC_ASG              AA
             ,ABC_ASG_WH           AAW
             ,RTL_WH               RW
             ,ABC_ASG_SWH          AAS
             ,RTL_WH_CATG_SWH_RELN RWCSR
             ,RTL_WH_CATG          RWC
             ,ABC_ANLS_CRIT        AACR
             ,ABC_ANLS_CLS         AACL
        WHERE
              1=1
          AND AA.GLBL_CMPY_CD       = AAW.GLBL_CMPY_CD
          AND AA.ABC_ASG_PK         = AAW.ABC_ASG_PK
          AND AAW.EZCANCELFLAG      = '0'
          AND AAW.GLBL_CMPY_CD      = RW.GLBL_CMPY_CD
          AND AAW.RTL_WH_CD         = RW.RTL_WH_CD
          AND RW.EZCANCELFLAG       = '0'
          AND AA.GLBL_CMPY_CD       = AAS.GLBL_CMPY_CD(+)
          AND AA.ABC_ASG_PK         = AAS.ABC_ASG_PK(+)
          AND AAS.EZCANCELFLAG(+)   = '0'
          AND AA.GLBL_CMPY_CD       = RWCSR.GLBL_CMPY_CD(+)
          AND AA.RTL_WH_CATG_CD     = RWCSR.RTL_WH_CATG_CD(+)
          AND AAS.RTL_SWH_CD        = RWCSR.RTL_SWH_CD(+)
          AND RWCSR.EZCANCELFLAG(+) = '0'
          AND AA.GLBL_CMPY_CD       = RWC.GLBL_CMPY_CD
          AND AA.RTL_WH_CATG_CD     = RWC.RTL_WH_CATG_CD
          AND RWC.EZCANCELFLAG      = '0'
          AND AA.GLBL_CMPY_CD       = AACR.GLBL_CMPY_CD
          AND AA.ABC_ANLS_CRIT_CD   = AACR.ABC_ANLS_CRIT_CD
          AND AACR.EZCANCELFLAG     = '0'
          AND AA.GLBL_CMPY_CD       = AACL.GLBL_CMPY_CD
          AND AA.ABC_ANLS_CLS_NUM   = AACL.ABC_ANLS_CLS_NUM 
          AND AACL.EZCANCELFLAG     = '0'
          AND AA.GLBL_CMPY_CD       = #glblCmpyCd#
          AND AA.EZCANCELFLAG       = '0'
          <isNotNull property="abcAsgNm">
          AND AA.ABC_ASG_NM   LIKE  #abcAsgNm#
          </isNotNull>
          <isNotNull property="rtlWhCatgCd">
          AND AA.RTL_WH_CATG_CD   = #rtlWhCatgCd#
          </isNotNull>
          <isNotNull property="rtlWhCd">
              <iterate property="rtlWhCd" var="rtlWhCd[]" open="AND (AAW.RTL_WH_CD LIKE " conjunction= "OR AAW.RTL_WH_CD LIKE " close=")">
              #rtlWhCd[]#
              </iterate>
          </isNotNull>
          <isNotNull property="rtlWhNm">
              <iterate property="rtlWhNm" var="rtlWhNm[]" open="AND (RW.RTL_WH_NM LIKE " conjunction= "OR RW.RTL_WH_NM LIKE " close=")">
              #rtlWhNm[]#
              </iterate>
          </isNotNull>
          <isNotNull property="rtlSwhCd">
              <iterate property="rtlSwhCd" var="rtlSwhCd[]" open="AND (AAS.RTL_SWH_CD LIKE " conjunction= "OR AAS.RTL_SWH_CD LIKE " close=")">
              #rtlSwhCd[]#
              </iterate>
          </isNotNull>
       GROUP BY
              AA.ABC_ASG_NM
             ,AA.ABC_ASG_PK
             ,AA.ABC_ASG_DESC_TXT
             ,RWC.RTL_WH_CATG_DESC_TXT
             ,AAW.RTL_WH_CD
             ,RW.RTL_WH_NM
             ,AACR.ABC_ANLS_CRIT_NM
             ,AA.EFF_FROM_DT
             ,AA.EFF_THRU_DT
             ,AACL.ABC_ANLS_CLS_NM
       ORDER BY
              AA.ABC_ASG_NM
       ) ABC
       WHERE ROWNUM &lt;= #limitRownum#
    </statement>

    <statement id="searchAbcAssignmentSwh" parameterClass="Map" resultClass="Map">
        SELECT AAS.RTL_SWH_CD
        FROM   ABC_ASG_SWH AAS
              ,RTL_SWH RS
              ,SWH SW
        WHERE 1 = 1
        AND   AAS.GLBL_CMPY_CD = #glblCmpyCd#
        AND   AAS.ABC_ASG_PK   = #abcAsgPk#
        AND   AAS.EZCANCELFLAG = '0'
        AND   AAS.GLBL_CMPY_CD = RS.GLBL_CMPY_CD
        AND   RS.RTL_WH_CD     = #rtlWhCd#
        AND   AAS.RTL_SWH_CD   = RS.RTL_SWH_CD
        AND   RS.EZCANCELFLAG  = '0'
        AND   AAS.GLBL_CMPY_CD = SW.GLBL_CMPY_CD
        AND   AAS.RTL_SWH_CD   = SW.RTL_SWH_CD
        AND   SW.EZCANCELFLAG  = '0'
        ORDER BY SW.RTL_SWH_SORT_NUM
    </statement>

    <resultMap id="result.NLCL1030_ASMsg" class="NLCL1030_ASMsg">
        <result property="abcAsgNm_A"           column="ABC_ASG_NM"            javaType="EZDSStringItem"/>
        <result property="abcAsgPk_A"           column="ABC_ASG_PK"            javaType="EZDCBigDecimalItem"/>
        <result property="abcAsgDescTxt_A"      column="ABC_ASG_DESC_TXT"      javaType="EZDSStringItem"/>
        <result property="rtlWhCatgDescTxt_A"   column="RTL_WH_CATG_DESC_TXT"  javaType="EZDSStringItem"/>
        <result property="rtlWhCdSrchTxt_AW"    column="RTL_WH_CD"             javaType="EZDSStringItem"/>
        <result property="rtlWhNmSrchTxt_AW"    column="RTL_WH_NM"             javaType="EZDSStringItem"/>
        <result property="abcAnlsCritNm_A"      column="ABC_ANLS_CRIT_NM"      javaType="EZDSStringItem"/>
        <result property="effFromDt_A"          column="EFF_FROM_DT"           javaType="EZDSStringItem"/>
        <result property="effThruDt_A"          column="EFF_THRU_DT"           javaType="EZDSStringItem"/>
        <result property="abcAnlsClsNm_A"       column="ABC_ANLS_CLS_NM"       javaType="EZDSStringItem"/>
    </resultMap>

</sqlMap>