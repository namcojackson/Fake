<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NMAL2600Query">

    <typeAlias alias="NMAL2600SMsg"     type="business.blap.NMAL2600.NMAL2600SMsg"/>
    <typeAlias alias="NMAL2600_ASMsg"   type="business.blap.NMAL2600.NMAL2600_ASMsg"/>
    <typeAlias alias="NMAL2600_TSMsg"   type="business.blap.NMAL2600.NMAL2600_TSMsg"/>
    <typeAlias alias="NMAL2600_QSMsg"   type="business.blap.NMAL2600.NMAL2600_QSMsg"/>

    <resultMap id="result.getContact"  class="NMAL2600_ASMsg">
        <result property="psnNum_A1"         column="PSN_NUM"              javaType="EZDSStringItem"/>
        <result property="psnTpCd_A1"        column="PSN_TP_CD"            javaType="EZDSStringItem"/>
        <result property="psnTpNm_A1"        column="PSN_TP_NM"            javaType="EZDSStringItem"/>
        <result property="psnFirstNm_A1"     column="PSN_FIRST_NM"         javaType="EZDSStringItem"/>
        <result property="psnLastNm_A1"      column="PSN_LAST_NM"          javaType="EZDSStringItem"/>
        <result property="jobTtlCd_A1"       column="JOB_TTL_CD"           javaType="EZDSStringItem"/>
        <result property="hrTtlNm_A1"        column="HR_TTL_NM"            javaType="EZDSStringItem"/>
        <result property="jobTtlNm_A1"       column="JOB_TTL_NM"           javaType="EZDSStringItem"/>
        <result property="psnCd_A1"          column="PSN_CD"               javaType="EZDSStringItem"/>
        <result property="hrSupvNm_A1"       column="HR_SUPV_NM"           javaType="EZDSStringItem"/>
        <result property="effFromDt_A1"      column="EFF_FROM_DT"          javaType="EZDCDateItem"/>
        <result property="effThruDt_A1"      column="EFF_THRU_DT"          javaType="EZDCDateItem"/>
    </resultMap>
    
    <resultMap id="result.getHierarchy"  class="NMAL2600_TSMsg">
        <result property="orgCd_T"              column="ORG_CD"                 javaType="EZDSStringItem"/>
        <result property="orgTierCd_T"          column="ORG_TIER_CD"            javaType="EZDSStringItem"/>
        <result property="orgNm_1"              column="FIRST_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_2"              column="SCD_ORG_NM"             javaType="EZDSStringItem"/>
        <result property="orgNm_3"              column="THIRD_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_4"              column="FRTH_ORG_NM"            javaType="EZDSStringItem"/>
        <result property="orgNm_5"              column="FIFTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_6"              column="SIXTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_7"              column="SVNTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_8"              column="EIGHTH_ORG_NM"          javaType="EZDSStringItem"/>
        <result property="orgNm_9"              column="NINTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="orgNm_10"             column="TENTH_ORG_NM"           javaType="EZDSStringItem"/>
        <result property="xxPsnNm_T"            column="PSN_NM"                 javaType="EZDSStringItem"/>
        <result property="xxFullNm_T"           column="TRTY_RULE"              javaType="EZDSStringItem"/>
        <result property="orgFuncRoleTpNm_T"    column="ORG_FUNC_ROLE_TP_NM"    javaType="EZDSStringItem"/>
        <result property="psnNum_T"             column="PSN_NUM"                javaType="EZDSStringItem"/>
    </resultMap>
    
    <resultMap id="result.getTargetOrg"  class="NMAL2600_QSMsg">
        <result property="orgCd_Q"              column="ORG_CD"                javaType="EZDSStringItem"/>
        <result property="orgNm_Q"              column="ORG_NM"                javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getBizAreaOrgPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               ORG.BIZ_AREA_ORG_CD
              ,ORG.BIZ_AREA_ORG_NM
          FROM
               BIZ_AREA_ORG ORG
              ,ORG_STRU_TP STRU
         WHERE
               ORG.GLBL_CMPY_CD   = #glblCmpyCd#
           AND ORG.EZCANCELFLAG   = '0'
           AND STRU.GLBL_CMPY_CD  = #glblCmpyCd#
           AND STRU.EZCANCELFLAG  = '0'
           AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
           AND TRTY_STRU_FLG = #trtyStruFlg#
         ORDER BY
               ORG.BIZ_AREA_ORG_SORT_NUM
    </statement>

    <statement id="getTrtyTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TRTY.TRTY_TP_CD
              ,TRTY.TRTY_TP_NM
          FROM
               TRTY_TP TRTY
         WHERE
               TRTY.GLBL_CMPY_CD  = #glblCmpyCd#
           AND TRTY.EZCANCELFLAG  = '0'
         ORDER BY
               TRTY.TRTY_TP_SORT_NUM
    </statement>

    <statement id="getOrgTierPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               TIER.ORG_TIER_CD
              ,TIER.ORG_TIER_NM
          FROM
               ORG_TIER TIER
         WHERE
               TIER.GLBL_CMPY_CD  = #glblCmpyCd#
           AND TIER.EZCANCELFLAG  = '0'
           AND TIER.ORG_TIER_CD > 0
         ORDER BY
               TIER.ORG_TIER_SORT_NUM
    </statement>

    <statement id="getTrtyGrpTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               GRP.TRTY_GRP_TP_CD
              ,GRP.TRTY_GRP_TP_NM
          FROM
               TRTY_GRP_TP GRP
         WHERE
               GRP.GLBL_CMPY_CD  = #glblCmpyCd#
           AND GRP.EZCANCELFLAG  = '0'
         ORDER BY
               GRP.TRTY_GRP_TP_SORT_NUM
    </statement>
    
    <statement id="getTrtyRuleTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               RULE.TRTY_RULE_TP_CD
              ,RULE.TRTY_RULE_TP_NM
          FROM
               TRTY_RULE_TP RULE
         WHERE
               RULE.GLBL_CMPY_CD  = #glblCmpyCd#
           AND RULE.EZCANCELFLAG  = '0'
         ORDER BY
               RULE.TRTY_RULE_TP_SORT_NUM
    </statement>
    
    <statement id="getTrtyRuleOprdTpPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
               OPRD.TRTY_RULE_OPRD_TP_CD
              ,OPRD.TRTY_RULE_OPRD_TP_NM
          FROM
               TRTY_RULE_OPRD_TP OPRD
         WHERE
               OPRD.GLBL_CMPY_CD  = #glblCmpyCd#
           AND OPRD.EZCANCELFLAG  = '0'
         ORDER BY
               OPRD.TRTY_RULE_OPRD_TP_SORT_NUM
    </statement>

<!-- CSA-QC#11652 Delete Start
    <statement id="getTerritoryTopTier" parameterClass="Map" resultMap="result.getHierarchy">
    SELECT
        ORG.ORG_CD AS ORG_CD
        ,ORG.ORG_TIER_CD AS ORG_TIER_CD
        ,ORG.ORG_NM AS FIRST_ORG_NM
    FROM
        DS_ORG_UNIT ORG
        ,ORG_STRU_TP TP
        ,BIZ_AREA_ORG BIZ
    <isEqual property="rsrcSrch" compareValue='Y'>
        ,DS_ORG_RESRC_RELN RELN
        ,S21_PSN PSN
    </isEqual>
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND ORG.GLBL_CMPY_CD = TP.GLBL_CMPY_CD
    AND TP.EZCANCELFLAG = '0'
    AND ORG.GLBL_CMPY_CD = BIZ.GLBL_CMPY_CD
    AND BIZ.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = TP.ORG_STRU_TP_CD
    AND TP.TRTY_STRU_FLG = #trtyStruFlg#
    AND ORG.ORG_TIER_CD = '1'
    AND BIZ.ORG_STRU_TP_CD = TP.ORG_STRU_TP_CD
    <isNotEqual property="includeInactive" compareValue='Y'>
    AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
    </isNotEqual>
   <isNotNull property="cMsg.orgNm_H1">
    AND ORG.ORG_NM     LIKE #cMsg.orgNm_H1#
    </isNotNull>
    <isNull property="cMsg.effFromDt_H1">
    AND ORG.EFF_FROM_DT &lt;= #slsDt#
    </isNull>
    <isNotNull property="cMsg.effFromDt_H1">
    AND ORG.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
    </isNotNull>
    AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#)  &gt;= #slsDt#
    <isNotNull property="cMsg.bizAreaOrgCd_P1">
    AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.trtyGrpTpCd_P1">
    AND ORG.TRTY_GRP_TP_CD = #cMsg.trtyGrpTpCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.trtyTpCd_P1">
    AND ORG.TRTY_TP_CD = #cMsg.trtyTpCd_P1#
    </isNotNull>
    <isEqual property="rsrcSrch" compareValue='Y'>
        AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND RELN.EZCANCELFLAG = '0'
        <isNull property="cMsg.effFromDt_H1">
        AND RELN.EFF_FROM_DT &lt;= #slsDt#
        </isNull>
        <isNotNull property="cMsg.effFromDt_H1">
        AND RELN.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
        </isNotNull>
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#)  &gt;= #slsDt#
        AND ORG.ORG_CD = RELN.ORG_CD

        AND RELN.GLBL_CMPY_CD = PSN.GLBL_CMPY_CD
        AND RELN.PSN_CD       = PSN.PSN_CD
        AND PSN.EZCANCELFLAG  = '0'
        <isNull property="cMsg.effFromDt_H1">
        AND RELN.EFF_FROM_DT &lt;= #slsDt#
        </isNull>
        <isNotNull property="cMsg.effFromDt_H1">
        AND RELN.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
        </isNotNull>
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#)  &gt;= #slsDt#
        <isNotNull property="cMsg.psnCd_H1">
         AND PSN.PSN_CD  LIKE #cMsg.psnCd_H1#
        </isNotNull>
        <isNotNull property="cMsg.psnNum_H1">
         AND PSN.PSN_NUM  LIKE #cMsg.psnNum_H1#
        </isNotNull>
        <isNotNull property="cMsg.xxPsnNm_H1">
         AND (
                 UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#)
             OR  UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#)
             OR  UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#)
             )
        </isNotNull>
    </isEqual>

    <isNotNull property="AdvSearchFlg1">
    AND ORG.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
               <isNotNull property="trtyRuleTpCd1">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd1#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd1">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd1#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal1">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal1#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal1">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal1#
               </isNotNull>
               )
    </isNotNull>
    <isNotNull property="AdvSearchFlg2">
    AND ORG.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
               <isNotNull property="trtyRuleTpCd2">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd2#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd2">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd2#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal2">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal2#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal2">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal2#
               </isNotNull>
               )
    </isNotNull>
    <isNotNull property="AdvSearchFlg3">
    AND ORG.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
               <isNotNull property="trtyRuleTpCd3">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd3#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd3">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd3#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal3">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal3#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal3">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal3#
               </isNotNull>
               )
    </isNotNull>
    <isNotNull property="AdvSearchFlg4">
    AND ORG.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
               <isNotNull property="trtyRuleTpCd4">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd4#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd4">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd4#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal4">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal4#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal4">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal4#
               </isNotNull>
               )
    </isNotNull>
    <isNotNull property="AdvSearchFlg5">
    AND ORG.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
               <isNotNull property="trtyRuleTpCd5">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd5#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd5">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd5#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal5">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal5#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal5">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal5#
               </isNotNull>
               )
    </isNotNull>

    ORDER BY
        ORG.ORG_CD
    </statement>
-->

    <statement id="getTerritory" parameterClass="Map" resultMap="result.getHierarchy">
    WITH WRK AS(
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,RELN.PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.EFF_FROM_DT
        FROM
            DS_ORG_UNIT ORG
            ,DS_ORG_RELN RELN
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
       <isNotEqual property="includeInactive" compareValue='Y'>
       <!-- 2018/03/07 QC#20233-1 add start -->
        AND RELN.GNRN_TP_CD != #gnrnTpCdPast#
       <!-- 2018/03/07 QC#20233-1 add end -->
        AND RELN.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
        AND ORG.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
       </isNotEqual>
      <!--
        AND (RELN.GNRN_TP_CD = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD = #gnrnTpCdFuture#)
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
        </isNotEqual>
      -->
        <isEqual property="includeInactive" compareValue='Y'>
        AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
        AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
        </isEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>

        UNION ALL
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,ORG.ORG_CD AS PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.EFF_FROM_DT
        FROM
            DS_ORG_UNIT ORG
           ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG =#trtyStruFlg#
        AND ORG.ORG_TIER_CD = '0'
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND ORG.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
      <!--
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
      -->
        </isNotEqual>
        <isEqual property="includeInactive" compareValue='Y'>
        AND ORG.GNRN_TP_CD     != #gnrnTpCdDelete#
        AND ORG.GNRN_TP_CD     != #gnrnTpCdTerminated#
        </isEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
    )

    , NORELN_TOPTIER AS(
        SELECT
            RELN.ORG_CD
          , ORG.ORG_TIER_CD
          , ORG.ORG_NM
          , ORG.FIRST_ORG_CD
          , ORG.TRTY_GRP_TP_CD
          , ORG.TRTY_TP_CD
          , RELN.PRNT_ORG_CD
          , ORG.ORG_STRU_TP_CD
          , ORG.EFF_FROM_DT
        FROM
            DS_ORG_RELN RELN
          , DS_ORG_UNIT ORG
          , ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD                          = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD                         = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD                         = #glblCmpyCd#
        AND ORG.EZCANCELFLAG                          = 0
        AND RELN.EZCANCELFLAG                         = 0
        AND STRU.EZCANCELFLAG                         = 0

       <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD                          = #cMsg.bizAreaOrgCd_P1#
       </isNotNull>
       <isNull property="cMsg.effFromDt_H1">
        AND ORG.EFF_FROM_DT                       &lt;= #slsDt#
       </isNull>
       <isNotNull property="cMsg.effFromDt_H1">
        AND ORG.EFF_FROM_DT                       &gt;= #cMsg.effFromDt_H1#
       </isNotNull>
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#)  &gt;= #slsDt#
        AND (   ORG.GNRN_TP_CD                        = #gnrnTpCdCurrent#
             OR ORG.GNRN_TP_CD                        = #gnrnTpCdFuture#)
        AND ORG.ORG_CD                                = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD                        = RELN.ORG_STRU_TP_CD
        AND RELN.GNRN_TP_CD                          != #gnrnTpCdDelete#
        AND RELN.GNRN_TP_CD                          != #gnrnTpCdTerminated#
       <isNull property="cMsg.effFromDt_H1">
        AND RELN.EFF_FROM_DT                      &lt;= #slsDt#
       </isNull>
       <isNotNull property="cMsg.effFromDt_H1">
        AND RELN.EFF_FROM_DT                      &gt;= #cMsg.effFromDt_H1#
       </isNotNull>
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
        AND (   RELN.GNRN_TP_CD                       = #gnrnTpCdCurrent#
             OR RELN.GNRN_TP_CD                       = #gnrnTpCdFuture#)

        AND ORG.ORG_STRU_TP_CD                        = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG                        = #trtyStruFlg#

        START WITH
            RELN.ORG_CD IN (
                SELECT
                    U.ORG_CD
                FROM
                    DS_ORG_UNIT U
                WHERE
                    U.EZCANCELFLAG  = 0
               <isNotNull property = "cMsg.bizAreaOrgCd_P1">
                AND U.FIRST_ORG_CD   =  #cMsg.bizAreaOrgCd_P1#
                AND U.ORG_CD        !=  #cMsg.bizAreaOrgCd_P1#
               </isNotNull>
               <isNotEqual property = "includeInactive" compareValue='Y'>
                AND U.GNRN_TP_CD    IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
               </isNotEqual>
               <isEqual property = "includeInactive" compareValue='Y'>
                AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
               </isEqual>
                AND U.ORG_CD  NOT IN (
                    SELECT
                        R.ORG_CD
                    FROM
                        DS_ORG_RELN R
                     ,  ORG_STRU_TP STRU
                    WHERE
                        R.ORG_STRU_TP_CD    = STRU.ORG_STRU_TP_CD
                    AND STRU.TRTY_STRU_FLG  = #trtyStruFlg#
                    AND R.GNRN_TP_CD       IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
                    AND R.GLBL_CMPY_CD      = #glblCmpyCd#
                    AND STRU.GLBL_CMPY_CD   = #glblCmpyCd#
                    AND R.EZCANCELFLAG      = 0
                    AND STRU.EZCANCELFLAG   = 0
                )
            )

        CONNECT BY NOCYCLE PRIOR
                RELN.ORG_CD                               =  RELN.PRNT_ORG_CD
            AND RELN.EZCANCELFLAG                         =  0
            AND RELN.GLBL_CMPY_CD                         =  #glblCmpyCd#
            AND RELN.EFF_FROM_DT                      &lt;=  #slsDt#
            AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
            AND RELN.GNRN_TP_CD                          IN  (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
    )

    ,RELN_PSN AS(
        SELECT
            RELN.ORG_CD
            ,RELN.PSN_CD
            ,RELN.ACCT_TEAM_ROLE_TP_CD
        FROM
            (
                SELECT
                    <!-- RANK() OVER(PARTITION BY RELN.GLBL_CMPY_CD, RELN.ORG_CD ORDER BY RELN.PSN_CD) RNK -->
                    RANK() OVER(PARTITION BY RELN.GLBL_CMPY_CD, RELN.ORG_CD ORDER BY RELN.ACCT_TEAM_ROLE_TP_CD NULLS FIRST, RELN.PSN_CD) RNK
                    ,RELN.ORG_CD
                    ,RELN.PSN_CD
                    ,RELN.ACCT_TEAM_ROLE_TP_CD
                FROM
                    DS_ORG_RESRC_RELN RELN
                  , ORG_FUNC_ASG      ASG
                <!-- 2017/08/25 QC#20588 Add Start -->
                <isEqual property="rsrcSrch" compareValue='Y'>
                  , (
                        SELECT
                               ORG_RELN.GLBL_CMPY_CD
                              ,ORG_RELN.ORG_CD
                              ,ORG_RELN.PSN_CD
                        FROM
                               DS_ORG_RESRC_RELN ORG_RELN
                              ,S21_PSN           PSN
                        WHERE
                               ORG_RELN.GLBL_CMPY_CD                         = #glblCmpyCd#
                          AND  ORG_RELN.EZCANCELFLAG                         = '0'
                          AND  PSN.GLBL_CMPY_CD                              = ORG_RELN.GLBL_CMPY_CD
                          AND  PSN.PSN_CD                                    = ORG_RELN.PSN_CD
                          AND  PSN.EZCANCELFLAG                              = '0'
                        <isNotNull property="psnCd_H1">
                          AND  PSN.PSN_CD                                 LIKE #psnCd_H1#
                        </isNotNull>
                        <isNotNull property="psnNum_H1">
                          AND  PSN.PSN_NUM                                LIKE #psnNum_H1#
                        </isNotNull>
                        <isNotNull property="xxPsnNm_H1">
                          AND (
                                  UPPER(PSN.PSN_LAST_NM)  LIKE UPPER(#xxPsnNm_H1#)
                              OR  UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#xxPsnNm_H1#)
                              OR  UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#xxPsnNm_H1#)
                              )
                        </isNotNull>
                        <isEqual property="includeInactive" compareValue='Y'>
                          AND  ORG_RELN.GNRN_TP_CD                          != #gnrnTpCdDelete#
                          AND  ORG_RELN.GNRN_TP_CD                          != #gnrnTpCdTerminated#
                        </isEqual>
                        <isNotEqual property="includeInactive" compareValue='Y'>
                          AND  ORG_RELN.EFF_FROM_DT                      &lt;= #slsDt#
                        </isNotEqual>
                        <isNull property="cMsg.effFromDt_H1">
                          AND  ORG_RELN.EFF_FROM_DT                      &lt;= #slsDt#
                          AND  PSN.EFF_FROM_DT                           &lt;= #slsDt#
                        </isNull>
                        <isNotNull property="cMsg.effFromDt_H1">
                          AND  ORG_RELN.EFF_FROM_DT                      &gt;= #cMsg.effFromDt_H1#
                          AND  PSN.EFF_FROM_DT                           &gt;= #cMsg.effFromDt_H1#
                        </isNotNull>
                          AND  NVL(ORG_RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
                          AND  NVL(PSN.EFF_THRU_DT, #maxeffThruDt#)      &gt;= #slsDt#
                        GROUP BY
                               ORG_RELN.GLBL_CMPY_CD
                              ,ORG_RELN.ORG_CD
                              ,ORG_RELN.PSN_CD
                  )                   ORG_RELN
                </isEqual>
                <!-- 2017/08/25 QC#20588 Add End -->
                WHERE
                    RELN.GLBL_CMPY_CD    = #glblCmpyCd#
                AND RELN.EZCANCELFLAG    = '0'
                <isNotEqual property="includeInactive" compareValue='Y'>
                AND RELN.EFF_FROM_DT                  &lt;=  #slsDt#
                AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
              <!-- AND (RELN.GNRN_TP_CD     = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD = #gnrnTpCdFuture#) -->
                </isNotEqual>
                <isEqual property="includeInactive" compareValue='Y'>
                AND RELN.GNRN_TP_CD     != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD     != #gnrnTpCdTerminated#
                </isEqual>
                <isNull property="cMsg.effFromDt_H1">
                AND RELN.EFF_FROM_DT &lt;= #slsDt#
                AND ASG.EFF_FROM_DT &lt;= #slsDt#
                </isNull>
                <isNotNull property="cMsg.effFromDt_H1">
                AND RELN.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
                AND ASG.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
                </isNotNull>
                AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
                AND NVL(ASG.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#

                AND RELN.GLBL_CMPY_CD    = ASG.GLBL_CMPY_CD
                AND RELN.PSN_CD          = ASG.PSN_CD
                <isNotEqual property="includeInactive" compareValue='Y'>
                AND ASG.EFF_FROM_DT                  &lt;=  #slsDt#
                AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
              <!-- AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD = #gnrnTpCdFuture#) -->
                </isNotEqual>
                <isEqual property="includeInactive" compareValue='Y'>
                AND ASG.GNRN_TP_CD != #gnrnTpCdDelete#
                AND ASG.GNRN_TP_CD != #gnrnTpCdTerminated#
                </isEqual>
                AND ASG.EZCANCELFLAG     = '0'
                <!-- 2017/08/25 QC#20588 Add Start -->
                <isEqual property="rsrcSrch" compareValue='Y'>
                AND RELN.GLBL_CMPY_CD = ORG_RELN.GLBL_CMPY_CD
                AND RELN.ORG_CD       = ORG_RELN.ORG_CD
                AND RELN.PSN_CD       = ORG_RELN.PSN_CD
                </isEqual>
                <!-- 2017/08/25 QC#20588 Add End -->
            ) RELN
        WHERE
            RELN.RNK = 1
    )

    ,PSN_TOC AS(
        SELECT
            ASG.TOC_CD
            ,ASG.PSN_CD
        FROM
            (
                SELECT
                    RANK() OVER(PARTITION BY GLBL_CMPY_CD, ASG.PSN_CD ORDER BY ASG.TOC_CD) RNK
                    ,ASG.TOC_CD
                    ,ASG.PSN_CD
                FROM
                    ORG_FUNC_ASG ASG
                WHERE
                    ASG.GLBL_CMPY_CD = #glblCmpyCd#
                AND ASG.EZCANCELFLAG = '0'
                <isNotEqual property="includeInactive" compareValue='Y'>
                AND ASG.EFF_FROM_DT                  &lt;=  #slsDt#
                AND NVL(ASG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
              <!-- AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD = #gnrnTpCdFuture#) -->
                </isNotEqual>
                <isEqual property="includeInactive" compareValue='Y'>
                AND ASG.GNRN_TP_CD != #gnrnTpCdDelete#
                AND ASG.GNRN_TP_CD != #gnrnTpCdTerminated#
                </isEqual>
            ) ASG
        WHERE
            ASG.RNK = 1
    )

   ,RESRC AS (
    SELECT
        RELN.ORG_CD
        ,PSN.PSN_CD
        ,CASE WHEN RELN.ACCT_TEAM_ROLE_TP_CD IS NOT NULL THEN NULL ELSE PSN.PSN_FIRST_NM END PSN_FIRST_NM
        ,CASE WHEN RELN.ACCT_TEAM_ROLE_TP_CD IS NOT NULL THEN NULL ELSE PSN.PSN_LAST_NM END PSN_LAST_NM
        ,ROLE.MGR_FLG
        ,ROLE.ORG_FUNC_ROLE_TP_CD
        ,CASE WHEN RELN.ACCT_TEAM_ROLE_TP_CD IS NOT NULL THEN NULL ELSE ROLE.ORG_FUNC_ROLE_TP_NM END ORG_FUNC_ROLE_TP_NM
        ,RQST.TOC_CD
        ,PSN.PSN_NUM
    FROM
        ORG_STRU_TP STRU
        ,RELN_PSN RELN
        ,ORG_TOC_CHNG_RQST RQST
        ,PSN_TOC ASG
        ,S21_PSN PSN
        ,ORG_FUNC_ROLE_TP ROLE
    WHERE
        STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND RQST.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND RQST.EZCANCELFLAG = '0'
    AND PSN.EZCANCELFLAG = '0'
    AND ROLE.EZCANCELFLAG = '0'
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND RELN.PSN_CD = PSN.PSN_CD
    AND ASG.PSN_CD = PSN.PSN_CD
    AND ASG.TOC_CD = RQST.TOC_CD
    AND RQST.ORG_FUNC_ROLE_TP_CD = ROLE.ORG_FUNC_ROLE_TP_CD
    <!--AND STRU.ORG_STRU_TP_CD  = ROLE.ORG_STRU_TP_CD-->
    <isNotEqual property="includeInactive" compareValue='Y'>
    AND (RQST.RGTN_STS_CD        = #rgtnStsCdP01#
      OR RQST.RGTN_STS_CD        = #rgtnStsCdP20#)
    </isNotEqual>
    <isNull property="cMsg.effFromDt_H1">
    AND PSN.EFF_FROM_DT      &lt;= #slsDt#
    </isNull>
    <isNotNull property="cMsg.effFromDt_H1">
    AND PSN.EFF_FROM_DT      &gt;= #cMsg.effFromDt_H1#
    </isNotNull>
    AND NVL(PSN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#

    )
    
    ,ORG1 AS(SELECT * FROM WRK)
    ,ORG2 AS(SELECT * FROM WRK)
    ,ORG3 AS(SELECT * FROM WRK)
    ,ORG4 AS(SELECT * FROM WRK)
    ,ORG5 AS(SELECT * FROM WRK)
    ,ORG6 AS(SELECT * FROM WRK)
    ,ORG7 AS(SELECT * FROM WRK)
    ,ORG8 AS(SELECT * FROM WRK)
    ,ORG9 AS(SELECT * FROM WRK)
    ,ORG10 AS(SELECT * FROM WRK)
    
    ,HIERARCHY AS(
        SELECT
            ORG1.ORG_CD
            ,ORG1.ORG_TIER_CD
            ,ORG1.ORG_STRU_TP_CD
            --FIRST   
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.ORG_NM
            END AS FIRST_ORG_NM
            --THIRD          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.ORG_NM
            END AS SCD_ORG_NM
            --FRTH          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.ORG_NM
            END AS THIRD_ORG_NM
            --FIFTH         
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.ORG_NM
            END AS FRTH_ORG_NM
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.ORG_NM
            END AS FIFTH_ORG_NM
            --SVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.ORG_NM
            END AS SIXTH_ORG_NM
            --EIGHTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.ORG_NM
            END AS SVNTH_ORG_NM
            --NINTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.ORG_NM
            END AS EIGHTH_ORG_NM
            --TENTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.ORG_NM
            END AS NINTH_ORG_NM
            --ELEVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.ORG_NM
            END AS TENTH_ORG_NM

       <isNotNull property="cMsg.trtyGrpTpCd_P1">
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.TRTY_GRP_TP_CD
            END AS FIRST_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.TRTY_GRP_TP_CD
            END AS SCD_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.TRTY_GRP_TP_CD
            END AS THIRD_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.TRTY_GRP_TP_CD
            END AS FRTH_TRTY_GRP_TP_CD
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.TRTY_GRP_TP_CD
            END AS FIFTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.TRTY_GRP_TP_CD
            END AS SIXTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.TRTY_GRP_TP_CD
            END AS SVNTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.TRTY_GRP_TP_CD
            END AS EIGHTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.TRTY_GRP_TP_CD
            END AS NINTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.TRTY_GRP_TP_CD
            END AS TENTH_TRTY_GRP_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.trtyTpCd_P1">
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.TRTY_TP_CD
            END AS FIRST_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.TRTY_TP_CD
            END AS SCD_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.TRTY_TP_CD
            END AS THIRD_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.TRTY_TP_CD
            END AS FRTH_TRTY_TP_CD
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.TRTY_TP_CD
            END AS FIFTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.TRTY_TP_CD
            END AS SIXTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.TRTY_TP_CD
            END AS SVNTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.TRTY_TP_CD
            END AS EIGHTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.TRTY_TP_CD
            END AS NINTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.TRTY_TP_CD
            END AS TENTH_TRTY_TP_CD
       </isNotNull>

       <isNotNull property="cMsg.effFromDt_H1">
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.EFF_FROM_DT
            END AS FIRST_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.EFF_FROM_DT
            END AS SCD_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.EFF_FROM_DT
            END AS THIRD_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.EFF_FROM_DT
            END AS FRTH_EFF_FROM_DT
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.EFF_FROM_DT
            END AS FIFTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.EFF_FROM_DT
            END AS SIXTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.EFF_FROM_DT
            END AS SVNTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.EFF_FROM_DT
            END AS EIGHTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.EFF_FROM_DT
            END AS NINTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.EFF_FROM_DT
            END AS TENTH_EFF_FROM_DT
       </isNotNull>

        FROM
            ORG1
            ,ORG2
            ,ORG3
            ,ORG4
            ,ORG5
            ,ORG6
            ,ORG7
            ,ORG8
            ,ORG9
            ,ORG10
        WHERE
            ORG1.PRNT_ORG_CD = ORG2.ORG_CD
        AND ORG2.PRNT_ORG_CD = ORG3.ORG_CD
        AND ORG3.PRNT_ORG_CD = ORG4.ORG_CD
        AND ORG4.PRNT_ORG_CD = ORG5.ORG_CD
        AND ORG5.PRNT_ORG_CD = ORG6.ORG_CD
        AND ORG6.PRNT_ORG_CD = ORG7.ORG_CD
        AND ORG7.PRNT_ORG_CD = ORG8.ORG_CD
        AND ORG8.PRNT_ORG_CD = ORG9.ORG_CD
        AND ORG9.PRNT_ORG_CD = ORG10.ORG_CD

        UNION ALL
        -- Obtain Organization that do not have parent
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
       <isNotNull property="cMsg.trtyGrpTpCd_P1">
            ,ORG.TRTY_GRP_TP_CD AS FIRST_TRTY_GRP_TP_CD
            ,NULL AS SCD_TRTY_GRP_TP_CD
            ,NULL AS THIRD_TRTY_GRP_TP_CD
            ,NULL AS FRTH_TRTY_GRP_TP_CD
            ,NULL AS FIFTH_TRTY_GRP_TP_CD
            ,NULL AS SIXTH_TRTY_GRP_TP_CD
            ,NULL AS SVNTH_TRTY_GRP_TP_CD
            ,NULL AS EIGHTH_TRTY_GRP_TP_CD
            ,NULL AS NINTH_TRTY_GRP_TP_CD
            ,NULL AS TENTH_TRTY_GRP_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.trtyTpCd_P1">
            ,ORG.TRTY_TP_CD AS FIRST_TRTY_TP_CD
            ,NULL AS SCD_TRTY_TP_CD
            ,NULL AS THIRD_TRTY_TP_CD
            ,NULL AS FRTH_TRTY_TP_CD
            ,NULL AS FIFTH_TRTY_TP_CD
            ,NULL AS SIXTH_TRTY_TP_CD
            ,NULL AS SVNTH_TRTY_TP_CD
            ,NULL AS EIGHTH_TRTY_TP_CD
            ,NULL AS NINTH_TRTY_TP_CD
            ,NULL AS TENTH_TRTY_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.effFromDt_H1">
            ,ORG.EFF_FROM_DT AS FIRST_EFF_FROM_DT
            ,NULL AS SCD_EFF_FROM_DT
            ,NULL AS THIRD_EFF_FROM_DT
            ,NULL AS FRTH_EFF_FROM_DT
            ,NULL AS FIFTH_EFF_FROM_DT
            ,NULL AS SIXTH_EFF_FROM_DT
            ,NULL AS SVNTH_EFF_FROM_DT
            ,NULL AS EIGHTH_EFF_FROM_DT
            ,NULL AS NINTH_EFF_FROM_DT
            ,NULL AS TENTH_EFF_FROM_DT
       </isNotNull>
        FROM
            DS_ORG_UNIT ORG
         ,  ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD    = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD   = #glblCmpyCd#
        AND ORG.EZCANCELFLAG    = '0'
        AND STRU.EZCANCELFLAG   = '0'
        AND ORG.ORG_STRU_TP_CD  = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG  = #trtyStruFlg#
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND ORG.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
      <!--
        AND (   ORG.GNRN_TP_CD  = #gnrnTpCdCurrent#
             OR ORG.GNRN_TP_CD  = #gnrnTpCdFuture#)
      -->
        </isNotEqual>
        <isEqual property="includeInactive" compareValue='Y'>
        AND ORG.GNRN_TP_CD     != #gnrnTpCdDelete#
        AND ORG.GNRN_TP_CD     != #gnrnTpCdTerminated#
        </isEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD    = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        AND NOT EXISTS(
                SELECT
                    1
                FROM
                    DS_ORG_RELN RELN
                WHERE
                    RELN.GLBL_CMPY_CD   = #glblCmpyCd#
                AND RELN.EZCANCELFLAG   = '0'
                AND RELN.ORG_CD         = ORG.ORG_CD
                AND RELN.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
                AND RELN.GNRN_TP_CD    != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD    != #gnrnTpCdTerminated#
                AND ORG.ORG_TIER_CD &gt;= #firstTierCd#
            )

        UNION ALL
        -- Obtain Organization that are not connected with top tier(BIZ_AREA)
        SELECT
            NOR.ORG_CD
            ,NOR.ORG_TIER_CD
            ,NOR.ORG_STRU_TP_CD
            ,NOR.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
       <isNotNull property="cMsg.trtyGrpTpCd_P1">
            ,NOR.TRTY_GRP_TP_CD AS FIRST_TRTY_GRP_TP_CD
            ,NULL AS SCD_TRTY_GRP_TP_CD
            ,NULL AS THIRD_TRTY_GRP_TP_CD
            ,NULL AS FRTH_TRTY_GRP_TP_CD
            ,NULL AS FIFTH_TRTY_GRP_TP_CD
            ,NULL AS SIXTH_TRTY_GRP_TP_CD
            ,NULL AS SVNTH_TRTY_GRP_TP_CD
            ,NULL AS EIGHTH_TRTY_GRP_TP_CD
            ,NULL AS NINTH_TRTY_GRP_TP_CD
            ,NULL AS TENTH_TRTY_GRP_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.trtyTpCd_P1">
            ,NOR.TRTY_TP_CD AS FIRST_TRTY_TP_CD
            ,NULL AS SCD_TRTY_TP_CD
            ,NULL AS THIRD_TRTY_TP_CD
            ,NULL AS FRTH_TRTY_TP_CD
            ,NULL AS FIFTH_TRTY_TP_CD
            ,NULL AS SIXTH_TRTY_TP_CD
            ,NULL AS SVNTH_TRTY_TP_CD
            ,NULL AS EIGHTH_TRTY_TP_CD
            ,NULL AS NINTH_TRTY_TP_CD
            ,NULL AS TENTH_TRTY_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.effFromDt_H1">
            ,NOR.EFF_FROM_DT AS FIRST_EFF_FROM_DT
            ,NULL AS SCD_EFF_FROM_DT
            ,NULL AS THIRD_EFF_FROM_DT
            ,NULL AS FRTH_EFF_FROM_DT
            ,NULL AS FIFTH_EFF_FROM_DT
            ,NULL AS SIXTH_EFF_FROM_DT
            ,NULL AS SVNTH_EFF_FROM_DT
            ,NULL AS EIGHTH_EFF_FROM_DT
            ,NULL AS NINTH_EFF_FROM_DT
            ,NULL AS TENTH_EFF_FROM_DT
       </isNotNull>
        FROM
            NORELN_TOPTIER NOR
    )

    SELECT
         H.ORG_CD
        ,H.ORG_TIER_CD
        ,H.FIRST_ORG_NM
        ,H.SCD_ORG_NM
        ,H.THIRD_ORG_NM
        ,H.FRTH_ORG_NM
        ,H.FIFTH_ORG_NM
        ,H.SIXTH_ORG_NM
        ,H.SVNTH_ORG_NM
        ,H.EIGHTH_ORG_NM
        ,H.NINTH_ORG_NM
        ,H.TENTH_ORG_NM
        ,NVL(R.PSN_FIRST_NM,'') || ' ' || NVL(R.PSN_LAST_NM,'') AS PSN_NM
        ,R.ORG_FUNC_ROLE_TP_NM AS ORG_FUNC_ROLE_TP_NM
        ,R.PSN_NUM AS PSN_NUM
    FROM
        HIERARCHY H, RESRC R
    WHERE
    <isNotEqual property="rsrcSrch" compareValue='Y'>
        H.ORG_CD = R.ORG_CD(+)
    </isNotEqual>
    <isEqual property="rsrcSrch" compareValue='Y'>
        H.ORG_CD = R.ORG_CD
    </isEqual>
    AND H.ORG_TIER_CD &gt;= #firstTierCd#
    <!-- 2017/08/25 QC#20588 Del Start -->
   <!-- <isNotNull property="cMsg.psnCd_H1"> -->
   <!--  AND R.PSN_CD   LIKE #cMsg.psnCd_H1# -->
   <!-- </isNotNull> -->
   <!-- <isNotNull property="cMsg.psnNum_H1"> -->
   <!--  AND R.PSN_NUM  LIKE #cMsg.psnNum_H1# -->
   <!-- </isNotNull> -->
   <!-- <isNotNull property="cMsg.xxPsnNm_H1"> -->
   <!--  AND ( -->
   <!--          UPPER(R.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#) -->
   <!--      OR  UPPER(R.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#) -->
   <!--      OR  UPPER(R.PSN_FIRST_NM) || ' ' || UPPER(R.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#) -->
   <!--      ) -->
   <!-- </isNotNull> -->
    <!-- 2017/08/25 QC#20588 Del End -->
   <isNotNull property="cMsg.trtyGrpTpCd_P1">
    AND ( FIRST_TRTY_GRP_TP_CD = #cMsg.trtyGrpTpCd_P1#
         OR H.SCD_TRTY_GRP_TP_CD    = #cMsg.trtyGrpTpCd_P1#
         OR H.THIRD_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.FRTH_TRTY_GRP_TP_CD   = #cMsg.trtyGrpTpCd_P1#
         OR H.FIFTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.SIXTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.SVNTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.EIGHTH_TRTY_GRP_TP_CD = #cMsg.trtyGrpTpCd_P1#
         OR H.NINTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.TENTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
        )
   </isNotNull>
   <isNotNull property="cMsg.orgNm_H1">
     AND ( H.FIRST_ORG_NM     LIKE #cMsg.orgNm_H1#
         OR H.SCD_ORG_NM     LIKE #cMsg.orgNm_H1#
         OR H.THIRD_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.FRTH_ORG_NM    LIKE #cMsg.orgNm_H1#
         OR H.FIFTH_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.SIXTH_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.SVNTH_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.EIGHTH_ORG_NM  LIKE #cMsg.orgNm_H1#
         OR H.NINTH_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.TENTH_ORG_NM   LIKE #cMsg.orgNm_H1#
        )
   </isNotNull>
   <isNotNull property="cMsg.trtyTpCd_P1">
     AND ( H.FIRST_TRTY_TP_CD    = #cMsg.trtyTpCd_P1#
         OR H.SCD_TRTY_TP_CD    = #cMsg.trtyTpCd_P1#
         OR H.THIRD_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.FRTH_TRTY_TP_CD   = #cMsg.trtyTpCd_P1#
         OR H.FIFTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.SIXTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.SVNTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.EIGHTH_TRTY_TP_CD = #cMsg.trtyTpCd_P1#
         OR H.NINTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.TENTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
        )
   </isNotNull>
   <isNotNull property="cMsg.effFromDt_H1">
     AND ( H.FIRST_EFF_FROM_DT    &gt;= #cMsg.effFromDt_H1#
         OR H.SCD_EFF_FROM_DT    &gt;= #cMsg.effFromDt_H1#
         OR H.THIRD_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.FRTH_EFF_FROM_DT   &gt;= #cMsg.effFromDt_H1#
         OR H.FIFTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.SIXTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.SVNTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.EIGHTH_EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
         OR H.NINTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.TENTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
        )
   </isNotNull>
   <isEqual property="orgTierCd" compareValue='1'>
    AND H.FIRST_ORG_NM    IS NOT NULL
   </isEqual>
     <isEqual property="orgTierCd" compareValue='2'>
    AND H.SCD_ORG_NM      IS NOT NULL
     </isEqual>
     <isEqual property="orgTierCd" compareValue='3'>
    AND H.THIRD_ORG_NM    IS NOT NULL
     </isEqual>
     <isEqual property="orgTierCd" compareValue='4'>
    AND H.FRTH_ORG_NM     IS NOT NULL
     </isEqual>
     <isEqual property="orgTierCd" compareValue='5'>
    AND H.FIFTH_ORG_NM    IS NOT NULL
     </isEqual>
     <isEqual property="orgTierCd" compareValue='6'>
    AND H.SIXTH_ORG_NM    IS NOT NULL
     </isEqual>
     <isEqual property="orgTierCd" compareValue='7'>
    AND H.SVNTH_ORG_NM    IS NOT NULL
     </isEqual>
     <isEqual property="orgTierCd" compareValue='8'>
    AND H.EIGHTH_ORG_NM   IS NOT NULL
     </isEqual>
     <isEqual property="orgTierCd" compareValue='9'>
    AND H.NINTH_ORG_NM    IS NOT NULL
     </isEqual>
     <isEqual property="orgTierCd" compareValue='10'>
    AND H.TENTH_ORG_NM    IS NOT NULL
     </isEqual>

    <isNotNull property="AdvSearchFlg1">
    AND H.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
<!-- 2019/11/08 QC#54209 ADD START -->
               <isNotEqual property="includeInactive" compareValue='Y'>
                 AND RULE.EFF_FROM_DT                      &lt;= #slsDt#
                 AND NVL(RULE.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
               </isNotEqual>
<!-- 2019/11/08 QC#54209 ADD END -->
               <isNotNull property="trtyRuleTpCd1">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd1#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd1">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd1#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal1">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal1#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal1">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal1#
               </isNotNull>
               )
    </isNotNull>
    <isNotNull property="AdvSearchFlg2">
    AND H.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
<!-- 2019/11/08 QC#54209 ADD START -->
               <isNotEqual property="includeInactive" compareValue='Y'>
                 AND RULE.EFF_FROM_DT                      &lt;= #slsDt#
                 AND NVL(RULE.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
               </isNotEqual>
<!-- 2019/11/08 QC#54209 ADD END -->
               <isNotNull property="trtyRuleTpCd2">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd2#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd2">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd2#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal2">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal2#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal2">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal2#
               </isNotNull>
               )
    </isNotNull>
    <isNotNull property="AdvSearchFlg3">
    AND H.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
<!-- 2019/11/08 QC#54209 ADD START -->
               <isNotEqual property="includeInactive" compareValue='Y'>
                 AND RULE.EFF_FROM_DT                      &lt;= #slsDt#
                 AND NVL(RULE.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
               </isNotEqual>
<!-- 2019/11/08 QC#54209 ADD END -->
               <isNotNull property="trtyRuleTpCd3">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd3#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd3">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd3#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal3">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal3#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal3">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal3#
               </isNotNull>
               )
    </isNotNull>
    <isNotNull property="AdvSearchFlg4">
    AND H.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
<!-- 2019/11/08 QC#54209 ADD START -->
               <isNotEqual property="includeInactive" compareValue='Y'>
                 AND RULE.EFF_FROM_DT                      &lt;= #slsDt#
                 AND NVL(RULE.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
               </isNotEqual>
<!-- 2019/11/08 QC#54209 ADD END -->
               <isNotNull property="trtyRuleTpCd4">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd4#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd4">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd4#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal4">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal4#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal4">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal4#
               </isNotNull>
               )
    </isNotNull>
    <isNotNull property="AdvSearchFlg5">
    AND H.ORG_CD  IN
               ( SELECT
                     ORG_CD
                 FROM
                     TRTY_RULE RULE
                 WHERE RULE.GLBL_CMPY_CD         = #glblCmpyCd#
                 AND RULE.EZCANCELFLAG           = '0'
<!-- 2019/11/08 QC#54209 ADD START -->
               <isNotEqual property="includeInactive" compareValue='Y'>
                 AND RULE.EFF_FROM_DT                      &lt;= #slsDt#
                 AND NVL(RULE.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
               </isNotEqual>
<!-- 2019/11/08 QC#54209 ADD END -->
               <isNotNull property="trtyRuleTpCd5">
                 AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd5#
               </isNotNull>
               <isNotNull property="trtyRuleOprdTpCd5">
                 AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd5#
               </isNotNull>
               <isNotNull property="trtyRuleFromVal5">
                 AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal5#
               </isNotNull>
               <isNotNull property="trtyRuleThruVal5">
                 AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal5#
               </isNotNull>
               )
    </isNotNull>
    ORDER BY
        FIRST_ORG_NM NULLS FIRST
        ,SCD_ORG_NM NULLS FIRST
        ,THIRD_ORG_NM NULLS FIRST
        ,FRTH_ORG_NM NULLS FIRST
        ,FIFTH_ORG_NM NULLS FIRST
        ,SIXTH_ORG_NM NULLS FIRST
        ,SVNTH_ORG_NM NULLS FIRST
        ,EIGHTH_ORG_NM NULLS FIRST
        ,NINTH_ORG_NM NULLS FIRST
        ,TENTH_ORG_NM NULLS FIRST
        ,ORG_TIER_CD
    </statement>

    <statement id="getTerritoryWithRules" parameterClass="Map" resultMap="result.getHierarchy">
    WITH WRK AS(
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,RELN.PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.EFF_FROM_DT
        FROM
            DS_ORG_UNIT ORG
            ,DS_ORG_RELN RELN
            ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND RELN.EZCANCELFLAG = '0'
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
        AND ORG.ORG_CD = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD = RELN.ORG_STRU_TP_CD
        <isNotEqual property="includeInactive" compareValue='Y'>
       <!-- 2018/03/07 QC#20233-1 add start -->
        AND RELN.GNRN_TP_CD != #gnrnTpCdPast#
       <!-- 2018/03/07 QC#20233-1 add end -->
        AND RELN.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
        AND ORG.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
        </isNotEqual>
      <!--
        AND (RELN.GNRN_TP_CD = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD = #gnrnTpCdFuture#)
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#)
        </isNotEqual>
      -->
        <isEqual property="includeInactive" compareValue='Y'>
        AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
        AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
        </isEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>

        UNION ALL
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_NM
            ,ORG.FIRST_ORG_CD
            ,ORG.TRTY_GRP_TP_CD
            ,ORG.TRTY_TP_CD
            ,ORG.ORG_CD AS PRNT_ORG_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.EFF_FROM_DT
        FROM
            DS_ORG_UNIT ORG
           ,ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD = #glblCmpyCd#
        AND ORG.EZCANCELFLAG = '0'
        AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
        AND STRU.EZCANCELFLAG = '0'
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG =#trtyStruFlg#
        AND ORG.ORG_TIER_CD = '0'
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND ORG.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
      <!-- AND (ORG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ORG.GNRN_TP_CD =#gnrnTpCdFuture#) -->
        </isNotEqual>
        <isEqual property="includeInactive" compareValue='Y'>
        AND ORG.GNRN_TP_CD     != #gnrnTpCdDelete#
        AND ORG.GNRN_TP_CD     != #gnrnTpCdTerminated#
        </isEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
    )

    , NORELN_TOPTIER AS(
        SELECT
            RELN.ORG_CD
          , ORG.ORG_TIER_CD
          , ORG.ORG_NM
          , ORG.FIRST_ORG_CD
          , ORG.TRTY_GRP_TP_CD
          , ORG.TRTY_TP_CD
          , RELN.PRNT_ORG_CD
          , ORG.ORG_STRU_TP_CD
          , ORG.EFF_FROM_DT
        FROM
            DS_ORG_RELN RELN
          , DS_ORG_UNIT ORG
          , ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD                          = #glblCmpyCd#
        AND RELN.GLBL_CMPY_CD                         = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD                         = #glblCmpyCd#
        AND ORG.EZCANCELFLAG                          = 0
        AND RELN.EZCANCELFLAG                         = 0
        AND STRU.EZCANCELFLAG                         = 0

       <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD                          = #cMsg.bizAreaOrgCd_P1#
       </isNotNull>
       <isNull property="cMsg.effFromDt_H1">
        AND ORG.EFF_FROM_DT                       &lt;= #slsDt#
       </isNull>
       <isNotNull property="cMsg.effFromDt_H1">
        AND ORG.EFF_FROM_DT                       &gt;= #cMsg.effFromDt_H1#
       </isNotNull>
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#)  &gt;= #slsDt#
        AND (   ORG.GNRN_TP_CD                        = #gnrnTpCdCurrent#
             OR ORG.GNRN_TP_CD                        = #gnrnTpCdFuture#)
        AND ORG.ORG_CD                                = RELN.ORG_CD
        AND ORG.ORG_STRU_TP_CD                        = RELN.ORG_STRU_TP_CD
        AND RELN.GNRN_TP_CD                          != #gnrnTpCdDelete#
        AND RELN.GNRN_TP_CD                          != #gnrnTpCdTerminated#
       <isNull property="cMsg.effFromDt_H1">
        AND RELN.EFF_FROM_DT                      &lt;= #slsDt#
       </isNull>
       <isNotNull property="cMsg.effFromDt_H1">
        AND RELN.EFF_FROM_DT                      &gt;= #cMsg.effFromDt_H1#
       </isNotNull>
        AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
        AND (   RELN.GNRN_TP_CD                       = #gnrnTpCdCurrent#
             OR RELN.GNRN_TP_CD                       = #gnrnTpCdFuture#)

        AND ORG.ORG_STRU_TP_CD                        = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG                        = #trtyStruFlg#

        START WITH
            RELN.ORG_CD IN (
                SELECT
                    U.ORG_CD
                FROM
                    DS_ORG_UNIT U
                WHERE
                    U.EZCANCELFLAG  = 0
               <isNotNull property = "cMsg.bizAreaOrgCd_P1">
                AND U.FIRST_ORG_CD   =  #cMsg.bizAreaOrgCd_P1#
                AND U.ORG_CD        !=  #cMsg.bizAreaOrgCd_P1#
               </isNotNull>
               <isNotEqual property = "includeInactive" compareValue='Y'>
                AND U.GNRN_TP_CD    IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
               </isNotEqual>
               <isEqual property = "includeInactive" compareValue='Y'>
                AND RELN.GNRN_TP_CD != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD != #gnrnTpCdTerminated#
               </isEqual>
                AND U.ORG_CD  NOT IN (
                    SELECT
                        R.ORG_CD
                    FROM
                        DS_ORG_RELN R
                     ,  ORG_STRU_TP STRU
                    WHERE
                        R.ORG_STRU_TP_CD    = STRU.ORG_STRU_TP_CD
                    AND STRU.TRTY_STRU_FLG  = #trtyStruFlg#
                    AND R.GNRN_TP_CD       IN (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
                    AND R.GLBL_CMPY_CD      = #glblCmpyCd#
                    AND STRU.GLBL_CMPY_CD   = #glblCmpyCd#
                    AND R.EZCANCELFLAG      = 0
                    AND STRU.EZCANCELFLAG   = 0
                )
            )

        CONNECT BY NOCYCLE PRIOR
                RELN.ORG_CD                               =  RELN.PRNT_ORG_CD
            AND RELN.EZCANCELFLAG                         =  0
            AND RELN.GLBL_CMPY_CD                         =  #glblCmpyCd#
            AND RELN.EFF_FROM_DT                      &lt;=  #slsDt#
            AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
            AND RELN.GNRN_TP_CD                          IN  (#gnrnTpCdCurrent#, #gnrnTpCdFuture#)
    )

    ,RELN_PSN AS(
        SELECT
            RELN.ORG_CD
            ,RELN.PSN_CD
        FROM
            (
                SELECT
                    RANK() OVER(PARTITION BY RELN.GLBL_CMPY_CD, RELN.ORG_CD ORDER BY RELN.PSN_CD) RNK
                    ,RELN.ORG_CD
                    ,RELN.PSN_CD
                FROM
                    DS_ORG_RESRC_RELN RELN
                  , ORG_FUNC_ASG      ASG
                WHERE
                    RELN.GLBL_CMPY_CD    = #glblCmpyCd#
                AND RELN.EZCANCELFLAG    = '0'
                <isNotEqual property="includeInactive" compareValue='Y'>
                AND (RELN.GNRN_TP_CD     = #gnrnTpCdCurrent# OR RELN.GNRN_TP_CD = #gnrnTpCdFuture#)
                </isNotEqual>
                <isEqual property="includeInactive" compareValue='Y'>
                AND RELN.GNRN_TP_CD     != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD     != #gnrnTpCdTerminated#
                </isEqual>
                <isNull property="cMsg.effFromDt_H1">
                AND RELN.EFF_FROM_DT &lt;= #slsDt#
                AND ASG.EFF_FROM_DT &lt;= #slsDt#
                </isNull>
                <isNotNull property="cMsg.effFromDt_H1">
                AND RELN.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
                AND ASG.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
                </isNotNull>
                AND NVL(RELN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
                AND NVL(ASG.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#

                AND RELN.GLBL_CMPY_CD    = ASG.GLBL_CMPY_CD
                AND RELN.PSN_CD          = ASG.PSN_CD
                <isNotEqual property="includeInactive" compareValue='Y'>
                AND (ASG.GNRN_TP_CD = #gnrnTpCdCurrent# OR ASG.GNRN_TP_CD = #gnrnTpCdFuture#)
                </isNotEqual>
                <isEqual property="includeInactive" compareValue='Y'>
                AND ASG.GNRN_TP_CD != #gnrnTpCdDelete#
                AND ASG.GNRN_TP_CD != #gnrnTpCdTerminated#
                </isEqual>
                AND ASG.EZCANCELFLAG     = '0'
            ) RELN
        WHERE
            RELN.RNK = 1
    )

    ,PSN_TOC AS(
        SELECT
            ASG.TOC_CD
            ,ASG.PSN_CD
        FROM
            (
                SELECT
                    RANK() OVER(PARTITION BY GLBL_CMPY_CD, ASG.PSN_CD ORDER BY ASG.TOC_CD) RNK
                    ,ASG.TOC_CD
                    ,ASG.PSN_CD
                FROM
                    ORG_FUNC_ASG ASG
                WHERE
                    ASG.GLBL_CMPY_CD = #glblCmpyCd#
                AND ASG.EZCANCELFLAG = '0'
                <isNotEqual property="includeInactive" compareValue='Y'>
                AND ASG.EFF_FROM_DT                  &lt;=  #slsDt#
                AND NVL(ASG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
                </isNotEqual>
                <isEqual property="includeInactive" compareValue='Y'>
                AND ASG.GNRN_TP_CD != #gnrnTpCdDelete#
                AND ASG.GNRN_TP_CD != #gnrnTpCdTerminated#
                </isEqual>
            ) ASG
        WHERE
            ASG.RNK = 1
    )

   ,RESRC AS (
    SELECT
        RELN.ORG_CD
        ,PSN.PSN_CD
        ,PSN.PSN_FIRST_NM
        ,PSN.PSN_LAST_NM
        ,ROLE.MGR_FLG
        ,ROLE.ORG_FUNC_ROLE_TP_CD
        ,ROLE.ORG_FUNC_ROLE_TP_NM
        ,RQST.TOC_CD
        ,PSN.PSN_NUM
    FROM
        ORG_STRU_TP STRU
        ,RELN_PSN RELN
        ,ORG_TOC_CHNG_RQST RQST
        ,PSN_TOC ASG
        ,S21_PSN PSN
        ,ORG_FUNC_ROLE_TP ROLE
    WHERE
        STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND RQST.GLBL_CMPY_CD = #glblCmpyCd#
    AND PSN.GLBL_CMPY_CD = #glblCmpyCd#
    AND ROLE.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND RQST.EZCANCELFLAG = '0'
    AND PSN.EZCANCELFLAG = '0'
    AND ROLE.EZCANCELFLAG = '0'
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND RELN.PSN_CD = PSN.PSN_CD
    AND ASG.PSN_CD = PSN.PSN_CD
    AND ASG.TOC_CD = RQST.TOC_CD
    AND RQST.ORG_FUNC_ROLE_TP_CD = ROLE.ORG_FUNC_ROLE_TP_CD
    <!--AND STRU.ORG_STRU_TP_CD = ROLE.ORG_STRU_TP_CD-->
    <isNotEqual property="includeInactive" compareValue='Y'>
    AND (RQST.RGTN_STS_CD        = #rgtnStsCdP01#
      OR RQST.RGTN_STS_CD        = #rgtnStsCdP20#)
    </isNotEqual>
    <isNull property="cMsg.effFromDt_H1">
    AND PSN.EFF_FROM_DT      &lt;= #slsDt#
    </isNull>
    <isNotNull property="cMsg.effFromDt_H1">
    AND PSN.EFF_FROM_DT      &gt;= #cMsg.effFromDt_H1#
    </isNotNull>
    AND NVL(PSN.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
    )

    ,RULE AS (SELECT
         RULE.ORG_CD
        ,(TP.TRTY_RULE_TP_NM 
         || ' ' || OPRD.TRTY_RULE_OPRD_TP_NM
         || ' ' || RULE.TRTY_RULE_FROM_VAL_TXT
         || ' ' || DECODE(RULE.TRTY_RULE_THRU_VAL_TXT, NULL, '', 'AND' 
         || ' ' || RULE.TRTY_RULE_THRU_VAL_TXT)) AS RULE_DESC
    FROM
        TRTY_RULE RULE
        ,TRTY_RULE_TP TP
        ,TRTY_RULE_OPRD_TP OPRD
        ,(
            SELECT
                TRTY_RULE_PK
            FROM
                (
                    SELECT
                        RANK() OVER(PARTITION BY GLBL_CMPY_CD ,RULE.ORG_CD ORDER BY TRTY_RULE_PK) RNK
                        ,RULE.TRTY_RULE_PK TRTY_RULE_PK
                    FROM
                        TRTY_RULE RULE
                    WHERE
                        RULE.GLBL_CMPY_CD = #glblCmpyCd#
                    AND RULE.EZCANCELFLAG = '0'
                    <isNotEqual property="includeInactive" compareValue='Y'>
                    AND RULE.EFF_FROM_DT &lt;= #slsDt#
                    AND NVL(RULE.EFF_THRU_DT, #maxeffThruDt#) &gt;= #slsDt#
                    </isNotEqual>
                    <isNotNull property="AdvSearchFlg1">
                    AND (
                        1=1
                        <isNotNull property="trtyRuleTpCd1">
                          AND    RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd1#
                        </isNotNull>
                        <isNotNull property="trtyRuleOprdTpCd1">
                          AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd1#
                        </isNotNull>
                        <isNotNull property="trtyRuleFromVal1">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal1#
                        </isNotNull>
                        <isNotNull property="trtyRuleThruVal1">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal1#
                        </isNotNull>
                    )
                    </isNotNull>
                    <isNotNull property="AdvSearchFlg2">
                    OR (
                        1=1
                        <isNotNull property="trtyRuleTpCd1">
                          AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd2#
                        </isNotNull>
                        <isNotNull property="trtyRuleOprdTpCd1">
                          AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd2#
                        </isNotNull>
                        <isNotNull property="trtyRuleFromVal1">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal2#
                        </isNotNull>
                        <isNotNull property="trtyRuleThruVal1">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal2#
                        </isNotNull>
                    )
                    </isNotNull>
                    <isNotNull property="AdvSearchFlg3">
                    OR (
                        1=1
                        <isNotNull property="trtyRuleTpCd1">
                          AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd3#
                        </isNotNull>
                        <isNotNull property="trtyRuleOprdTpCd1">
                          AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd3#
                        </isNotNull>
                        <isNotNull property="trtyRuleFromVal1">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal3#
                        </isNotNull>
                        <isNotNull property="trtyRuleThruVal1">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal3#
                        </isNotNull>
                    )
                    </isNotNull>
                    <isNotNull property="AdvSearchFlg4">
                    OR (
                        1=1
                        <isNotNull property="trtyRuleTpCd1">
                          AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd4#
                        </isNotNull>
                        <isNotNull property="trtyRuleOprdTpCd1">
                          AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd4#
                        </isNotNull>
                        <isNotNull property="trtyRuleFromVal1">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal4#
                        </isNotNull>
                        <isNotNull property="trtyRuleThruVal1">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal4#
                        </isNotNull>
                    )
                    </isNotNull>
                    <isNotNull property="AdvSearchFlg5">
                    OR (
                        1=1
                        <isNotNull property="trtyRuleTpCd1">
                          AND RULE.TRTY_RULE_TP_CD        = #trtyRuleTpCd5#
                        </isNotNull>
                        <isNotNull property="trtyRuleOprdTpCd1">
                          AND RULE.TRTY_RULE_OPRD_TP_CD   = #trtyRuleOprdTpCd5#
                        </isNotNull>
                        <isNotNull property="trtyRuleFromVal1">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal5#
                        </isNotNull>
                        <isNotNull property="trtyRuleThruVal1">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal5#
                        </isNotNull>
                    )
                    </isNotNull>
                ) RNK
            WHERE
                RNK.RNK = 1
        ) ONE_RULE
    WHERE
        RULE.GLBL_CMPY_CD = #glblCmpyCd#
    AND TP.GLBL_CMPY_CD = #glblCmpyCd#
    AND OPRD.GLBL_CMPY_CD = #glblCmpyCd#
    AND RULE.EZCANCELFLAG = '0'
    AND TP.EZCANCELFLAG = '0'
    AND OPRD.EZCANCELFLAG = '0'
    AND RULE.TRTY_RULE_TP_CD = TP.TRTY_RULE_TP_CD
    AND RULE.TRTY_RULE_OPRD_TP_CD = OPRD.TRTY_RULE_OPRD_TP_CD
    AND RULE.TRTY_RULE_PK = ONE_RULE.TRTY_RULE_PK
    )

    ,ORG1 AS(SELECT * FROM WRK)
    ,ORG2 AS(SELECT * FROM WRK)
    ,ORG3 AS(SELECT * FROM WRK)
    ,ORG4 AS(SELECT * FROM WRK)
    ,ORG5 AS(SELECT * FROM WRK)
    ,ORG6 AS(SELECT * FROM WRK)
    ,ORG7 AS(SELECT * FROM WRK)
    ,ORG8 AS(SELECT * FROM WRK)
    ,ORG9 AS(SELECT * FROM WRK)
    ,ORG10 AS(SELECT * FROM WRK)
    
    ,HIERARCHY AS(
        SELECT
            ORG1.ORG_CD
            ,ORG1.ORG_TIER_CD
            ,ORG1.ORG_STRU_TP_CD
            --FIRST   
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.ORG_NM
            END AS FIRST_ORG_NM
            --THIRD          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.ORG_NM
            END AS SCD_ORG_NM
            --FRTH          
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.ORG_NM
            END AS THIRD_ORG_NM
            --FIFTH         
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.ORG_NM
            END AS FRTH_ORG_NM
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.ORG_NM
            END AS FIFTH_ORG_NM
            --SVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.ORG_NM
            END AS SIXTH_ORG_NM
            --EIGHTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.ORG_NM
            END AS SVNTH_ORG_NM
            --NINTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.ORG_NM
            END AS EIGHTH_ORG_NM
            --TENTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.ORG_NM
            END AS NINTH_ORG_NM
            --ELEVNTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.ORG_NM
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.ORG_NM
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.ORG_NM
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.ORG_NM
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.ORG_NM
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.ORG_NM
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.ORG_NM
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.ORG_NM
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.ORG_NM
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.ORG_NM
            END AS TENTH_ORG_NM

       <isNotNull property="cMsg.trtyGrpTpCd_P1">
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.TRTY_GRP_TP_CD
            END AS FIRST_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.TRTY_GRP_TP_CD
            END AS SCD_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.TRTY_GRP_TP_CD
            END AS THIRD_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.TRTY_GRP_TP_CD
            END AS FRTH_TRTY_GRP_TP_CD
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.TRTY_GRP_TP_CD
            END AS FIFTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.TRTY_GRP_TP_CD
            END AS SIXTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.TRTY_GRP_TP_CD
            END AS SVNTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.TRTY_GRP_TP_CD
            END AS EIGHTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.TRTY_GRP_TP_CD
            END AS NINTH_TRTY_GRP_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.TRTY_GRP_TP_CD
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.TRTY_GRP_TP_CD
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.TRTY_GRP_TP_CD
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.TRTY_GRP_TP_CD
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.TRTY_GRP_TP_CD
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.TRTY_GRP_TP_CD
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.TRTY_GRP_TP_CD
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.TRTY_GRP_TP_CD
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.TRTY_GRP_TP_CD
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.TRTY_GRP_TP_CD
            END AS TENTH_TRTY_GRP_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.trtyTpCd_P1">
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.TRTY_TP_CD
            END AS FIRST_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.TRTY_TP_CD
            END AS SCD_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.TRTY_TP_CD
            END AS THIRD_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.TRTY_TP_CD
            END AS FRTH_TRTY_TP_CD
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.TRTY_TP_CD
            END AS FIFTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.TRTY_TP_CD
            END AS SIXTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.TRTY_TP_CD
            END AS SVNTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.TRTY_TP_CD
            END AS EIGHTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.TRTY_TP_CD
            END AS NINTH_TRTY_TP_CD
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.TRTY_TP_CD
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.TRTY_TP_CD
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.TRTY_TP_CD
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.TRTY_TP_CD
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.TRTY_TP_CD
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.TRTY_TP_CD
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.TRTY_TP_CD
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.TRTY_TP_CD
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.TRTY_TP_CD
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.TRTY_TP_CD
            END AS TENTH_TRTY_TP_CD
       </isNotNull>

       <isNotNull property="cMsg.effFromDt_H1">
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '1' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '1' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '1' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '1' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '1' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '1' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '1' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '1' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '1' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '1' THEN ORG10.EFF_FROM_DT
            END AS FIRST_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '2' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '2' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '2' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '2' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '2' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '2' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '2' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '2' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '2' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '2' THEN ORG10.EFF_FROM_DT
            END AS SCD_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '3' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '3' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '3' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '3' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '3' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '3' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '3' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '3' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '3' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '3' THEN ORG10.EFF_FROM_DT
            END AS THIRD_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '4' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '4' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '4' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '4' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '4' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '4' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '4' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '4' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '4' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '4' THEN ORG10.EFF_FROM_DT
            END AS FRTH_EFF_FROM_DT
            --SIXTH        
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '5' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '5' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '5' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '5' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '5' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '5' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '5' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '5' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '5' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '5' THEN ORG10.EFF_FROM_DT
            END AS FIFTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '6' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '6' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '6' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '6' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '6' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '6' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '6' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '6' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '6' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '6' THEN ORG10.EFF_FROM_DT
            END AS SIXTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '7' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '7' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '7' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '7' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '7' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '7' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '7' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '7' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '7' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '7' THEN ORG10.EFF_FROM_DT
            END AS SVNTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '8' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '8' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '8' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '8' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '8' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '8' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '8' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '8' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '8' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '8' THEN ORG10.EFF_FROM_DT
            END AS EIGHTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '9' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '9' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '9' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '9' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '9' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '9' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '9' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '9' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '9' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '9' THEN ORG10.EFF_FROM_DT
            END AS NINTH_EFF_FROM_DT
            ,CASE
                WHEN ORG1.ORG_TIER_CD = '10' THEN ORG1.EFF_FROM_DT
                WHEN ORG2.ORG_TIER_CD = '10' THEN ORG2.EFF_FROM_DT
                WHEN ORG3.ORG_TIER_CD = '10' THEN ORG3.EFF_FROM_DT
                WHEN ORG4.ORG_TIER_CD = '10' THEN ORG4.EFF_FROM_DT
                WHEN ORG5.ORG_TIER_CD = '10' THEN ORG5.EFF_FROM_DT
                WHEN ORG6.ORG_TIER_CD = '10' THEN ORG6.EFF_FROM_DT
                WHEN ORG7.ORG_TIER_CD = '10' THEN ORG7.EFF_FROM_DT
                WHEN ORG8.ORG_TIER_CD = '10' THEN ORG8.EFF_FROM_DT
                WHEN ORG9.ORG_TIER_CD = '10' THEN ORG9.EFF_FROM_DT
                WHEN ORG10.ORG_TIER_CD = '10' THEN ORG10.EFF_FROM_DT
            END AS TENTH_EFF_FROM_DT
       </isNotNull>

        FROM
            ORG1
            ,ORG2
            ,ORG3
            ,ORG4
            ,ORG5
            ,ORG6
            ,ORG7
            ,ORG8
            ,ORG9
            ,ORG10
        WHERE
            ORG1.PRNT_ORG_CD = ORG2.ORG_CD
        AND ORG2.PRNT_ORG_CD = ORG3.ORG_CD
        AND ORG3.PRNT_ORG_CD = ORG4.ORG_CD
        AND ORG4.PRNT_ORG_CD = ORG5.ORG_CD
        AND ORG5.PRNT_ORG_CD = ORG6.ORG_CD
        AND ORG6.PRNT_ORG_CD = ORG7.ORG_CD
        AND ORG7.PRNT_ORG_CD = ORG8.ORG_CD
        AND ORG8.PRNT_ORG_CD = ORG9.ORG_CD
        AND ORG9.PRNT_ORG_CD = ORG10.ORG_CD

        UNION ALL
        -- Obtain Organization that do not have parent
        SELECT
            ORG.ORG_CD
            ,ORG.ORG_TIER_CD
            ,ORG.ORG_STRU_TP_CD
            ,ORG.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
       <isNotNull property="cMsg.trtyGrpTpCd_P1">
            ,ORG.TRTY_GRP_TP_CD AS FIRST_TRTY_GRP_TP_CD
            ,NULL AS SCD_TRTY_GRP_TP_CD
            ,NULL AS THIRD_TRTY_GRP_TP_CD
            ,NULL AS FRTH_TRTY_GRP_TP_CD
            ,NULL AS FIFTH_TRTY_GRP_TP_CD
            ,NULL AS SIXTH_TRTY_GRP_TP_CD
            ,NULL AS SVNTH_TRTY_GRP_TP_CD
            ,NULL AS EIGHTH_TRTY_GRP_TP_CD
            ,NULL AS NINTH_TRTY_GRP_TP_CD
            ,NULL AS TENTH_TRTY_GRP_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.trtyTpCd_P1">
            ,ORG.TRTY_TP_CD AS FIRST_TRTY_TP_CD
            ,NULL AS SCD_TRTY_TP_CD
            ,NULL AS THIRD_TRTY_TP_CD
            ,NULL AS FRTH_TRTY_TP_CD
            ,NULL AS FIFTH_TRTY_TP_CD
            ,NULL AS SIXTH_TRTY_TP_CD
            ,NULL AS SVNTH_TRTY_TP_CD
            ,NULL AS EIGHTH_TRTY_TP_CD
            ,NULL AS NINTH_TRTY_TP_CD
            ,NULL AS TENTH_TRTY_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.effFromDt_H1">
            ,ORG.EFF_FROM_DT AS FIRST_EFF_FROM_DT
            ,NULL AS SCD_EFF_FROM_DT
            ,NULL AS THIRD_EFF_FROM_DT
            ,NULL AS FRTH_EFF_FROM_DT
            ,NULL AS FIFTH_EFF_FROM_DT
            ,NULL AS SIXTH_EFF_FROM_DT
            ,NULL AS SVNTH_EFF_FROM_DT
            ,NULL AS EIGHTH_EFF_FROM_DT
            ,NULL AS NINTH_EFF_FROM_DT
            ,NULL AS TENTH_EFF_FROM_DT
       </isNotNull>
        FROM
            DS_ORG_UNIT ORG
         ,  ORG_STRU_TP STRU
        WHERE
            ORG.GLBL_CMPY_CD    = #glblCmpyCd#
        AND STRU.GLBL_CMPY_CD   = #glblCmpyCd#
        AND ORG.EZCANCELFLAG    = '0'
        AND STRU.EZCANCELFLAG   = '0'
        AND ORG.ORG_STRU_TP_CD  = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG  = #trtyStruFlg#
        <isNotEqual property="includeInactive" compareValue='Y'>
        AND ORG.EFF_FROM_DT                  &lt;=  #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxeffThruDt#) &gt;=  #slsDt#
      <!--
        AND (   ORG.GNRN_TP_CD  = #gnrnTpCdCurrent#
             OR ORG.GNRN_TP_CD  = #gnrnTpCdFuture#)
      -->
        </isNotEqual>
        <isEqual property="includeInactive" compareValue='Y'>
        AND ORG.GNRN_TP_CD     != #gnrnTpCdDelete#
        AND ORG.GNRN_TP_CD     != #gnrnTpCdTerminated#
        </isEqual>
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD    = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        AND NOT EXISTS(
                SELECT
                    1
                FROM
                    DS_ORG_RELN RELN
                WHERE
                    RELN.GLBL_CMPY_CD   = #glblCmpyCd#
                AND RELN.EZCANCELFLAG   = '0'
                AND RELN.ORG_CD         = ORG.ORG_CD
                AND RELN.ORG_STRU_TP_CD = ORG.ORG_STRU_TP_CD
                AND RELN.GNRN_TP_CD    != #gnrnTpCdDelete#
                AND RELN.GNRN_TP_CD    != #gnrnTpCdTerminated#
                AND ORG.ORG_TIER_CD &gt;= #firstTierCd#
            )

        UNION ALL
        -- Obtain Organization that are not connected with top tier(BIZ_AREA)
        SELECT
            NOR.ORG_CD
            ,NOR.ORG_TIER_CD
            ,NOR.ORG_STRU_TP_CD
            ,NOR.ORG_NM AS FIRST_ORG_NM
            ,NULL AS SCD_ORG_NM
            ,NULL AS THIRD_ORG_NM
            ,NULL AS FRTH_ORG_NM
            ,NULL AS FIFTH_ORG_NM
            ,NULL AS SIXTH_ORG_NM
            ,NULL AS SVNTH_ORG_NM
            ,NULL AS EIGHTH_ORG_NM
            ,NULL AS NINTH_ORG_NM
            ,NULL AS TENTH_ORG_NM
       <isNotNull property="cMsg.trtyGrpTpCd_P1">
            ,NOR.TRTY_GRP_TP_CD AS FIRST_TRTY_GRP_TP_CD
            ,NULL AS SCD_TRTY_GRP_TP_CD
            ,NULL AS THIRD_TRTY_GRP_TP_CD
            ,NULL AS FRTH_TRTY_GRP_TP_CD
            ,NULL AS FIFTH_TRTY_GRP_TP_CD
            ,NULL AS SIXTH_TRTY_GRP_TP_CD
            ,NULL AS SVNTH_TRTY_GRP_TP_CD
            ,NULL AS EIGHTH_TRTY_GRP_TP_CD
            ,NULL AS NINTH_TRTY_GRP_TP_CD
            ,NULL AS TENTH_TRTY_GRP_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.trtyTpCd_P1">
            ,NOR.TRTY_TP_CD AS FIRST_TRTY_TP_CD
            ,NULL AS SCD_TRTY_TP_CD
            ,NULL AS THIRD_TRTY_TP_CD
            ,NULL AS FRTH_TRTY_TP_CD
            ,NULL AS FIFTH_TRTY_TP_CD
            ,NULL AS SIXTH_TRTY_TP_CD
            ,NULL AS SVNTH_TRTY_TP_CD
            ,NULL AS EIGHTH_TRTY_TP_CD
            ,NULL AS NINTH_TRTY_TP_CD
            ,NULL AS TENTH_TRTY_TP_CD
       </isNotNull>
       <isNotNull property="cMsg.effFromDt_H1">
            ,NOR.EFF_FROM_DT AS FIRST_EFF_FROM_DT
            ,NULL AS SCD_EFF_FROM_DT
            ,NULL AS THIRD_EFF_FROM_DT
            ,NULL AS FRTH_EFF_FROM_DT
            ,NULL AS FIFTH_EFF_FROM_DT
            ,NULL AS SIXTH_EFF_FROM_DT
            ,NULL AS SVNTH_EFF_FROM_DT
            ,NULL AS EIGHTH_EFF_FROM_DT
            ,NULL AS NINTH_EFF_FROM_DT
            ,NULL AS TENTH_EFF_FROM_DT
       </isNotNull>
        FROM
            NORELN_TOPTIER NOR
    )
    SELECT
         H.ORG_CD
        ,H.ORG_TIER_CD
        ,H.FIRST_ORG_NM
        ,H.SCD_ORG_NM
        ,H.THIRD_ORG_NM
        ,H.FRTH_ORG_NM
        ,H.FIFTH_ORG_NM
        ,H.SIXTH_ORG_NM
        ,H.SVNTH_ORG_NM
        ,H.EIGHTH_ORG_NM
        ,H.NINTH_ORG_NM
        ,H.TENTH_ORG_NM
        ,NVL(RESRC.PSN_FIRST_NM,'') || ' ' || NVL(RESRC.PSN_LAST_NM,'') AS PSN_NM
        ,RULE.RULE_DESC AS TRTY_RULE
        ,RESRC.ORG_FUNC_ROLE_TP_NM AS ORG_FUNC_ROLE_TP_NM
        ,RESRC.PSN_NUM AS PSN_NUM
    FROM
        HIERARCHY H, RESRC RESRC, RULE RULE
    WHERE
    <isNotEqual property="rsrcSrch" compareValue='Y'>
        H.ORG_CD = RESRC.ORG_CD(+)
    </isNotEqual>
    <isEqual property="rsrcSrch" compareValue='Y'>
        H.ORG_CD = RESRC.ORG_CD
    </isEqual>
    <isNull property="AdvSearchFlg1">
    AND H.ORG_CD = RULE.ORG_CD(+)
    </isNull>
    <isNotNull property="AdvSearchFlg1">
    AND H.ORG_CD = RULE.ORG_CD
    </isNotNull>
    AND H.ORG_TIER_CD &gt;= #firstTierCd#
   <isNotNull property="cMsg.psnCd_H1">
    AND RESRC.PSN_CD   LIKE #cMsg.psnCd_H1#
   </isNotNull>
   <isNotNull property="cMsg.psnNum_H1">
    AND RESRC.PSN_NUM  LIKE #cMsg.psnNum_H1#
   </isNotNull>
   <isNotNull property="cMsg.xxPsnNm_H1">
    AND (
            UPPER(RESRC.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#)
        OR  UPPER(RESRC.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#)
        OR  UPPER(RESRC.PSN_FIRST_NM) || ' ' || UPPER(RESRC.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#)
        )
   </isNotNull>
   <isNotNull property="cMsg.trtyGrpTpCd_P1">
    AND ( FIRST_TRTY_GRP_TP_CD = #cMsg.trtyGrpTpCd_P1#
         OR H.SCD_TRTY_GRP_TP_CD    = #cMsg.trtyGrpTpCd_P1#
         OR H.THIRD_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.FRTH_TRTY_GRP_TP_CD   = #cMsg.trtyGrpTpCd_P1#
         OR H.FIFTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.SIXTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.SVNTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.EIGHTH_TRTY_GRP_TP_CD = #cMsg.trtyGrpTpCd_P1#
         OR H.NINTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
         OR H.TENTH_TRTY_GRP_TP_CD  = #cMsg.trtyGrpTpCd_P1#
        )
   </isNotNull>
   <isNotNull property="cMsg.orgNm_H1">
    AND ( H.FIRST_ORG_NM     LIKE #cMsg.orgNm_H1#
         OR H.SCD_ORG_NM     LIKE #cMsg.orgNm_H1#
         OR H.THIRD_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.FRTH_ORG_NM    LIKE #cMsg.orgNm_H1#
         OR H.FIFTH_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.SIXTH_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.SVNTH_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.EIGHTH_ORG_NM  LIKE #cMsg.orgNm_H1#
         OR H.NINTH_ORG_NM   LIKE #cMsg.orgNm_H1#
         OR H.TENTH_ORG_NM   LIKE #cMsg.orgNm_H1#
        )
   </isNotNull>
   <isNotNull property="cMsg.trtyTpCd_P1">
    AND ( H.FIRST_TRTY_TP_CD    = #cMsg.trtyTpCd_P1#
         OR H.SCD_TRTY_TP_CD    = #cMsg.trtyTpCd_P1#
         OR H.THIRD_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.FRTH_TRTY_TP_CD   = #cMsg.trtyTpCd_P1#
         OR H.FIFTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.SIXTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.SVNTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.EIGHTH_TRTY_TP_CD = #cMsg.trtyTpCd_P1#
         OR H.NINTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
         OR H.TENTH_TRTY_TP_CD  = #cMsg.trtyTpCd_P1#
        )
   </isNotNull>
   <isNotNull property="cMsg.effFromDt_H1">
    AND ( H.FIRST_EFF_FROM_DT    &gt;= #cMsg.effFromDt_H1#
         OR H.SCD_EFF_FROM_DT    &gt;= #cMsg.effFromDt_H1#
         OR H.THIRD_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.FRTH_EFF_FROM_DT   &gt;= #cMsg.effFromDt_H1#
         OR H.FIFTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.SIXTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.SVNTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.EIGHTH_EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
         OR H.NINTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
         OR H.TENTH_EFF_FROM_DT  &gt;= #cMsg.effFromDt_H1#
        )
   </isNotNull>
   <isEqual property="orgTierCd" compareValue='1'>
    AND H.FIRST_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='2'>
    AND H.SCD_ORG_NM      IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='3'>
    AND H.THIRD_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='4'>
    AND H.FRTH_ORG_NM     IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='5'>
    AND H.FIFTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='6'>
    AND H.SIXTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='7'>
    AND H.SVNTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='8'>
    AND H.EIGHTH_ORG_NM   IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='9'>
    AND H.NINTH_ORG_NM    IS NOT NULL
   </isEqual>
   <isEqual property="orgTierCd" compareValue='10'>
    AND H.TENTH_ORG_NM    IS NOT NULL
   </isEqual>
    ORDER BY
        FIRST_ORG_NM NULLS FIRST
        ,SCD_ORG_NM NULLS FIRST
        ,THIRD_ORG_NM NULLS FIRST
        ,FRTH_ORG_NM NULLS FIRST
        ,FIFTH_ORG_NM NULLS FIRST
        ,SIXTH_ORG_NM NULLS FIRST
        ,SVNTH_ORG_NM NULLS FIRST
        ,EIGHTH_ORG_NM NULLS FIRST
        ,NINTH_ORG_NM NULLS FIRST
        ,TENTH_ORG_NM NULLS FIRST
        ,ORG_TIER_CD
    </statement>

    <statement id="getAdditionalOrg" parameterClass="Map" resultClass="Map">
    SELECT
        ORG.ORG_CD AS ORG_CD
       ,ORG.ORG_STRU_TP_CD AS ORG_STRU_TP_CD
       ,ORG.EFF_FROM_DT AS EFF_FROM_DT
       ,ORG.EZUPTIME AS EZUPTIME
       ,ORG.EZUPTIMEZONE AS EZUPTIMEZONE
    FROM
        DS_ORG_UNIT ORG
       ,ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = #glblCmpyCd#
    AND ORG.EZCANCELFLAG = '0'
    AND STRU.GLBL_CMPY_CD = #glblCmpyCd#
    AND STRU.EZCANCELFLAG = '0'
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = #trtyStruFlg#
    AND ORG.ORG_NM = #cMsg.orgNm_P#
    </statement>
    
    <statement id="getTargetOrgForTopTierSearch" parameterClass="Map" resultMap="result.getTargetOrg">
    WITH TRTY AS
    (
        SELECT
            ORG.ORG_CD
         ,  ORG.ORG_NM
        FROM
            DS_ORG_RESRC_RELN RELN,
            DS_ORG_UNIT       ORG,
            S21_PSN           PSN,
            ORG_STRU_TP       STRU
        WHERE
            RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND RELN.EZCANCELFLAG = '0'
        AND RELN.GLBL_CMPY_CD = PSN.GLBL_CMPY_CD
        AND RELN.EZCANCELFLAG = PSN.EZCANCELFLAG
        AND RELN.GLBL_CMPY_CD = ORG.GLBL_CMPY_CD
        AND RELN.EZCANCELFLAG = ORG.EZCANCELFLAG
        <isNotEqual property="includeInactive" compareValue='Y'> <!-- 2018/03/09 S21_NA#23307 Add -->
        AND ORG.EFF_FROM_DT   &lt;= #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt#
        </isNotEqual>
        <!-- 2018/03/09 S21_NA#23307 Add Start -->
        <isEqual property="includeInactive" compareValue='Y'>
        AND ORG.GNRN_TP_CD     != #gnrnTpCdDelete#
        AND ORG.GNRN_TP_CD     != #gnrnTpCdTerminated#
        </isEqual>
        <!-- 2018/03/09 S21_NA#23307 Add End-->
        AND RELN.ORG_CD = ORG.ORG_CD
        AND RELN.EFF_FROM_DT   &lt;= #slsDt#
        AND NVL(RELN.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt#
        AND RELN.PSN_CD = PSN.PSN_CD
        AND PSN.EFF_FROM_DT   &lt;= #slsDt#
        AND NVL(PSN.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt#
        AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND STRU.TRTY_STRU_FLG = 'Y'
        <isNotNull property="cMsg.bizAreaOrgCd_P1">
        AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
        </isNotNull>
        <isNotNull property="cMsg.orgTierCd_P1">
        AND ORG.ORG_TIER_CD = #cMsg.orgTierCd_P1#
        </isNotNull>
        <isNotNull property="cMsg.orgNm_H1">
        AND ORG.ORG_NM LIKE #cMsg.orgNm_H1#
        </isNotNull>
        <isNotNull property="cMsg.trtyTpCd_P1">
        AND ORG.TRTY_TP_CD = #cMsg.trtyTpCd_P1#
        </isNotNull>
        <isNotNull property="cMsg.trtyGrpTpCd_P1">
        AND ORG.TRTY_GRP_TP_CD = #cMsg.trtyGrpTpCd_P1#
        </isNotNull>
        <isNotNull property="cMsg.effFromDt_H1">
        AND ORG.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
        </isNotNull>
        <isNotNull property="cMsg.psnCd_H1">
        AND PSN.PSN_CD LIKE #cMsg.psnCd_H1#
        </isNotNull>
        <isNotNull property="cMsg.xxPsnNm_H1">
        AND (UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#) 
          OR UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#)
          OR (UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM)) LIKE UPPER(#cMsg.xxPsnNm_H1#)
        )
        </isNotNull>
        <isNotNull property="cMsg.psnNum_H1">
        AND PSN.PSN_NUM LIKE #cMsg.psnNum_H1#
        </isNotNull>

        <isNotNull property="AdvSearchFlg1">
           AND  ( EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD    
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd1">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd1#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd1">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd1#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal1">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal1#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal1">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal1#
            </isNotNull>
                              )
        </isNotNull>
        <isNotNull property="AdvSearchFlg2">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD    
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd2">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd2#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd2">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd2#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal2">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal2#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal2">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal2#
            </isNotNull>
                              )
        </isNotNull>
        <isNotNull property="AdvSearchFlg3">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd3">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd3#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd3">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd3#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal3">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal3#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal3">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal3#
            </isNotNull>
                              )
        </isNotNull>
        <isNotNull property="AdvSearchFlg4">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD    
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd4">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd4#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd4">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd4#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal4">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal4#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal4">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal4#
            </isNotNull>
                              )
        </isNotNull>
        <isNotNull property="AdvSearchFlg5">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd5">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd5#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd5">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd5#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal5">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal5#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal5">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal5#
            </isNotNull>
                              )
        </isNotNull>

        <isNotNull property="AdvSearchFlg6">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd6">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd6#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd6">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd6#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal6">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal6#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal6">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal6#
            </isNotNull>
                              )
        </isNotNull>
        <isNotNull property="AdvSearchFlg7">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd7">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd7#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd7">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd7#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal7">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal7#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal7">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal7#
            </isNotNull>
                              )
        </isNotNull>
        <isNotNull property="AdvSearchFlg8">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd8">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd8#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd8">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd8#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal8">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal8#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal8">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal8#
            </isNotNull>
                              )
        </isNotNull>
        <isNotNull property="AdvSearchFlg9">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd9">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd9#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd9">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd9#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal9">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal9#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal9">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal9#
            </isNotNull>
                              )
        </isNotNull>
        <isNotNull property="AdvSearchFlg10">
           OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                        WHERE RULE.GLBL_CMPY_CD = #glblCmpyCd#
                              AND ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                              AND RULE.EZCANCELFLAG = '0'
                              AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                              AND ORG.ORG_CD = RULE.ORG_CD
                              <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

            <isNotNull property="trtyRuleTpCd10">
                              AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd10#
            </isNotNull>
            <isNotNull property="trtyRuleOprdTpCd10">
                              AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd10#
            </isNotNull>
            <isNotNull property="trtyRuleFromVal10">
                              AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal10#
            </isNotNull>
            <isNotNull property="trtyRuleThruVal10">
                              AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal10#
            </isNotNull>
                              )
        </isNotNull>

        <isNotNull property="AdvSearchFlg1">
            )
        </isNotNull>
      )
    , RELN AS
    (
        (
            SELECT
                DISTINCT ORG.ORG_CD
              , ORG.ORG_NM
            FROM
                DS_ORG_UNIT ORG
             ,  DS_ORG_RELN RELN
            WHERE
                ORG.GLBL_CMPY_CD      = #glblCmpyCd#
            AND ORG.EZCANCELFLAG      = '0'
            AND ORG.ORG_TIER_CD       = #orgTierCd_1#
            AND ORG.GLBL_CMPY_CD      = RELN.GLBL_CMPY_CD
            AND ORG.ORG_CD            = RELN.ORG_CD
            AND RELN.EZCANCELFLAG     = '0'
            START WITH RELN.ORG_CD IN (SELECT ORG_CD FROM TRTY)
            CONNECT BY NOCYCLE PRIOR
                    RELN.PRNT_ORG_CD  = RELN.ORG_CD
                AND RELN.GLBL_CMPY_CD = #glblCmpyCd#
                AND RELN.EZCANCELFLAG = 0
                AND (
                        (   RELN.EFF_FROM_DT                  &lt;= #slsDt#
                        AND NVL(RELN.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt#
                        )
                    )
                AND RELN.GNRN_TP_CD IN (#gnrnTp_Current#, #gnrnTp_Future#)
         ) UNION (
            SELECT
                DISTINCT TRTY.ORG_CD
              , TRTY.ORG_NM
            FROM
                TRTY
            WHERE
                TRTY.ORG_CD   NOT IN
                         (
                           SELECT
                               RELN.ORG_CD
                           FROM
                               DS_ORG_RELN RELN
                            ,  ORG_STRU_TP STRU
                           WHERE RELN.GLBL_CMPY_CD = #glblCmpyCd#
                           AND RELN.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
                           AND RELN.GLBL_CMPY_CD   = STRU.GLBL_CMPY_CD 
                           AND ( RELN.EFF_FROM_DT                      &lt;= #slsDt#
                                 AND NVL(RELN.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt# )
                           AND RELN.GNRN_TP_CD IN (#gnrnTp_Current#, #gnrnTp_Future#)
                           AND STRU.TRTY_STRU_FLG  = 'Y'
                           AND RELN.EZCANCELFLAG   = '0'
                           AND STRU.EZCANCELFLAG   = '0'
                         )
          )
    )

    SELECT
        DISTINCT RELN.ORG_CD,
        RELN.ORG_NM
    FROM
        RELN        RELN
    ORDER BY
        RELN.ORG_CD
    </statement>
     
    <statement id="getTargetOrg" parameterClass="Map" resultMap="result.getTargetOrg">
    WITH RELN AS
    (
        SELECT
            DISTINCT ORG.ORG_CD
        FROM
            DS_ORG_RESRC_RELN RELN,
            DS_ORG_UNIT ORG,
            S21_PSN PSN,
            ORG_STRU_TP STRU
        WHERE
            RELN.GLBL_CMPY_CD = 'ADB'
        AND RELN.EZCANCELFLAG = '0'
        AND RELN.GLBL_CMPY_CD = PSN.GLBL_CMPY_CD
        AND RELN.EZCANCELFLAG = PSN.EZCANCELFLAG
        AND RELN.GLBL_CMPY_CD = ORG.GLBL_CMPY_CD
        AND RELN.EZCANCELFLAG = ORG.EZCANCELFLAG
        <isNotEqual property="includeInactive" compareValue='Y'> <!-- 2018/03/09 S21_NA#23307 Add -->
        AND ORG.EFF_FROM_DT   &lt;= #slsDt#
        AND NVL(ORG.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt#
        </isNotEqual>
        <!-- 2018/03/09 S21_NA#23307 Add Start -->
        <isEqual property="includeInactive" compareValue='Y'>
        AND ORG.GNRN_TP_CD     != #gnrnTpCdDelete#
        AND ORG.GNRN_TP_CD     != #gnrnTpCdTerminated#
        </isEqual>
        <!-- 2018/03/09 S21_NA#23307 Add End-->
        AND RELN.GLBL_CMPY_CD = STRU.GLBL_CMPY_CD
        AND RELN.EZCANCELFLAG = STRU.EZCANCELFLAG
        AND RELN.ORG_CD = ORG.ORG_CD
        AND RELN.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
        AND RELN.EFF_FROM_DT   &lt;= #slsDt#
        AND NVL(RELN.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt#
        AND STRU.TRTY_STRU_FLG = 'Y'
        AND RELN.PSN_CD = PSN.PSN_CD
        AND PSN.EFF_FROM_DT   &lt;= #slsDt#
        AND NVL(PSN.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt#
        <isNotNull property="cMsg.psnCd_H1">
        AND PSN.PSN_CD LIKE #cMsg.psnCd_H1#
        </isNotNull>
        <isNotNull property="cMsg.xxPsnNm_H1">
        AND (UPPER(PSN.PSN_FIRST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#) 
          OR UPPER(PSN.PSN_LAST_NM) LIKE UPPER(#cMsg.xxPsnNm_H1#)
          OR (UPPER(PSN.PSN_FIRST_NM) || ' ' || UPPER(PSN.PSN_LAST_NM)) LIKE UPPER(#cMsg.xxPsnNm_H1#)
        )
        </isNotNull>
        <isNotNull property="cMsg.psnNum_H1">
        AND PSN.PSN_NUM LIKE #cMsg.psnNum_H1#
        </isNotNull>
    )

    SELECT
        ORG.ORG_CD,
        ORG.ORG_NM
    FROM
        DS_ORG_UNIT ORG,
        ORG_STRU_TP STRU
    WHERE
        ORG.GLBL_CMPY_CD = 'ADB'
    AND ORG.EZCANCELFLAG = '0'
    <isNotEqual property="includeInactive" compareValue='Y'> <!-- 2018/03/09 S21_NA#23307 Add -->
    AND ORG.EFF_FROM_DT   &lt;= #slsDt#
    AND NVL(ORG.EFF_THRU_DT, #maxEffDt#) &gt;= #slsDt#
    </isNotEqual>
    <!-- 2018/03/09 S21_NA#23307 Add Start -->
    <isEqual property="includeInactive" compareValue='Y'>
    AND ORG.GNRN_TP_CD     != #gnrnTpCdDelete#
    AND ORG.GNRN_TP_CD     != #gnrnTpCdTerminated#
    </isEqual>
    <!-- 2018/03/09 S21_NA#23307 Add End-->
    AND ORG.ORG_STRU_TP_CD = STRU.ORG_STRU_TP_CD
    AND STRU.TRTY_STRU_FLG = 'Y'
    <isNotNull property="cMsg.bizAreaOrgCd_P1">
    AND ORG.FIRST_ORG_CD = #cMsg.bizAreaOrgCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.orgTierCd_P1">
    AND ORG.ORG_TIER_CD = #cMsg.orgTierCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.orgNm_H1">
    AND ORG.ORG_NM LIKE #cMsg.orgNm_H1#
    </isNotNull>
    <isNotNull property="cMsg.trtyTpCd_P1">
    AND ORG.TRTY_TP_CD = #cMsg.trtyTpCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.trtyGrpTpCd_P1">
    AND ORG.TRTY_GRP_TP_CD = #cMsg.trtyGrpTpCd_P1#
    </isNotNull>
    <isNotNull property="cMsg.effFromDt_H1">
    AND ORG.EFF_FROM_DT &gt;= #cMsg.effFromDt_H1#
    </isNotNull>
    <isNotNull property="cMsg.psnCd_H1">
    AND EXISTS (SELECT 1 FROM RELN WHERE RELN.ORG_CD = ORG.ORG_CD)
    </isNotNull>
    <isNotNull property="cMsg.xxPsnNm_H1">
    AND EXISTS (SELECT 1 FROM RELN WHERE RELN.ORG_CD = ORG.ORG_CD)
    </isNotNull>
    <isNotNull property="cMsg.psnNum_H1">
    AND EXISTS (SELECT 1 FROM RELN WHERE RELN.ORG_CD = ORG.ORG_CD)
    </isNotNull>

    <isNotNull property="AdvSearchFlg1">
       AND  ( EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd1">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd1#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd1">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd1#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal1">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal1#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal1">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal1#
        </isNotNull>
                          )
    </isNotNull>
    <isNotNull property="AdvSearchFlg2">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd2">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd2#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd2">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd2#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal2">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal2#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal2">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal2#
        </isNotNull>
                          )
    </isNotNull>
    <isNotNull property="AdvSearchFlg3">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd3">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd3#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd3">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd3#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal3">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal3#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal3">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal3#
        </isNotNull>
                          )
    </isNotNull>
    <isNotNull property="AdvSearchFlg4">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd4">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd4#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd4">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd4#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal4">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal4#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal4">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal4#
        </isNotNull>
                          )
    </isNotNull>
    <isNotNull property="AdvSearchFlg5">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd5">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd5#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd5">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd5#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal5">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal5#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal5">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal5#
        </isNotNull>
                          )
    </isNotNull>

    <isNotNull property="AdvSearchFlg6">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd6">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd6#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd6">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd6#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal6">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal6#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal6">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal6#
        </isNotNull>
                          )
    </isNotNull>
    <isNotNull property="AdvSearchFlg7">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd7">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd7#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd7">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd7#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal7">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal7#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal7">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal7#
        </isNotNull>
                          )
    </isNotNull>
    <isNotNull property="AdvSearchFlg8">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd8">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd8#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd8">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd8#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal8">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal8#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal8">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal8#
        </isNotNull>
                          )
    </isNotNull>
    <isNotNull property="AdvSearchFlg9">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd9">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd9#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd9">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd9#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal9">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal9#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal9">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal9#
        </isNotNull>
                          )
    </isNotNull>
    <isNotNull property="AdvSearchFlg10">
       OR  EXISTS (SELECT 1 FROM TRTY_RULE RULE
                    WHERE ORG.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
                          AND RULE.EZCANCELFLAG = '0'
                          AND ORG.ORG_STRU_TP_CD = RULE.ORG_STRU_TP_CD
                          AND ORG.ORG_CD = RULE.ORG_CD    
                          <!-- AND ORG.ORG_TIER_CD = RULE.ORG_TIER_CD --> <!-- 2018/03/27 S21_NA#23158 Del-->

        <isNotNull property="trtyRuleTpCd10">
                          AND RULE.TRTY_RULE_TP_CD = #trtyRuleTpCd10#
        </isNotNull>
        <isNotNull property="trtyRuleOprdTpCd10">
                          AND RULE.TRTY_RULE_OPRD_TP_CD = #trtyRuleOprdTpCd10#
        </isNotNull>
        <isNotNull property="trtyRuleFromVal10">
                          AND RULE.TRTY_RULE_FROM_VAL_TXT = #trtyRuleFromVal10#
        </isNotNull>
        <isNotNull property="trtyRuleThruVal10">
                          AND RULE.TRTY_RULE_THRU_VAL_TXT = #trtyRuleThruVal10#
        </isNotNull>
                          )
    </isNotNull>

    <isNotNull property="AdvSearchFlg1">
        )
    </isNotNull>
    ORDER BY
        TO_NUMBER(ORG.ORG_TIER_CD)
       ,ORG.ORG_NM
    </statement>

</sqlMap>
