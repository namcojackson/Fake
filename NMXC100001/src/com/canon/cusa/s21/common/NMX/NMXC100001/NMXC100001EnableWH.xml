<?xml version="1.0" encoding="UTF-8" ?> 
<sqlMap namespace="NMXC100001EnableWH">
<statement id="getInvtyNmAval" parameterClass="Map" resultClass="Map">
SELECT
       D.INVTY_LOC_NM    AS INVTY_LOC_NM
     , U.LOC_ROLE_TP_CD  AS LOC_ROLE_TP_CD
FROM
       DS_INVTY_LOC_V D
     , LOC_USG U
     , AVAL_INVTY_LOC_ROLE A
WHERE
       D.INVTY_LOC_CD = #invtyLocCd#
   AND D.RGTN_STS_CD  = #readyForOrderTaking#
      <isEqual property="isDataSecuritySet" compareValue="Y">
       <iterate property="dataSecurityList" var="dataSecurityList[]" open="AND D.INVTY_LOC_CD IN(" close=")" conjunction=",">
        #dataSecurityList[]#
       </iterate>
      </isEqual>
   AND (D.WH_SYS_TP_CD &lt;&gt; #na#  OR D.WH_SYS_TP_CD IS NULL)
   AND D.GLBL_CMPY_CD = #glblCmpyCd#
   AND D.EZCANCELFLAG = '0'
   AND U.PTY_LOC_PK     = D.PTY_LOC_PK
   AND U.GLBL_CMPY_CD   = D.GLBL_CMPY_CD
   AND U.EZCANCELFLAG   = '0'
   AND A.LOC_ROLE_TP_CD = U.LOC_ROLE_TP_CD
   AND A.GLBL_CMPY_CD   = U.GLBL_CMPY_CD
   AND A.BIZ_APP_ID     = #bizAppId#
      <isEqual property="isLocationTypeSet" compareValue="Y">
       <iterate property="locationTypeList" var="locationTypeList[]" open="AND A.LOC_TP_CD IN(" close=")" conjunction=",">
        #locationTypeList[]#
       </iterate>
      </isEqual>
<!-- 10/06/2015 add start -->
      <isNotNull property="bizAppKeyId">
   AND A.BIZ_APP_LOC_CHK_KEY_ID = #bizAppKeyId#
      </isNotNull>
<!-- 10/06/2015 add end -->
   AND A.EZCANCELFLAG   = '0'
   <isEqual property="virtualWHFlg" compareValue="Y">
UNION ALL
SELECT
       D.INVTY_LOC_NM    AS INVTY_LOC_NM
     , ''                AS LOC_ROLE_TP_CD
FROM
       DS_INVTY_LOC_V D
WHERE
       D.INVTY_LOC_CD = #invtyLocCd#
   AND D.RGTN_STS_CD  = #readyForOrderTaking#
      <isEqual property="isDataSecuritySet" compareValue="Y">
       <iterate property="dataSecurityList" var="dataSecurityList[]" open="AND D.INVTY_LOC_CD IN(" close=")" conjunction=",">
        #dataSecurityList[]#
       </iterate>
      </isEqual>
   AND (D.WH_SYS_TP_CD = #na#)
   AND D.GLBL_CMPY_CD = #glblCmpyCd#
   AND D.EZCANCELFLAG = '0'
   </isEqual>
</statement>

<statement id="getLocRoleTpList" parameterClass="Map" resultClass="Map">
    SELECT
        A.LOC_ROLE_TP_CD
    FROM
        AVAL_INVTY_LOC_ROLE A
    WHERE
            A.GLBL_CMPY_CD       = #glblCmpyCd#
        AND A.BIZ_APP_ID         = #funcId#
    <iterate property="locationTypeList" var="locationTypeList[]" open="AND A.LOC_TP_CD IN(" close=")" conjunction=",">
        #locationTypeList[]#
    </iterate>
<!-- 10/06/2015 add start -->
    <isNotNull property="bizAppKeyId">
    AND A.BIZ_APP_LOC_CHK_KEY_ID = #bizAppKeyId#
    </isNotNull>
<!-- 10/06/2015 add end -->
        AND A.EZCANCELFLAG       = '0'
</statement>

<!-- 10/06/2015 add start -->
<statement id="getLocRoleTpList2" parameterClass="Map" resultClass="Map">
SELECT
       A.LOC_ROLE_TP_CD
FROM
       AVAL_INVTY_LOC_ROLE A
WHERE
       A.GLBL_CMPY_CD           = #glblCmpyCd#
   AND A.BIZ_APP_ID             = #funcId#
   <isNotNull property="bizAppKeyId">
   AND A.BIZ_APP_LOC_CHK_KEY_ID = #bizAppKeyId#
   </isNotNull>
   AND A.EZCANCELFLAG           = '0'
</statement>
<!-- 10/06/2015 add end -->
</sqlMap>
