<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB582001">

    <statement id="getCtacTp" parameterClass="Map" resultClass="String">
        SELECT 
            CTAC_TP_CD
        FROM
            (SELECT 
                CTAC_TP_CD
             FROM CTAC_TP
             WHERE 
                 GLBL_CMPY_CD = #GLBL_CMPY_CD#
             AND SPLY_IND_FLG = #SPLY_IND_FLG#
             AND ACTV_FLG     = #ACTV_FLG#
             AND EZCANCELFLAG = '0'
             ORDER BY 
                 CTAC_TP_SORT_NUM
            )
        WHERE ROWNUM = 1
    </statement>
    
    <statement id="getPrevProcDt" parameterClass="Map" resultClass="Map">
        SELECT
            DS_BIZ_PROC_LOG_PK
            ,SUBSTR(DS_BIZ_LAST_UPD_TS, 1,8) AS DS_BIZ_LAST_UPD_DT
        FROM 
            DS_BIZ_PROC_LOG
        WHERE 
            GLBL_CMPY_CD     = #GLBL_CMPY_CD#
        AND PROC_PGM_ID      = #PROC_PGM_ID#
        AND EZCANCELFLAG     = '0' 
    </statement>
    
    <statement id="getSplyIds" parameterClass="Map" resultClass="Map">
    <![CDATA[
        SELECT 
            DISTINCT 
                ARCS_SPLY_ID
        FROM
            NMAI1130_01
        WHERE
            INTERFACE_ID            = #INTERFACE_ID#
        AND TRANSACTION_ID          = #TRANSACTION_ID#
        AND (
            SUBSTR(NVL(PRNT_VND_LAST_UPD_TS, '00000000'), 1, 8)  >= #DS_BIZ_LAST_UPD_TS#
            OR 
            SUBSTR(NVL(VND_LAST_UPD_TS, '00000000'), 1, 8)       >= #DS_BIZ_LAST_UPD_TS#
            OR 
            SUBSTR(NVL(VND_CTAC_LAST_UPD_TS, '00000000'), 1, 8)  >= #DS_BIZ_LAST_UPD_TS#
            )
        AND EZCANCELFLAG            = '0'
        ORDER BY
            ARCS_SPLY_ID
     ]]>
    </statement>
    
    <statement id="getSplySiteInfoList" parameterClass="Map" resultClass="Map">
        SELECT
             N1.INTERFACE_ID
            ,N1.TRANSACTION_ID
            ,N1.SEGMENT_ID
            ,N1.UNIT_ID
            ,N1.SEQ_NUMBER
            ,N1.ARCS_SPLY_ID
            ,N1.ARCS_SPLY_NUM
            ,N1.PRNT_VND_NM
            ,N1.ARCS_VND_TP_LKUP_TXT
            ,N1.PRNT_VND_PMT_TERM_DESC_TXT
            ,N1.ARCS_TAX_PAYER_ID
            ,N1.PAY_ALONE_FLG
            ,N1.PRNT_VND_EFF_FROM_DT
            ,N1.PRNT_VND_INAC_DT
            ,N1.PRNT_VND_LAST_UPD_TS
            ,N1.ARCS_SPLY_SITE_ID
            ,N1.ARCS_SPLY_SITE_CD
            ,N1.ARCS_SPLY_SITE_ATTRB_TXT_05
            ,N1.ARCS_CTRY_TXT
            ,N1.VND_ADDR_ALL_TXT_01
            ,N1.VND_ADDR_ALL_TXT_02
            ,N1.VND_ADDR_ALL_TXT_03
            ,N1.CTY_ADDR
            ,N1.ST_CD
            ,N1.POST_CD
            ,N1.ARCS_CNTY_NM
            ,N1.ARCS_PROV_NM
            ,N1.ALT_VND_ADDR_ALL_TXT
            ,N1.ARCS_SPLY_COA_SEG_TXT_01
            ,N1.ARCS_SPLY_COA_SEG_TXT_02
            ,N1.ARCS_SPLY_COA_SEG_TXT_03
            ,N1.ARCS_SPLY_COA_SEG_TXT_04
            ,N1.ARCS_SPLY_COA_SEG_TXT_05
            ,N1.ARCS_SPLY_COA_SEG_TXT_06
            ,N1.ARCS_SPLY_COA_SEG_TXT_07
            ,N1.ARCS_SPLY_COA_SEG_TXT_08
            ,N1.ARCS_SPLY_COA_SEG_TXT_09
            ,N1.VND_PMT_TERM_DESC_TXT
            ,N1.VND_INAC_DT
            ,N1.VND_LAST_UPD_TS
            ,N1.ARCS_CTAC_PSN_FIRST_NM
            ,N1.ARCS_CTAC_PSN_LAST_NM
            ,N1.ARCS_CTAC_AREA_TEL_NUM
            ,N1.ARCS_CTAC_TEL_NUM
            ,N1.ARCS_CTAC_AREA_FAX_NUM
            ,N1.ARCS_CTAC_FAX_NUM
            ,N1.ARCS_CTAC_EML_ADDR
            ,N1.VND_CTAC_INAC_DT
            ,N1.VND_CTAC_LAST_UPD_TS
            ,N1.SPLY_PMT_FLG
            <!-- START 2018/03/20 M.Naito [QC#21001, ADD] -->
            ,PVTC.PRNT_VND_TP_CD
            <!-- END 2018/03/20 M.Naito [QC#21001, ADD] -->
        FROM
            NMAI1130_01 N1
           ,PRNT_VND_TP_CONV PVTC
        WHERE
            N1.INTERFACE_ID            = #INTERFACE_ID#
        AND N1.TRANSACTION_ID          = #TRANSACTION_ID#
        AND N1.ARCS_SPLY_ID            = #ARCS_SPLY_ID#
        AND N1.EZCANCELFLAG            = '0'
        AND N1.ARCS_VND_TP_LKUP_TXT    = PVTC.XTRNL_SYS_VND_TP_LKUP_TXT
        AND PVTC.EZCANCELFLAG          = '0'
        ORDER BY
             N1.ARCS_SPLY_ID NULLS LAST
            ,N1.ARCS_SPLY_SITE_ID NULLS LAST
            ,N1.ARCS_SPLY_SITE_ATTRB_TXT_05
        ASC
    </statement>
        
    
    <statement id="getVndInfoByArcsSplySiteId" parameterClass="Map"    resultClass="Map">
        SELECT
             VND.GLBL_CMPY_CD
            ,VND.VND_PK
            ,VND.VND_CD
            ,VND.TAX_PAYER_ID
            ,VND.FIRST_LINE_ADDR
            ,VND.SCD_LINE_ADDR
            ,VND.THIRD_LINE_ADDR
            ,VND.FRTH_LINE_ADDR
            ,VND.CTY_ADDR
            ,VND.CNTY_PK
            ,VND.PROV_NM
            ,VND.ST_CD
            ,VND.POST_CD
            ,VND.CTRY_CD
            ,VND.LOC_NUM
            ,VND.LOC_NM
            ,VND.ADDL_LOC_NM
            ,VND.GLN_NUM
            ,VND.FIRST_REF_CMNT_TXT
            ,VND.SCD_REF_CMNT_TXT
            ,VND.DBA_NM
            ,VND.DUNS_NUM
            ,VND.RGTN_STS_CD
            ,VND.PTY_LOC_PK
            ,VND.LOC_ROLE_TP_CD
            ,VND.LOC_GRP_CD
            ,VND.EFF_FROM_DT
            ,VND.EFF_THRU_DT
            ,VND.COA_AFFL_CD
            ,VND.INTL_VND_FLG
            ,VND.ASN_REQ_FLG
            ,VND.CMPY_PK
            ,VND.FAX_NUM
            ,VND.TEL_NUM
            ,VND.PAYEE_FLG
            ,VND.THIRD_PTY_VND_FLG
            ,VND.TRSMT_METH_TP_CD
            ,VND.SHPG_SVC_LVL_CD
            ,VND.FRT_CHRG_TO_CD
            ,VND.FRT_CHRG_METH_CD
            ,VND.INV_RCV_METH_TP_CD
            ,VND.CHRG_RATE_VND_GRP_CD
            ,VND.AFFL_GLBL_CMPY_CD
            ,VND.ATTN_NM
            ,VND.WH_CD
            ,VND.SEND_PO_EML_ADDR
            ,VND.DEAL_CCY_CD
            ,VND.INV_VND_CD
            ,VND.PRNT_VND_PK
            ,VND.SPLY_PMT_FLG
            ,VND.SPLY_PO_FLG
            ,VND.INV_MACH_TP_CD
            ,VND.INV_TOL_RATE
            ,VND.RCV_TOL_RATE
            ,VND.VND_PMT_TERM_CD
            ,VND.VND_PMT_TERM_DESC_TXT
            ,VND.VND_PMT_METH_CD
            ,VND.PAY_GRP_CD
            ,VND.SPLY_EDI_LOC_CD
            ,VND.SPLY_EDI_NUM
            ,VND.INAC_DT
            ,VND.SPLY_SITE_DEAL_CD
            ,VND.XTRNL_REF_NUM
            ,VND.END_CUST_NUM
            ,VND.ARCS_SPLY_SITE_CD
            ,VND.ARCS_SPLY_SITE_ID
            ,VND.BILL_TO_CUST_CD
            ,VND.SPLY_COA_CMPY_CD
            ,VND.SPLY_COA_BR_CD
            ,VND.SPLY_COA_CC_CD
            ,VND.SPLY_COA_ACCT_CD
            ,VND.SPLY_COA_PROD_CD
            ,VND.SPLY_COA_CH_CD
            ,VND.SPLY_COA_AFFL_CD
            ,VND.SPLY_COA_PROJ_CD
            ,VND.SPLY_COA_EXTN_CD
            ,VND.PRE_PMT_COA_CMPY_CD
            ,VND.PRE_PMT_COA_BR_CD
            ,VND.PRE_PMT_COA_CC_CD
            ,VND.PRE_PMT_COA_ACCT_CD
            ,VND.PRE_PMT_COA_PROD_CD
            ,VND.PRE_PMT_COA_CH_CD
            ,VND.PRE_PMT_COA_AFFL_CD
            ,VND.PRE_PMT_COA_PROJ_CD
            ,VND.PRE_PMT_COA_EXTN_CD
            ,VND.VND_RTRN_COA_CMPY_CD
            ,VND.VND_RTRN_COA_BR_CD
            ,VND.VND_RTRN_COA_CC_CD
            ,VND.VND_RTRN_COA_ACCT_CD
            ,VND.VND_RTRN_COA_PROD_CD
            ,VND.VND_RTRN_COA_CH_CD
            ,VND.VND_RTRN_COA_AFFL_CD
            ,VND.VND_RTRN_COA_PROJ_CD
            ,VND.VND_RTRN_COA_EXTN_CD
            ,VND.SEND_ARCS_FLG
            ,VND.CARR_TP_CD
            ,VND.INV_MATCH_TP_CD
            ,PV.PRNT_VND_CD
        FROM
             VND         VND
            ,PRNT_VND    PV
        WHERE
            VND.GLBL_CMPY_CD             = #GLBL_CMPY_CD#
        AND VND.ARCS_SPLY_SITE_ID        = #ARCS_SPLY_SITE_ID#
        AND VND.GLBL_CMPY_CD             = PV.GLBL_CMPY_CD
        AND VND.PRNT_VND_PK              = PV.PRNT_VND_PK
        AND VND.EZCANCELFLAG            = '0' 
        AND PV.EZCANCELFLAG             = '0' 
    </statement>
    
    <statement id="getVndInfoByVndCd" parameterClass="Map" resultClass="Map">
        SELECT
             VND.GLBL_CMPY_CD
            ,VND.VND_PK
            ,VND.VND_CD
            ,VND.TAX_PAYER_ID
            ,VND.FIRST_LINE_ADDR
            ,VND.SCD_LINE_ADDR
            ,VND.THIRD_LINE_ADDR
            ,VND.FRTH_LINE_ADDR
            ,VND.CTY_ADDR
            ,VND.CNTY_PK
            ,VND.PROV_NM
            ,VND.ST_CD
            ,VND.POST_CD
            ,VND.CTRY_CD
            ,VND.LOC_NUM
            ,VND.LOC_NM
            ,VND.ADDL_LOC_NM
            ,VND.GLN_NUM
            ,VND.FIRST_REF_CMNT_TXT
            ,VND.SCD_REF_CMNT_TXT
            ,VND.DBA_NM
            ,VND.DUNS_NUM
            ,VND.RGTN_STS_CD
            ,VND.PTY_LOC_PK
            ,VND.LOC_ROLE_TP_CD
            ,VND.LOC_GRP_CD
            ,VND.EFF_FROM_DT
            ,VND.EFF_THRU_DT
            ,VND.COA_AFFL_CD
            ,VND.INTL_VND_FLG
            ,VND.ASN_REQ_FLG
            ,VND.CMPY_PK
            ,VND.FAX_NUM
            ,VND.TEL_NUM
            ,VND.PAYEE_FLG
            ,VND.THIRD_PTY_VND_FLG
            ,VND.TRSMT_METH_TP_CD
            ,VND.SHPG_SVC_LVL_CD
            ,VND.FRT_CHRG_TO_CD
            ,VND.FRT_CHRG_METH_CD
            ,VND.INV_RCV_METH_TP_CD
            ,VND.CHRG_RATE_VND_GRP_CD
            ,VND.AFFL_GLBL_CMPY_CD
            ,VND.ATTN_NM
            ,VND.WH_CD
            ,VND.SEND_PO_EML_ADDR
            ,VND.DEAL_CCY_CD
            ,VND.INV_VND_CD
            ,VND.PRNT_VND_PK
            ,VND.SPLY_PMT_FLG
            ,VND.SPLY_PO_FLG
            ,VND.INV_MACH_TP_CD
            ,VND.INV_TOL_RATE
            ,VND.RCV_TOL_RATE
            ,VND.VND_PMT_TERM_CD
            ,VND.VND_PMT_TERM_DESC_TXT
            ,VND.VND_PMT_METH_CD
            ,VND.PAY_GRP_CD
            ,VND.SPLY_EDI_LOC_CD
            ,VND.SPLY_EDI_NUM
            ,VND.INAC_DT
            ,VND.SPLY_SITE_DEAL_CD
            ,VND.XTRNL_REF_NUM
            ,VND.END_CUST_NUM
            ,VND.ARCS_SPLY_SITE_CD
            ,VND.ARCS_SPLY_SITE_ID
            ,VND.BILL_TO_CUST_CD
            ,VND.SPLY_COA_CMPY_CD
            ,VND.SPLY_COA_BR_CD
            ,VND.SPLY_COA_CC_CD
            ,VND.SPLY_COA_ACCT_CD
            ,VND.SPLY_COA_PROD_CD
            ,VND.SPLY_COA_CH_CD
            ,VND.SPLY_COA_AFFL_CD
            ,VND.SPLY_COA_PROJ_CD
            ,VND.SPLY_COA_EXTN_CD
            ,VND.PRE_PMT_COA_CMPY_CD
            ,VND.PRE_PMT_COA_BR_CD
            ,VND.PRE_PMT_COA_CC_CD
            ,VND.PRE_PMT_COA_ACCT_CD
            ,VND.PRE_PMT_COA_PROD_CD
            ,VND.PRE_PMT_COA_CH_CD
            ,VND.PRE_PMT_COA_AFFL_CD
            ,VND.PRE_PMT_COA_PROJ_CD
            ,VND.PRE_PMT_COA_EXTN_CD
            ,VND.VND_RTRN_COA_CMPY_CD
            ,VND.VND_RTRN_COA_BR_CD
            ,VND.VND_RTRN_COA_CC_CD
            ,VND.VND_RTRN_COA_ACCT_CD
            ,VND.VND_RTRN_COA_PROD_CD
            ,VND.VND_RTRN_COA_CH_CD
            ,VND.VND_RTRN_COA_AFFL_CD
            ,VND.VND_RTRN_COA_PROJ_CD
            ,VND.VND_RTRN_COA_EXTN_CD
            ,VND.SEND_ARCS_FLG
            ,VND.CARR_TP_CD
            ,VND.INV_MATCH_TP_CD
            ,PV.PRNT_VND_CD
        FROM
             VND          VND
            ,PRNT_VND     PV
        WHERE
            VND.GLBL_CMPY_CD     = #GLBL_CMPY_CD#
        AND VND.VND_CD           = #VND_CD#
        AND VND.GLBL_CMPY_CD      = PV.GLBL_CMPY_CD
        AND VND.PRNT_VND_PK       = PV.PRNT_VND_PK
        AND VND.EZCANCELFLAG     = '0'
        AND PV.EZCANCELFLAG      = '0'
    </statement>


    <statement id="getContactInfoList" parameterClass="Map" resultClass="Map">
    <![CDATA[
        SELECT
             INTERFACE_ID
            ,TRANSACTION_ID
            ,SEGMENT_ID
            ,UNIT_ID
            ,SEQ_NUMBER
            ,ARCS_SPLY_ID
            ,ARCS_SPLY_NUM
            ,PRNT_VND_NM
            ,ARCS_VND_TP_LKUP_TXT
            ,PRNT_VND_PMT_TERM_DESC_TXT
            ,ARCS_TAX_PAYER_ID
            ,PAY_ALONE_FLG
            ,PRNT_VND_EFF_FROM_DT
            ,PRNT_VND_INAC_DT
            ,PRNT_VND_LAST_UPD_TS
            ,ARCS_SPLY_SITE_ID
            ,ARCS_SPLY_SITE_CD
            ,ARCS_SPLY_SITE_ATTRB_TXT_05
            ,ARCS_CTRY_TXT
            ,VND_ADDR_ALL_TXT_01
            ,VND_ADDR_ALL_TXT_02
            ,VND_ADDR_ALL_TXT_03
            ,CTY_ADDR
            ,ST_CD
            ,POST_CD
            ,ARCS_CNTY_NM
            ,ARCS_PROV_NM
            ,ALT_VND_ADDR_ALL_TXT
            ,ARCS_SPLY_COA_SEG_TXT_01
            ,ARCS_SPLY_COA_SEG_TXT_02
            ,ARCS_SPLY_COA_SEG_TXT_03
            ,ARCS_SPLY_COA_SEG_TXT_04
            ,ARCS_SPLY_COA_SEG_TXT_05
            ,ARCS_SPLY_COA_SEG_TXT_06
            ,ARCS_SPLY_COA_SEG_TXT_07
            ,ARCS_SPLY_COA_SEG_TXT_08
            ,ARCS_SPLY_COA_SEG_TXT_09
            ,VND_PMT_TERM_DESC_TXT
            ,VND_INAC_DT
            ,VND_LAST_UPD_TS
            ,ARCS_CTAC_PSN_FIRST_NM
            ,ARCS_CTAC_PSN_LAST_NM
            ,ARCS_CTAC_AREA_TEL_NUM
            ,ARCS_CTAC_TEL_NUM
            ,ARCS_CTAC_AREA_FAX_NUM
            ,ARCS_CTAC_FAX_NUM
            ,ARCS_CTAC_EML_ADDR
            ,VND_CTAC_INAC_DT
            ,VND_CTAC_LAST_UPD_TS
        FROM
            NMAI1130_01
        WHERE
            INTERFACE_ID                                         = #INTERFACE_ID#
        AND TRANSACTION_ID                                       = #TRANSACTION_ID#
        AND ARCS_SPLY_ID                                         = #ARCS_SPLY_ID#
        AND ARCS_CTAC_PSN_FIRST_NM IS NOT NULL
        AND ARCS_CTAC_PSN_LAST_NM IS NOT NULL
        AND SUBSTR(NVL(VND_CTAC_LAST_UPD_TS, '00000000'), 1, 8)  >= #DS_BIZ_LAST_UPD_TS#
        AND EZCANCELFLAG                                         = '0'
    ]]>
    </statement>


    <statement id="getCtacInfoList" parameterClass="Map" resultClass="Map">
        SELECT
             DCPR.GLBL_CMPY_CD
            ,DCPR.DS_CTAC_PSN_RELN_PK
            ,DCPR.CTAC_PSN_PK
            ,DCPR.DS_ACCT_NUM
            ,DCPR.LOC_NUM
            ,DCPR.EFF_FROM_DT
            ,DCPR.EFF_THRU_DT
            ,DCPR.DS_PRIM_LOC_FLG
            ,CP.PTY_LOC_PK
            ,CP.CTAC_PSN_FIRST_NM
            ,CP.CTAC_PSN_MID_NM
            ,CP.CTAC_PSN_LAST_NM
            ,CP.CTAC_PSN_EML_ADDR
            ,CP.CTAC_PSN_EXTN_NUM
            ,CP.CTAC_PSN_PVT_FLG
            ,CP.CTAC_PSN_PVT_LOGIN_USR_NM
            ,CP.CTAC_PSN_SCR_TRGT_FLG
            ,CP.CTAC_PSN_RCV_ML_FLG
            ,DCPR.CTAC_TP_CD
            ,CP.CTAC_PSN_TEL_NUM
            ,CP.CTAC_PSN_CELL_PHO_NUM
            ,CP.CTAC_PSN_FAX_NUM
            ,CP.CTAC_PSN_CMNT_TXT
            ,CP.CTAC_PSN_ACTV_FLG
            ,CP.DS_CTAC_PSN_SALT_CD
            ,CP.DS_CTAC_PSN_DEPT_CD
            ,CP.DS_CTAC_PSN_TTL_CD
            ,CP.DS_PRIM_CTAC_TP_CD
            ,CP.CTAC_PSN_NUM
            ,CP.CTAC_PSN_ADMIN_TEL_NUM
            ,DCPN.DS_CTAC_PNT_TP_CD
            ,DCPN.DS_CTAC_PNT_PK
            ,DCPN.DS_CTAC_PNT_VAL_TXT
            ,DCPN.DS_CTAC_PSN_EXTN_NUM
            ,DCPN.DS_OPS_OUT_FLG
            ,DCPN.DS_CTAC_PNT_ACTV_FLG
        FROM
             DS_CTAC_PSN_RELN DCPR
            ,CTAC_PSN CP
            ,DS_CTAC_PNT DCPN
        WHERE 
            DCPR.GLBL_CMPY_CD        = #GLBL_CMPY_CD#
        AND DCPR.LOC_NUM             = #LOC_NUM#
        AND DCPR.GLBL_CMPY_CD        = CP.GLBL_CMPY_CD
        AND DCPR.CTAC_PSN_PK         = CP.CTAC_PSN_PK
        AND CP.CTAC_PSN_FIRST_NM     = #CTAC_PSN_FIRST_NM#
        AND CP.CTAC_PSN_LAST_NM      = #CTAC_PSN_LAST_NM#
        AND CP.GLBL_CMPY_CD          = DCPN.GLBL_CMPY_CD
        AND CP.CTAC_PSN_PK           = DCPN.CTAC_PSN_PK
        <iterate property="dsCtacPntTpCd" var="elem[]" open=" AND DCPN.DS_CTAC_PNT_TP_CD IN (" close=")" conjunction=",">
            #elem[]#
        </iterate>
        AND DCPR.EZCANCELFLAG        = '0'
        AND CP.EZCANCELFLAG          = '0'
        AND DCPN.EZCANCELFLAG        = '0'
    </statement>
    
    <statement id="getPrntVndByArcsSplyId" parameterClass="Map" resultClass="Map">
        SELECT
             GLBL_CMPY_CD
            ,PRNT_VND_PK
            ,PRNT_VND_CD
            ,PRNT_VND_NM
            ,SPLY_NM
            ,SPLY_TP_CD
            ,PRNT_VND_TP_CD
            ,TAX_PAYER_ID
            ,INAC_DT
            ,TAX_PAYER_RG_NUM
            ,ARCS_SPLY_NUM
            ,ARCS_SPLY_ID
            ,INDY_TP_CD
            ,MNRTY_OWND_TP_CD
            ,SPLY_ORG_TP_CD
            ,SPLY_ONE_TM_FLG
            ,SM_BIZ_FLG
            ,WOMEN_OWNED_FLG
            ,EXCL_PMT_FLG
            ,DISC_TAKE_FLG
            ,PO_PMT_HLD_FLG
            ,FD_RPT_FLG
            ,INC_TAX_TP_CD
            ,ST_TAX_FLG
            ,SPLY_RPT_NM
            ,SPLY_DEAL_CD
            ,COA_AFFL_CD
            ,SPLY_HUB_ZN_CD
            ,DS_ACCT_NUM
            ,VND_PMT_TERM_CD
            ,VND_PMT_TERM_DESC_TXT
            ,VND_PMT_METH_CD
            ,PAY_GRP_CD
            ,WOMEN_OWND_FLG
            ,PAY_ALONE_FLG
        FROM
            PRNT_VND
        WHERE
            GLBL_CMPY_CD = #GLBL_CMPY_CD#
        AND ARCS_SPLY_ID = #ARCS_SPLY_ID#
        AND EZCANCELFLAG = '0' 
    </statement>
    
    <statement id="getPrntVndTp" parameterClass="Map" resultClass="String">
        SELECT
            PVT.PRNT_VND_TP_CD
        FROM
             PRNT_VND_TP_CONV PVTC
            ,PRNT_VND_TP PVT
        WHERE
            PVTC.GLBL_CMPY_CD               = #GLBL_CMPY_CD#
        AND PVTC.XTRNL_SYS_VND_TP_LKUP_TXT  = #XTRNL_SYS_VND_TP_LKUP_TXT#
        AND PVTC.GLBL_CMPY_CD               = PVT.GLBL_CMPY_CD
        AND PVTC.PRNT_VND_TP_CD             = PVT.PRNT_VND_TP_CD
        AND PVTC.EZCANCELFLAG               = '0' 
        AND PVT.EZCANCELFLAG                = '0' 
    </statement>
    
    <statement id="getBizLastUpdDt" parameterClass="Map" resultClass="Map">
        SELECT 
             MAX(PRNT_VND_LAST_UPD_DT) AS MAX_PRNT_VND_LAST_UPD_DT
            ,MAX(VND_LAST_UPD_DT)      AS MAX_VND_LAST_UPD_DT
            ,MAX(VND_CTAC_LAST_UPD_DT) AS MAX_VND_CTAC_LAST_UPD_DT
        FROM
            (SELECT 
                 SUBSTR(NVL(PRNT_VND_LAST_UPD_TS, '00000000'), 1, 8)     AS PRNT_VND_LAST_UPD_DT
                ,SUBSTR(NVL(VND_LAST_UPD_TS, '00000000'), 1, 8)          AS VND_LAST_UPD_DT
                ,SUBSTR(NVL(VND_CTAC_LAST_UPD_TS, '00000000'), 1, 8)     AS VND_CTAC_LAST_UPD_DT
            FROM 
                NMAI1130_01
            WHERE
                INTERFACE_ID            = #INTERFACE_ID#
            AND TRANSACTION_ID          = #TRANSACTION_ID#
            AND EZCANCELFLAG               = '0' 
            )
    </statement>
    
    <statement id="getPrntVndInfo" parameterClass="Map" resultClass="Map">
    SELECT
         PV.GLBL_CMPY_CD
        ,PV.PRNT_VND_PK
        ,PV.PRNT_VND_CD
        ,PV.PRNT_VND_NM
        ,PV.SPLY_NM
        ,PV.SPLY_TP_CD
        ,PV.PRNT_VND_TP_CD
        ,PV.TAX_PAYER_ID
        ,PV.INAC_DT
        ,PV.TAX_PAYER_RG_NUM
        ,PV.ARCS_SPLY_NUM
        ,PV.ARCS_SPLY_ID
        ,PV.INDY_TP_CD
        ,PV.MNRTY_OWND_TP_CD
        ,PV.SPLY_ORG_TP_CD
        ,PV.SPLY_ONE_TM_FLG
        ,PV.SM_BIZ_FLG
        ,PV.WOMEN_OWNED_FLG
        ,PV.EXCL_PMT_FLG
        ,PV.DISC_TAKE_FLG
        ,PV.PO_PMT_HLD_FLG
        ,PV.FD_RPT_FLG
        ,PV.INC_TAX_TP_CD
        ,PV.ST_TAX_FLG
        ,PV.SPLY_RPT_NM
        ,PV.SPLY_DEAL_CD
        ,PV.COA_AFFL_CD
        ,PV.SPLY_HUB_ZN_CD
        ,PV.DS_ACCT_NUM
        ,PV.VND_PMT_TERM_CD
        ,PV.VND_PMT_TERM_DESC_TXT
        ,PV.VND_PMT_METH_CD
        ,PV.PAY_GRP_CD
        ,PV.WOMEN_OWND_FLG
        ,PV.PAY_ALONE_FLG
    FROM
        PRNT_VND PV
    WHERE 1=1
        AND PV.GLBL_CMPY_CD = #GLBL_CMPY_CD#
        AND PV.PRNT_VND_PK  = #PRNT_VND_PK#
        AND PV.EZCANCELFLAG = '0'
    </statement>

    <statement id="getVndPmtTermCd" parameterClass="Map"  resultClass="String">
        SELECT
            VND_PMT_TERM_CD
        FROM
            VND_PMT_TERM VPT
        WHERE
            VPT.GLBL_CMPY_CD            = #GLBL_CMPY_CD#
        AND VPT.EZCANCELFLAG            = '0'
        AND VPT.VND_PMT_TERM_DESC_TXT   = #VND_PMT_TERM_DESC_TXT#
    </statement>

    <!-- START 2021/02/15 G.Delgado [QC#55912,ADD] -->
    <statement id="checkPrntVndTpSendArcs" parameterClass="Map"  resultClass="Integer">
        SELECT
            COUNT(PVT.SEND_ARCS_FLG)
        FROM
             PRNT_VND PV
            ,PRNT_VND_TP PVT
        WHERE 1=1
            AND PV.GLBL_CMPY_CD                 = #GLBL_CMPY_CD#
            AND PV.PRNT_VND_CD                  = #PRNT_VND_CD#
            AND PV.GLBL_CMPY_CD                 = PVT.GLBL_CMPY_CD
            AND PV.PRNT_VND_TP_CD               = PVT.PRNT_VND_TP_CD
            AND PVT.SEND_ARCS_FLG               = 'Y'
            AND PV.EZCANCELFLAG                 = '0'
            AND PVT.EZCANCELFLAG                = '0'
    </statement>
    <statement id="checkSplySitesWithPurFlgOnPayFlgOff" parameterClass="Map"  resultClass="Integer">
        SELECT
            COUNT(V.VND_CD)
        FROM
            VND V
        WHERE
            V.GLBL_CMPY_CD        = #GLBL_CMPY_CD#
        AND V.PRNT_VND_PK         = #PRNT_VND_PK#
        AND V.SPLY_PO_FLG         = 'Y'
        AND V.SPLY_PMT_FLG        = 'N'
        AND V.EZCANCELFLAG        = '0'
    </statement>
    <!-- END 2021/02/15 G.Delgado [QC#55912,ADD] -->
</sqlMap>
