<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NLXC042001SvcMachMstrCheck">

    <statement id="getSvcMachMstrList" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.SVC_MACH_MSTR_PK
           ,SMM.SER_NUM
           ,SMM.MDSE_CD
           ,SMM.SVC_CONFIG_MSTR_PK
           ,SMM.SVC_MACH_MSTR_STS_CD
           ,SMM.CUR_LOC_NUM
           ,DILV.RTL_WH_CD
           ,SMM.SVC_MACH_MAINT_AVAL_FLG
           ,SMM.TRX_HDR_NUM
           ,SMM.STK_STS_CD
           ,SMM.SVC_MACH_MSTR_LOC_STS_CD
           ,SCM.MDL_ID
        FROM
            SVC_MACH_MSTR   SMM
           ,DS_INVTY_LOC_V  DILV
           ,SVC_CONFIG_MSTR SCM
        WHERE
            SMM.GLBL_CMPY_CD       = #glblCmpyCd#
        AND SMM.SER_NUM            = #serNum#
        AND SMM.MDSE_CD            = #mdseCd#
        <isNotNull property="trxHdrNum">
        AND SMM.TRX_HDR_NUM        = #trxHdrNum#
        </isNotNull>
        AND SMM.EZCANCELFLAG       = '0'
        AND SMM.GLBL_CMPY_CD       = DILV.GLBL_CMPY_CD(+)
        AND SMM.CUR_LOC_NUM        = DILV.INVTY_LOC_CD(+)
        AND DILV.EZCANCELFLAG(+)   = '0'
        AND SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD(+)
        AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK(+)
        AND SCM.EZCANCELFLAG(+)    = '0'
        ORDER BY
            SMM.SVC_MACH_MSTR_PK
    </statement>

    <statement id="getDefMdseSvcMachMstrList" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.SVC_MACH_MSTR_PK
           ,SMM.SER_NUM
           ,SMM.MDSE_CD
           ,SMM.SVC_CONFIG_MSTR_PK
           ,SMM.SVC_MACH_MSTR_STS_CD
           ,SMM.CUR_LOC_NUM
           ,DILV.RTL_WH_CD
           ,SMM.SVC_MACH_MAINT_AVAL_FLG
           ,SMM.TRX_HDR_NUM
           ,SMM.STK_STS_CD
           ,SMM.SVC_MACH_MSTR_LOC_STS_CD
           ,SCM.MDL_ID
        FROM
            SVC_MACH_MSTR   SMM
           ,DS_INVTY_LOC_V  DILV
           ,SVC_CONFIG_MSTR SCM
        WHERE
            SMM.GLBL_CMPY_CD       = #glblCmpyCd#
        AND SMM.SER_NUM            = #serNum#
        AND SMM.MDSE_CD     &lt;&gt; #mdseCd#
        AND SMM.EZCANCELFLAG       = '0'
        AND SMM.GLBL_CMPY_CD       = DILV.GLBL_CMPY_CD(+)
        AND SMM.CUR_LOC_NUM        = DILV.INVTY_LOC_CD(+)
        AND DILV.EZCANCELFLAG(+)   = '0'
        AND SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD(+)
        AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK(+)
        AND SCM.EZCANCELFLAG(+)    = '0'
        ORDER BY
            SMM.SVC_MACH_MSTR_PK
    </statement>

    <statement id="getDefMdseSvcMachMstrListForMdlChk" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.SVC_MACH_MSTR_PK
           ,SMM.SER_NUM
           ,SMM.MDSE_CD
           ,SMM.SVC_CONFIG_MSTR_PK
           ,SMM.SVC_MACH_MSTR_STS_CD
           ,SMM.CUR_LOC_NUM
           ,DILV.RTL_WH_CD
           ,SMM.SVC_MACH_MAINT_AVAL_FLG
           ,SMM.TRX_HDR_NUM
           ,SMM.STK_STS_CD
           ,SMM.SVC_MACH_MSTR_LOC_STS_CD
           <isNotNull property="mdlId">
           ,SCM.MDL_ID
           </isNotNull>
        FROM
            SVC_MACH_MSTR   SMM
           ,DS_INVTY_LOC_V  DILV
           <isNotNull property="mdlId">
           ,SVC_CONFIG_MSTR SCM
           </isNotNull>
        WHERE
            SMM.GLBL_CMPY_CD       = #glblCmpyCd#
        AND SMM.SER_NUM            = #serNum#
        AND SMM.MDSE_CD     &lt;&gt; #mdseCd#
        AND SMM.EZCANCELFLAG       = '0'
        AND SMM.GLBL_CMPY_CD       = DILV.GLBL_CMPY_CD(+)
        AND SMM.CUR_LOC_NUM        = DILV.INVTY_LOC_CD(+)
        AND DILV.EZCANCELFLAG(+)   = '0'
        <isNotNull property="mdlId">
        AND SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD
        AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK
        AND SCM.EZCANCELFLAG       = '0'
        </isNotNull>
        <isNull property="mdlId">
        AND NOT EXISTS (
                        SELECT
                            1
                        FROM
                            SVC_CONFIG_MSTR SCM
                        WHERE
                            SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD
                        AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK
                        AND SCM.EZCANCELFLAG       = '0'
                       )
        </isNull>
        ORDER BY
            SMM.SVC_MACH_MSTR_PK
    </statement>

    <statement id="getSoSerialList" parameterClass="Map" resultClass="String">
        SELECT
            SS.SER_NUM
        FROM
            SO_SER SS
        WHERE
            SS.GLBL_CMPY_CD = #glblCmpyCd#
        AND SS.SO_NUM       = #soNum#
        AND SS.MDSE_CD      = #mdseCd#
        <isNotNull property="whPickFlg">
        AND SS.WH_PICK_FLG  = #whPickFlg#
        </isNotNull>
        <isNotNull property="ordAsgFlg">
        AND SS.ORD_ASG_FLG  = #ordAsgFlg#
        </isNotNull>
        AND NOT EXISTS (
                        SELECT
                            1
                        FROM
                            SHIP_SER_NUM PS
                        WHERE
                            PS.GLBL_CMPY_CD = SS.GLBL_CMPY_CD
                        AND PS.SO_NUM       = SS.SO_NUM
                        AND PS.MDSE_CD      = SS.MDSE_CD
                        AND PS.SER_NUM      = SS.SER_NUM
                        AND PS.EZCANCELFLAG = '0'
                       )
        AND SS.EZCANCELFLAG = '0'
    </statement>

    <statement id="getRwsSerialList" parameterClass="Map" resultClass="String">
        SELECT
            RS.SER_NUM
        FROM
            RWS_SER RS
        WHERE
            RS.GLBL_CMPY_CD = #glblCmpyCd#
        AND RS.RWS_NUM      = #rwsNum#
        AND RS.MDSE_CD      = #mdseCd#
        AND RS.EZCANCELFLAG = '0'
    </statement>

    <statement id="getMdseInfo" parameterClass="Map" resultClass="Map">
        SELECT
            MD.MDSE_CD
           ,MD.RCV_SER_TAKE_FLG
           ,MD.SHPG_SER_TAKE_FLG
           ,MD.INSTL_BASE_CTRL_FLG
           ,MD.MDSE_DESC_SHORT_TXT
        FROM
            MDSE         MD
       WHERE
           MD.GLBL_CMPY_CD  = #glblCmpyCd#
       AND MD.MDSE_CD       = #mdseCd#
       AND MD.EZCANCELFLAG  = '0'
    </statement>

    <statement id="geRcvSerCheckCtrl" parameterClass="Map" resultClass="Map">
        SELECT
            DCC.DS_COND_CONST_GRP_ID
           ,DCC.DS_COND_CONST_CD
           ,DCC.DS_COND_CONST_NM
           ,DCC.DS_COND_CONST_SORT_NUM
           ,DCC.DS_COND_CONST_DESC_TXT
           ,DCC.DS_COND_CONST_VAL_TXT_01
           ,DCC.DS_COND_CONST_VAL_TXT_02
           ,DCC.DS_COND_CONST_VAL_TXT_03
           ,DCC.DS_COND_CONST_VAL_TXT_04
           ,DCC.DS_COND_CONST_VAL_TXT_05
           ,DCC.DS_COND_CONST_VAL_TXT_06
           ,DCC.DS_COND_CONST_VAL_TXT_07
           ,DCC.DS_COND_CONST_VAL_TXT_08
           ,DCC.DS_COND_CONST_VAL_TXT_09
           ,DCC.DS_COND_CONST_VAL_TXT_10
           ,DCC.DS_COND_CONST_VAL_NUM_01
           ,DCC.DS_COND_CONST_VAL_NUM_02
           ,DCC.DS_COND_CONST_VAL_NUM_03
           ,DCC.DS_COND_CONST_VAL_NUM_04
           ,DCC.DS_COND_CONST_VAL_NUM_05
        FROM
            DS_COND_CONST    DCC
        WHERE
            DCC.GLBL_CMPY_CD         = #glblCmpyCd#
        AND DCC.DS_COND_CONST_GRP_ID = #dsCondConstGrpId#
        AND DCC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getTrxHdrNum" parameterClass="Map" resultClass="String">
        SELECT DISTINCT
            SOD.TRX_HDR_NUM
        FROM
            RWS_HDR RH
           ,RWS_DTL RD
           ,PRCH_REQ_DTL PRD
           ,SHPG_ORD_DTL SOD
        WHERE
            RH.GLBL_CMPY_CD           = #glblCmpyCd#
        AND RH.RWS_NUM                = #rwsNum#
        AND RH.EZCANCELFLAG           = '0'
        AND RH.GLBL_CMPY_CD           = RD.GLBL_CMPY_CD
        AND RH.RWS_NUM                = RD.RWS_NUM
        AND RD.EZCANCELFLAG           = '0'
        AND RD.GLBL_CMPY_CD           = PRD.GLBL_CMPY_CD
        AND RH.PO_RCV_TRX_HDR_NUM     = PRD.PO_ORD_NUM
        AND RD.PO_RCV_TRX_LINE_NUM    = PRD.PO_ORD_DTL_LINE_NUM
        AND PRD.EZCANCELFLAG          = '0'
        AND PRD.GLBL_CMPY_CD          = SOD.GLBL_CMPY_CD
        AND PRD.PRCH_REQ_NUM          = SOD.PRCH_REQ_NUM
        AND PRD.PRCH_REQ_LINE_NUM     = SOD.PRCH_REQ_LINE_NUM
        AND PRD.PRCH_REQ_LINE_SUB_NUM = SOD.PRCH_REQ_LINE_SUB_NUM
        AND SOD.EZCANCELFLAG          = '0'
    </statement>

    <statement id="getRtlWhCd" parameterClass="Map" resultClass="String">
        SELECT DISTINCT
            PRD.DEST_RTL_WH_CD
        FROM
            RWS_HDR RH
           ,RWS_DTL RD
           ,PRCH_REQ_DTL PRD
        WHERE
            RH.GLBL_CMPY_CD           = #glblCmpyCd#
        AND RH.RWS_NUM                = #rwsNum#
        AND RH.EZCANCELFLAG           = '0'
        AND RH.GLBL_CMPY_CD           = RD.GLBL_CMPY_CD
        AND RH.RWS_NUM                = RD.RWS_NUM
        AND RD.EZCANCELFLAG           = '0'
        AND RD.GLBL_CMPY_CD           = PRD.GLBL_CMPY_CD
        AND RH.PO_RCV_TRX_HDR_NUM     = PRD.PO_ORD_NUM
        AND RD.PO_RCV_TRX_LINE_NUM    = PRD.PO_ORD_DTL_LINE_NUM
        AND PRD.EZCANCELFLAG          = '0'
    </statement>

</sqlMap>