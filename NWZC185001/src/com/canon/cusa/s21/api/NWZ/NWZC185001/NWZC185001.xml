<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NWZC185001">
   
    <statement id="getDefPrcCatgCd" parameterClass="Map" resultClass="Map">
            SELECT
                  PD.LINE_BIZ_TP_CD
                , PD.DEF_PRC_CATG_CD
            FROM
                DS_ORD_TP_PROC_DFN PD
            WHERE
                    PD.GLBL_CMPY_CD = #glblCmpyCd#
                AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
                AND PD.ACTV_FLG     = 'Y'
                AND PD.EFF_FROM_DT &lt;= #slsDt#
                AND (
                    PD.EFF_THRU_DT &gt;= #slsDt#
                 OR PD.EFF_THRU_DT  IS NULL
                    )
                AND PD.EZCANCELFLAG = '0'
    </statement>
    
    <statement id="getXtrnlIntfcXref" parameterClass="Map" resultClass="Map">
            SELECT
                  X.TRGT_ATTRB_TXT_01
                , X.TRGT_ATTRB_TXT_02
                , X.TRGT_ATTRB_TXT_03
                , X.TRGT_ATTRB_TXT_04
            FROM
                XTRNL_INTFC_XREF X
            WHERE
                    X.GLBL_CMPY_CD           = #glblCmpyCd#
                AND X.CPO_SRC_TP_CD          = #cpoSrcTpCd#
                AND X.INTFC_ID               IS NULL
                AND X.INTFC_XREF_CTX_TP_CD   = #intfcXrefCtxTpCd#
                AND X.SRC_ATTRB_TXT_01       IS NULL
                AND X.SRC_ATTRB_TXT_02       = #srcAttrbTxt02#
                AND X.SRC_ATTRB_TXT_03       = #srcAttrbTxt03#
                AND X.EZCANCELFLAG = '0'
    </statement>
    
    <statement id="getBillToCustByLocNum" parameterClass="Map" resultClass="Map">
            SELECT
                  B.SELL_TO_CUST_CD
                , B.BILL_TO_CUST_CD
            FROM
                BILL_TO_CUST B
            WHERE
                    B.GLBL_CMPY_CD     = #glblCmpyCd#
                AND B.LOC_NUM          = #locNum#
                AND B.RGTN_STS_CD      = #rgtnStsCd#
                AND B.EZCANCELFLAG     = '0'
                AND B.EZCANCELFLAG    = '0'
    </statement>
    
    <statement id="getShipToCustByLocNum" parameterClass="Map" resultClass="Map">
            SELECT
                  S.SELL_TO_CUST_CD
                , S.SHIP_TO_CUST_CD
                , S.ADDL_LOC_NM
                , S.LOC_NM
                , S.FIRST_LINE_ADDR
                , S.SCD_LINE_ADDR
                , S.THIRD_LINE_ADDR
                , S.FRTH_LINE_ADDR
                , S.POST_CD
                , S.CTY_ADDR
                , S.ST_CD
                , S.PROV_NM
                , S.CTRY_CD
                , S.CNTY_PK
                , S.FIRST_REF_CMNT_TXT
                , S.SCD_REF_CMNT_TXT
                , C.CNTY_NM
            FROM
                SHIP_TO_CUST S
              , CNTY C
            WHERE
                    S.GLBL_CMPY_CD     = #glblCmpyCd#
                AND S.LOC_NUM          = #locNum#
                AND S.RGTN_STS_CD      = #rgtnStsCd#
<!-- 2018/11/22 QC#29220 Mod Start -->
<!--            AND S.GLBL_CMPY_CD     = C.GLBL_CMPY_CD -->
<!--            AND S.CNTY_PK          = C.CNTY_PK -->
                AND S.GLBL_CMPY_CD     = C.GLBL_CMPY_CD (+)
                AND S.CNTY_PK          = C.CNTY_PK (+)
                AND S.EZCANCELFLAG     = '0'
<!--            AND C.EZCANCELFLAG     = '0' -->
                AND C.EZCANCELFLAG (+) = '0'
<!-- 2018/11/22 QC#29220 Mod End -->
    </statement>
    
    <statement id="getMdseInfo" parameterClass="Map" resultClass="Map">
    WITH MDSE_V AS (
            SELECT
                  A.GLBL_CMPY_CD
                , A.MDSE_CD
                , A.PKG_UOM_CLS_CD
            FROM
                MDSE A
            WHERE
                    A.GLBL_CMPY_CD     = #glblCmpyCd#
                AND A.MDSE_CD          = #mdseCd#
                AND A.RGTN_STS_CD      = #rgtnStsCd#
                AND A.EZCANCELFLAG     = '0'
            UNION
            SELECT
                  A.GLBL_CMPY_CD
                , A.MDSE_CD
                , A.PKG_UOM_CLS_CD
            FROM
                ORD_TAKE_MDSE O
              , MDSE A
            WHERE
                    O.GLBL_CMPY_CD     = #glblCmpyCd#
                AND O.ORD_TAKE_MDSE_CD = #mdseCd#
                AND A .RGTN_STS_CD     = #rgtnStsCd#
                AND O.GLBL_CMPY_CD     = A.GLBL_CMPY_CD
                AND O.MDSE_CD          = A.MDSE_CD
                AND O.EZCANCELFLAG     = '0'
                AND A.EZCANCELFLAG     = '0'
            UNION
            SELECT
                  A.GLBL_CMPY_CD
                , A.MDSE_CD
                , A.PKG_UOM_CLS_CD
            FROM
                MDSE M
              , ALL_MDSE_V A
            WHERE
                    M.GLBL_CMPY_CD     = #glblCmpyCd#
                AND M.MNF_ITEM_CD      = #mdseCd#
                AND M.GLBL_CMPY_CD     = A.GLBL_CMPY_CD
                AND M.MDSE_CD          = A.MDSE_CD
                AND A.RGTN_STS_CD      = #rgtnStsCd#
                AND M.EZCANCELFLAG     = '0'
                AND A.EZCANCELFLAG     = '0'
            UNION
            SELECT
                  A.GLBL_CMPY_CD
                , A.MDSE_CD
                , A.PKG_UOM_CLS_CD
            FROM
                CUST_MDSE_XREF X
              , ALL_MDSE_V A
            WHERE
                    X.GLBL_CMPY_CD            = #glblCmpyCd#
                AND X.CUST_MDSE_CD            = #mdseCd#
                AND X.DS_ACCT_NUM             = #dsAcctNum#
                AND X.CUST_MDSE_XREF_ENBL_FLG = #flagY#
                AND X.GLBL_CMPY_CD            = A.GLBL_CMPY_CD
                AND X.MDSE_CD                 = A.MDSE_CD
                AND A.RGTN_STS_CD             = #rgtnStsCd#
                AND X.EZCANCELFLAG            = '0'
                AND A.EZCANCELFLAG            = '0'
    )
            SELECT
                  A.MDSE_CD
                , MSP.PKG_UOM_CD BASE_PKG_UOM_CD
                , MSP.IN_EACH_QTY
                , MSP.IN_POUND_WT
            FROM
                MDSE_V A
              , MDSE_STORE_PKG MSP
            WHERE
                    A.GLBL_CMPY_CD     = MSP.GLBL_CMPY_CD
                AND A.MDSE_CD          = MSP.MDSE_CD
                AND MSP.PRIM_PKG_UOM_FLG = 'Y'
                AND MSP.EZCANCELFLAG   = '0'
    </statement>
    
    <statement id="getDsOrdLineProcDfn" parameterClass="Map" resultClass="Map">
            SELECT
                  D.DS_ORD_LINE_CATG_CD
            FROM
                DS_ORD_LINE_PROC_DFN D
              , DS_ORD_LINE_CATG C
            WHERE
                    D.GLBL_CMPY_CD         = #glblCmpyCd#
                AND D.DS_ORD_TP_CD         = #dsOrdTpCd#
                AND D.PRIM_LINE_CATG_FLG   = #flagY#
                AND D.GLBL_CMPY_CD         = C.GLBL_CMPY_CD
                AND D.DS_ORD_LINE_CATG_CD  = C.DS_ORD_LINE_CATG_CD
                AND C.DS_ORD_LINE_DRCTN_CD = #dsOrdLineDrctnCd#
                AND D.EZCANCELFLAG         = '0'
                AND C.EZCANCELFLAG         = '0'
    </statement>
    
    <statement id="getWriterLineBizRoleTp" parameterClass="Map" resultClass="String">
            SELECT
                  D.LINE_BIZ_ROLE_TP_CD
            FROM
                LINE_BIZ_ROLE_TP D
            WHERE
                    D.GLBL_CMPY_CD         = #glblCmpyCd#
                AND D.PRIM_REP_ROLE_FLG    = #primRepRoleFlg#
                AND D.EZCANCELFLAG         = '0'
    </statement>
    
    <statement id="getCarrCdAndShpgSvcLvlRelationCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(CR.GLBL_CMPY_CD)
            FROM
                SHPG_SVC_LVL_CARR_RELN CR 
            WHERE
                CR.GLBL_CMPY_CD        = #glblCmpyCd#
                AND CR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                AND CR.CARR_CD         = #carrCd#
                AND CR.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getFrtCondSvcLvlRelationCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(FR.GLBL_CMPY_CD)
            FROM
                FRT_COND_SVC_LVL_RELN FR
            WHERE
                FR.GLBL_CMPY_CD        = #glblCmpyCd#
                AND FR.LINE_BIZ_TP_CD  = #lineBizTpCd#
                AND FR.FRT_COND_CD     = #frtCondCd#
                AND FR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                AND FR.EZCANCELFLAG    = '0'
    </statement>
    

    <statement id="getCpoDtl" parameterClass="Map" resultClass="Map">
        SELECT
                  DCD.CPO_ORD_NUM
                , DCD.CPO_DTL_LINE_NUM
                , DCD.CPO_DTL_LINE_SUB_NUM
                , DCD.DS_CPO_LINE_NUM
                , DCD.DS_CPO_LINE_SUB_NUM
            FROM
                CPO_DTL DCD
            WHERE
                    DCD.GLBL_CMPY_CD      = #glblCmpyCd#
                AND DCD.CPO_ORD_NUM       = #cpoOrdNum#
                AND DCD.EZCANCELFLAG      = '0'
    </statement>
    
    
    <statement id="getCtacPnt" parameterClass="Map" resultClass="Map">
        SELECT
                  DCP.DS_CTAC_PNT_TP_CD
                , DCP.DS_CTAC_PNT_VAL_TXT
                , DCP.DS_CTAC_PSN_EXTN_NUM
            FROM
                DS_CTAC_PNT DCP
            WHERE
                    DCP.GLBL_CMPY_CD         = #glblCmpyCd#
                AND DCP.CTAC_PSN_PK          = #ctacPsnPk#
                AND DCP.EZCANCELFLAG         = '0'
                AND DCP.DS_OPS_OUT_FLG       = #dsOpsOutFlg#
                AND DCP.DS_CTAC_PNT_ACTV_FLG = #dsCtacPntActvFlg#
            ORDER BY
                DCP.DS_CTAC_PNT_TP_CD
    </statement>
    
    <statement id="getCtacTpCd" parameterClass="Map" resultClass="String">
        SELECT
                  DCPR.CTAC_TP_CD
            FROM
                DS_CTAC_PSN_RELN DCPR
            WHERE
                    DCPR.GLBL_CMPY_CD = #glblCmpyCd#
                AND DCPR.CTAC_PSN_PK  = #ctacPsnPk#
                AND DCPR.EZCANCELFLAG = '0'
                AND ROWNUM            &lt;= 1
    </statement>
    <!-- 2018/06/08 QC#26123 Add Start -->
    <statement id="getChildMdseList" parameterClass="Map" resultClass="Map">
        SELECT
                  NVL(C.CHILD_MDSE_CD, C.CHILD_ORD_TAKE_MDSE_CD) CHILD_MDSE_CD
                , C.CHILD_MDSE_QTY
            FROM
                CMPSN C
            WHERE
                    C.GLBL_CMPY_CD     = #glblCmpyCd#
                AND C.PRNT_MDSE_CD     = #prntMdseCd#
                AND C.EFF_FROM_DT  &lt;= #slsDt#
                AND (C.EFF_THRU_DT    IS NULL
                 OR  C.EFF_THRU_DT &gt;= #slsDt#)
                AND C.EZCANCELFLAG     = '0'
            ORDER BY
                C.CMPSN_PK
    </statement>
    <!-- 2018/06/08 QC#26123 Add End -->
    
    <!-- 2018/06/27 QC#23726 Add Start -->
    <statement id="getShipToAcctNumByLocNum" parameterClass="Map" resultClass="Map">
            SELECT
                  ST.SELL_TO_CUST_CD
            FROM
                SHIP_TO_CUST ST
            WHERE
                    ST.GLBL_CMPY_CD     = #glblCmpyCd#
                AND ST.LOC_NUM          = #locNum#
                AND ST.RGTN_STS_CD      = #rgtnStsCd#
                AND ST.EFF_FROM_DT  &lt;= #slsDt#
                AND (ST.EFF_THRU_DT    IS NULL
                 OR  ST.EFF_THRU_DT &gt;= #slsDt#)
                AND ST.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getCarrSvcLvlCd" parameterClass="Map" resultClass="String">
            SELECT
                CARR_SVC_LVL_CD
            FROM
                (
                 SELECT 
                     CSL.CARR_SVC_LVL_CD
                 FROM
                     SHPG_SVC_LVL_CARR_RELN SSLCR
                    ,CARR_SVC_LVL           CSL
                 WHERE
                     SSLCR.GLBL_CMPY_CD        = #glblCmpyCd#
                     AND SSLCR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                     AND SSLCR.CARR_CD         = #carrCd#
                     AND SSLCR.EZCANCELFLAG    = '0'

                     AND SSLCR.GLBL_CMPY_CD    = CSL.GLBL_CMPY_CD
                     AND SSLCR.CARR_SVC_LVL_CD = CSL.CARR_SVC_LVL_CD
                     AND CSL.EZCANCELFLAG      = '0'
                 ORDER BY
                     SSLCR.CARR_SVC_LVL_CD DESC
                )
            WHERE
                ROWNUM = 1
    </statement>
    <!-- 2018/06/27 QC#23726 Add End -->
</sqlMap>
