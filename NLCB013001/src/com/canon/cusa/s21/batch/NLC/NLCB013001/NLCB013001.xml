<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NLCB013001">
    <statement id="getWorkData" parameterClass="Map">
    SELECT
            I.INVTY_TRX_PK
            , I.INVTY_TRX_DT
            , I.TRX_CD
            , I.TRX_RSN_CD
            , I.MDSE_CD
            , I.INVTY_LOC_CD
            , I.VND_CD
            , V.COA_AFFL_CD
            , G.GLBL_CMPY_CD        VND_GLBL_CMPY_CD
            , I.INVTY_TRX_QTY
            , I.IMPT_INV_DO_NUM
            , I.IMPT_DO_CLS_CD
            , I.IMPT_INV_NUM
            , I.INVTY_TRX_SLP_NUM
            , I.PO_RCV_NUM
            , I.CPO_ORD_NUM
            , I.INVTY_TRX_REF_NUM
            , I.ROSS_ORD_NUM
<!--            , C.INV_NUM-->
            , I.VND_RTRN_NUM
<!--            , D.DO_NUM-->
<!--            , DG.EXPT_INV_NUM-->
            , I.INVTY_TRX_SLP_NUM
<!--            , IPS.IMPT_CNTNR_NUM-->
    FROM
              INVTY_TRX I
            , STK_IN_RSLT_WRK W
            , VND V
            , GLBL_CMPY G
<!--            , CPO_DTL C-->
<!--            , DO D-->
<!--            , DO_GRP DG-->
<!--            , RWS_DTL RD-->
<!--            , IMPT_PACK_SLP IPS-->
            , MDSE DM
<!-- START 2016/07/01 T.Kikuhara V2.0-->
            , DS_INVTY_LOC_V DI
            , RTL_WH R
            , INVTY_OWNR IO
<!-- END 2016/07/01 T.Kikuhara V2.0-->
    WHERE
           ( I.INVTY_TRX_DT BETWEEN (SELECT
                                         PROC_EXEC_DT
                                     FROM
                                         INTFC_SLS_MTH_MGT
                                     WHERE
                                         GLBL_CMPY_CD = #glblCmpyCd#
                                         AND EZCANCELFLAG = '0') AND #invtyTrxDtTo# ) AND
<!-- START 2014/12/19 T.Kanasaka [CCH-QC200 MOD] -->
<!--           ( ( I.TRX_CD  =  #trxCdPurStkIn#  AND  I.TRX_RSN_CD  =  #trxRsnPurStkIn# -->
<!--				  <isEqual property="techInvIcldFlg" compareValue="N" > -->
<!--				    AND LOC_TP_CD != #locTpCdTechnician# -->
<!--				  </isEqual> -->
<!--              )  OR -->

<!--             ( I.TRX_CD  =  #trxCdPurStkIn#  AND  I.TRX_RSN_CD  =  #trxRsnExpVndRtn# )  OR -->
<!--             ( I.TRX_CD  =  #trxCdPurStkIn#  AND  I.TRX_RSN_CD  =  #trxRsnDomVndRtn# )  OR -->
           ( (
                    I.TRX_CD  =  #trxCdPurStkIn#
                AND I.TRX_RSN_CD IN (#trxRsnPurStkIn#, #trxRsnExpVndRtn#, #trxRsnDomVndRtn#)
              <isEqual property="techInvIcldFlg" compareValue="N" >
                AND I.LOC_TP_CD != #locTpCdTechnician#
              </isEqual>
             ) )
<!-- END 2014/12/19 T.Kanasaka [CCH-QC200 MOD] -->

          AND  I.GLBL_CMPY_CD             =  #glblCmpyCd#
          AND  I.EZCANCELFLAG             =  '0'
          AND  W.INVTY_TRX_PK(+)          =  I.INVTY_TRX_PK
          AND  W.GLBL_CMPY_CD(+)          =  I.GLBL_CMPY_CD
          AND  W.INVTY_TRX_PK       IS NULL
          AND  W.EZCANCELFLAG(+)          =  '0'
          AND  V.VND_CD(+)                =  I.VND_CD
          AND  V.GLBL_CMPY_CD(+)          =  I.GLBL_CMPY_CD
          AND  V.EZCANCELFLAG(+)          =  '0'
          AND  G.COA_AFFL_CD(+)           =  V.COA_AFFL_CD
          AND  G.EZCANCELFLAG(+)          =  '0'
<!--          AND  C.CPO_ORD_NUM(+)           =  I.CPO_ORD_NUM-->
<!--          AND  C.CPO_DTL_LINE_NUM(+)      =  I.CPO_DTL_LINE_NUM-->
<!--          AND  C.CPO_DTL_LINE_SUB_NUM(+)  =  I.CPO_DTL_LINE_SUB_NUM-->
<!--          AND  C.GLBL_CMPY_CD(+)          =  I.GLBL_CMPY_CD-->
<!--          AND  C.EZCANCELFLAG(+)          =  '0'-->
<!--          AND  D.TRX_HDR_NUM(+)           =  I.VND_RTRN_NUM-->
<!--          AND  D.GLBL_CMPY_CD(+)          =  I.GLBL_CMPY_CD-->
<!--          AND  D.EZCANCELFLAG(+)          =  '0'-->
<!--          AND  DG.DO_NUM(+)               =  D.DO_NUM-->
<!--          AND  DG.GLBL_CMPY_CD(+)         =  D.GLBL_CMPY_CD-->
<!--          AND  DG.EZCANCELFLAG(+)         =  '0'-->
<!--          AND  RD.GLBL_CMPY_CD(+)         =  I.GLBL_CMPY_CD-->
<!--          AND  RD.RWS_NUM(+)              =  I.RWS_NUM-->
<!--          AND  RD.RWS_DTL_LINE_NUM(+)     =  I.RWS_DTL_LINE_NUM-->
<!--          AND  RD.EZCANCELFLAG(+)         =  '0'-->
<!--          AND  IPS.GLBL_CMPY_CD(+)        =  RD.GLBL_CMPY_CD-->
<!--          AND  IPS.IMPT_PACK_SLP_PK(+)    =  RD.IMPT_PACK_SLP_PK-->
<!--          AND  IPS.EZCANCELFLAG(+)        =  '0'-->
          AND  I.GLBL_CMPY_CD             =  DM.GLBL_CMPY_CD
          AND  I.MDSE_CD                  =  DM.MDSE_CD
          AND  DM.MDSE_RGTN_TP_CD         =  #mdseRgtnTpCd#
          AND  DM.EZCANCELFLAG            =  '0'
<!-- START 2016/07/01 T.Kikuhara V2.0-->
          AND  I.GLBL_CMPY_CD             =  DI.GLBL_CMPY_CD
          AND  I.INVTY_LOC_CD             =  DI.INVTY_LOC_CD
          AND  DI.GLBL_CMPY_CD            =  R.GLBL_CMPY_CD
          AND  DI.RTL_WH_CD               =  R.RTL_WH_CD
          AND  DI.EZCANCELFLAG            =  '0'
          AND  R.GLBL_CMPY_CD             =  IO.GLBL_CMPY_CD
          AND  R.INVTY_OWNR_CD            =  IO.INVTY_OWNR_CD
          AND  R.EZCANCELFLAG             =  '0'
          AND  IO.CMPY_INVTY_FLG          =  #FLG_Y#
          AND  IO.EZCANCELFLAG            =  '0'
<!-- END 2016/07/01 T.Kikuhara V2.0-->
    </statement>

</sqlMap>
