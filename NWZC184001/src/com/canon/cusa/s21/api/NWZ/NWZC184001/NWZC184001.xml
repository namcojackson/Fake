<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NWZC184001">
   
    <statement id="getDefPrcCatgCd" parameterClass="Map" resultClass="Map">
            SELECT
                  PD.LINE_BIZ_TP_CD
                , PD.DEF_PRC_CATG_CD
            FROM
                DS_ORD_TP_PROC_DFN PD
            WHERE
                    PD.GLBL_CMPY_CD = #glblCmpyCd#
                AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
                AND PD.ACTV_FLG     = 'Y'
                AND PD.EFF_FROM_DT &lt;= #slsDt#
                AND (
                    PD.EFF_THRU_DT &gt;= #slsDt#
                 OR PD.EFF_THRU_DT  IS NULL
                    )
                AND PD.EZCANCELFLAG = '0'
    </statement>
    
    <statement id="getXtrnlIntfcXref" parameterClass="Map" resultClass="Map">
            SELECT
                  X.TRGT_ATTRB_TXT_01
                , X.TRGT_ATTRB_TXT_02
                , X.TRGT_ATTRB_TXT_03
                , X.TRGT_ATTRB_TXT_04
            FROM
                XTRNL_INTFC_XREF X
            WHERE
                    X.GLBL_CMPY_CD           = #glblCmpyCd#
                AND X.CPO_SRC_TP_CD          = #cpoSrcTpCd#
                AND X.INTFC_ID               IS NULL
                AND X.INTFC_XREF_CTX_TP_CD   = #intfcXrefCtxTpCd#
                AND X.SRC_ATTRB_TXT_01       IS NULL
                AND X.SRC_ATTRB_TXT_02       = #srcAttrbTxt02#
                AND X.SRC_ATTRB_TXT_03       = #srcAttrbTxt03#
                AND X.EZCANCELFLAG = '0'
    </statement>
    
    <statement id="getBillToCustByLocNum" parameterClass="Map" resultClass="Map">
            SELECT
                  B.SELL_TO_CUST_CD
                , B.BILL_TO_CUST_CD
            FROM
                BILL_TO_CUST B
            WHERE
                    B.GLBL_CMPY_CD     = #glblCmpyCd#
                AND B.LOC_NUM          = #locNum#
                AND B.RGTN_STS_CD      = #rgtnStsCd#
                AND B.EZCANCELFLAG     = '0'
    </statement>
    
    <statement id="getShipToCustByLocNum" parameterClass="Map" resultClass="Map">
            SELECT
                  S.SELL_TO_CUST_CD
                , S.SHIP_TO_CUST_CD
                , S.ADDL_LOC_NM
                , S.LOC_NM
                , S.FIRST_LINE_ADDR
                , S.SCD_LINE_ADDR
                , S.THIRD_LINE_ADDR
                , S.FRTH_LINE_ADDR
                , S.POST_CD
                , S.CTY_ADDR
                , S.ST_CD
                , S.PROV_NM
                , S.CTRY_CD
                , S.CNTY_PK
                , S.FIRST_REF_CMNT_TXT
                , S.SCD_REF_CMNT_TXT
                , C.CNTY_NM
            FROM
                SHIP_TO_CUST S
              , CNTY C
            WHERE
                    S.GLBL_CMPY_CD     = #glblCmpyCd#
                AND S.LOC_NUM          = #locNum#
                AND S.RGTN_STS_CD      = #rgtnStsCd#
<!-- 2018/11/22 QC#29220 Mod Start -->
<!--            AND S.GLBL_CMPY_CD     = C.GLBL_CMPY_CD -->
<!--            AND S.CNTY_PK          = C.CNTY_PK -->
                AND S.GLBL_CMPY_CD     = C.GLBL_CMPY_CD (+)
                AND S.CNTY_PK          = C.CNTY_PK (+)
                AND S.EZCANCELFLAG     = '0'
<!--            AND C.EZCANCELFLAG     = '0' -->
                AND C.EZCANCELFLAG (+) = '0'
<!-- 2018/11/22 QC#29220 Mod End -->
    </statement>
    
    <statement id="getMdseInfo" parameterClass="Map" resultClass="Map">
    WITH MDSE_V AS (
            SELECT
                  A.GLBL_CMPY_CD
                , A.MDSE_CD
                , A.PKG_UOM_CLS_CD
            FROM
                MDSE A
            WHERE
                    A.GLBL_CMPY_CD     = #glblCmpyCd#
                AND A.MDSE_CD          = #mdseCd#
                AND A.RGTN_STS_CD      = #rgtnStsCd#
                AND A.EZCANCELFLAG     = '0'
            UNION
            SELECT
                  A.GLBL_CMPY_CD
                , A.MDSE_CD
                , A.PKG_UOM_CLS_CD
            FROM
                ORD_TAKE_MDSE O
              , MDSE A
            WHERE
                    O.GLBL_CMPY_CD     = #glblCmpyCd#
                AND O.ORD_TAKE_MDSE_CD = #mdseCd#
                AND A .RGTN_STS_CD     = #rgtnStsCd#
                AND O.GLBL_CMPY_CD     = A.GLBL_CMPY_CD
                AND O.MDSE_CD          = A.MDSE_CD
                AND O.EZCANCELFLAG     = '0'
                AND A.EZCANCELFLAG     = '0'
            UNION
            SELECT
                  A.GLBL_CMPY_CD
                , A.MDSE_CD
                , A.PKG_UOM_CLS_CD
            FROM
                MDSE M
              , ALL_MDSE_V A
            WHERE
                    M.GLBL_CMPY_CD     = #glblCmpyCd#
                AND M.MNF_ITEM_CD      = #mdseCd#
                AND M.GLBL_CMPY_CD     = A.GLBL_CMPY_CD
                AND M.MDSE_CD          = A.MDSE_CD
                AND A.RGTN_STS_CD      = #rgtnStsCd#
                AND M.EZCANCELFLAG     = '0'
                AND A.EZCANCELFLAG     = '0'
            UNION
            SELECT
                  A.GLBL_CMPY_CD
                , A.MDSE_CD
                , A.PKG_UOM_CLS_CD
            FROM
                CUST_MDSE_XREF X
              , ALL_MDSE_V A
            WHERE
                    X.GLBL_CMPY_CD            = #glblCmpyCd#
                AND X.CUST_MDSE_CD            = #mdseCd#
                AND X.DS_ACCT_NUM             = #dsAcctNum#
                AND X.CUST_MDSE_XREF_ENBL_FLG = #flagY#
                AND X.GLBL_CMPY_CD            = A.GLBL_CMPY_CD
                AND X.MDSE_CD                 = A.MDSE_CD
                AND A.RGTN_STS_CD             = #rgtnStsCd#
                AND X.EZCANCELFLAG            = '0'
                AND A.EZCANCELFLAG            = '0'
    )
            SELECT
                  A.MDSE_CD
                , MSP.PKG_UOM_CD BASE_PKG_UOM_CD
                , MSP.IN_EACH_QTY
            FROM
                MDSE_V A
              , MDSE_STORE_PKG MSP
            WHERE
                    A.GLBL_CMPY_CD     = MSP.GLBL_CMPY_CD
                AND A.MDSE_CD          = MSP.MDSE_CD
                AND MSP.PRIM_PKG_UOM_FLG = 'Y'
                AND MSP.EZCANCELFLAG   = '0'
    </statement>
    
    <statement id="getDsOrdLineProcDfn" parameterClass="Map" resultClass="Map">
            SELECT
                  D.DS_ORD_LINE_CATG_CD
            FROM
                DS_ORD_LINE_PROC_DFN D
              , DS_ORD_LINE_CATG C
            WHERE
                    D.GLBL_CMPY_CD         = #glblCmpyCd#
                AND D.DS_ORD_TP_CD         = #dsOrdTpCd#
                AND D.PRIM_LINE_CATG_FLG   = #flagY#
                AND D.GLBL_CMPY_CD         = C.GLBL_CMPY_CD
                AND D.DS_ORD_LINE_CATG_CD  = C.DS_ORD_LINE_CATG_CD
                AND C.DS_ORD_LINE_DRCTN_CD = #dsOrdLineDrctnCd#
                AND D.EZCANCELFLAG         = '0'
                AND C.EZCANCELFLAG         = '0'
    </statement>
    
    <statement id="getWriterLineBizRoleTp" parameterClass="Map" resultClass="String">
            SELECT
                  D.LINE_BIZ_ROLE_TP_CD
            FROM
                LINE_BIZ_ROLE_TP D
            WHERE
                    D.GLBL_CMPY_CD         = #glblCmpyCd#
                AND D.PRIM_REP_ROLE_FLG    = #primRepRoleFlg#
                AND D.EZCANCELFLAG         = '0'
    </statement>
    
    <statement id="getCarrCdAndShpgSvcLvlRelationCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(CR.GLBL_CMPY_CD)
            FROM
                SHPG_SVC_LVL_CARR_RELN CR 
            WHERE
                CR.GLBL_CMPY_CD        = #glblCmpyCd#
                AND CR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                AND CR.CARR_CD         = #carrCd#
                AND CR.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getFrtCondSvcLvlRelationCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(FR.GLBL_CMPY_CD)
            FROM
                FRT_COND_SVC_LVL_RELN FR
            WHERE
                FR.GLBL_CMPY_CD        = #glblCmpyCd#
                AND FR.LINE_BIZ_TP_CD  = #lineBizTpCd#
                AND FR.FRT_COND_CD     = #frtCondCd#
                AND FR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                AND FR.EZCANCELFLAG    = '0'
    </statement>
</sqlMap>
