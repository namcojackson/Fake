<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAB247001">

    <statement id="findReportRequestHeader" parameterClass="Map" resultClass="Map">
        SELECT
             RRH.RPT_RQST_HDR_PK
             ,RRH.RPT_ID
        FROM
            RPT_RQST_HDR RRH
        WHERE
            1 = 1
        AND RRH.GLBL_CMPY_CD         = #glblCmpyCd#
        AND RRH.RPT_RQST_PROC_STS_CD = #rptRqstProcStsCd#
        AND RRH.EZCANCELFLAG         = '0'
        ORDER BY
            RPT_RQST_HDR_PK ASC
    </statement>

    <statement id="findReportRequestCondition" parameterClass="Map" resultClass="Map">
        SELECT
             RRC.RPT_RQST_COND_PK
             ,RRC.RPT_RQST_COL_TP_CD
             ,RRC.RPT_RQST_OP_TP_CD
             ,RRC.RPT_RQST_COL_VAL_TXT
             ,RRCT.RPT_RQST_PHYS_NM
             ,RROT.RPT_RQST_OP_TP_NM
        FROM
            RPT_RQST_COND RRC
            ,RPT_RQST_COL_TP RRCT
            ,RPT_RQST_OP_TP RROT
        WHERE
            1 = 1
        AND RRC.GLBL_CMPY_CD         = #glblCmpyCd#
        AND RRC.RPT_RQST_HDR_PK      = #rptRqstHdrPk#
        AND RRC.GLBL_CMPY_CD         = RRCT.GLBL_CMPY_CD
        AND RRC.RPT_RQST_COL_TP_CD   = RRCT.RPT_RQST_COL_TP_CD
        AND RRCT.RPT_ID              = #rptId#
        AND RRC.GLBL_CMPY_CD         = RROT.GLBL_CMPY_CD
        AND RRC.RPT_RQST_OP_TP_CD    = RROT.RPT_RQST_OP_TP_CD
        AND RRC.EZCANCELFLAG         = '0'
        AND RRCT.EZCANCELFLAG        = '0'
        AND RROT.EZCANCELFLAG        = '0'
    </statement>

    <statement id="findDSImportOrder" parameterClass="Map" resultClass="Map">
        SELECT * FROM (
        SELECT
            DIO.DS_IMPT_ORD_PK
            ,DIO.ORD_SRC_REF_NUM
            ,DIO.IMPT_STS_CD
            ,T.TOC_CD
            ,T.TOC_NM
            <!-- QC#10922 ,DIO.ORIG_ORD_NUM AS CPO_ORD_NUM -->
            ,C.CPO_ORD_NUM
            ,C.CPO_ORD_TS
            ,T.COA_EXTN_CD
            ,CE.COA_EXTN_DESC_TXT
            ,DIO.SOLD_TO_CUST_LOC_CD
            ,STC_SELL.DS_ACCT_NM AS DS_ACCT_NM_SELL
            ,DIO.SELL_TO_CUST_CD
            ,DIO.BILL_TO_CUST_ACCT_CD
            ,STC_BILL.DS_ACCT_NM AS DS_ACCT_NM_BILL
            ,DIO.BILL_TO_CUST_CD
            ,DIO.SHIP_TO_CUST_ACCT_CD
            ,DIO.SHIP_TO_LOC_NM AS DS_ACCT_NM_SHIP
            ,DIO.SHIP_TO_CUST_CD
            ,DIO.ORD_SRC_IMPT_TS
            ,T.COA_BR_CD
            ,CB.COA_BR_DESC_TXT
        FROM
            DS_IMPT_ORD DIO
            ,CPO C
            ,TOC T
            ,SELL_TO_CUST STC_SELL
            ,SELL_TO_CUST STC_BILL
            ,COA_BR CB
            ,COA_EXTN CE
        WHERE
            1 = 1
        AND DIO.GLBL_CMPY_CD          = #glblCmpyCd#
        AND DIO.CPO_SRC_TP_CD         = #cpoSrcTpCd#
        AND DIO.GLBL_CMPY_CD          = C.GLBL_CMPY_CD(+)
        AND DIO.ORD_SRC_REF_NUM       = C.ORD_SRC_REF_NUM(+)
        AND DIO.GLBL_CMPY_CD          = T.GLBL_CMPY_CD(+)
        AND DIO.SLS_REP_TOC_CD        = T.TOC_CD(+)
        AND DIO.GLBL_CMPY_CD          = STC_SELL.GLBL_CMPY_CD(+)
        AND DIO.SELL_TO_CUST_CD       = STC_SELL.SELL_TO_CUST_CD(+)
        AND DIO.GLBL_CMPY_CD          = STC_BILL.GLBL_CMPY_CD(+)
        AND DIO.BILL_TO_CUST_ACCT_CD  = STC_BILL.SELL_TO_CUST_CD(+)
        AND T.GLBL_CMPY_CD            = CB.GLBL_CMPY_CD(+)
        AND T.COA_BR_CD               = CB.COA_BR_CD(+)
        AND T.GLBL_CMPY_CD            = CE.GLBL_CMPY_CD(+)
        AND T.COA_EXTN_CD             = CE.COA_EXTN_CD(+)
        AND DIO.EZCANCELFLAG          = '0'
        AND C.EZCANCELFLAG(+)         = '0'
        AND T.EZCANCELFLAG(+)         = '0'
        AND STC_SELL.EZCANCELFLAG(+)  = '0'
        AND STC_BILL.EZCANCELFLAG(+)  = '0'
        AND CB.EZCANCELFLAG(+)        = '0'
        AND CE.EZCANCELFLAG(+)        = '0'
        ORDER BY
            ORD_SRC_IMPT_DT ASC
            ,ORD_SRC_REF_NUM ASC
        ) DIO
        WHERE
            1 = 1
        <iterate property="condValList" var="elem[]" conjunction="">
            $elem[]$
        </iterate>
    </statement>

    <statement id="findCsaOrdHeader" parameterClass="Map" resultClass="Map">
        SELECT
            MAIN.RTL_DIV_CD
            ,MAIN.CUST_ISS_PO_NUM
            ,MAIN.INSTL_SELL_TO_CUST_CD
            ,MAIN.ROSS_ORD_TP_MSG_TXT
            ,MAIN.ORD_COORD_NM
            ,MAIN.RTL_CUST_PO_DT
            ,MAIN.ISTL_LOC_FIRST_CUST_NM
            ,MAIN.ISTL_LOC_SCD_CUST_NM
            ,MAIN.ISTL_LOC_FIRST_LINE_ADDR
            ,MAIN.ISTL_LOC_CTY_ADDR
            ,MAIN.ISTL_LOC_ST_CD
            ,MAIN.ISTL_LOC_POST_CD
            ,MAIN.ISTL_LOC_TEL_NUM
            ,MAIN.ISTL_LOC_FAX_NUM
            ,MAIN.ISTL_LOC_ATTN_TO_NM
            ,MAIN.INSTL_CD
            ,MAIN.ISTL_SUB_LOC_CD
            ,MAIN.SVC_DLR_CD
            ,MAIN.SVC_DLR_FIRST_CUST_NM
            ,MAIN.SVC_DLR_SCD_CUST_NM
            ,MAIN.SVC_DLR_FIRST_LINE_ADDR
            ,MAIN.SVC_DLR_CTY_ADDR
            ,MAIN.SVC_DLR_ST_CD
            ,MAIN.SVC_DLR_POST_CD
            ,MAIN.SVC_DLR_TEL_NUM
            ,MAIN.SVC_DLR_FAX_NUM
            ,MAIN.DLR_APP_FLG
            ,MAIN.SPLY_INCL_FLG
            ,MAIN.WTY_MTH
            ,MAIN.WH_FIRST_CUST_NM
        FROM(
            SELECT
                COHVS.RTL_DIV_CD
                ,COHVS.CUST_ISS_PO_NUM
                ,COHVS.INSTL_SELL_TO_CUST_CD
                ,COIVS.ROSS_ORD_TP_MSG_TXT
                ,COHVS.ORD_COORD_NM
                ,COHVS.RTL_CUST_PO_DT
                ,COIVS.ISTL_LOC_FIRST_CUST_NM
                ,COIVS.ISTL_LOC_SCD_CUST_NM
                ,COIVS.ISTL_LOC_FIRST_LINE_ADDR
                ,COIVS.ISTL_LOC_CTY_ADDR
                ,COIVS.ISTL_LOC_ST_CD
                ,COIVS.ISTL_LOC_POST_CD
                ,COIVS.ISTL_LOC_TEL_NUM
                ,COIVS.ISTL_LOC_FAX_NUM
                ,COIVS.ISTL_LOC_ATTN_TO_NM
                ,COIVS.INSTL_CD
                ,COIVS.ISTL_SUB_LOC_CD
                ,COIVS.SVC_DLR_CD
                ,COIVS.SVC_DLR_FIRST_CUST_NM
                ,COIVS.SVC_DLR_SCD_CUST_NM
                ,COIVS.SVC_DLR_FIRST_LINE_ADDR
                ,COIVS.SVC_DLR_CTY_ADDR
                ,COIVS.SVC_DLR_ST_CD
                ,COIVS.SVC_DLR_POST_CD
                ,COIVS.SVC_DLR_TEL_NUM
                ,COIVS.SVC_DLR_FAX_NUM
                ,COIVS.DLR_APP_FLG
                ,COIVS.SPLY_INCL_FLG
                ,COIVS.WTY_MTH
                ,COIVS.WH_FIRST_CUST_NM
            FROM
                CSA_ORD_HDR_VIEW_SNAP COHVS
                ,CSA_ORD_ITEM_VIEW_SNAP COIVS
            WHERE
                1 = 1
            AND COHVS.GLBL_CMPY_CD    = #glblCmpyCd#
            AND COHVS.CPO_ORD_NUM     = #cpoOrdNum#
            AND COHVS.GLBL_CMPY_CD    = COIVS.GLBL_CMPY_CD
            AND COHVS.CPO_ORD_NUM     = COIVS.CPO_ORD_NUM
            AND COIVS.INSTL_CD        = #instlCd#
            AND COIVS.ISTL_SUB_LOC_CD = #istlSubLocCd#
            <iterate property="contrBizTpCdList" var="contrBizTpCd[]" open="AND COIVS.CONTR_BIZ_TP_CD IN (" conjunction= ", " close=")">
                #contrBizTpCd[]#
            </iterate>
            AND COHVS.EZCANCELFLAG    = '0'
            AND COIVS.EZCANCELFLAG    = '0'
            ORDER BY
                COIVS.RCPO_DTL_SQ ASC
        ) MAIN
        WHERE ROWNUM                = #rowNum#
    </statement>

    <statement id="findCsaOrdLineOneArea" parameterClass="Map" resultClass="Map">
        SELECT
            MAIN.FNDG_DLR_CD
            ,MAIN.FNDG_DLR_FIRST_CUST_NM
            ,MAIN.FNDG_DLR_SCD_CUST_NM
            ,MAIN.FNDG_DLR_FIRST_LINE_ADDR
            ,MAIN.FNDG_DLR_CTY_ADDR
            ,MAIN.FNDG_DLR_ST_CD
            ,MAIN.FNDG_DLR_POST_CD
            ,MAIN.FNDG_DLR_TEL_NUM
            ,MAIN.FNDG_DLR_FAX_NUM
            ,MAIN.ORIG_DLR_CD
            ,MAIN.ORIG_DLR_FIRST_CUST_NM
            ,MAIN.ORIG_DLR_SCD_CUST_NM
            ,MAIN.ORIG_DLR_FIRST_LINE_ADDR
            ,MAIN.ORIG_DLR_CTY_ADDR
            ,MAIN.ORIG_DLR_ST_CD
            ,MAIN.ORIG_DLR_POST_CD
            ,MAIN.ORIG_DLR_TEL_NUM
            ,MAIN.ORIG_DLR_FAX_NUM
            ,MAIN.SHIP_TO_LOC_FIRST_CUST_NM
            ,MAIN.SHIP_TO_LOC_SCD_CUST_NM
            ,MAIN.SHIP_TO_LOC_FIRST_LINE_ADDR
            ,MAIN.SHIP_TO_LOC_CTY_ADDR
            ,MAIN.SHIP_TO_LOC_ST_CD
            ,MAIN.SHIP_TO_LOC_POST_CD
            ,MAIN.SHIP_TO_LOC_TEL_NUM
            ,MAIN.SHIP_TO_LOC_FAX_NUM
            ,MAIN.SHIP_TO_LOC_ATTN_TO_NM
            ,MAIN.LOC_NUM
        FROM(
            SELECT
                COIVS.FNDG_DLR_CD
                ,COIVS.FNDG_DLR_FIRST_CUST_NM
                ,COIVS.FNDG_DLR_SCD_CUST_NM
                ,COIVS.FNDG_DLR_FIRST_LINE_ADDR
                ,COIVS.FNDG_DLR_CTY_ADDR
                ,COIVS.FNDG_DLR_ST_CD
                ,COIVS.FNDG_DLR_POST_CD
                ,COIVS.FNDG_DLR_TEL_NUM
                ,COIVS.FNDG_DLR_FAX_NUM
                ,COIVS.ORIG_DLR_CD
                ,COIVS.ORIG_DLR_FIRST_CUST_NM
                ,COIVS.ORIG_DLR_SCD_CUST_NM
                ,COIVS.ORIG_DLR_FIRST_LINE_ADDR
                ,COIVS.ORIG_DLR_CTY_ADDR
                ,COIVS.ORIG_DLR_ST_CD
                ,COIVS.ORIG_DLR_POST_CD
                ,COIVS.ORIG_DLR_TEL_NUM
                ,COIVS.ORIG_DLR_FAX_NUM
                ,COIVS.SHIP_TO_LOC_FIRST_CUST_NM
                ,COIVS.SHIP_TO_LOC_SCD_CUST_NM
                ,COIVS.SHIP_TO_LOC_FIRST_LINE_ADDR
                ,COIVS.SHIP_TO_LOC_CTY_ADDR
                ,COIVS.SHIP_TO_LOC_ST_CD
                ,COIVS.SHIP_TO_LOC_POST_CD
                ,COIVS.SHIP_TO_LOC_TEL_NUM
                ,COIVS.SHIP_TO_LOC_FAX_NUM
                ,COIVS.SHIP_TO_LOC_ATTN_TO_NM
                ,COIVS.CPO_ORD_NUM || COIVS.RCPO_POSN_NUM AS LOC_NUM
            FROM
                CSA_ORD_ITEM_VIEW_SNAP COIVS
            WHERE
                1 = 1
            AND COIVS.GLBL_CMPY_CD    = #glblCmpyCd#
            AND COIVS.CPO_ORD_NUM     = #cpoOrdNum#
            AND COIVS.INSTL_CD        = #instlCd#
            AND COIVS.ISTL_SUB_LOC_CD = #istlSubLocCd#
            <iterate property="contrBizTpCdList" var="contrBizTpCd[]" open="AND COIVS.CONTR_BIZ_TP_CD IN (" conjunction= ", " close=")">
                #contrBizTpCd[]#
            </iterate>
            AND COIVS.EZCANCELFLAG    = '0'
            ORDER BY 
                COIVS.RCPO_DTL_SQ ASC
        ) MAIN
        WHERE ROWNUM                = #rowNum#
    </statement>

    <statement id="findCsaOrdLineTwoArea" parameterClass="Map" resultClass="Map">
        SELECT
            COIVS.MDSE_CD
            ,COIVS.MDL_NM
            ,COIVS.ORD_QTY
            ,COIVS.SHIP_QTY
            ,COIVS.BO_QTY
            ,COSVS.SER_NUM
            ,COSVS.PRNT_SER_NUM
            ,COIVS.SO_NUM
            ,COIVS.LOC_NM
            ,COIVS.ACTL_SHIP_DT
        FROM
            CSA_ORD_ITEM_VIEW_SNAP COIVS
            ,CSA_ORD_SER_VIEW_SNAP COSVS
        WHERE
            1 = 1
        AND COIVS.GLBL_CMPY_CD    = #glblCmpyCd#
        AND COIVS.CPO_ORD_NUM     = #cpoOrdNum#
        AND COIVS.INSTL_CD        = #instlCd#
        AND COIVS.ISTL_SUB_LOC_CD = #istlSubLocCd#
        <iterate property="contrBizTpCdList" var="contrBizTpCd[]" open="AND COIVS.CONTR_BIZ_TP_CD IN (" conjunction= ", " close=")">
            #contrBizTpCd[]#
        </iterate>
        AND COIVS.GLBL_CMPY_CD    = COSVS.GLBL_CMPY_CD(+)
        AND COIVS.RCPO_DTL_SQ     = COSVS.RCPO_DTL_SQ(+)
        AND COIVS.MDL_NM          = COSVS.MDL_NM(+)
        AND COIVS.SO_NUM          = COSVS.SO_NUM(+)
        AND COIVS.EZCANCELFLAG    = '0'
        AND COSVS.EZCANCELFLAG(+) = '0'
        ORDER BY
            COIVS.RCPO_DTL_SQ ASC
    </statement>

    <statement id="findCsaOrdLineThreeArea" parameterClass="Map" resultClass="Map">
        SELECT
            COIVS.MDSE_CD
            ,COIVS.MDL_NM
            ,DECODE(COIVS.ISTL_COMP_AMT, 0, NULL, TO_CHAR(COIVS.ISTL_COMP_AMT, 'FM9G999G999G999G999G990D00')) ISTL_COMP_AMT
            ,DECODE(COIVS.SVC_DLR_COMP_AMT, 0, NULL, TO_CHAR(COIVS.SVC_DLR_COMP_AMT, 'FM9G999G999G999G999G990D00')) SVC_DLR_COMP_AMT
            ,DECODE(COIVS.EXT_WTY_COMP_AMT, 0, NULL, TO_CHAR(COIVS.EXT_WTY_COMP_AMT, 'FM9G999G999G999G999G990D00')) EXT_WTY_COMP_AMT
            ,DECODE(COIVS.FNDG_DLR_COMP_AMT, 0, NULL, TO_CHAR(COIVS.FNDG_DLR_COMP_AMT, 'FM9G999G999G999G999G990D00')) FNDG_DLR_COMP_AMT
            ,DECODE(COIVS.ORIG_DLR_COMP_AMT, 0, NULL, TO_CHAR(COIVS.ORIG_DLR_COMP_AMT, 'FM9G999G999G999G999G990D00')) ORIG_DLR_COMP_AMT
            ,DECODE(COIVS.ORD_TAKE_DLR_COMP_AMT, 0, NULL, TO_CHAR(COIVS.ORD_TAKE_DLR_COMP_AMT, 'FM9G999G999G999G999G990D00')) ORD_TAKE_DLR_COMP_AMT
            ,DECODE(COIVS.RMV_COMP_AMT, 0, NULL, TO_CHAR(COIVS.RMV_COMP_AMT, 'FM9G999G999G999G999G990D00')) RMV_COMP_AMT
            ,DECODE(COIVS.MLY_BASE_COMP_AMT, 0, NULL, TO_CHAR(COIVS.MLY_BASE_COMP_AMT, 'FM9G999G999G999G999G990D00')) MLY_BASE_COMP_AMT
            ,DECODE(COIVS.MLY_ADMIN_COMP_AMT, 0, NULL, TO_CHAR(COIVS.MLY_ADMIN_COMP_AMT, 'FM9G999G999G999G999G990D00')) MLY_ADMIN_COMP_AMT
            ,NULL XS_MTR_COPY_QTY
            ,NULL XS_MTR_COMP_COPY_QTY
            ,NULL XS_MTR_COMP_AMT_RATE
            ,COIVS.RCPO_DTL_SQ
            ,COIVS.SO_NUM
        FROM
            CSA_ORD_ITEM_VIEW_SNAP COIVS
        WHERE
            1 = 1
        AND COIVS.GLBL_CMPY_CD    = #glblCmpyCd#
        AND COIVS.CPO_ORD_NUM     = #cpoOrdNum#
        AND COIVS.INSTL_CD        = #instlCd#
        AND COIVS.ISTL_SUB_LOC_CD = #istlSubLocCd#
        <iterate property="contrBizTpCdList" var="contrBizTpCd[]" open="AND COIVS.CONTR_BIZ_TP_CD IN (" conjunction= ", " close=")">
            #contrBizTpCd[]#
        </iterate>
        AND COIVS.EZCANCELFLAG    = '0'
        AND (COIVS.ISTL_COMP_AMT != 0 
        OR  COIVS.SVC_DLR_COMP_AMT != 0
        OR  COIVS.EXT_WTY_COMP_AMT != 0
        OR  COIVS.FNDG_DLR_COMP_AMT != 0
        OR  COIVS.ORIG_DLR_COMP_AMT != 0
        OR  COIVS.ORD_TAKE_DLR_COMP_AMT != 0
        OR  COIVS.RMV_COMP_AMT != 0
        OR  COIVS.MLY_BASE_COMP_AMT != 0
        OR  COIVS.MLY_ADMIN_COMP_AMT != 0)
        ORDER BY
            COIVS.RCPO_DTL_SQ ASC
    </statement>

    <statement id="findCsaOrdLineThreeArea2" parameterClass="Map" resultClass="Map">
        SELECT
            COUVS.MDSE_CD
            ,COUVS.MDL_NM
            ,NULL ISTL_COMP_AMT
            ,NULL SVC_DLR_COMP_AMT
            ,NULL EXT_WTY_COMP_AMT
            ,NULL FNDG_DLR_COMP_AMT
            ,NULL ORIG_DLR_COMP_AMT
            ,NULL ORD_TAKE_DLR_COMP_AMT
            ,NULL RMV_COMP_AMT
            ,NULL MLY_BASE_COMP_AMT
            ,NULL MLY_ADMIN_COMP_AMT
            ,DECODE(COUVS.XS_MTR_COPY_QTY, 0, NULL, TO_CHAR(COUVS.XS_MTR_COPY_QTY, 'FM9999999999999990')) XS_MTR_COPY_QTY
            ,DECODE(COUVS.XS_MTR_COMP_COPY_QTY, 0, NULL, TO_CHAR(COUVS.XS_MTR_COMP_COPY_QTY, 'FM9999G999999999990')) XS_MTR_COMP_COPY_QTY
            ,TO_CHAR(COUVS.XS_MTR_COMP_AMT_RATE, 'FM999G999G999G999G990D0000') XS_MTR_COMP_AMT_RATE
        FROM
            CSA_ORD_USG_VIEW_SNAP COUVS
        WHERE
            1 = 1
        AND COUVS.GLBL_CMPY_CD    = #glblCmpyCd#
        AND COUVS.RCPO_DTL_SQ     = #rcpoDtlSq#
        AND COUVS.MDL_NM          = #mdlNm#
        <isNotNull property="soNum">
        AND COUVS.SO_NUM          = #soNum#
        </isNotNull>
        <isNull property="soNum">
        AND COUVS.SO_NUM          IS NULL
        </isNull>
        AND COUVS.EZCANCELFLAG    = '0'
        ORDER BY
            COUVS.BLLG_MTR_NUM ASC
    </statement>
    
    <statement id="findCsaOrdMsgArea" parameterClass="Map" resultClass="Map">
        SELECT
            COMVS.RTL_MSG_TXT
        FROM
            CSA_ORD_MSG_VIEW_SNAP COMVS
        WHERE
            1 = 1
        AND COMVS.GLBL_CMPY_CD    = #glblCmpyCd#
        AND COMVS.TRX_HDR_NUM     = #trxHdrNum#
        AND COMVS.EZCANCELFLAG    = '0'
        ORDER BY
            COMVS.RTL_MSG_PK ASC
    </statement>

</sqlMap>
