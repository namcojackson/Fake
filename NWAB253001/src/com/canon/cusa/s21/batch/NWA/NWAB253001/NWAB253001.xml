<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAB253001">
    <statement id="getCountWrkData" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*) AS WRK_COUNT
        FROM
            ORD_RMA_DEF_WH_UPLD_WRK ODW
        WHERE
                ODW.GLBL_CMPY_CD     = #glblCmpyCd#
            AND ODW.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
            AND ODW.EZCANCELFLAG     = '0'
        ORDER BY
            ODW.UPLD_CSV_RQST_ROW_NUM
    </statement>
    <statement id="getWrkData" parameterClass="Map" resultClass="Map">
        SELECT
             ODW.UPLD_CSV_RQST_ROW_NUM
            ,ODW.DEF_WH_MAP_TMPL_CD
            ,ODW.MDSE_ITEM_CLS_TP_DESC_TXT
            ,ODW.THIRD_PTY_ITEM_FLG
            ,ODW.FROM_POST_CD
            ,ODW.TO_POST_CD
            ,ODW.ON_HND_CHK_FLG
            ,ODW.THIRD_PTY_DSP_TP_NM
            ,ODW.DROP_RTRN_VND_NM
            ,ODW.RMA_DEF_WH_CD
        FROM
            ORD_RMA_DEF_WH_UPLD_WRK ODW
        WHERE
                ODW.GLBL_CMPY_CD     = #glblCmpyCd#
            AND ODW.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
            AND ODW.EZCANCELFLAG     = '0'
        ORDER BY
            ODW.UPLD_CSV_RQST_ROW_NUM
    </statement>
    <statement id="getMdseItemClsTpInfo" parameterClass="Map" resultClass="Map">
        SELECT
            MICT.MDSE_ITEM_CLS_TP_CD
        FROM
            MDSE_ITEM_CLS_TP MICT
        WHERE
                MICT.GLBL_CMPY_CD              = #glblCmpyCd#
            AND MICT.MDSE_ITEM_CLS_TP_DESC_TXT = #mdseItemClsTpDescTxt#
            AND MICT.EZCANCELFLAG              = '0'
        ORDER BY
            MICT.MDSE_ITEM_CLS_TP_CD
    </statement>
    <statement id="getRtlWhInfo" parameterClass="Map" resultClass="Map">
        SELECT
            '1'
        FROM
            RTL_WH RW
        WHERE
                RW.GLBL_CMPY_CD = #glblCmpyCd#
            AND RW.PHYS_WH_CD   = #physWhCd#
            AND RW.EZCANCELFLAG = '0'
            AND ROWNUM = 1
    </statement>
    <statement id="getThirdPtyDspTpInfo" parameterClass="Map" resultClass="Map">
        SELECT
            TPD.THIRD_PTY_DSP_TP_CD
        FROM
            THIRD_PTY_DSP_TP TPD
        WHERE
                TPD.GLBL_CMPY_CD        = #glblCmpyCd#
            AND TPD.THIRD_PTY_DSP_TP_NM = #thirdPtyDspTpNm#
            AND TPD.EZCANCELFLAG        = '0'
        ORDER BY
            TPD.THIRD_PTY_DSP_TP_CD
    </statement>
    <statement id="getDropRtrnVndInfo" parameterClass="Map" resultClass="Map">
        SELECT
            DRV.DROP_RTRN_VND_CD
        FROM
            DROP_RTRN_VND DRV
        WHERE
                DRV.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DRV.DROP_RTRN_VND_NM = #dropRtrnVndNm#
            AND DRV.EZCANCELFLAG     = '0'
        ORDER BY
            DRV.DROP_RTRN_VND_CD
    </statement>
    <statement id="getDuplicatedFile" parameterClass="Map" resultClass="Map">
        SELECT
             WRK.UPLD_CSV_RQST_ROW_NUM
            ,WRK.FROM_POST_CD
            ,WRK.TO_POST_CD
        FROM
            ORD_RMA_DEF_WH_UPLD_WRK WRK
        WHERE
                WRK.GLBL_CMPY_CD              = #glblCmpyCd#
            AND WRK.UPLD_CSV_RQST_PK          = #upldCsvRqstPk#
            AND WRK.DEF_WH_MAP_TMPL_CD        = #defWhMapTmplCd#
            AND WRK.MDSE_ITEM_CLS_TP_DESC_TXT = #mdseItemClsTpDescTxt#
            AND WRK.THIRD_PTY_ITEM_FLG        = #thirdPtyItemFlg#
            <isNotNull property="thirdPtyDspTpNm">
                AND WRK.THIRD_PTY_DSP_TP_NM   = #thirdPtyDspTpNm#
            </isNotNull>
            <isNull property="thirdPtyDspTpNm">
                AND WRK.THIRD_PTY_DSP_TP_NM   IS NULL
            </isNull>
            <isNotNull property="dropRtrnVndNm">
                AND WRK.DROP_RTRN_VND_NM      = #dropRtrnVndNm#
            </isNotNull>
            <isNull property="dropRtrnVndNm">
                AND WRK.DROP_RTRN_VND_NM      IS NULL
            </isNull>
            AND WRK.EZCANCELFLAG              = '0'
        ORDER BY
            WRK.UPLD_CSV_RQST_ROW_NUM
    </statement>
    <statement id="getDuplicatedRecord" parameterClass="Map" resultClass="Map">
        SELECT
             ODW.FROM_POST_CD
            ,ODW.TO_POST_CD
        FROM
            ORD_RMA_DEF_WH ODW
        WHERE
                ODW.GLBL_CMPY_CD            = #glblCmpyCd#
            AND ODW.DEF_WH_MAP_TMPL_CD      = #defWhMapTmplCd#
            AND ODW.MDSE_ITEM_CLS_TP_CD     = #mdseItemClsTpCd#
            AND ODW.THIRD_PTY_ITEM_FLG      = #thirdPtyItemFlg#
            <isNotNull property="thirdPtyDspTpCd">
                AND ODW.THIRD_PTY_DSP_TP_CD = #thirdPtyDspTpCd#
            </isNotNull>
            <isNotNull property="dropRtrnVndCd">
                AND ODW.DROP_RTRN_VND_CD    = #dropRtrnVndCd#
            </isNotNull>
            AND ODW.EZCANCELFLAG        = '0'
        ORDER BY
             ODW.FROM_POST_CD
            ,ODW.TO_POST_CD
    </statement>
</sqlMap>
