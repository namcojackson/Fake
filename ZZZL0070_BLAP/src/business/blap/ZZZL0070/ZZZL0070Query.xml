<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="ZZZL0070Query">

	<statement id="getTableInfo" parameterClass="Map" resultClass="Map">
		SELECT	DISTINCT
       			CNT.BAT_TBL_NM, 
       			CNT.BAT_TBL_EST_DT, 
       			CNT.BAT_TBL_SIZE_NUM/1000 AS BAT_TBL_SIZE_NUM,
       			CNT.BAT_TBL_DATA_CNT
		FROM  	
				BAT_TBL_CNT_LOG CNT, 
				BAT_TBL_REL REL
		WHERE 	
				REL.GLBL_CMPY_CD = #glblCmpyCd#
		AND   	REL.EZCANCELFLAG = '0'
		<isNotNull property="batProcJobId">
			<iterate property="batProcJobId" var="batProcJobId[]" open="and (" close=")" conjunction="or">
				BAT_PROC_JOB_ID = #batProcJobId[]#
			</iterate>
		</isNotNull>
		AND   	CNT.GLBL_CMPY_CD = REL.GLBL_CMPY_CD
		AND   	CNT.EZCANCELFLAG = '0'
		AND   	CNT.BAT_TBL_NM = REL.BAT_TBL_NM
		AND   	CNT.BAT_TBL_EST_DT  &gt;= #startDate#
		AND   	CNT.BAT_TBL_EST_DT  &lt;= #endDate#
		ORDER BY		
				BAT_TBL_NM ASC, 
				BAT_TBL_EST_DT ASC
	</statement>
	
	<statement id="getJobInfo" parameterClass="Map" resultClass="Map">
		SELECT
		  	DCOUNT.JID AS JBID,
			DCOUNT.DT AS MDATE,
			COUNT(DCOUNT.DT) AS EXECNT,
			SUM(DCOUNT.BCNT)/1000 AS TOTALTIME
		FROM
			(SELECT
		    	BAT_PROC_JOB_ID AS JID,
				substr(BAT_PROC_START_TS,0,8) AS DT,
		 		SUM(BAT_PROC_TM_CNT) AS BCNT
			FROM
				BAT_PROC_LOG
			WHERE
				GLBL_CMPY_CD 		= #glblCmpyCd#
			<isNotNull property="batProcJobId">
			<iterate property="batProcJobId" var="batProcJobId[]" open="and (" close=")" conjunction="or">
				BAT_PROC_JOB_ID = #batProcJobId[]#
			</iterate>
			</isNotNull>
				AND BAT_PROC_START_TS &gt;= #startDate#
				AND BAT_PROC_START_TS &lt;= #endDate#
			GROUP BY 
		    	BAT_PROC_JOB_ID,
				BAT_PROC_START_TS
			) DCOUNT
		GROUP BY 
			DCOUNT.JID,DCOUNT.DT
		ORDER BY 
			DCOUNT.JID ASC, 
			DCOUNT.DT ASC
	</statement>
	
	<statement id="getProgramId" parameterClass="Map" resultClass="Map">
		SELECT	BAT_PROC_JOB_ID,
				BAT_PROC_PGM_ID
		FROM  	
				BAT_PROC_LOG_MV
		WHERE 	
				GLBL_CMPY_CD = #glblCmpyCd#
		AND   	EZCANCELFLAG = '0'
		AND   	BAT_PROC_JOB_ID = #batProcJobId#
	</statement>
	
</sqlMap>