<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NFCB060001">
<statement id="getTargetData" parameterClass="Map">
    SELECT
         A.ECHK_PMT_REQ_ID
        ,A.BILL_TO_CUST_ACCT_CD
        ,A.DS_CUST_BANK_ACCT_RELN_PK
        ,A.ECHK_PMT_AMT
        ,B.INV_NUM
        ,B.INV_TOT_DEAL_NET_AMT
        ,C.DS_BANK_ACCT_PK
    FROM
         ECHK_RCPT_TRX A
        ,ECHK_RCPT_TRX_DTL B
        ,DS_CUST_BANK_ACCT_RELN C
    WHERE
            A.GLBL_CMPY_CD      = #glblCmpyCd#
        AND A.ECHK_PMT_STS_CD   = #echkPmtStsCd#
        AND A.AR_CASH_APPLY_FLG = #cashApplyFlg#
        AND A.EZCANCELFLAG      = '0'
        AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD
        AND A.ECHK_PMT_REQ_ID   = B.ECHK_PMT_REQ_ID
        AND B.EZCANCELFLAG      = '0'
        AND A.GLBL_CMPY_CD      = C.GLBL_CMPY_CD
        AND A.DS_CUST_BANK_ACCT_RELN_PK = C.DS_CUST_BANK_ACCT_RELN_PK
        AND C.EZCANCELFLAG      = '0'
    ORDER BY
         A.BILL_TO_CUST_ACCT_CD
        ,A.ECHK_PMT_REQ_ID
        ,B.INV_NUM
</statement>

<statement id="getSumOfTargetData" parameterClass="Map" resultClass="Map">
    SELECT
         SUM(B.INV_TOT_DEAL_NET_AMT) AS TOT_AMT
        ,COUNT(*)            AS CNT
    FROM
         ECHK_RCPT_TRX A
        ,ECHK_RCPT_TRX_DTL B
    WHERE
            A.GLBL_CMPY_CD           = #glblCmpyCd#
        AND A.ECHK_PMT_STS_CD        = #echkPmtStsCd#
        AND A.AR_CASH_APPLY_FLG      = #cashApplyFlg#
        AND A.BILL_TO_CUST_ACCT_CD   = #custCd#
        AND A.EZCANCELFLAG           = '0'
        AND A.GLBL_CMPY_CD           = B.GLBL_CMPY_CD
        AND A.ECHK_PMT_REQ_ID        = B.ECHK_PMT_REQ_ID
        AND B.EZCANCELFLAG           = '0'
</statement>
</sqlMap>