<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB109001">
    <statement id="getDailyData" parameterClass="Map">
        SELECT
             A.GLBL_CMPY_CD
            ,A.INTFC_PRT_MDSE_CD
            ,A.PRT_SIZE_TXT
            ,A.PRT_MAIN_PROD_CD
            ,A.CINC_PROD_CD
            ,A.PRT_DESC_TXT
            ,A.PRT_ITEM_CD
            ,A.PRT_ITEM_NM
            ,A.PRT_RUS_CD
            ,A.PRT_VND_DROP_FLG
            ,A.PRT_ASSET_CD
            ,A.DSCTN_FLG
            ,A.PRT_YFI_FLG
            ,A.PRT_DEL_FLG
            ,A.PRT_GTY_VND_END_DT
            ,A.PRT_GTY_END_DT
            ,A.INTFC_STD_COST_TXT
            ,A.INTFC_WRT_DOWN_COST_TXT
            ,A.INTFC_CCY_CD
            ,A.INTFC_PRT_SPEC_WT
            ,A.INTFC_GLBL_VND_CD
            ,A.INTFC_LOCAL_VND_CD
            ,A.INTFC_PACK_SNP_QTY
            ,A.INTFC_SUB_DIV_QTY
            ,A.INTFC_PRT_SALE_DT
            ,A.INTFC_PRT_ENTRY_DT
            ,A.INTFC_CMNT_TXT_01
            ,A.INTFC_CMNT_TXT_02
            ,A.INTFC_ATTRB_TXT_01
            ,A.INTFC_ATTRB_TXT_02
            ,A.INTFC_ATTRB_TXT_03
            ,A.INTFC_ATTRB_TXT_04
            ,A.INTFC_CRAT_DT
            ,A.INTFC_UPD_IND
        FROM 
             PRT_MSTR_WRK A
        WHERE
                A.GLBL_CMPY_CD       = #glblCmpyCd#
            AND A.EZCANCELFLAG       = '0'
            AND A.INTFC_CRAT_DT      = #intfcCratDt#
            <isNotNull property="preIntfcCratDt"> 
            AND NOT EXISTS (SELECT *
                 FROM
                     PRT_MSTR_WRK B
                 WHERE 
                         A.GLBL_CMPY_CD            = B.GLBL_CMPY_CD
                     AND B.EZCANCELFLAG            = '0'
                     AND B.INTFC_CRAT_DT           = #preIntfcCratDt#
                     AND A.INTFC_PRT_MDSE_CD                           = B.INTFC_PRT_MDSE_CD
                     AND A.PRT_SIZE_TXT                                = B.PRT_SIZE_TXT
                     AND NVL(A.PRT_MAIN_PROD_CD, #nullCompare#)        = NVL(B.PRT_MAIN_PROD_CD, #nullCompare#)
                     AND NVL(A.CINC_PROD_CD, #nullCompare#)            = NVL(B.CINC_PROD_CD, #nullCompare#)
                     AND NVL(A.PRT_DESC_TXT, #nullCompare#)            = NVL(B.PRT_DESC_TXT, #nullCompare#)
                     AND NVL(A.PRT_ITEM_CD, #nullCompare#)             = NVL(B.PRT_ITEM_CD, #nullCompare#)
                     AND NVL(A.PRT_ITEM_NM, #nullCompare#)             = NVL(B.PRT_ITEM_NM, #nullCompare#)
                     AND NVL(A.PRT_RUS_CD, #nullCompare#)              = NVL(B.PRT_RUS_CD, #nullCompare#)
                     AND NVL(A.PRT_VND_DROP_FLG, #nullCompare#)        = NVL(B.PRT_VND_DROP_FLG, #nullCompare#)
                     AND NVL(A.PRT_ASSET_CD, #nullCompare#)            = NVL(B.PRT_ASSET_CD, #nullCompare#)
                     AND NVL(A.DSCTN_FLG, #nullCompare#)               = NVL(B.DSCTN_FLG, #nullCompare#)
                     AND NVL(A.PRT_YFI_FLG, #nullCompare#)             = NVL(B.PRT_YFI_FLG, #nullCompare#)
                     AND NVL(A.PRT_DEL_FLG, #nullCompare#)             = NVL(B.PRT_DEL_FLG, #nullCompare#)
                     AND NVL(A.PRT_GTY_VND_END_DT, #nullCompare#)      = NVL(B.PRT_GTY_VND_END_DT, #nullCompare#)
                     AND NVL(A.PRT_GTY_END_DT, #nullCompare#)          = NVL(B.PRT_GTY_END_DT, #nullCompare#)
                     AND NVL(A.INTFC_STD_COST_TXT, #nullCompare#)      = NVL(B.INTFC_STD_COST_TXT, #nullCompare#)
                     AND NVL(A.INTFC_WRT_DOWN_COST_TXT, #nullCompare#) = NVL(B.INTFC_WRT_DOWN_COST_TXT, #nullCompare#)
                     AND NVL(A.INTFC_CCY_CD, #nullCompare#)            = NVL(B.INTFC_CCY_CD, #nullCompare#)
                     AND NVL(A.INTFC_PRT_SPEC_WT, #nullCompare#)       = NVL(B.INTFC_PRT_SPEC_WT, #nullCompare#)
                     AND NVL(A.INTFC_GLBL_VND_CD, #nullCompare#)       = NVL(B.INTFC_GLBL_VND_CD, #nullCompare#)
                     AND NVL(A.INTFC_LOCAL_VND_CD, #nullCompare#)      = NVL(B.INTFC_LOCAL_VND_CD, #nullCompare#)
                     AND NVL(A.INTFC_PACK_SNP_QTY, #nullCompare#)      = NVL(B.INTFC_PACK_SNP_QTY, #nullCompare#)
                     AND NVL(A.INTFC_SUB_DIV_QTY, #nullCompare#)       = NVL(B.INTFC_SUB_DIV_QTY, #nullCompare#)
                     AND NVL(A.INTFC_PRT_SALE_DT, #nullCompare#)       = NVL(B.INTFC_PRT_SALE_DT, #nullCompare#)
                     AND NVL(A.INTFC_PRT_ENTRY_DT, #nullCompare#)      = NVL(B.INTFC_PRT_ENTRY_DT, #nullCompare#)
                     AND NVL(A.INTFC_CMNT_TXT_01, #nullCompare#)       = NVL(B.INTFC_CMNT_TXT_01, #nullCompare#)
                     AND NVL(A.INTFC_CMNT_TXT_02, #nullCompare#)       = NVL(B.INTFC_CMNT_TXT_02, #nullCompare#)
                     AND NVL(A.INTFC_ATTRB_TXT_01, #nullCompare#)      = NVL(B.INTFC_ATTRB_TXT_01, #nullCompare#)
                     AND NVL(A.INTFC_ATTRB_TXT_02, #nullCompare#)      = NVL(B.INTFC_ATTRB_TXT_02, #nullCompare#)
                     AND NVL(A.INTFC_ATTRB_TXT_03, #nullCompare#)      = NVL(B.INTFC_ATTRB_TXT_03, #nullCompare#)
                     AND NVL(A.INTFC_ATTRB_TXT_04, #nullCompare#)      = NVL(B.INTFC_ATTRB_TXT_04, #nullCompare#)
                     AND NVL(A.INTFC_UPD_IND, #nullCompare#)           = NVL(B.INTFC_UPD_IND, #nullCompare#)
                )
           </isNotNull>
        ORDER BY
             A.INTFC_PRT_MDSE_CD
            ,A.PRT_SIZE_TXT
    </statement>
    <statement id="getMonthlyData" parameterClass="Map">
        SELECT
             A.GLBL_CMPY_CD
            ,A.INTFC_PRT_MDSE_CD
            ,A.PRT_SIZE_TXT
            ,A.PRT_MAIN_PROD_CD
            ,A.CINC_PROD_CD
            ,A.PRT_DESC_TXT
            ,A.PRT_ITEM_CD
            ,A.PRT_ITEM_NM
            ,A.PRT_RUS_CD
            ,A.PRT_VND_DROP_FLG
            ,A.PRT_ASSET_CD
            ,A.DSCTN_FLG
            ,A.PRT_YFI_FLG
            ,A.PRT_DEL_FLG
            ,A.PRT_GTY_VND_END_DT
            ,A.PRT_GTY_END_DT
            ,A.INTFC_STD_COST_TXT
            ,A.INTFC_WRT_DOWN_COST_TXT
            ,A.INTFC_CCY_CD
            ,A.INTFC_PRT_SPEC_WT
            ,A.INTFC_GLBL_VND_CD
            ,A.INTFC_LOCAL_VND_CD
            ,A.INTFC_PACK_SNP_QTY
            ,A.INTFC_SUB_DIV_QTY
            ,A.INTFC_PRT_SALE_DT
            ,A.INTFC_PRT_ENTRY_DT
            ,A.INTFC_CMNT_TXT_01
            ,A.INTFC_CMNT_TXT_02
            ,A.INTFC_ATTRB_TXT_01
            ,A.INTFC_ATTRB_TXT_02
            ,A.INTFC_ATTRB_TXT_03
            ,A.INTFC_ATTRB_TXT_04
            ,A.INTFC_CRAT_DT
            ,A.INTFC_UPD_IND
        FROM 
             PRT_MSTR_WRK A
        WHERE
                A.GLBL_CMPY_CD       = #glblCmpyCd#
            AND A.EZCANCELFLAG       = '0'
            AND A.INTFC_CRAT_DT      = #intfcCratDt#
        ORDER BY
             A.INTFC_PRT_MDSE_CD
            ,A.PRT_SIZE_TXT
    </statement>
    <statement id="getPreIntfcCratDt" parameterClass="Map" resultClass="String">
        SELECT
             MAX(A.INTFC_CRAT_DT)
        FROM 
             PRT_MSTR_WRK A
        WHERE
                A.GLBL_CMPY_CD       =    #glblCmpyCd#
            AND A.EZCANCELFLAG       =    '0'
            AND A.INTFC_CRAT_DT      &lt; #intfcCratDt#
    </statement>
</sqlMap>
