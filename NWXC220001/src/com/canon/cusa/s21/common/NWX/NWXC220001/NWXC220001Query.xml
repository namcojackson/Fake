<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWXC220001Query">
    <typeAlias alias="XTRNL_INTFC_XREFTMsg"    type="business.db.XTRNL_INTFC_XREFTMsg"/>

    <statement id="getEdiAttrb" parameterClass="Map" resultClass="Map">
        SELECT
            DIEA.DS_IMPT_ORD_PK                           -- Direct Sales Import Order PK
            ,DIDEA.DS_IMPT_ORD_DTL_PK                     -- Direct Sales Import Order Detail PK
            ,DETP.DS_EDI_TRD_PTNR_REF_CD                  -- Direct Sales EDI Trading Partner Reference Code
            ,DETP.SEND_PO_ACK_FLG                         -- Send PO Acknowledgement Flag
            ,DETP.PO_INBD_INTFC_ID                        -- PO Inbound Interface ID
        FROM
            DS_IMPT_EXT_ATTRB    DIEA       -- Direct Sales Import Extend Attribute
            ,DS_IMPT_DTL_EXT_ATTRB DIDEA    -- Direct Sales Import Detail Extend Attribute
            ,DS_EDI_TRD_PTNR      DETP      -- Direct Sales EDI Trading Partner
        WHERE
            DIEA.EZCANCELFLAG       = '0'
            AND DIEA.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DIEA.EZCANCELFLAG   = DIDEA.EZCANCELFLAG
            AND DIEA.DS_IMPT_ORD_PK = #dsImptOrdPk#
            AND DIEA.GLBL_CMPY_CD   = DIDEA.GLBL_CMPY_CD
            AND DIEA.DS_IMPT_ORD_PK = DIDEA.DS_IMPT_ORD_PK
            AND DIEA.EZCANCELFLAG   = DETP.EZCANCELFLAG
            AND DIEA.GLBL_CMPY_CD   = DETP.GLBL_CMPY_CD
            AND DIEA.EDI_TRD_PTNR_CD = DETP.DS_EDI_TRD_PTNR_CD
    </statement>

    <statement id="getXtrnlIntfcXref" parameterClass="Map" resultMap="result.getXtrnlIntfcXref">
        SELECT
            XIX.GLBL_CMPY_CD
            ,XIX.CPO_SRC_TP_CD
            ,XIX.INTFC_ID
            ,XIX.INTFC_XREF_CTX_TP_CD
            ,XIX.TRGT_ATTRB_TXT_01
            ,XIX.TRGT_ATTRB_TXT_02
            ,XIX.TRGT_ATTRB_TXT_03
            ,XIX.TRGT_ATTRB_TXT_04
            ,XIX.TRGT_ATTRB_TXT_05
            ,XIX.TRGT_ATTRB_TXT_06
            ,XIX.TRGT_ATTRB_TXT_07
            ,XIX.TRGT_ATTRB_TXT_08
            ,XIX.TRGT_ATTRB_TXT_09
            ,XIX.TRGT_ATTRB_TXT_10
            ,XIX.TRGT_ATTRB_NUM_01
            ,XIX.TRGT_ATTRB_NUM_02
            ,XIX.TRGT_ATTRB_NUM_03
            ,XIX.TRGT_ATTRB_NUM_04
            ,XIX.TRGT_ATTRB_NUM_05
        FROM
            XTRNL_INTFC_XREF     XIX        -- External Interface Cross Reference
        WHERE
            XIX.EZCANCELFLAG           = '0'
            AND XIX.GLBL_CMPY_CD       = #glblCmpyCd#
            AND XIX.CPO_SRC_TP_CD      = #cpoSrcTpCd#
            AND XIX.INTFC_ID           = #intfcId#
            AND XIX.INTFC_XREF_CTX_TP_CD = #intfcXrefCtxTpCd#
            <isNotNull property="srcAttrbTxt01">
            AND XIX.SRC_ATTRB_TXT_01   = #srcAttrbTxt01#
            </isNotNull>
            <isNull property="srcAttrbTxt01">
            AND XIX.SRC_ATTRB_TXT_01 IS NULL
            </isNull>
            <isNotNull property="srcAttrbTxt02">
            AND XIX.SRC_ATTRB_TXT_02   = #srcAttrbTxt02#
            </isNotNull>
            <isNull property="srcAttrbTxt02">
            AND XIX.SRC_ATTRB_TXT_02 IS NULL
            </isNull>
            <isNotNull property="srcAttrbTxt03">
            AND XIX.SRC_ATTRB_TXT_03   = #srcAttrbTxt03#
            </isNotNull>
            <isNull property="srcAttrbTxt03">
            AND XIX.SRC_ATTRB_TXT_03 IS NULL
            </isNull>
            <isNotNull property="srcAttrbTxt04">
            AND XIX.SRC_ATTRB_TXT_04   = #srcAttrbTxt04#
            </isNotNull>
            <isNull property="srcAttrbTxt04">
            AND XIX.SRC_ATTRB_TXT_04 IS NULL
            </isNull>
            <!-- 2018/06/04 S21_NA#26443 Add Start -->
            <isNotNull property="srcAttrbTxt05">
            AND XIX.SRC_ATTRB_TXT_05   = #srcAttrbTxt05#
            </isNotNull>
            <isNull>
            AND XIX.SRC_ATTRB_TXT_05 IS NULL
            </isNull>
            <!-- 2018/06/04 S21_NA#26443 Add End -->
    </statement>

    <resultMap id="result.getXtrnlIntfcXref" class="XTRNL_INTFC_XREFTMsg">
        <result property="glblCmpyCd"         column="GLBL_CMPY_CD"          javaType="EZDTStringItem"/>
        <result property="cpoSrcTpCd"         column="CPO_SRC_TP_CD"          javaType="EZDTStringItem"/>
        <result property="intfcId"            column="INTFC_ID"               javaType="EZDTStringItem"/>
        <result property="intfcXrefCtxTpCd"   column="INTFC_XREF_CTX_TP_CD"   javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_01"    column="TRGT_ATTRB_TXT_01"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_01"    column="TRGT_ATTRB_TXT_01"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_02"    column="TRGT_ATTRB_TXT_02"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_03"    column="TRGT_ATTRB_TXT_03"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_04"    column="TRGT_ATTRB_TXT_04"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_05"    column="TRGT_ATTRB_TXT_05"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_06"    column="TRGT_ATTRB_TXT_06"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_07"    column="TRGT_ATTRB_TXT_07"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_08"    column="TRGT_ATTRB_TXT_08"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_09"    column="TRGT_ATTRB_TXT_09"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbTxt_10"    column="TRGT_ATTRB_TXT_10"      javaType="EZDTStringItem"/>
        <result property="trgtAttrbNum_01"    column="TRGT_ATTRB_NUM_01"      javaType="EZDTBigDecimalItem"/>
        <result property="trgtAttrbNum_02"    column="TRGT_ATTRB_NUM_02"      javaType="EZDTBigDecimalItem"/>
        <result property="trgtAttrbNum_03"    column="TRGT_ATTRB_NUM_03"      javaType="EZDTBigDecimalItem"/>
        <result property="trgtAttrbNum_04"    column="TRGT_ATTRB_NUM_04"      javaType="EZDTBigDecimalItem"/>
        <result property="trgtAttrbNum_05"    column="TRGT_ATTRB_NUM_05"      javaType="EZDTBigDecimalItem"/>
    </resultMap>

    <statement id="getShpgSvcLvlCarrReln" parameterClass="Map" resultClass="String">
        SELECT
             SSLCR.SHPG_SVC_LVL_CD                          -- Shipping Service Level Code,Example Data
        FROM
            SHPG_SVC_LVL_CARR_RELN SSLCR      -- Shipping Service Level Carrier Relation
        WHERE
            SSLCR.EZCANCELFLAG         = '0'
            AND SSLCR.GLBL_CMPY_CD     = #glblCmpyCd#
            AND SSLCR.SHPG_SVC_LVL_CD  = #shpgSvcLvlCd#
            AND SSLCR.CARR_SVC_LVL_CD  = #carrSvcLvlCd#
    </statement>

    <statement id="getPmtTermCashDiscCd1" parameterClass="Map" resultClass="String">
        SELECT
            CCP.PMT_TERM_CASH_DISC_CD      -- FK Parent Entity: PMT_TERM_CASH_DISC
        FROM
            CUST_CR_PRFL         CCP        -- Customer Credit Profile
        WHERE
            CCP.EZCANCELFLAG           = '0'
            AND CCP.GLBL_CMPY_CD       = #glblCmpyCd#
            AND CCP.BILL_TO_CUST_CD    = #billToCustCd#
    </statement>

    <statement id="getPmtTermCashDiscCd2" parameterClass="Map" resultClass="String">
        SELECT
            DACP.PMT_TERM_CASH_DISC_CD      -- FK Parent Entity: PMT_TERM_CASH_DISC
        FROM
            DS_ACCT_CR_PRFL      DACP       -- Direct Sales Account Credit Profile
        WHERE
            DACP.EZCANCELFLAG       = '0'
            AND DACP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DACP.DS_ACCT_NUM    = #dsAcctNum#
    </statement>

    <statement id="getDuplicateOrd" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM              AS CPO_ORD_NUM
            , C.CUST_ISS_PO_NUM        AS PO_NUM
            , C.BILL_TO_CUST_CD        AS BILL_TO_CUST_CD
            , C.BILL_TO_CUST_ACCT_CD   AS BILL_TO_CUST_ACCT_CD
            , C.ORD_HDR_STS_CD         AS ORD_HDR_STS_CD
        FROM
            CPO     C
        WHERE
            C.GLBL_CMPY_CD    =  #glblCmpyCd#
        <isNotNull property="ordNum">
        AND C.CPO_ORD_NUM     != #ordNum#
        </isNotNull>
        AND C.ORD_HDR_STS_CD  != #ordHdrStsCd#
        AND C.EZCANCELFLAG    =  '0'
        AND C.CUST_ISS_PO_NUM =  #custIssPoNum#
        AND
            EXISTS (
                SELECT
                    *
                FROM
                     CPO        C1
                    ,CPO_DTL    CD1
                WHERE
                    C1.GLBL_CMPY_CD          =  #glblCmpyCd#
                <isNotNull property="ordNum">
                AND C1.CPO_ORD_NUM           =  #ordNum#
                </isNotNull>
                AND C1.CUST_ISS_PO_NUM       =  C.CUST_ISS_PO_NUM
                AND C1.EZCANCELFLAG          =  '0'
                AND
                    (
                        C1.BILL_TO_CUST_CD = C.BILL_TO_CUST_CD
                    OR
                        C1.BILL_TO_CUST_ACCT_CD =  C.BILL_TO_CUST_ACCT_CD
                    )

                AND C1.GLBL_CMPY_CD         =  CD1.GLBL_CMPY_CD(+)
                AND C1.CPO_ORD_NUM          =  CD1.CPO_ORD_NUM(+)
                AND CD1.CR_REBIL_CD(+)      IS NULL
                AND CD1.EZCANCELFLAG(+)     =  '0'
            )
    </statement>

    <statement id="getDuplicateMaintPo" parameterClass="Map" resultClass="Map">
        SELECT
            CNTD.CPO_ORD_NUM        AS CPO_ORD_NUM
         ,  CNTD.CPO_DTL_LINE_NUM   AS CPO_DTL_LINE_NUM
         ,  CNTP.CUST_PO_NUM        AS PO_NUM
         ,  CP.BILL_TO_CUST_CD      AS BILL_TO_CUST_CD
        FROM
            CPO                   CP
         ,  DS_CONTR_DTL          CNTD
         ,  DS_CONTR_CR_CARD_PO   CNTP
        WHERE
            CNTD.GLBL_CMPY_CD     =  #glblCmpyCd#
        <isNotNull property="ordNum">
        AND CNTD.CPO_ORD_NUM      != #ordNum#
        </isNotNull>
        AND CNTD.EZCANCELFLAG     =  '0'

        AND CNTD.GLBL_CMPY_CD     =  CNTP.GLBL_CMPY_CD
        AND CNTD.DS_CONTR_DTL_PK  =  CNTP.DS_CONTR_DTL_PK
        AND CNTP.EZCANCELFLAG     =  '0'
        AND CNTP.CUST_PO_NUM      = #custIssPoNum#
        <!-- START 2019/01/17 K.Morita [QC#26928, ADD] -->
        AND CNTP.CR_CARD_FLG      =  'N'
        AND CP.CUST_ISS_PO_DT     &gt;= CNTP.PO_FROM_DT
        AND CP.CUST_ISS_PO_DT     &lt;= CNTP.PO_DT
        <!-- END 2019/01/17 K.Morita [QC#26928, ADD] -->
        AND CNTD.GLBL_CMPY_CD     =  CP.GLBL_CMPY_CD
        AND CNTD.CPO_ORD_NUM      =  CP.CPO_ORD_NUM
        AND CP.EZCANCELFLAG       =  '0'

        AND (EXISTS
                (SELECT
                    *
                 FROM
                     DS_CONTR_DTL          CNTD2
                  ,  DS_CONTR_CR_CARD_PO   CNTP2
                  ,  DS_CONTR              CNT2
                 WHERE
                     CNTD2.GLBL_CMPY_CD    =  #glblCmpyCd#
                <isNotNull property="ordNum">
                 AND CNTD2.CPO_ORD_NUM     =  #ordNum#
                </isNotNull>
                 AND CNTD2.EZCANCELFLAG    =  '0'
                 <!-- START 2019/01/17 K.Morita [QC#26928, ADD] -->
                 AND CNTP2.CR_CARD_FLG     =  'N'
                 AND CP.CUST_ISS_PO_DT     &gt;= CNTP.PO_FROM_DT
                 AND CP.CUST_ISS_PO_DT     &lt;= CNTP.PO_DT
                 <!-- END 2019/01/17 K.Morita [QC#26928, ADD] -->
                 AND CNTD2.GLBL_CMPY_CD    =  CNTP2.GLBL_CMPY_CD
                 AND CNTD2.DS_CONTR_DTL_PK =  CNTP2.DS_CONTR_DTL_PK
                 AND CNTP2.EZCANCELFLAG    =  '0'
                 AND CNTP2.CUST_PO_NUM     =  CNTP.CUST_PO_NUM

                 AND CNTD2.GLBL_CMPY_CD    =  CNT2.GLBL_CMPY_CD
                 AND CNTD2.DS_CONTR_PK     =  CNT2.DS_CONTR_PK
                 AND CNT2.CR_REBIL_CD      IS NULL
                 AND CNT2.EZCANCELFLAG     =  '0'
                )
            )
    </statement>

    <statement id="getDuplicateLeasePo" parameterClass="Map" resultClass="Map">
        SELECT
            C.CPO_ORD_NUM          AS CPO_ORD_NUM
         ,  C.LEASE_CMPY_PO_NUM    AS PO_NUM
         ,  C.BILL_TO_CUST_CD      AS BILL_TO_CUST_CD
        FROM
            CPO C
        WHERE
            C.GLBL_CMPY_CD   =  #glblCmpyCd#
        <isNotNull property="ordNum">
        AND C.CPO_ORD_NUM    != #ordNum#
        </isNotNull>
        AND C.EZCANCELFLAG   =  '0'
        AND C.ORD_HDR_STS_CD != #ordHdrStsCd#
        AND C.LEASE_CMPY_PO_NUM =  #custIssPoNum#

        AND (EXISTS
               (SELECT
                    *
                FROM
                    CPO        C1
                 ,  CPO_DTL    CD1
                WHERE
                    C1.GLBL_CMPY_CD          =  #glblCmpyCd#
                <isNotNull property="ordNum">
                AND C1.CPO_ORD_NUM           =  #ordNum#
                </isNotNull>
                AND C1.LEASE_CMPY_PO_NUM     =  C.LEASE_CMPY_PO_NUM
                AND C1.BILL_TO_CUST_ACCT_CD  =  C.BILL_TO_CUST_ACCT_CD
                AND C1.EZCANCELFLAG          =  '0'

                AND C1.GLBL_CMPY_CD          =  CD1.GLBL_CMPY_CD
                AND C1.CPO_ORD_NUM           =  CD1.CPO_ORD_NUM
                AND CD1.CR_REBIL_CD          IS NULL
                AND CD1.EZCANCELFLAG         =  '0'
               )
           )
    </statement>

    <statement id="getDefMdse1" parameterClass="Map" resultClass="Map">
        SELECT
            AMV.MDSE_CD      AS MDSE_CD
            ,AMV.MDSE_NM     AS MDSE_NM
        FROM
            ALL_MDSE_V           AMV
        WHERE
            AMV.EZCANCELFLAG        = '0'
            AND AMV.GLBL_CMPY_CD    = #glblCmpyCd#
            AND AMV.MDSE_CD         = #mdseCd#
    </statement>

    <statement id="getDefMdse2" parameterClass="Map" resultClass="Map">
        SELECT
            AMV.MDSE_CD      AS MDSE_CD
            ,AMV.MDSE_NM     AS MDSE_NM
        FROM
             MDSE                 M
            ,ALL_MDSE_V           AMV
        WHERE
            M.EZCANCELFLAG        = '0'
            AND M.GLBL_CMPY_CD    = #glblCmpyCd#
            AND M.MNF_ITEM_CD     = #mdseCd#          -- 10 Length
            AND M.EZCANCELFLAG    = AMV.EZCANCELFLAG
            AND M.GLBL_CMPY_CD    = AMV.GLBL_CMPY_CD
            AND M.MDSE_CD         = AMV.MDSE_CD
    </statement>

    <statement id="getDefMdseFromCustMdseXref" parameterClass="Map" resultClass="Map">
        SELECT
            AMV.MDSE_CD      AS MDSE_CD
            ,AMV.MDSE_NM     AS MDSE_NM
        FROM
            CUST_MDSE_XREF        CMX
            ,ALL_MDSE_V           AMV
        WHERE
            CMX.EZCANCELFLAG        = '0'
            AND CMX.GLBL_CMPY_CD    = #glblCmpyCd#
            AND CMX.CUST_MDSE_CD    = #custMdseCd#
            AND CMX.DS_ACCT_NUM     = #dsAcctNum#
            AND CMX.CUST_MDSE_XREF_ENBL_FLG = 'Y'
            AND CMX.EZCANCELFLAG    = AMV.EZCANCELFLAG
            AND CMX.GLBL_CMPY_CD    = AMV.GLBL_CMPY_CD
            AND CMX.MDSE_CD         = AMV.MDSE_CD
    </statement>

    <statement id="getDsOrdLineCatgList" parameterClass="Map" resultClass="Map">
        SELECT
            PD.PRIM_LINE_CATG_FLG       AS PRIM_LINE_CATG_FLG
           ,C.DS_ORD_LINE_CATG_CD       AS DS_ORD_LINE_CATG_CD
           ,C.DS_ORD_LINE_CATG_DESC_TXT AS DS_ORD_LINE_CATG_DESC_TXT
        FROM
            DS_ORD_LINE_PROC_DFN PD
           ,DS_ORD_LINE_CATG C
        WHERE
            PD.GLBL_CMPY_CD             = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD         = #dsOrdTpCd#
            AND PD.ACTV_FLG             = #actvFlg#
            AND PD.EFF_FROM_DT          &lt;= #effDt#
            AND (PD.EFF_THRU_DT         &gt;= #effDt# OR PD.EFF_THRU_DT IS NULL)
            AND PD.EZCANCELFLAG         = '0'
            AND PD.GLBL_CMPY_CD         = C.GLBL_CMPY_CD
            AND PD.DS_ORD_LINE_CATG_CD  = C.DS_ORD_LINE_CATG_CD
            AND C.DS_ORD_LINE_DRCTN_CD  = #dsOrdLineDrctnCd#
            AND C.EZCANCELFLAG          = '0'
        ORDER BY
            C.DS_ORD_LINE_CATG_SORT_NUM
    </statement>

    <statement id="getDefDsOrdTpProcDfnPk" parameterClass="Map" resultClass="String">
        SELECT
            DOTPD.DS_ORD_TP_CD
        FROM
            DS_ORD_TP_PROC_DFN   DOTPD
        WHERE
            DOTPD.EZCANCELFLAG      = '0'
            AND DOTPD.GLBL_CMPY_CD  = #glblCmpyCd#
            AND DOTPD.DS_ORD_TP_CD  = #dsOrdTpCd#
            AND DOTPD.ACTV_FLG      = 'Y'
            AND DOTPD.EFF_FROM_DT   &lt;= #effFromDt#
            AND NVL(DOTPD.EFF_THRU_DT, '99991231') &gt;= #effThruDt#
    </statement>

    <statement id="getDuplicateDsImptOrdList" parameterClass="Map" resultClass="Map">
        SELECT
             DIO.DS_IMPT_ORD_PK
            ,CPO_V.CPO_ORD_NUM
            ,ISTS.IMPT_OVRD_MSG_FLG
        FROM
             DS_IMPT_ORD DIO
            ,IMPT_STS    ISTS
            ,(
             SELECT
                  C.CPO_ORD_NUM
                 ,C.CPO_SRC_TP_CD
                 ,C.ORD_SRC_REF_NUM
             FROM
                  CPO    C
             WHERE
                     C.EZCANCELFLAG     = '0'
                 AND C.GLBL_CMPY_CD     = #glblCmpyCd#
                 <isNotNull property="cpoSrcTpCd">
                 AND C.CPO_SRC_TP_CD    = #cpoSrcTpCd#
                 </isNotNull>
                 <isNotNull property="ordSrcRefNum">
                 AND C.ORD_SRC_REF_NUM = #ordSrcRefNum#
                 </isNotNull>
             ) CPO_V
        WHERE
                DIO.EZCANCELFLAG    = '0'
            AND DIO.GLBL_CMPY_CD    = #glblCmpyCd#
            <isNotNull property="dsImptOrdPk">
            AND DIO.DS_IMPT_ORD_PK  != #dsImptOrdPk#
            </isNotNull>
            <isNotNull property="cpoSrcTpCd">
            AND DIO.CPO_SRC_TP_CD   = #cpoSrcTpCd#
            </isNotNull>
            <isNotNull property="ordSrcRefNum">
            AND DIO.ORD_SRC_REF_NUM = #ordSrcRefNum#
            </isNotNull>
            AND DIO.CPO_SRC_TP_CD   = CPO_V.CPO_SRC_TP_CD(+)
            AND DIO.ORD_SRC_REF_NUM = CPO_V.ORD_SRC_REF_NUM(+)
            AND DIO.EZCANCELFLAG    = ISTS.EZCANCELFLAG(+)
            AND DIO.GLBL_CMPY_CD    = ISTS.GLBL_CMPY_CD(+)
            AND DIO.IMPT_STS_CD     = ISTS.IMPT_STS_CD(+)
    </statement>

    <statement id="getDsImptPkList" parameterClass="Map" resultClass="Map">
        SELECT
             DISD.DS_IMPT_SVC_DTL_PK
            ,DIST.DS_IMPT_SCHD_TMPL_PK
        FROM
             DS_IMPT_SVC_DTL   DISD
            ,DS_IMPT_SCHD_TMPL DIST
        WHERE
                DISD.EZCANCELFLAG       = '0'
            AND DISD.GLBL_CMPY_CD       = #glblCmpyCd#
            AND DISD.DS_IMPT_ORD_PK     = #dsImptOrdPk#
            AND DISD.EZCANCELFLAG       = DIST.EZCANCELFLAG(+)
            AND DISD.GLBL_CMPY_CD       = DIST.GLBL_CMPY_CD(+)
            AND DISD.DS_IMPT_SVC_DTL_PK = DIST.DS_IMPT_SVC_DTL_PK(+)
    </statement>

    <statement id="getValidDsOrdCatgCdList" parameterClass="Map" resultClass="Map">
        SELECT
            OC.DS_ORD_CATG_CD       AS DS_ORD_CATG_CD
           ,OC.DS_ORD_CATG_DESC_TXT AS DS_ORD_CATG_DESC_TXT
        FROM
            DS_ORD_CATG           OC
           ,DS_ORD_TP             OT
           ,AVAL_DS_ORD_TP_APP_ID AI
        WHERE
            OC.GLBL_CMPY_CD             = #glblCmpyCd#
            AND OC.EZCANCELFLAG         = '0'

            AND OC.GLBL_CMPY_CD   = OT.GLBL_CMPY_CD
            AND OC.DS_ORD_CATG_CD = OT.DS_ORD_CATG_CD
            AND OT.EZCANCELFLAG   = '0'

            AND OT.GLBL_CMPY_CD = AI.GLBL_CMPY_CD
            AND OT.DS_ORD_TP_CD = AI.DS_ORD_TP_CD
            AND AI.BIZ_APP_ID   = #bizId#
            AND AI.EZCANCELFLAG = '0'
        GROUP BY
            OC.DS_ORD_CATG_CD
           ,OC.DS_ORD_CATG_DESC_TXT
        ORDER BY
            OC.DS_ORD_CATG_CD
           ,OC.DS_ORD_CATG_DESC_TXT
    </statement>

    <statement id="getBaseComponentFlag" parameterClass="Map" resultClass="Map">
        SELECT
            M.INSTL_BASE_CTRL_FLG
           ,MT.MDSE_TP_CTX_TP_CD
        FROM
            MDSE            M
           ,MDSE_TP_VAL_SET MT
        WHERE
            M.GLBL_CMPY_CD             = #glblCmpyCd#
            AND M.MDSE_CD              = #mdseCd#
            AND M.EZCANCELFLAG         = '0'
            AND M.GLBL_CMPY_CD         = MT.GLBL_CMPY_CD(+)
            AND M.COA_MDSE_TP_CD       = MT.COA_MDSE_TP_CD(+)
            AND MT.MDSE_TP_CTX_TP_CD(+) = #mdseTpCtxTpCd#
            AND MT.EZCANCELFLAG(+)      = '0'
            AND ROWNUM                  = 1
    </statement>

    <statement id="getOrdProcTpInfo" parameterClass="Map" resultClass="Map">
        SELECT
                  OPT.ITRL_ORD_PROC_FLG
                , OPT.CUST_ORD_PROC_FLG
                , OPT.WS_ORD_PROC_FLG 
            FROM
                <isNotNull property="dsOrdLineCatgCd">
                DS_ORD_LINE_PROC_DFN    PD
                </isNotNull>
                <isNull property="dsOrdLineCatgCd">
                DS_ORD_TP_PROC_DFN      PD
                </isNull>
                , ORD_PROC_TP           OPT
            WHERE
                PD.GLBL_CMPY_CD            = #glblCmpyCd#
                AND PD.DS_ORD_TP_CD        = #dsOrdTpCd#
                <isNotNull property="dsOrdLineCatgCd">
                AND PD.DS_ORD_LINE_CATG_CD = #dsOrdLineCatgCd#
                </isNotNull>
                AND PD.EZCANCELFLAG        = '0'
                AND PD.GLBL_CMPY_CD        = OPT.GLBL_CMPY_CD
                AND PD.ORD_PROC_TP_CD      = OPT.ORD_PROC_TP_CD
                AND OPT.EFF_FROM_DT       &lt;= #slsDt#
                AND (
                    OPT.EFF_THRU_DT       &gt;= #slsDt#
                 OR OPT.EFF_THRU_DT       IS NULL
                    )
                AND OPT.ACTV_FLG           = 'Y'
                AND OPT.EZCANCELFLAG       = '0'
                AND ROWNUM                 = 1
    </statement>

    <statement id="getCostPctInfo" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            S.MDSE_INVTY_COST_PCT
        FROM
              RTL_SWH RS
            , SWH   S
        WHERE
                RS.GLBL_CMPY_CD  = #glblCmpyCd#
            AND RS.RTL_SWH_CD    = #rtlSwhCd#
            AND RS.EFF_FROM_DT  &lt;= #slsDt#
            AND (
                RS.EFF_THRU_DT  &gt;= #slsDt#
             OR RS.EFF_THRU_DT  IS NULL
                )
            AND RS.EZCANCELFLAG  = '0'
            AND RS.GLBL_CMPY_CD  = S.GLBL_CMPY_CD
            AND RS.RTL_SWH_CD    = S.RTL_SWH_CD
            AND S.EZCANCELFLAG   = '0'
    </statement>

    <statement id="getMdlIdNmBySvcConfigMstr" parameterClass="Map" resultClass="Map">
        SELECT
             SCM.MDL_ID
            ,DM.MDL_DESC_TXT AS MDL_DESC_TXT2
            ,MN.T_MDL_NM AS MDL_DESC_TXT
        FROM
            SVC_CONFIG_MSTR SCM
            ,DS_MDL DM
            ,MDL_NM MN
        WHERE
            SCM.GLBL_CMPY_CD            = #glblCmpyCd#
            AND SCM.SVC_CONFIG_MSTR_PK  = #svcConfigMstrPk#
            AND SCM.EZCANCELFLAG        = '0'
            AND SCM.GLBL_CMPY_CD        = DM.GLBL_CMPY_CD(+)
            AND SCM.MDL_ID              = DM.MDL_ID(+)
            AND DM.EZCANCELFLAG(+)      = '0'
            AND DM.EZCANCELFLAG         = MN.EZCANCELFLAG(+)
            AND DM.GLBL_CMPY_CD         = MN.T_GLBL_CMPY_CD(+)
            AND DM.MDL_ID               = MN.T_MDL_ID(+)
    </statement>

    <statement id="getSlsRepInfo" parameterClass="Map" resultClass="Map">
        SELECT
             SP.PSN_NUM           AS SLS_REP_PSN_NUM
            ,TOC.TOC_CD           AS SLS_REP_TOC_CD
            ,TOC.TOC_NM           AS SLS_REP_TOC_NM
            ,CB.COA_BR_CD         AS COA_BR_CD
            ,CB.COA_BR_DESC_TXT   AS COA_BR_DESC_TXT
            ,CE.COA_EXTN_CD       AS COA_EXTN_CD
            ,CE.COA_EXTN_DESC_TXT AS COA_EXTN_DESC_TXT
            ,(
             CASE
             WHEN CB.COA_BR_CD IS NOT NULL THEN
                 CB.COA_BR_CD || ':' || CB.COA_BR_DESC_TXT
             END
             )                    AS COA_BR_ITEM
            ,(
             CASE
             WHEN CE.COA_EXTN_CD IS NOT NULL THEN
                 CE.COA_EXTN_CD || ':' || CE.COA_EXTN_DESC_TXT
             END
             )                    AS COA_EXTN_ITEM
        FROM
             TOC              TOC
            ,ORG_FUNC_ROLE_TP OFRT
            ,BIZ_AREA_ORG     BA
            ,ORG_FUNC_ASG     OFA
            ,S21_PSN          SP
            ,COA_BR           CB
            ,COA_EXTN         CE
        WHERE
                TOC.GLBL_CMPY_CD        =  #glblCmpyCd#
            <isNotNull property="slsRepTocNm">
            AND TOC.TOC_NM              =  #slsRepTocNm#
            </isNotNull>
            <isNotNull property="slsRepTocCd">
            AND TOC.TOC_CD              =  #slsRepTocCd#
            </isNotNull>
            AND TOC.EZCANCELFLAG        =  '0'
            AND TOC.GLBL_CMPY_CD        =  OFRT.GLBL_CMPY_CD
            AND TOC.ORG_FUNC_ROLE_TP_CD =  OFRT.ORG_FUNC_ROLE_TP_CD
            AND OFRT.SLS_REP_FLG        =  'Y'
            AND OFRT.EZCANCELFLAG       =  '0'
            AND OFRT.GLBL_CMPY_CD       =  BA.GLBL_CMPY_CD
            AND OFRT.FIRST_ORG_CD       =  BA.BIZ_AREA_ORG_CD
            AND BA.SLS_FLG              =  'Y'
            AND BA.ORG_STRU_TP_CD       =  #orgStruTpCd#
            AND BA.EZCANCELFLAG         =  '0'
            AND TOC.GLBL_CMPY_CD        =  OFA.GLBL_CMPY_CD
            AND TOC.TOC_CD              =  OFA.TOC_CD
            AND OFA.EZCANCELFLAG        =  '0'
            AND OFA.GLBL_CMPY_CD        =  SP.GLBL_CMPY_CD
            AND OFA.PSN_CD              =  SP.PSN_CD
            <isNotNull property="slsRepPsnNum">
            AND SP.PSN_NUM              =  #slsRepPsnNum#
            </isNotNull>
            AND SP.EFF_FROM_DT          &lt;= #slsDt#
            AND (SP.EFF_THRU_DT         &gt;= #slsDt# OR SP.EFF_THRU_DT IS NULL)
            AND SP.EZCANCELFLAG         =  '0'
            AND TOC.GLBL_CMPY_CD        =  CB.GLBL_CMPY_CD (+)
            AND TOC.COA_BR_CD           =  CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+)     =  '0'
            AND TOC.GLBL_CMPY_CD        =  CE.GLBL_CMPY_CD (+)
            AND TOC.COA_EXTN_CD         =  CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+)     =  '0'
        ORDER BY
            TOC.TOC_CD
    </statement>

    <statement id="getDsMdseStorePkgUomCd" parameterClass="Map" resultClass="String">
        SELECT
            MSP.PKG_UOM_CD
        FROM
            MDSE_STORE_PKG  MSP
        WHERE
                MSP.GLBL_CMPY_CD     = #glblCmpyCd#
            AND MSP.MDSE_CD          = #mdseCd#
            AND MSP.BASE_PKG_UOM_CD  = #basePkgUomCd#
            AND MSP.EZCANCELFLAG     = '0'
    </statement>

    <statement id="isExistOrdCatg" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(OCBC.ORD_CATG_BIZ_CTX_PK)
        FROM
            ORD_CATG_BIZ_CTX OCBC
        WHERE
            OCBC.GLBL_CMPY_CD           = #glblCmpyCd#
            AND OCBC.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCd#
            AND OCBC.EZCANCELFLAG       = '0'
            AND (
                 (
                  OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                  AND OCBC.DS_ORD_TP_CD  IS NULL
                  AND OCBC.DS_ORD_RSN_CD IS NULL
                 )
                 <isNotNull property="dsOrdTpCd">
                 OR
                 (
                  OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                  AND OCBC.DS_ORD_TP_CD  = #dsOrdTpCd#
                  AND OCBC.DS_ORD_RSN_CD IS NULL
                 )
                 </isNotNull>
                 <isNotNull property="dsOrdTpCd">
                     <isNotNull property="dsOrdRsnCd">
                     OR
                     (
                      OCBC.DS_ORD_CATG_CD    = #dsOrdCatgCd#
                      AND OCBC.DS_ORD_TP_CD  = #dsOrdTpCd#
                      AND OCBC.DS_ORD_RSN_CD = #dsOrdRsnCd#
                     )
                     </isNotNull>
                 </isNotNull>
                )
    </statement>

</sqlMap>
