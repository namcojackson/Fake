<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWXC220001QueryForCustomer">

    <statement id="getBillToCustWithDsAcctFromCd" parameterClass="Map" resultClass="Map">
        SELECT
             BTC.BILL_TO_CUST_PK
            ,BTC.BILL_TO_CUST_CD
            ,STC.SELL_TO_CUST_PK
        FROM
            BILL_TO_CUST         BTC
            ,SELL_TO_CUST        STC
        WHERE
            BTC.EZCANCELFLAG            = '0'
            AND BTC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND BTC.EZCANCELFLAG        = STC.EZCANCELFLAG
            AND BTC.GLBL_CMPY_CD        = STC.GLBL_CMPY_CD
            AND BTC.SELL_TO_CUST_CD     = STC.SELL_TO_CUST_CD
            AND BTC.BILL_TO_CUST_CD     = #billToCustCd#

            <isNotNull property="rgtnStsCd">
            AND BTC.RGTN_STS_CD         = STC.RGTN_STS_CD
            AND BTC.RGTN_STS_CD         = #rgtnStsCd#
            </isNotNull>

            <isNotNull property="slsDt">
            AND BTC.EFF_FROM_DT         &lt;= #slsDt#
            AND NVL(BTC.EFF_THRU_DT, '99991231') &gt;= #slsDt#
            AND STC.EFF_FROM_DT         &lt;= #slsDt#
            AND NVL(STC.EFF_THRU_DT, '99991231') &gt;= #slsDt#
            </isNotNull>
    </statement>

    <statement id="getShipToCustWithDsAcctFromCd" parameterClass="Map" resultClass="Map">
        SELECT
             STC.SHIP_TO_CUST_PK
            ,STC.SELL_TO_CUST_CD
            ,SELL.SELL_TO_CUST_PK
            ,CNTY.CNTY_NM
        FROM
            SHIP_TO_CUST         STC
            ,SELL_TO_CUST        SELL
            ,CNTY                CNTY
        WHERE
            STC.EZCANCELFLAG            = '0'
            AND STC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND STC.EZCANCELFLAG        = SELL.EZCANCELFLAG
            AND STC.GLBL_CMPY_CD        = SELL.GLBL_CMPY_CD
            AND STC.SELL_TO_CUST_CD     = SELL.SELL_TO_CUST_CD
            AND STC.EZCANCELFLAG        = CNTY.EZCANCELFLAG(+)
            AND STC.GLBL_CMPY_CD        = CNTY.GLBL_CMPY_CD(+)
            AND STC.CNTY_PK             = CNTY.CNTY_PK(+)
            AND STC.SHIP_TO_CUST_CD     = #shipToCustCd#

            <isNotNull property="rgtnStsCd">
            AND STC.RGTN_STS_CD         = SELL.RGTN_STS_CD
            AND STC.RGTN_STS_CD         = #rgtnStsCd#
            </isNotNull>

            <isNotNull property="slsDt">
            AND STC.EFF_FROM_DT         &lt;= #slsDt#
            AND NVL(STC.EFF_THRU_DT, '99991231') &gt;= #slsDt#
            AND SELL.EFF_FROM_DT         &lt;= #slsDt#
            AND NVL(SELL.EFF_THRU_DT, '99991231') &gt;= #slsDt#
            </isNotNull>

    </statement>
</sqlMap>
