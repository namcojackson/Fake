<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSAB062001">
    <statement id="getProcCnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            SVC_MACH_UPLD_WRK A
        WHERE
            A.GLBL_CMPY_CD     = #glblCmpyCd#
        AND A.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
        AND A.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getInvalidModeData" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            A.UPLD_CSV_RQST_ROW_NUM
        FROM
            SVC_MACH_UPLD_WRK A
        WHERE
            A.GLBL_CMPY_CD     = #glblCmpyCd#
        AND A.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
        <iterate property="procModeCdList" var="procModeCdList[]" open="AND (A.PROC_MODE_CD NOT IN (" close=") OR A.PROC_MODE_CD IS NULL)" conjunction=",">
            #procModeCdList[]#
        </iterate>
        AND A.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getSvcMachMstrForNonConfig" parameterClass="Map" resultClass="Map">
        SELECT
             A.EZTABLEID
            ,A.EZCANCELFLAG
            ,A.EZINTIME
            ,A.EZINTIMEZONE
            ,A.EZINCOMPANYCODE
            ,A.EZINUSERID
            ,A.EZINAPLID
            ,A.EZUPTIME
            ,A.EZUPTIMEZONE
            ,A.EZUPCOMPANYCODE
            ,A.EZUPUSERID
            ,A.EZUPAPLID
            ,A.GLBL_CMPY_CD
            ,A.UPLD_CSV_RQST_PK
            ,A.UPLD_CSV_RQST_ROW_NUM
            ,A.PROC_MODE_CD
            ,A.SVC_MACH_MSTR_PK
            ,A.SER_NUM
            ,A.MDSE_CD
            ,A.SVC_CONFIG_MSTR_PK
            ,A.PRNT_SER_NUM
            ,A.OWNR_ACCT_NUM
            ,A.BILL_TO_ACCT_NUM
            ,A.CUR_LOC_ACCT_NUM
            ,A.IND_BILL_TO_LOC_NUM
            ,A.IND_CUR_LOC_NUM
            ,A.SVC_MACH_MSTR_STS_CD
            ,A.SVC_MACH_USG_STS_CD
            ,A.SVC_MACH_TRX_TP_CD
            ,A.ISTL_DT
            ,A.EFF_FROM_DT
            ,A.EFF_THRU_DT
            ,A.SVC_MACH_RMV_DT
            ,A.CUST_MACH_CTRL_NUM
            ,A.SVC_CMNT_TXT
            ,A.UPLD_CSV_RQST_CMNT_TXT
            <!-- START 2017/07/07 K.Kojima [QC#19660,ADD] -->
            ,A.SVC_BY_LINE_BIZ_TP_CD
            <!-- END 2017/07/07 K.Kojima [QC#19660,ADD] -->
            <!-- START 2018/09/26 M.Naito [QC#28493, ADD] -->
            ,A.PRNT_MDSE_CD
            <!-- END 2018/09/26 M.Naito [QC#28493, ADD] -->
            <!-- START 2023/07/31 S.Moriai [QC#61632,ADD] -->
            ,A.SW_LIC_ID
            <!-- END 2023/07/31 S.Moriai [QC#61632,ADD] -->
            <!-- START 2023/10/03 S.Naya [QC#54186,ADD] -->
            ,A.SVC_PRVD_PTY_DESC_TXT_01
            ,A.SVC_PRVD_PTY_DESC_TXT_02
            <!-- END   2023/10/03 S.Naya [QC#54186,ADD] -->
            <!-- START 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
            ,A.SLD_BY_LINE_BIZ_TP_CD
            ,A.REQ_TECH_CD
            <!-- END 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
        FROM
            (
                SELECT
                     AA.EZTABLEID
                    ,AA.EZCANCELFLAG
                    ,AA.EZINTIME
                    ,AA.EZINTIMEZONE
                    ,AA.EZINCOMPANYCODE
                    ,AA.EZINUSERID
                    ,AA.EZINAPLID
                    ,AA.EZUPTIME
                    ,AA.EZUPTIMEZONE
                    ,AA.EZUPCOMPANYCODE
                    ,AA.EZUPUSERID
                    ,AA.EZUPAPLID
                    ,AA.GLBL_CMPY_CD
                    ,AA.UPLD_CSV_RQST_PK
                    ,AA.UPLD_CSV_RQST_ROW_NUM
                    ,AA.PROC_MODE_CD
                    ,DECODE(AA.SVC_MACH_MSTR_PK, 0, NULL, AA.SVC_MACH_MSTR_PK)     AS SVC_MACH_MSTR_PK
                    ,AA.SER_NUM
                    ,AA.MDSE_CD
                    ,DECODE(AA.SVC_CONFIG_MSTR_PK, 0, NULL, AA.SVC_CONFIG_MSTR_PK) AS SVC_CONFIG_MSTR_PK
                    ,AA.PRNT_SER_NUM
                    ,AA.OWNR_ACCT_NUM
                    ,AA.BILL_TO_ACCT_NUM
                    ,AA.CUR_LOC_ACCT_NUM
                    ,AA.IND_BILL_TO_LOC_NUM
                    ,AA.IND_CUR_LOC_NUM
                    ,AA.SVC_MACH_MSTR_STS_CD
                    ,AA.SVC_MACH_USG_STS_CD
                    ,AA.SVC_MACH_TRX_TP_CD
                    ,AA.ISTL_DT
                    ,AA.EFF_FROM_DT
                    ,AA.EFF_THRU_DT
                    ,AA.SVC_MACH_RMV_DT
                    ,AA.CUST_MACH_CTRL_NUM
                    ,AA.SVC_CMNT_TXT
                    ,AA.UPLD_CSV_RQST_CMNT_TXT
                    <!-- START 2017/07/07 K.Kojima [QC#19660,ADD] -->
                    ,AA.SVC_BY_LINE_BIZ_TP_CD
                    <!-- END 2017/07/07 K.Kojima [QC#19660,ADD] -->
                    <!-- START 2018/09/26 M.Naito [QC#28493, ADD] -->
                    ,AA.PRNT_MDSE_CD
                    <!-- END 2018/09/26 M.Naito [QC#28493, ADD] -->
                    <!-- START 2023/07/31 S.Moriai [QC#61632,ADD] -->
                    ,AA.SW_LIC_ID
                    <!-- END 2023/07/31 S.Moriai [QC#61632,ADD] -->
                    <!-- START 2023/10/03 S.Naya [QC#54186,ADD] -->
                    ,AA.SVC_PRVD_PTY_DESC_TXT_01
                    ,AA.SVC_PRVD_PTY_DESC_TXT_02
                    <!-- END   2023/10/03 S.Naya [QC#54186,ADD] -->
                    <!-- START 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
                    ,AA.SLD_BY_LINE_BIZ_TP_CD
                    ,AA.REQ_TECH_CD
                    <!-- END 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
                FROM
                    SVC_MACH_UPLD_WRK AA
                WHERE
                    AA.GLBL_CMPY_CD     = #glblCmpyCd#
                AND AA.EZCANCELFLAG     = '0'
                AND AA.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
                <iterate property="procModeCdList" var="procModeCdList[]" open=" AND AA.PROC_MODE_CD IN (" close=")" conjunction=",">
                    #procModeCdList[]#
                </iterate>
            ) A
        WHERE
            A.SVC_CONFIG_MSTR_PK IS NULL
        AND A.PRNT_SER_NUM       IS NULL
        ORDER BY
             A.PROC_MODE_CD
            ,A.UPLD_CSV_RQST_ROW_NUM

    </statement>

<!-- START 2017/01/25 K.Kitachi [QC#17198, MOD] -->
    <statement id="getTergetPrntSerNum" parameterClass="Map" resultClass="Map">
<!-- END 2017/01/25 K.Kitachi [QC#17198, MOD] -->
        SELECT DISTINCT
             CASE
                WHEN A.SVC_CONFIG_MSTR_PK IS NOT NULL THEN C.SER_NUM
                ELSE A.PRNT_SER_NUM
             END AS PRNT_SER_NUM
<!-- START 2018/08/22 M.Naito [QC#20733, ADD] -->
            ,CASE
                WHEN A.SVC_CONFIG_MSTR_PK IS NOT NULL THEN C.MDSE_CD
                ELSE A.PRNT_MDSE_CD
             END AS PRNT_MDSE_CD
<!-- START 2018/09/26 M.Naito [QC#28493, DEL] -->
             <!-- ,A.UPLD_CSV_RQST_ROW_NUM AS UPLD_CSV_RQST_ROW_NUM -->
<!-- END 2018/08/22 M.Naito [QC#20733, ADD] -->
<!-- END 2018/09/26 M.Naito [QC#28493, DEL] -->
<!-- START 2017/01/25 K.Kitachi [QC#17198, ADD] -->
            ,TO_NUMBER(A.SVC_CONFIG_MSTR_PK) AS SVC_CONFIG_MSTR_PK
<!-- END 2017/01/25 K.Kitachi [QC#17198, ADD] -->
        FROM
             (
                SELECT
                     AA.GLBL_CMPY_CD
                    ,DECODE(AA.SVC_CONFIG_MSTR_PK, 0, NULL, AA.SVC_CONFIG_MSTR_PK) AS SVC_CONFIG_MSTR_PK
                    ,AA.PRNT_SER_NUM
<!-- START 2018/08/22 M.Naito [QC#20733, ADD] -->
                    ,AA.PRNT_MDSE_CD
<!-- START 2018/09/26 M.Naito [QC#28493, DEL] -->
                    <!-- ,AA.UPLD_CSV_RQST_ROW_NUM -->
<!-- END 2018/09/26 M.Naito [QC#28493, DEL] -->
<!-- END 2018/08/22 M.Naito [QC#20733, ADD] -->
                FROM
                    SVC_MACH_UPLD_WRK AA
                WHERE
                    AA.GLBL_CMPY_CD      =  #glblCmpyCd#
                AND AA.UPLD_CSV_RQST_PK  =  #upldCsvRqstPk#
                <iterate property="procModeCdList" var="procModeCdList[]" open=" AND AA.PROC_MODE_CD IN (" close=")" conjunction=",">
                    #procModeCdList[]#
                </iterate>
                AND AA.EZCANCELFLAG      =  '0'
             ) A
            ,SVC_CONFIG_MSTR   B
            ,SVC_MACH_MSTR     C
        WHERE
            (
                A.SVC_CONFIG_MSTR_PK    IS NOT NULL
            OR A.PRNT_SER_NUM           IS NOT NULL
            )
        AND A.GLBL_CMPY_CD              =  B.GLBL_CMPY_CD       (+)
        AND A.SVC_CONFIG_MSTR_PK        =  B.SVC_CONFIG_MSTR_PK (+)
        AND B.EZCANCELFLAG          (+) =  '0'
        AND B.GLBL_CMPY_CD              =  C.GLBL_CMPY_CD       (+)
        AND B.SVC_MACH_MSTR_PK          =  C.SVC_MACH_MSTR_PK   (+)
        AND C.EZCANCELFLAG          (+) =  '0'

    </statement>

    <statement id="getSvcMachMstrForConfig" parameterClass="Map" resultClass="Map">
        SELECT
             Y.EZTABLEID
            ,Y.EZCANCELFLAG
            ,Y.EZINTIME
            ,Y.EZINTIMEZONE
            ,Y.EZINCOMPANYCODE
            ,Y.EZINUSERID
            ,Y.EZINAPLID
            ,Y.EZUPTIME
            ,Y.EZUPTIMEZONE
            ,Y.EZUPCOMPANYCODE
            ,Y.EZUPUSERID
            ,Y.EZUPAPLID
            ,Y.GLBL_CMPY_CD
            ,Y.UPLD_CSV_RQST_PK
            ,Y.UPLD_CSV_RQST_ROW_NUM
            ,Y.PROC_MODE_CD
            ,DECODE(Y.SVC_MACH_MSTR_PK, 0, NULL, Y.SVC_MACH_MSTR_PK)     AS SVC_MACH_MSTR_PK
            ,Y.SER_NUM
            ,Y.MDSE_CD
            ,DECODE(Y.SVC_CONFIG_MSTR_PK, 0, NULL, Y.SVC_CONFIG_MSTR_PK) AS SVC_CONFIG_MSTR_PK
            ,Y.PRNT_SER_NUM
<!-- START 2018/09/26 M.Naito [QC#28493, ADD] -->
            ,Y.PRNT_MDSE_CD
<!-- END 2018/09/26 M.Naito [QC#28493, ADD] -->
            ,Y.OWNR_ACCT_NUM
            ,Y.BILL_TO_ACCT_NUM
            ,Y.CUR_LOC_ACCT_NUM
            ,Y.IND_BILL_TO_LOC_NUM
            ,Y.IND_CUR_LOC_NUM
            ,Y.SVC_MACH_MSTR_STS_CD
            ,Y.SVC_MACH_USG_STS_CD
            ,Y.SVC_MACH_TRX_TP_CD
            ,Y.ISTL_DT
            ,Y.EFF_FROM_DT
            ,Y.EFF_THRU_DT
            ,Y.SVC_MACH_RMV_DT
            ,Y.CUST_MACH_CTRL_NUM
            ,Y.SVC_CMNT_TXT
            ,Y.UPLD_CSV_RQST_CMNT_TXT
            <!-- START 2017/07/07 K.Kojima [QC#19660,ADD] -->
            ,Y.SVC_BY_LINE_BIZ_TP_CD
            <!-- END 2017/07/07 K.Kojima [QC#19660,ADD] -->
            <!-- START 2023/07/31 S.Moriai [QC#61632,ADD] -->
            ,Y.SW_LIC_ID
            <!-- END 2023/07/31 S.Moriai [QC#61632,ADD] -->
            <!-- START 2023/10/03 S.Naya [QC#54186,ADD] -->
            ,Y.SVC_PRVD_PTY_DESC_TXT_01
            ,Y.SVC_PRVD_PTY_DESC_TXT_02
            <!-- END   2023/10/03 S.Naya [QC#54186,ADD] -->
            <!-- START 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
            ,Y.SLD_BY_LINE_BIZ_TP_CD
            ,Y.REQ_TECH_CD
            <!-- END 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
        FROM
             (
                SELECT
                     A.GLBL_CMPY_CD
                    ,A.UPLD_CSV_RQST_PK
                    ,A.UPLD_CSV_RQST_ROW_NUM
                    ,CASE
                        WHEN A.SVC_CONFIG_MSTR_PK IS NOT NULL THEN C.SER_NUM
                        ELSE A.PRNT_SER_NUM
                     END AS PRNT_SER_NUM
<!-- START 2018/09/26 M.Naito [QC#28493, ADD] -->
                    ,CASE
                        WHEN A.SVC_CONFIG_MSTR_PK IS NOT NULL THEN C.MDSE_CD
                        ELSE A.PRNT_MDSE_CD
                     END AS PRNT_MDSE_CD
<!-- END 2018/09/26 M.Naito [QC#28493, ADD] -->
<!-- START 2017/01/25 K.Kitachi [QC#17198, ADD] -->
                    ,TO_NUMBER(A.SVC_CONFIG_MSTR_PK) AS SVC_CONFIG_MSTR_PK
<!-- END 2017/01/25 K.Kitachi [QC#17198, ADD] -->
                FROM
                     (
                        SELECT
                             AA.GLBL_CMPY_CD
                            ,AA.UPLD_CSV_RQST_PK
                            ,AA.UPLD_CSV_RQST_ROW_NUM
                            ,DECODE(AA.SVC_CONFIG_MSTR_PK, 0, NULL, AA.SVC_CONFIG_MSTR_PK) AS SVC_CONFIG_MSTR_PK
                            ,AA.PRNT_SER_NUM
<!-- START 2018/09/26 M.Naito [QC#28493, ADD] -->
                            ,AA.PRNT_MDSE_CD
<!-- END 2018/09/26 M.Naito [QC#28493, ADD] -->
<!-- START 2023/07/31 S.Moriai [QC#61632,ADD] -->
                            ,AA.SW_LIC_ID
<!-- END 2023/07/31 S.Moriai [QC#61632,ADD] -->
<!-- START 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
                            ,AA.SLD_BY_LINE_BIZ_TP_CD
                            ,AA.REQ_TECH_CD
 <!-- END 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
                        FROM
                            SVC_MACH_UPLD_WRK AA
                        WHERE
                            AA.GLBL_CMPY_CD     =  #glblCmpyCd#
                        AND AA.UPLD_CSV_RQST_PK =  #upldCsvRqstPk#
                        <iterate property="procModeCdList" var="procModeCdList[]" open=" AND AA.PROC_MODE_CD IN (" close=")" conjunction=",">
                            #procModeCdList[]#
                        </iterate>
                        AND AA.EZCANCELFLAG     =  '0'
                     ) A
                    ,SVC_CONFIG_MSTR B
                    ,SVC_MACH_MSTR   C
                WHERE
                    (
                        A.SVC_CONFIG_MSTR_PK    IS NOT NULL
                    OR A.PRNT_SER_NUM           IS NOT NULL
                    )
                AND A.GLBL_CMPY_CD              =  B.GLBL_CMPY_CD       (+)
                AND A.SVC_CONFIG_MSTR_PK        =  B.SVC_CONFIG_MSTR_PK (+)
                AND B.EZCANCELFLAG          (+) =  '0'
                AND B.GLBL_CMPY_CD              =  C.GLBL_CMPY_CD       (+)
                AND B.SVC_MACH_MSTR_PK          =  C.SVC_MACH_MSTR_PK   (+)
                AND C.EZCANCELFLAG          (+) =  '0'
             ) X
            ,SVC_MACH_UPLD_WRK Y
        WHERE
<!-- START 2017/01/25 K.Kitachi [QC#17198, MOD] -->
            X.GLBL_CMPY_CD          = Y.GLBL_CMPY_CD
        AND X.UPLD_CSV_RQST_PK      = Y.UPLD_CSV_RQST_PK
        AND X.UPLD_CSV_RQST_ROW_NUM = Y.UPLD_CSV_RQST_ROW_NUM
        <isNotNull property="prntSerNum">
        AND X.PRNT_SER_NUM          = #prntSerNum#
        </isNotNull>
<!-- START 2018/09/26 M.Naito [QC#28493, ADD] -->
        <isNotNull property="prntMdseCd">
        AND X.PRNT_MDSE_CD          = #prntMdseCd#
        </isNotNull>
<!-- END 2018/09/26 M.Naito [QC#28493, ADD] -->
        <isNotNull property="svcConfigMstrPk">
        AND X.SVC_CONFIG_MSTR_PK    = #svcConfigMstrPk#
        </isNotNull>
        AND Y.EZCANCELFLAG          = '0'
<!-- END 2017/01/25 K.Kitachi [QC#17198, MOD] -->
        ORDER BY
            Y.UPLD_CSV_RQST_ROW_NUM

    </statement>

    <statement id="getSvcMachMstrForTerminate" parameterClass="Map" resultClass="Map">
        SELECT
             A.EZTABLEID
            ,A.EZCANCELFLAG
            ,A.EZINTIME
            ,A.EZINTIMEZONE
            ,A.EZINCOMPANYCODE
            ,A.EZINUSERID
            ,A.EZINAPLID
            ,A.EZUPTIME
            ,A.EZUPTIMEZONE
            ,A.EZUPCOMPANYCODE
            ,A.EZUPUSERID
            ,A.EZUPAPLID
            ,A.GLBL_CMPY_CD
            ,A.UPLD_CSV_RQST_PK
            ,A.UPLD_CSV_RQST_ROW_NUM
            ,A.PROC_MODE_CD
            ,DECODE(A.SVC_MACH_MSTR_PK, 0, NULL, A.SVC_MACH_MSTR_PK)     AS SVC_MACH_MSTR_PK
            ,A.SER_NUM
            ,A.MDSE_CD
            ,DECODE(A.SVC_CONFIG_MSTR_PK, 0, NULL, A.SVC_CONFIG_MSTR_PK) AS SVC_CONFIG_MSTR_PK
            ,A.PRNT_SER_NUM
            ,A.OWNR_ACCT_NUM
            ,A.BILL_TO_ACCT_NUM
            ,A.CUR_LOC_ACCT_NUM
            ,A.IND_BILL_TO_LOC_NUM
            ,A.IND_CUR_LOC_NUM
            ,A.SVC_MACH_MSTR_STS_CD
            ,A.SVC_MACH_USG_STS_CD
            ,A.SVC_MACH_TRX_TP_CD
            ,A.ISTL_DT
            ,A.EFF_FROM_DT
            ,A.EFF_THRU_DT
            ,A.SVC_MACH_RMV_DT
            ,A.CUST_MACH_CTRL_NUM
            ,A.SVC_CMNT_TXT
            ,A.UPLD_CSV_RQST_CMNT_TXT
            <!-- START 2017/07/07 K.Kojima [QC#19660,ADD] -->
            ,A.SVC_BY_LINE_BIZ_TP_CD
            <!-- END 2017/07/07 K.Kojima [QC#19660,ADD] -->
            <!-- START 2018/09/26 M.Naito [QC#28493, ADD] -->
            ,A.PRNT_MDSE_CD
            <!-- END 2018/09/26 M.Naito [QC#28493, ADD] -->
            <!-- START 2023/07/31 S.Moriai [QC#61632,ADD] -->
            ,A.SW_LIC_ID
            <!-- END 2023/07/31 S.Moriai [QC#61632,ADD] -->
            <!-- START 2023/10/03 S.Naya [QC#54186,ADD] -->
            ,A.SVC_PRVD_PTY_DESC_TXT_01
            ,A.SVC_PRVD_PTY_DESC_TXT_02
            <!-- END   2023/10/03 S.Naya [QC#54186,ADD] -->
            <!-- START 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
            ,A.SLD_BY_LINE_BIZ_TP_CD
            ,A.REQ_TECH_CD
            <!-- END 2023/10/06 Y.Nagasawa [QC#60082,ADD] -->
        FROM
            SVC_MACH_UPLD_WRK A
        WHERE
            A.GLBL_CMPY_CD = #glblCmpyCd#
        AND A.EZCANCELFLAG = '0'
        AND A.UPLD_CSV_RQST_PK = #upldCsvRqstPk#
        <iterate property="procModeCdList" var="procModeCdList[]" open=" AND A.PROC_MODE_CD IN (" close=")" conjunction=",">
            #procModeCdList[]#
        </iterate>
        ORDER BY
             A.UPLD_CSV_RQST_ROW_NUM

    </statement>

    <statement id="getDsContrDtlCtrlSts" parameterClass="Map" resultClass="Map">
        SELECT
             A.DS_CONTR_CTRL_STS_CD
            ,B.DS_CONTR_NUM
        FROM
             DS_CONTR_DTL_STS_V A
            ,DS_CONTR           B
        WHERE
            A.GLBL_CMPY_CD      = #glblCmpyCd#
        AND A.EZCANCELFLAG      = '0'
        AND A.DS_CONTR_DTL_PK   = #dsContrDtlPk#
        AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD
        AND A.DS_CONTR_PK       = B.DS_CONTR_PK
        AND B.EZCANCELFLAG      = '0'
    </statement>

    <statement id="getOpenOrder" parameterClass="Map" resultClass="String">
        SELECT
            B.CPO_ORD_NUM
        FROM
            SVC_MACH_MSTR A
            ,CPO_DTL B
        WHERE
            A.GLBL_CMPY_CD          = #glblCmpyCd#
        AND A.EZCANCELFLAG          = '0'
        AND A.SVC_MACH_MSTR_PK      = #svcMachMstrPk#
        AND A.GLBL_CMPY_CD          = B.GLBL_CMPY_CD
        AND B.EZCANCELFLAG          = '0'
        AND A.CPO_ORD_NUM           = B.CPO_ORD_NUM
        AND A.CPO_DTL_LINE_NUM      = B.CPO_DTL_LINE_NUM
        AND A.CPO_DTL_LINE_SUB_NUM  = B.CPO_DTL_LINE_SUB_NUM
        AND B.ORD_LINE_STS_CD       NOT IN (#closed#, #cancelled#)

    </statement>

    <statement id="countRtlSWH" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            RTL_SWH RS
        WHERE
                RS.GLBL_CMPY_CD                  = #glblCmpyCd#
            AND RS.INVTY_LOC_CD                  = #invtyLocCd#
            AND RS.RTL_SWH_DSBL_FLG              = 'N'
            AND RS.EFF_FROM_DT               &lt;= #slsDt#
            AND NVL(RS.EFF_THRU_DT, #endDt#) &gt;= #slsDt#
            AND RS.EZCANCELFLAG                  = '0'
            AND ROWNUM                           = 1
    </statement>

    <!-- START 2017/07/07 K.Kojima [QC#19660,ADD] -->
    <statement id="countSvcLineBiz" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
             LINE_BIZ_TP          A
            ,AVAL_LINE_BIZ_TP_SRC B
        WHERE
                A.GLBL_CMPY_CD         = #glblCmpyCd#
            AND A.LINE_BIZ_TP_CD       = #lineBizTpCd#
            AND A.EZCANCELFLAG         = '0'
            AND A.GLBL_CMPY_CD         = B.GLBL_CMPY_CD
            AND A.LINE_BIZ_TP_CD       = B.LINE_BIZ_TP_CD
            AND B.SYS_SRC_CD           = #sysSrcCd#
            AND B.EZCANCELFLAG         = '0'
        ORDER BY
            A.LINE_BIZ_TP_SORT_NUM
    </statement>
    <!-- END 2017/07/07 K.Kojima [QC#19660,ADD] -->

    <!-- START 2018/01/18 M.Kidokoro [QC#21962, ADD] -->
    <statement id="getSvcIstlReqFlg" parameterClass="Map" resultClass="String">
        SELECT
            C.SVC_ISTL_REQ_FLG
        FROM
            SVC_MACH_MSTR   A
           ,SVC_CONFIG_MSTR B
           ,DS_MDL          C
        WHERE
            A.GLBL_CMPY_CD       = #glblCmpyCd#
        AND A.SVC_MACH_MSTR_PK   = #svcMachMstrPk#
        AND A.EZCANCELFLAG       = '0'
        AND A.GLBL_CMPY_CD       = B.GLBL_CMPY_CD
        AND A.SVC_CONFIG_MSTR_PK = B.SVC_CONFIG_MSTR_PK
        AND B.EZCANCELFLAG       = '0'
        AND B.GLBL_CMPY_CD       = C.GLBL_CMPY_CD
        AND B.MDL_ID             = C.MDL_ID
        AND C.EZCANCELFLAG       = '0'
    </statement>
    <!-- END 2018/01/18 M.Kidokoro [QC#21962, ADD] -->

    <!-- START 2018/05/28 K.Kitachi [QC#19932, ADD] -->
    <statement id="getSvcMachMstrQty" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            NVL(SUM(A.SVC_MACH_QTY), 0)
        FROM
            SVC_MACH_MSTR A
        WHERE
                A.GLBL_CMPY_CD             = #glblCmpyCd#
            <isNotNull property="serNum">
            AND A.SER_NUM                  = #serNum#
            </isNotNull>
            AND A.MDSE_CD                  = #mdseCd#
            AND A.IND_CUR_LOC_NUM          = #invtyLocCd#
            AND A.SVC_MACH_MSTR_LOC_STS_CD = #locStsCd#
            AND A.STK_STS_CD               = #stkStsCd#
            <iterate property="svcMachMstrStsCdList" var="svcMachMstrStsCd[]" open="AND A.SVC_MACH_MSTR_STS_CD IN (" close=")" conjunction=",">
                #svcMachMstrStsCd[]#
            </iterate>
            AND A.EZCANCELFLAG             = '0'
    </statement>
    <statement id="getInvtyDtlDlyQty" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            NVL(SUM(A.INVTY_QTY), 0)
        FROM
            INVTY_DTL_DLY A
        WHERE
                A.GLBL_CMPY_CD = #glblCmpyCd#
            <isNotNull property="serNum">
            AND A.SER_NUM      = #serNum#
            </isNotNull>
            AND A.MDSE_CD      = #mdseCd#
            AND A.INVTY_LOC_CD = #invtyLocCd#
            AND A.LOC_STS_CD   = #locStsCd#
            AND A.STK_STS_CD   = #stkStsCd#
            AND A.EZCANCELFLAG = '0'
    </statement>
    <!-- END 2018/05/28 K.Kitachi [QC#19932, ADD] -->
    <!-- START 2018/06/14 T.Tomita [QC#23428, ADD] -->
    <statement id="cntExchOrd" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
             SVC_MACH_MSTR     A
            ,CPO               B
            ,DS_ORD_TP         C
            ,ORD_CATG_BIZ_CTX  D
        WHERE
            A.GLBL_CMPY_CD       =  #glblCmpyCd#
        AND A.EZCANCELFLAG       =  '0'
        AND A.SVC_MACH_MSTR_PK   =  #svcMachMstrPk#
        AND A.GLBL_CMPY_CD       =  B.GLBL_CMPY_CD
        AND A.CPO_ORD_NUM        =  B.CPO_ORD_NUM
        AND B.EZCANCELFLAG       =  '0'
        <iterate property="ordHdrStsCdList" var="ordHdrStsCd[]" open="AND B.ORD_HDR_STS_CD NOT IN (" close=")" conjunction=",">
            #ordHdrStsCd[]#
        </iterate>
        AND B.GLBL_CMPY_CD       =  C.GLBL_CMPY_CD
        AND B.DS_ORD_TP_CD       =  C.DS_ORD_TP_CD
        AND C.EZCANCELFLAG       =  '0'
        AND C.GLBL_CMPY_CD       =  D.GLBL_CMPY_CD
        AND C.DS_ORD_CATG_CD     =  D.DS_ORD_CATG_CD
    <!-- START 2019/06/17 W.Honda [QC#50842, ADD] -->
        AND (C.DS_ORD_TP_CD      =  D.DS_ORD_TP_CD
            OR  D.DS_ORD_TP_CD   IS  NULL)
    <!-- END 2019/06/17 W.Honda [QC#50842, ADD] -->
        AND D.EZCANCELFLAG       =  '0'
        AND D.ORD_CATG_CTX_TP_CD =  #ordCatgCtxTpCd#
        AND NOT EXISTS (
            SELECT
                *
            FROM
                DS_CONTR_INTFC Z
            WHERE
                Z.GLBL_CMPY_CD           =  A.GLBL_CMPY_CD
            AND Z.SVC_MACH_MSTR_PK       =  A.SVC_MACH_MSTR_PK
            AND Z.EZCANCELFLAG           =  '0'
            AND Z.CONTR_INTFC_SRC_TP_CD  =  #contrIntfcSrcTpCd#
            AND Z.DS_CONTR_INTFC_ACT_CD  =  #dsContrIntfcActCd#
            )
    </statement>
    <!-- END 2018/06/14 T.Tomita [QC#23428, ADD] -->
    <!-- START 2023/10/03 S.Naya [QC#54186,ADD] -->
    <statement id="countSvcPrvdPty" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)
        FROM
            SVC_PRVD_PTY SPP
        WHERE
                SPP.GLBL_CMPY_CD          = #glblCmpyCd#
            AND SPP.EZCANCELFLAG          = '0'
            <isNotNull property="svcPrvdPtyCd">
            AND SPP.SVC_PRVD_PTY_CD       = #svcPrvdPtyCd#
            </isNotNull>
            <isNotNull property="svcPrvdPtyDescTxt">
            AND SPP.SVC_PRVD_PTY_DESC_TXT = #svcPrvdPtyDescTxt#
            </isNotNull>
        ORDER BY
            SPP.SVC_PRVD_PTY_SORT_NUM
    </statement>
    <statement id="getSvdPrvdPtyCdAndDescTxt" parameterClass="Map" resultClass="Map">
        SELECT
             SPP.SVC_PRVD_PTY_CD
            ,SPP.SVC_PRVD_PTY_DESC_TXT
        FROM
            SVC_PRVD_PTY SPP
        WHERE
                SPP.GLBL_CMPY_CD          = #glblCmpyCd#
            AND SPP.EZCANCELFLAG          = '0'
            <isNotNull property="svcPrvdPtyCd">
            AND SPP.SVC_PRVD_PTY_CD       = #svcPrvdPtyCd#
            </isNotNull>
            <isNotNull property="svcPrvdPtyDescTxt">
            AND SPP.SVC_PRVD_PTY_DESC_TXT = #svcPrvdPtyDescTxt#
            </isNotNull>
        ORDER BY
            SPP.SVC_PRVD_PTY_SORT_NUM
    </statement>
    <!-- END   2023/10/03 S.Naya [QC#54186,ADD] -->
    <!-- START 2023/12/19 T.Fukuta [CSA-QC#61841,ADD] -->
    <statement id="countLocStsMndFlgByStsCd" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*) COUNT
        FROM
            SVC_MACH_MSTR_STS A
        WHERE
                A.GLBL_CMPY_CD         = #glblCmpyCd#
            AND A.EZCANCELFLAG         = '0'
            AND A.LOC_STS_MND_FLG      = #locStsMndFlg#
            AND A.SVC_MACH_MSTR_STS_CD = #svcMachMstrStsCd#
    </statement>
    <!-- END 2023/12/19 T.Fukuta [CSA-QC#61841,ADD] -->
</sqlMap>
