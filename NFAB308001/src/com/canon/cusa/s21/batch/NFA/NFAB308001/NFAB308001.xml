<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NFAB308001">

<typeAlias alias="BDG_VRSNTMsg"	type="business.db.BDG_VRSNTMsg"/>

<statement id="getNewBdgVrsn" parameterClass="Map" resultMap="result.bdgVrsn">
    SELECT
         #glblCmpyCd#               AS GLBL_CMPY_CD
        ,IF.BDG_YR_MTH_PER_TXT
        ,IF.BDG_SCN_NM
        ,IF.COA_ID
        ,IF.BDG_SCN_OPEN_DT
        ,IF.COA_CMPY_CD
        ,IF.COA_BR_CD
        ,IF.COA_CC_CD
        ,IF.COA_ACCT_CD
        ,IF.COA_PROD_CD
        ,IF.COA_CH_CD
        ,IF.COA_AFFL_CD
        ,IF.COA_PROJ_CD
        ,IF.COA_EXTN_CD
        ,IF.BDG_VRSN_AMT
        ,BV.BDG_YR_MTH_PER_TXT      AS BV_BDG_YR_MTH_PER_TXT
        ,BV.BDG_SCN_NM              AS BV_BDG_SCN_NM
        ,BV.COA_ID                  AS BV_COA_ID
        ,'N'                        AS BV_STS_CD
    FROM
         NFAI3080_01    IF
        ,BDG_VRSN       BV
    WHERE
            IF.INTERFACE_ID             = #interfaceId#
        AND IF.TRANSACTION_ID           = #transactionId#
        AND IF.BDG_ACT_XTRNL_NM         = #insert#
        AND #glblCmpyCd#                = BV.GLBL_CMPY_CD(+)
        AND IF.BDG_YR_MTH_PER_TXT       = BV.BDG_YR_MTH_PER_TXT(+)
        AND IF.BDG_SCN_NM               = BV.BDG_SCN_NM(+)
        AND IF.COA_ID                   = BV.COA_ID(+)
        AND BV.COA_ID                   IS NULL
    ORDER BY
         BDG_ACT_XTRNL_NM       ASC
        ,BDG_YR_MTH_PER_TXT     ASC
        ,BDG_SCN_NM             ASC
        ,COA_ID                 ASC
</statement>

<statement id="getReactivateBdgVrsn" parameterClass="Map" resultMap="result.bdgVrsn">
    SELECT
         #glblCmpyCd#               AS GLBL_CMPY_CD
        ,IF.BDG_YR_MTH_PER_TXT
        ,IF.BDG_SCN_NM
        ,IF.COA_ID
        ,IF.BDG_SCN_OPEN_DT
        ,IF.COA_CMPY_CD
        ,IF.COA_BR_CD
        ,IF.COA_CC_CD
        ,IF.COA_ACCT_CD
        ,IF.COA_PROD_CD
        ,IF.COA_CH_CD
        ,IF.COA_AFFL_CD
        ,IF.COA_PROJ_CD
        ,IF.COA_EXTN_CD
        ,IF.BDG_VRSN_AMT
        ,BV.BDG_YR_MTH_PER_TXT      AS BV_BDG_YR_MTH_PER_TXT
        ,BV.BDG_SCN_NM              AS BV_BDG_SCN_NM
        ,BV.COA_ID                  AS BV_COA_ID
        ,'Y'                        AS BV_STS_CD
    FROM
         NFAI3080_01    IF
        ,BDG_VRSN       BV
    WHERE
            IF.INTERFACE_ID             = #interfaceId#
        AND IF.TRANSACTION_ID           = #transactionId#
        AND IF.BDG_ACT_XTRNL_NM         = #insert#
        AND #glblCmpyCd#                = BV.GLBL_CMPY_CD
        AND IF.BDG_YR_MTH_PER_TXT       = BV.BDG_YR_MTH_PER_TXT
        AND IF.BDG_SCN_NM               = BV.BDG_SCN_NM
        AND IF.COA_ID                   = BV.COA_ID
        AND '1'                         = BV.EZCANCELFLAG
    ORDER BY
         BDG_ACT_XTRNL_NM       ASC
        ,BDG_YR_MTH_PER_TXT     ASC
        ,BDG_SCN_NM             ASC
        ,COA_ID                 ASC
</statement>

<statement id="getUpdatedBdgVrsn" parameterClass="Map" resultMap="result.bdgVrsn">
    SELECT
         #glblCmpyCd#               AS GLBL_CMPY_CD
        ,IF.BDG_YR_MTH_PER_TXT
        ,IF.BDG_SCN_NM
        ,IF.COA_ID
        ,IF.BDG_ACT_XTRNL_NM
        ,IF.BDG_SCN_OPEN_DT
        ,IF.COA_CMPY_CD
        ,IF.COA_BR_CD
        ,IF.COA_CC_CD
        ,IF.COA_ACCT_CD
        ,IF.COA_PROD_CD
        ,IF.COA_CH_CD
        ,IF.COA_AFFL_CD
        ,IF.COA_PROJ_CD
        ,IF.COA_EXTN_CD
        ,IF.BDG_VRSN_AMT
    FROM
        NFAI3080_01     IF
    WHERE
            IF.INTERFACE_ID             = #interfaceId#
        AND IF.TRANSACTION_ID           = #transactionId#
        AND IF.BDG_ACT_XTRNL_NM         = #upd#
</statement>

<statement id="getDelBdgVrsn" parameterClass="Map" resultMap="result.bdgVrsn">
    SELECT
         #glblCmpyCd#               AS GLBL_CMPY_CD
        ,IF.BDG_YR_MTH_PER_TXT
        ,IF.BDG_SCN_NM
        ,IF.COA_ID
        ,IF.BDG_ACT_XTRNL_NM
        ,IF.BDG_SCN_OPEN_DT
        ,IF.COA_CMPY_CD
        ,IF.COA_BR_CD
        ,IF.COA_CC_CD
        ,IF.COA_ACCT_CD
        ,IF.COA_PROD_CD
        ,IF.COA_CH_CD
        ,IF.COA_AFFL_CD
        ,IF.COA_PROJ_CD
        ,IF.COA_EXTN_CD
        ,IF.BDG_VRSN_AMT
    FROM
        NFAI3080_01     IF
    WHERE
            IF.INTERFACE_ID             = #interfaceId#
        AND IF.TRANSACTION_ID           = #transactionId#
        AND IF.BDG_ACT_XTRNL_NM         = #del#
</statement>

<resultMap id="result.bdgVrsn" class="BDG_VRSNTMsg">
    <result property="glblCmpyCd"                       column="GLBL_CMPY_CD"                       javaType="EZDSStringItem"/>
    <result property="bdgYrMthPerTxt"                   column="BDG_YR_MTH_PER_TXT"                 javaType="EZDSStringItem"/>
    <result property="bdgScnNm"                         column="BDG_SCN_NM"                         javaType="EZDSStringItem"/>
    <result property="coaId"                            column="COA_ID"                             javaType="EZDSBigDecimalItem"/>
    <result property="bdgScnOpenDt"                     column="BDG_SCN_OPEN_DT"                    javaType="EZDSStringItem"/>
    <result property="coaCmpyCd"                        column="COA_CMPY_CD"                        javaType="EZDSStringItem"/>
    <result property="coaBrCd"                          column="COA_BR_CD"                          javaType="EZDSStringItem"/>
    <result property="coaCcCd"                          column="COA_CC_CD"                          javaType="EZDSStringItem"/>
    <result property="coaAcctCd"                        column="COA_ACCT_CD"                        javaType="EZDSStringItem"/>
    <result property="coaProdCd"                        column="COA_PROD_CD"                        javaType="EZDSStringItem"/>
    <result property="coaChCd"                          column="COA_CH_CD"                          javaType="EZDSStringItem"/>
    <result property="coaAfflCd"                        column="COA_AFFL_CD"                        javaType="EZDSStringItem"/>
    <result property="coaProjCd"                        column="COA_PROJ_CD"                        javaType="EZDSStringItem"/>
    <result property="coaExtnCd"                        column="COA_EXTN_CD"                        javaType="EZDSStringItem"/>
    <result property="bdgVrsnAmt"                       column="BDG_VRSN_AMT"                       javaType="EZDSBigDecimalItem"/>
</resultMap>

</sqlMap>