<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NPAB158001">
    <!-- 08/08/2017 CITS S.Endo Mod Sol#035(QC#18108) START-->
    <statement id="getOrderInfo" parameterClass="Map" resultClass="Map">
        SELECT
             MAIN.GLBL_CMPY_CD
            ,MAIN.ORDER_TYPE
            ,MAIN.SHPG_PLN_NUM
            ,MAIN.CPO_ORD_NUM
            ,MAIN.CPO_DTL_LINE_NUM
            ,MAIN.CPO_DTL_LINE_SUB_NUM
            ,MAIN.PRNT_CMPY_SET_MDSE_FLG
            ,MAIN.CUST_ISS_PO_NUM
            ,MAIN.CUST_ISS_PO_DT
            ,MAIN.CPO_ORD_TP_CD
            ,MAIN.PRCH_REQ_APVL_STS_CD
            ,MAIN.ADMIN_PSN_CD
            ,MAIN.RDD_DT CPO_RDD_DT
            ,MAIN.VND_INVTY_LOC_CD
            ,MAIN.RTL_WH_CD
            ,MAIN.RTL_SWH_CD
            ,MAIN.SHIP_TO_CUST_CD
            ,MAIN.SHIP_TO_LOC_NM
            ,MAIN.SHIP_TO_ADDL_LOC_NM
            ,MAIN.SHIP_TO_FIRST_LINE_ADDR
            ,MAIN.SHIP_TO_SCD_LINE_ADDR
            ,MAIN.SHIP_TO_THIRD_LINE_ADDR
            ,MAIN.SHIP_TO_FRTH_LINE_ADDR
            ,MAIN.SHIP_TO_FIRST_REF_CMNT_TXT
            ,MAIN.SHIP_TO_SCD_REF_CMNT_TXT
            ,MAIN.SHIP_TO_CTY_ADDR
            ,MAIN.SHIP_TO_ST_CD
            ,MAIN.SHIP_TO_PROV_ADDR
            ,MAIN.SHIP_TO_CNTY_NM
            ,MAIN.SHIP_TO_POST_CD
            ,MAIN.SHIP_TO_CTRY_CD
            ,MAIN.BILL_TO_CUST_CD
            ,MAIN.SELL_TO_CUST_CD
            ,MAIN.RDD_DT
            ,MAIN.PRCH_GRP_CD
            ,MAIN.MDSE_CD
            ,MAIN.SET_MDSE_CD
            ,MAIN.ORD_QTY
            ,MAIN.CUST_UOM_CD
            ,MAIN.REQ_FRT_CHRG_TO_CD
            ,MAIN.REQ_FRT_CHRG_METH_CD
            ,MAIN.REQ_SHPG_SVC_LVL_CD
            ,MAIN.RQST_CARR_CD
            ,MAIN.CARR_ACCT_NUM
            ,MAIN.DELY_ADDL_CMNT_TXT
            ,MAIN.VND_DROP_SHIP_FLG
            ,MAIN.LINE_BIZ_TP_CD
            ,MAIN.FRT_COND_CD
            ,MAIN.DS_ORD_LINE_CATG_CD
            ,MAIN.SER_NUM
            ,MAIN.DS_CPO_CONFIG_PK
            ,MAIN.SPCL_HDLG_TP_DESC_TXT
            ,MAIN.ITT_DROP_SHIP_FLG
            ,MAIN.SELL_TO_FIRST_REF_CMNT_TXT
        FROM(
            SELECT
                 #ORDER_TYPE_DS# ORDER_TYPE
                ,SHPG.GLBL_CMPY_CD
                ,SHPG.SHPG_PLN_NUM
                ,CPO.CPO_ORD_NUM
                ,CPOD.CPO_DTL_LINE_NUM
                ,CPOD.CPO_DTL_LINE_SUB_NUM
                ,MDSE2.PRNT_CMPY_SET_MDSE_FLG
                ,CPO.CUST_ISS_PO_NUM
                ,CPO.CUST_ISS_PO_DT
                ,CPOD.CPO_ORD_TP_CD
                ,#SUBMIT_FOR_APPROVAL#       PRCH_REQ_APVL_STS_CD
                ,CPO.ADMIN_PSN_CD
                ,CPOD.RDD_DT CPO_RDD_DT
                ,NULL        VND_INVTY_LOC_CD
                ,CPOD.RTL_WH_CD
                ,CPOD.RTL_SWH_CD
                ,SHPG.SHIP_TO_CUST_CD
                ,SHPG.SHIP_TO_LOC_NM
                ,SHPG.SHIP_TO_ADDL_LOC_NM
                ,SHPG.SHIP_TO_FIRST_LINE_ADDR
                ,SHPG.SHIP_TO_SCD_LINE_ADDR
                ,SHPG.SHIP_TO_THIRD_LINE_ADDR
                ,SHPG.SHIP_TO_FRTH_LINE_ADDR
                ,SHPG.SHIP_TO_FIRST_REF_CMNT_TXT
                ,SHPG.SHIP_TO_SCD_REF_CMNT_TXT
                ,SHPG.SHIP_TO_CTY_ADDR
                ,SHPG.SHIP_TO_ST_CD
                ,SHPG.SHIP_TO_PROV_ADDR
                ,SHPG.SHIP_TO_CNTY_NM
                ,SHPG.SHIP_TO_POST_CD
                ,SHPG.SHIP_TO_CTRY_CD
                ,SHPG.BILL_TO_CUST_CD
                ,SHPG.SELL_TO_CUST_CD
                ,SHPG.RDD_DT
                ,MDSE1.PRCH_GRP_CD
                ,SHPG.MDSE_CD
                ,SHPG.SET_MDSE_CD
                ,SHPG.ORD_QTY
                ,SHPG.CUST_UOM_CD
                ,SHPG.REQ_FRT_CHRG_TO_CD
                ,SHPG.REQ_FRT_CHRG_METH_CD
                ,SHPG.REQ_SHPG_SVC_LVL_CD
                ,SHPG.RQST_CARR_CD
                ,SHPG.CARR_ACCT_NUM
                ,(CASE WHEN DEL1.DELY_ADDL_CMNT_TXT IS NULL THEN DEL2.DELY_ADDL_CMNT_TXT ELSE DEL1.DELY_ADDL_CMNT_TXT END) DELY_ADDL_CMNT_TXT
                ,#flgony#                    VND_DROP_SHIP_FLG
                ,DOTP.LINE_BIZ_TP_CD
                ,CPO.FRT_COND_CD
                ,CPOD.DS_ORD_LINE_CATG_CD
                ,CPOD.SER_NUM
                ,DCPC.DS_CPO_CONFIG_PK
                ,SHT.SPCL_HDLG_TP_DESC_TXT
                <!-- Start QC#21006 Add -->
                ,OLS.ITT_DROP_SHIP_FLG
                <!-- End QC#21006 Add -->
                <!-- START 2017/10/16 S.Katsuma [Sol#454,ADD] -->
                ,CPO.SELL_TO_FIRST_REF_CMNT_TXT
                <!-- END 2017/10/16 S.Katsuma [Sol#454,ADD] -->
            FROM
                 SHPG_PLN           SHPG
                ,CPO                CPO
                ,CPO_DTL            CPOD
                ,DS_CPO_CONFIG      DCPC
                ,MDSE               MDSE
                ,MDSE               MDSE1
                ,MDSE               MDSE2
                ,DS_CPO_DELY_INFO   DEL1
                ,DS_CPO_DELY_INFO   DEL2
                ,DS_ORD_TP_PROC_DFN DOTP
                ,SPCL_HDLG_TP       SHT
                <!-- Start QC#21006 Add -->
                ,ORD_LINE_SRC       OLS
                <!-- End QC#21006 Add -->
            WHERE
                 SHPG.GLBL_CMPY_CD                   = #GLBL_CMPY_CD#
            AND  SHPG.EZCANCELFLAG                   = '0'
            AND  SHPG.AVAL_PO_QTY                    &gt; 0
            AND  SHPG.PO_REQ_FLG                     = #flgony#
            AND  SHPG.SO_CLOSE_FLG                   = #flgoffn#
            AND  SHPG.RTE_STS_CD                     = #RTE_STS_CD#
            AND  SHPG.SHPG_STS_CD                    = #SHPG_STS_CD#
            AND  (
                    (
                        NOT EXISTS
                        (
	                         SELECT 
	                            1
	                        FROM
	                            PRCH_REQ_INTFC REQI
	                         WHERE
	                               SHPG.GLBL_CMPY_CD         = REQI.GLBL_CMPY_CD
	                         AND   SHPG.SHPG_PLN_NUM         = REQI.SHPG_PLN_NUM
	                         AND   REQI.EZCANCELFLAG         = '0'
                        )
                        OR EXISTS
                        (
                         SELECT 
                            1
                        FROM
                            PRCH_REQ_INTFC REQI
                         WHERE
                               SHPG.GLBL_CMPY_CD         = REQI.GLBL_CMPY_CD
                         AND   SHPG.SHPG_PLN_NUM         = REQI.SHPG_PLN_NUM
                         AND   SHPG.ORD_QTY             != REQI.ORD_QTY
                         AND   CPOD.ORD_LINE_DPLY_STS_CD = #ordLineDplyStsCd510#
                         AND   REQI.EZCANCELFLAG         = '0'
                         AND   NOT EXISTS(
                               SELECT
                                   1
                               FROM
                                   PRCH_REQ_INTFC REQI2
                               WHERE   
                                   SHPG.GLBL_CMPY_CD         = REQI2.GLBL_CMPY_CD
                               AND SHPG.SHPG_PLN_NUM         = REQI2.SHPG_PLN_NUM
                               AND SHPG.ORD_QTY              = REQI2.ORD_QTY
                         )
                        )
                    )
                OR (
                    NOT EXISTS
                    (
                        SELECT
                            REQI.SHPG_PLN_NUM
                        FROM
                             PRCH_REQ_INTFC REQI
                            ,PRCH_REQ       PR
                            ,PRCH_REQ_DTL   PRD
                            ,PO_DTL         PD
                        WHERE
                            SHPG.GLBL_CMPY_CD            = REQI.GLBL_CMPY_CD
                        AND SHPG.SHPG_PLN_NUM            = REQI.SHPG_PLN_NUM
                        AND REQI.EZCANCELFLAG            = '0'
                        AND REQI.GLBL_CMPY_CD            = PR.GLBL_CMPY_CD
                        AND REQI.PRCH_REQ_NUM            = PR.PRCH_REQ_NUM
                        AND PR.EZCANCELFLAG              = '0'
                        AND PR.GLBL_CMPY_CD              = PRD.GLBL_CMPY_CD
                        AND PR.PRCH_REQ_NUM              = PRD.PRCH_REQ_NUM
                        AND PRD.EZCANCELFLAG             = '0'
                        AND PRD.GLBL_CMPY_CD             = PD.GLBL_CMPY_CD
                        AND PRD.PO_ORD_NUM               = PD.PO_ORD_NUM
                        AND SHPG.SHPG_PLN_NUM            = PD.SHPG_PLN_NUM
                        AND PD.PO_LINE_STS_CD NOT IN (#poLineStsCdCancel#, #poLineStsCdClose#)
                        AND PD.EZCANCELFLAG             = '0'
                    )
                  AND NOT EXISTS
                     (
                       SELECT
                           1
                       FROM
                            PRCH_REQ_INTFC    REQI
                       WHERE
                             SHPG.GLBL_CMPY_CD         = REQI.GLBL_CMPY_CD
                       AND   SHPG.SHPG_PLN_NUM         = REQI.SHPG_PLN_NUM
                       AND   REQI.PRCH_REQ_NUM         IS NULL
                       AND   REQI.EZCANCELFLAG         = '0'
                    )
                AND NOT EXISTS
                     (
                       SELECT /*+ USE_NL(REQI PR REQD) LEADING(REQI PR REQD) INDEX(REQI PRCH_REQ_INTFC_I1) INDEX(PR PRCH_REQ_PK) INDEX(REQD PRCH_REQ_DTL_PK) */
                           1
                       FROM
                            PRCH_REQ_INTFC    REQI
                           ,PRCH_REQ          PR
                           ,PRCH_REQ_DTL      REQD
                           ,PRCH_REQ_LINE_STS REQL
                       WHERE
                             SHPG.GLBL_CMPY_CD         = REQI.GLBL_CMPY_CD
                       AND   SHPG.SHPG_PLN_NUM         = REQI.SHPG_PLN_NUM
                       AND   REQI.GLBL_CMPY_CD         = PR.GLBL_CMPY_CD
                       AND   REQI.PRCH_REQ_NUM         = PR.PRCH_REQ_NUM
                       AND   PR.GLBL_CMPY_CD           = REQD.GLBL_CMPY_CD
                       AND   PR.PRCH_REQ_NUM           = REQD.PRCH_REQ_NUM
                       AND   REQD.GLBL_CMPY_CD         = REQL.GLBL_CMPY_CD
                       AND   REQD.PRCH_REQ_LINE_STS_CD = REQL.PRCH_REQ_LINE_STS_CD
                       AND   REQL.OPEN_STS_FLG         = #flgony#
                       AND   REQI.EZCANCELFLAG         = '0'
                       AND   REQD.EZCANCELFLAG         = '0'
                       AND   REQL.EZCANCELFLAG         = '0'
                       AND   PR.EZCANCELFLAG           = '0'
                    )
                   )
                 )
            AND  SHPG.GLBL_CMPY_CD                   = CPO.GLBL_CMPY_CD
            AND  SHPG.TRX_HDR_NUM                    = CPO.CPO_ORD_NUM
            AND  CPO.EZCANCELFLAG                    = '0'
            AND  SHPG.GLBL_CMPY_CD                   = CPOD.GLBL_CMPY_CD
            AND  CPO.CPO_ORD_NUM                     = CPOD.CPO_ORD_NUM
            AND  SHPG.TRX_LINE_NUM                   = CPOD.CPO_DTL_LINE_NUM
            AND  SHPG.TRX_LINE_SUB_NUM               = CPOD.CPO_DTL_LINE_SUB_NUM
            AND  CPOD.EZCANCELFLAG                   = '0'
            <!-- QC#21006 Delate
            AND  EXISTS (SELECT 1
                         FROM   ORD_LINE_SRC OLS
                         WHERE  OLS.GLBL_CMPY_CD = CPOD.GLBL_CMPY_CD
                         AND    OLS.ORD_LINE_SRC_CD = CPOD.ORD_LINE_SRC_CD
                         AND    OLS.ITT_DROP_SHIP_FLG = #flgoffn#
                         AND    OLS.EZCANCELFLAG = 0)
            -->
            AND  CPOD.GLBL_CMPY_CD                   = DCPC.GLBL_CMPY_CD
            AND  CPOD.DS_CPO_CONFIG_PK               = DCPC.DS_CPO_CONFIG_PK
            AND  DCPC.EZCANCELFLAG                   = '0'
            AND  SHPG.GLBL_CMPY_CD                   = MDSE.GLBL_CMPY_CD
            AND  SHPG.MDSE_CD                        = MDSE.MDSE_CD
            AND  MDSE.MDSE_TP_CD                     != #MDSE_TP_CD#
            AND  MDSE.EZCANCELFLAG                   = '0'
            AND  SHPG.GLBL_CMPY_CD                   = MDSE1.GLBL_CMPY_CD
            AND  SHPG.MDSE_CD                        = MDSE1.MDSE_CD
            AND  MDSE1.PRNT_CMPY_SET_MDSE_FLG        = #flgoffn#
            AND  MDSE1.EZCANCELFLAG                  = '0'
            AND  SHPG.GLBL_CMPY_CD                   = MDSE2.GLBL_CMPY_CD(+)
            AND  SHPG.SET_MDSE_CD                    = MDSE2.MDSE_CD(+)
            AND  MDSE2.EZCANCELFLAG(+)               = '0'
            AND  DCPC.GLBL_CMPY_CD                   = DEL1.GLBL_CMPY_CD(+)
            AND  DCPC.CPO_ORD_NUM                    = DEL1.CPO_ORD_NUM(+)
            AND  DCPC.DS_CPO_CONFIG_PK               = DEL1.DS_CPO_CONFIG_PK(+)
            AND  DEL1.EZCANCELFLAG(+)                = '0'
            AND  DCPC.GLBL_CMPY_CD                   = DEL2.GLBL_CMPY_CD(+)
            AND  DCPC.CPO_ORD_NUM                    = DEL2.CPO_ORD_NUM(+)
            AND  DEL2.DS_CPO_CONFIG_PK(+)            IS NULL
            AND  DEL2.EZCANCELFLAG(+)                = '0'
            AND  CPO.GLBL_CMPY_CD                    = DOTP.GLBL_CMPY_CD(+)
            AND  CPO.DS_ORD_TP_CD                    = DOTP.DS_ORD_TP_CD(+)
            AND  DOTP.EZCANCELFLAG(+)                = '0'
            AND  CPO.SPCL_HDLG_TP_CD                 = SHT.SPCL_HDLG_TP_CD(+)
            AND  CPO.GLBL_CMPY_CD                    = SHT.GLBL_CMPY_CD(+)
            AND  SHT.EZCANCELFLAG(+)                 = '0'
            <!-- Start QC#21006 Add -->
            AND  CPOD.GLBL_CMPY_CD                   = OLS.GLBL_CMPY_CD(+)
            AND  CPOD.ORD_LINE_SRC_CD                = OLS.ORD_LINE_SRC_CD(+)
            AND  OLS.EZCANCELFLAG(+)                 = '0'
            <!-- End QC#21006 Add -->
            AND NOT EXISTS (SELECT
                                1
                            FROM
                                HLD          HLD
                               ,HLD_RSN      HRS
                               ,HLD_PROC_DFN HPD
                            WHERE
                                HLD.GLBL_CMPY_CD             = CPOD.GLBL_CMPY_CD
                            AND HLD.CPO_ORD_NUM              = CPOD.CPO_ORD_NUM
                            AND NVL(HLD.CPO_DTL_LINE_NUM, CPOD.CPO_DTL_LINE_NUM)         = CPOD.CPO_DTL_LINE_NUM
                            AND NVL(HLD.CPO_DTL_LINE_SUB_NUM, CPOD.CPO_DTL_LINE_SUB_NUM)     = CPOD.CPO_DTL_LINE_SUB_NUM
                            AND HLD.REL_FLG                  = #relFlg#
                            AND HLD.EZCANCELFLAG             = '0'
                            AND HLD.GLBL_CMPY_CD             = HRS.GLBL_CMPY_CD
                            AND HLD.HLD_RSN_CD               = HRS.HLD_RSN_CD
                            AND HRS.EZCANCELFLAG             = '0'
                            AND HLD.GLBL_CMPY_CD             = HPD.GLBL_CMPY_CD
                            AND HLD.HLD_RSN_CD               = HPD.HLD_RSN_CD
                            AND HPD.WH_TP_CD                 = #whTpCd#
                            AND HPD.REL_PNT_HARD_ALLOC_FLG   = #relPntHardAllocFlg#
                            AND HPD.EZCANCELFLAG             = '0'
                           )
            UNION ALL
            SELECT
                 #ORDER_TYPE_WH# ORDER_TYPE
                ,SHPG.GLBL_CMPY_CD
                ,SHPG.SHPG_PLN_NUM
                ,CPO.CPO_ORD_NUM
                ,CPOD.CPO_DTL_LINE_NUM
                ,CPOD.CPO_DTL_LINE_SUB_NUM
                ,MDSE2.PRNT_CMPY_SET_MDSE_FLG
                ,CPO.CUST_ISS_PO_NUM
                ,CPO.CUST_ISS_PO_DT
                ,CPOD.CPO_ORD_TP_CD
                ,#entered#       PRCH_REQ_APVL_STS_CD
                ,CPO.ADMIN_PSN_CD
                ,CPOD.RDD_DT CPO_RDD_DT
                ,NULL        VND_INVTY_LOC_CD
                ,CPOD.RTL_WH_CD
                ,CPOD.RTL_SWH_CD
                ,SHPG.SHIP_TO_CUST_CD
                ,SHPG.SHIP_TO_LOC_NM
                ,SHPG.SHIP_TO_ADDL_LOC_NM
                ,SHPG.SHIP_TO_FIRST_LINE_ADDR
                ,SHPG.SHIP_TO_SCD_LINE_ADDR
                ,SHPG.SHIP_TO_THIRD_LINE_ADDR
                ,SHPG.SHIP_TO_FRTH_LINE_ADDR
                ,SHPG.SHIP_TO_FIRST_REF_CMNT_TXT
                ,SHPG.SHIP_TO_SCD_REF_CMNT_TXT
                ,SHPG.SHIP_TO_CTY_ADDR
                ,SHPG.SHIP_TO_ST_CD
                ,SHPG.SHIP_TO_PROV_ADDR
                ,SHPG.SHIP_TO_CNTY_NM
                ,SHPG.SHIP_TO_POST_CD
                ,SHPG.SHIP_TO_CTRY_CD
                ,NULL        BILL_TO_CUST_CD
                ,NULL        SELL_TO_CUST_CD
                ,SHPG.RDD_DT
                ,MDSE1.PRCH_GRP_CD
                ,SHPG.MDSE_CD
                ,SHPG.SET_MDSE_CD
                ,SHPG.ORD_QTY
                ,SHPG.CUST_UOM_CD
                ,SHPG.REQ_FRT_CHRG_TO_CD
                ,SHPG.REQ_FRT_CHRG_METH_CD
                ,SHPG.REQ_SHPG_SVC_LVL_CD
                ,SHPG.RQST_CARR_CD
                ,SHPG.CARR_ACCT_NUM
                ,(CASE WHEN DEL1.DELY_ADDL_CMNT_TXT IS NULL THEN DEL2.DELY_ADDL_CMNT_TXT ELSE DEL1.DELY_ADDL_CMNT_TXT END) DELY_ADDL_CMNT_TXT
                ,#flgoffn#                    VND_DROP_SHIP_FLG
                ,DOTP.LINE_BIZ_TP_CD
                ,CPO.FRT_COND_CD
                ,CPOD.DS_ORD_LINE_CATG_CD
                ,CPOD.SER_NUM
                ,DCPC.DS_CPO_CONFIG_PK
                ,SHT.SPCL_HDLG_TP_DESC_TXT
                <!-- Start QC#21006 Add -->
                ,ORLS.ITT_DROP_SHIP_FLG
                <!-- End QC#21006 Add -->
                <!-- START 2017/10/16 S.Katsuma [Sol#454,ADD] -->
                ,CPO.SELL_TO_FIRST_REF_CMNT_TXT
                <!-- END 2017/10/16 S.Katsuma [Sol#454,ADD] -->
            FROM
                 SHPG_PLN           SHPG
                ,ORD_LINE_SRC       ORLS
                ,CPO                CPO
                ,CPO_DTL            CPOD
                ,DS_CPO_CONFIG      DCPC
                ,ALL_MDSE_V         MDSE
                ,ALL_MDSE_V         MDSE1
                ,ALL_MDSE_V         MDSE2
                ,DS_CPO_DELY_INFO   DEL1
                ,DS_CPO_DELY_INFO   DEL2
                ,DS_ORD_TP_PROC_DFN DOTP
                ,SPCL_HDLG_TP       SHT
            WHERE
                 SHPG.GLBL_CMPY_CD                   = #GLBL_CMPY_CD#
            AND  SHPG.EZCANCELFLAG                   = '0'
            AND  SHPG.AVAL_PO_QTY                    = 0
            AND  SHPG.PO_REQ_FLG                     = #flgoffn#
            AND  SHPG.SO_CLOSE_FLG                   = #flgoffn#
            AND  SHPG.RTE_STS_CD                     = #RTE_STS_CD#
            AND  SHPG.SHPG_STS_CD                    = #SHPG_STS_CD#
            AND
            (
                NOT EXISTS 
                (
                    SELECT  
                        1
                    FROM
                        PRCH_REQ_INTFC REQI
                    WHERE
                        CPOD.GLBL_CMPY_CD         = REQI.GLBL_CMPY_CD
                    AND CPOD.CPO_ORD_NUM          = REQI.TRX_REF_NUM
                    AND CPOD.CPO_DTL_LINE_NUM     = REQI.TRX_REF_LINE_NUM
                    AND CPOD.CPO_DTL_LINE_SUB_NUM = REQI.TRX_REF_LINE_SUB_NUM
                    AND CPOD.ORD_QTY              = REQI.ORD_QTY
                    AND CPOD.RTL_WH_CD            = REQI.DEST_RTL_WH_CD
                    AND CPOD.RTL_SWH_CD           = REQI.DEST_RTL_SWH_CD
                    AND REQI.EZCANCELFLAG         = '0'
                )
                OR (
                       (
                           EXISTS 
                           (
                               SELECT
                                  1
                               FROM
                                    PRCH_REQ_INTFC REQI
                                   ,SHPG_PLN       SP
                               WHERE
                                   CPOD.GLBL_CMPY_CD         = REQI.GLBL_CMPY_CD
                               AND CPOD.CPO_ORD_NUM          = REQI.TRX_REF_NUM
                               AND CPOD.CPO_DTL_LINE_NUM     = REQI.TRX_REF_LINE_NUM
                               AND CPOD.CPO_DTL_LINE_SUB_NUM = REQI.TRX_REF_LINE_SUB_NUM
                               AND CPOD.ORD_QTY              = REQI.ORD_QTY
                               AND CPOD.RTL_WH_CD            = REQI.DEST_RTL_WH_CD
                               AND CPOD.RTL_SWH_CD           = REQI.DEST_RTL_SWH_CD
                               AND REQI.PRCH_REQ_NUM         IS NULL
                               AND REQI.GLBL_CMPY_CD         = SP.GLBL_CMPY_CD
                               AND REQI.SHPG_PLN_NUM         = SP.SHPG_PLN_NUM
                               AND REQI.EZCANCELFLAG         = '0'
                               AND SP.EZCANCELFLAG           = '1'
                           )
                           OR EXISTS
                           (
                               SELECT
                                  1
                               FROM
                                   PRCH_REQ_INTFC REQI
                                   ,SHPG_PLN       SP
                               WHERE
                                   CPOD.GLBL_CMPY_CD         = REQI.GLBL_CMPY_CD
                               AND CPOD.CPO_ORD_NUM          = REQI.TRX_REF_NUM
                               AND CPOD.CPO_DTL_LINE_NUM     = REQI.TRX_REF_LINE_NUM
                               AND CPOD.CPO_DTL_LINE_SUB_NUM = REQI.TRX_REF_LINE_SUB_NUM
                               AND CPOD.ORD_QTY              = REQI.ORD_QTY
                               AND CPOD.RTL_WH_CD            = REQI.DEST_RTL_WH_CD
                               AND CPOD.RTL_SWH_CD           = REQI.DEST_RTL_SWH_CD
                               AND REQI.PRCH_REQ_NUM         IS NOT NULL
                               AND REQI.GLBL_CMPY_CD         = SP.GLBL_CMPY_CD
                               AND REQI.SHPG_PLN_NUM         = SP.SHPG_PLN_NUM
                               AND REQI.EZCANCELFLAG         = '0'
                               AND SP.EZCANCELFLAG           = '1'
                           )
                           OR EXISTS
                           (
                               SELECT
                                   1
                               FROM
                                     PRCH_REQ_DTL      PRD
                                    ,PRCH_REQ_LINE_STS PRLS
                               WHERE
                                   CPOD.GLBL_CMPY_CD              = PRD.GLBL_CMPY_CD
                               AND CPOD.CPO_ORD_NUM               = PRD.TRX_REF_NUM
                               AND CPOD.CPO_DTL_LINE_NUM          = PRD.TRX_REF_LINE_NUM
                               AND CPOD.CPO_DTL_LINE_SUB_NUM      = PRD.TRX_REF_LINE_SUB_NUM
                               AND CPOD.ORD_QTY                   = PRD.ORD_QTY
                               AND CPOD.RTL_WH_CD                 = PRD.DEST_RTL_WH_CD
                               AND CPOD.RTL_SWH_CD                = PRD.DEST_RTL_SWH_CD
                               AND PRD.GLBL_CMPY_CD               = PRLS.GLBL_CMPY_CD
                               AND PRD.PRCH_REQ_LINE_STS_CD       = PRLS.PRCH_REQ_LINE_STS_CD
                               AND PRLS.OPEN_STS_FLG              = 'N'
                               AND PRD.EZCANCELFLAG               = '0'
                           )
                           OR EXISTS
                           (
                               SELECT
                                   1
                               FROM
                                     PO_DTL         PD
                               WHERE
                                   CPOD.GLBL_CMPY_CD              = PD.GLBL_CMPY_CD
                               AND CPOD.CPO_ORD_NUM               = PD.TRX_REF_NUM
                               AND CPOD.CPO_DTL_LINE_NUM          = PD.TRX_REF_LINE_NUM
                               AND CPOD.CPO_DTL_LINE_SUB_NUM      = PD.TRX_REF_LINE_SUB_NUM
                               AND CPOD.ORD_QTY                   = PD.ORD_QTY
                               AND CPOD.RTL_WH_CD                 = PD.DEST_RTL_WH_CD
                               AND CPOD.RTL_SWH_CD                = PD.DEST_RTL_SWH_CD
                               AND PD.PO_LINE_STS_CD              IN (#poLineStsCdCancel#)
                               AND PD.EZCANCELFLAG                = '0'
                           )
                       )
                       AND NOT EXISTS
                       (
                           SELECT
                               1
                           FROM
                                PRCH_REQ_INTFC REQI
                               ,SHPG_PLN       SP
                           WHERE
                               CPOD.GLBL_CMPY_CD         = REQI.GLBL_CMPY_CD
                           AND CPOD.CPO_ORD_NUM          = REQI.TRX_REF_NUM
                           AND CPOD.CPO_DTL_LINE_NUM     = REQI.TRX_REF_LINE_NUM
                           AND CPOD.CPO_DTL_LINE_SUB_NUM = REQI.TRX_REF_LINE_SUB_NUM
                           AND CPOD.ORD_QTY              = REQI.ORD_QTY
                           AND CPOD.RTL_WH_CD            = REQI.DEST_RTL_WH_CD
                           AND CPOD.RTL_SWH_CD           = REQI.DEST_RTL_SWH_CD
                           AND REQI.PRCH_REQ_NUM         IS NULL
                           AND REQI.GLBL_CMPY_CD         = SP.GLBL_CMPY_CD
                           AND REQI.SHPG_PLN_NUM         = SP.SHPG_PLN_NUM
                           AND SP.SHPG_PLN_NUM           = SHPG.SHPG_PLN_NUM
                           AND REQI.EZCANCELFLAG         = '0'
                           AND SP.EZCANCELFLAG           = '0'
                       )
                       AND NOT EXISTS
                       (
                           SELECT
                               1
                           FROM
                                 PRCH_REQ_DTL      PRD
                                ,PRCH_REQ_LINE_STS PRLS
                           WHERE
                               CPOD.GLBL_CMPY_CD              = PRD.GLBL_CMPY_CD
                           AND CPOD.CPO_ORD_NUM               = PRD.TRX_REF_NUM
                           AND CPOD.CPO_DTL_LINE_NUM          = PRD.TRX_REF_LINE_NUM
                           AND CPOD.CPO_DTL_LINE_SUB_NUM      = PRD.TRX_REF_LINE_SUB_NUM
                           AND CPOD.ORD_QTY                   = PRD.ORD_QTY
                           AND CPOD.RTL_WH_CD                 = PRD.DEST_RTL_WH_CD
                           AND CPOD.RTL_SWH_CD                = PRD.DEST_RTL_SWH_CD
                           AND PRD.GLBL_CMPY_CD               = PRLS.GLBL_CMPY_CD
                           AND PRD.PRCH_REQ_LINE_STS_CD       = PRLS.PRCH_REQ_LINE_STS_CD
                           AND PRD.SHPG_PLN_NUM               = SHPG.SHPG_PLN_NUM
                           AND PRLS.OPEN_STS_FLG              = 'Y'
                           AND PRD.EZCANCELFLAG               = '0'
                       )
                       AND NOT EXISTS
                       (
                           SELECT
                               1
                           FROM
                                 PO_DTL         PD
                           WHERE
                               CPOD.GLBL_CMPY_CD              = PD.GLBL_CMPY_CD
                           AND CPOD.CPO_ORD_NUM               = PD.TRX_REF_NUM
                           AND CPOD.CPO_DTL_LINE_NUM          = PD.TRX_REF_LINE_NUM
                           AND CPOD.CPO_DTL_LINE_SUB_NUM      = PD.TRX_REF_LINE_SUB_NUM
                           AND CPOD.ORD_QTY                   = PD.ORD_QTY
                           AND CPOD.RTL_WH_CD                 = PD.DEST_RTL_WH_CD
                           AND CPOD.RTL_SWH_CD                = PD.DEST_RTL_SWH_CD
                           AND PD.PO_LINE_STS_CD              NOT IN (#poLineStsCdCancel#)
                           AND PD.EZCANCELFLAG                = '0'
                       )
                  )
            )
            AND  SHPG.GLBL_CMPY_CD                   = CPO.GLBL_CMPY_CD
            AND  SHPG.TRX_HDR_NUM                    = CPO.CPO_ORD_NUM
            AND  CPO.EZCANCELFLAG                    = '0'
            AND  CPO.GLBL_CMPY_CD                    = CPOD.GLBL_CMPY_CD
            AND  CPO.CPO_ORD_NUM                     = CPOD.CPO_ORD_NUM
            <iterate property="ordLineStsCdList" var="ordLineStsCdList[]" open="AND CPOD.ORD_LINE_DPLY_STS_CD IN (" close=")" conjunction=",">
                #ordLineStsCdList[]#
            </iterate>
            AND  SHPG.GLBL_CMPY_CD                   = CPOD.GLBL_CMPY_CD
            AND  SHPG.TRX_HDR_NUM                    = CPOD.CPO_ORD_NUM
            AND  SHPG.TRX_LINE_NUM                   = CPOD.CPO_DTL_LINE_NUM
            AND  SHPG.TRX_LINE_SUB_NUM               = CPOD.CPO_DTL_LINE_SUB_NUM
            AND  CPOD.EZCANCELFLAG                   = '0'
            AND  CPOD.GLBL_CMPY_CD                   = ORLS.GLBL_CMPY_CD
            AND  CPOD.ORD_LINE_SRC_CD                = ORLS.ORD_LINE_SRC_CD
            AND  ORLS.ORD_LINE_SRC_CATG_CD           = #ORD_LINE_SRC_CATG_CD#
            AND  ORLS.EZCANCELFLAG                   = '0'
            AND  CPOD.GLBL_CMPY_CD                   = DCPC.GLBL_CMPY_CD
            AND  CPOD.DS_CPO_CONFIG_PK               = DCPC.DS_CPO_CONFIG_PK
            AND  DCPC.EZCANCELFLAG                   = '0'
            AND  SHPG.GLBL_CMPY_CD                   = MDSE.GLBL_CMPY_CD
            AND  SHPG.MDSE_CD                        = MDSE.MDSE_CD
            AND  MDSE.MDSE_TP_CD                     != #MDSE_TP_CD#
            AND  MDSE.EZCANCELFLAG                   = '0'
            AND  SHPG.GLBL_CMPY_CD                   = MDSE1.GLBL_CMPY_CD
            AND  SHPG.MDSE_CD                        = MDSE1.MDSE_CD
            AND  MDSE1.PRNT_CMPY_SET_MDSE_FLG        = #flgoffn#
            AND  MDSE1.EZCANCELFLAG                  = '0'
            AND  SHPG.GLBL_CMPY_CD                   = MDSE2.GLBL_CMPY_CD(+)
            AND  SHPG.SET_MDSE_CD                    = MDSE2.MDSE_CD(+)
            AND  MDSE2.EZCANCELFLAG(+)                = '0'
            AND  DCPC.GLBL_CMPY_CD                   = DEL1.GLBL_CMPY_CD(+)
            AND  DCPC.CPO_ORD_NUM                    = DEL1.CPO_ORD_NUM(+)
            AND  DCPC.DS_CPO_CONFIG_PK               = DEL1.DS_CPO_CONFIG_PK(+)
            AND  DEL1.EZCANCELFLAG(+)                = '0'
            AND  DCPC.GLBL_CMPY_CD                   = DEL2.GLBL_CMPY_CD(+)
            AND  DCPC.CPO_ORD_NUM                    = DEL2.CPO_ORD_NUM(+)
            AND  DEL2.DS_CPO_CONFIG_PK(+)            IS NULL
            AND  DEL2.EZCANCELFLAG(+)                = '0'
            AND  CPO.GLBL_CMPY_CD                    = DOTP.GLBL_CMPY_CD(+)
            AND  CPO.DS_ORD_TP_CD                    = DOTP.DS_ORD_TP_CD(+)
            AND  DOTP.EZCANCELFLAG(+)                = '0'
            AND  CPO.SPCL_HDLG_TP_CD                 = SHT.SPCL_HDLG_TP_CD(+)
            AND  CPO.GLBL_CMPY_CD                    = SHT.GLBL_CMPY_CD(+)
            AND  SHT.EZCANCELFLAG(+)                 = '0'
            AND NOT EXISTS (SELECT
                                1
                            FROM
                                HLD          HLD
                               ,HLD_RSN      HRS
                               ,HLD_PROC_DFN HPD
                            WHERE
                                HLD.GLBL_CMPY_CD             = CPOD.GLBL_CMPY_CD
                            AND HLD.CPO_ORD_NUM              = CPOD.CPO_ORD_NUM
                            AND NVL(HLD.CPO_DTL_LINE_NUM, CPOD.CPO_DTL_LINE_NUM)         = CPOD.CPO_DTL_LINE_NUM
                            AND NVL(HLD.CPO_DTL_LINE_SUB_NUM, CPOD.CPO_DTL_LINE_SUB_NUM)     = CPOD.CPO_DTL_LINE_SUB_NUM
                            AND HLD.REL_FLG                  = #relFlg#
                            AND HLD.EZCANCELFLAG             = '0'
                            AND HLD.GLBL_CMPY_CD             = HRS.GLBL_CMPY_CD
                            AND HLD.HLD_RSN_CD               = HRS.HLD_RSN_CD
                            AND HRS.EZCANCELFLAG             = '0'
                            AND HLD.GLBL_CMPY_CD             = HPD.GLBL_CMPY_CD
                            AND HLD.HLD_RSN_CD               = HPD.HLD_RSN_CD
                            AND HPD.WH_TP_CD                 = #whTpCd#
                            AND HPD.REL_PNT_HARD_ALLOC_FLG   = #relPntHardAllocFlg#
                            AND HPD.EZCANCELFLAG             = '0'
                           )
        ) MAIN
        ORDER BY
             CPO_ORD_NUM
            ,CPO_DTL_LINE_NUM
    </statement>
    <statement id="getSetMdseOrderInfo" parameterClass="Map" resultClass="Map">
        SELECT
            #ORDER_TYPE#                            ORDER_TYPE
           ,#RTL_WH_CD#                             RTL_WH_CD
           ,PRCH.PRCH_REQ_NUM                       PRCH_REQ_NUM
           ,PRCH.PRCH_REQ_LINE_NUM                  PRCH_REQ_LINE_NUM
           ,PRCH.PRCH_REQ_APVL_STS_CD               PRCH_REQ_APVL_STS_CD
           ,PRCH.PRCH_REQ_REC_TP_CD                 PRCH_REQ_REC_TP_CD
           ,PRCH.PRCH_REQ_TP_CD                     PRCH_REQ_TP_CD
           ,PRCH.PRCH_REQ_LINE_TP_CD                PRCH_REQ_LINE_TP_CD
           ,PRCH.PRCH_REQ_CRAT_DT                   PRCH_REQ_CRAT_DT
           ,PRCH.PRCH_REQ_CRAT_TM                   PRCH_REQ_CRAT_TM
           ,PRCH.PRCH_REQ_CRAT_BY_PSN_CD            PRCH_REQ_CRAT_BY_PSN_CD
           ,PRCH.PRCH_REQ_CRAT_BY_NM                PRCH_REQ_CRAT_BY_NM
           ,PRCH.RQST_TECH_TOC_CD                   RQST_TECH_TOC_CD
           ,PRCH.PRCH_REQ_SRC_TP_CD                 PRCH_REQ_SRC_TP_CD
           ,SHPG.TRX_HDR_NUM                        TRX_REF_NUM
           ,SHPG.TRX_LINE_NUM                       TRX_REF_LINE_NUM
           ,SHPG.TRX_LINE_SUB_NUM                   TRX_REF_LINE_SUB_NUM
           ,PRCH.FSR_NUM                            FSR_NUM
           ,PRCH.SVC_TASK_NUM                       SVC_TASK_NUM
           ,PRCH.SVC_MACH_SER_NUM                   SVC_MACH_SER_NUM
           ,SHPG.SHPG_PLN_NUM                       SHPG_PLN_NUM
           ,PRCH.CPO_ORD_NUM                        CPO_ORD_NUM
           ,PRCH.CUST_ISS_PO_NUM                    CUST_ISS_PO_NUM
           ,PRCH.CUST_ISS_PO_DT                     CUST_ISS_PO_DT
           ,PRCH.CPO_ORD_TP_CD                      CPO_ORD_TP_CD
           ,PRCH.CTAC_PSN_NM                        CTAC_PSN_NM
           ,PRCH.ADMIN_PSN_CD                       ADMIN_PSN_CD
           ,PRCH.SHIP_FROM_SO_NUM                   SHIP_FROM_SO_NUM
           ,PRCH.PO_SCHD_REL_DT                     PO_SCHD_REL_DT
           ,PRCH.PROCR_TP_CD                        PROCR_TP_CD
           ,PRCH.SRC_INVTY_LOC_CD                   SRC_INVTY_LOC_CD
           ,PRCH.SRC_RTL_WH_CD                      SRC_RTL_WH_CD
           ,PRCH.SRC_RTL_SWH_CD                     SRC_RTL_SWH_CD
           ,PRCH.PRNT_VND_CD                        PRNT_VND_CD
           ,PRCH.VND_CD                             VND_CD
           ,PRCH.VND_INVTY_LOC_CD                   VND_INVTY_LOC_CD
           ,PRCH.DEST_INVTY_LOC_CD                  DEST_INVTY_LOC_CD
           ,PRCH.DEST_RTL_WH_CD                     DEST_RTL_WH_CD
           ,PRCH.DEST_RTL_SWH_CD                    DEST_RTL_SWH_CD
           ,PRCH.SHIP_TO_CUST_CD                    SHIP_TO_CUST_CD
           ,PRCH.SHIP_TO_LOC_NM                     SHIP_TO_LOC_NM
           ,PRCH.SHIP_TO_ADDL_LOC_NM                SHIP_TO_ADDL_LOC_NM
           ,PRCH.SHIP_TO_FIRST_LINE_ADDR            SHIP_TO_FIRST_LINE_ADDR
           ,PRCH.SHIP_TO_SCD_LINE_ADDR              SHIP_TO_SCD_LINE_ADDR
           ,PRCH.SHIP_TO_THIRD_LINE_ADDR            SHIP_TO_THIRD_LINE_ADDR
           ,PRCH.SHIP_TO_FRTH_LINE_ADDR             SHIP_TO_FRTH_LINE_ADDR
           ,PRCH.SHIP_TO_FIRST_REF_CMNT_TXT         SHIP_TO_FIRST_REF_CMNT_TXT
           ,PRCH.SHIP_TO_SCD_REF_CMNT_TXT           SHIP_TO_SCD_REF_CMNT_TXT
           ,PRCH.SHIP_TO_CTY_ADDR                   SHIP_TO_CTY_ADDR
           ,PRCH.SHIP_TO_ST_CD                      SHIP_TO_ST_CD
           ,SHPG.SHIP_TO_PROV_ADDR                  SHIP_TO_PROV_ADDR
           ,PRCH.SHIP_TO_PROV_NM                    SHIP_TO_PROV_NM
           ,PRCH.SHIP_TO_CNTY_NM                    SHIP_TO_CNTY_NM
           ,PRCH.SHIP_TO_POST_CD                    SHIP_TO_POST_CD
           ,PRCH.SHIP_TO_CTRY_CD                    SHIP_TO_CTRY_CD
           ,PRCH.BILL_TO_CUST_CD                    BILL_TO_CUST_CD
           ,PRCH.SELL_TO_CUST_CD                    SELL_TO_CUST_CD
           ,PRCH.RQST_RCV_DT                        RQST_RCV_DT
           ,PRCH.RQST_RCV_TM                        RQST_RCV_TM
           ,PRCH.PO_QLFY_CD                         PO_QLFY_CD
           ,PRCH.VND_DROP_SHIP_FLG                  VND_DROP_SHIP_FLG
           ,PRCH.PRCH_GRP_CD                        PRCH_GRP_CD
           ,SHPG.MDSE_CD                            MDSE_CD
           ,SHPG.ORD_QTY                            ORD_QTY
           ,SHPG.ORD_QTY                            ORD_QTY
           ,SHPG.CUST_UOM_CD                        CUST_UOM_CD
           ,PRCH.LINE_BIZ_TP_CD                     LINE_BIZ_TP_CD
           ,SHPG.REQ_FRT_CHRG_TO_CD                 REQ_FRT_CHRG_TO_CD
           ,SHPG.REQ_FRT_CHRG_METH_CD               REQ_FRT_CHRG_METH_CD
           ,CPO.FRT_COND_CD                         FRT_COND_CD
           ,SHPG.REQ_SHPG_SVC_LVL_CD                REQ_SHPG_SVC_LVL_CD
           ,SHPG.RQST_CARR_CD                       RQST_CARR_CD
           ,SHPG.CARR_ACCT_NUM                      CARR_ACCT_NUM
           ,PRCH.PRCH_REQ_CMNT_TXT                  PRCH_REQ_CMNT_TXT
           ,PRCH.SPCL_INSTN_CMNT_TXT                SPCL_INSTN_CMNT_TXT
           ,NULL                                    DELY_ADDL_CMNT_TXT
           ,PRCH.RCV_ADDL_CMNT_TXT                  RCV_ADDL_CMNT_TXT
           ,PRCH.PRCH_REQ_LINE_CMNT_TXT             PRCH_REQ_LINE_CMNT_TXT
           ,SHT.SPCL_HDLG_TP_DESC_TXT               SPCL_HDLG_TP_DESC_TXT
           ,OLS.ITT_DROP_SHIP_FLG                   ITT_DROP_SHIP_FLG
        FROM
            SHPG_PLN             SHPG
           ,PRCH_REQ_INTFC       PRCH
           ,CPO_DTL              CPOD
           ,CPO                  CPO
           ,SPCL_HDLG_TP         SHT
           ,ORD_LINE_SRC         OLS
        WHERE
            SHPG.GLBL_CMPY_CD                   = #GLBL_CMPY_CD#
        AND SHPG.EZCANCELFLAG                   = '0'
        AND SHPG.TRX_HDR_NUM                    = #TRX_HDR_NUM#
        AND SHPG.TRX_LINE_NUM                   = #TRX_LINE_NUM#
        AND SHPG.TRX_LINE_SUB_NUM               = #TRX_LINE_SUB_NUM#
        AND SHPG.GLBL_CMPY_CD                   = PRCH.GLBL_CMPY_CD
        AND SHPG.TRX_HDR_NUM                    = PRCH.TRX_REF_NUM
        AND SHPG.TRX_LINE_NUM                   = PRCH.TRX_REF_LINE_NUM
        AND PRCH.TRX_REF_LINE_SUB_NUM           = #TRX_REF_LINE_SUB_NUM#
        AND PRCH.EZCANCELFLAG                   = '0'
        AND SHPG.GLBL_CMPY_CD                   = CPOD.GLBL_CMPY_CD
        AND SHPG.TRX_HDR_NUM                    = CPOD.CPO_ORD_NUM
        AND SHPG.TRX_LINE_NUM                   = CPOD.CPO_DTL_LINE_NUM
        AND SHPG.TRX_LINE_SUB_NUM               = CPOD.CPO_DTL_LINE_SUB_NUM
        AND CPOD.EZCANCELFLAG                   = '0'
        AND CPOD.GLBL_CMPY_CD                   = CPO.GLBL_CMPY_CD
        AND CPOD.CPO_ORD_NUM                    = CPO.CPO_ORD_NUM
        AND CPO.EZCANCELFLAG                    = '0'
        AND CPO.SPCL_HDLG_TP_CD                 = SHT.SPCL_HDLG_TP_CD(+)
        AND CPO.GLBL_CMPY_CD                    = SHT.GLBL_CMPY_CD(+)
        AND SHT.EZCANCELFLAG(+)                 = '0'
        AND CPOD.GLBL_CMPY_CD                   = OLS.GLBL_CMPY_CD(+)
        AND CPOD.ORD_LINE_SRC_CD                = OLS.ORD_LINE_SRC_CD(+)
        AND OLS.EZCANCELFLAG(+)                 = '0'
    </statement>
    <!-- 08/08/2017 CITS S.Endo Mod Sol#035(QC#18108) END-->
    <statement id="getDsOrderLineCategoryType" parameterClass="Map" resultClass="Map">
        SELECT DS_ORD_LINE_CATG_CD 
        FROM   ORD_LINE_VAL_SET
        WHERE  1=1
        AND    GLBL_CMPY_CD       = #GLBL_CMPY_CD#
        AND    EZCANCELFLAG       = '0'
        AND    ORD_LINE_CTX_TP_CD = #ORD_LINE_CTX_TP_CD#
    </statement>

    <statement id="getPrntVndCd" parameterClass="Map" resultClass="String">
          SELECT
              PV.PRNT_VND_CD
          FROM
               VND V
              ,PRNT_VND PV
          WHERE
              1 = 1
              -- JOIN TO VND
              AND V.GLBL_CMPY_CD                         = #GLBL_CMPY_CD#
              AND V.VND_CD                               = #rossVndCd#
              AND V.EFF_FROM_DT                      &lt;= #salesDate#
              AND NVL(V.EFF_THRU_DT   , '99991231')  &gt;= #salesDate#
              AND V.RGTN_STS_CD                          = #rgtnStsCd#
              -- JOIN TO PRNT_VND
              AND V.GLBL_CMPY_CD                         = PV.GLBL_CMPY_CD
              AND V.PRNT_VND_PK                          = PV.PRNT_VND_PK
    </statement>

    <statement id="getShipTo" parameterClass="Map" resultClass="Map">
        SELECT
            S.LOC_NM                  AS SHIP_TO_LOC_NM
            ,S.ADDL_LOC_NM            AS SHIP_TO_ADDL_LOC_NM
            ,S.FIRST_LINE_ADDR        AS SHIP_TO_FIRST_LINE_ADDR
            ,S.SCD_LINE_ADDR          AS SHIP_TO_SCD_LINE_ADDR
            ,S.THIRD_LINE_ADDR        AS SHIP_TO_THIRD_LINE_ADDR
            ,S.FRTH_LINE_ADDR         AS SHIP_TO_FRTH_LINE_ADDR
            ,S.FIRST_REF_CMNT_TXT     AS SHIP_TO_FIRST_REF_CMNT_TXT
            ,S.SCD_REF_CMNT_TXT       AS SHIP_TO_SCD_REF_CMNT_TXT
            ,S.CTY_ADDR               AS SHIP_TO_CTY_ADDR
            ,S.ST_CD                  AS SHIP_TO_ST_CD
            ,S.PROV_NM                AS SHIP_TO_PROV_ADDR
            ,C.CNTY_NM                AS SHIP_TO_CNTY_NM
            ,S.POST_CD                AS SHIP_TO_POST_CD
            ,S.CTRY_CD                AS SHIP_TO_CTRY_CD
        FROM
            SHIP_TO_CUST S
            ,CNTY C
        WHERE
            S.GLBL_CMPY_CD        = #glblCmpyCd#
            AND S.SHIP_TO_CUST_CD = #shipToCustCd#
            AND S.RGTN_STS_CD     = #rgtnStsCd#
            AND S.EZCANCELFLAG    = '0'
            AND S.GLBL_CMPY_CD    = C.GLBL_CMPY_CD(+)
            AND S.CNTY_PK         = C.CNTY_PK(+)
            AND C.EZCANCELFLAG(+) = '0'
    </statement>

</sqlMap>
