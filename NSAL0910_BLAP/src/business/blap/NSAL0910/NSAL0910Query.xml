<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSAL0910Query">
    <typeAlias alias="NSAL0910_ASMsg" type="business.blap.NSAL0910.NSAL0910_ASMsg"/>
    <statement id="getSearchData" parameterClass="Map" resultMap="result.getSearchData">
            SELECT
                 CFS_INV_INTFC_PK
                ,DS_ACCT_DLR_CD
                ,PROC_DT
                ,INV_DT
                ,CFS_LEASE_PBL_NUM
                ,INV_LINE_NUM
                ,CSA_INV_NUM
                ,CSA_CONTR_NUM
                ,CFS_SER_NUM
                ,CFS_INV_PROC_STS_CD
                ,CFS_INV_PROC_STS_DESC_TXT
                ,INTFC_ERR_MSG_TXT
                ,BLLG_PER_FROM_DT
                ,BLLG_PER_THRU_DT
                ,FTR_FLG_ORIG_TXT
                ,BLLG_MTR_LB_NM
                ,CFS_BLLG_TP_TXT
                ,CM_FLG_ORIG_TXT
                ,CFS_LEASE_NUM
                ,INV_TOT_DEAL_NET_AMT
                ,END_CUST_NM
                ,DS_CONTR_NUM
                ,CSA_DS_CONTR_MOD_TXT
                ,DS_CONTR_PK
                ,USG_ITEM_CD
                ,SVC_ITEM_CD
                ,FTR_ITEM_CD
                ,DFRD_ACCTG_RULE_CD
                ,DFRD_INV_RULE_CD
                ,BILL_TO_CUST_ACCT_CD
                ,BILL_TO_LOC_NUM
                ,SHIP_TO_CUST_ACCT_CD
                ,SHIP_TO_LOC_NUM
                ,SVC_LINE_CONTR_DTL_PK
                ,USG_LINE_CONTR_DTL_PK
                ,UOM_CD
                ,BILL_TO_CUST_CD
                ,DS_INV_TP_CD
                ,CONTR_VRSN_EFF_FROM_DT
                ,CFS_FLEET_FLG
                ,CFS_INV_BAT_NUM
                ,INV_NUM
                ,EZUPTIME
                ,EZUPTIMEZONE
            FROM (
                 SELECT
                      CII.CFS_INV_INTFC_PK                CFS_INV_INTFC_PK
                     ,CII.DS_ACCT_DLR_CD                  DS_ACCT_DLR_CD
                     ,CII.PROC_DT                         PROC_DT
                     ,CII.INV_DT                          INV_DT
                     ,CII.CFS_LEASE_PBL_NUM               CFS_LEASE_PBL_NUM
                     ,CII.INV_LINE_NUM                    INV_LINE_NUM
                     ,CII.CSA_INV_NUM                     CSA_INV_NUM
                     ,CII.CSA_CONTR_NUM                   CSA_CONTR_NUM
                     ,CII.CFS_SER_NUM                     CFS_SER_NUM
                     ,CII.CFS_INV_PROC_STS_CD             CFS_INV_PROC_STS_CD
                     ,STS.CFS_INV_PROC_STS_DESC_TXT       CFS_INV_PROC_STS_DESC_TXT
                     ,CII.INTFC_ERR_MSG_TXT               INTFC_ERR_MSG_TXT
                     ,CII.BLLG_PER_FROM_DT                BLLG_PER_FROM_DT
                     ,CII.BLLG_PER_THRU_DT                BLLG_PER_THRU_DT
                     ,CII.FTR_FLG_ORIG_TXT                FTR_FLG_ORIG_TXT
                     ,CII.BLLG_MTR_LB_NM                  BLLG_MTR_LB_NM
                     ,CII.CFS_BLLG_TP_TXT                 CFS_BLLG_TP_TXT
                     ,CII.CM_FLG_ORIG_TXT                 CM_FLG_ORIG_TXT
                     ,CII.CFS_LEASE_NUM                   CFS_LEASE_NUM
                     ,CII.INV_TOT_DEAL_NET_AMT            INV_TOT_DEAL_NET_AMT
                     ,CII.END_CUST_NM                     END_CUST_NM
                     ,CII.DS_CONTR_NUM                    DS_CONTR_NUM
                     ,CII.CSA_DS_CONTR_MOD_TXT            CSA_DS_CONTR_MOD_TXT
                     ,CII.DS_CONTR_PK                     DS_CONTR_PK
                     ,CII.USG_ITEM_CD                     USG_ITEM_CD
                     ,CII.SVC_ITEM_CD                     SVC_ITEM_CD
                     ,CII.FTR_ITEM_CD                     FTR_ITEM_CD
                     ,CII.DFRD_ACCTG_RULE_CD              DFRD_ACCTG_RULE_CD
                     ,CII.DFRD_INV_RULE_CD                DFRD_INV_RULE_CD
                     ,CII.BILL_TO_CUST_ACCT_CD            BILL_TO_CUST_ACCT_CD
                     ,CII.BILL_TO_LOC_NUM                 BILL_TO_LOC_NUM
                     ,CII.SHIP_TO_CUST_ACCT_CD            SHIP_TO_CUST_ACCT_CD
                     ,CII.SHIP_TO_LOC_NUM                 SHIP_TO_LOC_NUM
                     ,CII.SVC_LINE_CONTR_DTL_PK           SVC_LINE_CONTR_DTL_PK
                     ,CII.USG_LINE_CONTR_DTL_PK           USG_LINE_CONTR_DTL_PK
                     ,CII.UOM_CD                          UOM_CD
                     ,CII.BILL_TO_CUST_CD                 BILL_TO_CUST_CD
                     ,CII.DS_INV_TP_CD                    DS_INV_TP_CD
                     ,CII.CONTR_VRSN_EFF_FROM_DT          CONTR_VRSN_EFF_FROM_DT
                     ,CII.CFS_FLEET_FLG                   CFS_FLEET_FLG
                     ,CII.CFS_INV_BAT_NUM                 CFS_INV_BAT_NUM
                     ,CII.INV_NUM                         INV_NUM
                     ,CII.EZUPTIME                        EZUPTIME
                     ,CII.EZUPTIMEZONE                    EZUPTIMEZONE
                 FROM
                      CFS_INV_INTFC      CII
                     ,CFS_INV_PROC_STS   STS
                 WHERE
                      CII.GLBL_CMPY_CD                   = #glblCmpyCd#
                  AND CII.DS_ACCT_DLR_CD                 = #dsAcctDlrCd#
                  <isNotNull property="procDtFrom">
                  AND CII.PROC_DT                    &gt;= #procDtFrom#
                  </isNotNull>
                  <isNotNull property="procDtTo">
                  AND NVL(CII.PROC_DT, #procDtTo#)   &lt;= #procDtTo#
                  </isNotNull>
                  <isNotNull property="cfsInvProcStsCd">
                  AND CII.CFS_INV_PROC_STS_CD            = #cfsInvProcStsCd#
                  </isNotNull>
                  <isNotNull property="cratDtFrom">
                  AND CII.EZINTIME                   &gt;= #cratDtFrom#
                  </isNotNull>
                  <isNotNull property="cratDtTo">
                  AND CII.EZINTIME                   &lt;= #cratDtTo#
                  </isNotNull>
                  <isNotNull property="csaInvNum">
                  AND CII.CSA_INV_NUM                 like #csaInvNum#
                  </isNotNull>
                  <isNotNull property="cfsSerNum">
                  AND CII.CFS_SER_NUM                 like #cfsSerNum#
                  </isNotNull>
                  <isNotNull property="csaContrNum">
                  AND CII.CSA_CONTR_NUM               like #csaContrNum#
                  </isNotNull>
                  AND CII.EZCANCELFLAG                   = '0'
                  AND CII.CFS_INV_PROC_STS_CD            = STS.CFS_INV_PROC_STS_CD
                  AND CII.GLBL_CMPY_CD                   = STS.GLBL_CMPY_CD
                  AND STS.EZCANCELFLAG                   = '0'
                 ORDER BY
                      CII.CFS_LEASE_PBL_NUM
            ) WHERE
                ROWNUM        &lt;= #rowNum#
    </statement>
    <resultMap id="result.getSearchData"      class="NSAL0910_ASMsg">
         <result property="cfsInvIntfcPk_A"         column="CFS_INV_INTFC_PK"           javaType="EZDSBigDecimalItem"/>
         <result property="dsAcctDlrCd_A"           column="DS_ACCT_DLR_CD"             javaType="EZDSStringItem"/>
         <result property="procDt_A"                column="PROC_DT"                    javaType="EZDSDateItem"/>
         <result property="invDt_A"                 column="INV_DT"                     javaType="EZDSDateItem"/>
         <result property="cfsLeasePblNum_A"        column="CFS_LEASE_PBL_NUM"          javaType="EZDSStringItem"/>
         <result property="invLineNum_A"            column="INV_LINE_NUM"               javaType="EZDSStringItem"/>
         <result property="csaInvNum_A"             column="CSA_INV_NUM"                javaType="EZDSStringItem"/>
         <result property="csaContrNum_A"           column="CSA_CONTR_NUM"              javaType="EZDSStringItem"/>
         <result property="cfsSerNum_A"             column="CFS_SER_NUM"                javaType="EZDSStringItem"/>
         <result property="cfsInvProcStsCd_A"       column="CFS_INV_PROC_STS_CD"        javaType="EZDSStringItem"/>
         <result property="cfsInvProcStsDescTxt_A"  column="CFS_INV_PROC_STS_DESC_TXT"  javaType="EZDSStringItem"/>
         <result property="intfcErrMsgTxt_A"        column="INTFC_ERR_MSG_TXT"          javaType="EZDSStringItem"/>
         <result property="bllgPerFromDt_A"         column="BLLG_PER_FROM_DT"           javaType="EZDSDateItem"/>
         <result property="bllgPerThruDt_A"         column="BLLG_PER_THRU_DT"           javaType="EZDSDateItem"/>
         <result property="ftrFlgOrigTxt_A"         column="FTR_FLG_ORIG_TXT"           javaType="EZDSStringItem"/>
         <result property="bllgMtrLbNm_A"           column="BLLG_MTR_LB_NM"             javaType="EZDSStringItem"/>
         <result property="cfsBllgTpTxt_A"          column="CFS_BLLG_TP_TXT"            javaType="EZDSStringItem"/>
         <result property="cmFlgOrigTxt_A"          column="CM_FLG_ORIG_TXT"            javaType="EZDSStringItem"/>
         <result property="cfsLeaseNum_A"           column="CFS_LEASE_NUM"              javaType="EZDSStringItem"/>
         <result property="invTotDealNetAmt_A"      column="INV_TOT_DEAL_NET_AMT"       javaType="EZDSBigDecimalItem"/>
         <result property="endCustNm_A"             column="END_CUST_NM"                javaType="EZDSStringItem"/>
         <result property="dsContrNum_A"            column="DS_CONTR_NUM"               javaType="EZDSStringItem"/>
         <result property="csaDsContrModTxt_A"      column="CSA_DS_CONTR_MOD_TXT"       javaType="EZDSStringItem"/>
         <result property="dsContrPk_A"             column="DS_CONTR_PK"                javaType="EZDSBigDecimalItem"/>
         <result property="usgItemCd_A"             column="USG_ITEM_CD"                javaType="EZDSStringItem"/>
         <result property="svcItemCd_A"             column="SVC_ITEM_CD"                javaType="EZDSStringItem"/>
         <result property="ftrItemCd_A"             column="FTR_ITEM_CD"                javaType="EZDSStringItem"/>
         <result property="dfrdAcctgRuleCd_A"       column="DFRD_ACCTG_RULE_CD"         javaType="EZDSStringItem"/>
         <result property="dfrdInvRuleCd_A"         column="DFRD_INV_RULE_CD"           javaType="EZDSStringItem"/>
         <result property="billToCustAcctCd_A"      column="BILL_TO_CUST_ACCT_CD"       javaType="EZDSStringItem"/>
         <result property="billToLocNum_A"          column="BILL_TO_LOC_NUM"            javaType="EZDSStringItem"/>
         <result property="shipToCustAcctCd_A"      column="SHIP_TO_CUST_ACCT_CD"       javaType="EZDSStringItem"/>
         <result property="shipToLocNum_A"          column="SHIP_TO_LOC_NUM"            javaType="EZDSStringItem"/>
         <result property="svcLineContrDtlPk_A"     column="SVC_LINE_CONTR_DTL_PK"      javaType="EZDSBigDecimalItem"/>
         <result property="usgLineContrDtlPk_A"     column="USG_LINE_CONTR_DTL_PK"      javaType="EZDSBigDecimalItem"/>
         <result property="uomCd_A"                 column="UOM_CD"                     javaType="EZDSStringItem"/>
         <result property="billToCustCd_A"          column="BILL_TO_CUST_CD"            javaType="EZDSStringItem"/>
         <result property="dsInvTpCd_A"             column="DS_INV_TP_CD"               javaType="EZDSStringItem"/>
         <result property="contrVrsnEffFromDt_A"    column="CONTR_VRSN_EFF_FROM_DT"     javaType="EZDSDateItem"/>
         <result property="cfsFleetFlg_A"           column="CFS_FLEET_FLG"              javaType="EZDSStringItem"/>
         <result property="cfsInvBatNum_A"          column="CFS_INV_BAT_NUM"            javaType="EZDSStringItem"/>
         <result property="invNum_A"                column="INV_NUM"                    javaType="EZDSStringItem"/>
         <result property="ezUpTime_A"              column="EZUPTIME"                   javaType="EZDSStringItem"/>
         <result property="ezUpTimeZone_A"          column="EZUPTIMEZONE"               javaType="EZDSStringItem"/>
    </resultMap>

    <statement id="getInvData" parameterClass="Map" resultClass="Map">
            SELECT
                 INL.INV_NUM                         INV_NUM
                ,INL.DS_CONTR_NUM                    DS_CONTR_NUM
                ,INL.DS_CONTR_DTL_PK                 DS_CONTR_DTL_PK
            FROM
                 INV_LINE      INL
            WHERE
                 INL.GLBL_CMPY_CD                   = #glblCmpyCd#
             AND INL.INV_NUM                        = #invNum#
            <isNotNull property="dsContrNum">
             AND INL.DS_CONTR_NUM                   = #dsContrNum#
            </isNotNull>
             AND INL.DS_CONTR_NUM                   IS NOT NULL
             AND INL.EZCANCELFLAG                   = '0'
             AND ROWNUM                             = 1
            ORDER BY
                 INL.INV_NUM
                ,INL.INV_LINE_NUM
                ,INL.INV_BOL_LINE_NUM
                ,INL.INV_LINE_SUB_NUM
                ,INL.INV_LINE_SUB_TRX_NUM
    </statement>

    <statement id="getContrData" parameterClass="Map" resultClass="Map">
        SELECT
             SMM.SVC_MACH_MSTR_PK     AS SVC_MACH_MSTR_PK
            ,SMM.SER_NUM              AS SER_NUM
            ,HDR.DS_CONTR_PK          AS DS_CONTR_PK
            ,HDR.DS_CONTR_NUM         AS DS_CONTR_NUM
            ,DTL.DS_CONTR_DTL_PK      AS DS_CONTR_DTL_PK
        FROM
             SVC_MACH_MSTR      SMM
            ,DS_CONTR_DTL       DTL
            ,DS_CONTR           HDR
        WHERE
                SMM.GLBL_CMPY_CD            = #glblCmpyCd#
            AND SMM.EZCANCELFLAG            = '0'
            AND SMM.GLBL_CMPY_CD            = DTL.GLBL_CMPY_CD
            AND SMM.SER_NUM                 = #serNum#
            AND SMM.SVC_MACH_MSTR_PK        = DTL.SVC_MACH_MSTR_PK
            AND DTL.EZCANCELFLAG            = '0'
            AND DTL.GLBL_CMPY_CD            = HDR.GLBL_CMPY_CD
            AND DTL.DS_CONTR_PK             = HDR.DS_CONTR_PK
            <isNotNull property="dsContrNum">
            AND HDR.DS_CONTR_NUM            = #dsContrNum#
            </isNotNull>
            AND HDR.DS_CONTR_CATG_CD &lt;&gt; #dsContrCatgCdIsWty#
            AND HDR.EZCANCELFLAG            = '0'
            AND ROWNUM                      = 1
        ORDER BY
             SMM.SER_NUM
            ,HDR.DS_CONTR_NUM
            ,DTL.DS_CONTR_DTL_PK
    </statement>
</sqlMap>
