<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NWCB722001">
   <statement id="getCsmpClaimList" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE2.INV_NUM
         ,INLINE5.INV_BOL_LINE_NUM
         ,INLINE5.INV_LINE_NUM
         ,INLINE5.INV_LINE_SUB_NUM
         ,INLINE5.INV_LINE_SUB_TRX_NUM
         ,INLINE2.CPO_ORD_NUM
         ,INLINE5.DS_ORD_POSN_NUM
         ,INLINE5.CPO_DTL_LINE_NUM
         ,INLINE5.CPO_DTL_LINE_SUB_NUM
         ,INLINE5.DS_CPO_LINE_NUM
         ,INLINE5.DS_CPO_LINE_SUB_NUM
         ,INLINE2.LINE_BIZ_TP_CD
         ,INLINE2.DS_BIZ_AREA_CD
         ,INLINE2.DS_ORD_CATG_CD
         ,INLINE2.DS_ORD_TP_CD
         ,INLINE2.DS_ORD_RSN_CD
         ,INLINE2.CUST_ISS_PO_NUM
         ,INLINE2.CUST_ISS_PO_DT
         ,INLINE2.INV_DT
         ,INLINE3.SHIP_DT
         ,INLINE2.DEAL_CCY_CD
         ,INLINE2.SELL_TO_CUST_CD
         ,INLINE2.SOLD_TO_CUST_LOC_CD
         ,INLINE2.SELL_TO_LOC_NM
         ,INLINE2.SELL_TO_ADDL_LOC_NM
         ,INLINE2.SELL_TO_FIRST_LINE_ADDR
         ,INLINE2.SELL_TO_SCD_LINE_ADDR
         ,INLINE2.SELL_TO_THIRD_LINE_ADDR
         ,INLINE2.SELL_TO_FRTH_LINE_ADDR
         ,INLINE2.SELL_TO_CTY_ADDR
         ,INLINE2.SELL_TO_PROV_NM
         ,INLINE2.SELL_TO_CNTY_NM
         ,INLINE2.SELL_TO_ST_CD
         ,INLINE2.SELL_TO_POST_CD
         ,INLINE2.SELL_TO_CTRY_CD
         ,INLINE2.SELL_TO_FIRST_REF_CMNT_TXT
         ,INLINE2.SELL_TO_SCD_REF_CMNT_TXT
         ,INLINE3.SHIP_TO_CUST_ACCT_CD
         ,INLINE3.SHIP_TO_CUST_CD
         ,INLINE3.DROP_SHIP_FLG
         ,INLINE3.SHIP_TO_LOC_NM
         ,INLINE3.SHIP_TO_ADDL_LOC_NM
         ,INLINE3.SHIP_TO_FIRST_LINE_ADDR
         ,INLINE3.SHIP_TO_SCD_LINE_ADDR
         ,INLINE3.SHIP_TO_THIRD_LINE_ADDR
         ,INLINE3.SHIP_TO_FRTH_LINE_ADDR
         ,INLINE3.SHIP_TO_CTY_ADDR
         ,INLINE3.SHIP_TO_CNTY_NM
         ,INLINE3.SHIP_TO_PROV_NM
         ,INLINE3.SHIP_TO_ST_CD
         ,INLINE3.SHIP_TO_POST_CD
         ,INLINE3.SHIP_TO_CTRY_CD
         ,INLINE3.SHIP_TO_FIRST_REF_CMNT_TXT
         ,INLINE3.SHIP_TO_SCD_REF_CMNT_TXT
         ,INLINE5.CSMP_CONTR_NUM
         ,INLINE5.DLR_REF_NUM
         ,INLINE5.UOM_CD
         ,INLINE5.ORD_CUST_UOM_QTY
         ,INLINE5.MDSE_CD
         ,INLINE9.ORD_TAKE_MDSE_CD
         ,INLINE5.MDSE_NM
         ,INLINE5.COA_PROD_CD
         ,INLINE5.SET_MDSE_CD
         ,INLINE5.ORD_QTY
         ,INLINE5.SHIP_QTY
         ,INLINE5.SLS_REP_TOC_CD
         ,INLINE5.DEAL_NET_UNIT_PRC_AMT
         ,INLINE5.INV_LINE_DEAL_NET_AMT
         ,INLINE5.INV_LINE_FUNC_NET_AMT
         ,INLINE7.CSMP_PRC_LIST_CD
         ,INLINE5.SVC_CONFIG_MSTR_PK
         ,INLINE5.FIRST_BLLG_ATTRB_VAL_TXT
         ,INLINE5.SCD_BLLG_ATTRB_VAL_TXT
         ,INLINE5.THIRD_BLLG_ATTRB_VAL_TXT
         ,INLINE5.FRTH_BLLG_ATTRB_VAL_TXT
         ,INLINE5.FIFTH_BLLG_ATTRB_VAL_TXT
         ,INLINE5.SIXTH_BLLG_ATTRB_VAL_TXT
         ,INLINE2.SLS_ADMIN_PSN_CD
         ,INLINE5.SLS_REP_TOC_CD
         ,INLINE5.CUST_ISS_PO_NUM
         ,INLINE5.CUST_ISS_PO_DT
         ,INLINE5.INV_DPLY_QTY
         ,INLINE10.DFRD_ACCTG_RULE_CD
         ,INLINE5.DS_ORD_LINE_CATG_CD
         ,INLINE5.BASE_CMPT_FLG
         ,INLINE2.ORD_DT
         <!-- START 2018/01/05 Hd.Sugawara [QC#22371,ADD] -->
         ,INLINE3.SHIP_FROM_INVTY_LOC_CD
         <!-- END 2018/01/05 Hd.Sugawara [QC#22371,ADD] -->
     FROM
          INV             INLINE2
         ,INV_BOL         INLINE3
         ,INV_LINE        INLINE5
         ,ORD_PRFT_DTL    INLINE7
         ,(
            SELECT
                   INLINE1.TRX_HDR_NUM
                  ,INLINE1.TRX_LINE_NUM
                  ,INLINE1.TRX_LINE_SUB_NUM
                  ,MAX(INLINE1.ORD_PRFT_VRSN_NUM) ORD_PRFT_VRSN_NUM
              FROM
                   ORD_PRFT_DTL INLINE1
             WHERE
                   INLINE1.EZCANCELFLAG = '0'
               AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
          GROUP BY
                   INLINE1.TRX_HDR_NUM, INLINE1.TRX_LINE_NUM, INLINE1.TRX_LINE_SUB_NUM
          ) INLINE8
         ,ORD_TAKE_MDSE	INLINE9
         ,MDSE	        INLINE10
    WHERE
          INLINE2.GLBL_CMPY_CD = #glblCmpyCd#
      AND INLINE2.EZCANCELFLAG = '0'
      AND INLINE3.EZCANCELFLAG = '0'
      AND INLINE3.GLBL_CMPY_CD = INLINE2.GLBL_CMPY_CD
      AND INLINE3.INV_NUM      = INLINE2.INV_NUM
      AND INLINE5.EZCANCELFLAG = '0'
      AND INLINE5.GLBL_CMPY_CD = INLINE3.GLBL_CMPY_CD
      AND INLINE5.INV_NUM      = INLINE3.INV_NUM
      AND INLINE5.INV_BOL_LINE_NUM = INLINE3.INV_BOL_LINE_NUM
      AND INLINE5.SET_MDSE_CD IS NULL
      AND INLINE5.CSMP_INV_PROC_STS_CD IN (#csmpInvProcStsCd_1#, #csmpInvProcStsCd_9#)
      AND NOT EXISTS (
                      SELECT
                             '1'
                        FROM
                             ORD_LINE_VAL_SET
                       WHERE
                             ORD_LINE_CTX_TP_CD = #ordLineCtxTpCd#
                         AND DS_ORD_LINE_CATG_CD = INLINE5.DS_ORD_LINE_CATG_CD
                         AND EZCANCELFLAG = '0'
                     )
      AND INLINE7.EZCANCELFLAG(+) = '0'
      AND INLINE7.GLBL_CMPY_CD(+) = INLINE5.GLBL_CMPY_CD
      AND INLINE7.TRX_HDR_NUM(+) = INLINE5.CPO_ORD_NUM
      AND INLINE7.TRX_LINE_NUM(+) = INLINE5.CPO_DTL_LINE_NUM
      AND INLINE7.TRX_LINE_SUB_NUM(+) = INLINE5.CPO_DTL_LINE_SUB_NUM
      AND INLINE7.ORD_PRFT_VRSN_NUM(+) = INLINE8.ORD_PRFT_VRSN_NUM
      AND INLINE8.TRX_HDR_NUM(+) = INLINE5.CPO_ORD_NUM
      AND INLINE8.TRX_LINE_NUM(+) = INLINE5.CPO_DTL_LINE_NUM
      AND INLINE8.TRX_LINE_SUB_NUM(+) = INLINE5.CPO_DTL_LINE_SUB_NUM
      AND INLINE9.EZCANCELFLAG(+) = '0'
      AND INLINE9.GLBL_CMPY_CD(+) = INLINE5.GLBL_CMPY_CD
      AND INLINE9.MDSE_CD(+) = INLINE5.MDSE_CD
      AND INLINE10.EZCANCELFLAG(+) = '0'
      AND INLINE10.GLBL_CMPY_CD(+) = INLINE5.GLBL_CMPY_CD
      AND INLINE10.MDSE_CD(+) = INLINE5.MDSE_CD
 ORDER BY INLINE2.INV_NUM
         ,INLINE5.INV_BOL_LINE_NUM
         ,INLINE5.INV_LINE_NUM
         ,INLINE5.INV_LINE_SUB_NUM
         ,INLINE5.INV_LINE_SUB_TRX_NUM
         ,INLINE2.CPO_ORD_NUM
         ,INLINE5.DS_ORD_POSN_NUM
   </statement>
   <statement id="findSetItem" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE1.CSMP_SET_ITEM_CD
         ,INLINE1.CSMP_SET_ITEM_NM
     FROM
          CSMP_SET_ITEM INLINE1
    WHERE
          INLINE1.EZCANCELFLAG = '0'
      AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
      AND INLINE1.CSMP_SET_ITEM_CD = #ordTakeMdseCd#
   </statement>
   <statement id="findAftrMrktByItem" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE1.CSMP_NUM
     FROM
          CSMP_CONTR INLINE1
    WHERE
          INLINE1.EZCANCELFLAG = '0'
      AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
      AND INLINE1.DS_ACCT_NUM = #dsAcctNum#
      AND INLINE1.DLR_REF_NUM = #dlrRefNum#
      AND INLINE1.EFF_FROM_DT &lt;= #effFromDtFrom#
      AND NVL(INLINE1.EFF_THRU_DT, '99991231') &gt;= #effFromDtTo#
   </statement>
   <statement id="getCsmpPriceListName" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE1.PRC_CATG_NM
     FROM
          PRC_CATG INLINE1
    WHERE
          INLINE1.EZCANCELFLAG = '0'
      AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
      AND INLINE1.PRC_CATG_CD  = #prcCatgCd#
      AND INLINE1.ACTV_FLG     = #actvFlg#
      AND INLINE1.DEL_FLG      = #delFlg#
      AND INLINE1.EFF_FROM_DT &lt;= #effFromDtFrom#
      AND NVL(INLINE1.EFF_THRU_DT, '99991231') &gt;= #effFromDtTo#
   </statement>
   <statement id="getSpclCsmpExclArNm" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE3.SPCL_CSMP_EXCL_AR_NM
     FROM
          PRC_CATG INLINE1
         ,PRC_EQUIP_CONTR_ATTRB INLINE3
    WHERE
          INLINE1.EZCANCELFLAG = '0'
      AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
      AND INLINE1.PRC_CATG_CD = #prcCatgCd#
      AND INLINE1.ACTV_FLG = #actvFlg#
      AND INLINE1.DEL_FLG = #delFlg#
      AND INLINE1.EFF_FROM_DT &lt;= #effFromDtFrom#
      AND NVL(INLINE1.EFF_THRU_DT, '99991231') &gt;= #effFromDtTo#
      AND INLINE3.EZCANCELFLAG = '0'
      AND INLINE3.GLBL_CMPY_CD = INLINE1.GLBL_CMPY_CD
      AND INLINE3.PRC_CATG_CD = INLINE1.PRC_CATG_CD
   
   </statement>
   <statement id="getSvcMachMstr" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE2.ISTL_DT
         ,INLINE2.SVC_MACH_MSTR_PK
     FROM
          SVC_CONFIG_MSTR INLINE1
         ,SVC_MACH_MSTR INLINE2
    WHERE
          INLINE1.EZCANCELFLAG = '0'
      AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
      AND INLINE1.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
      AND INLINE2.EZCANCELFLAG = '0'
      AND INLINE2.GLBL_CMPY_CD = INLINE1.GLBL_CMPY_CD
      AND INLINE2.SVC_MACH_MSTR_PK = INLINE1.SVC_MACH_MSTR_PK
   </statement>
   <statement id="getSetAftrMrktItemList" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE1.MDSE_CD
         ,INLINE2.ORD_TAKE_MDSE_CD
     FROM
          INV_LINE INLINE1
         ,ORD_TAKE_MDSE INLINE2
    WHERE
          INLINE1.EZCANCELFLAG = '0'
      AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
      AND INLINE1.INV_NUM = #invNum#
      AND INLINE1.INV_BOL_LINE_NUM = #invBolLineNum#
      AND INLINE1.INV_LINE_NUM = #invLineNUm#
      AND INLINE2.EZCANCELFLAG(+) = '0'
      AND INLINE2.GLBL_CMPY_CD(+) = INLINE1.GLBL_CMPY_CD
      AND INLINE2.MDSE_CD (+)  = INLINE1.MDSE_CD
   </statement>
   <statement id="getAftrMrktItem" parameterClass="Map" resultClass="Map">
   SELECT
<!--          INLINE1.CSMP_AFT_MKT_MDSE_CD-->
        OTM.MDSE_CD     AS CSMP_AFT_MKT_MDSE_CD <!-- QC#24677 mod -->
     FROM
          CSMP_AFT_MKT_MAP INLINE1
        ,ORD_TAKE_MDSE OTM <!-- QC#24677 add -->
    WHERE
          INLINE1.EZCANCELFLAG = '0'
      AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
<!-- QC#24677 mod Star t-->
      <isNull property="setItemFlg">
       AND INLINE1.MDSE_CD = #mdseCd#
      </isNull>
      <isNotNull property="setItemFlg">
      AND (INLINE1.MDSE_CD = #mdseCd#
        OR (INLINE1.MDSE_CD = (
                    SELECT ORD_TAKE_MDSE_CD FROM ORD_TAKE_MDSE
                    WHERE GLBL_CMPY_CD = #glblCmpyCd#
                    AND MDSE_CD = #mdseCd#
                    AND EZCANCELFLAG = '0'
            )
        )
      )
      </isNotNull>
<!-- QC#24677 mod End-->
<!-- QC#24677 add Start-->
      AND INLINE1.GLBL_CMPY_CD          = OTM.GLBL_CMPY_CD
      AND INLINE1.CSMP_AFT_MKT_MDSE_CD  = OTM.ORD_TAKE_MDSE_CD
      AND OTM.EZCANCELFLAG              = '0'
<!-- QC#24677 add End-->
   </statement>
    <statement id="getReplacePriceCatg" parameterClass="Map" resultClass="Map">
   SELECT
          INLINE1.PRC_CATG_CD
     FROM
          PRC_CATG INLINE1
    WHERE
          INLINE1.EZCANCELFLAG = '0'
      AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
<!-- Mod Start QC#12252 -->
      AND INLINE1.PRC_CATG_NM = #prcCatgCd#
<!-- Mod End   QC#12252 -->
      AND INLINE1.ACTV_FLG = #actvFlg#
      AND INLINE1.DEL_FLG = #delFlg#
      AND INLINE1.EFF_FROM_DT &lt;= #invDt#
      AND NVL(INLINE1.EFF_THRU_DT, '99991231') &gt;= #invDt#
    </statement>
    <statement id="getLineList" parameterClass="Map" resultClass="Map">
SELECT
           INLINE1.INV_NUM
          ,INLINE1.INV_BOL_LINE_NUM
          ,INLINE1.INV_LINE_NUM
          ,INLINE1.INV_LINE_SUB_NUM
          ,INLINE1.INV_LINE_SUB_TRX_NUM
          ,INLINE1.DS_ORD_POSN_NUM
          ,INLINE1.DS_ORD_LINE_CATG_CD
          ,INLINE1.DS_CPO_LINE_NUM
          ,INLINE1.DS_CPO_LINE_SUB_NUM
          ,INLINE1.CUST_ISS_PO_NUM
          ,INLINE1.CUST_ISS_PO_DT
          ,INLINE1.BASE_CMPT_FLG
          ,INLINE1.CPO_DTL_LINE_NUM
          ,INLINE1.CPO_DTL_LINE_SUB_NUM
          ,INLINE1.SHPG_PLN_NUM
          ,INLINE1.STK_STS_CD
          ,INLINE1.FIRST_ORG_CD
          ,INLINE1.FIRST_ORG_NM
          ,INLINE1.SCD_ORG_CD
          ,INLINE1.SCD_ORG_NM
          ,INLINE1.THIRD_ORG_CD
          ,INLINE1.THIRD_ORG_NM
          ,INLINE1.FRTH_ORG_CD
          ,INLINE1.FRTH_ORG_NM
          ,INLINE1.FIFTH_ORG_CD
          ,INLINE1.FIFTH_ORG_NM
          ,INLINE1.SIXTH_ORG_CD
          ,INLINE1.SIXTH_ORG_NM
          ,INLINE1.SVNTH_ORG_CD
          ,INLINE1.SVNTH_ORG_NM
          ,INLINE1.EIGHTH_ORG_CD
          ,INLINE1.EIGHTH_ORG_NM
          ,INLINE1.SLS_REP_TOC_CD
          ,INLINE1.SLS_REP_TOC_NM
          ,INLINE1.ZEROTH_PROD_CTRL_CD
          ,INLINE1.ZEROTH_PROD_CTRL_NM
          ,INLINE1.FIRST_PROD_CTRL_CD
          ,INLINE1.FIRST_PROD_CTRL_NM
          ,INLINE1.SCD_PROD_CTRL_CD
          ,INLINE1.SCD_PROD_CTRL_NM
          ,INLINE1.THIRD_PROD_CTRL_CD
          ,INLINE1.THIRD_PROD_CTRL_NM
          ,INLINE1.FRTH_PROD_CTRL_CD
          ,INLINE1.FRTH_PROD_CTRL_NM
          ,INLINE1.FIFTH_PROD_CTRL_CD
          ,INLINE1.FIFTH_PROD_CTRL_NM
          ,INLINE1.SIXTH_PROD_CTRL_CD
          ,INLINE1.SIXTH_PROD_CTRL_NM
          ,INLINE1.SVNTH_PROD_CTRL_CD
          ,INLINE1.SVNTH_PROD_CTRL_NM
          ,INLINE1.MDSE_CD
          ,INLINE1.MDSE_NM
          ,INLINE1.COA_PROD_CD
          ,INLINE1.COA_PROD_NM
          ,INLINE1.TRX_CD
          ,INLINE1.TRX_RSN_CD
          ,INLINE1.ORD_QTY
          ,INLINE1.SHIP_QTY
          ,INLINE1.BO_QTY
          ,INLINE1.MAN_PRC_FLG
          ,INLINE1.DEAL_NET_UNIT_PRC_AMT
          ,INLINE1.INV_LINE_DEAL_TAX_AMT
          ,INLINE1.INV_LINE_DEAL_NET_AMT
          ,INLINE1.DEAL_DISC_UNIT_PRC_AMT
          ,INLINE1.FUNC_NET_UNIT_PRC_AMT
          ,INLINE1.INV_LINE_FUNC_TAX_AMT
          ,INLINE1.INV_LINE_FUNC_NET_AMT
          ,INLINE1.FUNC_DISC_UNIT_PRC_AMT
          ,INLINE1.TAX_FLG
          ,INLINE1.TAX_PCT
          ,INLINE1.U_CFC_MAT_CD
          ,INLINE1.U_CFC_MAT_NM
          ,INLINE1.U_CFC_TXT
          ,INLINE1.MERC_CNTN_FLG
          ,INLINE1.MERC_STMT_ON_INV_TXT
          ,INLINE1.COA_CMPY_CD
          ,INLINE1.COA_AFFL_CD
          ,INLINE1.COA_BR_CD
          ,INLINE1.COA_CH_CD
          ,INLINE1.COA_CC_CD
          ,INLINE1.COA_ACCT_CD
          ,INLINE1.COA_PROJ_CD
          ,INLINE1.COA_EXTN_CD
          ,INLINE1.CR_DR_RSN_SUB_CD
          ,INLINE1.ORIG_CPO_ORD_NUM
          ,INLINE1.ORIG_INV_NUM
          ,INLINE1.SET_MDSE_CD
          ,INLINE1.SHIP_CMPL_COST_AMT
          ,INLINE1.BR_CD
		  ,INLINE1.BR_NM
          ,INLINE1.DEAL_GRS_UNIT_PRC_AMT
          ,INLINE1.DEAL_GRS_TOT_PRC_AMT
          ,INLINE1.FUNC_GRS_UNIT_PRC_AMT
          ,INLINE1.FUNC_GRS_TOT_PRC_AMT
          ,INLINE1.SET_RATIO_KEEP_FLG
          ,INLINE1.UNIVS_PRMO_ID
          ,INLINE1.PRMO_SHORT_NM
          ,INLINE1.CR_DR_RSN_CD
          ,INLINE1.PRC_CATG_CD
          ,INLINE1.CPO_ORD_NUM
          ,INLINE1.HIST_CRAT_CPLT_FLG
      FROM
           INV_LINE INLINE1
     WHERE
           INLINE1.EZCANCELFLAG         ='0'
       AND INLINE1.GLBL_CMPY_CD         = #glblCmpyCd#
       AND INLINE1.INV_NUM              = #invNum#
       AND INLINE1.INV_BOL_LINE_NUM     = #invBolLineNum#
       AND INLINE1.INV_LINE_NUM         = #invLineNum#
       AND INLINE1.INV_LINE_SUB_NUM &lt;&gt; #invLineSubNum#
    </statement>
    <statement id="getSerNum" parameterClass="Map" resultClass="Map">
    SELECT
           INLINE1.SER_NUM
      FROM
           DS_INV_LINE_SER_NUM INLINE1
     WHERE
           INLINE1.EZCANCELFLAG = '0'
       AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
       AND INV_NUM = #invNum#
       AND INV_BOL_LINE_NUM = #invBolLineNum#
       AND INV_LINE_NUM = #invLineNum#
       AND INV_LINE_SUB_NUM = #invLineSubNum#
       AND INV_TRX_LINE_SUB_NUM = #invTrxLineSubNum#
    </statement>
    <statement id="getSlsCreditList" parameterClass="Map" resultClass="Map">
    SELECT
           DS_INV_SLS_CR_PK
          ,INV_NUM
          ,INV_BOL_LINE_NUM
          ,INV_LINE_NUM
          ,INV_LINE_SUB_NUM
          ,INV_TRX_LINE_SUB_NUM
          ,MDSE_CD
          ,INV_LINE_SPL_TP_CD
          ,INV_LINE_SPL_PCT
          ,SLS_REP_TOC_CD
          ,SLS_REP_CR_PCT
          ,DEAL_SLS_CR_AMT
          ,FUNC_SLS_CR_AMT
          ,DEAL_CCY_CD
          ,DFRD_ACCTG_RULE_CD
          ,DFRD_ACCTG_RULE_DURN_AOT
          ,DURN_START_DT
          ,DEAL_ORIG_DFRD_AMT
          ,FUNC_ORIG_DFRD_AMT
          ,DEAL_DFRD_BAL_AMT
          ,FUNC_DFRD_BAL_AMT
          ,DEAL_SCHD_REV_AMT
          ,FUNC_SCHD_REV_AMT
          ,REV_RECOG_CNT
          ,FIRST_REV_RECOG_DT
          ,NEXT_REV_RECOG_DT
          ,REV_RECOG_PROC_STS_CD
          ,SLS_REP_BR_CD
          ,COA_CMPY_CD
          ,COA_AFFL_CD
          ,COA_BR_CD
          ,COA_CH_CD
          ,COA_CC_CD
          ,COA_ACCT_CD
          ,COA_PROD_CD
          ,COA_PROJ_CD
          ,COA_EXTN_CD
          ,TRX_CD
          ,TRX_RSN_CD
          ,MAN_INV_CRAT_CMNT_TXT
          ,DS_CPO_CONFIG_PK
          ,SLS_REP_ROLE_TP_CD
          ,CPLT_REV_RECOG_DT
      FROM
           DS_INV_SLS_CR INLINE1
     WHERE
           INLINE1.EZCANCELFLAG = '0'
       AND INLINE1.GLBL_CMPY_CD = #glblCmpyCd#
       AND INLINE1.INV_NUM = #invNum#
       AND INLINE1.INV_BOL_LINE_NUM = #invBolLineNum#
       AND INLINE1.INV_LINE_NUM = #invLineNum#
       AND INLINE1.INV_LINE_SUB_NUM = #invLineSubNum#
       AND INLINE1.INV_TRX_LINE_SUB_NUM = #invTrxLineSubNum#
       <!-- QC#15533 -->
       AND (INLINE1.INV_LINE_SPL_TP_CD IS NULL OR INLINE1.INV_LINE_SPL_TP_CD NOT IN ('40','50'))
    </statement>
    <statement id="getDsAcctCust" parameterClass="Map" resultClass="Map">
    SELECT
        STC.SELL_TO_CUST_PK
    FROM
        SELL_TO_CUST STC
    WHERE
        STC.EZCANCELFLAG    = '0'
    AND STC.GLBL_CMPY_CD    = #glblCmpyCd#
    AND STC.SELL_TO_CUST_CD = #sellToCustCd#
    </statement>
    <statement id="getBillToCust" parameterClass="Map" resultClass="Map">
    SELECT
        BTC.BILL_TO_CUST_CD
    FROM
        SELL_TO_CUST STC
       ,ACCT_LOC AL
       ,BILL_TO_CUST BTC
       ,PRIN_CUST PC
    WHERE
        STC.EZCANCELFLAG = '0'
    AND STC.GLBL_CMPY_CD = #glblCmpyCd#
    AND STC.SELL_TO_CUST_CD = #sellToCustCd#
    AND STC.GLBL_CMPY_CD = AL.GLBL_CMPY_CD
    AND STC.SELL_TO_CUST_CD = AL.DS_ACCT_NUM
    AND AL.EZCANCELFLAG = '0'
    AND AL.EFF_FROM_DT &lt;= #slsDt#
    AND NVL(AL.EFF_THRU_DT, '99991231') &gt;= #slsDt#
    AND AL.RGTN_STS_CD = 'P20'
    AND AL.GLBL_CMPY_CD = BTC.GLBL_CMPY_CD
    AND AL.LOC_NUM = BTC.LOC_NUM
    AND BTC.EZCANCELFLAG = '0'
    AND BTC.LOC_NUM = PC.LOC_NUM
    AND PC.EZCANCELFLAG = '0'
    AND PC.GLBL_CMPY_CD = #glblCmpyCd#
    </statement>
    <!-- START 2018/01/05 Hd.Sugawara [QC#22371,ADD] -->
    <statement id="getCsmpExclFlg" parameterClass="Map" resultClass="Map">
    SELECT
        PCES.CSMP_EXCL_FLG
    FROM
        DS_INVTY_LOC_V DILV
       ,PRC_CALC_EXCL_SWH PCES
    WHERE
        DILV.GLBL_CMPY_CD = #glblCmpyCd#
    AND DILV.INVTY_LOC_CD = #invtyLocCd#
    AND DILV.EZCANCELFLAG = '0'
    AND PCES.GLBL_CMPY_CD = DILV.GLBL_CMPY_CD
    AND PCES.RTL_SWH_CD   = DILV.RTL_SWH_CD
    AND PCES.EZCANCELFLAG = '0'
    </statement>
    <!-- END 2018/01/05 Hd.Sugawara [QC#22371,ADD] -->
    <statement id="getCSMPInvErr" parameterClass="Map" resultClass="Map">
        SELECT
            CIE.CSMP_INV_ERR_PK
        FROM
            CSMP_INV_ERR CIE
        WHERE
            CIE.GLBL_CMPY_CD = #glblCmpyCd#
        AND CIE.EZCANCELFLAG = '0' 
        AND CIE.ORIG_INV_NUM = #origInvNum#
    </statement>
</sqlMap>