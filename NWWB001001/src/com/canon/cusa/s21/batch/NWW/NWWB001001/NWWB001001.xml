<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWWB001001">
    <statement id="getNtfyHdr" parameterClass="Map" resultClass="Map">
        SELECT
            NH.NTFY_HDR_PK
            ,NH.NTFY_HDR_ID
            ,NH.NTFY_HDR_NM
            ,NH.NTFY_HDR_DESC_TXT
            ,NH.NTFY_BIZ_AREA_TP_CD
            ,NH.NTFY_SUB_AREA_TP_CD
            ,NH.NTFY_FREQ_TP_CD
            ,NH.NTFY_INTVL_AOT
            ,NH.NTFY_INTVL_UOM_TP_CD
            ,NH.HIST_DAYS_AOT
            ,NRJ.NTFY_JOB_ID
            ,NH.NTFY_SQL_CLOD
            ,NH.NTFY_RUN_SUN_FLG
            ,NH.NTFY_RUN_MON_FLG
            ,NH.NTFY_RUN_TUE_FLG
            ,NH.NTFY_RUN_WED_FLG
            ,NH.NTFY_RUN_THU_FLG
            ,NH.NTFY_RUN_FRI_FLG
            ,NH.NTFY_RUN_SAT_FLG
            ,NH.NTFY_RUN_DAY_LIST_TXT
            ,NH.NTFY_RUN_MN_LIST_TXT
            ,NH.NTFY_END_HOUR_MN
            ,NH.NTFY_START_HOUR_MN
            ,NH.NTFY_EOM_FLG
        FROM
            NTFY_HDR NH
            ,NTFY_RUN_JOB NRJ
        WHERE
                NH.GLBL_CMPY_CD               = #glblCmpyCd#
            AND NH.EZCANCELFLAG               = '0'
            AND NH.EFF_FROM_DT                &lt;= #procDt#
            AND NVL(NH.EFF_THRU_DT,#maxDt#)   &gt;= #procDt#
            AND NH.NTFY_HDR_ACTV_FLG          = 'Y'

            AND NH.GLBL_CMPY_CD               = NRJ.GLBL_CMPY_CD 
            AND NH.EZCANCELFLAG               = NRJ.EZCANCELFLAG 
            AND NH.NTFY_HDR_PK                = NRJ.NTFY_HDR_PK
            AND NRJ.NEXT_RUN_TS               &lt;= #runTs#
            AND (
                    (
                        NRJ.NTFY_JOB_ID               IS NULL
                    AND MOD(NH.NTFY_HDR_ID, #jobCount#)       = #jobId#
                    )
                OR NRJ.NTFY_JOB_ID               = #jobId#
                )
    </statement>
    
    <statement id="execSQL" parameterClass="String" resultClass="Map">
        $SQL$
    </statement>
    
    <statement id="execSQLForOrderBy" parameterClass="String" resultClass="Map">
        SELECT
            *
        FROM(
            $SQL$
            ) A
        ORDER BY
            1
    </statement>
    
    <statement id="getNtfyActDtl" parameterClass="Map" resultClass="Map">
        SELECT
            NAD.NTFY_ACT_NM
            ,NAD.NTFY_ACT_ID
            ,NAD.NTFY_ACT_DTL_PK
            ,NAD.NTFY_ACT_TP_CD
            ,NAD.NTFY_OTPT_TP_CD
            ,NAD.NTFY_EML_RPY_TO_ADDR
            ,NAD.NTFY_EML_TO_ADDR
            ,NAD.NTFY_EML_CC_ADDR
            ,NAD.NTFY_EML_BCC_ADDR
            ,NAD.NTFY_EML_SUBJ_TXT
            ,NAD.NTFY_EML_BODY_CLOD
            ,NAD.RTRV_TO_ADDR_FROM_SQL_FLG
            ,NAD.NTFY_ATT_TP_CD
        FROM
            NTFY_ACT_DTL NAD
        WHERE
                NAD.GLBL_CMPY_CD = #glblCmpyCd#
            AND NAD.EZCANCELFLAG = '0'
            AND NAD.NTFY_HDR_PK  = #ntfyHdrPk#
    </statement>

    <statement id="getDistListAssign" parameterClass="Map" resultClass="Map">
        SELECT
            DLA.NTFY_DIST_QLFY_CD
            ,DLA.NTFY_DIST_LIST_ASG_VAL_TXT
            ,DL.NTFY_DIST_LIST_NM
        FROM
            NTFY_DIST_RELN NDR
            ,NTFY_DIST_LIST DL
            ,NTFY_DIST_LIST_ASG DLA
        WHERE
                NDR.GLBL_CMPY_CD = #glblCmpyCd#
            AND NDR.EZCANCELFLAG = '0'
            AND NDR.NTFY_ACT_DTL_PK = #ntfyActDtlPk#
        
            AND NDR.GLBL_CMPY_CD = DL.GLBL_CMPY_CD
            AND NDR.EZCANCELFLAG = DL.EZCANCELFLAG
            AND NDR.NTFY_DIST_LIST_PK = DL.NTFY_DIST_LIST_PK
            AND DL.EFF_FROM_DT               &lt;= #procDt#
            AND NVL(DL.EFF_THRU_DT,#maxDt#)               &gt;= #procDt#
            AND DL.NTFY_DIST_LIST_ACTV_FLG         = 'Y' 
        
            AND DL.GLBL_CMPY_CD = DLA.GLBL_CMPY_CD
            AND DL.EZCANCELFLAG = DLA.EZCANCELFLAG
            AND DL.NTFY_DIST_LIST_PK = DLA.NTFY_DIST_LIST_PK
            AND DLA.NTFY_DIST_LIST_ASG_ACTV_FLG = 'Y'
    </statement>
    
    <statement id="getDistListNm" parameterClass="Map" resultClass="String">
        SELECT
            DL.NTFY_DIST_LIST_NM
        FROM
            NTFY_DIST_RELN NDR
            ,NTFY_DIST_LIST DL
        WHERE
                NDR.GLBL_CMPY_CD = #glblCmpyCd#
            AND NDR.EZCANCELFLAG = '0'
            AND NDR.NTFY_ACT_DTL_PK = #ntfyActDtlPk#
        
            AND NDR.GLBL_CMPY_CD = DL.GLBL_CMPY_CD
            AND NDR.EZCANCELFLAG = DL.EZCANCELFLAG
            AND NDR.NTFY_DIST_LIST_PK = DL.NTFY_DIST_LIST_PK
    </statement>
    
    <statement id="getMlAddr" parameterClass="Map" resultClass="String">
        SELECT DISTINCT
            A.$colNm$ ML_ADDR
        FROM
            $tblNm$ A
        WHERE
                A.GLBL_CMPY_CD = #glblCmpyCd#
            AND A.EZCANCELFLAG = '0'
            AND $sql$
    </statement>
    
    <statement id="getNtfySbscr" parameterClass="Map" resultClass="String">
        SELECT
            A.$mlColNm$ ML_ADDR
        FROM
            NTFY_SBSCR NS
            ,$tblNm$ A
        WHERE
                NS.GLBL_CMPY_CD = #glblCmpyCd#
            AND NS.EZCANCELfLAG = '0'
            AND NS.NTFY_HDR_PK = #ntfyHdrPk#
            AND NS.NTFY_SBSCR_FLG = 'N'
        
            AND NS.GLBL_CMPY_CD = A.GLBL_CMPY_CD
            AND NS.EZCANCELFLAG = A.EZCANCELFLAG
            AND NS.NTFY_SBSCR_PSN_CD = A.$psnColNm$
    </statement>
    
    <statement id="getNtfyActDtlCol" parameterClass="Map" resultClass="Map">
        SELECT
            NADC.NTFY_ACT_DTL_COL_SORT_NUM
            ,NADC.HDR_LB_NM
            ,NADC.PLACE_HLD_NM
        FROM
            NTFY_ACT_DTL_COL NADC
        WHERE
                NADC.GLBL_CMPY_CD = #glblCmpyCd#
            AND NADC.EZCANCELFLAG = '0'
            AND NADC.NTFY_ACT_DTL_PK = #ntfyActDtlPk#
        ORDER BY
            NADC.NTFY_ACT_DTL_COL_SORT_NUM
    </statement>
</sqlMap>
