<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSAL1050Query">
    <typeAlias alias="NSAL1050_ACMsg"  type="business.blap.NSAL1050.NSAL1050_ACMsg"/>
        <statement id="getSearchData" parameterClass="Map" resultMap="result.getSearchData">
            WITH SVC_TERM_COND_DATA_SRC_V AS (
                SELECT
                     SVC_TERM_COND_DATA_SRC_CD
                    ,SVC_TERM_COND_SRC_DESC_TXT
                FROM (
                    SELECT
                         SVC_TERM_COND_DATA_SRC_CD
                        ,SVC_TERM_COND_SRC_DESC_TXT
                        ,ROW_NUMBER() OVER (PARTITION BY SVC_TERM_COND_DATA_SRC_CD ORDER BY SVC_TERM_COND_DATA_SORT_NUM) AS ROW_NUM
                    FROM
                        SVC_TERM_COND_DATA_SRC
                    WHERE
                        GLBL_CMPY_CD       = #glblCmpyCd#
                        AND EZCANCELFLAG   = '0')
                WHERE
                    ROW_NUM = 1
                )
            SELECT
                 SVC_TERM_ATTRB_DESC_TXT
                ,SVC_TERM_COND_ATTRB_NM
                ,SVC_TERM_ATTRB_SORT_NUM
                ,SVC_TERM_ATTRB_CONTR_FLG
                ,SVC_TERM_ATTRB_MACH_FLG
                ,SVC_TERM_ATTRB_ACTV_FLG
                ,EFF_FROM_DT
                ,EFF_THRU_DT
                ,SVC_TERM_COND_DATA_SRC_CD
                ,SVC_TERM_COND_CATG_PK
                ,SVC_TERM_DATA_TP_CD
                ,SVC_TERM_COND_ATTRB_PK
                ,EZUPTIME
                ,EZUPTIMEZONE
                ,SVC_TERM_COND_CATG_DESC_TXT
                ,SVC_TERM_COND_SRC_DESC_TXT
                ,SVC_TERM_DATA_TP_DESC_TXT
                <!-- START 2016/11/30 K.Kojima [QC#14204, ADD] -->
                ,XX_REC_HIST_CRAT_TS_A
                ,XX_REC_HIST_CRAT_BY_NM_A
                ,XX_REC_HIST_UPD_TS_A
                ,XX_REC_HIST_UPD_BY_NM_A
                ,XX_REC_HIST_TBL_NM_A
                <!-- END 2016/11/30 K.Kojima [QC#14204, ADD] -->
            FROM (
                SELECT
                     A.SVC_TERM_ATTRB_DESC_TXT      AS  SVC_TERM_ATTRB_DESC_TXT
                    ,A.SVC_TERM_COND_ATTRB_NM       AS  SVC_TERM_COND_ATTRB_NM
                    ,A.SVC_TERM_ATTRB_SORT_NUM      AS  SVC_TERM_ATTRB_SORT_NUM
                    ,A.SVC_TERM_ATTRB_CONTR_FLG     AS  SVC_TERM_ATTRB_CONTR_FLG
                    ,A.SVC_TERM_ATTRB_MACH_FLG      AS  SVC_TERM_ATTRB_MACH_FLG
                    ,A.SVC_TERM_ATTRB_ACTV_FLG      AS  SVC_TERM_ATTRB_ACTV_FLG
                    ,A.EFF_FROM_DT                  AS  EFF_FROM_DT
                    ,A.EFF_THRU_DT                  AS  EFF_THRU_DT
                    <!-- START 2016/11/30 K.Kojima [QC#18214, MOD] -->
                    <!-- ,A.SVC_TERM_COND_DATA_SRC_CD    AS  SVC_TERM_COND_DATA_SRC_CD -->
                    ,CASE
                        WHEN A.SVC_TERM_COND_DATA_SRC_CD IS NULL
                        THEN A.PHYS_MAINT_TRGT_TBL_NM
                        ELSE A.SVC_TERM_COND_DATA_SRC_CD
                     END                            AS  SVC_TERM_COND_DATA_SRC_CD
                    <!-- END 2016/11/30 K.Kojima [QC#18214, MOD] -->
                    ,A.SVC_TERM_COND_CATG_PK        AS  SVC_TERM_COND_CATG_PK
                    ,A.SVC_TERM_DATA_TP_CD          AS  SVC_TERM_DATA_TP_CD
                    ,A.SVC_TERM_COND_ATTRB_PK       AS  SVC_TERM_COND_ATTRB_PK
                    ,A.EZUPTIME                     AS  EZUPTIME
                    ,A.EZUPTIMEZONE                 AS  EZUPTIMEZONE
                    ,B.SVC_TERM_COND_CATG_DESC_TXT  AS  SVC_TERM_COND_CATG_DESC_TXT
                    ,CASE
                        WHEN A.SVC_TERM_COND_DATA_SRC_CD IS NULL
                        THEN E.LOGIC_MAINT_TRGT_TBL_NM
                        ELSE C.SVC_TERM_COND_SRC_DESC_TXT
                     END                            AS  SVC_TERM_COND_SRC_DESC_TXT
                    ,D.SVC_TERM_DATA_TP_DESC_TXT    AS  SVC_TERM_DATA_TP_DESC_TXT
                   <!-- START 2016/11/30 K.Kojima [QC#14204, ADD] -->
                   ,A.EZINTIME                    AS XX_REC_HIST_CRAT_TS_A
                   ,A.EZINUSERID                  AS XX_REC_HIST_CRAT_BY_NM_A
                   ,A.EZUPTIME                    AS XX_REC_HIST_UPD_TS_A
                   ,A.EZUPUSERID                  AS XX_REC_HIST_UPD_BY_NM_A
                   ,A.EZTABLEID                   AS XX_REC_HIST_TBL_NM_A
                   <!-- END 2016/11/30 K.Kojima [QC#14204, ADD] -->
                FROM
                     SVC_TERM_COND_ATTRB       A
                    ,SVC_TERM_COND_CATG        B
                    ,SVC_TERM_COND_DATA_SRC_V  C
                    ,SVC_TERM_ATTRB_DATA_TP    D
                    ,SVC_TERM_COND_ATTRB_MAP   E
                WHERE
                        A.GLBL_CMPY_CD                      = #glblCmpyCd#
                <isNotNull property="svcTermAttrbDescTxt">
                    AND A.SVC_TERM_ATTRB_DESC_TXT           LIKE #svcTermAttrbDescTxt#
                </isNotNull>
                <isEqual property="activeFlg" compareValue="Y">
                    AND A.SVC_TERM_ATTRB_ACTV_FLG           = #activeFlg#
                    AND A.EFF_FROM_DT                       &lt;= #slsDate#
                    AND NVL(A.EFF_THRU_DT, #hitDate#)       &gt;= #slsDate#
                </isEqual>
                    AND A.GLBL_CMPY_CD                      = B.GLBL_CMPY_CD (+)
                    AND A.SVC_TERM_COND_CATG_PK             = B.SVC_TERM_COND_CATG_PK (+)
                    AND B.SVC_TERM_COND_CATG_ACTV_FLG (+)   = #svcTermCondCatgActvFlg#
                    AND B.EFF_FROM_DT (+)                   &lt;= #slsDate#
                    AND NVL(B.EFF_THRU_DT (+), #hitDate#)   &gt;= #slsDate#
                    AND A.SVC_TERM_COND_DATA_SRC_CD         = C.SVC_TERM_COND_DATA_SRC_CD (+)
                    AND A.GLBL_CMPY_CD                      = D.GLBL_CMPY_CD (+)
                    AND A.SVC_TERM_DATA_TP_CD               = D.SVC_TERM_ATTRB_DATA_TP_CD (+)
                    AND A.GLBL_CMPY_CD                      = E.GLBL_CMPY_CD (+)
                    AND A.PHYS_MAINT_TRGT_TBL_NM            = E.PHYS_MAINT_TRGT_TBL_NM (+)
                    AND A.EZCANCELFLAG                      = '0'
                    AND B.EZCANCELFLAG(+)                   = '0'
                    AND D.EZCANCELFLAG(+)                   = '0'
                    AND E.EZCANCELFLAG(+)                   = '0'
                ORDER BY
                    A.SVC_TERM_ATTRB_DESC_TXT               ASC
            )
            WHERE
                ROWNUM    &lt;= #rowNum#
    </statement>
    <resultMap id="result.getSearchData"          class="NSAL1050_ACMsg">
        <result property="svcTermAttrbDescTxt_A"    column="SVC_TERM_ATTRB_DESC_TXT"      javaType="EZDSStringItem" />
        <result property="svcTermCondAttrbNm_A"     column="SVC_TERM_COND_ATTRB_NM"       javaType="EZDSStringItem" />
        <result property="svcTermAttrbSortNum_A"    column="SVC_TERM_ATTRB_SORT_NUM"      javaType="EZDCBigDecimalItem" />
        <result property="xxChkBox_AC"              column="SVC_TERM_ATTRB_CONTR_FLG"     javaType="EZDSStringItem" />
        <result property="xxChkBox_AM"              column="SVC_TERM_ATTRB_MACH_FLG"      javaType="EZDSStringItem" />
        <result property="xxChkBox_AA"              column="SVC_TERM_ATTRB_ACTV_FLG"      javaType="EZDSStringItem" />
        <result property="effFromDt_A"              column="EFF_FROM_DT"                  javaType="EZDSStringItem" />
        <result property="effToDt_A"                column="EFF_THRU_DT"                  javaType="EZDSStringItem" />
        <result property="svcTermCondDataSrcCd_A"   column="SVC_TERM_COND_DATA_SRC_CD"    javaType="EZDSStringItem" />
        <result property="svcTermCondCatgPk_1V"     column="SVC_TERM_COND_CATG_PK"        javaType="EZDCBigDecimalItem" />
        <result property="svcTermCondAttrbPk_A"     column="SVC_TERM_COND_ATTRB_PK"       javaType="EZDCBigDecimalItem" />
        <result property="ezUpTime"                 column="EZUPTIME"                 javaType="EZDSStringItem" />
        <result property="ezUpTimeZone"             column="EZUPTIMEZONE"             javaType="EZDSStringItem" />
        <result property="svcTermCondCatgDescTxt_A" column="SVC_TERM_COND_CATG_DESC_TXT"  javaType="EZDSStringItem" />
        <result property="svcTermDataTpCd_1V"       column="SVC_TERM_DATA_TP_CD"          javaType="EZDSStringItem" />
        <result property="svcTermDataTpDescTxt_A"   column="SVC_TERM_DATA_TP_DESC_TXT"    javaType="EZDSStringItem" />
        <result property="svcTermCondSrcDescTxt_A"  column="SVC_TERM_COND_SRC_DESC_TXT"   javaType="EZDSStringItem" />
        <!-- START 2016/11/30 K.Kojima [QC#14204, ADD] -->
        <result property="xxRecHistCratTs_A"        column="XX_REC_HIST_CRAT_TS_A"        javaType="EZDSStringItem"/>
        <result property="xxRecHistCratByNm_A"      column="XX_REC_HIST_CRAT_BY_NM_A"     javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdTs_A"         column="XX_REC_HIST_UPD_TS_A"         javaType="EZDSStringItem"/>
        <result property="xxRecHistUpdByNm_A"       column="XX_REC_HIST_UPD_BY_NM_A"      javaType="EZDSStringItem"/>
        <result property="xxRecHistTblNm_A"         column="XX_REC_HIST_TBL_NM_A"         javaType="EZDSStringItem"/>
        <!-- END 2016/11/30 K.Kojima [QC#14204, ADD] -->
    </resultMap>
</sqlMap>
