<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAL2330Query">

    <typeAlias alias="NWAL2330CMsg"    type="business.blap.NWAL2330.NWAL2330CMsg"/>
    <typeAlias alias="NWAL2330_ACMsg"  type="business.blap.NWAL2330.NWAL2330_ACMsg"/>

    <statement id="search" parameterClass="Map" resultMap="result.search">
        SELECT
            TBL_DATA_SET.CPO_ORD_NUM
            ,TBL_DATA_SET.INV_NUM
            ,TBL_DATA_SET.SO_NUM
            ,TBL_DATA_SET.ORD_DT
            ,TBL_DATA_SET.INV_DT
            ,TBL_DATA_SET.SOLD_NM
            ,TBL_DATA_SET.BILL_NM
            ,TBL_DATA_SET.SHIP_NM
            ,TBL_DATA_SET.INV_TOT_FUNC_NET_AMT
            ,TBL_DATA_SET.CPO_SRC_TP_DESC_TXT
            ,TBL_DATA_SET.DS_ORD_CATG_DESC_TXT
            ,TBL_DATA_SET.DS_ORD_TP_DESC_TXT 
        FROM
            (
            SELECT DISTINCT
                 TBL_DATA.CPO_ORD_NUM
                ,TBL_DATA.INV_NUM
                ,TBL_DATA.SO_NUM
                ,TBL_DATA.ORD_DT
                ,TBL_DATA.INV_DT
                ,TBL_DATA.SOLD_NM
                ,TBL_DATA.BILL_NM
                ,TBL_DATA.SHIP_NM
                ,TBL_DATA.INV_TOT_FUNC_NET_AMT
                ,TBL_DATA.CPO_SRC_TP_DESC_TXT
                ,TBL_DATA.DS_ORD_CATG_DESC_TXT
                ,TBL_DATA.DS_ORD_TP_DESC_TXT
            FROM
                (
                 SELECT
                     I.CPO_ORD_NUM
                    ,I.INV_NUM
                    ,IB.SO_NUM
                    ,I.ORD_DT
                    ,I.INV_DT
                    ,STC1.DS_ACCT_NM SOLD_NM
                    ,STC2.DS_ACCT_NM BILL_NM
                    ,STC3.DS_ACCT_NM SHIP_NM
                    ,I.INV_TOT_FUNC_NET_AMT
                    ,CST.CPO_SRC_TP_DESC_TXT
                    ,DOC.DS_ORD_CATG_DESC_TXT
                    ,DOT.DS_ORD_TP_DESC_TXT
                 FROM
                     INV          I
                    ,INV_BOL      IB
                    ,CPO          CPO
                    ,CPO_SRC_TP   CST
                    ,DS_ORD_CATG  DOC
                    ,DS_ORD_TP    DOT
                    ,SELL_TO_CUST STC1
                    ,SELL_TO_CUST STC2
                    ,SELL_TO_CUST STC3
                WHERE
                    I.GLBL_CMPY_CD = #glblCmpyCd#
                AND
                    I.EZCANCELFLAG = '0'
                <isNotNull property="cpoOrdNum">
                AND I.CPO_ORD_NUM LIKE #cpoOrdNum#
                </isNotNull>
                <isNotNull property="ordDtFrom">
                AND I.ORD_DT &gt;= #ordDtFrom#
                </isNotNull>
                <isNotNull property="ordDtTo">
                AND I.ORD_DT &lt;= #ordDtTo#
                </isNotNull>
                <isNotNull property="invDtFrom">
                AND I.INV_DT &gt;= #invDtFrom#
                </isNotNull>
                <isNotNull property="invDtTo">
                AND I.INV_DT &lt;= #invDtTo#
                </isNotNull>
                <isNotNull property="sellToCustCd">
                AND I.SELL_TO_CUST_CD LIKE #sellToCustCd#
                </isNotNull>
                <isNotNull property="invNum">
                AND I.INV_NUM LIKE #invNum#
                </isNotNull>
                <isNotNull property="billToCustAcctCd">
                AND I.BILL_TO_CUST_ACCT_CD LIKE #billToCustAcctCd#
                </isNotNull>
                <isNotNull property="dsOrdCatgCd">
                AND I.DS_ORD_CATG_CD = #dsOrdCatgCd#
                </isNotNull>
                <isNotNull property="dsOrdTpCd">
                AND I.DS_ORD_TP_CD = #dsOrdTpCd#
                </isNotNull>
                AND
                    IB.GLBL_CMPY_CD = I.GLBL_CMPY_CD
                AND
                    IB.EZCANCELFLAG = '0'
                AND
                    IB.INV_NUM = I.INV_NUM
                <isNotNull property="soNum">
                AND IB.SO_NUM LIKE #soNum#
                </isNotNull>
                <isNotNull property="shipToCustAcctCd">
                AND IB.SHIP_TO_CUST_ACCT_CD LIKE #shipToCustAcctCd#
                </isNotNull>
                AND
                    I.GLBL_CMPY_CD = CPO.GLBL_CMPY_CD(+)
                AND
                    CPO.EZCANCELFLAG(+) = '0'
                AND
                    I.CPO_ORD_NUM = CPO.CPO_ORD_NUM(+)
                <isNotNull property="cpoSrcTpCd">
                AND CPO.CPO_SRC_TP_CD = #cpoSrcTpCd#
                </isNotNull>
                AND
                    CPO.GLBL_CMPY_CD = CST.GLBL_CMPY_CD(+)
                AND
                    CST.EZCANCELFLAG(+) = '0'
                AND
                    CPO.CPO_SRC_TP_CD = CST.CPO_SRC_TP_CD(+)
                AND
                    I.GLBL_CMPY_CD = DOC.GLBL_CMPY_CD(+)
                AND
                    DOC.EZCANCELFLAG(+) = '0'
                AND
                    I.DS_ORD_CATG_CD = DOC.DS_ORD_CATG_CD(+)
                AND
                    I.GLBL_CMPY_CD = DOT.GLBL_CMPY_CD(+)
                AND
                    DOT.EZCANCELFLAG(+) = '0'
                AND
                    I.DS_ORD_TP_CD = DOT.DS_ORD_TP_CD(+)
                AND
                    I.GLBL_CMPY_CD = STC1.GLBL_CMPY_CD(+)
                AND
                    STC1.EZCANCELFLAG(+) ='0'
                AND
                    I.SELL_TO_CUST_CD = STC1.SELL_TO_CUST_CD(+)
                <isNotNull property="dsAcctNm1">
                AND STC1.DS_ACCT_NM LIKE #dsAcctNm1#
                </isNotNull>
                AND
                    I.GLBL_CMPY_CD = STC2.GLBL_CMPY_CD(+)
                AND
                    STC2.EZCANCELFLAG(+) = '0'
                AND
                    I.BILL_TO_CUST_ACCT_CD = STC2.SELL_TO_CUST_CD(+)
                <isNotNull property="dsAcctNm2">
                AND STC2.DS_ACCT_NM LIKE #dsAcctNm2#
                </isNotNull>
                AND
                    IB.GLBL_CMPY_CD = STC3.GLBL_CMPY_CD(+)
                AND
                    STC3.EZCANCELFLAG(+) = '0'
                AND
                    IB.SHIP_TO_CUST_ACCT_CD = STC3.SELL_TO_CUST_CD(+)
                <isNotNull property="dsAcctNm3">
                AND STC3.DS_ACCT_NM LIKE #dsAcctNm3#
                </isNotNull>
                ORDER BY
                     I.CPO_ORD_NUM
                    ,I.INV_NUM
                    ,IB.SO_NUM
                ) TBL_DATA
            ) TBL_DATA_SET
        WHERE
            ROWNUM &lt; #rowNum#
    </statement>

    <resultMap id="result.search" class="NWAL2330_ACMsg">
        <result property="cpoOrdNum_A1"         column="CPO_ORD_NUM"           javaType="EZDCStringItem"/>
        <result property="invNum_A1"            column="INV_NUM"               javaType="EZDCStringItem"/>
        <result property="soNum_A1"             column="SO_NUM"                javaType="EZDCStringItem"/>
        <result property="ordDt_A1"             column="ORD_DT"                javaType="EZDCDateItem"/>
        <result property="invDt_A1"             column="INV_DT"                javaType="EZDCDateItem"/>
        <result property="dsAcctNm_A1"          column="SOLD_NM"               javaType="EZDCStringItem"/>
        <result property="dsAcctNm_A2"          column="BILL_NM"               javaType="EZDCStringItem"/>
        <result property="dsAcctNm_A3"          column="SHIP_NM"               javaType="EZDCStringItem"/>
        <result property="invTotFuncNetAmt_A1"  column="INV_TOT_FUNC_NET_AMT"  javaType="EZDCBigDecimalItem"/>
        <result property="cpoSrcTpDescTxt_A1"   column="CPO_SRC_TP_DESC_TXT"   javaType="EZDCStringItem"/>
        <result property="dsOrdCatgDescTxt_A1"  column="DS_ORD_CATG_DESC_TXT"  javaType="EZDCStringItem"/>
        <result property="dsOrdTpDescTxt_A1"    column="DS_ORD_TP_DESC_TXT"    javaType="EZDCStringItem"/>
        
    </resultMap>

    <statement id="getPullDownData" resultClass="Map" parameterClass="Map">
        SELECT
                DOT.DS_ORD_TP_CD
               ,DOT.DS_ORD_TP_DESC_TXT
        FROM
                DS_ORD_TP DOT
        WHERE
                DOT.GLBL_CMPY_CD = #glblCmpyCd#
        AND
                DOT.EZCANCELFLAG = '0'
        AND
                DOT.DS_ORD_CATG_CD = #dsOrdCatgCd#
        ORDER BY
                DOT.DS_ORD_TP_SORT_NUM
    </statement>

</sqlMap>

