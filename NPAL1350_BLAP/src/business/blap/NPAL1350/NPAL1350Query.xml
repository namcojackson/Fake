<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NPAL1350Query">
    <typeAlias alias="NPAL1350CMsg" type="business.blap.NPAL1350.NPAL1350CMsg" />
    <typeAlias alias="NPAL1350SMsg" type="business.blap.NPAL1350.NPAL1350SMsg" />
    <typeAlias alias="NPAL1350_ASMsg" type="business.blap.NPAL1350.NPAL1350_ASMsg" />

    <statement id="getSearchOptionPulldownList" parameterClass="Map"
        resultClass="Map">
        SELECT
            SSO.SRCH_OPT_PK
            ,SSO.SRCH_OPT_NM
        FROM
            SAVE_SRCH_OPT SSO
        WHERE
                SSO.GLBL_CMPY_CD    = #glblCmpyCd#
            AND SSO.SRCH_OPT_APL_ID = #srchOptAplId#
            AND SSO.SRCH_OPT_USR_ID = #srchOptUsrId#
            AND SSO.EZCANCELFLAG    = '0'
        ORDER BY
            SSO.SRCH_OPT_NM ASC
    </statement>
    <statement id="getWorkOrderStatusPulldownList" parameterClass="Map" resultClass="Map">
        SELECT
            WOS.DS_WRK_ORD_STS_NM
            ,MAX(WOS.WRK_ORD_STS_SORT_NUM) AS MAX_WRK_ORD_STS_SORT_NUM
        FROM
            WRK_ORD_STS WOS
        WHERE
                WOS.GLBL_CMPY_CD    = #glblCmpyCd#
            AND WOS.EZCANCELFLAG    = '0'
        GROUP BY
            WOS.DS_WRK_ORD_STS_NM
        ORDER BY
            MAX_WRK_ORD_STS_SORT_NUM ASC
    </statement>
    <statement id="getKitBom" parameterClass="Map" resultClass="Map">
        SELECT WO.GLBL_CMPY_CD
              ,WO.WRK_ORD_NUM
              ,WO.FNSH_GOODS_MDSE_CD
              ,WO.FNSH_GOODS_ORD_QTY
              ,WO.RQST_RCV_DT
              ,WO.KIT_BOM_PRINT_FLG
              ,WO.WRK_ORD_MSG_TXT
              ,WO.RTL_WH_CD
              ,WOD.SO_NUM
              ,WOD.WRK_ORD_DTL_LINE_NUM
              ,WOD.ORIG_GOODS_MDSE_CD
              ,WOD.ORIG_GOODS_ORD_QTY
              ,WO.FNSH_MDSE_DESC_SHORT_TXT
              ,WOD.ORIG_MDSE_DESC_SHORT_TXT
              ,DSWOT.DS_WRK_ORD_TP_DESC_TXT
              ,WOD.ORIG_GOODS_ORD_QTY / WO.FNSH_GOODS_ORD_QTY AS CHILD_MDSE_QTY
              ,WOD.SPLY_RTL_SWH_CD
              ,WH.RTL_WH_NM
              ,WH.WH_OWNR_CD
              ,WH.ATTN_NM
              ,WH.FIRST_LINE_ADDR
              ,WH.SCD_LINE_ADDR  
              ,WH.THIRD_LINE_ADDR
              ,WH.FRTH_LINE_ADDR
              ,WH.CTY_ADDR || ' ' || WH.ST_CD || ' ' || WH.POST_CD || ' ' || WH.CTRY_CD AS FIFTH_LINE_ADDR
              ,'TEL : ' || WH.TEL_NUM || 'FAX : ' || WH.FAX_NUM AS SIXTH_LINE_ADDR
        FROM   WRK_ORD WO
              ,WRK_ORD_DTL WOD
              ,DS_WRK_ORD_TP DSWOT
              ,RTL_WH WH
        WHERE  1 = 1
        AND    WO.WRK_ORD_NUM  = #wrkOrdNum#
        AND    WO.GLBL_CMPY_CD = #glblCmpyCd#
        AND    WO.EZCANCELFLAG = '0'
        AND    WO.GLBL_CMPY_CD = WOD.GLBL_CMPY_CD
        AND    WO.WRK_ORD_NUM  = WOD.WRK_ORD_NUM
        AND    WOD.EZCANCELFLAG = '0'
        AND    WO.GLBL_CMPY_CD     = DSWOT.GLBL_CMPY_CD
        AND    WO.DS_WRK_ORD_TP_CD = DSWOT.DS_WRK_ORD_TP_CD
        AND    DSWOT.EZCANCELFLAG     = '0'
        AND    WO.GLBL_CMPY_CD = WH.GLBL_CMPY_CD
        AND CASE WO.DS_WRK_ORD_TP_CD WHEN '1' THEN WO.RTL_WH_CD ELSE WO.INVTY_LOC_CD END = WH.RTL_WH_CD
    </statement>

    <statement id="getCmpsnMsg" parameterClass="Map" resultClass="Map">
        SELECT
            MSG.PRNT_MDSE_CD
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  1 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_01
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  2 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_02
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  3 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_03
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  4 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_04
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  5 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_05
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  6 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_06
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  7 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_07
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  8 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_08
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN  9 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_09
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN 10 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_10
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN 11 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_11
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN 12 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_12
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN 13 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_13
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN 14 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_14
           ,MAX(CASE MSG.CMPSN_MSG_SEG_ID WHEN 15 THEN MSG.CMPSN_MSG_TXT END) BOM_KIT_CMNT_TXT_15
        FROM
            WRK_ORD   WOH
           ,CMPSN_MSG MSG
        WHERE
            WOH.GLBL_CMPY_CD       = #glblCmpyCd#
        AND WOH.WRK_ORD_NUM        = #wrkOrdNum#
        AND WOH.EZCANCELFLAG       = '0'
        AND WOH.GLBL_CMPY_CD       = MSG.GLBL_CMPY_CD
        AND WOH.FNSH_GOODS_MDSE_CD = MSG.PRNT_MDSE_CD
        AND MSG.EZCANCELFLAG       = '0'
        GROUP BY
            MSG.PRNT_MDSE_CD
        ORDER BY
            MSG.PRNT_MDSE_CD
    </statement>

    <statement id="search" parameterClass="Map"
        resultMap="result.NPAL1350_ASMsg">
        SELECT
            T1.WRK_ORD_NUM
            ,T1.WRK_ORD_TP_CD
            ,T1.WRK_ORD_STS_CD
            ,T1.WRK_ORD_DT
            ,T1.FNSH_GOODS_MDSE_CD
            ,T1.RQST_RCV_DT
            ,T1.FNSH_GOODS_ORD_QTY
            ,T1.FNSH_GOODS_RCV_QTY
            ,T1.FNSH_GOODS_BAL_QTY
            ,T1.FNSH_GOODS_CANC_QTY
            ,T1.DS_WRK_ORD_TP_CD
            ,T1.RTL_WH_CD
            ,T1.CPLT_RTL_SWH_CD
            ,T1.OLD_WRK_ORD_NUM
            ,T1.FNSH_MDSE_DESC_SHORT_TXT
            ,T1.DS_WRK_ORD_TP_DESC_TXT
            ,T1.DS_WRK_ORD_STS_NM
            ,T1.RTL_WH_NM
            ,T1.RTL_SWH_NM
            ,T1.EZUPTIME        WO_EZUPTIME
            ,T1.EZUPTIMEZONE    WO_EZUPTIMEZONE
        FROM
            (SELECT
                WO.WRK_ORD_NUM
                ,WO.WRK_ORD_TP_CD
                ,WO.WRK_ORD_STS_CD
                ,WO.WRK_ORD_DT
                ,WO.FNSH_GOODS_MDSE_CD
                ,WO.RQST_RCV_DT
                ,WO.FNSH_GOODS_ORD_QTY
                ,WO.FNSH_GOODS_RCV_QTY
                ,WO.FNSH_GOODS_BAL_QTY
                ,WO.FNSH_GOODS_CANC_QTY
                ,WO.DS_WRK_ORD_TP_CD
                ,WO.RTL_WH_CD
                ,WO.CPLT_RTL_SWH_CD
                ,WO.OLD_WRK_ORD_NUM
                ,WO.FNSH_MDSE_DESC_SHORT_TXT
                ,DWOT.DS_WRK_ORD_TP_DESC_TXT
                ,WOS.DS_WRK_ORD_STS_NM
                ,RW.RTL_WH_NM
                ,RS.RTL_SWH_NM
                ,WO.EZUPTIME
                ,WO.EZUPTIMEZONE
            FROM
                WRK_ORD         WO
                ,DS_WRK_ORD_TP  DWOT
                ,WRK_ORD_STS    WOS
                ,RTL_WH         RW
                ,RTL_SWH        RS
            WHERE
                    WO.GLBL_CMPY_CD                        =      #glblCmpyCd#
            <isNotNull property="cMsg.wrkOrdNum">
                AND WO.WRK_ORD_NUM                         LIKE   #cMsg.wrkOrdNum#
            </isNotNull>
                AND WO.WRK_ORD_TP_CD                       =      #wrkOrdTpCd#
            <isNotNull property="cMsg.dsWrkOrdStsNm_PL">
                AND WO.WRK_ORD_STS_CD                      IN (
                    SELECT
                        WOS.WRK_ORD_STS_CD
                    FROM
                        WRK_ORD_STS WOS
                    WHERE
                            WOS.GLBL_CMPY_CD       =  #glblCmpyCd#
                        AND WOS.DS_WRK_ORD_STS_NM  =  #cMsg.dsWrkOrdStsNm_PL#
                        AND WOS.EZCANCELFLAG       =  '0'
                )
            </isNotNull>
            <isNotNull property="cMsg.wrkOrdDt_FM">
                AND WO.WRK_ORD_DT                      &gt;=      #cMsg.wrkOrdDt_FM#
            </isNotNull>
            <isNotNull property="cMsg.wrkOrdDt_TO">
                AND WO.WRK_ORD_DT                      &lt;=      #cMsg.wrkOrdDt_TO#
            </isNotNull>
            <isNotNull property="cMsg.prntMdseCd">
                AND WO.FNSH_GOODS_MDSE_CD                  LIKE   #cMsg.prntMdseCd#
            </isNotNull>
            <isNotNull property="cMsg.rqstRcvDt_FM">
                AND WO.RQST_RCV_DT                     &gt;=      #cMsg.rqstRcvDt_FM#
            </isNotNull>
            <isNotNull property="cMsg.rqstRcvDt_TO">
                AND WO.RQST_RCV_DT                     &lt;=      #cMsg.rqstRcvDt_TO#
            </isNotNull>
            <isNotNull property="cMsg.dsWrkOrdTpCd_PL">
                AND WO.DS_WRK_ORD_TP_CD                    =      #cMsg.dsWrkOrdTpCd_PL#
            </isNotNull>
            <isNotNull property="cMsg.rtlWhCd">
                AND WO.RTL_WH_CD                           =      #cMsg.rtlWhCd#
            </isNotNull>
            <isNotNull property="cMsg.rtlSwhCd">
                AND WO.CPLT_RTL_SWH_CD                     =      #cMsg.rtlSwhCd#
            </isNotNull>
                AND WO.GLBL_CMPY_CD                        =      DWOT.GLBL_CMPY_CD(+)
                AND WO.DS_WRK_ORD_TP_CD                    =      DWOT.DS_WRK_ORD_TP_CD(+)
                AND WO.GLBL_CMPY_CD                        =      WOS.GLBL_CMPY_CD(+)
                AND WO.WRK_ORD_STS_CD                      =      WOS.WRK_ORD_STS_CD(+)
                AND WO.GLBL_CMPY_CD                        =      RW.GLBL_CMPY_CD(+)
                AND WO.RTL_WH_CD                           =      RW.RTL_WH_CD(+)
                AND WO.GLBL_CMPY_CD                        =      RS.GLBL_CMPY_CD(+)
                AND WO.RTL_WH_CD                           =      RS.RTL_WH_CD(+)
                AND WO.CPLT_RTL_SWH_CD                     =      RS.RTL_SWH_CD(+)
                AND WO.EZCANCELFLAG                        =      '0'
                AND DWOT.EZCANCELFLAG(+)                   =      '0'
                AND WOS.EZCANCELFLAG(+)                    =      '0'
                AND RW.EZCANCELFLAG(+)                     =      '0'
                AND RS.EZCANCELFLAG(+)                     =      '0'
            ORDER BY
                WO.WRK_ORD_NUM         DESC
            ) T1
        WHERE
                ROWNUM         &lt;=       #maxRownum#
    </statement>
    <resultMap id="result.NPAL1350_ASMsg" class="NPAL1350_ASMsg">
        <result property="wrkOrdNum_A1"                 column="WRK_ORD_NUM"                   javaType="EZDSStringItem"/>
        <result property="wrkOrdDt_A1"                  column="WRK_ORD_DT"                    javaType="EZDSDateItem"/>
        <result property="fnshGoodsMdseCd_A1"           column="FNSH_GOODS_MDSE_CD"            javaType="EZDSStringItem"/>
        <result property="rqstRcvDt_A1"                 column="RQST_RCV_DT"                   javaType="EZDSDateItem"/>
        <result property="fnshGoodsOrdQty_A1"           column="FNSH_GOODS_ORD_QTY"            javaType="EZDSBigDecimalItem"/>
        <result property="fnshGoodsRcvQty_A1"           column="FNSH_GOODS_RCV_QTY"            javaType="EZDSBigDecimalItem"/>
        <result property="fnshGoodsBalQty_A1"           column="FNSH_GOODS_BAL_QTY"            javaType="EZDSBigDecimalItem"/>
        <result property="fnshGoodsCancQty_A1"          column="FNSH_GOODS_CANC_QTY"           javaType="EZDSBigDecimalItem"/>
        <result property="rtlWhCd_A1"                   column="RTL_WH_CD"                     javaType="EZDSStringItem"/>
        <result property="cpltRtlSwhCd_A1"              column="CPLT_RTL_SWH_CD"               javaType="EZDSStringItem"/>
        <result property="oldWrkOrdNum_A1"              column="OLD_WRK_ORD_NUM"               javaType="EZDSStringItem"/>
        <result property="fnshMdseDescShortTxt_A1"      column="FNSH_MDSE_DESC_SHORT_TXT"      javaType="EZDSStringItem"/>
        <result property="wrkOrdStsCd_A1"               column="WRK_ORD_STS_CD"                javaType="EZDSStringItem"/>
        <result property="dsWrkOrdTpDescTxt_A1"         column="DS_WRK_ORD_TP_DESC_TXT"        javaType="EZDSStringItem"/>
        <result property="dsWrkOrdStsNm_A1"             column="DS_WRK_ORD_STS_NM"             javaType="EZDSStringItem"/>
        <result property="rtlWhNm_A1"                   column="RTL_WH_NM"                     javaType="EZDSStringItem"/>
        <result property="rtlSwhNm_A1"                  column="RTL_SWH_NM"                    javaType="EZDSStringItem"/>
        <result property="xxRqstTs_A1"                  column="WO_EZUPTIME"                   javaType="EZDSStringItem"/>
        <result property="xxRqstTz_A1"                  column="WO_EZUPTIMEZONE"               javaType="EZDSStringItem"/>
    </resultMap>
</sqlMap>