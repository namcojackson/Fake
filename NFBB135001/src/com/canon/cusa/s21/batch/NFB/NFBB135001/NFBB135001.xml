<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NFBB135001">
    <statement id="getCusaInv" parameterClass="Map" resultClass="Map">
       SELECT
             H.AP_VND_CD
            ,H.AP_VND_INV_NUM
            ,H.AP_VND_INV_SQ_NUM
            ,H.AC_INV_TOT_COST_AMT
            ,H.AP_PMT_CHK_NUM
            ,H.ARCS_PMT_AMT
            ,H.ARCS_PMT_DT
       FROM
             PO_VND_V      V
            ,CM_AP_INV_HDR H
       WHERE
                V.GLBL_CMPY_CD = #glblCmpyCd#
            AND V.EZCANCELFLAG = '0'
            AND V.PRNT_VND_CD = #prntVndCd#
            AND V.GLBL_CMPY_CD = H.GLBL_CMPY_CD
            AND V.VND_CD = H.AP_VND_CD
            AND H.ACCT_INV_STS_CD = #acctInvSts#
            AND H.CUSA_INTFC_DT IS NULL
            AND H.EZCANCELFLAG = '0'
            AND LENGTH(H.AP_VND_INV_NUM) &lt;= #invNumMaxLength#
            AND LENGTH(H.ARCS_PMT_AMT) &lt;= #pmtAmtMaxLength#
            AND LENGTH(H.AP_PMT_CHK_NUM) &lt;= #pmtChkNumMaxLength#
            AND EXISTS (
                SELECT
                     1
                FROM
                     AP_INV_PMT P
                WHERE
                        P.GLBL_CMPY_CD = H.GLBL_CMPY_CD
                    AND P.AP_VND_CD = H.AP_VND_CD
                    AND P.AP_VND_INV_NUM = H.AP_VND_INV_NUM
                    AND P.AP_VND_INV_SQ_NUM = H.AP_VND_INV_SQ_NUM
                    AND P.EZCANCELFLAG = '0'
            )
            ORDER BY H.AP_PMT_CHK_NUM
                    ,H.AP_VND_INV_NUM
    </statement>
</sqlMap>
