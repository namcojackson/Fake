<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSXC001001GetNotArvMachCntForFlt">
    <statement id="getNotArvMachCnt" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            COUNT(*)  AS CNT
        FROM
             DS_CONTR  HDR
        WHERE
            HDR.GLBL_CMPY_CD             = #glblCmpyCd#
        AND HDR.EZCANCELFLAG             = '0'
        AND HDR.DS_CONTR_PK              = #dsContrPk#
        AND HDR.DS_CONTR_CATG_CD         = #dsContrCatgCd#
        AND EXISTS (
            SELECT
                1
            FROM
                DS_CONTR_DTL    DTL
               ,CPO_DTL         CDL
            WHERE
                DTL.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DTL.EZCANCELFLAG         = '0'
            AND DTL.DS_CONTR_PK          = HDR.DS_CONTR_PK
            AND DTL.DS_CONTR_DTL_STS_CD  = #dsContrDtlStsCd#
            AND DTL.GLBL_CMPY_CD         = CDL.GLBL_CMPY_CD
            AND DTL.CPO_ORD_NUM          = CDL.CPO_ORD_NUM
            AND DTL.CPO_DTL_LINE_NUM     = CDL.CPO_DTL_LINE_NUM
            AND DTL.CPO_DTL_LINE_SUB_NUM = CDL.CPO_DTL_LINE_SUB_NUM
            AND CDL.ORD_LINE_STS_CD      &lt;&gt; #ordLineStsCd#
            AND CDL.EZCANCELFLAG         = '0'
            )
    </statement>
</sqlMap>
