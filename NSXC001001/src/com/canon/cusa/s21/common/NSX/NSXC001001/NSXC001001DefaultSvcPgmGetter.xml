<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSXC001001DefaultSvcPgmGetter">
    <statement id="getMdseInfo" parameterClass="Map" resultClass="Map">
        SELECT
             A.COA_PROD_CD
            ,A.COA_MDSE_TP_CD
            ,A.MDSE_CD
            ,A.MDSE_ITEM_TP_CD
            ,NVL(A.SW_CATG_CD, #allCd#)         AS SW_CATG_CD
            ,NVL(A.SVC_COV_BASE_TP_CD, #allCd#) AS SVC_COV_BASE_TP_CD
            ,NVL(A.SVC_PGM_TP_CD, #allCd#)      AS SVC_PGM_TP_CD
        FROM
            MDSE    A
        WHERE
                A.GLBL_CMPY_CD      = #glblCmpyCd#
            AND A.EZCANCELFLAG      = '0'
            AND A.MDSE_CD           = #mdseCd#
        UNION ALL
        SELECT
             A.COA_PROD_CD
            ,A.COA_MDSE_TP_CD
            ,A.MDSE_CD
            ,A.MDSE_ITEM_TP_CD
            ,NVL(A.SW_CATG_CD, #allCd#)         AS SW_CATG_CD
            ,NVL(A.SVC_COV_BASE_TP_CD, #allCd#) AS SVC_COV_BASE_TP_CD
            ,NVL(A.SVC_PGM_TP_CD, #allCd#)      AS SVC_PGM_TP_CD
        FROM
            MDSE            A
           ,ORD_TAKE_MDSE   B
        WHERE
                A.GLBL_CMPY_CD      = #glblCmpyCd#
            AND A.EZCANCELFLAG      = '0'
            AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD
            AND B.EZCANCELFLAG      = '0'
            AND A.MDSE_CD           = B.MDSE_CD
            AND B.ORD_TAKE_MDSE_CD  = #mdseCd#
    </statement>
    <statement id="getDefSvcPgmRule" parameterClass="Map" resultClass="String">
        SELECT
            SVC_PGM_MDSE_CD
        FROM
            (
                SELECT
                     A.SVC_PGM_MDSE_CD
                FROM
                    DEF_SVC_PGM_RULE A
                WHERE
                        A.GLBL_CMPY_CD         = #glblCmpyCd#
                    AND A.EZCANCELFLAG         = '0'
                    AND A.SVC_LINE_BIZ_CD      = #svcLineBizCd#
                    AND A.SVC_PGM_RNTL_FLG     = #rntlFlg#
                    AND A.SVC_PGM_RNTL_SPL_FLG = #rntlSplFlg#
                    AND (DECODE(A.SVC_MACH_TP_CD, #allCd#, #svcMachTp#, A.SVC_MACH_TP_CD) = #svcMachTp#)
                    AND (DECODE(A.COA_PROD_CD, #allCd#, #coaProdCd#, A.COA_PROD_CD) = #coaProdCd#)
                    AND (DECODE(A.COA_MDSE_TP_CD, #allCd#, #coaMdseTp#, A.COA_MDSE_TP_CD) = #coaMdseTp#)
                    AND #mdseCd# LIKE (DECODE(A.MDSE_CD, #allCd#, #mdseCd#, A.MDSE_CD))
                    AND (DECODE(A.MDSE_ITEM_TP_CD, #allCd#, #mdseItemTp#, A.MDSE_ITEM_TP_CD) = #mdseItemTp#)
                    AND (DECODE(A.SW_CATG_CD, #allCd#, #swCatgCd#, A.SW_CATG_CD) = #swCatgCd#)
                    AND (DECODE(A.SVC_COV_BASE_TP_CD, #allCd#, #svcCovBaseTp#, A.SVC_COV_BASE_TP_CD) = #svcCovBaseTp#)
                    AND (DECODE(A.SVC_PGM_TP_CD, #allCd#, #svcPgmTp#, A.SVC_PGM_TP_CD) = #svcPgmTp#)
                ORDER BY
                    A.DEF_SVC_PGM_RULE_SORT_NUM
                   ,A.SVC_PGM_MDSE_CD
            )
        WHERE
            ROWNUM = 1
    </statement>
</sqlMap>
