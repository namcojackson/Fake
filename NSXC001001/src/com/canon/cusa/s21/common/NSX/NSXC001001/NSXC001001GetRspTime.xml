<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NSXC001001GetRspTime">

    <statement id="getBusinessDay" parameterClass="Map" resultClass="String">
    SELECT
          CAL_DT
      FROM
         (
    SELECT
          CAL.CAL_DT 
    FROM  CAL 
    WHERE 
          CAL.GLBL_CMPY_CD          = #glblCmpyCd#
<!-- START 2023/06/14 K.Kitachi [QC#61365, MOD] -->
<!--  AND CAL.CAL_TP_CD             = #glblCmpyCd# -->
      AND CAL.CAL_TP_CD             = #calTpCd#
<!-- END 2023/06/14 K.Kitachi [QC#61365, MOD] -->
      AND CAL.DT_ATTRB_CD           = '01'
      AND CAL.DT_ATTRB_VAL_CD       = '1'
      <isNotNull property="fromDate">
      AND CAL.CAL_DT             &gt; #fromDate#
      ORDER BY CAL_DT ASC
      </isNotNull>
      <isNotNull property="toDate">
      AND CAL.CAL_DT             &lt; #toDate#
      ORDER BY CAL_DT DESC
      </isNotNull>
         )
    WHERE ROWNUM = 1       
    </statement>

    <statement id="getBusinessDays" parameterClass="Map" resultClass="Integer">
     SELECT
           COUNT(CAL.CAL_DT)
     FROM  CAL 
    WHERE 
          CAL.GLBL_CMPY_CD          = #glblCmpyCd#
<!-- START 2023/06/14 K.Kitachi [QC#61365, MOD] -->
<!--  AND CAL.CAL_TP_CD             = #glblCmpyCd# -->
      AND CAL.CAL_TP_CD             = #calTpCd#
<!-- END 2023/06/14 K.Kitachi [QC#61365, MOD] -->
      AND CAL.DT_ATTRB_CD           = '01'
      AND CAL.DT_ATTRB_VAL_CD       = '1'
      AND CAL.CAL_DT BETWEEN #fromDate# AND #toDate#
    </statement>
<!-- NA#ASCC CLICK ADD Start -->
    <statement id="getSvcRspTmMnAot" parameterClass="Map" resultClass="Map">
        SELECT
            DM.RSP_TM_UP_MN_AOT
          , DM.RSP_TM_DOWN_MN_AOT
        FROM
            MDL_NM   MN
          , DS_MDL   DM
        WHERE
              MN.T_GLBL_CMPY_CD = #glblCmpyCd#
          AND MN.T_MDL_NM       = #mdlNm#
          AND MN.T_GLBL_CMPY_CD = DM.GLBL_CMPY_CD
          AND MN.T_MDL_ID       = DM.MDL_ID
          AND MN.EZCANCELFLAG   = '0'
          AND DM.EZCANCELFLAG   = '0'
          AND DM.MDL_ACTV_FLG   = #mdlActvFlg#
          AND ROWNUM = 1
    </statement>
<!-- NA#ASCC CLICK ADD End -->
<!-- QC#3727 CLICK ADD Start -->
    <statement id="getServiceTermCondPk" parameterClass="Map" resultClass="Map">
        SELECT
                 TERM.SVC_TERM_COND_PK
            FROM SVC_TERM_COND TERM
                ,SVC_TERM_COND_ATTRB ATTR
            WHERE
                 TERM.GLBL_CMPY_CD = #glblCmpyCd#
            AND
                 TERM.DS_CONTR_PK = #dsContrPk#
            AND
    <isNotNull property="dsContrDtlPk">
                 TERM.DS_CONTR_DTL_PK = #dsContrDtlPk#
    </isNotNull>
    <isNull property="dsContrDtlPk">
                 TERM.DS_CONTR_DTL_PK IS NULL
    </isNull>
            AND
                 TERM.SVC_TERM_ATTRB_MAP_VAL_CD IS NOT NULL
            AND
                 ATTR.SVC_TERM_COND_ATTRB_NM = #attrNm#
            AND
                 TERM.GLBL_CMPY_CD = ATTR.GLBL_CMPY_CD
            AND
                 TERM.SVC_TERM_COND_ATTRB_PK = ATTR.SVC_TERM_COND_ATTRB_PK
            AND
                 TERM.EZCANCELFLAG = '0'
            AND
                 ATTR.EZCANCELFLAG = '0'
    </statement>
<!-- QC#3727 CLICK ADD End -->
<!-- QC#447 ADD Start -->
    <statement id="getFleetLineDsContrDtlPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            DTL.DS_CONTR_DTL_PK
        FROM
            DS_CONTR_DTL    DTL
        WHERE
            DTL.GLBL_CMPY_CD                  = #glblCmpyCd#
        AND DTL.DS_CONTR_DTL_TP_CD            = #dsContrDtlTpCd#
        AND DTL.EZCANCELFLAG                  = '0'
        AND EXISTS(
           SELECT
                1
          FROM
                DS_CONTR_DTL   DT2
            WHERE
                DT2.GLBL_CMPY_CD               = DTL.GLBL_CMPY_CD
            AND DT2.DS_CONTR_PK                = DTL.DS_CONTR_PK
            AND DT2.DS_CONTR_DTL_PK            = #dsContrDtlPk#
            AND DT2.EZCANCELFLAG               = '0'
            )
    </statement>
    <statement id="getAddlChargTpFromIF" parameterClass="Map" resultClass="Map">
        SELECT
            ADDL_CHRG_TP_CD
           ,EFF_FROM_DT
           ,EFF_THRU_DT
        FROM
            (
           SELECT
                ADI.ADDL_CHRG_TP_CD     ADDL_CHRG_TP_CD
               ,ADI.EFF_FROM_DT         EFF_FROM_DT
               ,ADI.EFF_THRU_DT         EFF_THRU_DT
          FROM
                DS_ADDL_CHRG_INTFC   ADI
            WHERE
               ADI.GLBL_CMPY_CD                     = #glblCmpyCd#
            AND ADI.SVC_MACH_MSTR_PK                = #svcMachMstrPk#
            AND ADI.EFF_FROM_DT                 &lt;= #slaDt#
            AND NVL(ADI.EFF_THRU_DT, #maxDate#) &gt;= #slaDt#
            AND ADI.EZCANCELFLAG                    = '0'
          ORDER BY
                ADI.DS_ADDL_CHRG_INTFC_PK DESC
            )
        WHERE
            ROWNUM                                  = 1
    </statement>
    <statement id="getTermCondOpt" parameterClass="Map" resultClass="Map">
        SELECT
            TERM_COND_OPT_TP_DESC_TXT
           ,TERM_COND_OPT_VAL_TXT
           ,EFF_FROM_DT
           ,EFF_THRU_DT
        FROM
            (
            SELECT
                TO_NUMBER(MTO.TERM_COND_OPT_VAL_TXT)  NUM_TERM_COND_OPT_VAL_TXT
               ,TOT.TERM_COND_OPT_TP_DESC_TXT         TERM_COND_OPT_TP_DESC_TXT
               ,MTO.TERM_COND_OPT_VAL_TXT             TERM_COND_OPT_VAL_TXT
               ,ADC.EFF_FROM_DT                       EFF_FROM_DT
               ,ADC.EFF_THRU_DT                       EFF_THRU_DT
               ,'1'                                   PRIORITY_NUM
            FROM
                DS_CONTR_ADDL_CHRG   ADC
               ,ADDL_CHRG_TP_V       ACT
               ,MDSE_TERM_COND_OPT   MTO
               ,TERM_COND_OPT_TP     TOT
            WHERE
                  ADC.GLBL_CMPY_CD                    = #glblCmpyCd#
              AND ADC.DS_CONTR_DTL_PK                 = #dsContrDtlPk#
              AND ADC.EFF_FROM_DT                 &lt;= #slaDt#
              AND NVL(ADC.EFF_THRU_DT, #maxDate#) &gt;= #slaDt#
              AND ADC.EZCANCELFLAG                    = '0'
              AND ADC.ADDL_CHRG_TP_CD                 = ACT.ADDL_CHRG_TP_CD
              AND ADC.GLBL_CMPY_CD                    = ACT.GLBL_CMPY_CD
              AND ACT.EZCANCELFLAG                    = '0'
              AND ACT.INTG_MDSE_CD                    = MTO.MDSE_CD
              AND ACT.GLBL_CMPY_CD                    = MTO.GLBL_CMPY_CD
              AND MTO.EZCANCELFLAG                    = '0'
              AND MTO.TERM_COND_OPT_TP_CD             = TOT.TERM_COND_OPT_TP_CD
              AND MTO.GLBL_CMPY_CD                    = TOT.GLBL_CMPY_CD
              AND TOT.RSP_TM_TP_FLG                   = #rspTmTpFlg#
              AND TOT.EZCANCELFLAG                    = '0'
          UNION ALL
            SELECT
                TO_NUMBER(MTO.TERM_COND_OPT_VAL_TXT)  NUM_TERM_COND_OPT_VAL_TXT
               ,TOT.TERM_COND_OPT_TP_DESC_TXT         TERM_COND_OPT_TP_DESC_TXT
               ,MTO.TERM_COND_OPT_VAL_TXT             TERM_COND_OPT_VAL_TXT
               ,ADC.EFF_FROM_DT                       EFF_FROM_DT
               ,ADC.EFF_THRU_DT                       EFF_THRU_DT
               ,'2'                                   PRIORITY_NUM
            FROM
                DS_CONTR_DTL         DTL
               ,DS_CONTR_ADDL_CHRG   ADC
               ,ADDL_CHRG_TP_V       ACT
               ,MDSE_TERM_COND_OPT   MTO
               ,TERM_COND_OPT_TP     TOT
            WHERE
                  DTL.GLBL_CMPY_CD                    = #glblCmpyCd#
              AND DTL.DS_CONTR_DTL_PK                 = #dsContrDtlPk#
              AND DTL.EZCANCELFLAG                    = '0'
              AND DTL.DS_CONTR_PK                     = ADC.DS_CONTR_PK
              AND DTL.GLBL_CMPY_CD                    = ADC.GLBL_CMPY_CD
              AND ADC.DS_CONTR_DTL_PK                 IS NULL
              AND ADC.EFF_FROM_DT                 &lt;= #slaDt#
              AND NVL(ADC.EFF_THRU_DT, #maxDate#) &gt;= #slaDt#
              AND ADC.EZCANCELFLAG                    = '0'
              AND ADC.ADDL_CHRG_TP_CD                 = ACT.ADDL_CHRG_TP_CD
              AND ADC.GLBL_CMPY_CD                    = ACT.GLBL_CMPY_CD
              AND ACT.EZCANCELFLAG                    = '0'
              AND ACT.INTG_MDSE_CD                    = MTO.MDSE_CD
              AND ACT.GLBL_CMPY_CD                    = MTO.GLBL_CMPY_CD
              AND MTO.EZCANCELFLAG                    = '0'
              AND MTO.TERM_COND_OPT_TP_CD             = TOT.TERM_COND_OPT_TP_CD
              AND MTO.GLBL_CMPY_CD                    = TOT.GLBL_CMPY_CD
              AND TOT.RSP_TM_TP_FLG                   = #rspTmTpFlg#
              AND TOT.EZCANCELFLAG                    = '0'
          ORDER BY
                PRIORITY_NUM
               ,NUM_TERM_COND_OPT_VAL_TXT
               ,EFF_FROM_DT    DESC
            )
        WHERE
            ROWNUM                                  = 1
    </statement>
    <statement id="getSvcCov" parameterClass="Map" resultClass="Map">
        SELECT
            SVC_COV_DTL_VAL_TXT
           ,SVC_COV_FEAT_VAL_TXT
        FROM
            (
            SELECT
                SCD.SVC_COV_DTL_VAL_TXT                 SVC_COV_DTL_VAL_TXT
               ,SCF.SVC_COV_FEAT_VAL_TXT                SVC_COV_FEAT_VAL_TXT
            FROM
                DS_CONTR_DTL         DTL
               ,MDSE                 MDS
               ,SVC_COV_TMPL_DTL     SCD
               ,SVC_COV_FEAT         SCF
            WHERE
                  DTL.GLBL_CMPY_CD                          = #glblCmpyCd#
              AND DTL.DS_CONTR_DTL_PK                       = #dsContrDtlPk#
              AND DTL.CONTR_EFF_FROM_DT                 &lt;= #slaDt#
              AND NVL(DTL.CONTR_EFF_THRU_DT, #maxDate#) &gt;= #slaDt#
              AND DTL.EZCANCELFLAG                          = '0'
              AND DTL.SVC_PGM_MDSE_CD                       = MDS.MDSE_CD
              AND DTL.GLBL_CMPY_CD                          = MDS.GLBL_CMPY_CD
              AND MDS.EZCANCELFLAG                          = '0'
              AND MDS.SVC_COV_TMPL_TP_CD                    = SCD.SVC_COV_TMPL_TP_CD
              AND MDS.GLBL_CMPY_CD                          = SCD.GLBL_CMPY_CD
              AND SCD.SVC_COV_FEAT_CD                       = #svcCovFeatCd#
              AND SCD.SVC_COV_DTL_ACTV_FLG                  = #svcCovDtlActvFlg#
              AND SCD.EZCANCELFLAG                          = '0'
              AND SCD.SVC_COV_FEAT_CD                       = SCF.SVC_COV_FEAT_CD
              AND SCD.GLBL_CMPY_CD                          = SCF.GLBL_CMPY_CD
              AND SCF.EZCANCELFLAG                          = '0'
          ORDER BY
                TO_NUMBER(SCD.SVC_COV_DTL_VAL_TXT)
               ,DTL.CONTR_EFF_FROM_DT    DESC
            )
        WHERE
            ROWNUM                                  = 1
    </statement>
<!-- QC#447 ADD End -->
<!-- QC#15658 Add Start -->
    <statement id="getCoverageTime" parameterClass="Map" resultClass="Map">
        SELECT
                 TERM.DS_CONTR_DTL_PK
                ,TERM.DS_CONTR_PK
                ,AHS.AHS_SUN_FROM_TM
                ,AHS.AHS_SUN_TO_TM
                ,AHS.AHS_MON_FROM_TM
                ,AHS.AHS_MON_TO_TM
                ,AHS.AHS_TUE_FROM_TM
                ,AHS.AHS_TUE_TO_TM
                ,AHS.AHS_WED_FROM_TM
                ,AHS.AHS_WED_TO_TM
                ,AHS.AHS_THU_FROM_TM
                ,AHS.AHS_THU_TO_TM
                ,AHS.AHS_FRI_FROM_TM
                ,AHS.AHS_FRI_TO_TM
                ,AHS.AHS_SAT_FROM_TM
                ,AHS.AHS_SAT_TO_TM
                ,AHS.AHS_HOL_FROM_TM
                ,AHS.AHS_HOL_TO_TM
            FROM SVC_TERM_COND TERM
                ,SVC_TERM_COND_ATTRB ATTR
                ,AHS
            WHERE
                 TERM.GLBL_CMPY_CD = #glblCmpyCd#
            AND
                 TERM.DS_CONTR_PK = #dsContrPk#
            AND
        <isNotNull property="dsContrDtlPk">
                 TERM.DS_CONTR_DTL_PK = #dsContrDtlPk#
        </isNotNull>
        <isNull property="dsContrDtlPk">
                 TERM.DS_CONTR_DTL_PK IS NULL
        </isNull>
            AND
                 TERM.GLBL_CMPY_CD = ATTR.GLBL_CMPY_CD
            AND
                 TERM.SVC_TERM_COND_ATTRB_PK = ATTR.SVC_TERM_COND_ATTRB_PK
            AND
                 ATTR.SVC_TERM_COND_ATTRB_NM = #attrNm#
            AND
                 TERM.GLBL_CMPY_CD = AHS.GLBL_CMPY_CD
            AND
                 TERM.SVC_TERM_ATTRB_MAP_VAL_CD = AHS.AHS_CD
            AND
                 TERM.EZCANCELFLAG = '0'
            AND
                 ATTR.EZCANCELFLAG = '0'
            AND
                 AHS.EZCANCELFLAG = '0'
    </statement>
<!-- QC#15658 Add End -->
</sqlMap>
