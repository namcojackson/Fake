<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWAB265001">

    <statement id="getNWAI1200_HDR" parameterClass="Map" resultClass="Map">
        SELECT
             N0.INTERFACE_ID
            ,N0.TRANSACTION_ID
            ,N0.SEGMENT_ID
            ,N0.UNIT_ID
            ,N0.SEQ_NUMBER
            ,N0.IDOC_PO_DOC_NUM
        FROM
            $intfTable$           N0
        WHERE
            N0.EZCANCELFLAG         = '0'
            AND N0.INTERFACE_ID     = #interfaceId#
            AND N0.TRANSACTION_ID   = #transactionId#
            <!-- 2018/07/06 S21_NA#26936 Add Start -->
            <isNotNull property="segmentId">
                AND N0.SEGMENT_ID       = #segmentId#
            </isNotNull>
            <isNotNull property="unitId">
                AND N0.UNIT_ID          = #unitId#
            </isNotNull>
            <!-- 2018/07/06 S21_NA#26936 Add End -->
            <isNotNull property="idocPoDocNum">
            AND N0.IDOC_PO_DOC_NUM  = #idocPoDocNum#
            </isNotNull>
        ORDER BY
            N0.IDOC_PO_DOC_NUM
    </statement>

    <statement id="getNWAI1200_DTL" parameterClass="Map" resultClass="Map">
        SELECT
             N0.INTERFACE_ID
            ,N0.TRANSACTION_ID
            ,N0.SEGMENT_ID
            ,N0.UNIT_ID
            ,N0.SEQ_NUMBER
            ,N0.IDOC_PO_DOC_NUM
            ,N0.IDOC_PO_DTL_LINE_REF_NUM
        FROM
            $intfTable$           N0
        WHERE
            N0.EZCANCELFLAG         = '0'
            AND N0.INTERFACE_ID     = #interfaceId#
            AND N0.TRANSACTION_ID   = #transactionId#
            <!-- 2018/07/06 S21_NA#26936 Add Start -->
            AND N0.SEGMENT_ID       = #segmentId#
            AND N0.UNIT_ID          = #unitId#
            <!-- 2018/07/06 S21_NA#26936 Add End -->
            AND N0.IDOC_PO_DOC_NUM  = #idocPoDocNum#
            <isNotNull property="idocPoDtlLineRefNum">
            AND N0.IDOC_PO_DTL_LINE_REF_NUM  = #idocPoDtlLineRefNum#
            </isNotNull>
        ORDER BY
             N0.IDOC_PO_DOC_NUM
            ,LPAD(N0.IDOC_PO_DTL_LINE_REF_NUM, 6, '0')
    </statement>

    <statement id="getPoRcpntPtnrNum" parameterClass="Map" resultClass="String">
        SELECT
                  X.TRGT_ATTRB_TXT_01 
            FROM
                XTRNL_INTFC_XREF X 
            WHERE
                X.INTFC_XREF_CTX_TP_CD  = #intfcXrefCtxTp#
                AND X.SRC_ATTRB_TXT_01  = #srcAttrbTxt01#
                AND X.CPO_SRC_TP_CD     = #cpoSrcTpCd#
                AND X.INTFC_ID          = #intfcId#
                AND X.GLBL_CMPY_CD      = #glblCmpyCd#
                AND X.EZCANCELFLAG      = '0'
                AND ROWNUM              =  1
    </statement>

</sqlMap>
