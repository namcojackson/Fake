<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NPZC002001">

	<typeAlias alias="CMPSNTMsg"		type="business.db.CMPSNTMsg"/>
	
    <statement id="getWrkOrdDtlKeyList" parameterClass="EZDMsg" resultClass="Map">
        SELECT
			GLBL_CMPY_CD
			, WRK_ORD_NUM
			, WRK_ORD_DTL_LINE_NUM
	    FROM
            WRK_ORD_DTL
        WHERE
            GLBL_CMPY_CD = #glblCmpyCd#
            AND WRK_ORD_NUM = #wrkOrdNum#
            AND EZCANCELFLAG = '0'
    </statement>

    <statement id="countInvtyCtrlMdse" parameterClass="Map" resultClass="Integer">
        SELECT
        	COUNT(MDSE_CD) AS MDSE_CNT
	    FROM
            MDSE
        WHERE
            GLBL_CMPY_CD	= #glblCmpyCd#
            AND MDSE_CD		= #mdseCd#
            AND INVTY_CTRL_FLG = 'Y'
    </statement>

    <statement id="getSoSerNum" parameterClass="Map" resultClass="Map">
        SELECT H.RWS_NUM
              ,D.RWS_DTL_LINE_NUM
              ,D.MDSE_CD
              ,S.SER_NUM
        FROM   SHIP_SER_NUM S
              ,RWS_HDR H
              ,RWS_DTL D
        WHERE  1 = 1
        AND    S.SO_NUM       = #soNum#
        AND    S.GLBL_CMPY_CD = #glblCmpyCd#
        AND    S.EZCANCELFLAG = '0'
        AND    S.GLBL_CMPY_CD = H.GLBL_CMPY_CD
        AND    S.SO_NUM       = H.PO_RCV_TRX_HDR_NUM
        AND    H.EZCANCELFLAG = '0'
        AND    H.GLBL_CMPY_CD = D.GLBL_CMPY_CD
        AND    H.RWS_NUM      = D.RWS_NUM
        AND    S.MDSE_CD      = D.MDSE_CD
        AND    D.EZCANCELFLAG = '0'
    </statement>

    <statement id="getCMPSN" parameterClass="Map" resultMap="res.CMPSNTMsg">
        SELECT
        	GLBL_CMPY_CD
        	, PRNT_MDSE_CD
        	, CMPSN_PK
        	, MDSE_CMPSN_TP_CD
        	, CHILD_MDSE_CD
        	, CHILD_KIT_MAT_CD
        	, CHILD_MDSE_QTY
	    FROM
            CMPSN
        WHERE
	      GLBL_CMPY_CD			= #glblCmpyCd01#
	      AND PRNT_MDSE_CD		= #prntMdseCd01#
	      AND (
	      			(CHILD_MDSE_CD		= #childMdseCd01#	AND MDSE_CMPSN_TP_CD = #KIT_MDSE#)
	      		OR	(CHILD_KIT_MAT_CD	= #childKitMatCd01# AND MDSE_CMPSN_TP_CD = #KIT_MATERIAL#)
	      	  )
	      AND  EZCANCELFLAG = '0'
    </statement>
	<resultMap id="res.CMPSNTMsg" class="CMPSNTMsg">
		<result property="prntMdseCd" column="PRNT_MDSE_CD" javaType="EZDTStringItem"/>
		<result property="cmpsnPk" column="CMPSN_PK" javaType="EZDTBigDecimalItem"/>
		<result property="mdseCmpsnTpCd" column="MDSE_CMPSN_TP_CD" javaType="EZDTStringItem"/>
		<result property="childMdseCd" column="CHILD_MDSE_CD" javaType="EZDTStringItem"/>
		<result property="childKitMatCd" column="CHILD_KIT_MAT_CD" javaType="EZDTStringItem"/>
		<result property="childMdseQty" column="CHILD_MDSE_QTY" javaType="EZDTBigDecimalItem"/>
	</resultMap>
	
</sqlMap>
