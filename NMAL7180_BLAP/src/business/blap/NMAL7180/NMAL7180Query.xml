<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAL7180Query">

    <typeAlias alias="NMAL7180SMsg"    type="business.blap.NMAL7180.NMAL7180SMsg"/>
    <typeAlias alias="NMAL7180_ASMsg"  type="business.blap.NMAL7180.NMAL7180_ASMsg"/>
    <statement id="getPriceGroup" parameterClass="Map" resultClass="Map">
        SELECT
            *
        FROM
            (SELECT
                PG.PRC_GRP_PK                   AS PRC_GRP_PK
                ,PG.PRC_GRP_NM                  AS PRC_GRP_NM
                ,PG.ACTV_FLG                    AS ACTV_FLG
                <!-- 2020/02/19 QC#55203 Del Start -->
                <!-- ,PD.PRC_GRP_FROM_TXT            AS PRC_GRP_FROM_TXT -->
                <!-- ,PD.PRC_GRP_THRU_TXT            AS PRC_GRP_THRU_TXT -->
                <!-- ,PD.PRC_GRP_PRCD_NUM            AS PRC_GRP_PRCD_NUM -->  <!-- QC#18785 -->
                <!-- 2020/02/19 QC#55203 Del End -->
                ,PG.EFF_FROM_DT                 AS EFF_FROM_DT
                ,PG.EFF_THRU_DT                 AS EFF_THRU_DT
                <!-- ,PTA.PRC_GRP_TRGT_ATTRB_NM      AS PRC_GRP_TRGT_ATTRB_NM --> <!-- 2020/02/19 QC#55203 Del-->
                ,PT.PRC_GRP_TP_NM               AS PRC_GRP_TP_NM
                <!-- 2020/02/19 QC#55203 Del Start -->
                <!-- ,PTT.PRC_GRP_TRGT_TP_NM         AS PRC_GRP_TRGT_TP_NM --> 
                <!-- ,PO.PRC_GRP_OP_NM               AS PRC_GRP_OP_NM -->
                <!-- 2020/02/19 QC#55203 Del End -->
                ,PG.PRC_GRP_DESC_TXT            AS PRC_GRP_DESC_TXT
                ,PGTT.PRC_GRP_TRX_TP_DESC_TXT   AS PRC_GRP_TRX_TP_DESC_TXT <!-- QC#18785 -->
                <!-- 2018/02/20 QC#22575 add start -->
                ,PT.PRC_GRP_TP_DESC_TXT         AS PRC_GRP_TP_DESC_TXT
                <!-- 2020/02/19 QC#55203 Del Start -->
                <!-- ,PTT.PRC_GRP_TRGT_TP_DESC_TXT   AS PRC_GRP_TRGT_TP_DESC_TXT -->
                <!-- ,PTA.PRC_GRP_TRGT_ATTRB_DESC_TXT AS PRC_GRP_TRGT_ATTRB_DESC_TXT -->
                <!-- ,PO.PRC_GRP_OP_DESC_TXT         AS PRC_GRP_OP_DESC_TXT -->
                <!-- 2020/02/19 QC#55203 Del End -->
                <!-- 2018/02/20 QC#22575 add end -->
            FROM
                PRC_GRP             PG
                <!-- 2020/02/19 QC#55203 Del Start -->
                <!-- ,PRC_GRP_DTL        PD -->
                <!-- ,PRC_GRP_TRGT_ATTRB PTA -->
                <!-- ,PRC_GRP_TRGT_TP    PTT -->
                <!-- ,PRC_GRP_OP         PO -->
                <!-- 2020/02/19 QC#55203 Del End -->
                ,PRC_GRP_TP         PT
                ,PRC_GRP_TRX_TP     PGTT
            WHERE
                PG.GLBL_CMPY_CD         = #glblCmpyCd#
            AND PG.EZCANCELFLAG         = '0'
            <isNotNull property="prcGrpNm">
                AND UPPER(PG.PRC_GRP_NM) LIKE UPPER(#prcGrpNm#)
            </isNotNull>
            <isNotNull property="prcGrpDescTxt">
                AND UPPER(PG.PRC_GRP_DESC_TXT) LIKE UPPER(#prcGrpDescTxt#)
            </isNotNull>
            <isNotNull property="prcGrpTpCd">
                AND PG.PRC_GRP_TP_CD     = #prcGrpTpCd#
            </isNotNull>
            <isNotNull property="prcGrpTrxTpCd"> <!-- QC#18785 -->
                AND PG.PRC_GRP_TRX_TP_CD = #prcGrpTrxTpCd#
            </isNotNull>
            <isNotNull property="actvFlg">
                AND PG.ACTV_FLG = #actvFlg#
            </isNotNull>
            AND PT.EZCANCELFLAG          = '0'
            AND PG.GLBL_CMPY_CD          = PT.GLBL_CMPY_CD
            AND PG.PRC_GRP_TP_CD         = PT.PRC_GRP_TP_CD
            <!-- 2020/02/19 QC#55203 Mod Start -->
            AND EXISTS (
                SELECT
                    1
                FROM
                    PRC_GRP_DTL         PD
                    ,PRC_GRP_TRGT_TP    PTT
                    ,PRC_GRP_TRGT_ATTRB PTA
                    ,PRC_GRP_OP         PO
                WHERE
                        PD.GLBL_CMPY_CD(+)       = PG.GLBL_CMPY_CD
                    AND PD.EZCANCELFLAG(+)       = '0'
                    AND PD.PRC_GRP_PK(+)         = PG.PRC_GRP_PK
                    <isNotNull property="prcGrpTrgtTpCd">
                        AND PD.PRC_GRP_TRGT_TP_CD = #prcGrpTrgtTpCd#
                    </isNotNull>
                    <isNotNull property="prcGrpTrgtAttrbCd">
                        AND PD.PRC_GRP_TRGT_ATTRB_CD = #prcGrpTrgtAttrbCd#
                    </isNotNull>
                    <isNotNull property="prcGrpFromTxt">
                        AND UPPER(PD.PRC_GRP_FROM_TXT) LIKE UPPER(#prcGrpFromTxt#)
                    </isNotNull>
                    <isNotNull property="prcGrpThruTxt">
                        AND UPPER(PD.PRC_GRP_THRU_TXT) LIKE UPPER(#prcGrpThruTxt#)
                    </isNotNull>
                    AND PTT.EZCANCELFLAG(+)      = '0'
                    AND PD.GLBL_CMPY_CD          = PTT.GLBL_CMPY_CD(+)
                    AND PD.PRC_GRP_TRGT_TP_CD    = PTT.PRC_GRP_TRGT_TP_CD(+)
                    AND PTA.EZCANCELFLAG(+)      = '0'
                    AND PD.GLBL_CMPY_CD          = PTA.GLBL_CMPY_CD(+)
                    AND PD.PRC_GRP_TRGT_TP_CD    = PTA.PRC_GRP_TRGT_TP_CD(+)
                    AND PD.PRC_GRP_TRGT_ATTRB_CD = PTA.PRC_GRP_TRGT_ATTRB_CD(+)
                    AND PD.PRC_GRP_OP_CD         = PO.PRC_GRP_OP_CD(+)
                    <!-- QC#18785 -->
                )
            <isNotNull property="effFromDt">
                AND PG.EFF_FROM_DT &gt;= #effFromDt#
            </isNotNull>
            <isNotNull property="effThruDt">
                AND NVL(PG.EFF_THRU_DT, #highValDt#) &lt;= #effThruDt#
            </isNotNull>
            <!-- 2020/02/19 QC#55203 Mod Start -->
            AND PGTT.EZCANCELFLAG(+)     = '0'
            AND PG.GLBL_CMPY_CD          = PGTT.GLBL_CMPY_CD(+)
            AND PG.PRC_GRP_TRX_TP_CD     = PGTT.PRC_GRP_TRX_TP_CD(+)
            ORDER BY
                 PG.PRC_GRP_NM
                ,PT.PRC_GRP_TP_NM
                <!-- 2020/02/19 QC#55203 Del Start -->
                <!-- ,PTT.PRC_GRP_TRGT_TP_NM -->
                <!-- ,PTA.PRC_GRP_TRGT_ATTRB_NM -->
                <!-- ,PO.PRC_GRP_OP_NM -->
                <!-- ,PD.PRC_GRP_FROM_TXT -->
                <!-- ,PD.PRC_GRP_THRU_TXT -->
                <!-- 2020/02/19 QC#55203 Del End -->
            )
        WHERE
            ROWNUM &lt;= #rowNum#
    </statement>

</sqlMap>
