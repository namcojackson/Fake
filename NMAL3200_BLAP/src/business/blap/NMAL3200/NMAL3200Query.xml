<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NMAL3200Query">

    <statement id="findContrAssnTrgtTp" parameterClass="Map" resultClass="Map">
        SELECT
            CATT.CONTR_ASSN_TRGT_TP_CD
            ,CATT.CONTR_ASSN_TRGT_TP_DESC_TXT
        FROM
            CONTR_ASSN_TRGT_TP CATT
        WHERE 
            1 = 1
        AND CATT.GLBL_CMPY_CD = #glblCmpyCd#
        AND CATT.ACTV_FLG     = #actvFlg#
        AND CATT.EZCANCELFLAG = '0'
        ORDER BY
            CONTR_ASSN_TRGT_TP_SORT_NUM ASC
    </statement>

    <statement id="findMktgFldMap" parameterClass="Map" resultClass="Map">
        SELECT
            MMR.MKTG_MAP_RQST_PK
            ,MFM.MKTG_FLD_MAP_PK
            ,MFM.DS_ACCT_NM_COL_DFN_NM
            ,MFM.FIRST_LINE_ADDR_COL_DFN_NM
            ,MFM.SCD_LINE_ADDR_COL_DFN_NM
            ,MFM.THIRD_LINE_ADDR_COL_DFN_NM
            ,MFM.FRTH_LINE_ADDR_COL_DFN_NM
            ,MFM.CTY_ADDR_COL_DFN_NM
            ,MFM.CNTY_PK_COL_DFN_NM
            ,MFM.ST_CD_COL_DFN_NM
            ,MFM.POST_CD_COL_DFN_NM
            ,MFM.CTRY_CD_COL_DFN_NM
            ,MFM.DUNS_NUM_COL_DFN_NM
            ,MFM.GLN_COL_DFN_NM
            ,MFM.HIN_COL_DFN_NM
            ,MFM.ATTRB_TXT_COL_DFN_NM_01
            ,MFM.ATTRB_TXT_COL_DFN_NM_02
            ,MFM.ATTRB_TXT_COL_DFN_NM_03
            ,MFM.ATTRB_TXT_COL_DFN_NM_04
            ,MFM.ATTRB_TXT_COL_DFN_NM_05
            ,MFM.ATTRB_TXT_COL_DFN_NM_06
            ,MFM.ATTRB_TXT_COL_DFN_NM_07
            ,MFM.ATTRB_TXT_COL_DFN_NM_08
            ,MFM.ATTRB_TXT_COL_DFN_NM_09
            ,MFM.ATTRB_TXT_COL_DFN_NM_10
            ,MFM.ATTRB_TXT_COL_DFN_NM_11
            ,MFM.ATTRB_TXT_COL_DFN_NM_12
            ,MFM.ATTRB_TXT_COL_DFN_NM_13
            ,MFM.ATTRB_TXT_COL_DFN_NM_14
            ,MFM.ATTRB_TXT_COL_DFN_NM_15
            ,MFM.ATTRB_TXT_COL_DFN_NM_16
            ,MFM.ATTRB_TXT_COL_DFN_NM_17
            ,MFM.ATTRB_TXT_COL_DFN_NM_18
            ,MFM.ATTRB_TXT_COL_DFN_NM_19
            ,MFM.ATTRB_TXT_COL_DFN_NM_20
            ,MFM.EZUPTIME
            ,MFM.EZUPTIMEZONE
        FROM
            MKTG_FLD_MAP MFM
            ,MKTG_MAP_RQST MMR
        WHERE
            1 = 1
        AND MFM.GLBL_CMPY_CD    = #glblCmpyCd#
        <isNotNull property="mktgFldMapNm">
        AND MFM.MKTG_FLD_MAP_NM = #mktgFldMapNm#
        </isNotNull>
        <isNotNull property="mktgFldMapPk">
        AND MFM.MKTG_FLD_MAP_PK = #mktgFldMapPk#
        </isNotNull>
        -- JOIN TO MKTG_MAP_RQST
        AND MFM.GLBL_CMPY_CD    = MMR.GLBL_CMPY_CD(+)
        AND MFM.MKTG_FLD_MAP_PK = MMR.MKTG_FLD_MAP_PK(+)
        -- EZCANCELFLAG
        AND MFM.EZCANCELFLAG    = '0'
        AND MMR.EZCANCELFLAG(+) = '0'
    </statement>

    <statement id="findMktgMapRqst" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            MMR.MKTG_MAP_RQST_PK
        FROM
            MKTG_MAP_RQST MMR
        WHERE
            1 = 1
        AND MMR.GLBL_CMPY_CD     = #glblCmpyCd#
        AND MMR.MKTG_FLD_MAP_PK  = #mktgFldMapPk#
        AND MMR.EZCANCELFLAG     = '0'
        AND ROWNUM               = #rowNum#
    </statement>

    <statement id="findMktgFldMapPk" parameterClass="Map" resultClass="Map">
        SELECT
            MFM.MKTG_FLD_MAP_PK
            ,MFM.EZUPTIME
            ,MFM.EZUPTIMEZONE
        FROM
            MKTG_FLD_MAP MFM
        WHERE
            1 = 1
        AND MFM.GLBL_CMPY_CD     = #glblCmpyCd#
        AND MFM.MKTG_FLD_MAP_NM  = #mktgFldMapNm#
        <isNotNull property="mktgFldMapPk">
        AND MFM.MKTG_FLD_MAP_PK != #mktgFldMapPk#
        </isNotNull>
        AND MFM.EZCANCELFLAG     = '0'
    </statement>

    <statement id="findMktgMapRqstFldMap" parameterClass="Map" resultClass="Map">
        SELECT
            MMR.MKTG_MAP_RQST_PK
            ,MFM.DS_ACCT_NM_COL_DFN_NM
            ,MFM.FIRST_LINE_ADDR_COL_DFN_NM
            ,MFM.SCD_LINE_ADDR_COL_DFN_NM
            ,MFM.THIRD_LINE_ADDR_COL_DFN_NM
            ,MFM.FRTH_LINE_ADDR_COL_DFN_NM
            ,MFM.CTY_ADDR_COL_DFN_NM
            ,MFM.CNTY_PK_COL_DFN_NM
            ,MFM.ST_CD_COL_DFN_NM
            ,MFM.POST_CD_COL_DFN_NM
            ,MFM.CTRY_CD_COL_DFN_NM
            ,MFM.DUNS_NUM_COL_DFN_NM
            ,MFM.GLN_COL_DFN_NM
            ,MFM.HIN_COL_DFN_NM
            ,MFM.ATTRB_TXT_COL_DFN_NM_01
            ,MFM.ATTRB_TXT_COL_DFN_NM_02
            ,MFM.ATTRB_TXT_COL_DFN_NM_03
            ,MFM.ATTRB_TXT_COL_DFN_NM_04
            ,MFM.ATTRB_TXT_COL_DFN_NM_05
            ,MFM.ATTRB_TXT_COL_DFN_NM_06
            ,MFM.ATTRB_TXT_COL_DFN_NM_07
            ,MFM.ATTRB_TXT_COL_DFN_NM_08
            ,MFM.ATTRB_TXT_COL_DFN_NM_09
            ,MFM.ATTRB_TXT_COL_DFN_NM_10
            ,MFM.ATTRB_TXT_COL_DFN_NM_11
            ,MFM.ATTRB_TXT_COL_DFN_NM_12
            ,MFM.ATTRB_TXT_COL_DFN_NM_13
            ,MFM.ATTRB_TXT_COL_DFN_NM_14
            ,MFM.ATTRB_TXT_COL_DFN_NM_15
            ,MFM.ATTRB_TXT_COL_DFN_NM_16
            ,MFM.ATTRB_TXT_COL_DFN_NM_17
            ,MFM.ATTRB_TXT_COL_DFN_NM_18
            ,MFM.ATTRB_TXT_COL_DFN_NM_19
            ,MFM.ATTRB_TXT_COL_DFN_NM_20
        FROM
            MKTG_MAP_RQST MMR
            ,MKTG_FLD_MAP MFM
        WHERE
            1 = 1
        AND MMR.GLBL_CMPY_CD           = #glblCmpyCd#
        AND MMR.MKTG_MAP_RQST_PK       = #mktgMapRqstPk#
        -- JOIN TO MKTG_FLD_MAP
        AND MMR.GLBL_CMPY_CD           = MFM.GLBL_CMPY_CD
        AND MMR.MKTG_FLD_MAP_PK        = MFM.MKTG_FLD_MAP_PK
        -- EZCANCELFLAG
        AND MMR.EZCANCELFLAG           = '0'
        AND MFM.EZCANCELFLAG           = '0'
    </statement>

    <statement id="findMktMapReq" parameterClass="Map" resultClass="Map">
        SELECT
            MAIN.MKTG_MAP_RQST_PK
            ,MAIN.MKTG_MAP_RQST_PROC_FLG
            ,MAIN.XX_FULL_NM
            ,MAIN.CRAT_TS
            ,MAIN.EXACT_MATCH_FLG
            ,MAIN.PRTL_MATCH_FLG
            ,MAIN.DUNS_MATCH_FLG
            ,MAIN.GLN_MATCH_FLG
            ,MAIN.MKTG_FLD_MAP_NM
            ,MAIN.CONTR_ASSN_TRGT_TP_DESC_TXT
            ,MAIN.UPLD_FILE_NM
            ,MAIN.UPLD_ERR_FLG
        FROM (
            SELECT
                MMR.MKTG_MAP_RQST_PK
                ,MMR.MKTG_MAP_RQST_PROC_FLG
                ,CASE WHEN AP.USR_NM IS NULL THEN NULL ELSE AP.USR_NM || '(' || AP.FIRST_NM || ' ' || AP.LAST_NM || ')' END AS XX_FULL_NM
                ,SUBSTR(MMR.CRAT_TS,1, 14) AS CRAT_TS
                ,MMR.EXACT_MATCH_FLG
                ,MMR.PRTL_MATCH_FLG
                ,MMR.DUNS_MATCH_FLG
                ,MMR.GLN_MATCH_FLG
                ,MFM.MKTG_FLD_MAP_NM
                ,CATT.CONTR_ASSN_TRGT_TP_DESC_TXT
                ,MMR.MKTG_FLD_MAP_PK
                ,MMR.UPLD_FILE_NM
                ,MMR.UPLD_ERR_FLG
            FROM
                MKTG_MAP_RQST MMR
                ,MKTG_FLD_MAP MFM
                ,CONTR_ASSN_TRGT_TP CATT
                ,AUTH_PSN AP
            WHERE 
                1 = 1
            AND MMR.GLBL_CMPY_CD                       = #glblCmpyCd#
            <isNotNull property="mktgMapRqstPk">
            AND MMR.MKTG_MAP_RQST_PK                   = #mktgMapRqstPk#
            </isNotNull>
            <isNotNull property="mktgMapRqstProcFlg">
            AND MMR.MKTG_MAP_RQST_PROC_FLG             = #mktgMapRqstProcFlg#
            </isNotNull>
            <isNotNull property="upldErrFlg">
            AND MMR.UPLD_ERR_FLG                       = #upldErrFlg#
            </isNotNull>
            -- JOIN TO MKTG_FLD_MAP
            AND MMR.GLBL_CMPY_CD                       = MFM.GLBL_CMPY_CD
            AND MMR.MKTG_FLD_MAP_PK                    = MFM.MKTG_FLD_MAP_PK
            <isNotNull property="mktgFldMapNm">
            AND MFM.MKTG_FLD_MAP_NM                    = #mktgFldMapNm#
            </isNotNull>
            -- JOIN TO CONTR_ASSN_TRGT_TP
            AND MMR.GLBL_CMPY_CD                       = CATT.GLBL_CMPY_CD
            AND MMR.CONTR_ASSN_TRGT_TP_CD              = CATT.CONTR_ASSN_TRGT_TP_CD
            -- JOIN TO AUTH_PSN
            AND MMR.GLBL_CMPY_CD                       = AP.GLBL_CMPY_CD(+)
            AND MMR.CRAT_USR_ID                        = AP.USR_NM(+)
            <!-- QC#14034
            AND AP.EFF_FROM_DT(+)                  &lt;= #salesDate#
            AND NVL(AP.EFF_TO_DT(+), '99991231')   &gt;= #salesDate#
             -->
            -- EZCANCELFLAG
            AND MMR.EZCANCELFLAG                       = '0'
            AND MFM.EZCANCELFLAG                       = '0'
            AND CATT.EZCANCELFLAG                      = '0'
            AND AP.EZCANCELFLAG(+)                     = '0'
            ORDER BY
                MMR.CRAT_TS DESC
        ) MAIN
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="downloadUpldData" parameterClass="Map" resultClass="Map">
        SELECT
            MAIN.MKTG_MAP_RQST_PK
            ,MAIN.DS_ACCT_NM_COL_DFN_NM
            ,MAIN.FIRST_LINE_ADDR_COL_DFN_NM
            ,MAIN.SCD_LINE_ADDR_COL_DFN_NM
            ,MAIN.THIRD_LINE_ADDR_COL_DFN_NM
            ,MAIN.FRTH_LINE_ADDR_COL_DFN_NM
            ,MAIN.CTY_ADDR_COL_DFN_NM
            ,MAIN.CNTY_PK_COL_DFN_NM
            ,MAIN.ST_CD_COL_DFN_NM
            ,MAIN.POST_CD_COL_DFN_NM
            ,MAIN.CTRY_CD_COL_DFN_NM
            ,MAIN.DUNS_NUM_COL_DFN_NM
            ,MAIN.GLN_COL_DFN_NM
            ,MAIN.HIN_COL_DFN_NM
            ,MAIN.ATTRB_TXT_COL_DFN_NM_01
            ,MAIN.ATTRB_TXT_COL_DFN_NM_02
            ,MAIN.ATTRB_TXT_COL_DFN_NM_03
            ,MAIN.ATTRB_TXT_COL_DFN_NM_04
            ,MAIN.ATTRB_TXT_COL_DFN_NM_05
            ,MAIN.ATTRB_TXT_COL_DFN_NM_06
            ,MAIN.ATTRB_TXT_COL_DFN_NM_07
            ,MAIN.ATTRB_TXT_COL_DFN_NM_08
            ,MAIN.ATTRB_TXT_COL_DFN_NM_09
            ,MAIN.ATTRB_TXT_COL_DFN_NM_10
            ,MAIN.ATTRB_TXT_COL_DFN_NM_11
            ,MAIN.ATTRB_TXT_COL_DFN_NM_12
            ,MAIN.ATTRB_TXT_COL_DFN_NM_13
            ,MAIN.ATTRB_TXT_COL_DFN_NM_14
            ,MAIN.ATTRB_TXT_COL_DFN_NM_15
            ,MAIN.ATTRB_TXT_COL_DFN_NM_16
            ,MAIN.ATTRB_TXT_COL_DFN_NM_17
            ,MAIN.ATTRB_TXT_COL_DFN_NM_18
            ,MAIN.ATTRB_TXT_COL_DFN_NM_19
            ,MAIN.ATTRB_TXT_COL_DFN_NM_20
            ,MAIN.DS_ACCT_NM
            ,MAIN.FIRST_LINE_ADDR
            ,MAIN.SCD_LINE_ADDR
            ,MAIN.THIRD_LINE_ADDR
            ,MAIN.FRTH_LINE_ADDR
            ,MAIN.CTY_ADDR
            ,MAIN.CNTY_PK
            ,MAIN.ST_CD
            ,MAIN.POST_CD
            ,MAIN.CTRY_CD
            ,MAIN.DUNS_NUM
            ,MAIN.GLN_NUM
            ,MAIN.HIN_NUM
            ,MAIN.MKTG_MAP_ATTRB_TXT_01
            ,MAIN.MKTG_MAP_ATTRB_TXT_02
            ,MAIN.MKTG_MAP_ATTRB_TXT_03
            ,MAIN.MKTG_MAP_ATTRB_TXT_04
            ,MAIN.MKTG_MAP_ATTRB_TXT_05
            ,MAIN.MKTG_MAP_ATTRB_TXT_06
            ,MAIN.MKTG_MAP_ATTRB_TXT_07
            ,MAIN.MKTG_MAP_ATTRB_TXT_08
            ,MAIN.MKTG_MAP_ATTRB_TXT_09
            ,MAIN.MKTG_MAP_ATTRB_TXT_10
            ,MAIN.MKTG_MAP_ATTRB_TXT_11
            ,MAIN.MKTG_MAP_ATTRB_TXT_12
            ,MAIN.MKTG_MAP_ATTRB_TXT_13
            ,MAIN.MKTG_MAP_ATTRB_TXT_14
            ,MAIN.MKTG_MAP_ATTRB_TXT_15
            ,MAIN.MKTG_MAP_ATTRB_TXT_16
            ,MAIN.MKTG_MAP_ATTRB_TXT_17
            ,MAIN.MKTG_MAP_ATTRB_TXT_18
            ,MAIN.MKTG_MAP_ATTRB_TXT_19
            ,MAIN.MKTG_MAP_ATTRB_TXT_20
            ,MAIN.UPLD_CSV_RQST_CMNT_TXT
        FROM (
            SELECT
                MMR.MKTG_MAP_RQST_PK
                ,MFM.DS_ACCT_NM_COL_DFN_NM
                ,MFM.FIRST_LINE_ADDR_COL_DFN_NM
                ,MFM.SCD_LINE_ADDR_COL_DFN_NM
                ,MFM.THIRD_LINE_ADDR_COL_DFN_NM
                ,MFM.FRTH_LINE_ADDR_COL_DFN_NM
                ,MFM.CTY_ADDR_COL_DFN_NM
                ,MFM.CNTY_PK_COL_DFN_NM
                ,MFM.ST_CD_COL_DFN_NM
                ,MFM.POST_CD_COL_DFN_NM
                ,MFM.CTRY_CD_COL_DFN_NM
                ,MFM.DUNS_NUM_COL_DFN_NM
                ,MFM.GLN_COL_DFN_NM
                ,MFM.HIN_COL_DFN_NM
                ,MFM.ATTRB_TXT_COL_DFN_NM_01
                ,MFM.ATTRB_TXT_COL_DFN_NM_02
                ,MFM.ATTRB_TXT_COL_DFN_NM_03
                ,MFM.ATTRB_TXT_COL_DFN_NM_04
                ,MFM.ATTRB_TXT_COL_DFN_NM_05
                ,MFM.ATTRB_TXT_COL_DFN_NM_06
                ,MFM.ATTRB_TXT_COL_DFN_NM_07
                ,MFM.ATTRB_TXT_COL_DFN_NM_08
                ,MFM.ATTRB_TXT_COL_DFN_NM_09
                ,MFM.ATTRB_TXT_COL_DFN_NM_10
                ,MFM.ATTRB_TXT_COL_DFN_NM_11
                ,MFM.ATTRB_TXT_COL_DFN_NM_12
                ,MFM.ATTRB_TXT_COL_DFN_NM_13
                ,MFM.ATTRB_TXT_COL_DFN_NM_14
                ,MFM.ATTRB_TXT_COL_DFN_NM_15
                ,MFM.ATTRB_TXT_COL_DFN_NM_16
                ,MFM.ATTRB_TXT_COL_DFN_NM_17
                ,MFM.ATTRB_TXT_COL_DFN_NM_18
                ,MFM.ATTRB_TXT_COL_DFN_NM_19
                ,MFM.ATTRB_TXT_COL_DFN_NM_20
                ,MMW.DS_ACCT_NM
                ,MMW.FIRST_LINE_ADDR
                ,MMW.SCD_LINE_ADDR
                ,MMW.THIRD_LINE_ADDR
                ,MMW.FRTH_LINE_ADDR
                ,MMW.CTY_ADDR
                ,MMW.CNTY_PK
                ,MMW.ST_CD
                ,MMW.POST_CD
                ,MMW.CTRY_CD
                ,MMW.DUNS_NUM
                ,MMW.GLN_NUM
                ,MMW.HIN_NUM
                ,MMW.MKTG_MAP_ATTRB_TXT_01
                ,MMW.MKTG_MAP_ATTRB_TXT_02
                ,MMW.MKTG_MAP_ATTRB_TXT_03
                ,MMW.MKTG_MAP_ATTRB_TXT_04
                ,MMW.MKTG_MAP_ATTRB_TXT_05
                ,MMW.MKTG_MAP_ATTRB_TXT_06
                ,MMW.MKTG_MAP_ATTRB_TXT_07
                ,MMW.MKTG_MAP_ATTRB_TXT_08
                ,MMW.MKTG_MAP_ATTRB_TXT_09
                ,MMW.MKTG_MAP_ATTRB_TXT_10
                ,MMW.MKTG_MAP_ATTRB_TXT_11
                ,MMW.MKTG_MAP_ATTRB_TXT_12
                ,MMW.MKTG_MAP_ATTRB_TXT_13
                ,MMW.MKTG_MAP_ATTRB_TXT_14
                ,MMW.MKTG_MAP_ATTRB_TXT_15
                ,MMW.MKTG_MAP_ATTRB_TXT_16
                ,MMW.MKTG_MAP_ATTRB_TXT_17
                ,MMW.MKTG_MAP_ATTRB_TXT_18
                ,MMW.MKTG_MAP_ATTRB_TXT_19
                ,MMW.MKTG_MAP_ATTRB_TXT_20
                ,MMW.UPLD_CSV_RQST_CMNT_TXT
            FROM
                MKTG_MAP_RQST MMR
                ,MKTG_FLD_MAP MFM
                ,MKTG_MAP_WRK MMW
            WHERE 
                1 = 1
            AND MMR.GLBL_CMPY_CD           = #glblCmpyCd#
            AND MMR.MKTG_MAP_RQST_PK       = #mktgMapRqstPk#
            -- JOIN TO MKTG_FLD_MAP
            AND MMR.GLBL_CMPY_CD           = MFM.GLBL_CMPY_CD
            AND MMR.MKTG_FLD_MAP_PK        = MFM.MKTG_FLD_MAP_PK
            -- JOIN TO MKTG_MAP_WRK
            AND MMR.GLBL_CMPY_CD           = MMW.GLBL_CMPY_CD
            AND MMR.MKTG_MAP_RQST_PK       = MMW.MKTG_MAP_RQST_PK
            -- EZCANCELFLAG
            AND MMR.EZCANCELFLAG           = '0'
            AND MFM.EZCANCELFLAG           = '0'
            AND MMW.EZCANCELFLAG           = '0'
            ORDER BY
                MMW.MKTG_MAP_WRK_PK ASC
        ) MAIN
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="downloadResultFile" parameterClass="Map" resultClass="Map">
        SELECT
            MAIN.MKTG_MAP_RQST_PK
            ,MAIN.MKTG_FLD_MAP_NM
            ,MAIN.DS_ACCT_NM_COL_DFN_NM
            ,MAIN.FIRST_LINE_ADDR_COL_DFN_NM
            ,MAIN.SCD_LINE_ADDR_COL_DFN_NM
            ,MAIN.THIRD_LINE_ADDR_COL_DFN_NM
            ,MAIN.FRTH_LINE_ADDR_COL_DFN_NM
            ,MAIN.CTY_ADDR_COL_DFN_NM
            ,MAIN.CNTY_PK_COL_DFN_NM
            ,MAIN.ST_CD_COL_DFN_NM
            ,MAIN.POST_CD_COL_DFN_NM
            ,MAIN.CTRY_CD_COL_DFN_NM
            ,MAIN.DUNS_NUM_COL_DFN_NM
            ,MAIN.GLN_COL_DFN_NM
            ,MAIN.HIN_COL_DFN_NM
            ,MAIN.ATTRB_TXT_COL_DFN_NM_01
            ,MAIN.ATTRB_TXT_COL_DFN_NM_02
            ,MAIN.ATTRB_TXT_COL_DFN_NM_03
            ,MAIN.ATTRB_TXT_COL_DFN_NM_04
            ,MAIN.ATTRB_TXT_COL_DFN_NM_05
            ,MAIN.ATTRB_TXT_COL_DFN_NM_06
            ,MAIN.ATTRB_TXT_COL_DFN_NM_07
            ,MAIN.ATTRB_TXT_COL_DFN_NM_08
            ,MAIN.ATTRB_TXT_COL_DFN_NM_09
            ,MAIN.ATTRB_TXT_COL_DFN_NM_10
            ,MAIN.ATTRB_TXT_COL_DFN_NM_11
            ,MAIN.ATTRB_TXT_COL_DFN_NM_12
            ,MAIN.ATTRB_TXT_COL_DFN_NM_13
            ,MAIN.ATTRB_TXT_COL_DFN_NM_14
            ,MAIN.ATTRB_TXT_COL_DFN_NM_15
            ,MAIN.ATTRB_TXT_COL_DFN_NM_16
            ,MAIN.ATTRB_TXT_COL_DFN_NM_17
            ,MAIN.ATTRB_TXT_COL_DFN_NM_18
            ,MAIN.ATTRB_TXT_COL_DFN_NM_19
            ,MAIN.ATTRB_TXT_COL_DFN_NM_20
            ,MAIN.DS_ACCT_NM
            ,MAIN.FIRST_LINE_ADDR
            ,MAIN.SCD_LINE_ADDR
            ,MAIN.THIRD_LINE_ADDR
            ,MAIN.FRTH_LINE_ADDR
            ,MAIN.CTY_ADDR
            ,MAIN.CNTY_PK
            ,MAIN.ST_CD
            ,MAIN.POST_CD
            ,MAIN.CTRY_CD
            ,MAIN.DUNS_NUM
            ,MAIN.GLN_NUM
            ,MAIN.HIN_NUM
            ,MAIN.MKTG_MAP_ATTRB_TXT_01
            ,MAIN.MKTG_MAP_ATTRB_TXT_02
            ,MAIN.MKTG_MAP_ATTRB_TXT_03
            ,MAIN.MKTG_MAP_ATTRB_TXT_04
            ,MAIN.MKTG_MAP_ATTRB_TXT_05
            ,MAIN.MKTG_MAP_ATTRB_TXT_06
            ,MAIN.MKTG_MAP_ATTRB_TXT_07
            ,MAIN.MKTG_MAP_ATTRB_TXT_08
            ,MAIN.MKTG_MAP_ATTRB_TXT_09
            ,MAIN.MKTG_MAP_ATTRB_TXT_10
            ,MAIN.MKTG_MAP_ATTRB_TXT_11
            ,MAIN.MKTG_MAP_ATTRB_TXT_12
            ,MAIN.MKTG_MAP_ATTRB_TXT_13
            ,MAIN.MKTG_MAP_ATTRB_TXT_14
            ,MAIN.MKTG_MAP_ATTRB_TXT_15
            ,MAIN.MKTG_MAP_ATTRB_TXT_16
            ,MAIN.MKTG_MAP_ATTRB_TXT_17
            ,MAIN.MKTG_MAP_ATTRB_TXT_18
            ,MAIN.MKTG_MAP_ATTRB_TXT_19
            ,MAIN.MKTG_MAP_ATTRB_TXT_20
            ,MAIN.CRAT_USR_ID
            ,MAIN.CRAT_TS
            ,MAIN.UPLD_FILE_NM
            ,MAIN.MATCH_CRIT_TP_TXT
            ,MAIN.EXACT_MATCH_LOC_NUM
            ,MAIN.EXACT_MATCH_SF_ACCT_ID
            ,MAIN.PRTL_MATCH_LOC_NUM
            ,MAIN.PRTL_MATCH_SF_ACCT_ID
            ,MAIN.DUNS_MATCH_LOC_NUM
            ,MAIN.DUNS_MATCH_SF_ACCT_ID
            ,MAIN.GLN_MATCH_LOC_NUM
            ,MAIN.GLN_MATCH_SF_ACCT_ID
            ,MAIN.CANDI_TRTY_NM
        FROM (
            SELECT
                MMR.MKTG_MAP_RQST_PK
                ,MFM.MKTG_FLD_MAP_NM
                ,MFM.DS_ACCT_NM_COL_DFN_NM
                ,MFM.FIRST_LINE_ADDR_COL_DFN_NM
                ,MFM.SCD_LINE_ADDR_COL_DFN_NM
                ,MFM.THIRD_LINE_ADDR_COL_DFN_NM
                ,MFM.FRTH_LINE_ADDR_COL_DFN_NM
                ,MFM.CTY_ADDR_COL_DFN_NM
                ,MFM.CNTY_PK_COL_DFN_NM
                ,MFM.ST_CD_COL_DFN_NM
                ,MFM.POST_CD_COL_DFN_NM
                ,MFM.CTRY_CD_COL_DFN_NM
                ,MFM.DUNS_NUM_COL_DFN_NM
                ,MFM.GLN_COL_DFN_NM
                ,MFM.HIN_COL_DFN_NM
                ,MFM.ATTRB_TXT_COL_DFN_NM_01
                ,MFM.ATTRB_TXT_COL_DFN_NM_02
                ,MFM.ATTRB_TXT_COL_DFN_NM_03
                ,MFM.ATTRB_TXT_COL_DFN_NM_04
                ,MFM.ATTRB_TXT_COL_DFN_NM_05
                ,MFM.ATTRB_TXT_COL_DFN_NM_06
                ,MFM.ATTRB_TXT_COL_DFN_NM_07
                ,MFM.ATTRB_TXT_COL_DFN_NM_08
                ,MFM.ATTRB_TXT_COL_DFN_NM_09
                ,MFM.ATTRB_TXT_COL_DFN_NM_10
                ,MFM.ATTRB_TXT_COL_DFN_NM_11
                ,MFM.ATTRB_TXT_COL_DFN_NM_12
                ,MFM.ATTRB_TXT_COL_DFN_NM_13
                ,MFM.ATTRB_TXT_COL_DFN_NM_14
                ,MFM.ATTRB_TXT_COL_DFN_NM_15
                ,MFM.ATTRB_TXT_COL_DFN_NM_16
                ,MFM.ATTRB_TXT_COL_DFN_NM_17
                ,MFM.ATTRB_TXT_COL_DFN_NM_18
                ,MFM.ATTRB_TXT_COL_DFN_NM_19
                ,MFM.ATTRB_TXT_COL_DFN_NM_20
                ,MM.DS_ACCT_NM
                ,MM.FIRST_LINE_ADDR
                ,MM.SCD_LINE_ADDR
                ,MM.THIRD_LINE_ADDR
                ,MM.FRTH_LINE_ADDR
                ,MM.CTY_ADDR
                ,MM.CNTY_PK
                ,MM.ST_CD
                ,MM.POST_CD
                ,MM.CTRY_CD
                ,MM.DUNS_NUM
                ,MM.GLN_NUM
                ,MM.HIN_NUM
                ,MM.MKTG_MAP_ATTRB_TXT_01
                ,MM.MKTG_MAP_ATTRB_TXT_02
                ,MM.MKTG_MAP_ATTRB_TXT_03
                ,MM.MKTG_MAP_ATTRB_TXT_04
                ,MM.MKTG_MAP_ATTRB_TXT_05
                ,MM.MKTG_MAP_ATTRB_TXT_06
                ,MM.MKTG_MAP_ATTRB_TXT_07
                ,MM.MKTG_MAP_ATTRB_TXT_08
                ,MM.MKTG_MAP_ATTRB_TXT_09
                ,MM.MKTG_MAP_ATTRB_TXT_10
                ,MM.MKTG_MAP_ATTRB_TXT_11
                ,MM.MKTG_MAP_ATTRB_TXT_12
                ,MM.MKTG_MAP_ATTRB_TXT_13
                ,MM.MKTG_MAP_ATTRB_TXT_14
                ,MM.MKTG_MAP_ATTRB_TXT_15
                ,MM.MKTG_MAP_ATTRB_TXT_16
                ,MM.MKTG_MAP_ATTRB_TXT_17
                ,MM.MKTG_MAP_ATTRB_TXT_18
                ,MM.MKTG_MAP_ATTRB_TXT_19
                ,MM.MKTG_MAP_ATTRB_TXT_20
                ,MMR.CRAT_USR_ID
                ,MMR.CRAT_TS
                ,MMR.UPLD_FILE_NM
                ,MM.MATCH_CRIT_TP_TXT
                ,MM.EXACT_MATCH_LOC_NUM
                ,MM.EXACT_MATCH_SF_ACCT_ID
                ,MM.PRTL_MATCH_LOC_NUM
                ,MM.PRTL_MATCH_SF_ACCT_ID
                ,MM.DUNS_MATCH_LOC_NUM
                ,MM.DUNS_MATCH_SF_ACCT_ID
                ,MM.GLN_MATCH_LOC_NUM
                ,MM.GLN_MATCH_SF_ACCT_ID
                ,MM.CANDI_TRTY_NM
            FROM
                MKTG_MAP_RQST MMR
                ,MKTG_FLD_MAP MFM
                ,MKTG_MAP MM
            WHERE 
                1 = 1
            AND MMR.GLBL_CMPY_CD          = #glblCmpyCd#
            AND MMR.MKTG_MAP_RQST_PK      = #mktgMapRqstPk#
            -- JOIN TO MKTG_FLD_MAP
            AND MMR.GLBL_CMPY_CD          = MFM.GLBL_CMPY_CD
            AND MMR.MKTG_FLD_MAP_PK       = MFM.MKTG_FLD_MAP_PK
            -- JOIN TO MKTG_MAP
            AND MMR.GLBL_CMPY_CD          = MM.GLBL_CMPY_CD
            AND MMR.MKTG_MAP_RQST_PK      = MM.MKTG_MAP_RQST_PK
            <isEqual property="exactMatchFlg" compareValue="Y">
            AND 
            (
                MM.EXACT_MATCH_FLG        = #exactMatchFlg#
                OR 
                MM.DUNS_MATCH_FLG         = #dunsMatchFlg#
                OR 
                MM.GLN_MATCH_FLG          = #glnMatchFlg#
            )
            AND MM.PRTL_MATCH_FLG         = #prtlMatchFlg#
            </isEqual>
            <isEqual property="exactMatchFlg" compareValue="N">
            AND MM.EXACT_MATCH_FLG        = #exactMatchFlg#
            AND MM.DUNS_MATCH_FLG         = #dunsMatchFlg#
            AND MM.GLN_MATCH_FLG          = #glnMatchFlg#
            AND MM.PRTL_MATCH_FLG         = #prtlMatchFlg#
            </isEqual>
            -- EZCANCELFLAG
            AND MMR.EZCANCELFLAG          = '0'
            AND MFM.EZCANCELFLAG          = '0'
            AND MM.EZCANCELFLAG           = '0'
            ORDER BY
                MKTG_MAP_PK ASC
        ) MAIN
        WHERE ROWNUM &lt;= #rowNum#
    </statement>

    <statement id="findCntyPk" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            C.CNTY_PK
        FROM
            CNTY C
        WHERE
            1 = 1
        AND C.GLBL_CMPY_CD   = #glblCmpyCd#
        AND UPPER(C.CNTY_NM) = #cntyNm#
        AND C.ST_CD          = #stCd#
        AND C.EZCANCELFLAG = '0'
    </statement>

    <statement id="findCtryCd" parameterClass="Map" resultClass="String">
        SELECT
            C.CTRY_CD
        FROM
            CTRY C
        WHERE
            1 = 1
        AND C.GLBL_CMPY_CD   = #glblCmpyCd#
        AND C.CTRY_CD        = #ctryCd#
        AND C.EZCANCELFLAG   = '0'
    </statement>

    <statement id="findCtryMapCd" parameterClass="Map" resultClass="String">
        SELECT
            CM.CTRY_CD
        FROM
            CTRY_MAP CM
        WHERE
            1 = 1
        AND CM.GLBL_CMPY_CD        = #glblCmpyCd#
        AND CM.ISO_CTRY_CD         = #ctryCd#
        AND CM.EZCANCELFLAG        = '0'
    </statement>

</sqlMap>