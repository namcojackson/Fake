<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<sqlMap namespace="NPZC115001">

    <statement id="getPrntVndCd" parameterClass="Map" resultClass="Map">
        SELECT
             PV.PRNT_VND_CD
        FROM
             PRNT_VND PV
            ,VND      V
        WHERE
            PV.GLBL_CMPY_CD  = #glblCmpyCd#
        AND PV.GLBL_CMPY_CD  = V.GLBL_CMPY_CD
        AND PV.PRNT_VND_PK   = V.PRNT_VND_PK
        <iterate property="vndCdList" var="vndCd[]" open="AND V.VND_CD IN (" close=")" conjunction=",">
            #vndCd[]#
        </iterate>
        AND PV.EZCANCELFLAG  = '0'
        AND V.EZCANCELFLAG   = '0'
    </statement>

    <statement id="getAslEndDt" parameterClass="Map" resultClass="Map">
        SELECT
             NVL(AH.ASL_END_DT, '99991231')        AS ASL_END_DT
             ,NVL(MAX(AD.EFF_THRU_DT), '99991231') AS EFF_THRU_DT
        FROM
             ASL_HDR AH
            ,ASL_DTL AD
        WHERE
            AH.GLBL_CMPY_CD  = #glblCmpyCd#
        AND AH.ASL_HDR_PK    = #aslHdrPk#
        AND AH.GLBL_CMPY_CD  = AD.GLBL_CMPY_CD
        AND AH.ASL_HDR_PK    = AD.ASL_HDR_PK
        AND AH.EZCANCELFLAG  = '0'
        AND AD.EZCANCELFLAG  = '0'
        GROUP BY
            AH.ASL_END_DT
    </statement>

    <statement id="getAslDtlInfo" parameterClass="Map" resultClass="Map">
        SELECT
             AD.ASL_DTL_PK
             ,AD.ASL_HDR_PK
             ,AD.MDSE_CD
             ,AD.PRIM_SPLY_FLG
             ,AD.VND_UOM_CD
             ,AD.SPLY_ITEM_NUM
             ,AD.VND_CD
             ,AD.UNIT_PRC_AMT
             ,AD.BASE_ORD_QTY
             ,AD.VND_UOM_QTY
             ,AD.EFF_FROM_DT
             ,NVL(AD.EFF_THRU_DT, '99991231')   AS EFF_THRU_DT
             ,AD.VND_MIN_ORD_QTY
             ,AD.VND_INCR_ORD_QTY
             ,AD.VND_LT_DAYS_NUM
             <!-- START 2023/02/07 S.Dong [QC#60966, ADD] -->
             ,AD.VND_SHIP_LT_DAYS_NUM
             <!-- END 2023/02/07 S.Dong [QC#60966, ADD] -->
        FROM
             ASL_HDR            AH
            ,ASL_DTL            AD
        WHERE
            AH.GLBL_CMPY_CD         = #glblCmpyCd#
        AND AH.PRNT_VND_CD          = #prntVndCd#
        AND AH.GLBL_CMPY_CD         = AD.GLBL_CMPY_CD
        AND AH.ASL_HDR_PK           = AD.ASL_HDR_PK
        AND AD.VND_CD               = #vndCd#
        AND NVL(AD.SPLY_ITEM_NUM, AD.MDSE_CD) = #splyItemNum#
        AND AD.EFF_FROM_DT          &lt;= #procDt#
        AND NVL(AD.EFF_THRU_DT, '99991231') &gt;= #procDt#
        <isEqual property="isAslQlfyRefFlg" compareValue="Y">
        AND EXISTS (
                SELECT
                    1
                FROM
                    ASL_QLFY_RELN       AQR
                WHERE
                    AQR.GLBL_CMPY_CD    = AH.GLBL_CMPY_CD
                AND AQR.ASL_HDR_PK      = AH.ASL_HDR_PK
                AND AQR.ASL_QLFY_TP_CD  = #aslQlfyTpCd#
                <iterate property="aslQlfyRefCdList" var="aslQlfyRefCd[]" open="AND AQR.ASL_QLFY_REF_CD IN (" close=")" conjunction=",">
                    #aslQlfyRefCd[]#
                </iterate>
                AND AQR.EZCANCELFLAG    = '0'
        )
        </isEqual>
        AND AH.EZCANCELFLAG         = '0'
        AND AD.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getQlfyRelnList" parameterClass="Map" resultClass="BigDecimal">
         SELECT
             ASL_QLFY_RELN_PK
         FROM
             ASL_QLFY_RELN AQR
         WHERE 1=1
            AND AQR.GLBL_CMPY_CD      = #glblCmpyCd#
            AND AQR.ASL_HDR_PK        = #aslHdrPk#
                <iterate property="aslQlfyRelnPkList" var="aslQlfyRelnPk[]" open="AND AQR.ASL_QLFY_RELN_PK NOT IN (" close=")" conjunction=",">
                    #aslQlfyRelnPk[]#
                </iterate>
            AND AQR.EZCANCELFLAG      = '0'
    </statement>

</sqlMap>