<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NMAB262001">
    <statement id="getRequestInfo" parameterClass="Map" resultClass="Map">
        SELECT
             B.TRTY_UPD_RQST_DTL_PK            AS TRTY_UPD_RQST_DTL_PK
            ,B.TRTY_UPD_RQST_HDR_PK            AS TRTY_UPD_RQST_HDR_PK
            ,B.TRTY_ORG_CD                     AS TRTY_ORG_CD
            ,B.CUR_PSN_NUM                     AS CUR_PSN_NUM
            ,B.MOVE_PSN_NUM                    AS MOVE_PSN_NUM
            ,B.MOVE_EFF_FROM_DT                AS MOVE_EFF_FROM_DT_TXT
            ,B.MOVE_EFF_THRU_DT                AS MOVE_EFF_THRU_DT_TXT
            ,B.TRTY_END_DT                     AS TRTY_END_DT_TXT
            ,B.TRTY_UPD_MODE_TP_CD             AS TRTY_UPD_MODE_TP_CD
            ,A.RQST_RSLT_CMNT_TXT              AS RQST_CMNT_TXT
        FROM
             TRTY_UPD_RQST_HDR A
            ,TRTY_UPD_RQST_DTL B
        WHERE
             A.GLBL_CMPY_CD               = #glblCmpyCd#
            AND A.RQST_CRAT_SYS_TP_CD     = #rqstCratSysTpCd#
            AND A.RQST_RSLT_TP_CD         = #rqstRsltTpCd#
            AND A.GLBL_CMPY_CD            = B.GLBL_CMPY_CD
            AND A.TRTY_UPD_RQST_HDR_PK    = B.TRTY_UPD_RQST_HDR_PK
            AND A.EZCANCELFLAG            = '0'
            AND B.EZCANCELFLAG            = '0'
    </statement>
    <statement id="getWrkInfo" parameterClass="Map" resultClass="Map">
        SELECT
             A.UPLD_CSV_RQST_PK            AS UPLD_CSV_RQST_PK
            ,A.UPLD_CSV_RQST_ROW_NUM       AS UPLD_CSV_RQST_ROW_NUM
            ,A.TRTY_ORG_CD                 AS TRTY_ORG_CD
            ,A.TRTY_ORG_NM                 AS TRTY_ORG_NM
            ,A.CUR_PSN_NUM                 AS CUR_PSN_NUM
            ,A.MOVE_PSN_NUM                AS MOVE_PSN_NUM
            ,A.MOVE_EFF_FROM_DT_TXT        AS MOVE_EFF_FROM_DT_TXT
            ,A.MOVE_EFF_THRU_DT_TXT        AS MOVE_EFF_THRU_DT_TXT
            ,A.TRTY_END_DT_TXT             AS TRTY_END_DT_TXT
            ,A.TRTY_UPD_MODE_TP_CD         AS TRTY_UPD_MODE_TP_CD
            ,A.MASS_UPD_RSN_CMNT_TXT       AS MASS_UPD_RSN_CMNT_TXT
            ,A.UPLD_CSV_RQST_CMNT_TXT      AS RQST_CMNT_TXT
        FROM
             TRTY_UPD_WRK A
        WHERE
             A.GLBL_CMPY_CD               = #glblCmpyCd#
            AND A.UPLD_CSV_RQST_PK        = #upldCsvRqstPk#
            AND A.EZCANCELFLAG            = '0'
    </statement>
    <statement id="cntRequestInfo" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(1) AS COUNT
        FROM
             TRTY_UPD_RQST_HDR A
            ,TRTY_UPD_RQST_DTL B
        WHERE
             A.GLBL_CMPY_CD               = #glblCmpyCd#
            AND A.RQST_CRAT_SYS_TP_CD     = #rqstCratSysTpCd#
            AND A.RQST_RSLT_TP_CD         = #rqstRsltTpCd#
            AND A.GLBL_CMPY_CD            = B.GLBL_CMPY_CD
            AND A.TRTY_UPD_RQST_HDR_PK    = B.TRTY_UPD_RQST_HDR_PK
            AND B.TRTY_ORG_CD             = #trtyOrgCd#
            AND A.EZCANCELFLAG            = '0'
            AND B.EZCANCELFLAG            = '0'
    </statement>
    <statement id="cntWrkInfo" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(1) AS COUNT
        FROM
             TRTY_UPD_WRK A
        WHERE
             A.GLBL_CMPY_CD               = #glblCmpyCd#
            AND A.UPLD_CSV_RQST_PK        = #upldCsvRqstPk#
            AND A.TRTY_ORG_NM             = #trtyOrgNm#
            AND A.EZCANCELFLAG            = '0'
    </statement>
    <statement id="getEzuptime" parameterClass="Map" resultClass="String">
        SELECT
             C.EZUPTIME            AS EZUPTIME
        FROM
             DS_ORG_UNIT           A
            ,ORG_STRU_TP           B
            ,DS_ORG_RESRC_RELN     C
            ,S21_PSN               D
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD           = #orgCd#
            </isNotNull>
            <isNotNull property="orgNm">
            AND A.ORG_NM           = #orgNm#
            </isNotNull>
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD   = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG    = #trtyStruFlg#
            AND A.GLBL_CMPY_CD     = C.GLBL_CMPY_CD
            AND A.ORG_CD           = C.ORG_CD
            AND A.ORG_STRU_TP_CD   = C.ORG_STRU_TP_CD
            AND C.GLBL_CMPY_CD     = D.GLBL_CMPY_CD
            AND C.PSN_CD           = D.PSN_CD
            AND D.PSN_NUM          = #psnNum#
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
            AND C.EZCANCELFLAG     = '0'
            AND D.EZCANCELFLAG     = '0'
    </statement>
    <statement id="checkMoveToResrcTrtyRelnExist" parameterClass="Map" resultClass="Map">
        SELECT
             C.EFF_FROM_DT               AS EFF_FROM_DT
           , NVL(C.EFF_THRU_DT,#maxDt#)  AS EFF_THRU_DT
        FROM
             DS_ORG_UNIT           A
            ,ORG_STRU_TP           B
            ,DS_ORG_RESRC_RELN     C
            ,S21_PSN               D
        WHERE
             A.GLBL_CMPY_CD                 = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD                    = #orgCd#
            </isNotNull>
            <isNotNull property="    orgNm">
            AND A.ORG_NM                    = #orgNm#
            </isNotNull>
            AND A.GLBL_CMPY_CD              = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD            = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG             = #trtyStruFlg#
            AND A.GLBL_CMPY_CD              = C.GLBL_CMPY_CD
            AND A.ORG_CD                    = C.ORG_CD
            AND A.ORG_STRU_TP_CD            = C.ORG_STRU_TP_CD
            AND C.GLBL_CMPY_CD              = D.GLBL_CMPY_CD
            AND C.PSN_CD                    = D.PSN_CD
            AND C.GNRN_TP_CD               IN (#gnrnTp_current#, #gnrnTp_future#)
            AND D.PSN_NUM                   = #psnNum#
            AND A.EZCANCELFLAG              = '0'
            AND B.EZCANCELFLAG              = '0'
            AND C.EZCANCELFLAG              = '0'
            AND D.EZCANCELFLAG              = '0'
    </statement>
    <statement id="getResourceDt" parameterClass="Map" resultClass="Map">
        SELECT
             A.EFF_FROM_DT        AS EFF_FROM_DT
             ,A.EFF_THRU_DT       AS EFF_THRU_DT
        FROM
             DS_ORG_UNIT          A
            ,ORG_STRU_TP          B
        WHERE
             A.GLBL_CMPY_CD       = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD          = #orgCd#
            </isNotNull>
            <isNotNull property="orgNm">
            AND A.ORG_NM          = #orgNm#
            </isNotNull>
            AND A.GLBL_CMPY_CD    = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD  = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG   = #trtyStruFlg#
            AND A.EZCANCELFLAG    = '0'
            AND B.EZCANCELFLAG    = '0'
    </statement>
    <statement id="getBusinessAreaBase" parameterClass="Map" resultClass="String">
        SELECT
             C.BIZ_AREA_ORG_CD            AS BIZ_AREA_ORG_CD
        FROM
             DS_ORG_UNIT       A
            ,ORG_STRU_TP       B
            ,BIZ_AREA_ORG      C
            ,DS_ORG_RESRC_RELN D
            ,S21_PSN           E
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD   = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG    = #trtyStruFlg#
            AND A.GLBL_CMPY_CD     = C.GLBL_CMPY_CD
            AND A.FIRST_ORG_CD     = C.BIZ_AREA_ORG_CD
            AND A.ORG_STRU_TP_CD   = C.ORG_STRU_TP_CD
            AND A.GLBL_CMPY_CD     = D.GLBL_CMPY_CD
            AND A.ORG_CD           = D.ORG_CD
            AND D.EFF_FROM_DT      &lt;= #slsDate#
            AND NVL(D.EFF_THRU_DT, #hitDate#)    &gt;= #slsDate#
            AND D.GLBL_CMPY_CD     = E.GLBL_CMPY_CD
            AND D.PSN_CD           = E.PSN_CD
            AND E.PSN_NUM          = #psnNum#
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
            AND C.EZCANCELFLAG     = '0'
            AND D.EZCANCELFLAG     = '0'
            AND E.EZCANCELFLAG     = '0'
    </statement>
    <statement id="getBusinessArea" parameterClass="Map" resultClass="String">
        SELECT
             C.BIZ_AREA_ORG_CD            AS BIZ_AREA_ORG_CD
        FROM
             DS_ORG_UNIT A
            ,ORG_STRU_TP  B
            ,BIZ_AREA_ORG  C
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD          = #orgCd#
            </isNotNull>
            <isNotNull property="orgNm">
            AND A.ORG_NM          = #orgNm#
            </isNotNull>
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD   = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG    = #trtyStruFlg#
            AND A.GLBL_CMPY_CD     = C.GLBL_CMPY_CD
            AND A.FIRST_ORG_CD     = C.BIZ_AREA_ORG_CD
            AND A.ORG_STRU_TP_CD   = C.ORG_STRU_TP_CD
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
            AND C.EZCANCELFLAG     = '0'
    </statement>
     <statement id="cntRsrcRl" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(1)           AS COUNT
        FROM
             S21_PSN            A
            ,ORG_FUNC_ASG       B
            ,ORG_TOC_CHNG_RQST  C
            ,TOC_ORG_STRU_RELN  D
            ,DS_ORG_UNIT        E
            ,BIZ_AREA_ORG       F
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            AND A.PSN_NUM          = #psnNum#
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.PSN_CD           = B.PSN_CD
            AND B.EFF_FROM_DT      &lt;= #slsDate#
            AND NVL(B.EFF_THRU_DT, #hitDate#)    &gt;= #slsDate#
            <iterate property="gnrnTpCd" var="elem[]" open="AND B.GNRN_TP_CD   IN (" close=")" conjunction=",">
                #elem[]#
            </iterate>
            AND B.GLBL_CMPY_CD     = C.GLBL_CMPY_CD
            AND B.TOC_CD           = C.TOC_CD
            AND C.GLBL_CMPY_CD     = D.GLBL_CMPY_CD
            AND C.TOC_CD           = D.TOC_CD
            AND D.ORG_CD           = E.ORG_CD
            AND E.FIRST_ORG_CD     = F.BIZ_AREA_ORG_CD
            AND F.SLS_FLG          = #slsFlg#
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
            AND C.EZCANCELFLAG     = '0'
            AND D.EZCANCELFLAG     = '0'
            AND E.EZCANCELFLAG     = '0'
            AND F.EZCANCELFLAG     = '0'
    </statement>
    <statement id="getEzuptimeTrty" parameterClass="Map" resultClass="String">
        SELECT
             A.EZUPTIME            AS EZUPTIME
        FROM
             DS_ORG_UNIT A
            ,ORG_STRU_TP B
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD          = #orgCd#
            </isNotNull>
            <isNotNull property="orgNm">
            AND A.ORG_NM          = #orgNm#
            </isNotNull>
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD   = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG    = #trtyStruFlg#
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
    </statement>
    <statement id="getEffFromDt" parameterClass="Map" resultClass="String">
        SELECT
             A.EFF_FROM_DT            AS EFF_FROM_DT
        FROM
             DS_ORG_UNIT A
            ,ORG_STRU_TP B
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD           = #orgCd#
            </isNotNull>
            <isNotNull property="orgNm">
            AND A.ORG_NM           = #orgNm#
            </isNotNull>
            AND A.EFF_FROM_DT      &lt;= #slsDate#
            AND NVL(A.EFF_THRU_DT, #hitDate#)    &gt;= #slsDate#
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD   = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG    = #trtyStruFlg#
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
    </statement>
    <statement id="getEffFromDtRR" parameterClass="Map" resultClass="String">
        SELECT
             MAX(A.EFF_FROM_DT)    AS EFF_FROM_DT
        FROM
             DS_ORG_UNIT       A
            ,ORG_STRU_TP       B
            ,DS_ORG_RESRC_RELN C
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD           = #orgCd#
            </isNotNull>
            <isNotNull property="orgNm">
            AND A.ORG_NM           = #orgNm#
            </isNotNull>
            AND A.EFF_FROM_DT      &lt;= #slsDate#
            AND NVL(A.EFF_THRU_DT, #hitDate#)    &gt;= #slsDate#
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD   = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG    = #trtyStruFlg#
            AND A.GLBL_CMPY_CD     = C.GLBL_CMPY_CD
            AND A.ORG_CD           = C.ORG_CD
            AND A.ORG_STRU_TP_CD   = C.ORG_STRU_TP_CD
            AND C.EFF_FROM_DT      &lt;= #slsDate#
            AND NVL(C.EFF_THRU_DT, #hitDate#)    &gt;= #slsDate#
            <iterate property="gnrnTpCd" var="elem[]" open="AND C.GNRN_TP_CD   IN (" close=")" conjunction=",">
                #elem[]#
            </iterate>
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
            AND C.EZCANCELFLAG     = '0'
    </statement>
    <statement id="getEffFromDtTR" parameterClass="Map" resultClass="String">
        SELECT
             MAX(C.EFF_FROM_DT)    AS EFF_FROM_DT
        FROM
             DS_ORG_UNIT A
            ,ORG_STRU_TP B
            ,TRTY_RULE   C
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD           = #orgCd#
            </isNotNull>
            <isNotNull property="orgNm">
            AND A.ORG_NM           = #orgNm#
            </isNotNull>
            AND A.EFF_FROM_DT      &lt;= #slsDate#
            AND NVL(A.EFF_THRU_DT, #hitDate#)    &gt;= #slsDate#
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD   = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG    = #trtyStruFlg#
            AND A.GLBL_CMPY_CD     = C.GLBL_CMPY_CD
            AND A.ORG_CD           = C.ORG_CD
            AND A.ORG_STRU_TP_CD   = C.ORG_STRU_TP_CD
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
            AND C.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getEffFromDtDsOrgReln" parameterClass="Map" resultClass="String">
        SELECT
             MAX(C.EFF_FROM_DT)    AS EFF_FROM_DT
        FROM
             DS_ORG_UNIT A
            ,ORG_STRU_TP B
            ,DS_ORG_RELN C
        WHERE
             A.GLBL_CMPY_CD        = #glblCmpyCd#
            <isNotNull property="orgCd">
            AND A.ORG_CD           = #orgCd#
            </isNotNull>
            <isNotNull property="orgNm">
            AND A.ORG_NM           = #orgNm#
            </isNotNull>
            AND A.EFF_FROM_DT      &lt;= #slsDate#
            AND NVL(A.EFF_THRU_DT, #hitDate#)    &gt;= #slsDate#
            AND A.GLBL_CMPY_CD     = B.GLBL_CMPY_CD
            AND A.ORG_STRU_TP_CD   = B.ORG_STRU_TP_CD
            AND B.TRTY_STRU_FLG    = #trtyStruFlg#
            AND A.GLBL_CMPY_CD     = C.GLBL_CMPY_CD
            AND A.ORG_CD           = C.ORG_CD
            AND A.ORG_STRU_TP_CD   = C.ORG_STRU_TP_CD
            AND A.EZCANCELFLAG     = '0'
            AND B.EZCANCELFLAG     = '0'
            AND C.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getPsnCd" parameterClass="Map" resultClass="String">
        SELECT
             A.PSN_CD         AS PSN_CD
        FROM
             S21_PSN          A
        WHERE
             A.GLBL_CMPY_CD   = #glblCmpyCd#
            AND A.PSN_NUM     = #psnNum#
            AND A.EZCANCELFLAG    = '0'
    </statement>
    <statement id="getDsOrgResrcReln" parameterClass="Map" resultClass="Map">
        SELECT
             A.ORG_STRU_TP_CD         AS ORG_STRU_TP_CD
             ,A.COA_CC_CD             AS COA_CC_CD
             ,A.COA_BR_CD             AS COA_BR_CD
             ,A.GNRN_TP_CD            AS GNRN_TP_CD
             ,A.NON_SLS_REP_FLG       AS NON_SLS_REP_FLG
             ,A.ORG_FUNC_ROLE_TP_CD   AS ORG_FUNC_ROLE_TP_CD
             ,A.ACCT_TEAM_ROLE_TP_CD  AS ACCT_TEAM_ROLE_TP_CD
             ,A.EFF_FROM_DT           AS EFF_FROM_DT
        FROM
             DS_ORG_RESRC_RELN          A
        WHERE
             A.GLBL_CMPY_CD   = #glblCmpyCd#
            AND A.ORG_CD      = #orgCd#
            AND A.PSN_CD      = #psnCd#
            AND A.EZCANCELFLAG    = '0'
    </statement>
</sqlMap>
