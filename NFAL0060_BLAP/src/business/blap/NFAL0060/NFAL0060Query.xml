<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NFAL0060Query">

	<typeAlias alias="NFAL0060CMsg"		type="business.blap.NFAL0060.NFAL0060CMsg"/>
	<typeAlias alias="NFAL0060_ACMsg"	type="business.blap.NFAL0060.NFAL0060_ACMsg"/>	
	<typeAlias alias="AJE_PTRNTMsg"	type="business.db.AJE_PTRNTMsg"/>

	<statement id="getExistAjeIntfcTpCdList" parameterClass="Map" resultClass="Map">
		SELECT 
			AJE_INTFC_TP_CD		AS	AJE_INTFC_TP_CD
		, 	MAX(AJE_INTFC_TP_NM)	AS	AJE_INTFC_TP_NM
		FROM 
			AJE_PTRN_IND_TP
		WHERE 
		  	EZCANCELFLAG = '0'
		AND GLBL_CMPY_CD = #glblCmpyCd#
		GROUP BY 
			AJE_INTFC_TP_CD
		ORDER BY 
			AJE_INTFC_TP_CD
	</statement>	
	
	<statement id="getExistAjePtrnIndTpCdList" parameterClass="Map" resultClass="Map">
		SELECT 
			AJE_PTRN_IND_TP_CD		AS	AJE_PTRN_IND_TP_CD
		, 	MAX(AJE_PTRN_IND_TP_NM)	AS	AJE_PTRN_IND_TP_NM
		FROM 
			AJE_PTRN_IND_TP
		WHERE 
		  	EZCANCELFLAG = '0'
		AND GLBL_CMPY_CD = #glblCmpyCd#
		GROUP BY 
			AJE_PTRN_IND_TP_CD
		ORDER BY 
			AJE_PTRN_IND_TP_CD
	</statement>
	
	<statement id="getActlCdByIndTpCd" parameterClass="Map" resultClass="Map">
		SELECT 
			AJE_PTRN_ACTL_CD	AS	AJE_PTRN_ACTL_CD
		,	AJE_PTRN_ACTL_NM	AS	AJE_PTRN_ACTL_NM
		FROM 
			AJE_PTRN_IND_TP
		WHERE 
			EZCANCELFLAG 		='0'
		AND GLBL_CMPY_CD 		= #glblCmpyCd#
		AND AJE_PTRN_IND_TP_CD 	= #ajePtrnIndTpCd#
		GROUP BY 
			AJE_PTRN_ACTL_CD
		,	AJE_PTRN_ACTL_NM
		ORDER BY 
			AJE_PTRN_ACTL_CD
	</statement>
	
	<statement id="getColumnNameByIntfcNm" parameterClass="Map" resultClass="Map">
		SELECT 
		  COLUMN_NAME 
		FROM 
		  USER_TAB_COLUMNS 
		WHERE 
		  TABLE_NAME = #ajeIntfcTblNm#
		ORDER BY 
		  COLUMN_NAME
	</statement>

	<statement id="getCdTblListCd" parameterClass="Map" resultClass="Map">
		SELECT
			T1.COL_CD     AS COL_CD
		,	T1.COL_NM     AS COL_NM
		,	T1.ROW_NUM    AS ROW_NUM
		FROM (
			SELECT
				ROW_NUMBER() OVER (ORDER BY $xxTblSortColNm$ ) AS ROW_NUM
			,	$xxTblCdColNm$  AS COL_CD
			,	$xxTblNmColNm$  AS COL_NM
			FROM
				$xxTblNm$
			WHERE
				GLBL_CMPY_CD  = #glblCmpyCd#
			AND	EZCANCELFLAG = '0'
		) T1
		WHERE 
			T1.ROW_NUM &lt; #rowNum#
		ORDER BY 
			T1.ROW_NUM
	</statement>
	
	<statement id="getAjePtrnIndTpByKey" parameterClass="Map" resultClass="Map">
		SELECT
			EZUPTIME
		,	EZUPTIMEZONE
		,	AJE_INTFC_TP_CD
		,	AJE_PTRN_IND_TP_CD
		,	AJE_PTRN_IND_TP_NM
		,	AJE_PTRN_ACTL_CD
		,	AJE_PTRN_ACTL_NM
		,	AJE_INTFC_TP_NM
		,	AJE_INTFC_COL_TXT
		FROM (
			SELECT
				EZUPTIME			AS	EZUPTIME
			,	EZUPTIMEZONE		AS	EZUPTIMEZONE
			,	AJE_INTFC_TP_CD		AS	AJE_INTFC_TP_CD
			,	AJE_PTRN_IND_TP_CD	AS	AJE_PTRN_IND_TP_CD
		  	,	AJE_PTRN_IND_TP_NM	AS	AJE_PTRN_IND_TP_NM
			,	AJE_PTRN_ACTL_CD	AS	AJE_PTRN_ACTL_CD
			,	AJE_PTRN_ACTL_NM	AS	AJE_PTRN_ACTL_NM
			,	AJE_INTFC_TP_NM		AS	AJE_INTFC_TP_NM
			,	AJE_INTFC_COL_TXT	AS	AJE_INTFC_COL_TXT
			FROM 
				AJE_PTRN_IND_TP
			WHERE 
				EZCANCELFLAG = '0'
			AND	GLBL_CMPY_CD = #glblCmpyCd#
			<isNotNull property="bizMsg.ajeIntfcTpCd_3S">   
			AND	AJE_INTFC_TP_CD = #ajeIntfcTpCd#
			</isNotNull>
			<isNotNull property="bizMsg.ajePtrnIndTpCd_3">   
			AND	AJE_PTRN_IND_TP_CD = #ajePtrnIndTpCd#
			</isNotNull>
			<isNotNull property="bizMsg.ajePtrnActlCd_3">   
			AND	AJE_PTRN_ACTL_CD = #ajePtrnActlCd#
			</isNotNull>
			AND	AJE_PTRN_IND_TP_CD &lt;&gt; #defaultIndTpCd#
			ORDER BY 
				AJE_PTRN_IND_TP_CD
			,	AJE_INTFC_TP_CD
			,	AJE_PTRN_ACTL_CD
		) WHERE ROWNUM &lt; #rowNum#
	</statement>
	
	<statement id="getAjePtrnIndTpByKeyForExclusiveCheck" parameterClass="Map" resultClass="Map">
			SELECT
				EZUPTIME			AS	EZUPTIME
			,	EZUPTIMEZONE		AS	EZUPTIMEZONE
			FROM 
				AJE_PTRN_IND_TP
			WHERE 
				EZCANCELFLAG = '0'
			AND	GLBL_CMPY_CD = #glblCmpyCd#
			AND	AJE_INTFC_TP_CD = #ajeIntfcTpCd#
			AND	AJE_PTRN_IND_TP_CD = #ajePtrnIndTpCd#
			AND	AJE_PTRN_ACTL_CD = #ajePtrnActlCd#
			AND	AJE_PTRN_IND_TP_CD &lt;&gt; #defaultIndTpCd#
			ORDER BY 
				AJE_PTRN_IND_TP_CD
			,	AJE_INTFC_TP_CD
			,	AJE_PTRN_ACTL_CD
	</statement>

<!-- add 2016/03/24 -->
    <statement id="getPtrnToBeDeleted" parameterClass="Map" resultMap="result.getPtrnToBeDeleted">
    
        SELECT GLBL_CMPY_CD
              ,AJE_ID
              ,AJE_PTRN_IND_TP_CD_01
              ,AJE_PTRN_ACTL_CD_01
              ,AJE_PTRN_IND_TP_CD_02
              ,AJE_PTRN_ACTL_CD_02
              ,AJE_PTRN_IND_TP_CD_03
              ,AJE_PTRN_ACTL_CD_03
              ,DR_CR_TP_CD
              ,AJE_LINE_IDX_NUM
          FROM AJE_PTRN AP
              ,(SELECT AJE_PTRN_IND_TP_CD
                      ,AJE_PTRN_ACTL_CD
                  FROM AJE_PTRN_IND_TP
                 WHERE GLBL_CMPY_CD       = #glblCmpyCd#
                   AND EZCANCELFLAG       = '0'
                   AND AJE_PTRN_IND_TP_CD = #ptrnIndTp#
                   AND AJE_INTFC_TP_CD    = #intfcTpCd#
               ) PIT
         WHERE AP.GLBL_CMPY_CD            = #glblCmpyCd#
           AND AP.EZCANCELFLAG            = '0'
           AND AP.AJE_PTRN_IND_TP_CD_01   = #ptrnIndTp#
           AND AP.AJE_PTRN_ACTL_CD_01     = PIT.AJE_PTRN_ACTL_CD(+)
           AND PIT.AJE_PTRN_IND_TP_CD IS NULL
       UNION ALL
         SELECT GLBL_CMPY_CD
              ,AJE_ID
              ,AJE_PTRN_IND_TP_CD_01
              ,AJE_PTRN_ACTL_CD_01
              ,AJE_PTRN_IND_TP_CD_02
              ,AJE_PTRN_ACTL_CD_02
              ,AJE_PTRN_IND_TP_CD_03
              ,AJE_PTRN_ACTL_CD_03
              ,DR_CR_TP_CD
              ,AJE_LINE_IDX_NUM
          FROM AJE_PTRN AP
              ,(SELECT AJE_PTRN_IND_TP_CD
                      ,AJE_PTRN_ACTL_CD
                  FROM AJE_PTRN_IND_TP
                 WHERE GLBL_CMPY_CD       = #glblCmpyCd#
                   AND EZCANCELFLAG       = '0'
                   AND AJE_PTRN_IND_TP_CD = #ptrnIndTp#
                   AND AJE_INTFC_TP_CD    = #intfcTpCd#
               ) PIT
         WHERE AP.GLBL_CMPY_CD            = #glblCmpyCd#
           AND AP.EZCANCELFLAG            = '0'
           AND AP.AJE_PTRN_IND_TP_CD_02   = #ptrnIndTp#
           AND AP.AJE_PTRN_ACTL_CD_02     = PIT.AJE_PTRN_ACTL_CD(+)
           AND PIT.AJE_PTRN_IND_TP_CD IS NULL
       UNION ALL
          SELECT GLBL_CMPY_CD
              ,AJE_ID
              ,AJE_PTRN_IND_TP_CD_01
              ,AJE_PTRN_ACTL_CD_01
              ,AJE_PTRN_IND_TP_CD_02
              ,AJE_PTRN_ACTL_CD_02
              ,AJE_PTRN_IND_TP_CD_03
              ,AJE_PTRN_ACTL_CD_03
              ,DR_CR_TP_CD
              ,AJE_LINE_IDX_NUM
          FROM AJE_PTRN AP
              ,(SELECT AJE_PTRN_IND_TP_CD
                      ,AJE_PTRN_ACTL_CD
                  FROM AJE_PTRN_IND_TP
                 WHERE GLBL_CMPY_CD       = #glblCmpyCd#
                   AND EZCANCELFLAG       = '0'
                   AND AJE_PTRN_IND_TP_CD = #ptrnIndTp#
                   AND AJE_INTFC_TP_CD    = #intfcTpCd#
               ) PIT
         WHERE AP.GLBL_CMPY_CD            = #glblCmpyCd#
           AND AP.EZCANCELFLAG            = '0'
           AND AP.AJE_PTRN_IND_TP_CD_03   = #ptrnIndTp#
           AND AP.AJE_PTRN_ACTL_CD_03     = PIT.AJE_PTRN_ACTL_CD(+)
           AND PIT.AJE_PTRN_IND_TP_CD IS NULL
    </statement>
    
    <resultMap id="result.getPtrnToBeDeleted" class="AJE_PTRNTMsg">
        <result property="glblCmpyCd"                        column="GLBL_CMPY_CD"                              javaType="EZDTStringItem"/>
        <result property="ajeId"                             column="AJE_ID"                                    javaType="EZDTStringItem"/>
        <result property="ajePtrnIndTpCd_01"                  column="AJE_PTRN_IND_TP_CD_01"                     javaType="EZDTStringItem"/>
        <result property="ajePtrnActlCd_01"                   column="AJE_PTRN_ACTL_CD_01"                       javaType="EZDTStringItem"/>
        <result property="ajePtrnIndTpCd_02"                  column="AJE_PTRN_IND_TP_CD_02"                     javaType="EZDTStringItem"/>
        <result property="ajePtrnActlCd_02"                   column="AJE_PTRN_ACTL_CD_02"                       javaType="EZDTStringItem"/>
        <result property="ajePtrnIndTpCd_03"                  column="AJE_PTRN_IND_TP_CD_03"                     javaType="EZDTStringItem"/>
        <result property="ajePtrnActlCd_03"                   column="AJE_PTRN_ACTL_CD_03"                       javaType="EZDTStringItem"/>
        <result property="drCrTpCd"                          column="DR_CR_TP_CD"                               javaType="EZDTStringItem"/>
        <result property="ajeLineIdxNum"                     column="AJE_LINE_IDX_NUM"                          javaType="EZDTStringItem"/>
    </resultMap>
<!-- end -->

</sqlMap>
