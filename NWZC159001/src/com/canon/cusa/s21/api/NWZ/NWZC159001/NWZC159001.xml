<?xml version="1.0" encoding="UTF-8"?>

<sqlMap namespace="NWZC159001">

    <statement id="getDsCpoDtlDsRtrnDtlList" parameterClass="Map" resultClass="Map">
        SELECT
            CD.CR_REBIL_CD
        FROM
            CPO_DTL    CD
        WHERE
            CD.GLBL_CMPY_CD         = #glblCmpyCd#
            AND CD.CPO_ORD_NUM      = #cpoOrdNum#
            AND CD.ORD_LINE_STS_CD != #ordLineStsCancel#
            AND CD.EZCANCELFLAG     = '0'
        UNION ALL
        SELECT
            DCD.CR_REBIL_CD
        FROM
            DS_CPO_RTRN_DTL DCD
        WHERE
            DCD.GLBL_CMPY_CD          = #glblCmpyCd#
            AND DCD.CPO_ORD_NUM       = #cpoOrdNum#
            AND DCD.RTRN_LINE_STS_CD != #rtrnLineStsCancel#
            AND DCD.EZCANCELFLAG      = '0'
    </statement>
<!-- QC#14974 UPDATE 2016/10/06
    <statement id="getPrftApvlLineData" parameterClass="Map" resultClass="String">
-->
    <statement id="getPrftApvlLineData" parameterClass="Map" resultClass="Map">
<!-- QC#14974 UPDATE 2016/10/06 E N D -->
        SELECT
<!-- QC#14974 UPDATE 2016/10/06
                  V.GLBL_CMPY_CD
-->
                  V.*
<!-- QC#14974 UPDATE 2016/10/06 E N D -->
            FROM
                (
                 SELECT
                      C.GLBL_CMPY_CD
                    , C.ORD_HDR_STS_CD
                    , LC.DS_ORD_LINE_DRCTN_CD
                    , C.DS_ORD_CATG_CD
                    , C.DS_ORD_TP_CD
                    , C.DS_ORD_RSN_CD
                    , C.PRC_BASE_DT
                    , C.PRC_CALC_DT
                    , C.NEGO_DEAL_AMT
                    , C.CSMP_CONTR_NUM
                    , C.DLR_REF_NUM
                    , CD.CPO_DTL_LINE_NUM           TRX_LINE_NUM
                    , CD.CPO_DTL_LINE_SUB_NUM       TRX_LINE_SUB_NUM
                    , CD.DS_ORD_POSN_NUM
                    , CD.DS_CPO_LINE_NUM
                    , CD.DS_CPO_LINE_SUB_NUM
                    , CD.MDSE_CD
                    , CD.RTL_WH_CD
                    , CD.RTL_SWH_CD
                    , CD.DS_ORD_LINE_CATG_CD
                    , CD.ORD_QTY
                    , CD.CUST_UOM_CD
                    , CD.REF_CPO_DTL_LINE_NUM
                    , CD.REF_CPO_DTL_LINE_SUB_NUM
                    , CD.FL_PRC_LIST_CD
                    , CD.FUNC_PRC_LIST_PRC_AMT
                    , CD.ENT_FUNC_NET_UNIT_PRC_AMT  FUNC_NET_UNIT_PRC_AMT
                    , CD.CPO_DTL_FUNC_NET_AMT       FUNC_NET_AMT
                    , CD.FUNC_MAN_FL_ADJ_AMT
                    , CD.FUNC_SVC_COST_TRNSF_AMT
                    , CD.FUNC_MAN_REP_REV_ADJ_AMT
                    , CD.FUNC_SVC_REV_TRNSF_AMT
                    , DCC.CONFIG_CATG_CD
                    , #ordPrftTrxCatgOutBound#      ORD_PRFT_TRX_CATG_CD
                    , CD.CSMP_PRC_LIST_CD
                    , CD.CPO_DTL_FUNC_SLS_AMT
                    , CD.ORD_CUST_UOM_QTY
                    , CD.CSMP_CONTR_NUM            DTL_CSMP_CONTR_NUM
                    , CD.DLR_REF_NUM               DTL_DLR_REF_NUM
                    , CD.PRC_CATG_CD
                    , CD.ORD_LINE_STS_CD            LINE_STS_CD
                    , C.BILL_TO_CUST_CD
                    , C.SELL_TO_CUST_CD
                    , CD.SHIP_TO_CUST_CD
                    , DCC.BILL_TO_CUST_ACCT_CD
                    , DCC.BILL_TO_CUST_LOC_CD
                    , DCC.SHIP_TO_CUST_ACCT_CD
                    , DCC.SHIP_TO_CUST_LOC_CD
                    , M.THIS_MTH_TOT_STD_COST_AMT
                 FROM
                    CPO                 C
                    , DS_CPO_CONFIG     DCC
                    , CPO_DTL           CD
                    , DS_ORD_LINE_CATG  LC
                    , MDSE              M
                 WHERE
                    C.GLBL_CMPY_CD              = #glblCmpyCd#
                    AND C.CPO_ORD_NUM           = #trxHdrNum#
                    AND C.EZCANCELFLAG          = '0'
                    AND DCC.GLBL_CMPY_CD        = CD.GLBL_CMPY_CD
                    AND DCC.CPO_ORD_NUM         = CD.CPO_ORD_NUM
                    AND DCC.DS_ORD_POSN_NUM     = CD.DS_ORD_POSN_NUM
                    AND DCC.CONFIG_CATG_CD      = #outBound#
                    AND DCC.EZCANCELFLAG        = '0'
                    AND C.GLBL_CMPY_CD          = CD.GLBL_CMPY_CD
                    AND C.CPO_ORD_NUM           = CD.CPO_ORD_NUM
                    AND CD.CPO_DTL_CANC_FLG     = 'N'
                    AND CD.SET_MDSE_CD          IS NULL
                    AND CD.EZCANCELFLAG         = '0'
                    AND CD.GLBL_CMPY_CD         = LC.GLBL_CMPY_CD
                    AND CD.DS_ORD_LINE_CATG_CD  = LC.DS_ORD_LINE_CATG_CD
                    AND LC.EZCANCELFLAG         = '0'
                    AND CD.GLBL_CMPY_CD         = M.GLBL_CMPY_CD
                    AND CD.MDSE_CD              = M.MDSE_CD
                    AND M.EZCANCELFLAG          = '0'
                 UNION ALL
                 SELECT
                      C.GLBL_CMPY_CD
                    , C.ORD_HDR_STS_CD
                    , LC.DS_ORD_LINE_DRCTN_CD
                    , C.DS_ORD_CATG_CD
                    , C.DS_ORD_TP_CD
                    , C.DS_ORD_RSN_CD
                    , C.PRC_BASE_DT
                    , C.PRC_CALC_DT
                    , C.NEGO_DEAL_AMT
                    , C.CSMP_CONTR_NUM
                    , C.DLR_REF_NUM
                    , CD.CPO_DTL_LINE_NUM           TRX_LINE_NUM
                    , CD.CPO_DTL_LINE_SUB_NUM       TRX_LINE_SUB_NUM
                    , CD.DS_ORD_POSN_NUM
                    , CD.DS_CPO_LINE_NUM
                    , CD.DS_CPO_LINE_SUB_NUM
                    , CD.MDSE_CD
                    , CD.RTL_WH_CD
                    , CD.RTL_SWH_CD
                    , CD.DS_ORD_LINE_CATG_CD
                    , CD.ORD_QTY
                    , CD.CUST_UOM_CD
                    , CD.REF_CPO_DTL_LINE_NUM
                    , CD.REF_CPO_DTL_LINE_SUB_NUM
                    , CD.FL_PRC_LIST_CD
                    , CD.FUNC_PRC_LIST_PRC_AMT
                    , CD.ENT_FUNC_NET_UNIT_PRC_AMT  FUNC_NET_UNIT_PRC_AMT
                    , CD.CPO_DTL_FUNC_NET_AMT       FUNC_NET_AMT
                    , CD.FUNC_MAN_FL_ADJ_AMT
                    , CD.FUNC_SVC_COST_TRNSF_AMT
                    , CD.FUNC_MAN_REP_REV_ADJ_AMT
                    , CD.FUNC_SVC_REV_TRNSF_AMT
                    , DCC.CONFIG_CATG_CD
                    , #ordPrftTrxCatgOutBound#      ORD_PRFT_TRX_CATG_CD
                    , CD.CSMP_PRC_LIST_CD
                    , CD.CPO_DTL_FUNC_SLS_AMT
                    , CD.ORD_CUST_UOM_QTY
                    , CD.CSMP_CONTR_NUM            DTL_CSMP_CONTR_NUM
                    , CD.DLR_REF_NUM               DTL_DLR_REF_NUM
                    , CD.PRC_CATG_CD
                    , CD.ORD_LINE_STS_CD            LINE_STS_CD
                    , C.BILL_TO_CUST_CD
                    , C.SELL_TO_CUST_CD
                    , CD.SHIP_TO_CUST_CD
                    , DCC.BILL_TO_CUST_ACCT_CD
                    , DCC.BILL_TO_CUST_LOC_CD
                    , DCC.SHIP_TO_CUST_ACCT_CD
                    , DCC.SHIP_TO_CUST_LOC_CD
                    , M.THIS_MTH_TOT_STD_COST_AMT
                 FROM
                    CPO                 C
                    , DS_CPO_CONFIG     DCC
                    , CPO_DTL           CD
                    , DS_ORD_LINE_CATG  LC
                    , ORD_TAKE_MDSE     OTM
                    , MDSE              M
                 WHERE
                    C.GLBL_CMPY_CD              = #glblCmpyCd#
                    AND C.CPO_ORD_NUM           = #trxHdrNum#
                    AND C.EZCANCELFLAG          = '0'
                    AND DCC.GLBL_CMPY_CD        = CD.GLBL_CMPY_CD
                    AND DCC.CPO_ORD_NUM         = CD.CPO_ORD_NUM
                    AND DCC.DS_ORD_POSN_NUM     = CD.DS_ORD_POSN_NUM
                    AND DCC.CONFIG_CATG_CD      = #outBound#
                    AND DCC.EZCANCELFLAG        = '0'
                    AND C.GLBL_CMPY_CD          = CD.GLBL_CMPY_CD
                    AND C.CPO_ORD_NUM           = CD.CPO_ORD_NUM
                    AND CD.CPO_DTL_CANC_FLG     = 'N'
                    AND CD.SET_MDSE_CD          IS NULL
                    AND CD.EZCANCELFLAG         = '0'
                    AND CD.GLBL_CMPY_CD         = LC.GLBL_CMPY_CD
                    AND CD.DS_ORD_LINE_CATG_CD  = LC.DS_ORD_LINE_CATG_CD
                    AND LC.EZCANCELFLAG         = '0'
                    AND CD.GLBL_CMPY_CD         = OTM.GLBL_CMPY_CD
                    AND CD.MDSE_CD              = OTM.ORD_TAKE_MDSE_CD
                    AND OTM.EZCANCELFLAG        = '0'
                    AND OTM.GLBL_CMPY_CD        = M.GLBL_CMPY_CD
                    AND OTM.MDSE_CD             = M.MDSE_CD
                    AND M.EZCANCELFLAG          = '0'
                 UNION ALL
                 SELECT
<!-- QC#14974 UPDATE 2016/10/06 START
                      C.GLBL_CMPY_CD
                      , #ordPrftTrxCatgInBound#           ORD_PRFT_TRX_CATG_CD
                      , DC.DS_ORD_TP_CD
                      , DCRD.DS_ORD_LINE_CATG_CD
                      , DCRD.RTL_WH_CD
                      , DCRD.RTL_SWH_CD
-->
                      C.GLBL_CMPY_CD
                    , C.ORD_HDR_STS_CD
                    , LC.DS_ORD_LINE_DRCTN_CD
                    , C.DS_ORD_CATG_CD
                    , C.DS_ORD_TP_CD
                    , C.DS_ORD_RSN_CD
                    , C.PRC_BASE_DT
                    , C.PRC_CALC_DT
                    , C.NEGO_DEAL_AMT
                    , C.CSMP_CONTR_NUM
                    , C.DLR_REF_NUM
                    , DCRD.DS_CPO_RTRN_LINE_NUM         TRX_LINE_NUM
                    , DCRD.DS_CPO_RTRN_LINE_SUB_NUM     TRX_LINE_SUB_NUM
                    , DCRD.DS_ORD_POSN_NUM
                    , DCRD.DS_CPO_LINE_NUM
                    , DCRD.DS_CPO_LINE_SUB_NUM
                    , DCRD.MDSE_CD
                    , DCRD.RTL_WH_CD
                    , DCRD.RTL_SWH_CD
                    , DCRD.DS_ORD_LINE_CATG_CD
                    , DCRD.ORD_QTY
                    , DCRD.CUST_UOM_CD
                    , DCRD.REF_CPO_DTL_LINE_NUM
                    , DCRD.REF_CPO_DTL_LINE_SUB_NUM
                    , DCRD.FL_PRC_LIST_CD
                    , DCRD.FUNC_PRC_LIST_PRC_AMT
                    , DCRD.ENT_FUNC_NET_UNIT_PRC_AMT    FUNC_NET_UNIT_PRC_AMT
                    , DCRD.CPO_DTL_FUNC_NET_AMT         FUNC_NET_AMT
                    , DCRD.FUNC_MAN_FL_ADJ_AMT
                    , DCRD.FUNC_SVC_COST_TRNSF_AMT
                    , DCRD.FUNC_MAN_REP_REV_ADJ_AMT
                    , DCRD.FUNC_SVC_REV_TRNSF_AMT
                    , DCC.CONFIG_CATG_CD
                    , #ordPrftTrxCatgInBound#           ORD_PRFT_TRX_CATG_CD
                    , DCRD.CSMP_PRC_LIST_CD
                    , DCRD.CPO_DTL_FUNC_SLS_AMT
                    , DCRD.ORD_CUST_UOM_QTY
                    , DCRD.CSMP_CONTR_NUM               DTL_CSMP_CONTR_NUM
                    , DCRD.DLR_REF_NUM                  DTL_DLR_REF_NUM
                    , DCRD.PRC_CATG_CD
                    , DCRD.RTRN_LINE_STS_CD             LINE_STS_CD
                    , C.BILL_TO_CUST_CD
                    , C.SELL_TO_CUST_CD
                    , DCRD.SHIP_TO_CUST_CD
                    , DCC.BILL_TO_CUST_ACCT_CD
                    , DCC.BILL_TO_CUST_LOC_CD
                    , DCC.SHIP_TO_CUST_ACCT_CD
                    , DCC.SHIP_TO_CUST_LOC_CD
                    , M.THIS_MTH_TOT_STD_COST_AMT
<!-- QC#14974 UPDATE 2016/10/06 E N D -->
                 FROM
                    CPO C
                    , DS_CPO_CONFIG    DCC
                    , DS_CPO_RTRN_DTL  DCRD
                    , DS_ORD_LINE_CATG LC
<!-- QC#16155 Mod Start -->
                    , MDSE             M
<!--                , (SELECT
                           M.GLBL_CMPY_CD
                          ,M.MDSE_CD
                          ,M.THIS_MTH_TOT_STD_COST_AMT
                          ,M.EZCANCELFLAG
                       FROM
                           MDSE M
                       WHERE
                           M.GLBL_CMPY_CD     = #glblCmpyCd#
                           AND M.EZCANCELFLAG = '0'
                       UNION ALL
                       SELECT
                           M.GLBL_CMPY_CD
                          ,OTM.ORD_TAKE_MDSE_CD AS MDSE_CD
                          ,M.THIS_MTH_TOT_STD_COST_AMT
                          ,M.EZCANCELFLAG
                       FROM
                           MDSE M
                          ,ORD_TAKE_MDSE OTM
                       WHERE
                           M.GLBL_CMPY_CD       = #glblCmpyCd#
                           AND M.EZCANCELFLAG   = '0'
                           AND M.GLBL_CMPY_CD   = OTM.GLBL_CMPY_CD
                           AND M.MDSE_CD        = OTM.MDSE_CD
                           AND OTM.EZCANCELFLAG = '0'
                      ) M -->
<!-- QC#16155 Mod Start -->
                 WHERE
                    C.GLBL_CMPY_CD               = #glblCmpyCd#
                    AND C.CPO_ORD_NUM            = #trxHdrNum#
                    AND C.EZCANCELFLAG           = '0'
                    AND DCC.GLBL_CMPY_CD         = DCRD.GLBL_CMPY_CD
                    AND DCC.CPO_ORD_NUM          = DCRD.CPO_ORD_NUM
                    AND DCC.DS_ORD_POSN_NUM      = DCRD.DS_ORD_POSN_NUM
                    AND DCC.CONFIG_CATG_CD       = #inBound#
                    AND DCC.EZCANCELFLAG         = '0'
                    AND C.GLBL_CMPY_CD           = DCRD.GLBL_CMPY_CD
                    AND C.CPO_ORD_NUM            = DCRD.CPO_ORD_NUM
                    AND DCRD.CPO_DTL_CANC_FLG    = 'N'
                    AND DCRD.SET_MDSE_CD         IS NULL
                    AND DCRD.EZCANCELFLAG        = '0'
                    AND DCRD.GLBL_CMPY_CD        = LC.GLBL_CMPY_CD
                    AND DCRD.DS_ORD_LINE_CATG_CD = LC.DS_ORD_LINE_CATG_CD
                    AND LC.EZCANCELFLAG          = '0'
                    AND DCRD.GLBL_CMPY_CD        = M.GLBL_CMPY_CD
                    AND DCRD.MDSE_CD             = M.MDSE_CD
                    AND M.EZCANCELFLAG           = '0'
                 ) V
                , ORD_PRFT_TRX_CATG TC 
            WHERE
                TC.GLBL_CMPY_CD             = #glblCmpyCd#
                AND TC.ORD_PRFT_TRX_CATG_CD = V.ORD_PRFT_TRX_CATG_CD
                AND TC.EZCANCELFLAG         = '0'
                AND NOT EXISTS(
                               SELECT '1'
                               FROM
                                     DS_ORD_TP_PROC_DFN      PD
                                   , ORD_PRFT_LINE_CATG_RULE LCR
                               WHERE 
                                   PD.GLBL_CMPY_CD  = V.GLBL_CMPY_CD
                               AND PD.DS_ORD_TP_CD  = V.DS_ORD_TP_CD
                               AND PD.EFF_FROM_DT   &lt;= #slsDt#
                               AND ( PD.EFF_THRU_DT &gt;= #slsDt# OR PD.EFF_THRU_DT IS NULL )
                               AND PD.ACTV_FLG      = 'Y'
                               AND PD.EZCANCELFLAG  = '0'
                               AND PD.GLBL_CMPY_CD  = LCR.GLBL_CMPY_CD
                               AND LCR.ORD_PROC_NODE_PRFL_CD = PD.PRFT_APVL_NODE_PRFL_CD
                               AND LCR.DS_ORD_LINE_CATG_CD   = V.DS_ORD_LINE_CATG_CD
                               AND LCR.EFF_FROM_DT   &lt;= #slsDt#
                               AND ( LCR.EFF_THRU_DT &gt;= #slsDt# OR LCR.EFF_THRU_DT IS NULL )
                               AND LCR.ACTV_FLG     = 'Y'
                               AND LCR.EZCANCELFLAG = '0'
                    )
                AND NOT EXISTS(
                               SELECT '1'
                               FROM
                                     DS_ORD_TP_PROC_DFN      PD
                                   , ORD_PRFT_WH_RULE        WHR
                               WHERE 
                                   PD.GLBL_CMPY_CD  = V.GLBL_CMPY_CD
                               AND PD.DS_ORD_TP_CD  = V.DS_ORD_TP_CD
                               AND PD.EFF_FROM_DT   &lt;= #slsDt#
                               AND ( PD.EFF_THRU_DT &gt;= #slsDt# OR PD.EFF_THRU_DT IS NULL )
                               AND PD.ACTV_FLG      = 'Y'
                               AND PD.EZCANCELFLAG  = '0'
                               AND PD.GLBL_CMPY_CD  = WHR.GLBL_CMPY_CD
                               AND WHR.ORD_PROC_NODE_PRFL_CD = PD.PRFT_APVL_NODE_PRFL_CD
                               AND WHR.RTL_WH_CD    = V.RTL_WH_CD
                               AND NVL (WHR.RTL_SWH_CD, '1') = NVL (V.RTL_SWH_CD, '1')
                               AND WHR.EFF_FROM_DT   &lt;= #slsDt#
                               AND ( WHR.EFF_THRU_DT &gt;= #slsDt# OR WHR.EFF_THRU_DT IS NULL )
                               AND WHR.ACTV_FLG     = 'Y'
                               AND WHR.EZCANCELFLAG = '0'
                    )
    </statement>

<!-- QC#14974 ADD 2016/10/06 START -->
    <statement id="getPrftApvlHdrData" parameterClass="Map" resultClass="Map">
        SELECT
             C.CPO_ORD_NUM
            ,STC.DS_ACCT_NM
            ,DOC.DS_ORD_CATG_NM || '/' || DOT.DS_ORD_TP_NM
                                            AS CATG_RSN
            ,T.COA_EXTN_CD || '. ' || CE.COA_EXTN_NM || '/' || T.COA_BR_CD || ', ' || CB.COA_BR_NM
                                            AS BUS_UNIT_BR
            ,C.NEGO_DEAL_AMT
            ,C.DS_ORD_CATG_CD
            ,C.DS_ORD_TP_CD
            ,T.COA_EXTN_CD
            ,T.COA_BR_CD
            ,C.DS_ORD_RSN_CD
            ,C.PRC_BASE_DT
            ,C.PRC_CALC_DT
            ,C.CSMP_CONTR_NUM
            ,C.DLR_REF_NUM
            ,C.SELL_TO_CUST_CD
            ,C.BILL_TO_CUST_CD
            ,OTP.LINE_BIZ_TP_CD
            ,DOC.DS_ORD_CATG_NM
            ,DOT.DS_ORD_TP_NM
        FROM
             CPO                 C
            ,SELL_TO_CUST        STC
            ,DS_ORD_CATG         DOC
            ,DS_ORD_TP           DOT
            ,DS_ORD_TP_PROC_DFN  OTP
            ,TOC                 T
            ,COA_EXTN            CE
            ,COA_BR              CB
        WHERE
                C.GLBL_CMPY_CD         = #glblCmpyCd#
            AND C.CPO_ORD_NUM          = #cpoOrdNum#
            AND C.EZCANCELFLAG         = '0'
            AND C.GLBL_CMPY_CD         = STC.GLBL_CMPY_CD (+)
            AND C.SELL_TO_CUST_CD      = STC.SELL_TO_CUST_CD (+)
            AND STC.EZCANCELFLAG(+)    = '0'
            AND C.GLBL_CMPY_CD         = DOC.GLBL_CMPY_CD (+)
            AND C.DS_ORD_CATG_CD       = DOC.DS_ORD_CATG_CD (+)
            AND DOC.EZCANCELFLAG(+)    = '0'
            AND C.GLBL_CMPY_CD         = DOT.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD         = DOT.DS_ORD_TP_CD (+)
            AND DOT.EZCANCELFLAG(+)    = '0'
            AND C.GLBL_CMPY_CD         = OTP.GLBL_CMPY_CD (+)
            AND C.DS_ORD_TP_CD         = OTP.DS_ORD_TP_CD (+)
            AND OTP.EZCANCELFLAG(+)    = '0'
            AND C.GLBL_CMPY_CD         = T.GLBL_CMPY_CD (+)
            AND C.SLS_REP_TOC_CD       = T.TOC_CD (+)
            AND T.EZCANCELFLAG(+)      = '0'
            AND T.GLBL_CMPY_CD         = CE.GLBL_CMPY_CD (+)
            AND T.COA_EXTN_CD          = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG(+)     = '0'
            AND T.GLBL_CMPY_CD         = CB.GLBL_CMPY_CD (+)
            AND T.COA_BR_CD            = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG(+)     = '0'
    </statement>
<!-- QC#14974 ADD 2016/10/06 END -->

<!-- QC#14974 ADD 2016/10/13 START -->
    <statement id="getOrdProcNodePrfl" parameterClass="Map" resultClass="Map">
        SELECT
            OPPA.ORD_PROC_NODE_PRFL_NM AS ORD_PROC_NODE_PRFL_NM_PA
        FROM
             CPO                 C
            ,DS_ORD_TP_PROC_DFN  OTP
            ,ORD_PROC_NODE_PRFL  OPPA
        WHERE

                C.GLBL_CMPY_CD           = #glblCmpyCd#
            AND C.CPO_ORD_NUM            = #cpoOrdNum#
            AND C.EZCANCELFLAG           = '0'

            AND C.GLBL_CMPY_CD           = OTP.GLBL_CMPY_CD
            AND C.DS_ORD_TP_CD           = OTP.DS_ORD_TP_CD
            AND OTP.EZCANCELFLAG         = '0'

            AND OTP.GLBL_CMPY_CD          = OPPA.GLBL_CMPY_CD
            AND OTP.PRFT_APVL_NODE_PRFL_CD = OPPA.ORD_PROC_NODE_PRFL_CD
            AND OPPA.EZCANCELFLAG      = '0'
            
            AND ROWNUM = 1
    </statement>

<!-- 2017/04/13 S21_NA#18207 DEL START -->
<!--
    <statement id="getOrdPrft" parameterClass="Map" resultClass="Map">
        SELECT
            OP.ALT_GRS_PRFT_PCT
           ,OP.GRS_PRFT_PCT
           ,OP.TOT_FUNC_FINAL_FL_AMT
           ,OP.TOT_FUNC_REP_REV_AMT
        FROM
            ORD_PRFT OP
        WHERE
            OP.GLBL_CMPY_CD = #glblCmpyCd#
            AND OP.TRX_HDR_NUM  = #trxHdrNum#
            AND OP.EZCANCELFLAG = '0'
            AND NOT EXISTS (
                            SELECT
                                1
                            FROM
                                ORD_PRFT OP2
                            WHERE
                                OP.GLBL_CMPY_CD          = OP2.GLBL_CMPY_CD
                                AND OP.TRX_HDR_NUM       = OP2.TRX_HDR_NUM
                                AND OP.ORD_PRFT_VRSN_NUM &lt; OP2.ORD_PRFT_VRSN_NUM
                                AND OP2.EZCANCELFLAG     = '0'
                           )
    </statement>
-->
<!-- 2017/04/13 S21_NA#18207 DEL END -->
<!-- QC#14974 ADD 2016/10/13 END -->

</sqlMap>
