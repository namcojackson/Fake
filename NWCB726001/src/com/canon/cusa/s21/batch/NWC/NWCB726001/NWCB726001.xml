<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWCB726001">
    <statement id="getInvoiceData" parameterClass="Map" resultClass="Map">
        SELECT
             CC.RTL_DLR_CD              AS RTL_DLR_CD
            ,IC.INV_NUM                 AS INV_NUM_CUSA
            ,IEC.INV_NUM                AS INV_NUM_END_CUSTOMER
            ,IC.CUST_ISS_PO_NUM         AS CUST_ISS_PO_NUM
            ,IL.CSMP_CONTR_NUM          AS CSMP_CONTR_NUM
            ,IEC.SELL_TO_LOC_NM         AS SELL_TO_LOC_NM
            ,IL.MDSE_CD                 AS MDSE_CD
            ,IB.SHIP_DT                 AS SHIP_DT
            ,IC.INV_TOT_DEAL_NET_AMT    AS INV_TOT_DEAL_NET_AMT
            ,IB.SHIP_TO_FIRST_LINE_ADDR AS SHIP_TO_FIRST_LINE_ADDR
            ,IB.SHIP_TO_SCD_LINE_ADDR   AS SHIP_TO_SCD_LINE_ADDR
            ,IB.SHIP_TO_CTY_ADDR        AS SHIP_TO_CTY_ADDR
            ,IB.SHIP_TO_ST_CD           AS SHIP_TO_ST_CD
            ,IB.SHIP_TO_POST_CD         AS SHIP_TO_POST_CD
            ,IL.INV_BOL_LINE_NUM        AS INV_BOL_LINE_NUM
            ,IL.INV_LINE_NUM            AS INV_LINE_NUM
            ,IL.INV_LINE_SUB_NUM        AS INV_LINE_SUB_NUM
            ,IL.INV_LINE_SUB_TRX_NUM    AS INV_LINE_SUB_TRX_NUM
            ,IL.INV_LINE_DEAL_NET_AMT   AS INV_LINE_DEAL_NET_AMT
        FROM
             INV IC
            ,INV IEC
            ,INV_BOL IB
            ,INV_LINE IL
            ,CSMP_CONTR CC
        WHERE
            IC.GLBL_CMPY_CD          = #glblCmpyCd#
        AND IC.EZCANCELFLAG          = '0'
        AND IC.CSMP_INV_CLM_STS_CD   = #csmpInvClmStsCd#
        AND IC.GLBL_CMPY_CD          = IEC.GLBL_CMPY_CD
        AND IEC.EZCANCELFLAG         = '0'
        AND IC.CSMP_ORIG_INV_NUM     = IEC.INV_NUM(+)
        AND IB.GLBL_CMPY_CD          = IC.GLBL_CMPY_CD
        AND IB.EZCANCELFLAG          = '0'
        AND IB.INV_NUM               = IC.INV_NUM
        AND IL.GLBL_CMPY_CD          = IB.GLBL_CMPY_CD
        AND IL.EZCANCELFLAG          = '0'
        AND IL.INV_NUM               = IB.INV_NUM
        AND IL.INV_BOL_LINE_NUM      = IB.INV_BOL_LINE_NUM
        AND CC.GLBL_CMPY_CD          = IC.GLBL_CMPY_CD
        AND CC.EZCANCELFLAG          = '0'
        AND CC.DS_ACCT_NUM           = IEC.SELL_TO_CUST_CD
        AND CC.CSMP_NUM              = IL.CSMP_CONTR_NUM
        ORDER BY
             IC.INV_NUM
            ,IL.INV_BOL_LINE_NUM
            ,IL.INV_LINE_NUM
            ,IL.INV_LINE_SUB_NUM
            ,IL.INV_LINE_SUB_TRX_NUM
    </statement>

    <statement id="getSerNum" parameterClass="Map" resultClass="String">
        SELECT
            SUBSTR(DS.SER_NUM, 0, 20)
        FROM
            (
             SELECT 
                 DILSN.SER_NUM
             FROM
                 DS_INV_LINE_SER_NUM DILSN
             WHERE
                 DILSN.GLBL_CMPY_CD            = #glblCmpyCd#
             AND DILSN.EZCANCELFLAG            = '0'
             AND DILSN.INV_NUM                 = #invNum#
             AND DILSN.INV_BOL_LINE_NUM        = #invBolLineNum#
             AND DILSN.INV_LINE_NUM            = #invLineNum#
             AND DILSN.INV_LINE_SUB_NUM        = #invLineSubNum#
             AND DILSN.INV_TRX_LINE_SUB_NUM    = #invTrxLineSubNum#
             ORDER BY
                 DILSN.INV_NUM
                ,DILSN.INV_BOL_LINE_NUM
                ,DILSN.INV_LINE_NUM
                ,DILSN.INV_LINE_SUB_NUM
	            ,DILSN.INV_TRX_LINE_SUB_NUM
            ) DS
        WHERE
            ROWNUM &lt;= #rowNum#
    </statement>
</sqlMap>
