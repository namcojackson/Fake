<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWXC010001">

    <statement id="getTotalShellAmount" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SUM(DCD_SUM.TOT_BASE_PRC_FUNC_AMT) AS SELL_AMT
        FROM
            (
                SELECT
                    DCD.CPO_ORD_NUM
                    ,DCD.DS_CONTR_PK
                    ,DCD.TOT_BASE_PRC_FUNC_AMT
                    ,ROW_NUMBER() OVER(PARTITION BY DCD.CPO_ORD_NUM, DCD.DS_CONTR_PK ORDER BY DCD.CPO_ORD_NUM, DCD.DS_CONTR_PK) ROW_NUM
                FROM
                    DS_CONTR_DTL DCD
                WHERE
                    DCD.GLBL_CMPY_CD = #glblCmpyCd#
                AND DCD.EZCANCELFLAG = '0'
                AND DCD.CPO_ORD_NUM  = #trxHdrNum#
                AND DCD.BILL_WITH_EQUIP_FLG = #billWithEquipFlg#
            ) DCD_SUM
        WHERE
            ROW_NUM = 1
    </statement>
</sqlMap>
    