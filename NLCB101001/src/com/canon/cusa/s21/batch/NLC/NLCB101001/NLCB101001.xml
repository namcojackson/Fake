<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NLCB101001">
    <statement id="getDailyData" parameterClass="Map">
        SELECT
             A.GLBL_CMPY_CD
            ,A.CINC_GLBL_WH_CD
            ,A.INTFC_INVTY_DT
            ,A.INTFC_PRT_MDSE_CD
            ,A.PRT_SIZE_TXT
            ,A.INTFC_IN_TRNST_FLG
            ,A.PRT_INVTY_CATG_CD
            ,A.INTFC_QTY_SGN_TXT
            ,A.INTFC_INVTY_STK_QTY
            ,A.PRT_CHRG_IND
            ,A.INTFC_CRAT_DT
            ,A.INTFC_UPD_IND
        FROM 
             PRT_INVTY_WRK A
        WHERE
                A.GLBL_CMPY_CD       = #glblCmpyCd#
            AND A.EZCANCELFLAG       = '0'
            AND A.INTFC_CRAT_DT      = #intfcCratDt#
            <isNotNull property="preIntfcCratDt"> 
            AND NOT EXISTS (SELECT *
                 FROM
                     PRT_INVTY_WRK B
                 WHERE 
                         A.GLBL_CMPY_CD        = B.GLBL_CMPY_CD
                     AND B.EZCANCELFLAG        = '0'
                     AND B.INTFC_CRAT_DT       = #preIntfcCratDt#
                     AND A.CINC_GLBL_WH_CD     = B.CINC_GLBL_WH_CD
                     AND A.INTFC_PRT_MDSE_CD   = B.INTFC_PRT_MDSE_CD
                     AND A.PRT_SIZE_TXT        = B.PRT_SIZE_TXT
                     AND A.INTFC_IN_TRNST_FLG  = B.INTFC_IN_TRNST_FLG
                     AND A.PRT_INVTY_CATG_CD   = B.PRT_INVTY_CATG_CD
                     AND A.PRT_CHRG_IND        = B.PRT_CHRG_IND
                     AND A.INTFC_QTY_SGN_TXT   = B.INTFC_QTY_SGN_TXT
                     AND A.INTFC_INVTY_STK_QTY = B.INTFC_INVTY_STK_QTY
                )
           </isNotNull>
        ORDER BY
             A.INTFC_PRT_MDSE_CD
            ,A.PRT_SIZE_TXT
            ,A.INTFC_IN_TRNST_FLG DESC
    </statement>
    <statement id="getMonthlyData" parameterClass="Map">
        SELECT
             A.GLBL_CMPY_CD
            ,A.CINC_GLBL_WH_CD
            ,A.INTFC_INVTY_DT
            ,A.INTFC_PRT_MDSE_CD
            ,A.PRT_SIZE_TXT
            ,A.INTFC_IN_TRNST_FLG
            ,A.PRT_INVTY_CATG_CD
            ,A.INTFC_QTY_SGN_TXT
            ,A.INTFC_INVTY_STK_QTY
            ,A.PRT_CHRG_IND
            ,A.INTFC_CRAT_DT
            ,A.INTFC_UPD_IND
        FROM 
             PRT_INVTY_WRK A
        WHERE
                A.GLBL_CMPY_CD       = #glblCmpyCd#
            AND A.EZCANCELFLAG       = '0'
            AND A.INTFC_CRAT_DT      = #intfcCratDt#
        ORDER BY
             A.INTFC_PRT_MDSE_CD
            ,A.PRT_SIZE_TXT
            ,A.INTFC_IN_TRNST_FLG DESC
    </statement>
    <statement id="getPreIntfcCratDt" parameterClass="Map" resultClass="String">
        SELECT
             MAX(A.INTFC_CRAT_DT)
        FROM 
             PRT_INVTY_WRK A
        WHERE
                A.GLBL_CMPY_CD       =    #glblCmpyCd#
            AND A.EZCANCELFLAG       =    '0'
            AND A.INTFC_CRAT_DT      &lt; #intfcCratDt#
    </statement>
</sqlMap>
