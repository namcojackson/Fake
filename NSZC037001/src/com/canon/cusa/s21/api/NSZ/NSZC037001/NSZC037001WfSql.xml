<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NSZC037001">

    <statement id="WF_CR_CHK_SQL" parameterClass="Map" resultClass="Map">
        SELECT
             A.COND_STR_10
            ,A.COND_STR_9
            ,A.DEC_COND
        FROM
            ( 
                SELECT
                     ACRAL.AR_CR_APVL_USR_ID AS COND_STR_10
                    ,'Next'                  AS DEC_COND
                    ,'0'                     AS COND_STR_9
                    ,0                       AS SORT_KEY 
                FROM
                     BILL_TO_CUST BTC 
                    ,CLT_PTFO CP 
                    ,AR_CR_RF_APVL_LIMIT ACRAL 
                WHERE
                        BTC.GLBL_CMPY_CD            = #glblCmpyCd#
                    AND BTC.BILL_TO_CUST_CD         = #condStr1#
                    AND BTC.EZCANCELFLAG            = '0'
                    AND CP.GLBL_CMPY_CD             = BTC.GLBL_CMPY_CD
                    AND CP.CLT_PTFO_PK              = BTC.CLT_PTFO_PK
                    AND CP.EZCANCELFLAG             = '0'
                    <!-- START 2017/06/28 K.Kojima [QC#19141, MOD] -->
                    <!-- AND ACRAL.GLBL_CMPY_CD      (+) = CP.GLBL_CMPY_CD -->
                    <!-- AND ACRAL.AR_CR_APVL_USR_ID (+) = CP.CLT_CR_ANLST_SVC_PSN_CD -->
                    <!-- AND ACRAL.EZCANCELFLAG      (+) = '0' -->
                    AND ACRAL.GLBL_CMPY_CD          = CP.GLBL_CMPY_CD
                    AND ACRAL.AR_CR_APVL_USR_ID     = CP.CLT_CR_ANLST_SVC_PSN_CD
                    AND ACRAL.EZCANCELFLAG          = '0'
                    <!-- END 2017/06/28 K.Kojima [QC#19141, MOD] -->
                UNION ALL 
                SELECT
                     ACRAL.AR_CR_APVL_USR_ID AS COND_STR_10
                    ,'Next'                  AS DEC_COND
                    ,'0'                     AS COND_STR_9
                    ,1                       AS SORT_KEY 
                FROM
                     SELL_TO_CUST STC 
                    ,CLT_PTFO CP 
                    ,AR_CR_RF_APVL_LIMIT ACRAL 
                WHERE
                        STC.GLBL_CMPY_CD            = #glblCmpyCd#
                    AND STC.SELL_TO_CUST_CD         = #condStr2#
                    AND STC.EZCANCELFLAG            = '0'
                    AND CP.GLBL_CMPY_CD             = STC.GLBL_CMPY_CD
                    AND CP.CLT_PTFO_PK              = STC.CLT_PTFO_PK
                    AND CP.EZCANCELFLAG             = '0'
                    <!-- START 2017/06/28 K.Kojima [QC#19141, MOD] -->
                    <!-- AND ACRAL.GLBL_CMPY_CD      (+) = CP.GLBL_CMPY_CD -->
                    <!-- AND ACRAL.AR_CR_APVL_USR_ID (+) = CP.CLT_CR_ANLST_SVC_PSN_CD -->
                    <!-- AND ACRAL.EZCANCELFLAG      (+) = '0' -->
                    AND ACRAL.GLBL_CMPY_CD          = CP.GLBL_CMPY_CD
                    AND ACRAL.AR_CR_APVL_USR_ID     = CP.CLT_CR_ANLST_SVC_PSN_CD
                    AND ACRAL.EZCANCELFLAG          = '0'
                    <!-- END 2017/06/28 K.Kojima [QC#19141, MOD] -->
                UNION ALL 
                SELECT
                     NULL    AS COND_STR_10
                    ,'Next2' AS DEC_COND
                    ,'1'     AS COND_STR_9
                    ,2       AS SORT_KEY 
                FROM
                    DUAL
                ORDER BY
                    SORT_KEY
            ) A
        WHERE
            ROWNUM = 1
    </statement>

    <statement id="WF_CR_CHK_SINGLE_SQL" parameterClass="Map" resultClass="Map">
        SELECT
             #condStr10# AS VAL_STR_1
            ,#condStr1# AS COND_STR_1
        FROM
            DUAL
    </statement>

    <statement id="WF_CR_CHK_ALL_SQL" parameterClass="Map" resultClass="Map">
        WITH APVL AS (
            SELECT
                SP.PSN_CD AS VAL_STR_1
            FROM
                 S21_PSN      SP
                ,ORG_FUNC_ASG OFA
                ,TOC          T
          WHERE
                  SP.GLBL_CMPY_CD       = #glblCmpyCd#
              AND SP.EZCANCELFLAG       = '0'
              AND OFA.GLBL_CMPY_CD      = SP.GLBL_CMPY_CD
              AND OFA.PSN_CD            = SP.PSN_CD
              AND OFA.EZCANCELFLAG      = '0' 
              AND T.GLBL_CMPY_CD        = OFA.GLBL_CMPY_CD
              AND T.TOC_CD              = OFA.TOC_CD
              AND T.ORG_FUNC_ROLE_TP_CD = '208'
              AND T.EZCANCELFLAG        = '0'
          ORDER BY
            SP.PSN_CD
        )
        SELECT
             A.VAL_STR_1
            ,#condStr1# AS COND_STR_1
        FROM
            APVL A
        WHERE
            ROWNUM = 1
    </statement>

    <!-- START 2020/02/26 H.Mizukami [QC#55887, MOD] -->
    <!-- START 2019/03/19 H.Ikeda [QC#30745, MOD] -->
    <statement id="WF_CR_CHK_GRP_ALL_SQL" parameterClass="Map" resultClass="Map">
        WITH APVL AS (
        SELECT
             A.COND_STR_10
            ,A.COND_STR_9
            ,A.DEC_COND
            ,A.CR_LIMIT_AMT
        FROM
            ( 
                SELECT
                     ACRAL.AR_CR_APVL_USR_ID AS COND_STR_10
                    ,'Next'                  AS DEC_COND
                    ,'0'                     AS COND_STR_9
                    ,0                       AS SORT_KEY 
                    ,ACRAL.CR_LIMIT_AMT      AS CR_LIMIT_AMT
                FROM
                     BILL_TO_CUST BTC 
                    ,CLT_PTFO CP 
                    ,AR_CR_RF_APVL_LIMIT ACRAL 
                WHERE
                        BTC.GLBL_CMPY_CD            = #glblCmpyCd#
                    AND BTC.BILL_TO_CUST_CD         = #condStr1#
                    AND BTC.EZCANCELFLAG            = '0'
                    AND CP.GLBL_CMPY_CD             = BTC.GLBL_CMPY_CD
                    AND CP.CLT_PTFO_PK              = BTC.CLT_PTFO_PK
                    AND CP.EZCANCELFLAG             = '0'
                    AND ACRAL.GLBL_CMPY_CD          = CP.GLBL_CMPY_CD
                    AND ACRAL.AR_CR_APVL_USR_ID     = CP.CLT_CR_ANLST_SVC_PSN_CD
                    AND ACRAL.EZCANCELFLAG          = '0'
                UNION ALL 
                SELECT
                     ACRAL.AR_CR_APVL_USR_ID AS COND_STR_10
                    ,'Next'                  AS DEC_COND
                    ,'0'                     AS COND_STR_9
                    ,1                       AS SORT_KEY 
                    ,ACRAL.CR_LIMIT_AMT      AS CR_LIMIT_AMT
                FROM
                     SELL_TO_CUST STC 
                    ,CLT_PTFO CP 
                    ,AR_CR_RF_APVL_LIMIT ACRAL 
                WHERE
                        STC.GLBL_CMPY_CD            = #glblCmpyCd#
                    AND STC.SELL_TO_CUST_CD         = #condStr2#
                    AND STC.EZCANCELFLAG            = '0'
                    AND CP.GLBL_CMPY_CD             = STC.GLBL_CMPY_CD
                    AND CP.CLT_PTFO_PK              = STC.CLT_PTFO_PK
                    AND CP.EZCANCELFLAG             = '0'
                    AND ACRAL.GLBL_CMPY_CD          = CP.GLBL_CMPY_CD
                    AND ACRAL.AR_CR_APVL_USR_ID     = CP.CLT_CR_ANLST_SVC_PSN_CD
                    AND ACRAL.EZCANCELFLAG          = '0'
                UNION ALL 
                SELECT
                     NULL    AS COND_STR_10
                    ,'Next2' AS DEC_COND
                    ,'1'     AS COND_STR_9
                    ,2       AS SORT_KEY 
                    ,0       AS CR_LIMIT_AMT
                FROM
                    DUAL
                ORDER BY
                    SORT_KEY
            ) A
        WHERE
            ROWNUM = 1
        )
        SELECT
            'NSWP0004'                 AS BIZ_ID
           ,'GRP_APVL_PSN'             AS USER_GROUP_NAME
           ,''                         AS USER_GROUP_LEVEL
           ,ACRAL.AR_CR_APVL_USR_ID    AS WF_USR_ID
        FROM
            AR_CR_RF_APVL_LIMIT ACRAL
           ,APVL     APVL
        WHERE
            ACRAL.GLBL_CMPY_CD         = #glblCmpyCd#
        AND ACRAL.EZCANCELFLAG         = '0'
        AND ACRAL.CR_LIMIT_AMT     &gt;= APVL.CR_LIMIT_AMT
    </statement>
    <!-- END   2020/02/26 H.Mizukami [QC#55887, MOD] -->
<!--
    <statement id="WF_CR_CHK_GRP_ALL_SQL" parameterClass="Map" resultClass="Map">
        <isNotEqual property="condStr9" compareValue="1">
        SELECT
             '' AS BIZ_ID
            ,'' AS USER_GROUP_NAME
            ,'' AS USER_GROUP_LEVEL
            ,'' AS WF_USR_ID 
        FROM
            DUAL 
        WHERE
            ROWNUM  = 2
        </isNotEqual>
        <isEqual property="condStr9" compareValue="1">
        WITH APVL AS (
            SELECT
               SP.PSN_CD
            FROM
                 S21_PSN SP 
                ,ORG_FUNC_ASG OFA 
                ,TOC T 
          WHERE
                  SP.GLBL_CMPY_CD       = #glblCmpyCd#
              AND SP.EZCANCELFLAG       = '0'
              AND OFA.GLBL_CMPY_CD      = SP.GLBL_CMPY_CD
              AND OFA.PSN_CD            = SP.PSN_CD
              AND OFA.EZCANCELFLAG      = '0'
              AND T.GLBL_CMPY_CD        = OFA.GLBL_CMPY_CD
              AND T.TOC_CD              = OFA.TOC_CD
              AND T.ORG_FUNC_ROLE_TP_CD = '208'
              AND T.EZCANCELFLAG        = '0'
          ORDER BY
              SP.PSN_CD
        )
        SELECT
             'NSWP0004'       AS BIZ_ID
            ,'GRP_APVL_PSN'   AS USER_GROUP_NAME
            ,''               AS USER_GROUP_LEVEL
            ,A.PSN_CD         AS WF_USR_ID 
        FROM
            (
                SELECT
                     PSN_CD
                    ,ROWNUM AS APLVROW
                FROM
                    APVL
            ) A
        WHERE
            APLVROW &gt;= 2
        </isEqual>
    </statement>
-->
    <!-- END   2019/03/19 H.Ikeda [QC#30745, MOD] -->

    <statement id="WF_CR_CHK_REASSIGN_SQL" parameterClass="Map" resultClass="Map">
        SELECT DISTINCT
             'NSWP0004' AS BIZ_ID
            ,'GRP_CR_CHK_REASG' AS USER_GROUP_NAME
            ,SP.PSN_CD AS WF_USR_ID
        FROM
             S21_PSN SP
            <!-- START 2023/08/21 S.Fujita [QC#61722, MOD] -->
            <!-- ,ORG_FUNC_ASG OFA -->
            <!-- ,TOC T -->
            ,DS_COND_CONST DCC
        WHERE
                SP.GLBL_CMPY_CD          = #glblCmpyCd#
            AND SP.EZCANCELFLAG          = '0'
            <!-- AND OFA.GLBL_CMPY_CD        = SP.GLBL_CMPY_CD -->
            <!-- AND OFA.PSN_CD              = SP.PSN_CD -->
            <!-- AND OFA.EZCANCELFLAG        = '0' -->
            <!-- AND T.GLBL_CMPY_CD          = OFA.GLBL_CMPY_CD -->
            <!-- AND T.TOC_CD                = OFA.TOC_CD -->
            <!-- AND T.ORG_FUNC_ROLE_TP_CD   = '208' -->
            <!-- AND T.EZCANCELFLAG          = '0' -->
            AND DCC.GLBL_CMPY_CD         = SP.GLBL_CMPY_CD
            AND DCC.EZCANCELFLAG         = '0'
            AND DCC.DS_COND_CONST_NM     = SP.HR_TTL_NM
            AND DCC.DS_COND_CONST_GRP_ID = 'CR_RVW_REASSIGN_USR'
            <!-- END 2023/08/21 S.Fujita [QC#61722, MOD] -->
    </statement>
</sqlMap>		   
