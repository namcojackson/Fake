<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<sqlMap namespace="NSZC038001">
    <statement id="getArTrxBalForAcct" parameterClass="Map" resultClass="Map">
        SELECT
             SUM(B.DEAL_RMNG_BAL_GRS_AMT) AS DEAL_RMNG_BAL_GRS_AMT
            ,MIN(B.INV_DUE_DT)            AS INV_DUE_DT
        FROM
             FSR        A
            ,AR_TRX_BAL B
        WHERE
            A.GLBL_CMPY_CD         =  #glblCmpyCd#
        AND A.FSR_NUM              =  #fsrNum#
        AND A.EZCANCELFLAG         =  '0'
        AND A.GLBL_CMPY_CD         =  B.GLBL_CMPY_CD
        AND A.BILL_TO_CUST_ACCT_CD =  B.BILL_TO_CUST_ACCT_CD
        <iterate property="arCashApplyStsCd" var="arCashApplyStsCd[]"  open=" AND B.AR_CASH_APPLY_STS_CD IN (" close=" )" conjunction=",">
            #arCashApplyStsCd[]#
        </iterate>
        AND B.EZCANCELFLAG         =  '0'

    </statement>

    <statement id="getArCrRfApvlLimitForAcct" parameterClass="Map" resultClass="Map">
        SELECT
             D.CR_LIMIT_AMT        AS CR_LIMIT_AMT
            ,D.GRACE_PER_DAYS_AOT  AS GRACE_PER_DAYS_AOT
        FROM
             FSR                 A
            ,SELL_TO_CUST        B
            ,CLT_PTFO            C
            ,AR_CR_RF_APVL_LIMIT D
        WHERE
            A.GLBL_CMPY_CD            = #glblCmpyCd#
        AND A.FSR_NUM                 = #fsrNum#
        AND A.EZCANCELFLAG            = '0'
        AND A.GLBL_CMPY_CD            = B.GLBL_CMPY_CD
        AND A.BILL_TO_CUST_ACCT_CD    = B.SELL_TO_CUST_CD
        AND B.EZCANCELFLAG            = '0'
        AND B.GLBL_CMPY_CD            = C.GLBL_CMPY_CD
        AND B.CLT_PTFO_PK             = C.CLT_PTFO_PK
        AND C.EZCANCELFLAG            = '0'
        AND C.CLT_CR_ANLST_SVC_PSN_CD = #cltCrAnlstSvcPsnCd#
        AND C.GLBL_CMPY_CD            = D.GLBL_CMPY_CD
        AND C.CLT_CR_ANLST_SVC_PSN_CD = D.AR_CR_APVL_USR_ID
        AND D.EZCANCELFLAG            = '0'

    </statement>

    <statement id="getArTrxBalForBillToCust" parameterClass="Map" resultClass="Map">
        SELECT
             SUM(B.DEAL_RMNG_BAL_GRS_AMT) AS DEAL_RMNG_BAL_GRS_AMT
            ,MIN(B.INV_DUE_DT)            AS INV_DUE_DT
        FROM
             AR_TRX_BAL B
        WHERE
            B.GLBL_CMPY_CD        = #glblCmpyCd#
        AND B.BILL_TO_CUST_CD     = #billToCustCd#
        <iterate property="arCashApplyStsCd" var="arCashApplyStsCd[]"  open=" AND B.AR_CASH_APPLY_STS_CD IN (" close=" )" conjunction=",">
            #arCashApplyStsCd[]#
        </iterate>
        AND B.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getArCrRfApvlLimitForBillToCust" parameterClass="Map" resultClass="Map">
        SELECT
             D.CR_LIMIT_AMT        AS CR_LIMIT_AMT
            ,D.GRACE_PER_DAYS_AOT  AS GRACE_PER_DAYS_AOT
        FROM
             BILL_TO_CUST        A
            ,CLT_PTFO            C
            ,AR_CR_RF_APVL_LIMIT D
        WHERE
            A.GLBL_CMPY_CD            = #glblCmpyCd#
        AND A.BILL_TO_CUST_CD         = #billToCustCd#
        AND A.EZCANCELFLAG            = '0'
        AND A.GLBL_CMPY_CD            = C.GLBL_CMPY_CD
        AND A.CLT_PTFO_PK             = C.CLT_PTFO_PK
        AND C.EZCANCELFLAG            = '0'
        AND C.CLT_CR_ANLST_SVC_PSN_CD = #cltCrAnlstSvcPsnCd#
        AND C.GLBL_CMPY_CD            = D.GLBL_CMPY_CD
        AND C.CLT_CR_ANLST_SVC_PSN_CD = D.AR_CR_APVL_USR_ID
        AND D.EZCANCELFLAG            = '0'

    </statement>

    <statement id="geBillTotCustHardHoldFlg" parameterClass="Map" resultClass="String">
        SELECT
            B.CUST_HARD_HLD_FLG
        FROM
            BILL_TO_CUST  A
            ,CUST_CR_PRFL B
        WHERE
            A.GLBL_CMPY_CD      = #glblCmpyCd#
        AND A.BILL_TO_CUST_CD   = #billToCustCd#
        AND A.EZCANCELFLAG      = '0'
        AND A.GLBL_CMPY_CD      = B.GLBL_CMPY_CD
        AND A.BILL_TO_CUST_PK   = B.BILL_TO_CUST_PK
    </statement>
</sqlMap>
