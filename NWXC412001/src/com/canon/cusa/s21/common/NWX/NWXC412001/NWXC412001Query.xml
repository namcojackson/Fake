<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NWXC412001Query">

    <statement id="getXtrnlIntfcXref" parameterClass="Map" resultClass="Map">
        SELECT
             XIX.TRGT_ATTRB_TXT_01
            ,XIX.TRGT_ATTRB_TXT_02
            ,XIX.TRGT_ATTRB_TXT_03
            ,XIX.TRGT_ATTRB_TXT_04
            ,XIX.TRGT_ATTRB_TXT_05
            ,XIX.TRGT_ATTRB_TXT_06
            ,XIX.TRGT_ATTRB_TXT_07
            ,XIX.TRGT_ATTRB_TXT_08
            ,XIX.TRGT_ATTRB_TXT_09
            ,XIX.TRGT_ATTRB_TXT_10
            ,XIX.TRGT_ATTRB_NUM_01
            ,XIX.TRGT_ATTRB_NUM_02
            ,XIX.TRGT_ATTRB_NUM_03
            ,XIX.TRGT_ATTRB_NUM_04
            ,XIX.TRGT_ATTRB_NUM_05
        FROM
            XTRNL_INTFC_XREF XIX
        WHERE
                XIX.EZCANCELFLAG         = '0'
            AND XIX.GLBL_CMPY_CD         = #glblCmpyCd#
            AND XIX.CPO_SRC_TP_CD        = #cpoSrcTpCd#
            AND XIX.INTFC_ID             = #intfcId#
            AND XIX.INTFC_XREF_CTX_TP_CD = #intfcXrefCtxTpCd#
            <isNotNull property="srcAttrbTxt01">
            AND (UPPER(XIX.SRC_ATTRB_TXT_01)    = UPPER(#srcAttrbTxt01#)
             OR  XIX.SRC_ATTRB_TXT_01    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt02">
            AND (UPPER(XIX.SRC_ATTRB_TXT_02)    = UPPER(#srcAttrbTxt02#)
             OR  XIX.SRC_ATTRB_TXT_02    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt03">
            AND (UPPER(XIX.SRC_ATTRB_TXT_03)    = UPPER(#srcAttrbTxt03#)
             OR  XIX.SRC_ATTRB_TXT_03    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt04">
            AND (UPPER(XIX.SRC_ATTRB_TXT_04)    = UPPER(#srcAttrbTxt04#)
             OR  XIX.SRC_ATTRB_TXT_04    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt05">
            AND (UPPER(XIX.SRC_ATTRB_TXT_05)    = UPPER(#srcAttrbTxt05#)
             OR  XIX.SRC_ATTRB_TXT_05    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt06">
            AND (UPPER(XIX.SRC_ATTRB_TXT_06)    = UPPER(#srcAttrbTxt06#)
             OR  XIX.SRC_ATTRB_TXT_06    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt07">
            AND (UPPER(XIX.SRC_ATTRB_TXT_07)    = UPPER(#srcAttrbTxt07#)
             OR  XIX.SRC_ATTRB_TXT_07    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt08">
            AND (UPPER(XIX.SRC_ATTRB_TXT_08)    = UPPER(#srcAttrbTxt08#)
             OR  XIX.SRC_ATTRB_TXT_08    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt09">
            AND (UPPER(XIX.SRC_ATTRB_TXT_09)    = UPPER(#srcAttrbTxt09#)
             OR  XIX.SRC_ATTRB_TXT_09    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbTxt10">
            AND (UPPER(XIX.SRC_ATTRB_TXT_10)    = UPPER(#srcAttrbTxt10#)
             OR  XIX.SRC_ATTRB_TXT_10    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbNum01">
            AND (XIX.SRC_ATTRB_NUM_01    = #srcAttrbNum01#
             OR  XIX.SRC_ATTRB_NUM_01    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbNum02">
            AND (XIX.SRC_ATTRB_NUM_02    = #srcAttrbNum02#
             OR  XIX.SRC_ATTRB_NUM_02    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbNum03">
            AND (XIX.SRC_ATTRB_NUM_03    = #srcAttrbNum03#
             OR  XIX.SRC_ATTRB_NUM_03    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbNum04">
            AND (XIX.SRC_ATTRB_NUM_04    = #srcAttrbNum04#
             OR  XIX.SRC_ATTRB_NUM_04    IS NULL)
            </isNotNull>
            <isNotNull property="srcAttrbNum05">
            AND (XIX.SRC_ATTRB_NUM_05    = #srcAttrbNum05#
             OR  XIX.SRC_ATTRB_NUM_05    IS NULL)
            </isNotNull>
    </statement>

    <statement id="getPrcCatgCdFromName" parameterClass="Map" resultClass="String">
        SELECT
            PC.PRC_CATG_CD
        FROM
            PRC_CATG PC
        WHERE
                PC.EZCANCELFLAG = '0'
            AND PC.GLBL_CMPY_CD = #glblCmpyCd#
            AND PC.PRC_CATG_NM  = #prcCatgNm#
    </statement>

    <statement id="getPrcCatgCdFromId" parameterClass="Map" resultClass="String">
        SELECT
            PC.PRC_CATG_CD
        FROM
            PRC_CATG PC
        WHERE
                PC.EZCANCELFLAG = '0'
            AND PC.GLBL_CMPY_CD = #glblCmpyCd#
            AND PC.PRC_CATG_CD  = #prcCatgCd#
    </statement>

    <statement id="getShipToInfo" parameterClass="Map" resultClass="Map">
        SELECT
             'CUSTOMER' CATEGORY
            ,STC.SHIP_TO_CUST_CD
            ,STC.FIRST_LINE_ADDR
            ,STC.SCD_LINE_ADDR
            ,STC.THIRD_LINE_ADDR
            ,STC.FRTH_LINE_ADDR
            ,STC.CTY_ADDR
            ,STC.CNTY_PK
            ,(
                 SELECT
                     C.CNTY_NM
                 FROM
                     CNTY C
                 WHERE
                         C.EZCANCELFLAG = '0'
                     AND C.GLBL_CMPY_CD = #glblCmpyCd#
                     AND C.CNTY_PK      = STC.CNTY_PK
            ) AS CNTY_NM
            ,STC.PROV_NM
            ,STC.ST_CD
            ,STC.POST_CD
            ,STC.CTRY_CD
            ,STC.LOC_NUM
            ,STC.LOC_NM
            ,STC.ADDL_LOC_NM
            ,AL.DS_ACCT_NUM
            ,SELL.DS_ACCT_NM
            ,1 AS SORTNUM
        FROM
             SHIP_TO_CUST STC
            ,ACCT_LOC     AL
            ,SELL_TO_CUST SELL
        WHERE
                STC.EZCANCELFLAG   = '0'
            AND STC.GLBL_CMPY_CD   = #glblCmpyCd#
            <isNotNull property="locNum">
            AND STC.LOC_NUM        = #locNum#
            </isNotNull>
            <isNotNull property="locNm">
            AND UPPER(STC.LOC_NM)  = UPPER(#locNm#)
            </isNotNull>
            AND STC.RGTN_STS_CD    = #rgtnStsCd#
            AND STC.EFF_FROM_DT    &lt;= #slsDt#
            AND (STC.EFF_THRU_DT   &gt;= #slsDt# OR STC.EFF_THRU_DT IS NULL)
            AND STC.EZCANCELFLAG   = AL.EZCANCELFLAG
            AND STC.GLBL_CMPY_CD   = AL.GLBL_CMPY_CD
            AND STC.LOC_NUM        = AL.LOC_NUM
            AND STC.RGTN_STS_CD    = AL.RGTN_STS_CD
            <isNotNull property="address">
            AND UPPER(TRIM(TRIM(STC.FIRST_LINE_ADDR) || ' ' || TRIM(STC.SCD_LINE_ADDR)) 
                || TRIM(STC.THIRD_LINE_ADDR) 
                || TRIM(STC.FRTH_LINE_ADDR) 
                || TRIM(STC.CTY_ADDR) 
                || TRIM(STC.ST_CD) 
                || TRIM(SUBSTR(STC.POST_CD, 1, 5))) = UPPER(#address#)
            </isNotNull>
            AND AL.EFF_FROM_DT  &lt;= #slsDt#
            AND (AL.EFF_THRU_DT &gt;= #slsDt# OR AL.EFF_THRU_DT IS NULL)
            AND AL.EZCANCELFLAG    = SELL.EZCANCELFLAG
            AND AL.GLBL_CMPY_CD    = SELL.GLBL_CMPY_CD
            AND AL.DS_ACCT_NUM     = SELL.SELL_TO_CUST_CD
            AND AL.RGTN_STS_CD     = SELL.RGTN_STS_CD
            AND SELL.EFF_FROM_DT    &lt;= #slsDt#
            AND (SELL.EFF_THRU_DT   &gt;= #slsDt# OR SELL.EFF_THRU_DT IS NULL)
        UNION ALL
        SELECT
             'PROSPECT' CATEGORY
            ,NULL
            ,PPLW.FIRST_LINE_ADDR
            ,PPLW.SCD_LINE_ADDR
            ,PPLW.THIRD_LINE_ADDR
            ,PPLW.FRTH_LINE_ADDR
            ,PPLW.CTY_ADDR
            ,PPLW.CNTY_PK
            ,(
                 SELECT
                     C.CNTY_NM
                 FROM
                     CNTY C
                 WHERE
                         C.EZCANCELFLAG = '0'
                     AND C.GLBL_CMPY_CD = #glblCmpyCd#
                     AND C.CNTY_PK      = PPLW.CNTY_PK
            ) AS CNTY_NM
            ,PPLW.PROV_NM
            ,PPLW.ST_CD
            ,PPLW.POST_CD
            ,PPLW.CTRY_CD
            ,PPLW.LOC_NUM
            ,PPLW.LOC_NM
            ,PPLW.ADDL_LOC_NM
            ,DAP.DS_ACCT_NUM
            ,DAP.DS_ACCT_NM
            ,2 AS SORTNUM
        FROM
             DS_ACCT_PROS     DAP
            ,PROS_PTY_LOC_WRK PPLW
        WHERE
                DAP.EZCANCELFLAG  =  '0'
            AND DAP.GLBL_CMPY_CD  =  #glblCmpyCd#
            AND (DAP.EFF_THRU_DT   &gt;= #slsDt# OR DAP.EFF_THRU_DT IS NULL)
            AND DAP.EZCANCELFLAG   =  PPLW.EZCANCELFLAG
            AND DAP.GLBL_CMPY_CD   =  PPLW.GLBL_CMPY_CD
            AND DAP.PTY_LOC_PK     =  PPLW.PTY_LOC_PK
            AND (PPLW.EFF_THRU_DT  &gt;= #slsDt# OR PPLW.EFF_THRU_DT IS NULL)
            <isNotNull property="locNum">
            AND PPLW.LOC_NUM         = #locNum#
            </isNotNull>
            <isNotNull property="locNm">
            AND UPPER(PPLW.LOC_NM)   = UPPER(#locNm#)
            </isNotNull>
            <isNotNull property="address">
            AND UPPER(TRIM(TRIM(PPLW.FIRST_LINE_ADDR) || ' ' || TRIM(PPLW.SCD_LINE_ADDR)) 
                || TRIM(PPLW.THIRD_LINE_ADDR) 
                || TRIM(PPLW.FRTH_LINE_ADDR) 
                || TRIM(PPLW.CTY_ADDR) 
                || TRIM(PPLW.ST_CD) 
                || TRIM(SUBSTR(PPLW.POST_CD, 1, 5))) = UPPER(#address#)
            </isNotNull>
        ORDER BY
            SORTNUM
    </statement>

    <statement id="getBillToInfo" parameterClass="Map" resultClass="Map">
        SELECT
             'CUSTOMER' CATEGORY
            ,BTC.BILL_TO_CUST_CD
            ,BTC.BILL_TO_CUST_PK
            ,BTC.FIRST_LINE_ADDR
            ,BTC.SCD_LINE_ADDR
            ,BTC.THIRD_LINE_ADDR
            ,BTC.FRTH_LINE_ADDR
            ,BTC.CTY_ADDR
            ,BTC.CNTY_PK
            ,(
                 SELECT
                     C.CNTY_NM
                 FROM
                     CNTY C
                 WHERE
                         C.EZCANCELFLAG = '0'
                     AND C.GLBL_CMPY_CD = #glblCmpyCd#
                     AND C.CNTY_PK      = BTC.CNTY_PK
            ) AS CNTY_NM
            ,BTC.PROV_NM
            ,BTC.ST_CD
            ,BTC.POST_CD
            ,BTC.CTRY_CD
            ,BTC.LOC_NUM
            ,BTC.LOC_NM
            ,BTC.ADDL_LOC_NM
            ,AL.DS_ACCT_NUM
            ,STC.DS_ACCT_NM
            ,1 AS SORTNUM
        FROM
             BILL_TO_CUST BTC
            ,ACCT_LOC     AL
            ,SELL_TO_CUST STC
        WHERE
                BTC.EZCANCELFLAG    = '0'
            AND BTC.GLBL_CMPY_CD    = #glblCmpyCd#
            <isNotNull property="billToCustCd">
            AND BTC.BILL_TO_CUST_CD = #billToCustCd#
            </isNotNull>
            <isNotNull property="locNum">
            AND BTC.LOC_NUM         = #locNum#
            </isNotNull>
            <isNotNull property="locNm">
            AND UPPER(BTC.LOC_NM)   = UPPER(#locNm#)
            </isNotNull>
            AND BTC.RGTN_STS_CD     = #rgtnStsCd#
            AND BTC.EFF_FROM_DT     &lt;= #slsDt#
            AND (BTC.EFF_THRU_DT    &gt;= #slsDt# OR BTC.EFF_THRU_DT IS NULL)
            <isNotNull property="address">
            AND UPPER(TRIM(TRIM(BTC.FIRST_LINE_ADDR) || ' ' || TRIM(BTC.SCD_LINE_ADDR)) 
                || TRIM(BTC.THIRD_LINE_ADDR) 
                || TRIM(BTC.FRTH_LINE_ADDR) 
                || TRIM(BTC.CTY_ADDR) 
                || TRIM(BTC.ST_CD) 
                || TRIM(SUBSTR(BTC.POST_CD, 1, 5))) = UPPER(#address#)
            </isNotNull>
            AND BTC.EZCANCELFLAG    = AL.EZCANCELFLAG
            AND BTC.GLBL_CMPY_CD    = AL.GLBL_CMPY_CD
            AND BTC.LOC_NUM         = AL.LOC_NUM
            AND BTC.RGTN_STS_CD     = AL.RGTN_STS_CD
            AND AL.EFF_FROM_DT      &lt;= #slsDt#
            AND (AL.EFF_THRU_DT     &gt;= #slsDt# OR AL.EFF_THRU_DT IS NULL)
            AND AL.EZCANCELFLAG     = STC.EZCANCELFLAG
            AND AL.GLBL_CMPY_CD     = STC.GLBL_CMPY_CD
            AND AL.DS_ACCT_NUM      = STC.SELL_TO_CUST_CD
            AND AL.RGTN_STS_CD      = STC.RGTN_STS_CD
            AND STC.EFF_FROM_DT     &lt;= #slsDt#
            AND (STC.EFF_THRU_DT    &gt;= #slsDt# OR STC.EFF_THRU_DT IS NULL)
        <isNull property="billToCustCd">
        UNION ALL
        SELECT
             'PROSPECT' CATEGORY
            ,NULL
            ,NULL
            ,PPLW.FIRST_LINE_ADDR
            ,PPLW.SCD_LINE_ADDR
            ,PPLW.THIRD_LINE_ADDR
            ,PPLW.FRTH_LINE_ADDR
            ,PPLW.CTY_ADDR
            ,PPLW.CNTY_PK
            ,(
                 SELECT
                     C.CNTY_NM
                 FROM
                     CNTY C
                 WHERE
                         C.EZCANCELFLAG = '0'
                     AND C.GLBL_CMPY_CD = #glblCmpyCd#
                     AND C.CNTY_PK      = PPLW.CNTY_PK
            ) AS CNTY_NM
            ,PPLW.PROV_NM
            ,PPLW.ST_CD
            ,PPLW.POST_CD
            ,PPLW.CTRY_CD
            ,PPLW.LOC_NUM
            ,PPLW.LOC_NM
            ,PPLW.ADDL_LOC_NM
            ,DAP.DS_ACCT_NUM
            ,DAP.DS_ACCT_NM
            ,2 AS SORTNUM
        FROM
             DS_ACCT_PROS     DAP
            ,PROS_PTY_LOC_WRK PPLW
        WHERE
                DAP.EZCANCELFLAG  =  '0'
            AND DAP.GLBL_CMPY_CD  =  #glblCmpyCd#
            AND (DAP.EFF_THRU_DT   &gt;= #slsDt# OR DAP.EFF_THRU_DT IS NULL)
            AND DAP.EZCANCELFLAG   =  PPLW.EZCANCELFLAG
            AND DAP.GLBL_CMPY_CD   =  PPLW.GLBL_CMPY_CD
            AND DAP.PTY_LOC_PK     =  PPLW.PTY_LOC_PK
            AND (PPLW.EFF_THRU_DT  &gt;= #slsDt# OR PPLW.EFF_THRU_DT IS NULL)
            <isNotNull property="locNum">
            AND PPLW.LOC_NUM         = #locNum#
            </isNotNull>
            <isNotNull property="locNm">
            AND UPPER(PPLW.LOC_NM)   = UPPER(#locNm#)
            </isNotNull>
            <isNotNull property="address">
            AND UPPER(TRIM(TRIM(PPLW.FIRST_LINE_ADDR) || ' ' || TRIM(PPLW.SCD_LINE_ADDR)) 
                || TRIM(PPLW.THIRD_LINE_ADDR) 
                || TRIM(PPLW.FRTH_LINE_ADDR) 
                || TRIM(PPLW.CTY_ADDR) 
                || TRIM(PPLW.ST_CD) 
                || TRIM(SUBSTR(PPLW.POST_CD, 1, 5))) = UPPER(#address#)
            </isNotNull>
        ORDER BY
            SORTNUM
        </isNull>
    </statement>


    <statement id="getSoldToInfoFromShipToCustCd" parameterClass="Map" resultClass="Map">
        SELECT
             BTC.BILL_TO_CUST_CD
            ,BTC.BILL_TO_CUST_PK
            ,BTC.FIRST_LINE_ADDR
            ,BTC.SCD_LINE_ADDR
            ,BTC.THIRD_LINE_ADDR
            ,BTC.FRTH_LINE_ADDR
            ,BTC.CTY_ADDR
            ,BTC.CNTY_PK
            ,(
                 SELECT
                     C.CNTY_NM
                 FROM
                     CNTY C
                 WHERE
                         C.EZCANCELFLAG = '0'
                     AND C.GLBL_CMPY_CD = #glblCmpyCd#
                     AND C.CNTY_PK      = BTC.CNTY_PK
            ) AS CNTY_NM
            ,BTC.PROV_NM
            ,BTC.ST_CD
            ,BTC.POST_CD
            ,BTC.CTRY_CD
            ,BTC.LOC_NUM
            ,BTC.LOC_NM
            ,BTC.ADDL_LOC_NM
            ,AL.DS_ACCT_NUM
            ,SELL.DS_ACCT_NM
        FROM
             SHIP_TO_CUST STC
            ,BILL_TO_CUST BTC
            ,ACCT_LOC     AL
            ,SELL_TO_CUST SELL
        WHERE
                STC.EZCANCELFLAG    = '0'
            AND STC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
            AND STC.RGTN_STS_CD     = #rgtnStsCd#
            AND STC.EFF_FROM_DT     &lt;= #slsDt#
            AND (STC.EFF_THRU_DT    &gt;= #slsDt# OR STC.EFF_THRU_DT IS NULL)
            AND STC.EZCANCELFLAG    = BTC.EZCANCELFLAG
            AND STC.GLBL_CMPY_CD    = BTC.GLBL_CMPY_CD
            AND STC.LOC_NUM         = BTC.LOC_NUM
            AND STC.RGTN_STS_CD     = BTC.RGTN_STS_CD
            AND BTC.EFF_FROM_DT     &lt;= #slsDt#
            AND (BTC.EFF_THRU_DT    &gt;= #slsDt# OR BTC.EFF_THRU_DT IS NULL)
            AND BTC.EZCANCELFLAG    = AL.EZCANCELFLAG(+)
            AND BTC.GLBL_CMPY_CD    = AL.GLBL_CMPY_CD(+)
            AND BTC.LOC_NUM         = AL.LOC_NUM(+)
            AND BTC.RGTN_STS_CD     = AL.RGTN_STS_CD(+)
            AND AL.EFF_FROM_DT(+)   &lt;= #slsDt#
            AND (AL.EFF_THRU_DT(+)  &gt;= #slsDt# OR AL.EFF_THRU_DT(+) IS NULL)
            AND AL.EZCANCELFLAG     = SELL.EZCANCELFLAG(+)
            AND AL.GLBL_CMPY_CD     = SELL.GLBL_CMPY_CD(+)
            AND AL.DS_ACCT_NUM      = SELL.SELL_TO_CUST_CD(+)
            AND AL.RGTN_STS_CD      = SELL.RGTN_STS_CD(+)
            AND SELL.EFF_FROM_DT(+)  &lt;= #slsDt#
            AND (SELL.EFF_THRU_DT(+) &gt;= #slsDt# OR SELL.EFF_THRU_DT(+) IS NULL)
    </statement>

    <statement id="getSoldToInfoFromAddress" parameterClass="Map" resultClass="Map">
        SELECT
             BTC.BILL_TO_CUST_CD
            ,BTC.BILL_TO_CUST_PK
            ,BTC.FIRST_LINE_ADDR
            ,BTC.SCD_LINE_ADDR
            ,BTC.THIRD_LINE_ADDR
            ,BTC.FRTH_LINE_ADDR
            ,BTC.CTY_ADDR
            ,BTC.CNTY_PK
            ,(
                 SELECT
                     C.CNTY_NM
                 FROM
                     CNTY C
                 WHERE
                         C.EZCANCELFLAG = '0'
                     AND C.GLBL_CMPY_CD = #glblCmpyCd#
                     AND C.CNTY_PK      = BTC.CNTY_PK
            ) AS CNTY_NM
            ,BTC.PROV_NM
            ,BTC.ST_CD
            ,BTC.POST_CD
            ,BTC.CTRY_CD
            ,BTC.LOC_NUM
            ,BTC.LOC_NM
            ,BTC.ADDL_LOC_NM
            ,AL.DS_ACCT_NUM
            ,STC.DS_ACCT_NM
        FROM
             BILL_TO_CUST BTC
            ,ACCT_LOC     AL
            ,SELL_TO_CUST STC
        WHERE
                BTC.EZCANCELFLAG    = '0'
            AND BTC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND BTC.RGTN_STS_CD     = #rgtnStsCd#
            AND BTC.EFF_FROM_DT     &lt;= #slsDt#
            AND (BTC.EFF_THRU_DT    &gt;= #slsDt# OR BTC.EFF_THRU_DT IS NULL)
            <isNotNull property="locNm">
            AND UPPER(BTC.LOC_NM)   = UPPER(#locNm#)
            </isNotNull>
            AND UPPER(TRIM(TRIM(BTC.FIRST_LINE_ADDR) || ' ' || TRIM(BTC.SCD_LINE_ADDR)) 
                || TRIM(BTC.THIRD_LINE_ADDR) 
                || TRIM(BTC.FRTH_LINE_ADDR) 
                || TRIM(BTC.CTY_ADDR) 
                || TRIM(BTC.ST_CD) 
                || SUBSTR(TRIM(BTC.POST_CD), 1, 5)) = UPPER(#address#)
            AND BTC.EZCANCELFLAG    = AL.EZCANCELFLAG(+)
            AND BTC.GLBL_CMPY_CD    = AL.GLBL_CMPY_CD(+)
            AND BTC.LOC_NUM         = AL.LOC_NUM(+)
            AND BTC.RGTN_STS_CD     = AL.RGTN_STS_CD(+)
            AND AL.EFF_FROM_DT(+)   &lt;= #slsDt#
            AND (AL.EFF_THRU_DT(+)  &gt;= #slsDt# OR AL.EFF_THRU_DT(+) IS NULL)
            AND AL.EZCANCELFLAG     = STC.EZCANCELFLAG(+)
            AND AL.GLBL_CMPY_CD     = STC.GLBL_CMPY_CD(+)
            AND AL.DS_ACCT_NUM      = STC.SELL_TO_CUST_CD(+)
            AND AL.RGTN_STS_CD      = STC.RGTN_STS_CD(+)
            AND STC.EFF_FROM_DT(+)  &lt;= #slsDt#
            AND (STC.EFF_THRU_DT(+) &gt;= #slsDt# OR STC.EFF_THRU_DT(+) IS NULL)
    </statement>

    <statement id="getSoldToInfoFromShipToAcctCd" parameterClass="Map" resultClass="Map">
        SELECT
             BTC.BILL_TO_CUST_CD
            ,BTC.BILL_TO_CUST_PK
            ,BTC.FIRST_LINE_ADDR
            ,BTC.SCD_LINE_ADDR
            ,BTC.THIRD_LINE_ADDR
            ,BTC.FRTH_LINE_ADDR
            ,BTC.CTY_ADDR
            ,BTC.CNTY_PK
            ,(
                 SELECT
                     C.CNTY_NM
                 FROM
                     CNTY C
                 WHERE
                         C.EZCANCELFLAG = '0'
                     AND C.GLBL_CMPY_CD = #glblCmpyCd#
                     AND C.CNTY_PK      = BTC.CNTY_PK
            ) AS CNTY_NM
            ,BTC.PROV_NM
            ,BTC.ST_CD
            ,BTC.POST_CD
            ,BTC.CTRY_CD
            ,BTC.LOC_NUM
            ,BTC.LOC_NM
            ,BTC.ADDL_LOC_NM
            ,AL.DS_ACCT_NUM
            ,STC.DS_ACCT_NM
        FROM
             BILL_TO_CUST    BTC
            ,ACCT_LOC        AL
            ,SELL_TO_CUST    STC
        WHERE
                STC.EZCANCELFLAG    = '0'
            AND STC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND STC.SELL_TO_CUST_CD = #shipToAcctCd#
            AND STC.RGTN_STS_CD     = #rgtnStsCd#
            AND STC.EFF_FROM_DT     &lt;= #slsDt#
            AND (STC.EFF_THRU_DT    &gt;= #slsDt# OR STC.EFF_THRU_DT IS NULL)
            AND STC.EZCANCELFLAG    = AL.EZCANCELFLAG
            AND STC.GLBL_CMPY_CD    = AL.GLBL_CMPY_CD
            AND STC.SELL_TO_CUST_CD = AL.DS_ACCT_NUM
            AND STC.RGTN_STS_CD     = AL.RGTN_STS_CD
            AND AL.EFF_FROM_DT      &lt;= #slsDt#
            AND (AL.EFF_THRU_DT     &gt;= #slsDt# OR AL.EFF_THRU_DT IS NULL)
            AND AL.EZCANCELFLAG     = BTC.EZCANCELFLAG
            AND AL.GLBL_CMPY_CD     = BTC.GLBL_CMPY_CD
            AND AL.LOC_NUM          = BTC.LOC_NUM
            AND AL.RGTN_STS_CD      = BTC.RGTN_STS_CD
            AND BTC.EFF_FROM_DT     &lt;= #slsDt#
            AND (BTC.EFF_THRU_DT    &gt;= #slsDt# OR BTC.EFF_THRU_DT IS NULL)
    </statement>

    <statement id="getDsLineCatgCd" parameterClass="Map" resultClass="String">
        SELECT
            DOLC.DS_ORD_LINE_CATG_CD AS DS_ORD_LINE_CATG_CD
        FROM
             DS_ORD_LINE_PROC_DFN DOLPD
            ,DS_ORD_LINE_CATG     DOLC
        WHERE
                DOLPD.GLBL_CMPY_CD                 = #glblCmpyCd#
            AND DOLPD.DS_ORD_TP_CD                 = #dsOrdTpCd#
            AND DOLPD.ACTV_FLG                     = 'Y'
            AND DOLPD.PRIM_LINE_CATG_FLG           = 'Y'
            AND DOLPD.EFF_FROM_DT                 &lt;= #slsDt#
            AND NVL(DOLPD.EFF_THRU_DT,'99991231') &gt;= #slsDt#
            AND DOLPD.EZCANCELFLAG                 = '0'
            AND DOLPD.GLBL_CMPY_CD                 = DOLC.GLBL_CMPY_CD
            AND DOLPD.DS_ORD_LINE_CATG_CD          = DOLC.DS_ORD_LINE_CATG_CD
            AND DOLC.DS_ORD_LINE_DRCTN_CD          = #dsOrdLineDrctnCd#
            AND DOLC.EZCANCELFLAG                  = '0'
    </statement>

    <statement id="getSpecCondPrcPkByPrcCondTpCd" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SCP.SPEC_COND_PRC_PK
        FROM
            SPEC_COND_PRC SCP
        WHERE
                SCP.EZCANCELFLAG   = '0'
            AND SCP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND SCP.PRC_COND_TP_CD = #prcCondTpCd#
    </statement>

    <statement id="getMdse" parameterClass="Map" resultClass="Map">
        SELECT
            AMV.MDSE_CD
           ,AMV.MDSE_NM
           ,AMV.COA_MDSE_TP_CD
           ,AMV.SHPG_SER_TAKE_FLG
        FROM
            ALL_MDSE_V AMV
        WHERE
                AMV.EZCANCELFLAG   = '0'
            AND AMV.GLBL_CMPY_CD   = #glblCmpyCd#
            AND AMV.MDSE_CD        = #mdseCd#
            AND AMV.RGTN_STS_CD    = #rgtnStsCd#
    </statement>

    <statement id="getSvcMachMstrBySerNum" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.MDSE_CD
           ,SMM.SVC_CONFIG_MSTR_PK
           ,SMM.SVC_MACH_MSTR_PK
           ,SCM.MDL_ID
           ,MM.T_MDL_NM
        FROM
            SVC_MACH_MSTR SMM
           ,SVC_CONFIG_MSTR SCM
           ,MDL_NM MM
        WHERE
                SMM.EZCANCELFLAG   = '0'
            AND SMM.GLBL_CMPY_CD   = #glblCmpyCd#
            AND SMM.SER_NUM        = #serNum#
            <isNotNull property="mdseCd">
            AND SMM.MDSE_CD        = #mdseCd#
            </isNotNull>
            AND SMM.EFF_FROM_DT    &lt;= #slsDt#
            AND (SMM.EFF_THRU_DT   &gt;= #slsDt# OR SMM.EFF_THRU_DT IS NULL)
            AND SMM.SVC_MACH_MSTR_PK = SCM.SVC_MACH_MSTR_PK(+)
            AND SCM.EZCANCELFLAG(+)  = '0'
            AND SCM.GLBL_CMPY_CD(+)  = #glblCmpyCd#
            AND SCM.MDL_ID           = MM.T_MDL_ID(+)
            AND MM.EZCANCELFLAG(+)   = '0'
            AND MM.T_GLBL_CMPY_CD(+) = #glblCmpyCd#
            AND ROWNUM               = 1
    </statement>

    <statement id="getMdlIdByName" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            MN.T_MDL_ID
        FROM
            MDL_NM MN
        WHERE
                MN.EZCANCELFLAG   = '0'
            AND MN.T_GLBL_CMPY_CD = #glblCmpyCd#
            AND MN.T_MDL_NM       = #mdlNm#
            AND ROWNUM            = 1
    </statement>

    <statement id="getMdlIdByMdse" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            MN.T_MDL_ID
        FROM
            DS_MDL_CONFIG DMC
           ,MDL_NM MN
        WHERE
                DMC.EZCANCELFLAG   = '0'
            AND DMC.GLBL_CMPY_CD = #glblCmpyCd#
            AND DMC.PRNT_MDSE_CD = #mdseCd#
            AND DMC.MDL_ID       = MN.T_MDL_ID
            AND DMC.GLBL_CMPY_CD = MN.T_GLBL_CMPY_CD
            AND MN.EZCANCELFLAG  = '0'
            AND ROWNUM            = 1
            <!-- QC#20950 -->
            AND NOT EXISTS (SELECT '1' FROM DS_MDL_CONFIG A 
                            WHERE A.MDL_ID = DMC.MDL_ID 
                            AND A.CHILD_MDSE_CD IS NOT NULL
                            AND A.EZCANCELFLAG = DMC.EZCANCELFLAG
                            AND A.GLBL_CMPY_CD = DMC.GLBL_CMPY_CD)
    </statement>

    <statement id="getDsContrByContrNum" parameterClass="Map" resultClass="Map">
        SELECT
            DC.DS_CONTR_PK
        FROM
            DS_CONTR DC
        WHERE
                DC.EZCANCELFLAG              = '0'
            AND DC.GLBL_CMPY_CD              = #glblCmpyCd#
            AND DC.DS_CONTR_NUM              = #dsContrNum#
            AND DC.CONTR_VRSN_EFF_FROM_DT    &lt;= #slsDt#
            AND (DC.CONTR_VRSN_EFF_THRU_DT   &gt;= #slsDt# OR DC.CONTR_VRSN_EFF_THRU_DT IS NULL)
            AND ROWNUM                       = 1
    </statement>

    <statement id="getPrcMtrPkgFromName" parameterClass="Map" resultClass="Map">
        SELECT
            PMP.PRC_MTR_PKG_PK
           ,PMP.CORP_ADV_PRC_FLG
        FROM
            PRC_MTR_PKG PMP
        WHERE
                PMP.EZCANCELFLAG    = '0'
            AND PMP.GLBL_CMPY_CD    = #glblCmpyCd#
            AND PMP.PRC_MTR_PKG_NM  = #prcMtrPkgNm#
            AND PMP.EFF_FROM_DT     &lt;= #slsDt#
            AND (PMP.EFF_THRU_DT    &gt;= #slsDt# OR PMP.EFF_THRU_DT IS NULL)
            AND ROWNUM              = 1
    </statement>

    <statement id="getPrcMtrPkgMtrStru" parameterClass="Map" resultClass="Map">
        SELECT
            PMPMSV.*
           ,ML.BW_MTR_FLG
           ,ML.COLOR_MTR_FLG
           ,ML.TOT_MTR_FLG
        FROM
            PRC_MTR_PKG_MTR_STRU_V PMPMSV
           ,MTR_LB                 ML
        WHERE
                PMPMSV.EZCANCELFLAG              = '0'
            AND PMPMSV.GLBL_CMPY_CD              = #glblCmpyCd#
            AND PMPMSV.PRC_MTR_PKG_PK            = #prcMtrPkgPk#
            AND PMPMSV.MDL_ID                    = #mdlId#
            AND PMPMSV.ACTV_FLG                  = 'Y'
            AND PMPMSV.MDL_MTR_EFF_FROM_DT       &lt;= #slsDt#
            AND (PMPMSV.MDL_MTR_EFF_THRU_DT      &gt;= #slsDt# OR PMPMSV.MDL_MTR_EFF_THRU_DT IS NULL)
            AND PMPMSV.BLLG_MTR_MAP_EFF_FROM_DT  &lt;= #slsDt#
            AND (PMPMSV.BLLG_MTR_MAP_EFF_THRU_DT &gt;= #slsDt# OR PMPMSV.BLLG_MTR_MAP_EFF_THRU_DT IS NULL)
            AND PMPMSV.MTR_PKG_EFF_FROM_DT       &lt;= #slsDt#
            AND (PMPMSV.MTR_PKG_EFF_THRU_DT      &gt;= #slsDt# OR PMPMSV.MTR_PKG_EFF_THRU_DT IS NULL)
            AND PMPMSV.MTR_PKG_MDL_EFF_FROM_DT   &lt;= #slsDt#
            AND (PMPMSV.MTR_PKG_MDL_EFF_THRU_DT  &gt;= #slsDt# OR PMPMSV.MTR_PKG_MDL_EFF_THRU_DT IS NULL)
            AND PMPMSV.EZCANCELFLAG              = ML.EZCANCELFLAG
            AND PMPMSV.GLBL_CMPY_CD              = ML.GLBL_CMPY_CD
            AND PMPMSV.BLLG_MTR_LB_CD            = ML.MTR_LB_CD
            AND ML.MTR_LB_NM                     = #mtrLbDescTxt#
        ORDER BY
            PMPMSV.BLLG_MTR_LB_SORT_NUM
    </statement>

    <statement id="getSlsRepTocByResourceId" parameterClass="Map" resultClass="Map">
        SELECT
             SP.PSN_NUM           AS SLS_REP_PSN_NUM
            ,TOC.TOC_CD           AS SLS_REP_TOC_CD
            ,TOC.TOC_NM           AS SLS_REP_TOC_NM
        FROM
             TOC              TOC
            ,ORG_FUNC_ROLE_TP OFRT
            ,BIZ_AREA_ORG     BA
            ,ORG_FUNC_ASG     OFA
            ,S21_PSN          SP
            ,COA_BR           CB
            ,COA_EXTN         CE
        WHERE
                TOC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND TOC.EZCANCELFLAG        = '0'
            AND TOC.GLBL_CMPY_CD        = OFRT.GLBL_CMPY_CD
            AND TOC.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD
            AND OFRT.SLS_REP_FLG        = 'Y'
            AND OFRT.EZCANCELFLAG       = '0'
            AND OFRT.GLBL_CMPY_CD       = BA.GLBL_CMPY_CD
            AND OFRT.FIRST_ORG_CD       = BA.BIZ_AREA_ORG_CD
            AND BA.SLS_FLG              = 'Y'
            AND BA.ORG_STRU_TP_CD       = #orgStruTpCd#
            AND BA.EZCANCELFLAG         = '0'
            AND TOC.GLBL_CMPY_CD        = OFA.GLBL_CMPY_CD
            AND TOC.TOC_CD              = OFA.TOC_CD
            AND OFA.EZCANCELFLAG        = '0'
            AND OFA.GLBL_CMPY_CD        = SP.GLBL_CMPY_CD
            AND OFA.PSN_CD              = SP.PSN_CD
            AND SP.PSN_CD               = #slsRepPsnCd#
            AND SP.EFF_FROM_DT          &lt;= #slsDt#
            AND (SP.EFF_THRU_DT         &gt;= #slsDt# OR SP.EFF_THRU_DT IS NULL)
            AND SP.EZCANCELFLAG         = '0'
            AND TOC.GLBL_CMPY_CD        = CB.GLBL_CMPY_CD (+)
            AND TOC.COA_BR_CD           = CB.COA_BR_CD (+)
            AND CB.EZCANCELFLAG (+)     = '0'
            AND TOC.GLBL_CMPY_CD        = CE.GLBL_CMPY_CD (+)
            AND TOC.COA_EXTN_CD         = CE.COA_EXTN_CD (+)
            AND CE.EZCANCELFLAG (+)     = '0'
            AND ROWNUM                  = 1
    </statement>

    <statement id="getVendorInfo" parameterClass="Map" resultClass="Map">
        SELECT
            V.VND_CD
           ,PV.PRNT_VND_NM LOC_NM
           ,V.FIRST_LINE_ADDR
           ,V.CTY_ADDR
           ,V.ST_CD
           ,V.POST_CD
        FROM
            VND V
           ,PRNT_VND PV
        WHERE
                V.EZCANCELFLAG   = '0'
            AND V.GLBL_CMPY_CD   = #glblCmpyCd#
            AND V.ARCS_SPLY_SITE_CD = #arcsSplySiteCd#
            AND V.RGTN_STS_CD    = #rgtnStsCd#
            AND V.EFF_FROM_DT    &lt;= #slsDt#
            AND (V.EFF_THRU_DT   &gt;= #slsDt# OR V.EFF_THRU_DT IS NULL)
            AND V.EZCANCELFLAG = PV.EZCANCELFLAG
            AND V.GLBL_CMPY_CD = PV.GLBL_CMPY_CD
            AND V.PRNT_VND_PK = PV.PRNT_VND_PK
            AND PV.PRNT_VND_CD = #prntVndCd#
            AND ROWNUM           = 1
    </statement>

    <statement id="getCsmpContrInfo" parameterClass="Map" resultClass="Map">
        SELECT
            CC.CSMP_NUM
           ,CC.PRC_CATG_CD
        FROM
            CSMP_CONTR CC
        WHERE
                CC.EZCANCELFLAG   = '0'
            AND CC.GLBL_CMPY_CD   = #glblCmpyCd#
            AND CC.CSMP_NUM       = #csmpNum#
            AND CC.DS_ACCT_NUM    = #shipToAcctNum#
            AND CC.EFF_FROM_DT    &lt;= #slsDt#
            AND (CC.EFF_THRU_DT   &gt;= #slsDt# OR CC.EFF_THRU_DT IS NULL)
            AND ROWNUM            = 1
    </statement>

    <statement id="getLineBizRoleTpCd" parameterClass="Map" resultClass="Map">
        SELECT
            LBRT.LINE_BIZ_ROLE_TP_CD
        FROM
            DS_ORD_TP_PROC_DFN DOTPD
           ,LINE_BIZ_ROLE_TP LBRT
        WHERE
                DOTPD.EZCANCELFLAG     = '0'
            AND DOTPD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DOTPD.DS_ORD_TP_CD     = #dsOrdTpCd#
            AND DOTPD.GLBL_CMPY_CD     = LBRT.GLBL_CMPY_CD
            AND DOTPD.LINE_BIZ_TP_CD   = LBRT.LINE_BIZ_TP_CD
            AND LBRT.PRIM_REP_ROLE_FLG = #primRepRoleFlg#
            AND LBRT.EZCANCELFLAG      = '0'
            AND ROWNUM                 = 1
    </statement>

    <statement id="getPsnCdByPsnNm" parameterClass="Map" resultClass="Map">
        SELECT
            SP.PSN_CD
        FROM
            S21_PSN SP
        WHERE
                SP.EZCANCELFLAG   = '0'
            AND SP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND UPPER(TRIM(SP.PSN_LAST_NM || ', ' || SP.PSN_FIRST_NM || ' ' || SP.PSN_MID_NM)) = #psnNm#
    </statement>    

    <statement id="getPsnCdByTocNm" parameterClass="Map" resultClass="Map">
        SELECT
            OFA.PSN_CD
        FROM
            TOC T
           ,ORG_FUNC_ASG OFA
        WHERE
                T.EZCANCELFLAG   = '0'
            AND T.GLBL_CMPY_CD   = #glblCmpyCd#
            AND T.TOC_NM = #psnNm#
            AND T.EZCANCELFLAG = OFA.EZCANCELFLAG
            AND T.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD
            AND T.TOC_CD = OFA.TOC_CD
    </statement>
    
    <statement id="getPsnCdByPsnFullNm" parameterClass="Map" resultClass="Map">
        SELECT
            SP.PSN_CD
        FROM
            S21_PSN SP
        WHERE
                SP.EZCANCELFLAG   = '0'
            AND SP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND UPPER(TRIM(SP.PSN_LAST_NM || ', ' || SP.PSN_FIRST_NM || ' ' || SP.PSN_MID_NM)) = #psnNm#
    </statement>
    
    <statement id="getPsnCdByPsnCd" parameterClass="Map" resultClass="Map">
        SELECT
            SP.PSN_CD
        FROM
            S21_PSN SP
        WHERE
                SP.EZCANCELFLAG   = '0'
            AND SP.GLBL_CMPY_CD   = #glblCmpyCd#
            AND SP.PSN_CD = #psnCd#
    </statement>
    
    <statement id="getDefaultMaintenanceCustomer" parameterClass="Map" resultClass="Map">
        SELECT
            CSDCD.CONTR_LEASE_DS_ACCT_NUM
           ,CSDCD.CONTR_LEASE_BILL_TO_CUST_CD
        FROM
            CPO_SVC_DEF_CUST_DECN CSDCD
        WHERE
                CSDCD.EZCANCELFLAG   = '0'
            AND CSDCD.GLBL_CMPY_CD    = #glblCmpyCd#
            AND CSDCD.DS_ORD_CATG_CD  = #dsOrdCatgCd#
            <!-- START 2018/02/06 K.Kojima [QC#23357,ADD] -->
            AND CSDCD.DS_ORD_TP_CD    = #dsOrdTpCd#
            <!-- END 2018/02/06 K.Kojima [QC#23357,ADD] -->
            AND CSDCD.BILL_BY_TP_CD   = #billByTpCd#
    </statement>
    
    <!-- QC#17768 -->
    <!-- QC#24077 -->
    <statement id="getConfigMasterDetailList" parameterClass="Map" resultClass="Map">
        SELECT
            SMM_C.SVC_CONFIG_MSTR_PK
           ,SMM_C.SVC_MACH_MSTR_PK
           ,NVL(OTM.ORD_TAKE_MDSE_CD, SMM_C.MDSE_CD) MDSE_CD
           ,SMM_C.SER_NUM
           ,SCM.MDL_ID
           ,MM.T_MDL_NM MDL_NM
           ,SMM_C.CUR_LOC_NUM INVTY_LOC_CD
           ,CASE WHEN SMM_C.SVC_MACH_USG_STS_CD IN ('10','40') THEN SUBSTR(SMM_C.CUR_LOC_NUM, 1, 3) ELSE NULL END RTL_WH_CD
           ,CASE WHEN SMM_C.SVC_MACH_USG_STS_CD IN ('10','40') THEN SUBSTR(SMM_C.CUR_LOC_NUM, 4, 6) ELSE NULL END RTL_SWH_CD
        FROM
           SVC_MACH_MSTR SMM_P
          ,SVC_MACH_MSTR SMM_C
          ,ORD_TAKE_MDSE OTM
          ,SVC_CONFIG_MSTR SCM
          ,MDL_NM MM
        WHERE
            SMM_P.EZCANCELFLAG = '0'
        AND SMM_P.GLBL_CMPY_CD = #glblCmpyCd#
        AND SMM_P.EFF_FROM_DT    &lt;= #slsDt#
        AND (SMM_P.EFF_THRU_DT   &gt;= #slsDt# OR SMM_P.EFF_THRU_DT IS NULL)
        AND SMM_C.EZCANCELFLAG = '0'
        AND SMM_C.GLBL_CMPY_CD = #glblCmpyCd#
        AND SMM_P.SVC_CONFIG_MSTR_PK = SMM_C.SVC_CONFIG_MSTR_PK
        AND SMM_C.EFF_FROM_DT    &lt;= #slsDt#
        AND (SMM_C.EFF_THRU_DT   &gt;= #slsDt# OR SMM_C.EFF_THRU_DT IS NULL)
        AND OTM.EZCANCELFLAG(+) = '0'
        AND OTM.GLBL_CMPY_CD(+) = #glblCmpyCd#
        AND SUBSTR(SMM_C.MDSE_CD, 1, 8) = OTM.ORD_TAKE_MDSE_CD(+)
        AND SCM.EZCANCELFLAG = '0'
        AND SCM.GLBL_CMPY_CD = #glblCmpyCd#
        AND SMM_C.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK
        AND MM.EZCANCELFLAG(+) = '0'
        AND MM.T_GLBL_CMPY_CD(+) = #glblCmpyCd#
        AND SCM.MDL_ID = MM.T_MDL_ID(+)
        AND SMM_P.SER_NUM = #serNum#
        ORDER BY 
            SMM_C.SVC_CONFIG_MSTR_PK
           ,SMM_C.SVC_MACH_MSTR_PK
    </statement>
    <!-- QC#25324 -->
    <statement id="getConfigMasterDetailListFromConfigID" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.SVC_CONFIG_MSTR_PK
           ,SMM.SVC_MACH_MSTR_PK
           ,NVL(OTM.ORD_TAKE_MDSE_CD, SMM.MDSE_CD) MDSE_CD
           ,SMM.SER_NUM
           ,SCM.MDL_ID
           ,MM.T_MDL_NM MDL_NM
           ,SMM.CUR_LOC_NUM INVTY_LOC_CD
           ,CASE WHEN SMM.SVC_MACH_USG_STS_CD IN ('10','40') THEN SUBSTR(SMM.CUR_LOC_NUM, 1, 3) ELSE NULL END RTL_WH_CD
           ,CASE WHEN SMM.SVC_MACH_USG_STS_CD IN ('10','40') THEN SUBSTR(SMM.CUR_LOC_NUM, 4, 6) ELSE NULL END RTL_SWH_CD
        FROM
           SVC_MACH_MSTR SMM
          ,ORD_TAKE_MDSE OTM
          ,SVC_CONFIG_MSTR SCM
          ,MDL_NM MM
        WHERE
            SMM.EZCANCELFLAG = '0'
        AND SMM.GLBL_CMPY_CD = #glblCmpyCd#
        AND SMM.EFF_FROM_DT    &lt;= #slsDt#
        AND (SMM.EFF_THRU_DT   &gt;= #slsDt# OR SMM.EFF_THRU_DT IS NULL)
        AND OTM.EZCANCELFLAG(+) = '0'
        AND OTM.GLBL_CMPY_CD(+) = #glblCmpyCd#
        AND SUBSTR(SMM.MDSE_CD, 1, 8) = OTM.ORD_TAKE_MDSE_CD(+)
        AND SCM.EZCANCELFLAG = '0'
        AND SCM.GLBL_CMPY_CD = #glblCmpyCd#
        AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK
        AND MM.EZCANCELFLAG(+) = '0'
        AND MM.T_GLBL_CMPY_CD(+) = #glblCmpyCd#
        AND SCM.MDL_ID = MM.T_MDL_ID(+)
        AND SMM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
        ORDER BY 
            SMM.SVC_CONFIG_MSTR_PK
           ,SMM.SVC_MACH_MSTR_PK
    </statement>
    <!-- QC#15539-14 -->
    <statement id="getBillToInfoFromDsAcctNum" parameterClass="Map" resultClass="Map">
        SELECT
             BTC.BILL_TO_CUST_CD
            ,BTC.BILL_TO_CUST_PK
            ,BTC.FIRST_LINE_ADDR
            ,BTC.SCD_LINE_ADDR
            ,BTC.THIRD_LINE_ADDR
            ,BTC.FRTH_LINE_ADDR
            ,BTC.CTY_ADDR
            ,BTC.CNTY_PK
            ,(
                 SELECT
                     C.CNTY_NM
                 FROM
                     CNTY C
                 WHERE
                         C.EZCANCELFLAG = '0'
                     AND C.GLBL_CMPY_CD = #glblCmpyCd#
                     AND C.CNTY_PK      = BTC.CNTY_PK
            ) AS CNTY_NM
            ,BTC.PROV_NM
            ,BTC.ST_CD
            ,BTC.POST_CD
            ,BTC.CTRY_CD
            ,BTC.LOC_NUM
            ,BTC.LOC_NM
            ,BTC.ADDL_LOC_NM
            ,AL.DS_ACCT_NUM
            ,STC.DS_ACCT_NM
            ,1 AS SORTNUM
        FROM
             BILL_TO_CUST BTC
            ,ACCT_LOC     AL
            ,SELL_TO_CUST STC
        WHERE
                BTC.EZCANCELFLAG    = '0'
            AND BTC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND STC.SELL_TO_CUST_CD = #dsAcctNum#
            AND BTC.RGTN_STS_CD     = #rgtnStsCd#
            AND BTC.EFF_FROM_DT     &lt;= #slsDt#
            AND (BTC.EFF_THRU_DT    &gt;= #slsDt# OR BTC.EFF_THRU_DT IS NULL)
            AND BTC.EZCANCELFLAG    = AL.EZCANCELFLAG
            AND BTC.GLBL_CMPY_CD    = AL.GLBL_CMPY_CD
            AND BTC.LOC_NUM         = AL.LOC_NUM
            AND BTC.RGTN_STS_CD     = AL.RGTN_STS_CD
            AND AL.EFF_FROM_DT      &lt;= #slsDt#
            AND (AL.EFF_THRU_DT     &gt;= #slsDt# OR AL.EFF_THRU_DT IS NULL)
            AND AL.EZCANCELFLAG     = STC.EZCANCELFLAG
            AND AL.GLBL_CMPY_CD     = STC.GLBL_CMPY_CD
            AND AL.DS_ACCT_NUM      = STC.SELL_TO_CUST_CD
            AND AL.RGTN_STS_CD      = STC.RGTN_STS_CD
            AND STC.EFF_FROM_DT     &lt;= #slsDt#
            AND (STC.EFF_THRU_DT    &gt;= #slsDt# OR STC.EFF_THRU_DT IS NULL)
            <isNotNull property="primUsgFlg">
            AND BTC.PRIM_USG_FLG = #primUsgFlg#
            </isNotNull>
    </statement>
    <statement id="getAvailableRentalItem" parameterClass="Map" resultClass="Map">
        SELECT
            M.MDSE_CD
        FROM
            ALL_MDSE_V M
        WHERE
            M.GLBL_CMPY_CD = #glblCmpyCd#
        AND M.EZCANCELFLAG = '0'
        AND M.MDSE_CD = #mdseCd#
        AND M.INSTL_BASE_CTRL_FLG = 'Y'
        <isNotNull property="mdseTpCtxTp">
        AND NOT EXISTS (
                SELECT
                    1
                FROM
                    MDSE_TP_VAL_SET MTVS 
                WHERE
                    MTVS.GLBL_CMPY_CD        = M.GLBL_CMPY_CD
                AND MTVS.COA_MDSE_TP_CD      = M.COA_MDSE_TP_CD
                AND MTVS.MDSE_TP_CTX_TP_CD  IN
                <iterate property="mdseTpCtxTp" var="mdseTpCtxTp[]" open=" (" close=")" conjunction=",">
                #mdseTpCtxTp[]#
                </iterate>
                AND MTVS.EZCANCELFLAG        = '0'
        )
        </isNotNull>
    </statement>
    <statement id="getCSANumberByAcctCSMPNum" parameterClass="Map" resultClass="Map">
        SELECT
             CC.DLR_REF_NUM       AS DLR_REF_NUM
            ,CC.PRC_CATG_CD       AS PRC_CATG_CD
        FROM
             CSMP_CONTR       CC
        WHERE
                CC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND CC.EZCANCELFLAG         = '0'
            AND CC.EFF_FROM_DT          &lt;= #slsDt#
            AND (CC.EFF_THRU_DT         &gt;= #slsDt# OR CC.EFF_THRU_DT IS NULL)
            AND CC.DS_ACCT_NUM          = #dsAcctNum#
            AND CC.CSMP_NUM             = #csmpNum#
            AND ROWNUM                  = 1
    </statement>
    <!-- QC#24240 -->
    <statement id="getCSANumberByAcctCSMPNumNull" parameterClass="Map" resultClass="Map">
        SELECT
             CC.DLR_REF_NUM       AS DLR_REF_NUM
            ,CC.PRC_CATG_CD       AS PRC_CATG_CD
        FROM
             CSMP_CONTR       CC
        WHERE
                CC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND CC.EZCANCELFLAG         = '0'
            AND CC.EFF_FROM_DT          &lt;= #slsDt#
            AND (CC.EFF_THRU_DT         &gt;= #slsDt# OR CC.EFF_THRU_DT IS NULL)
            AND CC.DS_ACCT_NUM          = #dsAcctNum#
            AND CC.CSMP_NUM             IS NULL
            AND ROWNUM                  = 1
    </statement>

    <statement id="getDecimalPointDigit" parameterClass="Map" resultClass="Integer">
        SELECT
                  C.AFT_DECL_PNT_DIGIT_NUM
            FROM
                CCY             C
                , GLBL_CMPY     GC
            WHERE
                GC.GLBL_CMPY_CD     = #glblCmpyCd#
                AND GC.EZCANCELFLAG = '0'
                AND GC.GLBL_CMPY_CD = C.GLBL_CMPY_CD
                AND GC.STD_CCY_CD   = C.CCY_CD
                AND C.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getMdlIdFromMdlNm" parameterClass="Map" resultClass="Map">
        SELECT
                  MM.T_MDL_ID   MDL_ID
            FROM
                MDL_NM  MM
            WHERE
                MM.T_GLBL_CMPY_CD   = #glblCmpyCd#
                AND MM.T_MDL_NM     = #mdlNm#
                AND MM.EZCANCELFLAG = '0'
    </statement>
    <!-- QC#24206 -->
    <statement id="getCFSOwner" parameterClass="Map" resultClass="Map">
        SELECT
                STC.SELL_TO_CUST_PK
            FROM
                SVC_MACH_MSTR  SMM
               ,SELL_TO_CUST STC
            WHERE
                SMM.GLBL_CMPY_CD   = #glblCmpyCd#
                AND SMM.EZCANCELFLAG = '0'
                AND SMM.OWNR_ACCT_NUM = STC.SELL_TO_CUST_CD
                AND SMM.SVC_MACH_MSTR_PK = #svcMachMstrPk#
                AND STC.GLBL_CMPY_CD   = #glblCmpyCd#
                AND STC.EZCANCELFLAG = '0'
                AND STC.COA_AFFL_CD = 'ACZ'
    </statement>

</sqlMap>
