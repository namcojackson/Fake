<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWZC167001Query">

    <statement id="countPsnCd" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(AP.AUTH_PSN_ID)
        FROM
            AUTH_PSN AP
        WHERE
            AP.GLBL_CMPY_CD     = #glblCmpyCd#
            AND AP.USR_NM       = #psnCd#
            AND AP.EZCANCELFLAG = '0'
    </statement>

    <statement id="getDefaultCarrCd" parameterClass="Map" resultClass="String">
        SELECT
            CR.CARR_CD
        FROM
            SHPG_SVC_LVL_CARR_RELN CR
        WHERE
            CR.GLBL_CMPY_CD        = #glblCmpyCd#
            AND CR.CARR_SVC_LVL_CD = #carrSvcLvlCd#
            AND CR.EZCANCELFLAG    = '0'
            AND ROWNUM             = #rownum#
    </statement>

    <statement id="getDefaultCarrSvcLvl" parameterClass="Map" resultClass="String">
        SELECT
            PD.DEF_CARR_SVC_LVL_CD
        FROM
            DS_ORD_TP_PROC_DFN    PD
           ,FRT_COND_SVC_LVL_RELN SLR
        WHERE
            PD.GLBL_CMPY_CD     = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND PD.ACTV_FLG     = 'Y'
            AND PD.EFF_FROM_DT  &lt;= #slsDt#
            AND (PD.EFF_THRU_DT &gt;= #slsDt#
                     OR PD.EFF_THRU_DT IS NULL )
            AND PD.EZCANCELFLAG = '0'

            AND PD.GLBL_CMPY_CD     = SLR.GLBL_CMPY_CD 
            AND PD.LINE_BIZ_TP_CD   = SLR.LINE_BIZ_TP_CD 
            AND SLR.FRT_COND_CD     = #frtCondCd#
            AND SLR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
            AND SLR.EZCANCELFLAG    = '0'
            AND ROWNUM              = #rownum#
    </statement>

    <statement id="countSubmitPoNo" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(C.CUST_ISS_PO_NUM)
        FROM
            CPO C
        WHERE
            C.GLBL_CMPY_CD        = #glblCmpyCd#
            AND C.ORD_HDR_STS_CD  &lt;&gt; #ordHdrSts#
            AND C.CUST_ISS_PO_NUM = #custIssPoNum#
            AND C.SELL_TO_CUST_CD = #sellToCustCd#
            AND C.EZCANCELFLAG    = '0'
    </statement>

    <statement id="countSavePoNo" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(SQ.CUST_ISS_PO_NUM)
        FROM 
            SPLY_QUOTE SQ
        WHERE
            SQ.GLBL_CMPY_CD          = #glblCmpyCd#
            AND SQ.SPLY_QUOTE_STS_CD = #splyQuoteSts#
            AND SQ.CUST_ISS_PO_NUM   = #custIssPoNum#
            AND SQ.SELL_TO_CUST_CD   = #sellToCustCd#
            AND SQ.EZCANCELFLAG      = '0'
    </statement>

    <statement id="getAttrbTxt" parameterClass="Map" resultClass="String">
        SELECT
            OCB.FIRST_BIZ_CTX_ATTRB_TXT
        FROM
            ORD_CATG_BIZ_CTX OCB
        WHERE
            OCB.GLBL_CMPY_CD           = #glblCmpyCd#
            AND OCB.ORD_CATG_CTX_TP_CD = #ordCatgCtxTp#
            AND OCB.DS_ORD_CATG_CD     = #dsOrdCatg#
            AND (OCB.DS_ORD_TP_CD      = #dsOrdTp#
                     OR OCB.DS_ORD_TP_CD IS NULL )
            AND (OCB.DS_ORD_RSN_CD     = #dsOrdRsnCd#
                     OR OCB.DS_ORD_RSN_CD IS NULL )
            AND OCB.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getCashOrCcReqFlg" parameterClass="Map" resultClass="String">
        SELECT
            CCP.CASH_OR_CC_REQ_FLG
        FROM
            CUST_CR_PRFL CCP
        WHERE
            CCP.GLBL_CMPY_CD        = #glblCmpyCd#
            AND CCP.BILL_TO_CUST_CD = #billToCustCd#
            AND CCP.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getIntrlFlg" parameterClass="Map" resultClass="String">
        SELECT
            DAC.DS_ACCT_ITRL_FLG
        FROM
            SELL_TO_CUST DAC
        WHERE
            DAC.GLBL_CMPY_CD     = #glblCmpyCd# 
            AND DAC.SELL_TO_CUST_CD  = #sellToCustAcctCd#
            AND DAC.EZCANCELFLAG ='0'
    </statement>

    <statement id="getMdseSts" parameterClass="Map" resultClass="Map">
        SELECT
            MIS.CUST_ORD_ENTRY_AVAL_FLG AS CUST_ORD_ENTRY_AVAL_FLG
           ,MIS.USED_ONLY_AVAL_FLG      AS USED_ONLY_AVAL_FLG
        FROM
            MDSE  DMI
           ,MDSE_ITEM_STS MIS
        WHERE
            DMI.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DMI.MDSE_CD      = #mdseCd#
            AND DMI.EZCANCELFLAG = '0'

            AND DMI.GLBL_CMPY_CD     = MIS.GLBL_CMPY_CD
            AND DMI.MDSE_ITEM_STS_CD = MIS.MDSE_ITEM_STS_CD
            AND MIS.EZCANCELFLAG     = '0'
    </statement>

    <statement id="countCtryCd" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(COR.CTRY_CD)
        FROM
            CTRY_ORIG_RST COR
        WHERE
            COR.GLBL_CMPY_CD         = #glblCmpyCd#
            AND COR.CTRY_CD          = #ctryCd#
            AND (COR.SELL_TO_CUST_CD = #sellToCustCd#
                     OR COR.BILL_TO_CUST_CD = #billToCustCd# )
            AND COR.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getOrdCatgAndTp" parameterClass="Map" resultClass="Map">
        SELECT
            OC.DS_ORD_CATG_CD AS DS_ORD_CATG_CD
           ,OC.DS_ORD_TP_CD   AS DS_ORD_TP_CD
        FROM
            ORD_CATG_BIZ_CTX OC
        WHERE
            OC.GLBL_CMPY_CD           = #glblCmpyCd#
            AND OC.ORD_CATG_CTX_TP_CD = #ctxTpCd#
            AND OC.EZCANCELFLAG       ='0'
    </statement>

    <statement id="getCostPct" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SWH.MDSE_INVTY_COST_PCT
        FROM
            RTL_SWH RS
           ,SWH     SWH
        WHERE
            RS.GLBL_CMPY_CD     = #glblCmpyCd#
            AND RS.RTL_SWH_CD   = #rtlSwh#
            AND RS.EFF_FROM_DT  &lt;= #slsDt#
            AND (RS.EFF_THRU_DT &gt;= #slsDt#
                     OR RS.EFF_THRU_DT IS NULL )
            AND RS.EZCANCELFLAG = '0'

            AND RS.GLBL_CMPY_CD  = SWH.GLBL_CMPY_CD
            AND RS.RTL_SWH_CD    = SWH.RTL_SWH_CD
            AND SWH.EZCANCELFLAG = '0'
    </statement>

    <statement id="getInternalBill" parameterClass="Map" resultClass="String">
        SELECT
            BTC.BILL_TO_CUST_CD
        FROM
            BILL_TO_CUST BTC
        WHERE
            BTC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND BTC.BILL_TO_CUST_CD = #billToCustCd#
            AND BTC.RGTN_STS_CD     = #rgtnSts#
            AND BTC.BIZ_RELN_TP_CD  = #retnTpCd#
            AND BTC.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getSaleableSell" parameterClass="Map" resultClass="String">
        SELECT
            STC.SELL_TO_CUST_CD
        FROM
            SELL_TO_CUST STC
        WHERE
            STC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND STC.SELL_TO_CUST_CD = #sellToCust#
            AND STC.RGTN_STS_CD     = #rgtnSts#
            AND STC.SELL_HLD_FLG    = 'Y'
            AND STC.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getEmbargoFlag" parameterClass="Map" resultClass="String">
        SELECT
            STC.EMBGO_FLG
        FROM
            SHIP_TO_CUST STC
        WHERE
            STC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD = #shipToCust#
            AND STC.RGTN_STS_CD     = #rgtnSts#
            AND STC.EMBGO_FLG       = 'Y'
            AND STC.EZCANCELFLAG    = '0'
    </statement>

    <statement id="cntAvalWarehouse" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(WH.WH_CD) 
        FROM
            DS_ORD_TP_LOC_ROLE_RELN DLR
           ,LOC_USG                 LU
           ,WH                      WH
        WHERE
            DLR.GLBL_CMPY_CD     = #glblCmpyCd#
            AND DLR.DS_ORD_TP_CD = #dsOrdTpCd#
            AND DLR.EZCANCELFLAG = '0'

            AND DLR.GLBL_CMPY_CD   = LU.GLBL_CMPY_CD
            AND DLR.LOC_ROLE_TP_CD = LU.LOC_ROLE_TP_CD
            AND LU.EZCANCELFLAG    = '0'

            AND LU.GLBL_CMPY_CD = WH.GLBL_CMPY_CD
            AND LU.PTY_LOC_PK   = WH.PTY_LOC_PK
            AND WH.WH_CD        = #invtyLocCd#
            AND WH.EZCANCELFLAG = '0'
    </statement>

<!-- 2017/08/09 QC#8598 Del Start -->
<!--    <statement id="getShipToInfo" parameterClass="Map" resultClass="Map"> -->
<!--        SELECT                                                            -->
<!--            STC.SELL_TO_CUST_CD                                           -->
<!--           ,STC.LOC_NUM                                                   -->
<!--        FROM                                                              -->
<!--            SHIP_TO_CUST STC                                              -->
<!--        WHERE                                                             -->
<!--            STC.GLBL_CMPY_CD        = #glblCmpyCd#                        -->
<!--            AND STC.SHIP_TO_CUST_CD = #shipToCustCd#                      -->
<!--            AND STC.RGTN_STS_CD     = #rgtnSts#                           -->
<!--            AND STC.EZCANCELFLAG    = '0'                                 -->
<!--            AND ROWNUM              = #rowNum#                            -->
<!--    </statement>                                                          -->
<!-- 2017/08/09 QC#8598 Del End -->
</sqlMap>
