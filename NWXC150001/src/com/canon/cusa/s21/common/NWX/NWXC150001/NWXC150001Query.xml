<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<sqlMap namespace="NWXC150001Query">

    <statement id="getDefaultAcctFromShipToCust" parameterClass="Map" resultClass="String">
        SELECT
                  S.SELL_TO_CUST_CD
            FROM
                SHIP_TO_CUST    S
            WHERE
                S.GLBL_CMPY_CD        = #glblCmpyCd#
                AND S.SHIP_TO_CUST_CD = #shipToCustCd#
                AND S.RGTN_STS_CD     = #rgtnStsCd#
                AND S.EZCANCELFLAG    = '0'
                AND ROWNUM            = $rownum$
    </statement>

    <statement id="getDefaultAcctFromBillToCust" parameterClass="Map" resultClass="String">
        SELECT
                BTC.SELL_TO_CUST_CD
            FROM
                BILL_TO_CUST      BTC
            WHERE
                BTC.GLBL_CMPY_CD        = #glblCmpyCd#
                AND BTC.BILL_TO_CUST_CD = #billToCustCd#
                AND BTC.RGTN_STS_CD     = #rgtnStsCd#
                AND BTC.EZCANCELFLAG    = '0'
                AND ROWNUM              = $rownum$
    </statement>

    <statement id="getDefaultAcctPmtTerm" parameterClass="Map" resultClass="Map">
        SELECT
                  DACP.PMT_TERM_CASH_DISC_CD 
            FROM
                DS_ACCT_CR_PRFL DACP
            WHERE
                DACP.GLBL_CMPY_CD        = #glblCmpyCd#
                AND DACP.DS_ACCT_NUM     = #dsAcctNum#
                AND DACP.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getDefaultLocPmtTerm" parameterClass="Map" resultClass="Map">
        SELECT
                CCP.PMT_TERM_CASH_DISC_CD
            FROM
                CUST_CR_PRFL      CCP
            WHERE
                CCP.GLBL_CMPY_CD        = #glblCmpyCd#
                AND CCP.BILL_TO_CUST_CD = #billToCustCd#
                AND CCP.EZCANCELFLAG    = '0' 
    </statement>

    <statement id="checkCpoOrdTpAndDsOrdRsnRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(PD.GLBL_CMPY_CD)
            FROM
                DS_ORD_TP_PROC_DFN PD
                , DS_ORD_RSN       DOR 
            WHERE
                PD.GLBL_CMPY_CD          = #glblCmpyCd#
                AND PD.DS_ORD_TP_CD      = #dsOrdTpCd#
                AND PD.ACTV_FLG          = 'Y' 
                AND PD.EFF_FROM_DT      &lt;= #slsDt#
                AND (
                    PD.EFF_THRU_DT      &gt;= #slsDt#
                 OR PD.EFF_THRU_DT      IS NULL
                    )
                AND PD.EZCANCELFLAG      = '0' 
                AND PD.GLBL_CMPY_CD      = DOR.GLBL_CMPY_CD 
                AND PD.DS_ORD_RSN_GRP_CD = DOR.DS_ORD_RSN_GRP_CD 
                AND DOR.DS_ORD_RSN_CD    = #dsOrdRsnCd#
                AND DOR.EZCANCELFLAG     = '0'
    </statement>

    <statement id="checkBillToRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(BT.GLBL_CMPY_CD)
            FROM
                BILL_TO_CUST      BT
            WHERE
                BT.GLBL_CMPY_CD         = #glblCmpyCd#
                AND BT.BILL_TO_CUST_CD  = #billToCustCd#
                AND BT.RGTN_STS_CD      = #rgtnStsCd#
                AND BT.EZCANCELFLAG     = '0'
                AND BT.SELL_TO_CUST_CD = #sellToCustCd#
    </statement>

    <statement id="checkShipToRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(ST.GLBL_CMPY_CD)
            FROM
                SHIP_TO_CUST ST
            WHERE
                ST.GLBL_CMPY_CD        = #glblCmpyCd#
                AND ST.SHIP_TO_CUST_CD = #shipToCustCd#
                AND ST.SELL_TO_CUST_CD = #sellToCustCd#
                AND ST.RGTN_STS_CD     = #rgtnStsCd#
                AND ST.EZCANCELFLAG    = '0'
    </statement>

    <statement id="checkSoldToRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(BT.GLBL_CMPY_CD)
            FROM
                BILL_TO_CUST      BT
            WHERE
                BT.GLBL_CMPY_CD         = #glblCmpyCd#
                AND BT.BILL_TO_CUST_CD  = #billToCustCd#
                AND BT.RGTN_STS_CD      = #rgtnStsCd#
                AND BT.EZCANCELFLAG     = '0'
                AND BT.SELL_TO_CUST_CD  = #sellToCustCd#
    </statement>

    <statement id="checkCarrSvcLvlAndShpgSvcLvlRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(CR.GLBL_CMPY_CD)
            FROM
                SHPG_SVC_LVL_CARR_RELN CR 
            WHERE
                CR.GLBL_CMPY_CD        = #glblCmpyCd#
                AND CR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                AND CR.CARR_SVC_LVL_CD = #carrSvcLvlCd#
                AND CR.EZCANCELFLAG    = '0'
    </statement>

    <statement id="checkFrtCondSvcLvlRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(FR.GLBL_CMPY_CD)
            FROM
                FRT_COND_SVC_LVL_RELN FR
                <!-- 2018/12/10 S21_NA#29315 Add Start -->
                <isNotNull property="carrSvcLvlCd">
                <isNotNull property="notCollect">
                ,SHPG_SVC_LVL_CARR_RELN SSL
                , (
                    SELECT
                        DAC.VND_CD
                    FROM
                        DS_ACCT_CARR DAC
                    WHERE
                            DAC.GLBL_CMPY_CD = #glblCmpyCd#
                        AND DAC.DS_ACCT_NUM  IS NULL
                        AND DAC.LOC_NUM     = #locNum#
                        AND DAC.EFF_FROM_DT &lt;= #slsDt#
                        AND (DAC.EFF_THRU_DT &gt;= #slsDt#
                         OR DAC.EFF_THRU_DT IS NULL)
                        AND DAC.LINE_BIZ_TP_CD = #lineBizTpCd#
                        AND DAC.DS_BIZ_AREA_CD = #dsBizAreaCd#
                        AND DAC.EZCANCELFLAG = '0'

                    UNION ALL

                    SELECT
                        DAC.VND_CD
                    FROM
                        DS_ACCT_CARR DAC
                    WHERE
                            DAC.GLBL_CMPY_CD = #glblCmpyCd#
                        AND DAC.DS_ACCT_NUM  = #dsAcctNum#
                        AND DAC.LOC_NUM     IS NULL
                        AND DAC.EFF_FROM_DT &lt;= #slsDt#
                        AND (DAC.EFF_THRU_DT &gt;= #slsDt#
                         OR DAC.EFF_THRU_DT IS NULL)
                        AND DAC.LINE_BIZ_TP_CD = #lineBizTpCd#
                        AND DAC.DS_BIZ_AREA_CD = #dsBizAreaCd#
                        AND DAC.EZCANCELFLAG = '0'

                        AND NOT EXISTS (
                            SELECT
                                1
                            FROM
                                DS_ACCT_CARR DAC2
                            WHERE
                                    DAC2.GLBL_CMPY_CD = DAC.GLBL_CMPY_CD
                                AND DAC2.LOC_NUM       = #locNum#
                                AND DAC2.EFF_FROM_DT &lt;= #slsDt#
                                AND (DAC2.EFF_THRU_DT &gt;= #slsDt#
                                 OR DAC2.EFF_THRU_DT IS NULL)
                                AND DAC2.LINE_BIZ_TP_CD = DAC.LINE_BIZ_TP_CD
                                AND DAC2.DS_BIZ_AREA_CD = DAC.DS_BIZ_AREA_CD
                                AND DAC2.EZCANCELFLAG   = DAC.EZCANCELFLAG
                            )
                    )DACV
               </isNotNull>
               </isNotNull>
               <!-- 2018/12/10 S21_NA#29315 Add End -->
            WHERE
                FR.GLBL_CMPY_CD       = #glblCmpyCd#
                AND FR.LINE_BIZ_TP_CD = #lineBizTpCd#
                AND FR.FRT_COND_CD     = #frtCondCd#
                AND FR.SHPG_SVC_LVL_CD = #shpgSvcLvlCd#
                <isNotNull property="carrSvcLvlCd">
                AND FR.CARR_SVC_LVL_CD = #carrSvcLvlCd#
                </isNotNull>
                AND FR.EZCANCELFLAG    = '0'
                <!-- 2018/12/10 S21_NA#29315 Add Start -->
                <isNotNull property="carrSvcLvlCd">
                <isNotNull property="notCollect">
                AND FR.GLBL_CMPY_CD    = SSL.GLBL_CMPY_CD
                AND FR.SHPG_SVC_LVL_CD = SSL.SHPG_SVC_LVL_CD
                AND FR.CARR_SVC_LVL_CD = SSL.CARR_SVC_LVL_CD
                AND SSL.EZCANCELFLAG   = '0'

                AND SSL.CARR_CD        = DACV.VND_CD
                </isNotNull>
                </isNotNull>
               <!-- 2018/12/10 S21_NA#29315 Add End -->
    </statement>

    <statement id="checkCsmpRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(CC.GLBL_CMPY_CD)
            FROM
                CSMP_CONTR CC 
            WHERE
                CC.GLBL_CMPY_CD     = #glblCmpyCd#
                AND CC.CSMP_NUM     = #csmpNum#
                AND CC.DS_ACCT_NUM  = #dsAcctNum#
                AND CC.EZCANCELFLAG = '0'
    </statement>

    <statement id="checkCsaNumRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(CC.GLBL_CMPY_CD)
            FROM
                CSMP_CONTR CC 
            WHERE
                CC.GLBL_CMPY_CD     = #glblCmpyCd#
                AND CC.DLR_REF_NUM  = #dlrRefNum#
                AND CC.DS_ACCT_NUM  = #dsAcctNum#
                AND CC.EZCANCELFLAG = '0'
    </statement>

    <statement id="checkSalesRepRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(O.GLBL_CMPY_CD)
            FROM
                S21_ORG            O
                , ORG_FUNC_ROLE_TP RT
                , BIZ_AREA_ORG     BAO
            WHERE
                O.GLBL_CMPY_CD            = #glblCmpyCd#
                AND O.TOC_CD              = #slsRepCd#
                AND O.EZCANCELFLAG        = '0'
                AND O.GLBL_CMPY_CD        = RT.GLBL_CMPY_CD
                AND O.ORG_FUNC_ROLE_TP_CD = RT.ORG_FUNC_ROLE_TP_CD
                AND RT.SLS_REP_FLG        = 'Y'
                AND RT.EZCANCELFLAG       = '0'
                AND O.GLBL_CMPY_CD        = BAO.GLBL_CMPY_CD
                AND O.FIRST_ORG_CD        = BAO.BIZ_AREA_ORG_CD
                AND BAO.SLS_FLG           = 'Y'
                AND BAO.ORG_STRU_TP_CD    = #orgStruTpCd#
                AND BAO.EZCANCELFLAG      = '0'
    </statement>

    <statement id="checkConfigShiptoLocation" parameterClass="Map" resultClass="String">
        SELECT
                  SMM.CUR_LOC_NUM
            FROM
                SVC_CONFIG_MSTR SCM
                , SVC_MACH_MSTR SMM
            WHERE
                SCM.GLBL_CMPY_CD            = #glblCmpyCd#
                AND SCM.SVC_CONFIG_MSTR_PK  = #svcConfigMstrPk#
                AND SCM.EZCANCELFLAG        = '0' 
                AND SCM.GLBL_CMPY_CD        = SMM.GLBL_CMPY_CD
                AND SCM.SVC_MACH_MSTR_PK    = SMM.SVC_MACH_MSTR_PK
                AND SMM.EZCANCELFLAG        = '0'
    </statement>

    <statement id="checkRetailWhRelation" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(RSW.GLBL_CMPY_CD) 
            FROM
                DS_ORD_TP_LOC_ROLE_RELN LR
                , LOC_USG               LU
                , WH                    WH
                , RTL_SWH               RSW
                , RTL_WH                RW
            WHERE
                LR.GLBL_CMPY_CD          = #glblCmpyCd#
                AND LR.DS_ORD_TP_CD      = #dsOrdTpCd#
                AND LR.EZCANCELFLAG      = '0'
                AND LR.GLBL_CMPY_CD      = LU.GLBL_CMPY_CD
                AND LR.LOC_ROLE_TP_CD    = LU.LOC_ROLE_TP_CD
                AND LU.EZCANCELFLAG      = '0'
                AND LU.GLBL_CMPY_CD      = WH.GLBL_CMPY_CD
                AND LU.PTY_LOC_PK        = WH.PTY_LOC_PK
                AND WH.RGTN_STS_CD       = #rgtnStsCd#
                AND WH.EFF_FROM_DT      &lt;= #slsDt#
                AND (
                    WH.EFF_THRU_DT      &gt;= #slsDt#
                 OR WH.EFF_THRU_DT      IS NULL
                    )
                AND WH.EZCANCELFLAG      = '0'
                AND WH.GLBL_CMPY_CD      = RSW.GLBL_CMPY_CD
                AND WH.WH_CD             = RSW.INVTY_LOC_CD
                AND RSW.RTL_WH_CD        = #rtlWhCd#
                AND RSW.RTL_SWH_CD       = #rtlSwhCd#
                AND RSW.RTL_SWH_DSBL_FLG = 'N'
                AND RSW.EFF_FROM_DT     &lt;= #slsDt#
                AND (
                    RSW.EFF_THRU_DT     &gt;= #slsDt#
                 OR RSW.EFF_THRU_DT     IS NULL
                    )
                AND RSW.EZCANCELFLAG     = '0'
                AND RSW.GLBL_CMPY_CD     = RW.GLBL_CMPY_CD
                AND RSW.RTL_WH_CD        = RW.RTL_WH_CD
                AND RW.EFF_FROM_DT      &lt;= #slsDt#
                AND (
                    RW.EFF_THRU_DT      &gt;= #slsDt#
                 OR RW.EFF_THRU_DT      IS NULL
                    )
                AND RW.EZCANCELFLAG      = '0'
    </statement>

    <statement id="getSerNumInfo" parameterClass="Map" resultClass="Map">
        SELECT
                  SMM.SVC_MACH_USG_STS_CD
                , SMM.SVC_MACH_MSTR_STS_CD
                , SMM.SVC_MACH_MAINT_AVAL_FLG AS ALLC_FLG
                , SMM.CPO_ORD_NUM
                , SMM.CPO_DTL_LINE_NUM
                , SMM.CPO_DTL_LINE_SUB_NUM
                , SMM.SVC_CONFIG_MSTR_PK
                , SMM.CUR_LOC_NUM
                , SMM.SVC_MACH_MSTR_PK <!-- 2016/04/22 S21_NA#7449 Add -->
                , SMM.CUR_LOC_NUM 
                <!-- 2016/04/19 S21_NA#7271 ADD START -->
                <!-- 2016/09/05 S21_NA#12435 MOD START -->
                , NVL(SMM.TRX_HDR_NUM, SMM.RMA_NUM)               TRX_HDR_NUM
                , NVL(SMM.TRX_LINE_NUM, SMM.RMA_LINE_NUM)         TRX_LINE_NUM
                , NVL(SMM.TRX_LINE_SUB_NUM, SMM.RMA_LINE_SUB_NUM) TRX_LINE_SUB_NUM
                <!-- 2016/09/05 S21_NA#12435 MOD END -->
                <!-- 2016/04/19 S21_NA#7271 ADD END -->
                <!-- 2017/12/21 S21_NA#20050 Add Start -->
                , SMM.OWNR_ACCT_NUM
                <!-- 2017/12/21 S21_NA#20050 Add END -->
                <!-- , DCRD.RTRN_LINE_STS_CD  2019/01/21 S21_NA#29983 Add 2019/04/10 S21_NA#31140 Del -->  
            FROM
                SVC_MACH_MSTR SMM 
                <!-- ,DS_CPO_RTRN_DTL DCRD  2019/01/21 S21_NA#29983 Add 2019/04/10 S21_NA#31140 Del -->
            WHERE
                SMM.GLBL_CMPY_CD     = #glblCmpyCd#
                <isNotNull property="serNum">                    <!-- 2016/06/02 S21_NA#9273 Add -->
                   AND SMM.SER_NUM      = #serNum#
                   <isNotNull property="mdseCd">                 <!-- 2017/02/15 QC#16575 ADD START -->
                   AND SMM.MDSE_CD      LIKE #mdseCd# || '%'
                   </isNotNull>                                  <!-- 2017/02/15 QC#16575 ADD E N D -->

                </isNotNull>                                     <!-- 2016/06/02 S21_NA#9273 Add -->
                <isNull property="serNum">                       <!-- 2016/06/02 S21_NA#9273 Add -->
                   <isNotNull property="svcMachMstrPk">          <!-- 2016/06/02 S21_NA#9273 Add -->
                      AND SMM.SVC_MACH_MSTR_PK = #svcMachMstrPk# <!-- 2016/06/02 S21_NA#9273 Add -->
                   </isNotNull>                                  <!-- 2016/06/02 S21_NA#9273 Add -->
                </isNull>                                        <!-- 2016/06/02 S21_NA#9273 Add -->
                AND SMM.EZCANCELFLAG = '0'
                <!-- 2019/04/10 S21_NA#31140 Del Start -->
                <!-- 2019/01/21 S21_NA#29983 Add Start -->
                <!-- AND SMM.GLBL_CMPY_CD     = DCRD.GLBL_CMPY_CD(+) -->
                <!-- AND SMM.RMA_NUM          = DCRD.CPO_ORD_NUM(+) -->
                <!-- AND SMM.RMA_LINE_NUM     = DCRD.DS_CPO_RTRN_LINE_NUM(+) -->
                <!-- AND SMM.RMA_LINE_SUB_NUM = DCRD.DS_CPO_RTRN_LINE_SUB_NUM(+) -->
                <!-- AND DCRD.EZCANCELFLAG(+)  = '0' -->
                <!-- 2019/01/21 S21_NA#29983 Add End -->
                <!-- 2019/04/10 S21_NA#31140 Del Start -->
    </statement>

    <statement id="getRtlSwhInfo" parameterClass="Map" resultClass="Map">
        SELECT
                  RS.RTL_WH_CD
                , RS.RTL_SWH_CD 
            FROM
                RTL_SWH RS 
            WHERE
                RS.GLBL_CMPY_CD     = #glblCmpyCd#
                AND RS.INVTY_LOC_CD = #invtyLocCd#
                AND RS.EZCANCELFLAG = '0'
    </statement>

    <statement id="getSbstRelation" parameterClass="Map" resultClass="String">
        SELECT
                MDSE_CD 
            FROM (
                SELECT 
                     V.MDSE_CD
                  FROM 
                     ALL_MDSE_V V
                 WHERE 
                       V.GLBL_CMPY_CD = #glblCmpyCd#
                   AND V.RGTN_STS_CD = #rgtnStsCd#
                   <!-- 2017/06/14 S21_NA#18623 Add Start -->
                   AND V.SELL_HLD_FLG = 'N'
                   <!-- 2017/06/14 S21_NA#18623 Add End -->
                   AND V.MDSE_CD IN (
                        SELECT
                                SR.SUPD_TO_MDSE_CD SBST_MDSE_CD
                            FROM
                                SUPD_RELN       SR
                                ,ORD_TAKE_MDSE  OTM
                            WHERE
                                SR.GLBL_CMPY_CD          = #glblCmpyCd#
                                AND SR.EZCANCELFLAG      = '0'
                                <!-- 2017/06/14 S21_NA#18623 Mod Start -->
                                <!-- AND SUBSTR(SR.SUPD_FROM_MDSE_CD, 0, 8) = #mdseCd# -->
                                <!--  AND SUBSTR(SR.SUPD_TO_MDSE_CD, 0, 8)   = #sbstMdseCd# -->
                                AND SUBSTR(SR.SUPD_FROM_MDSE_CD, 1, 8) = #mdse8LenCd#
                                AND SUBSTR(SR.SUPD_TO_MDSE_CD, 1, 8)   = #sbstMdse8LenCd#
                                <!-- 2017/06/14 S21_NA#18623 Mod Start -->
                                AND SR.GLBL_CMPY_CD     = OTM.GLBL_CMPY_CD
                                AND SR.EZCANCELFLAG     = OTM.EZCANCELFLAG
                                AND SUBSTR(SR.SUPD_TO_MDSE_CD, 1, 8) = OTM.ORD_TAKE_MDSE_CD
                        UNION ALL
                            SELECT
                                    FS.RELN_MDSE_CD SBST_MDSE_CD
                                FROM
                                    MDSE_ITEM_FLIP_SET FS
                                    ,ORD_TAKE_MDSE  OTM
                                WHERE
                                    FS.GLBL_CMPY_CD     = #glblCmpyCd#
                                    AND FS.EZCANCELFLAG = '0'
                                    <!-- 2017/06/14 S21_NA#18623 Mod Start -->
                                    <!-- AND SUBSTR(FS.MDSE_CD, 0, 8)      = #mdseCd# -->
                                    <!-- AND SUBSTR(FS.RELN_MDSE_CD, 0, 8) = #sbstMdseCd# -->
                                    AND SUBSTR(FS.MDSE_CD, 1, 8)      = #mdse8LenCd#
                                    AND SUBSTR(FS.RELN_MDSE_CD, 1, 8) = #sbstMdse8LenCd#
                                    <!-- 2017/06/14 S21_NA#18623 Mod End -->
                                    AND FS.GLBL_CMPY_CD     = OTM.GLBL_CMPY_CD
                                    AND FS.EZCANCELFLAG     = OTM.EZCANCELFLAG
                                    AND SUBSTR(FS.RELN_MDSE_CD, 1, 8) = OTM.ORD_TAKE_MDSE_CD
                        UNION ALL
                            SELECT
                                    SR.SUPD_TO_MDSE_CD SBST_MDSE_CD
                                FROM
                                    SUPD_RELN       SR
                                WHERE
                                    SR.GLBL_CMPY_CD          = #glblCmpyCd#
                                    AND SR.EZCANCELFLAG      = '0'
                                    AND SR.SUPD_FROM_MDSE_CD = #mdseCd#
                                    AND SR.SUPD_TO_MDSE_CD   = #sbstMdseCd#
                        UNION ALL
                            SELECT
                                    FS.RELN_MDSE_CD SBST_MDSE_CD
                                FROM
                                    MDSE_ITEM_FLIP_SET FS
                                WHERE
                                    FS.GLBL_CMPY_CD     = #glblCmpyCd#
                                    AND FS.EZCANCELFLAG = '0'
                                    AND FS.MDSE_CD      = #mdseCd#
                                    AND FS.RELN_MDSE_CD = #sbstMdseCd#
            )
        )
<!-- 2016/03/05 S21_NA#1698 Mod Start
       SELECT 
             COUNT(MDSE_CD) 
          FROM (
                SELECT 
                     V.MDSE_CD
                  FROM 
                     ALL_MDSE_V V
                 WHERE 
                       V.GLBL_CMPY_CD = #glblCmpyCd#
                   AND V.RGTN_STS_CD = #rgtnStsCd#
                   AND V.MDSE_CD IN (
                              SELECT 
                                   SUPD.SUPD_TO_MDSE_CD
                                FROM 
                                   SUPD_RELN SUPD
                               WHERE 
                                     SUPD.GLBL_CMPY_CD = V.GLBL_CMPY_CD
                                 AND SUPD.SUPD_FROM_MDSE_CD = #mdseCd#
                                 AND SUPD.EZCANCELFLAG = '0'
                              UNION
                              SELECT 
                                   SUPD.SUPD_TO_MDSE_CD
                                FROM 
                                   ORD_TAKE_MDSE OTM ,
                                   SUPD_RELN SUPD
                               WHERE 
                                     OTM.GLBL_CMPY_CD = V.GLBL_CMPY_CD
                                 AND OTM.ORD_TAKE_MDSE_CD = #mdseCd#
                                 AND OTM.EZCANCELFLAG = '0'
                                 AND OTM.GLBL_CMPY_CD = SUPD.GLBL_CMPY_CD
                                 AND OTM.MDSE_CD = SUPD.SUPD_FROM_MDSE_CD
                                 AND SUPD.EZCANCELFLAG = '0'
                              UNION
                              SELECT 
                                   NVL(OTM.ORD_TAKE_MDSE_CD, FLIP.RELN_MDSE_CD)
                                FROM MDSE_ITEM_FLIP_SET FLIP ,
                                   ORD_TAKE_MDSE OTM
                               WHERE 
                                     FLIP.GLBL_CMPY_CD = V.GLBL_CMPY_CD
                                 AND FLIP.MDSE_CD = #mdseCd#
                                 AND FLIP.EZCANCELFLAG = '0'
                                 AND OTM.GLBL_CMPY_CD(+) = FLIP.GLBL_CMPY_CD
                                 AND OTM.ORD_TAKE_MDSE_CD(+) = SUBSTR(FLIP.RELN_MDSE_CD, 1, 8)
                                 AND OTM.EZCANCELFLAG(+) = '0'
                              UNION
                              SELECT 
                                   OTM.ORD_TAKE_MDSE_CD
                                FROM 
                                   MDSE_ITEM_FLIP_SET FLIP ,
                                   ORD_TAKE_MDSE OTM
                               WHERE 
                                     FLIP.GLBL_CMPY_CD = V.GLBL_CMPY_CD
                                 AND FLIP.MDSE_CD LIKE SUBSTR(#mdseCd#, 1, 8) || '%'
                                 AND FLIP.EZCANCELFLAG = '0'
                                 AND OTM.GLBL_CMPY_CD = FLIP.GLBL_CMPY_CD
                                 AND OTM.ORD_TAKE_MDSE_CD = SUBSTR(FLIP.RELN_MDSE_CD, 1, 8)
                                 AND OTM.EZCANCELFLAG = '0')
                AND V.EZCANCELFLAG = '0'
        ) WHERE 
              MDSE_CD LIKE #sbstMdseCd# -->
    </statement>

    <statement id="getLineStatus" parameterClass="Map" resultClass="String">
        SELECT
                  CD.ORD_LINE_STS_CD 
            FROM
                CPO_DTL CD 
            WHERE
                    CD.GLBL_CMPY_CD          = #glblCmpyCd#
                AND CD.CPO_ORD_NUM           = #cpoOrdNum#
                AND CD.DS_ORD_POSN_NUM       = #dsOrdPosnNum#
                AND CD.DS_CPO_LINE_NUM       = #dsCpoLineNum#
                AND CD.DS_CPO_LINE_SUB_NUM  IS NULL
                AND CD.EZCANCELFLAG          = '0'
    </statement>

    <statement id="getLineStatusForInbound" parameterClass="Map" resultClass="String">
        SELECT
                  DCRD.RTRN_LINE_STS_CD 
            FROM
                DS_CPO_RTRN_DTL DCRD
            WHERE
                    DCRD.GLBL_CMPY_CD        = #glblCmpyCd#
                AND DCRD.CPO_ORD_NUM         = #cpoOrdNum#
                AND DCRD.DS_ORD_POSN_NUM     = #dsOrdPosnNum#
                AND DCRD.DS_CPO_LINE_NUM     = #dsCpoLineNum#
               <isNull property="dsCpoLineSubNum">
                AND DCRD.DS_CPO_LINE_SUB_NUM IS NULL
               </isNull>
               <isNotNull property="dsCpoLineSubNum">
                AND DCRD.DS_CPO_LINE_SUB_NUM = #dsCpoLineSubNum#
               </isNotNull>
                AND DCRD.EZCANCELFLAG        = '0'
    </statement>

    <statement id="getDealWhMapping" parameterClass="Map" resultClass="Map">
        SELECT
                  VS.DS_ORD_LINE_CATG_CD
                , VS.SCD_BIZ_CTX_ATTRB_TXT 
            FROM
                ORD_LINE_VAL_SET VS 
            WHERE
                VS.GLBL_CMPY_CD           = #glblCmpyCd#
                AND VS.ORD_LINE_CTX_TP_CD = #forceDummyWh#
                AND VS.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getAllocQty" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                  NVL(SUM(SP.ORD_QTY), 0) ORD_QTY
            FROM
                SHPG_PLN SP
               <!-- 2019/11/27 QC#52339 Add Start -->
               ,MDSE     M
               <!-- 2019/11/27 QC#52339 Add End -->
            WHERE
                SP.GLBL_CMPY_CD              = #glblCmpyCd#
                AND SP.TRX_HDR_NUM           = #trxHdrNum#
                AND SP.TRX_LINE_NUM          = #trxLineNum#
                AND SP.TRX_LINE_SUB_NUM      = #trxLineSubNum#
                <!-- Mod Start 2019/02/21 QC#29713 -->
                <!-- AND SP.SHPG_STS_CD      NOT IN (#validated#, #cancelled#) -->
                <!-- Mod Start 2019/03/11 QC#30629 -->
                <!-- AND SP.SHPG_STS_CD      NOT IN (#validated#, #cancelled#, #poCancelled#) -->
                <!-- 2019/11/27 QC#52339 Del Start -->
                <!-- AND SP.SHPG_STS_CD      NOT IN (#validated#, #cancelled#, #poCancelled#, #soCancelled#) -->
                <!-- 2019/11/27 QC#52339 Del End -->
                <!-- Mod End 2019/03/11 QC#30629 -->
                <!-- Mod End 2019/02/21 QC#29713 -->
                AND SP.EZCANCELFLAG          = '0'
                <!-- 2019/11/27 QC#52339 Add Start -->
                AND SP.GLBL_CMPY_CD = M.GLBL_CMPY_CD
                AND SP.MDSE_CD = M.MDSE_CD
                AND M.EZCANCELFLAG = '0'
                AND ((M.INVTY_CTRL_FLG =  #invtyCtrlFlgY# AND SP.SHPG_STS_CD NOT IN (#validated#, #cancelled#, #poCancelled#, #soCancelled#)
                     ) OR (
                      M.INVTY_CTRL_FLG =  #invtyCtrlFlgN# AND SP.SHPG_STS_CD IN (#invoiced#)
                    ))
                <!-- 2019/11/27 QC#52339 Add End -->
    </statement>

    <statement id="checkDiChecked" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(DI.GLBL_CMPY_CD) CNT
            FROM
                DS_CPO_DI_CHK_RSLT_HDR DI 
            WHERE
                DI.GLBL_CMPY_CD         = #glblCmpyCd#
                AND DI.CPO_ORD_NUM      = #cpoOrdNum#
                AND DI.CPO_UPD_VRSN_NUM = #cpoUpdVrsnNum#
                AND DI.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getActiveLineCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(CD.GLBL_CMPY_CD) 
            FROM
                CPO_DTL CD 
            WHERE
                CD.GLBL_CMPY_CD             = #glblCmpyCd#
                AND CD.CPO_ORD_NUM          = #cpoOrdNum#
                AND CD.ORD_LINE_STS_CD     != #cancelled# 
                AND CD.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getPostCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(P.GLBL_CMPY_CD) 
            FROM
                POST P 
            WHERE
                P.GLBL_CMPY_CD     = #glblCmpyCd#
                AND P.POST_CD      = #postCd#
                AND P.EZCANCELFLAG = '0'
    </statement>

    <statement id="getAcctCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(S.GLBL_CMPY_CD) 
            FROM
                SELL_TO_CUST S 
            WHERE
                S.GLBL_CMPY_CD        = #glblCmpyCd#
                AND S.SELL_TO_CUST_CD = #acctCd#
                AND S.RGTN_STS_CD     = #rgtnStsCd#
                AND S.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getSoldToCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(B.GLBL_CMPY_CD) 
            FROM
                BILL_TO_CUST B
            WHERE
                B.GLBL_CMPY_CD        = #glblCmpyCd#
                AND B.BILL_TO_CUST_CD = #soldToLocCd#
                AND B.RGTN_STS_CD     = #rgtnStsCd#
                AND B.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getAssnPgmCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(PC.GLBL_CMPY_CD) 
            FROM
                PRC_CONTR PC
            WHERE
                PC.GLBL_CMPY_CD      = #glblCmpyCd#
                AND PC.PRC_CONTR_NUM = #assnPgmCd#
                AND PC.EFF_FROM_DT  &lt;= #slsDt#
                AND (
                    PC.EFF_THRU_DT  &gt;= #slsDt#
                 OR PC.EFF_THRU_DT  IS NULL
                    )
                AND PC.ACTV_FLG      = 'Y'
                AND PC.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getDsAcctCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(STC.GLBL_CMPY_CD)
            FROM
                SELL_TO_CUST STC
            WHERE
                    STC.GLBL_CMPY_CD          = #glblCmpyCd#
                AND STC.SELL_TO_CUST_CD       = #dsAcctNum#
                AND STC.RGTN_STS_CD           = #rgtnStsCd#
                AND STC.EZCANCELFLAG          = '0'
    </statement>

    <statement id="getShipToCustCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                          COUNT(S.GLBL_CMPY_CD) 
                    FROM
                        SHIP_TO_CUST S 
                    WHERE
                        S.GLBL_CMPY_CD        = #glblCmpyCd#
                        AND S.SHIP_TO_CUST_CD = #shipToCustCd#
                        AND S.RGTN_STS_CD     = #rgtnStsCd#
                        AND S.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getBillToCustCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                          COUNT(B.GLBL_CMPY_CD) 
                    FROM
                        BILL_TO_CUST B
                    WHERE
                        B.GLBL_CMPY_CD        = #glblCmpyCd#
                        AND B.BILL_TO_CUST_CD = #billToCustCd#
                        AND B.RGTN_STS_CD     = #rgtnStsCd#
                        AND B.EZCANCELFLAG    = '0'
    </statement>

    <statement id="getLineBizTpCd" parameterClass="Map" resultClass="String">
        SELECT
                  PD.LINE_BIZ_TP_CD
            FROM
                DS_ORD_TP OT
                , DS_ORD_TP_PROC_DFN PD
            WHERE
                OT.GLBL_CMPY_CD       = #glblCmpyCd#
                AND OT.DS_ORD_TP_CD   = #dsOrdTpCd#
                AND OT.EZCANCELFLAG   = '0'
                AND OT.GLBL_CMPY_CD   = PD.GLBL_CMPY_CD
                AND OT.DS_ORD_TP_CD   = PD.DS_ORD_TP_CD
                AND PD.ACTV_FLG       = 'Y' 
                AND PD.EFF_FROM_DT   &lt;= #slsDt#
                AND (
                    PD.EFF_THRU_DT   &gt;= #slsDt#
                 OR PD.EFF_THRU_DT   IS NULL
                    )
                AND PD.EZCANCELFLAG   = '0'
    </statement>

    <statement id="getEzPackCtxCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  ( 
                    SELECT
                              COUNT(C.GLBL_CMPY_CD)
                        FROM
                            ORD_CATG_BIZ_CTX C
                        WHERE
                            C.GLBL_CMPY_CD           = #glblCmpyCd#
                            AND C.ORD_CATG_CTX_TP_CD = #easyPack1#
                            AND C.DS_ORD_CATG_CD     = #dsOrdCatgCd#
                            AND C.DS_ORD_TP_CD       = #dsOrdTpCd#
                            AND C.EZCANCELFLAG       = '0'
                ) + ( 
                    SELECT
                              COUNT(C.GLBL_CMPY_CD)
                        FROM
                            ORD_CATG_BIZ_CTX C
                        WHERE
                            C.GLBL_CMPY_CD           = #glblCmpyCd#
                            AND C.ORD_CATG_CTX_TP_CD = #easyPack1#
                            AND C.DS_ORD_CATG_CD     = #dsOrdCatgCd#
                            AND C.DS_ORD_TP_CD      IS NULL
                            AND C.EZCANCELFLAG       = '0'
                ) CNT 
            FROM
                DUAL
    </statement>

    <statement id="getOrderCtxCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(C.GLBL_CMPY_CD) 
            FROM
                ORD_CATG_BIZ_CTX C 
            WHERE
                C.GLBL_CMPY_CD           = #glblCmpyCd#
                AND C.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCd#
                AND C.DS_ORD_CATG_CD     = #dsOrdCatgCd#
                <isNull property="dsOrdTpCd">
                AND C.DS_ORD_TP_CD      is null
                </isNull>
                <isNotNull property="dsOrdTpCd">
                AND (C.DS_ORD_TP_CD      is null
                  OR C.DS_ORD_TP_CD      = #dsOrdTpCd#)
                </isNotNull>
                <isNull property="dsOrdRsnCd">
                AND C.DS_ORD_RSN_CD      is null
                </isNull>
                <isNotNull property="dsOrdRsnCd">
                AND (C.DS_ORD_RSN_CD     is null
                  OR C.DS_ORD_RSN_CD     = #dsOrdRsnCd#)
                </isNotNull>
                AND C.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getCoaMdseTpCd" parameterClass="Map" resultClass="String">
        SELECT
                  VS.COA_MDSE_TP_CD 
            FROM
                MDSE_TP_VAL_SET VS 
            WHERE
                VS.GLBL_CMPY_CD          = #glblCmpyCd#
                AND VS.MDSE_TP_CTX_TP_CD = #mainMach#
                AND VS.EZCANCELFLAG      = '0'
    </statement>

    <statement id="getDefaultHddEraseRemovalFlag" parameterClass="Map" resultClass="Map">
        SELECT
                  CA.HARD_DRIVE_ERASE_INCL_FLG
                , CA.HARD_DRIVE_RMV_INCL_FLG 
            FROM
                PRC_EQUIP_CONTR_ATTRB CA 
            WHERE
                CA.GLBL_CMPY_CD     = #glblCmpyCd#
                AND CA.PRC_CATG_CD  = #prcCatgCd#
                AND CA.EZCANCELFLAG = '0'
    </statement>

    <!-- QC#14593 -->
    <statement id="getSvcIstlRuleFlg" parameterClass="Map" resultClass="String">
        SELECT
                  SIR.SVC_CUST_ISTL_FLG
            FROM
                DS_CPO_ISTL_INFO DCII
                , SVC_ISTL_RULE SIR
            WHERE
                DCII.GLBL_CMPY_CD   = #glblCmpyCd#
                AND DCII.CPO_ORD_NUM       = #cpoOrdNum#
                <isNotNull property="dsCpoConfigPk">
                AND DCII.DS_CPO_CONFIG_PK  = #dsCpoConfigPk#
                </isNotNull>
                <isNull property="dsCpoConfigPk">
                AND DCII.DS_CPO_CONFIG_PK  IS NULL
                </isNull>
                AND DCII.EZCANCELFLAG = '0'
                AND DCII.GLBL_CMPY_CD = SIR.GLBL_CMPY_CD
                AND DCII.EZCANCELFLAG = SIR.EZCANCELFLAG
                AND DCII.SVC_ISTL_RULE_NUM = SIR.SVC_ISTL_RULE_NUM
    </statement>

    <statement id="getDefaultCustIstlFlg" parameterClass="Map" resultClass="String">
        SELECT
                  DM.CUST_ISTL_FLG
            FROM
                DS_MDL DM
            WHERE
                DM.GLBL_CMPY_CD     = #glblCmpyCd#
                AND DM.MDL_ID       = #mdlId#
                AND DM.EZCANCELFLAG = '0'
    </statement>

    <statement id="getDefaultShopItemFlg" parameterClass="Map" resultClass="String">
        SELECT
                  SIR.SVC_PRE_ISTL_SHOP_FLG
            FROM
                DS_MDL DM
                , SVC_ISTL_RULE SIR
            WHERE
                DM.GLBL_CMPY_CD          = #glblCmpyCd#
                AND DM.MDL_ID            = #mdlId#
                AND DM.EZCANCELFLAG      = '0'
                AND DM.GLBL_CMPY_CD      = SIR.GLBL_CMPY_CD
                AND DM.SVC_ISTL_RULE_NUM = SIR.SVC_ISTL_RULE_NUM
                AND SIR.EZCANCELFLAG     = '0'
    </statement>

    <statement id="getSrvExcCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(*)
            FROM
                ORD_CATG_BIZ_CTX BC
            WHERE
                BC.GLBL_CMPY_CD           = #glblCmpyCd#
                AND BC.ORD_CATG_CTX_TP_CD = #serviceExchange#
                AND BC.DS_ORD_CATG_CD     = #dsOrdCatgCd#
                AND (BC.DS_ORD_TP_CD      = #dsOrdTpCd#
                OR  BC.DS_ORD_TP_CD       IS NULL )
                AND BC.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getSrvConfigMstrCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(SMM.GLBL_CMPY_CD)
            FROM
                SVC_MACH_MSTR SMM
            WHERE
                SMM.GLBL_CMPY_CD           = #glblCmpyCd#
                AND SMM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
                AND SMM.SVC_MACH_MSTR_PK   = #svcMachMstrPk#
                AND SMM.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getOrdCatgBizCtx" parameterClass="Map" resultClass="Map">
        SELECT
                  BC.FIRST_BIZ_CTX_ATTRB_TXT
                , BC.SCD_BIZ_CTX_ATTRB_TXT
            FROM
                SVC_MACH_MSTR       SMM
                , DS_ORD_TP         DOT
                , ORD_CATG_BIZ_CTX  BC
            WHERE
                SMM.GLBL_CMPY_CD          = #glblCmpyCd#
                AND SMM.SVC_MACH_MSTR_PK  = #svcMachMstrPk#
                AND SMM.EZCANCELFLAG      = '0' 
                AND SMM.GLBL_CMPY_CD      = DOT.GLBL_CMPY_CD 
                AND SMM.DS_ORD_TP_CD      = DOT.DS_ORD_TP_CD 
                AND DOT.EZCANCELFLAG      = '0' 
                AND DOT.GLBL_CMPY_CD      = BC.GLBL_CMPY_CD 
                AND DOT.DS_ORD_CATG_CD    = BC.DS_ORD_CATG_CD 
                <!-- 2016/04/22 S21_NA#7449 Mod Start -->
                <!-- AND DOT.DS_ORD_TP_CD      = BC.DS_ORD_TP_CD -->
                AND (
                        (
                            BC.DS_ORD_TP_CD IS NULL
                        )
                        OR (
                            SMM.DS_ORD_TP_CD = BC.DS_ORD_TP_CD
                            AND BC.DS_ORD_RSN_CD IS NULL
                        )
                        OR (
                            SMM.DS_ORD_TP_CD = BC.DS_ORD_TP_CD
                            AND SMM.DS_ORD_RSN_CD = BC.DS_ORD_RSN_CD
                        )
                )
                <!-- 2016/04/22 S21_NA#7449 Mod End -->
                AND BC.ORD_CATG_CTX_TP_CD = #serviceExchangeElig#
                AND BC.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getEasyPackCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(BC.GLBL_CMPY_CD) 
            FROM
                ORD_CATG_BIZ_CTX BC 
            WHERE
                BC.GLBL_CMPY_CD           = #glblCmpyCd#
                AND BC.ORD_CATG_CTX_TP_CD = #easyPack1#
                AND BC.DS_ORD_CATG_CD     = #dsOrdCatgCd#
                AND (BC.DS_ORD_TP_CD      = #dsOrdTpCd#
                OR  BC.DS_ORD_TP_CD       IS NULL)
                AND BC.EZCANCELFLAG       = '0'
    </statement>

    <statement id="getSplyPgmContrCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(SPC.GLBL_CMPY_CD) 
            FROM
                SPLY_PGM_CONTR SPC 
            WHERE
                SPC.GLBL_CMPY_CD             = #glblCmpyCd#
                AND SPC.BILL_TO_CUST_ACCT_CD = #billToCustAcctCd#
                -- AND SPC.BILL_TO_CUST_LOC_CD  IS NULL
                AND SPC.EFF_FROM_DT         &lt;= #slsDt#
                AND (
                    SPC.EFF_THRU_DT         &gt;= #slsDt#
                 OR SPC.EFF_THRU_DT         IS NULL
                    )
                AND SPC.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getLineBizRoleTpCdForWriter" parameterClass="Map" resultClass="String">
        <!-- QC#7268 -->
        SELECT
                  LBRT.LINE_BIZ_ROLE_TP_CD
            FROM
                DS_ORD_TP_PROC_DFN      DPD
                , LINE_BIZ_ROLE_TP      LBRT
            WHERE
                DPD.GLBL_CMPY_CD            = #glblCmpyCd#
                AND DPD.DS_ORD_TP_CD        = #dsOrdTpCd#
                AND DPD.ACTV_FLG            = 'Y'
                AND DPD.EFF_FROM_DT        &lt;= #slsDt#
                AND (
                    DPD.EFF_THRU_DT        &gt;= #slsDt#
                 OR DPD.EFF_THRU_DT        IS NULL
                    )
                AND DPD.EZCANCELFLAG        = '0'
                          --
                AND DPD.GLBL_CMPY_CD        = LBRT.GLBL_CMPY_CD
                AND DPD.LINE_BIZ_TP_CD      = LBRT.LINE_BIZ_TP_CD
                AND LBRT.PRIM_REP_ROLE_FLG  = 'Y'
                AND LBRT.EZCANCELFLAG       = '0'
<!-- 2016/06/24 S21_NA#7268 Mod
        SELECT
                  RT.LINE_BIZ_ROLE_TP_CD
            FROM
                DS_ORD_TP_PROC_DFN PD
                , TRTY_GRP_TP GT
                , LINE_BIZ_ROLE_RANK_DECN RD
                , LINE_BIZ_ROLE_TP RT
            WHERE
                PD.GLBL_CMPY_CD            = #glblCmpyCd#
                AND PD.DS_ORD_TP_CD        = #dsOrdTpCd#
                AND PD.ACTV_FLG            = 'Y'
                AND PD.EFF_FROM_DT        &lt;= #slsDt#
                AND (
                    PD.EFF_THRU_DT        &gt;= #slsDt#
                 OR PD.EFF_THRU_DT        IS NULL
                    )
                AND PD.EZCANCELFLAG        = '0'
                AND PD.GLBL_CMPY_CD        = GT.GLBL_CMPY_CD
                AND PD.LINE_BIZ_TP_CD      = GT.LINE_BIZ_TP_CD
                AND GT.EZCANCELFLAG        = '0'
                AND GT.GLBL_CMPY_CD        = RD.GLBL_CMPY_CD
                AND GT.TRTY_GRP_TP_CD      = RD.TRTY_GRP_TP_CD
                AND RD.EZCANCELFLAG        = '0'
                AND RD.GLBL_CMPY_CD        = RT.GLBL_CMPY_CD
                AND RD.LINE_BIZ_ROLE_TP_CD = RT.LINE_BIZ_ROLE_TP_CD
                AND RT.PRIM_REP_ROLE_FLG   = 'Y'
                AND RT.EZCANCELFLAG        = '0'
-->
    </statement>

    <statement id="matchConfigTp" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(CT.CONFIG_TP_CD)
        FROM
            CONFIG_TP CT
        WHERE
            CT.GLBL_CMPY_CD       = #glblCmpyCd#
            AND CT.CONFIG_TP_CD   = #configTpCd#
            AND CT.CONFIG_CATG_CD = #configCatgCd#
            AND CT.EZCANCELFLAG   = '0'
            AND (
                  1 != 1
                  <isNotNull property="configNewFlg">
                  OR CT.CONFIG_NEW_FLG = #configNewFlg#
                  </isNotNull>
                  <isNotNull property="configExstAtCustFlg">
                  OR CT.CONFIG_EXST_AT_CUST_FLG = #configExstAtCustFlg#
                  </isNotNull>
                  <isNotNull property="configExstWhFlg">
                  OR CT.CONFIG_EXST_WH_FLG = #configExstWhFlg#
                  </isNotNull>
                )
    </statement>

    <!-- 2016/01/13 S21_NA#2726 Add Start -->
    <statement id="getIbTrackableNotInSvcConfig" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(*)
        FROM
            MDSE M
        WHERE
                M.GLBL_CMPY_CD = #glblCmpyCd#
            AND M.EZCANCELFLAG = '0'
            AND M.MDSE_CD = #mdseCd#
            AND M.INSTL_BASE_CTRL_FLG = #flgOn#
            AND NOT EXISTS (
                SELECT
                    'X'
                FROM
                    SVC_MACH_MSTR SMM
                WHERE
                        M.GLBL_CMPY_CD = SMM.GLBL_CMPY_CD
                    AND SMM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
                    AND M.MDSE_CD = SMM.MDSE_CD
                    AND SMM.EZCANCELFLAG = '0'
            )
    </statement>
    <!-- 2016/01/13 S21_NA#2726 Add End -->

    <!-- 2016/01/25 S21_NA#3505 Add Start -->
    <statement id="getMachUsgStatus" parameterClass="Map" resultClass="String">
        SELECT
             SMM.SVC_MACH_USG_STS_CD
        FROM
             SVC_MACH_MSTR   SMM
           , SVC_CONFIG_MSTR SCM
        WHERE
             SCM.GLBL_CMPY_CD           = #glblCmpyCd#
             AND SCM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
             AND SCM.EZCANCELFLAG       = '0'
             AND SCM.GLBL_CMPY_CD       = SMM.GLBL_CMPY_CD
             AND SCM.SVC_MACH_MSTR_PK   = SMM.SVC_MACH_MSTR_PK
             AND SMM.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2016/01/25 S21_NA#3505 Add End -->
    
    <!-- 2018/09/25 S21_NA#28482 Add Start -->
    <statement id="getMachMstrStatus" parameterClass="Map" resultClass="String">
        SELECT
             SMM.SVC_MACH_MSTR_STS_CD
        FROM
             SVC_MACH_MSTR   SMM
           , SVC_CONFIG_MSTR SCM
        WHERE
             SCM.GLBL_CMPY_CD           = #glblCmpyCd#
             AND SCM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
             AND SCM.EZCANCELFLAG       = '0'
             AND SCM.GLBL_CMPY_CD       = SMM.GLBL_CMPY_CD
             AND SCM.SVC_MACH_MSTR_PK   = SMM.SVC_MACH_MSTR_PK
             AND SMM.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2018/09/25 S21_NA#28482 Add End -->
    
    <!-- 2018/05/18 S21_NA#25192 Add Start -->
    <statement id="getTrxHdrNumMatchCnt" parameterClass="Map" resultClass="Integer">
        SELECT
             COUNT(SMM.GLBL_CMPY_CD ) 
        FROM
             SVC_MACH_MSTR   SMM
           , SVC_CONFIG_MSTR SCM
        WHERE
             SCM.GLBL_CMPY_CD           = #glblCmpyCd#
             AND SCM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
             AND SCM.EZCANCELFLAG       = '0'
             AND SCM.GLBL_CMPY_CD       = SMM.GLBL_CMPY_CD
             AND SCM.SVC_MACH_MSTR_PK   = SMM.SVC_MACH_MSTR_PK
             <!-- 2019/04/08 S21_NA#31111 Mod Start -->
             <!-- AND SMM.TRX_HDR_NUM        = #cpoOrdNum# -->
             AND (SMM.TRX_HDR_NUM       = #cpoOrdNum# 
                 OR SMM.RMA_NUM         = #cpoOrdNum#)
             <!-- 2019/04/08 S21_NA#31111 Mod End -->
             AND SMM.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2018/05/18 S21_NA#25192 Add End -->
    
    <!-- 2016/05/20 S21_NA#5335 Add Start -->
    <statement id="getActiveRmaLineCnt" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(RD.GLBL_CMPY_CD) 
        FROM
            DS_CPO_RTRN_DTL RD 
        WHERE
            RD.GLBL_CMPY_CD             = #glblCmpyCd#
            AND RD.CPO_ORD_NUM          = #cpoOrdNum#
            AND RD.RTRN_LINE_STS_CD    != #cancelled# 
            AND RD.EZCANCELFLAG         = '0'
    </statement>
<!-- 2016/05/20 S21_NA#5335 Add End -->

    <statement id="getSvcMachMstrPkBySerNumAndMdseCd" parameterClass="Map" resultClass="BigDecimal">
        SELECT
                SMM.SVC_MACH_MSTR_PK
        FROM
            SVC_MACH_MSTR SMM 
        WHERE
            SMM.GLBL_CMPY_CD     = #glblCmpyCd#
            AND SMM.SER_NUM      = #serNum#
            AND SMM.MDSE_CD      LIKE #mdseCd# || '%'
            AND SMM.EFF_FROM_DT    &lt;= #slsDt#
            AND (SMM.EFF_THRU_DT   &gt;= #slsDt# OR SMM.EFF_THRU_DT IS NULL)
            AND SMM.EZCANCELFLAG = '0'
            AND ROWNUM             = 1
    </statement>

    <statement id="getBaseComponentInformation" parameterClass="Map" resultClass="Map">
        SELECT
             SMM.SVC_MACH_MSTR_PK
            ,SMM.MDSE_CD
            ,SMM.SER_NUM
        FROM
            SVC_MACH_MSTR SMM
        WHERE
                SMM.GLBL_CMPY_CD = #glblCmpyCd#
            AND SMM.EZCANCELFLAG = '0'
            AND SMM.EFF_FROM_DT    &lt;= #slsDt#
            AND (SMM.EFF_THRU_DT   &gt;= #slsDt# OR SMM.EFF_THRU_DT IS NULL)
            AND SMM.SVC_MACH_MSTR_PK IN
                (
                SELECT
                    SCM.SVC_MACH_MSTR_PK
                FROM
                     SVC_MACH_MSTR SMM
                    ,SVC_CONFIG_MSTR    SCM
                WHERE
                        SMM.GLBL_CMPY_CD       = #glblCmpyCd#
                    AND SMM.EZCANCELFLAG       = '0'
                   <isNotNull property="svcConfigMstrPk">
                    AND SMM.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
                   </isNotNull>
                   <isNull property="svcConfigMstrPk">
                   <isNotNull property="svcMachMstrPkForComponent">
                    AND SMM.SVC_MACH_MSTR_PK   = #svcMachMstrPkForComponent#
                   </isNotNull>
                   </isNull>
                    AND SMM.GLBL_CMPY_CD       = SCM.GLBL_CMPY_CD
                    AND SMM.EZCANCELFLAG       = SCM.EZCANCELFLAG
                    AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK
                )
         ORDER BY
             SMM.CPO_ORD_NUM
    </statement>
    <statement id="getOvrdPmtTermFlg" parameterClass="Map" resultClass="String">
        SELECT
            OVRD_PMT_TERM_FLG
        FROM (
            SELECT
                0                    SEQ
               ,CCP.OVRD_PMT_TERM_FLG
            FROM
                CUST_CR_PRFL CCP
            WHERE
                CCP.GLBL_CMPY_CD        = #glblCmpyCd#
                AND CCP.EZCANCELFLAG    = '0'
                AND CCP.BILL_TO_CUST_CD = #billToCustCd#
            UNION ALL
            SELECT
                1                    SEQ
               ,DACP.OVRD_PMT_TERM_FLG
            FROM
                DS_ACCT_CR_PRFL DACP
            WHERE
                DACP.GLBL_CMPY_CD        = #glblCmpyCd#
                AND DACP.EZCANCELFLAG    = '0'
                AND DACP.DS_ACCT_NUM     = #dsAcctNum#
            ORDER BY SEQ
        )
        WHERE ROWNUM = 1
    </statement>
    <statement id="getCashOrCcReqFlg" parameterClass="Map" resultClass="String">
        SELECT
            CASH_OR_CC_REQ_FLG
        FROM (
            SELECT
                0                    SEQ
               ,CCP.CASH_OR_CC_REQ_FLG
            FROM
                CUST_CR_PRFL CCP
            WHERE
                CCP.GLBL_CMPY_CD        = #glblCmpyCd#
                AND CCP.EZCANCELFLAG    = '0'
                AND CCP.BILL_TO_CUST_CD = #billToCustCd#
            UNION ALL
            SELECT
                1                    SEQ
               ,DACP.CASH_OR_CC_REQ_FLG
            FROM
                DS_ACCT_CR_PRFL DACP
            WHERE
                DACP.GLBL_CMPY_CD        = #glblCmpyCd#
                AND DACP.EZCANCELFLAG    = '0'
                AND DACP.DS_ACCT_NUM     = #dsAcctNum#
            ORDER BY SEQ
        )
        WHERE ROWNUM = 1
    </statement>

    <!-- 2017/11/02 S21_NA#20146 Add Start-->
    <statement id="getOrdCatgBizCtxFstAttbTxt" parameterClass="Map" resultClass="String">
        SELECT 
                OCBC.FIRST_BIZ_CTX_ATTRB_TXT
          FROM
                ORD_CATG_BIZ_CTX OCBC
         WHERE
                OCBC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND OCBC.EZCANCELFLAG        = '0'
            AND OCBC.ORD_CATG_CTX_TP_CD  = #ordCatgCtxTpCd#
        <isNotNull property="dsOrdCatgCd">
            AND (OCBC.DS_ORD_CATG_CD = #dsOrdCatgCd# OR OCBC.DS_ORD_CATG_CD IS NULL)
        </isNotNull>
        <isNull property="dsOrdCatgCd">
            AND OCBC.DS_ORD_CATG_CD IS NULL
        </isNull>
        <isNotNull property="dsOrdTpCd">
            AND (OCBC.DS_ORD_TP_CD = #dsOrdTpCd# OR OCBC.DS_ORD_TP_CD IS NULL)
        </isNotNull>
        <isNull property="dsOrdTpCd">
            AND OCBC.DS_ORD_TP_CD IS NULL
        </isNull>
    </statement>
    <!-- 2017/11/02 S21_NA#20146 Add End-->

    <!-- QC#21471 -->
    <statement id="existsCfsAcct" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(1) 
            FROM
                SELL_TO_CUST S
            WHERE
                S.GLBL_CMPY_CD          = #glblCmpyCd#
                AND S.SELL_TO_CUST_CD   = #acctCd#
                AND S.COA_AFFL_CD       = #cfsCoaAfflCd#
                AND S.EFF_FROM_DT      &lt;= #slsDt#
                AND (S.EFF_THRU_DT     &gt;= #slsDt# OR S.EFF_THRU_DT IS NULL)
                AND S.RGTN_STS_CD       = #rgtnStsReadyForOrderTaking#
                AND S.EZCANCELFLAG      = '0'
    </statement>
    <!-- 2017/12/26 S21_NA#22986 Add Start -->
    <statement id="getMinOrdLineSrcNotIttHld" parameterClass="Map" resultClass="String">
        SELECT
            MIN(ORD_LINE_SRC_CD) AS MIN_ORD_LINE_SRC_CD
        FROM
            ORD_LINE_SRC
        WHERE
            GLBL_CMPY_CD = #glblCmpyCd#
            AND ITT_HLD_FLG = #flgOffN#
            AND EZCANCELFLAG = '0'
    </statement>
    <!-- 2017/12/26 S21_NA#22986 Add End -->

    <!-- 2018/02/13 S21_NA#22717 Add Start -->
    <statement id="getAssetCratProcFlg" parameterClass="Map" resultClass="String">
        SELECT
            OPT.ASSET_CRAT_PROC_FLG
        FROM
            DS_ORD_LINE_PROC_DFN LPD
            , ORD_PROC_TP OPT
        WHERE
                LPD.GLBL_CMPY_CD = #glblCmpyCd#
            AND LPD.DS_ORD_TP_CD = #dsOrdTpCd#
            AND LPD.DS_ORD_LINE_CATG_CD = #dsOrdLineCatgCd#
            AND LPD.EZCANCELFLAG = '0'
        
            AND LPD.GLBL_CMPY_CD = OPT.GLBL_CMPY_CD
            AND LPD.ORD_PROC_TP_CD = OPT.ORD_PROC_TP_CD
            AND LPD.EZCANCELFLAG = OPT.EZCANCELFLAG
    </statement>

    <statement id="existsAssetCratTrgt" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(1)
        FROM
            MDSE_TP_VAL_SET MTVS
        WHERE
                MTVS.GLBL_CMPY_CD = #glblCmpyCd#
            AND MTVS.MDSE_TP_CTX_TP_CD = #mdseTpCtxTpCd#
            AND MTVS.COA_MDSE_TP_CD = #coaMdseTpCd#
            AND MTVS.EZCANCELFLAG = '0'
    </statement>
    <!-- 2018/02/13 S21_NA#22717 Add end -->
    <!-- 2018/03/28 S21_NA#24853 Add Start -->
    <statement id="getInternalOrdProcFlg" parameterClass="Map" resultClass="String">
        SELECT
            OPT.ITRL_ORD_PROC_FLG 
        FROM
            <isNotNull property="dsOrdLineCatgCd">
            DS_ORD_LINE_PROC_DFN    PD
            </isNotNull>
            <isNull property="dsOrdLineCatgCd">
            DS_ORD_TP_PROC_DFN      PD
            </isNull>
            , ORD_PROC_TP           OPT
        WHERE
                PD.GLBL_CMPY_CD        = #glblCmpyCd#
            AND PD.DS_ORD_TP_CD        = #dsOrdTpCd#
            <isNotNull property="dsOrdLineCatgCd">
            AND PD.DS_ORD_LINE_CATG_CD = #dsOrdLineCatgCd#
            </isNotNull>
            AND PD.EZCANCELFLAG        = '0'
            AND PD.GLBL_CMPY_CD        = OPT.GLBL_CMPY_CD
            AND PD.ORD_PROC_TP_CD      = OPT.ORD_PROC_TP_CD
            AND OPT.EFF_FROM_DT    &lt;= #slsDt#
            AND (
                OPT.EFF_THRU_DT    &gt;= #slsDt#
             OR OPT.EFF_THRU_DT       IS NULL
                )
            AND OPT.ACTV_FLG           = 'Y'
            AND OPT.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2018/03/28 S21_NA#24853 Add End -->
    
    <!-- 2018/06/14 S21_NA#24294 Add Start -->
    <statement id="getWhMpngTmpl" parameterClass="Map" resultClass="Map">
        SELECT
             CTX.FIRST_BIZ_CTX_ATTRB_TXT
            ,CTX.SCD_BIZ_CTX_ATTRB_TXT
        FROM
             ORD_CATG_BIZ_CTX CTX
        WHERE
                 CTX.GLBL_CMPY_CD       = #glblCmpyCd#
             AND CTX.ORD_CATG_CTX_TP_CD = #ordCatgCtxTpCd#
             AND CTX.DS_ORD_CATG_CD     = #dsOrdCatgCd#
             AND CTX.DS_ORD_TP_CD   = #dsOrdTpCd#
             AND CTX.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2018/06/14 S21_NA#24294 Add End -->
    <!-- 2018/06/18 QC#14307 Add Start -->
    <statement id="getAcctNum" parameterClass="Map" resultClass="Map">
       SELECT
           CUST.SELL_TO_CUST_CD AS SELL_TO_CUST_CD
         , CUST.DS_ACCT_NM      AS DS_ACCT_NM
         , CUST.LOC_NUM       AS LOC_NUM
       FROM
           SELL_TO_CUST CUST
       WHERE
                CUST.GLBL_CMPY_CD      = #glblCmpyCd#
            AND   CUST.EZCANCELFLAG    = '0'
            AND   CUST.RGTN_STS_CD     = #rgtnStsCd#
            AND   CUST.SELL_TO_CUST_CD = #dsAcctNum#
    </statement>

    <statement id="getLocNumFromBillTo" parameterClass="Map" resultClass="Map">
        SELECT
            BILL.LOC_NUM         AS LOC_NUM
          , BILL.DS_LOC_NM       AS LOC_NM
          , BILL.SELL_TO_CUST_CD AS SELL_TO_CUST_CD
          , BILL.DS_ACCT_NM      AS DS_ACCT_NM
        FROM
            BILL_TO_CUST BILL
        WHERE
                  BILL.GLBL_CMPY_CD    = #glblCmpyCd#
            AND   BILL.EZCANCELFLAG    = '0'
            AND   BILL.RGTN_STS_CD     = #rgtnStsCd#
            AND   BILL.BILL_TO_CUST_CD = #billToCustCd#
    </statement>

    <statement id="getLocNumFromShipTo" parameterClass="Map" resultClass="Map">
        SELECT
            SHIP.LOC_NUM         AS LOC_NUM
          , SHIP.DS_LOC_NM       AS LOC_NM
          , SHIP.SELL_TO_CUST_CD AS SELL_TO_CUST_CD
          , SHIP.DS_ACCT_NM      AS DS_ACCT_NM
        FROM
            SHIP_TO_CUST SHIP
        WHERE
                  SHIP.GLBL_CMPY_CD    = #glblCmpyCd#
            AND   SHIP.EZCANCELFLAG    = '0'
            AND   SHIP.RGTN_STS_CD     = #rgtnStsCd#
            AND   SHIP.SHIP_TO_CUST_CD = #shipToCustCd#
    </statement>

    <statement id="getAcctRefAttrb" parameterClass="Map" resultClass="Map">
        SELECT
            ATTRB.DS_ACCT_REF_ATTRB_NUM   AS DS_ACCT_REF_ATTRB_NUM
            , ATTRB.BLLG_ATTRB_NM         AS BLLG_ATTRB_NM
            , ATTRB.BLLG_ATTRB_VAL_TXT    AS BLLG_ATTRB_VAL_TXT
            , ATTRB.BLLG_ATTRB_ENBL_FLG   AS BLLG_ATTRB_ENBL_FLG
            , ATTRB.BLLG_ATTRB_REQ_FLG    AS BLLG_ATTRB_REQ_FLG
        FROM
            DS_ACCT_REF_ATTRB ATTRB
        WHERE
            ATTRB.GLBL_CMPY_CD = #glblCmpyCd#
        AND ATTRB.EZCANCELFLAG = '0'
        <isNotNull property="dsAcctNum">
        AND ATTRB.DS_ACCT_NUM  = #dsAcctNum#
        </isNotNull>
        <isNotNull property="locNum">
        AND ATTRB.LOC_NUM      = #locNum#
        ORDER BY 
            ATTRB.DS_ACCT_REF_ATTRB_NUM
          , ATTRB.DS_ACCT_REF_ATTRB_PK
        </isNotNull>
    </statement>

    <statement id="getSpclHdlg" parameterClass="Map" resultClass="Map">
        SELECT
             HDLG.EFF_FROM_DT               AS EFF_FROM_DT
            , HDLG.EFF_THRU_DT               AS EFF_THRU_DT
            , TO_CHAR(TO_TIMESTAMP(HDLG.EZINTIME, 'yyyymmddhh24missff3'), 'mm/dd/yyyy') AS EZINTIME
            , TO_CHAR(TO_TIMESTAMP(HDLG.EZUPTIME, 'yyyymmddhh24missff3'), 'mm/dd/yyyy') AS EZUPTIME
        FROM
            DS_CUST_SPCL_HDLG HDLG
        WHERE
            HDLG.GLBL_CMPY_CD                    = #glblCmpyCd#
        AND HDLG.EZCANCELFLAG                    = '0'
        AND HDLG.DS_ACCT_NUM                     = #dsAcctNum#
        AND HDLG.EFF_FROM_DT                 &lt;= #salesDate#
        AND NVL(HDLG.EFF_THRU_DT,'99991231') &gt;= #salesDate#
    </statement>

    <statement id="cntHrchEffLvlTp" parameterClass="Map" resultClass="Integer">
        SELECT COUNT(*) AS CNT
        FROM DS_ACCT_RELN RELN
        WHERE RELN.GLBL_CMPY_CD = #glblCmpyCd#
        AND   RELN.EZCANCELFLAG = '0'
        AND   RELN.DS_ACCT_NUM = #dsAcctNum#
        <!-- 2018/07/10 S21_NA#26661,26713 Add Start -->
        AND   RELN.DS_ACCT_RELN_TP_CD = '1'
        <!-- 2018/07/10 S21_NA#26661,26713 Add End -->
    </statement>

     <statement id="cntDisplay" parameterClass="Map" resultClass="Integer">
         SELECT
            COUNT(*) AS CNT
        FROM
            CUST_SPCL_INSTN_CTX CP
        WHERE
            CP.GLBL_CMPY_CD =  #glblCmpyCd#
        AND CP.EZCANCELFLAG = '0'
        AND CP.CUST_SPCL_INSTN_CTX_TP_CD = #custSpclInstnCtxTpCd#
        <isNotNull property="funcMstrId_S">
        AND CP.FUNC_MSTR_ID = #funcMstrId_S#
        </isNotNull>
        <isNotNull property="funcMstrIdDescTxt_S">
        AND CP.FUNC_MSTR_ID_DESC_TXT = #funcMstrIdDescTxt_S#
        </isNotNull>
    </statement>

     <statement id="getDisplayAvalCd" parameterClass="Map" resultClass="Map">
         SELECT
              CTX_TP.FIRST_BIZ_CTX_ATTRB_TXT    AS FIRST_BIZ_CTX_ATTRB_TXT_DISP
              ,CTX_TP.SCD_BIZ_CTX_ATTRB_TXT     AS SCD_BIZ_CTX_ATTRB_TXT_DISP
              ,CTX_TP.THIRD_BIZ_CTX_ATTRB_TXT   AS THIRD_BIZ_CTX_ATTRB_TXT_DISP
              ,CTX_TP.FRTH_BIZ_CTX_ATTRB_TXT    AS FRTH_BIZ_CTX_ATTRB_TXT_DISP
              ,CTX_TP.FIRST_NUM_CTX_ATTRB_TXT   AS FIRST_BIZ_CTX_ATTRB_NUM_SORT
              ,CTX_TP.SCD_NUM_CTX_ATTRB_TXT     AS SCD_BIZ_CTX_ATTRB_NUM_SORT
              ,CTX_TP.THIRD_NUM_CTX_ATTRB_TXT   AS THIRD_BIZ_CTX_ATTRB_NUM_SORT
              ,CTX_TP.FRTH_NUM_CTX_ATTRB_TXT    AS FRTH_BIZ_CTX_ATTRB_NUM_SORT
          FROM
              CUST_SPCL_INSTN_CTX_TP CTX_TP
          WHERE
              CTX_TP.GLBL_CMPY_CD = #glblCmpyCd#
          AND CTX_TP.EZCANCELFLAG = '0'
          AND CTX_TP.CUST_SPCL_INSTN_CTX_TP_CD = #custSpclInstnCtxTpCd#
          AND ROWNUM = 1
     </statement>

    <statement id="getDisplayAvalFlg" parameterClass="Map" resultClass="Map">
        SELECT
            CASE
                WHEN SUM(
                    CASE
                        WHEN FIRST_BIZ_CTX_ATTRB_TXT = 'Y' THEN 1
                        ELSE 0
                    END
                ) &gt; 0 THEN 'Y'
                ELSE 'N'
            END AS FIRST_BIZ_CTX_ATTRB_TXT
            ,CASE
                WHEN SUM(
                    CASE
                        WHEN SCD_BIZ_CTX_ATTRB_TXT = 'Y' THEN 1
                ELSE 0
                    END
                ) &gt; 0 THEN 'Y'
                ELSE 'N'
            END AS SCD_BIZ_CTX_ATTRB_TXT
            ,CASE
                WHEN SUM(
                    CASE
                        WHEN THIRD_BIZ_CTX_ATTRB_TXT = 'Y' THEN 1
                        ELSE 0
                    END
                ) &gt; 0 THEN 'Y'
                ELSE 'N'
            END AS THIRD_BIZ_CTX_ATTRB_TXT
            ,CASE
                WHEN SUM(
                    CASE
                        WHEN FRTH_BIZ_CTX_ATTRB_TXT = 'Y' THEN 1
                        ELSE 0
                    END
                ) &gt; 0 THEN 'Y'
                ELSE 'N'
            END AS FRTH_BIZ_CTX_ATTRB_TXT
        FROM
            CUST_SPCL_INSTN_CTX CP
        WHERE
            CP.GLBL_CMPY_CD = #glblCmpyCd#
        AND CP.EZCANCELFLAG = '0'
        AND CP.CUST_SPCL_INSTN_CTX_TP_CD = #custSpclInstnCtxTpCd#
        <isNotNull property="funcMstrId_S">
        AND CP.FUNC_MSTR_ID = #funcMstrId_S#
        </isNotNull>
        <isNotNull property="funcMstrIdDescTxt_S">
        AND CP.FUNC_MSTR_ID_DESC_TXT = #funcMstrIdDescTxt_S#
        </isNotNull>
     </statement>

     <statement id="getLobTypeWithMessageType" parameterClass="Map" resultClass="Map">
         SELECT
             BIZ_TP.LINE_BIZ_TP_CD     AS LINE_BIZ_TP_CD
            , MSG_TP.DS_CUST_MSG_TP_CD AS DS_CUST_MSG_TP_CD
         FROM
             LINE_BIZ_TP BIZ_TP
            , DS_CUST_MSG_TP MSG_TP
         WHERE
             BIZ_TP.GLBL_CMPY_CD = #glblCmpyCd#
         AND BIZ_TP.EZCANCELFLAG = '0'

         AND BIZ_TP.GLBL_CMPY_CD = MSG_TP.GLBL_CMPY_CD
         AND MSG_TP.EZCANCELFLAG = '0'
         AND MSG_TP.DS_CUST_MSG_TP_CD &lt;&gt; #custMsgTpCd#
     </statement>

    <statement id="getCustSpclInstn" parameterClass="Map" resultClass="Map">
        SELECT RULE.DS_CUST_TRX_RULE_PK       AS DS_CUST_TRX_RULE_PK
            , RULE.DS_ACCT_NUM                AS DS_ACCT_NUM
            , RULE.LOC_NUM                    AS LOC_NUM
            , RULE.DS_TRX_RULE_TP_CD          AS DS_TRX_RULE_TP_CD
            , RULE_TP.DS_TRX_RULE_TP_NM       AS DS_TRX_RULE_TP_NM
            , RULE.DS_PO_REQ_FLG              AS DS_PO_REQ_FLG
            , RULE.DS_BLKT_PO_NUM             AS DS_BLKT_PO_NUM
            , RULE.DS_PO_EXPR_DT              AS DS_PO_EXPR_DT
            , RULE.DS_DEF_BILL_TO_CD          AS DS_DEF_BILL_TO_CD
            , trim(BILL.FIRST_LINE_ADDR || ' ' || BILL.SCD_LINE_ADDR || ' ' || BILL.THIRD_LINE_ADDR || ' '  || BILL.FRTH_LINE_ADDR)
                                              AS XX_ALL_LINE_ADDR_BILL
            , RULE.DS_DEF_SHIP_TO_CD          AS DS_DEF_SHIP_TO_CD
            , trim(SHIP.FIRST_LINE_ADDR || ' ' || SHIP.SCD_LINE_ADDR || ' ' || SHIP.THIRD_LINE_ADDR || ' '  || SHIP.FRTH_LINE_ADDR)
                                              AS XX_ALL_LINE_ADDR_SHIP
            , RULE.DS_CR_CARD_REQ_FLG         AS DS_CR_CARD_REQ_FLG
            , RULE.DS_OVNGT_ALLW_FLG          AS DS_OVNGT_ALLW_FLG
            , RULE.CUST_EFF_LVL_CD            AS CUST_EFF_LVL_CD
            , LVL.CUST_EFF_LVL_NM             AS CUST_EFF_LVL_NM
        FROM
            DS_CUST_TRX_RULE RULE
           , BILL_TO_CUST BILL
           , SHIP_TO_CUST SHIP
           , DS_TRX_RULE_TP RULE_TP
           , CUST_EFF_LVL LVL
        WHERE
            RULE.GLBL_CMPY_CD = #glblCmpyCd#
        AND RULE.EZCANCELFLAG = '0'
        <isEqual property="selectAcctFlg" compareValue="Y">
        AND RULE.DS_ACCT_NUM = #searchKey#
        </isEqual>
        <isEqual property="selectLocFlg" compareValue="Y">
        AND RULE.LOC_NUM = #searchKey#
        </isEqual>

        AND RULE.GLBL_CMPY_CD = BILL.GLBL_CMPY_CD(+)
        AND RULE.DS_DEF_BILL_TO_CD = BILL.BILL_TO_CUST_CD(+)
        AND BILL.EZCANCELFLAG(+) = '0'

        AND RULE.GLBL_CMPY_CD = SHIP.GLBL_CMPY_CD(+)
        AND RULE.DS_DEF_SHIP_TO_CD = SHIP.SHIP_TO_CUST_CD(+)
        AND SHIP.EZCANCELFLAG(+) = '0'

        AND RULE.GLBL_CMPY_CD = RULE_TP.GLBL_CMPY_CD(+)
        AND RULE.DS_TRX_RULE_TP_CD = RULE_TP.DS_TRX_RULE_TP_CD(+)
        AND RULE_TP.EZCANCELFLAG(+) = '0'

        AND RULE.GLBL_CMPY_CD = LVL.GLBL_CMPY_CD(+)
        AND RULE.CUST_EFF_LVL_CD = LVL.CUST_EFF_LVL_CD(+)
        AND LVL.EZCANCELFLAG(+) = '0'

        AND (  NOT EXISTS (SELECT
            1
        FROM
            CUST_SPCL_INSTN_CTX CP
        WHERE
            CP.GLBL_CMPY_CD = #glblCmpyCd#
        AND CP.EZCANCELFLAG = '0'
        AND CP.CUST_SPCL_INSTN_CTX_TP_CD = #custSpclInstnCtxTpCd#
        <isNotNull property="funcMstrId_S">
        AND CP.FUNC_MSTR_ID = #funcMstrId_S#
        </isNotNull>
        <isNotNull property="funcMstrIdDescTxt_S">
        AND CP.FUNC_MSTR_ID_DESC_TXT = #funcMstrIdDescTxt_S#
        </isNotNull>
             )
        OR ( EXISTS (SELECT
            1
        FROM
            CUST_SPCL_INSTN_CTX CP
        WHERE
            CP.GLBL_CMPY_CD = #glblCmpyCd#
        AND CP.EZCANCELFLAG = '0'
        <!-- 2018/07/10 S21_NA#26661,26713 Add Start -->
        AND CP.CUST_SPCL_INSTN_CTX_TP_CD = #custSpclInstnCtxTpCd#
        <!-- 2018/07/10 S21_NA#26661,26713 Add End -->

        AND CP.GLBL_CMPY_CD = RULE.GLBL_CMPY_CD
        AND CP.FIRST_BIZ_CTX_ATTRB_TXT = RULE.DS_TRX_RULE_TP_CD
        <isNotNull property="funcMstrId_S">
        AND CP.FUNC_MSTR_ID = #funcMstrId_S#
        </isNotNull>
        <isNotNull property="funcMstrIdDescTxt_S">
        AND CP.FUNC_MSTR_ID_DESC_TXT = #funcMstrIdDescTxt_S#
        </isNotNull>
        )))
        ORDER BY
            RULE_TP.DS_TRX_RULE_TP_SORT_NUM
    </statement>

     <statement id="getCustSpclMsg" parameterClass="Map" resultClass="Map">
        SELECT 
            MSG.DS_CUST_SPCL_MSG_PK        AS DS_CUST_SPCL_MSG_PK
            , MSG.LINE_BIZ_TP_CD           AS LINE_BIZ_TP_CD
            , BIZ_LINE.LINE_BIZ_TP_NM      AS LINE_BIZ_TP_NM
            , MSG.DS_BIZ_AREA_CD           AS DS_BIZ_AREA_CD
            , BIZ_AREA.DS_BIZ_AREA_NM      AS DS_BIZ_AREA_NM
            , MSG.DS_CUST_MSG_TXT          AS DS_CUST_MSG_TXT
            , MSG_TP.DS_CUST_MSG_TP_NM     AS DS_CUST_MSG_TP_NM
            , MSG.DS_PRINT_ON_INV_FLG      AS DS_PRINT_ON_INV_FLG
            , LVL.CUST_EFF_LVL_NM          AS CUST_EFF_LVL_NM
            , MSG.EFF_FROM_DT              AS EFF_FROM_DT
            , MSG.EFF_THRU_DT              AS EFF_THRU_DT
            , TO_CHAR(TO_TIMESTAMP(MSG.EZINTIME, 'yyyymmddhh24missff3'), 'mm/dd/yyyy') AS EZINTIME
            , TO_CHAR(TO_TIMESTAMP(MSG.EZUPTIME, 'yyyymmddhh24missff3'), 'mm/dd/yyyy') AS EZUPTIME
            , (
                SELECT A.EZBUSINESSID
                  FROM ATT_DATA A 
                 WHERE A.EZCANCELFLAG = '0' 
                   AND A.GLBL_CMPY_CD = MSG.GLBL_CMPY_CD 
                   AND A.ATT_DATA_GRP_TXT = TO_CHAR(MSG.DS_CUST_SPCL_MSG_PK)
                   <isNotNull property="attBizAplIds">
                   AND A.EZBUSINESSID IN 
                   	<iterate property="attBizAplIds" var="attBizAplIds[]" open="(" close=")" conjunction=",">
                     #attBizAplIds[]#
                   	</iterate>
                   </isNotNull>
                   AND ROWNUM &lt;= 1
              )                            AS EZBUSINESSID
        FROM 
            DS_CUST_SPCL_MSG MSG
            , LINE_BIZ_TP BIZ_LINE
            , DS_BIZ_AREA BIZ_AREA
            , DS_CUST_MSG_TP MSG_TP
            , CUST_EFF_LVL LVL
        WHERE
            MSG.GLBL_CMPY_CD = #glblCmpyCd#
        AND MSG.EZCANCELFLAG = '0'
        <isEqual property="selectAcctFlg" compareValue="Y">
        AND MSG.DS_ACCT_NUM = #searchKey#
        </isEqual>
        <isEqual property="selectLocFlg" compareValue="Y">
        AND MSG.LOC_NUM = #searchKey#
        </isEqual>

        AND MSG.GLBL_CMPY_CD = BIZ_LINE.GLBL_CMPY_CD
        AND MSG.LINE_BIZ_TP_CD = BIZ_LINE.LINE_BIZ_TP_CD
        AND BIZ_LINE.EZCANCELFLAG = '0'

        AND MSG.GLBL_CMPY_CD = BIZ_AREA.GLBL_CMPY_CD
        AND MSG.DS_BIZ_AREA_CD = BIZ_AREA.DS_BIZ_AREA_CD
        AND BIZ_AREA.EZCANCELFLAG = '0'

        AND MSG.GLBL_CMPY_CD = MSG_TP.GLBL_CMPY_CD
        AND MSG.DS_CUST_MSG_TP_CD = MSG_TP.DS_CUST_MSG_TP_CD
        AND MSG_TP.EZCANCELFLAG = '0'

        AND MSG.GLBL_CMPY_CD = LVL.GLBL_CMPY_CD
        AND MSG.CUST_EFF_LVL_CD = LVL.CUST_EFF_LVL_CD
        AND LVL.EZCANCELFLAG = '0'

        AND MSG.DS_CUST_MSG_TP_CD &lt;&gt; #custMsgTpCd#

        AND MSG.EFF_FROM_DT &lt;= #salesDate#
        AND NVL(MSG.EFF_THRU_DT,'99991231') &gt;= #salesDate#

        AND (  NOT EXISTS (SELECT
            1
        FROM
            CUST_SPCL_INSTN_CTX CP
        WHERE
            CP.GLBL_CMPY_CD = #glblCmpyCd#
        AND CP.EZCANCELFLAG = '0'
        AND CP.CUST_SPCL_INSTN_CTX_TP_CD = #custSpclInstnCtxTpCd#
        <isNotNull property="funcMstrId_S">
        AND CP.FUNC_MSTR_ID = #funcMstrId_S#
        </isNotNull>
        <isNotNull property="funcMstrIdDescTxt_S">
        AND CP.FUNC_MSTR_ID_DESC_TXT = #funcMstrIdDescTxt_S#
        </isNotNull>
             )
        OR ( EXISTS (SELECT
            1
        FROM
            CUST_SPCL_INSTN_CTX CP
        WHERE
            CP.GLBL_CMPY_CD = #glblCmpyCd#
        AND CP.EZCANCELFLAG = '0'
        <!-- 2018/07/10 S21_NA#26661,26713 Add Start -->
        AND CP.CUST_SPCL_INSTN_CTX_TP_CD = #custSpclInstnCtxTpCd#
        <!-- 2018/07/10 S21_NA#26661,26713 Add End -->

        AND CP.GLBL_CMPY_CD = MSG.GLBL_CMPY_CD
        AND CP.FIRST_BIZ_CTX_ATTRB_TXT = MSG.DS_BIZ_AREA_CD
        <isNotNull property="funcMstrId_S">
        AND CP.FUNC_MSTR_ID = #funcMstrId_S#
        </isNotNull>
        <isNotNull property="funcMstrIdDescTxt_S">
        AND CP.FUNC_MSTR_ID_DESC_TXT = #funcMstrIdDescTxt_S#
        </isNotNull>
        )))
        <!-- 2018/07/10 S21_NA#26661,26713 Add Start -->
        <isNotNull property="lineBizTpCd_S">
        AND
        (
           MSG.LINE_BIZ_TP_CD = #lineBizTpCd_S#
        OR MSG.LINE_BIZ_TP_CD = #lineBizTpAll#
        OR #lineBizTpCd_S# = #lineBizTpAll#
        )
        </isNotNull>
        <!-- 2018/07/10 S21_NA#26661,26713 Add End -->
         ORDER BY
            BIZ_LINE.LINE_BIZ_TP_SORT_NUM
          , BIZ_AREA.DS_BIZ_AREA_SORT_NUM
          , MSG_TP.DS_CUST_MSG_TP_SORT_NUM
          , MSG.DS_CUST_SPCL_MSG_PK DESC 
          , NVL(MSG.EFF_THRU_DT,'99991231') DESC
     </statement>


    <!-- 2018/06/18 QC#14307 Add End -->
    <!-- QC#23726 2018/06/25 add Start -->
    <statement id="getCustCarrScvLvlReln" parameterClass="Map" resultClass="String">
        SELECT
            CCSLR.CARR_SVC_LVL_CD
        FROM
            CUST_CARR_SVC_LVL_RELN  CCSLR
        WHERE
                CCSLR.GLBL_CMPY_CD      = #glblCmpyCd#
            <!-- QC#23726-1 2018/06/28 mod Start -->
            <!-- AND CCSLR.LINE_BIZ_TP_CD    = #dsBizAreaCd# -->
            AND CCSLR.DS_BIZ_AREA_CD    = #dsBizAreaCd#
            <!-- QC#23726-1 2018/06/28 mod End -->
            AND CCSLR.DS_ACCT_NUM       = #dsAcctNum#
            AND CCSLR.EZCANCELFLAG      = '0'
            
    </statement>
    <statement id="getDsBizArea" parameterClass="Map" resultClass="String">
        SELECT
            OCB.SCD_BIZ_CTX_ATTRB_TXT
        FROM
            ORD_CATG_BIZ_CTX OCB
        WHERE
                OCB.GLBL_CMPY_CD       = #glblCmpyCd#
            AND OCB.ORD_CATG_CTX_TP_CD in
            <iterate property="ordCatgCtxTpCdList" var="ordCatgCtxTpCd[]" open=" (" close=")" conjunction=",">
                #ordCatgCtxTpCd[]#
            </iterate>
            AND  OCB.DS_ORD_CATG_CD    = #dsOrdCatgCd#
            AND (OCB.DS_ORD_TP_CD      is null
              OR OCB.DS_ORD_TP_CD      = #dsOrdTpCd#)
            AND (OCB.DS_ORD_RSN_CD     is null
              <isNotNull property="dsOrdRsnCd">
              OR OCB.DS_ORD_RSN_CD     = #dsOrdRsnCd#
              </isNotNull>
              )
            AND  OCB.EZCANCELFLAG      = '0'
        
    </statement>    <!-- QC#23726 2018/06/25 add End -->

    <!-- 2018/07/09 S21_NA#26895 Add Start -->
    <statement id="getOverWriteExemptRtlWhCdList" parameterClass="Map" resultClass="String">
        SELECT
            ODWE.RTL_WH_CD
        FROM
            ORD_DEF_WH_EX ODWE
        WHERE
                ODWE.GLBL_CMPY_CD       = #glblCmpyCd#
            AND ODWE.EZCANCELFLAG      = '0'
    </statement>
    <!-- 2018/07/09 S21_NA#26895 Add End -->

    <!-- 2018/07/13 S21_NA#27228 Add Start -->
    <statement id="getOverWriteExemptBaseRtlWhCdList" parameterClass="Map" resultClass="String">
        SELECT
            ODWB.RTL_WH_CD
        FROM
            ORD_DEF_WH_BASE_EX ODWB
        WHERE
                ODWB.GLBL_CMPY_CD       = #glblCmpyCd#
            AND ODWB.EZCANCELFLAG      = '0'
    </statement>
    <!-- 2018/07/13 S21_NA#27228 Add End -->
    
    <!-- 2018/07/30 S21_NA#26181 Add Start -->
    <statement id="alreadyExistOpenRmaLine" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(DCRD.GLBL_CMPY_CD) 
            FROM
                DS_CPO_RTRN_DTL DCRD
            WHERE
                    DCRD.GLBL_CMPY_CD         = #glblCmpyCd#
                <isNotNull property="svcMachMastrPk">
                AND DCRD.SVC_MACH_MSTR_PK     = #svcMachMastrPk#
                </isNotNull>
                <isNotNull property="serNum">
                AND DCRD.SER_NUM              = #serNum#
                </isNotNull>
                AND DCRD.CPO_ORD_NUM         != #cpoOrdNum#
                AND DCRD.MDSE_CD              = #mdseCd# 
                AND DCRD.OPEN_FLG             = #openFlg#
                AND DCRD.RTRN_LINE_STS_CD     = #rtrnLineStsCd#
                AND DCRD.EZCANCELFLAG         = '0'
    </statement>
    <!-- 2018/07/30 S21_NA#26181 Add End -->
    
    <!-- QC#26410 -->
    <statement id="isAvalableItemForOrderLine" parameterClass="Map" resultClass="String">
        SELECT
                  CASE COUNT(MDSE_CD) 
                    WHEN 0 THEN 'N' 
                    ELSE        'Y' 
                    END         IS_AVAL 
            FROM
                ALL_MDSE_V  M
            WHERE
                M.GLBL_CMPY_CD      = #glblCmpyCd#
                AND M.MDSE_CD       = #mdseCd#
                AND M.EZCANCELFLAG  = 0 
                AND NOT EXISTS ( 
                    SELECT
                              1 
                        FROM
                            ALL_MDSE_V V 
                        WHERE
                            M.GLBL_CMPY_CD              = V.GLBL_CMPY_CD 
                            AND M.MDSE_CD               = V.MDSE_CD 
                            <!-- 2019/11/06 QC#54211 Delete Start -->
                            <!-- AND V.SVC_ALLOC_TP_CD    IS NOT NULL  -->
                            <!-- AND V.DFRD_ACCTG_RULE_CD    NOT IN (#OPTIMA_DEFERRAL#, #SUBSCRIPTION_SERVICE#)  -->
                            <!-- 2019/11/06 QC#54211 Delete End -->
                            <!-- 2019/11/06 QC#54211 Add Start -->
                            AND ((  V.SVC_ALLOC_TP_CD    IS NOT NULL 
                                AND V.DFRD_ACCTG_RULE_CD    NOT IN (#OPTIMA_DEFERRAL#, #SUBSCRIPTION_SERVICE#))
                                OR  V.DFRD_ACCTG_RULE_CD = #DEFERRED#)
                            <!-- 2019/11/06 QC#54211 Add End -->
                            AND M.EZCANCELFLAG          = V.EZCANCELFLAG
                )
     </statement>

    <statement id="getSvcMachMstrPkByConfigIdAndMdseCd" parameterClass="Map" resultClass="BigDecimal">
        SELECT
            SMM.SVC_MACH_MSTR_PK
        FROM
            SVC_MACH_MSTR SMM 
        WHERE
            SMM.GLBL_CMPY_CD            = #glblCmpyCd#
            AND SMM.SVC_CONFIG_MSTR_PK  = #svcConfigMstrPk#
            AND SMM.MDSE_CD             LIKE #mdseCd# || '%'
            AND SMM.EFF_FROM_DT         &lt;= #slsDt#
            AND (SMM.EFF_THRU_DT        &gt;= #slsDt# OR SMM.EFF_THRU_DT IS NULL)
            AND SMM.EZCANCELFLAG = '0'
        ORDER BY
            SMM.SVC_MACH_SQ_NUM
    </statement>

    <statement id="getSvcMachMstrPkAndConfigIdBySerNumAndMdseCd" parameterClass="Map" resultClass="Map">
        SELECT
            SMM.SVC_MACH_MSTR_PK
            ,SMM.SVC_CONFIG_MSTR_PK
            ,SCM.MDL_ID
            ,DM.MDL_DESC_TXT
            ,MN.T_MDL_NM
        FROM
            SVC_MACH_MSTR SMM
            ,SVC_CONFIG_MSTR SCM
            ,DS_MDL DM
            ,MDL_NM MN
        WHERE
            SMM.GLBL_CMPY_CD     = #glblCmpyCd#
            AND SMM.SER_NUM      = #serNum#
            AND SMM.MDSE_CD      LIKE #mdseCd# || '%'
            AND SMM.EFF_FROM_DT    &lt;= #slsDt#
            AND (SMM.EFF_THRU_DT   &gt;= #slsDt# OR SMM.EFF_THRU_DT IS NULL)
            AND SMM.EZCANCELFLAG = '0'
            AND SMM.GLBL_CMPY_CD = SCM.GLBL_CMPY_CD
            AND SMM.SVC_CONFIG_MSTR_PK = SCM.SVC_CONFIG_MSTR_PK
            AND SCM.EZCANCELFLAG = '0'
            AND SCM.GLBL_CMPY_CD = DM.GLBL_CMPY_CD(+)
            AND SCM.MDL_ID = DM.MDL_ID(+)
            AND DM.EZCANCELFLAG(+) = '0'
            AND DM.GLBL_CMPY_CD = MN.T_GLBL_CMPY_CD(+)
            AND DM.MDL_ID = MN.T_MDL_ID(+)
            AND MN.EZCANCELFLAG(+) = '0'
            AND ROWNUM             = 1
    </statement>

    <!-- QC#29248 -->
    <statement id="cntBillableCounter" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(*)      CNT
            FROM
                PRC_MTR_PKG_MTR_STRU_V MS
            WHERE
                MS.GLBL_CMPY_CD                     = #glblCmpyCd#
                AND MS.MDL_ID                       = #mdlId#
                AND MS.PRC_MTR_PKG_PK               = #prcMtrPkgPk#
                AND MS.ACTV_FLG                     = 'Y'
                AND MS.BLLBL_FLG                    = 'Y'
                AND MS.BLLG_MTR_LB_CD              IS NOT NULL
                AND MS.MDL_MTR_EFF_FROM_DT          &lt;= #slsDt#
                AND ( 
                    MS.MDL_MTR_EFF_THRU_DT          &gt;= #slsDt#
                    OR MS.MDL_MTR_EFF_THRU_DT       IS NULL
                ) 
                AND MS.BLLG_MTR_MAP_EFF_FROM_DT     &lt;= #slsDt#
                AND ( 
                    MS.BLLG_MTR_MAP_EFF_THRU_DT     &gt;= #slsDt#
                    OR MS.BLLG_MTR_MAP_EFF_THRU_DT  IS NULL
                ) 
                AND MS.MTR_PKG_EFF_FROM_DT          &lt;= #slsDt#
                AND ( 
                    MS.MTR_PKG_EFF_THRU_DT          &gt;= #slsDt#
                    OR MS.MTR_PKG_EFF_THRU_DT       IS NULL
                ) 
                AND MS.MTR_PKG_MDL_EFF_FROM_DT      &lt;= #slsDt#
                AND ( 
                    MS.MTR_PKG_MDL_EFF_THRU_DT      &gt;= #slsDt#
                    OR MS.MTR_PKG_MDL_EFF_THRU_DT   IS NULL
                )
    </statement>

    <!-- 2019/01/08 QC#29241 Add Start -->
    <statement id="getOrdQtyVldFlg" parameterClass="Map" resultClass="String">
        SELECT
            OPT.ORD_QTY_VLD_FLG         AS ORD_QTY_VLD_FLG
        FROM
            DS_ORD_LINE_PROC_DFN DOLPD
          , ORD_PROC_TP          OPT
        WHERE
                  DOLPD.GLBL_CMPY_CD        = #glblCmpyCd#
            AND   DOLPD.DS_ORD_TP_CD        = #dsOrdTpCd#
            AND   DOLPD.DS_ORD_LINE_CATG_CD = #dsOrdLineCatgCd#
            AND   DOLPD.ACTV_FLG            = #actvFlg#
            AND   DOLPD.EFF_FROM_DT                  &lt;= #salesDate#
            AND   NVL(DOLPD.EFF_THRU_DT, '99991231') &gt;= #salesDate#
            AND   DOLPD.EZCANCELFLAG        = '0'
            AND   DOLPD.GLBL_CMPY_CD        = OPT.GLBL_CMPY_CD
            AND   DOLPD.ORD_PROC_TP_CD      = OPT.ORD_PROC_TP_CD
            AND   OPT.ACTV_FLG              = #actvFlg#
            AND   OPT.EFF_FROM_DT                    &lt;= #salesDate#
            AND   NVL(OPT.EFF_THRU_DT, '99991231')   &gt;= #salesDate#
            AND   OPT.EZCANCELFLAG          = '0'
    </statement>
    <!-- 2019/01/08 QC#29241 Add End -->

    <!-- START 2019/03/12 Hd.Sugawara [QC#30730,ADD] -->
    <statement id="getRelatedBillTo" parameterClass="Map" resultMap="String">
        SELECT 
            SHIP.RELN_BILL_TO_CUST_CD
        FROM
            SHIP_TO_CUST SHIP
        <!-- 2019/08/28 QC#53021 Add Start -->
          , ACCT_LOC     AC
          , PTY_LOC_WRK  PLW
          , SELL_TO_CUST STC
        <!-- 2019/08/28 QC#53021 Add End -->
        WHERE
                SHIP.GLBL_CMPY_CD    = #glblCmpyCd#
            AND SHIP.EZCANCELFLAG    = '0'
            AND SHIP.RGTN_STS_CD     = #rgtnStsCd#
            AND SHIP.SHIP_TO_CUST_CD = #shipToCustCd#
        <!-- 2019/08/28 QC#53021 Add Start -->
            AND PLW.GLBL_CMPY_CD     = SHIP.GLBL_CMPY_CD
            AND PLW.PTY_LOC_PK       = SHIP.PTY_LOC_PK
            AND PLW.RGTN_STS_CD      = #rgtnStsCd#
            AND PLW.EZCANCELFLAG     = '0'
            AND AC.GLBL_CMPY_CD      = PLW.GLBL_CMPY_CD
            AND AC.LOC_NUM           = PLW.LOC_NUM
            AND AC.RGTN_STS_CD       = #rgtnStsCd#
            AND AC.EZCANCELFLAG      = '0'
            AND AC.GLBL_CMPY_CD      = STC.GLBL_CMPY_CD
            AND AC.DS_ACCT_NUM       = STC.SELL_TO_CUST_CD
            AND STC.RGTN_STS_CD      = #rgtnStsCd#
            AND STC.EZCANCELFLAG     = '0'
        <!-- 2019/08/28 QC#53021 Add End -->
    </statement>
    <!-- END 2019/03/12 Hd.Sugawara [QC#30730,ADD] -->
    
    <!-- 2019/04/08 S21_NA#31111 Add Start -->
    <statement id="getConfigCnt4Exch" parameterClass="Map" resultClass="Integer">
        SELECT
              COUNT(*)
        FROM
            DS_CPO_CONFIG DCC
        WHERE
            DCC.GLBL_CMPY_CD       = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM        = #cpoOrdNum#
        AND DCC.CONFIG_CATG_CD     = #configCatgCd#
        AND DCC.SVC_CONFIG_MSTR_PK = #svcConfigMstrPk#
        AND DCC.EZCANCELFLAG       = '0'
    </statement>
    <!-- 2019/04/08 S21_NA#31111 Add End -->

    <!-- START 2019/04/24 Hd.Sugawara [QC#31125,QC#31126,ADD] -->
    <statement id="getLatestSlsRepInfo" parameterClass="Map" resultClass="String">
        WITH ORG_PSN_NUM AS (
            SELECT
                SP.PSN_NUM AS PSN_NUM
            FROM
                TOC TOC
              , ORG_FUNC_ASG OFA
              , S21_PSN SP
            WHERE
                    TOC.GLBL_CMPY_CD = #glblCmpyCd#
                AND TOC.EZCANCELFLAG = '0'
                AND TOC.TOC_CD       = #tocCd#

                AND TOC.GLBL_CMPY_CD = OFA.GLBL_CMPY_CD
                AND TOC.TOC_CD       = OFA.TOC_CD
                AND OFA.EZCANCELFLAG = '0'

                AND OFA.GLBL_CMPY_CD = SP.GLBL_CMPY_CD
                AND OFA.PSN_CD       = SP.PSN_CD
                AND SP.EZCANCELFLAG  = '0'
        )
        SELECT
            TOC.TOC_CD AS TOC_CD
        FROM
            TOC              TOC
          , ORG_FUNC_ROLE_TP OFRT
          , BIZ_AREA_ORG     BA
          , ORG_FUNC_ASG     OFA
          , S21_PSN          SP
          , S21_ORG          SO
          , ORG_PSN_NUM      OPN
        WHERE 
                TOC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND TOC.EZCANCELFLAG        = '0'

            AND TOC.GLBL_CMPY_CD        = OFRT.GLBL_CMPY_CD
            AND TOC.ORG_FUNC_ROLE_TP_CD = OFRT.ORG_FUNC_ROLE_TP_CD
            AND OFRT.SLS_REP_FLG        = #slsRepFlg#
            AND OFRT.EZCANCELFLAG       = '0'

            AND OFRT.GLBL_CMPY_CD       = BA.GLBL_CMPY_CD
            AND OFRT.FIRST_ORG_CD       = BA.BIZ_AREA_ORG_CD
            AND BA.SLS_FLG              = #slsRepFlg#
            AND BA.ORG_STRU_TP_CD       = #orgStruTpCd#
            AND BA.EZCANCELFLAG         = '0'

            AND TOC.GLBL_CMPY_CD        = OFA.GLBL_CMPY_CD
            AND TOC.TOC_CD              = OFA.TOC_CD
            AND OFA.EZCANCELFLAG        = '0'

            AND OFA.GLBL_CMPY_CD        = SP.GLBL_CMPY_CD
            AND OFA.PSN_CD              = SP.PSN_CD
            AND OFA.EFF_FROM_DT     &lt;= #slsDt#
            AND (OFA.EFF_THRU_DT    &gt;= #slsDt# OR OFA.EFF_THRU_DT IS NULL)
            AND SP.PSN_NUM              = OPN.PSN_NUM
            AND SP.EFF_FROM_DT      &lt;= #slsDt#
            AND (SP.EFF_THRU_DT     &gt;= #slsDt# OR SP.EFF_THRU_DT IS NULL)
            AND SP.EZCANCELFLAG         = '0'

            AND TOC.GLBL_CMPY_CD        = SO.GLBL_CMPY_CD
            AND TOC.TOC_CD              = SO.TOC_CD
            AND SO.RGTN_STS_CD         != #rgtnStsCd#
            AND SO.EZCANCELFLAG         = '0'
    </statement>
    <!-- END 2019/04/24 Hd.Sugawara [QC#31125,QC#31126,ADD] -->

    <!-- 2019/12/14 QC#53588 Add Start -->
    <statement id="getActiveLineCntEx" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(CD.GLBL_CMPY_CD) 
        FROM
            CPO_DTL CD 
        WHERE
            CD.GLBL_CMPY_CD             = #glblCmpyCd#
            AND CD.CPO_ORD_NUM          = #cpoOrdNum#
            AND CD.ORD_LINE_STS_CD     != #cancelled#
            AND CD.ORD_LINE_STS_CD     != #closed#  
            AND CD.EZCANCELFLAG         = '0'
    </statement>

    <statement id="isActiveLine" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(CD.GLBL_CMPY_CD) 
        FROM
            CPO_DTL CD 
        WHERE
            CD.GLBL_CMPY_CD             = #glblCmpyCd#
            AND CD.CPO_ORD_NUM          = #cpoOrdNum#
            AND CD.DS_ORD_POSN_NUM      = #dsOrdPosnNum#
            AND CD.DS_CPO_LINE_NUM      = #dsCpoLineNum#
            AND CD.ORD_LINE_STS_CD     != #cancelled#
            AND CD.ORD_LINE_STS_CD     != #closed#  
            AND CD.EZCANCELFLAG         = '0'
    </statement>

    <statement id="getActiveRmaLineCntEx" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(RD.GLBL_CMPY_CD) 
        FROM
            DS_CPO_RTRN_DTL RD 
        WHERE
            RD.GLBL_CMPY_CD             = #glblCmpyCd#
            AND RD.CPO_ORD_NUM          = #cpoOrdNum#
            AND RD.RTRN_LINE_STS_CD    != #cancelled# 
            AND RD.RTRN_LINE_STS_CD     != #closed#
            AND RD.EZCANCELFLAG         = '0'
    </statement>

    <!-- 2019/12/14 QC#53588 Add End -->

    <!-- ADD START 2022/08/19 H.Watanabe [QC#60255] -->
    <statement id="getCarrAcctNumVld" parameterClass="Map" resultClass="Map">
        SELECT
             CANV.VLD_PTRN_TXT
            ,CANV.LG_MIN_NUM
            ,CANV.LG_MAX_NUM
        FROM
             SHPG_SVC_LVL_CARR_RELN SSLCR
            ,CARR_ACCT_NUM_VLD CANV
        WHERE
                SSLCR.GLBL_CMPY_CD      = #glblCmpyCd#
            AND SSLCR.EZCANCELFLAG      = '0'
            AND SSLCR.GLBL_CMPY_CD      = CANV.GLBL_CMPY_CD
            AND CANV.EZCANCELFLAG       = '0'
            AND SSLCR.CARR_CD           = CANV.VND_CD
            AND SSLCR.SHPG_SVC_LVL_CD   = #shpgSvcLvlCd#
            AND SSLCR.CARR_SVC_LVL_CD   = #carrSvcLvlCd#
    </statement>
    <!-- ADD END   2022/08/19 H.Watanabe [QC#60255] -->
</sqlMap>
