<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NLCB118001">

    <statement id="getPrintData" parameterClass="Map" resultClass="Map">
        SELECT
            REQ.USER_ID
           ,REQ.REQ_TIME
           ,REQ.PHYS_INVTY_CTRL_PK 
           ,REQ_HDR.GLBL_CMPY_CD
           ,RTL_WH.DEF_SRC_LOC_CD
           ,RTL_WH2.RTL_WH_NM
           ,REQ_HDR.TECH_TOC_CD
           ,PSN.PSN_FIRST_NM || ' ' || PSN.PSN_MID_NM || ' ' || PSN.PSN_LAST_NM TECH_NM
           ,PSN.HR_SUPV_ID
           ,PSN.HR_SUPV_NM
           ,REQ_HDR.PHYS_INVTY_CTRL_NM
           ,REQ_HDR.PHYS_INVTY_DT
           ,REQ_DTL.RTL_WH_CD
           ,REQ_DTL.RTL_SWH_CD
           ,REQ_DTL.MDSE_CD
           ,MDS.MDSE_DESC_SHORT_TXT
           ,REQ_DTL.CNT_INP_QTY
        FROM
            CANON_E437_PRINT_REQUEST      REQ
           ,TECH_PI_RPT_RQST              REQ_END
           ,CANON_E437_PHYS_INVTY_CNT_HDR REQ_HDR
           ,CANON_E437_PHYS_INVTY_CNT_DTL REQ_DTL
           ,RTL_WH                        RTL_WH
           ,RTL_SWH                       RTL_SWH
           ,RTL_WH                        RTL_WH2
           ,S21_PSN                       PSN
           ,MDSE                          MDS
        WHERE
            REQ.PHYS_INVTY_CTRL_PK        = REQ_END.PHYS_INVTY_CTRL_PK(+)
        AND REQ.USER_ID                   = REQ_END.RQST_USR_ID(+)
        AND REQ.REQ_TIME                  = REQ_END.RPT_RQST_PROC_TS(+)
        AND REQ_END.GLBL_CMPY_CD          IS NULL
        AND REQ.PHYS_INVTY_CTRL_PK        = REQ_HDR.PHYS_INVTY_CTRL_PK
        AND REQ_HDR.GLBL_CMPY_CD          = #glblCmpyCd#
        AND REQ_HDR.EZCANCELFLAG          = '0'
        AND REQ_HDR.GLBL_CMPY_CD          = REQ_DTL.GLBL_CMPY_CD
        AND REQ_HDR.PHYS_INVTY_CTRL_PK    = REQ_DTL.PHYS_INVTY_CTRL_PK
        AND REQ_HDR.PHYS_INVTY_CNT_HDR_PK = REQ_DTL.PHYS_INVTY_CNT_HDR_PK
        AND REQ_DTL.EZCANCELFLAG          = '0'
        AND REQ_HDR.GLBL_CMPY_CD          = RTL_WH.GLBL_CMPY_CD
        AND REQ_HDR.RTL_WH_CD             = RTL_WH.RTL_WH_CD
        AND RTL_WH.EZCANCELFLAG           = '0'
        AND REQ_HDR.GLBL_CMPY_CD          = PSN.GLBL_CMPY_CD
        AND REQ_HDR.TECH_TOC_CD           = PSN.PSN_CD
        AND PSN.EZCANCELFLAG              = '0'
        AND REQ_HDR.GLBL_CMPY_CD          = MDS.GLBL_CMPY_CD
        AND REQ_HDR.MDSE_CD               = MDS.MDSE_CD
        AND MDS.EZCANCELFLAG              = '0'
        AND RTL_WH.GLBL_CMPY_CD           = RTL_SWH.GLBL_CMPY_CD
        AND RTL_WH.DEF_SRC_LOC_CD         = RTL_SWH.INVTY_LOC_CD
        AND RTL_SWH.EZCANCELFLAG          = '0'
        AND RTL_SWH.GLBL_CMPY_CD          = RTL_WH2.GLBL_CMPY_CD
        AND RTL_SWH.RTL_WH_CD             = RTL_WH2.RTL_WH_CD
        AND RTL_WH2.EZCANCELFLAG           = '0'
        ORDER BY
            REQ.USER_ID
           ,REQ.REQ_TIME
           ,REQ.PHYS_INVTY_CTRL_PK 
           ,RTL_WH.DEF_SRC_LOC_CD
           ,REQ_DTL.RTL_WH_CD
           ,REQ_DTL.RTL_SWH_CD
           ,REQ_DTL.MDSE_CD
    </statement>

</sqlMap>
