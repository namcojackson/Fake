<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="NPAB263001">

    <statement id="getReceivingInventories" parameterClass="Map" resultClass="Map">
        SELECT
                   NPAI0430.INTERFACE_ID
                  ,NPAI0430.TRANSACTION_ID
                  ,NPAI0430.SEGMENT_ID
                  ,NPAI0430.UNIT_ID
                  ,NPAI0430.SEQ_NUMBER
                  ,NPAI0430.MDSE_CD
                  ,NPAI0430.WH_CD
                  ,NPAI0430.STK_STS_TXT
                  ,NPAI0430.INVTY_QTY
                  ,PV.PRNT_VND_CD
                  ,RAV.RCV_ASN_VND_CD
        FROM
                   NPAI0430_01  NPAI0430
                  ,RCV_ASN_VND  RAV
                  ,PO_VND_V     PV
        WHERE
                   NPAI0430.INTERFACE_ID    = #interfaceId#
               AND NPAI0430.TRANSACTION_ID  = #transactionId#
               AND NPAI0430.EZCANCELFLAG    = '0'
               AND RAV.GLBL_CMPY_CD         = #glblCmpyCd#
               AND RAV.VND_SYS_TP_CD        = #vndSysTpCd#
               AND RAV.EZCANCELFLAG         = '0'
               AND RAV.GLBL_CMPY_CD         = PV.GLBL_CMPY_CD
               AND RAV.RCV_ASN_VND_CD       = PV.VND_CD
               AND PV.EZCANCELFLAG          = '0'
               AND NPAI0430.SEGMENT_ID      = (
                       SELECT MAX(A.SEGMENT_ID)
                       FROM NPAI0430_01 A 
                       WHERE
                           A.INTERFACE_ID    = NPAI0430.INTERFACE_ID
                       AND A.TRANSACTION_ID  = NPAI0430.TRANSACTION_ID
                       AND A.EZCANCELFLAG    = '0'
                   )
        ORDER BY
                   NPAI0430.SEGMENT_ID
                  ,NPAI0430.UNIT_ID
                  ,NPAI0430.SEQ_NUMBER
    </statement>

    <statement id="getReceivingInventoriesForOracle" parameterClass="Map" resultClass="Map">
        SELECT
                   NPAI0430.INTERFACE_ID
                  ,NPAI0430.TRANSACTION_ID
                  ,NPAI0430.SEGMENT_ID
                  ,NPAI0430.UNIT_ID
                  ,NPAI0430.SEQ_NUMBER
                  ,NPAI0430.MDSE_CD
                  ,NPAI0430.WH_CD
                  ,NPAI0430.STK_STS_TXT
                  ,NPAI0430.INVTY_QTY
                  ,PV.PRNT_VND_CD
                  ,PV.VND_CD
        FROM
                   NPAI0430_01  NPAI0430
                  ,PO_VND_V     PV
        WHERE
                   NPAI0430.INTERFACE_ID    = #interfaceId#
               AND NPAI0430.TRANSACTION_ID  = #transactionId#
               AND NPAI0430.EZCANCELFLAG    = '0'
               AND PV.GLBL_CMPY_CD          = #glblCmpyCd#
               AND PV.VND_CD                = #vndCd#
               AND PV.EZCANCELFLAG          = '0'
               AND NPAI0430.SEGMENT_ID      = (
                       SELECT MAX(A.SEGMENT_ID)
                       FROM NPAI0430_01 A 
                       WHERE
                           A.INTERFACE_ID    = NPAI0430.INTERFACE_ID
                       AND A.TRANSACTION_ID  = NPAI0430.TRANSACTION_ID
                       AND A.EZCANCELFLAG    = '0'
                   )
        ORDER BY
                   NPAI0430.SEGMENT_ID
                  ,NPAI0430.UNIT_ID
                  ,NPAI0430.SEQ_NUMBER
    </statement>
</sqlMap>