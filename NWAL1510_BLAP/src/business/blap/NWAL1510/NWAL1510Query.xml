<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<sqlMap namespace="NWAL1510Query">

    <typeAlias alias="NWAL1510_BCMsg" type="business.blap.NWAL1510.NWAL1510_BCMsg"/>
    <typeAlias alias="NWAL1510_BSMsg" type="business.blap.NWAL1510.NWAL1510_BSMsg"/>
    <typeAlias alias="NWAL1510_CSMsg" type="business.blap.NWAL1510.NWAL1510_CSMsg"/>
    <typeAlias alias="NWAL1510_DSMsg" type="business.blap.NWAL1510.NWAL1510_DSMsg"/>

    <statement id ="getSvcIstlRuleList" parameterClass="Map"  resultClass="Map">
        SELECT 
            SIR.SVC_ISTL_RULE_NUM 
           ,SIR.SVC_ISTL_RULE_NM
        FROM 
            SVC_ISTL_RULE SIR
        WHERE 
            SIR.EZCANCELFLAG = '0'
        AND SIR.GLBL_CMPY_CD = #glblCmpyCd#
    </statement>

    <statement id ="getCtacPsnTpList" parameterClass="Map"  resultClass="Map">
        SELECT
             CT.CTAC_TP_CD
            ,CT.CTAC_TP_DESC_TXT
            ,CT.CTAC_CUST_REF_TP_CD
        FROM
            CTAC_TP              CT
        WHERE
            CT.EZCANCELFLAG       = '0'
            AND CT.GLBL_CMPY_CD   = #glblCmpyCd#
            AND CT.ACTV_FLG       = #actvFlg#
        ORDER BY CTAC_TP_SORT_NUM ASC
    </statement>

    <statement id ="searchWithConfNum" parameterClass="Map"  resultClass="Map">
        SELECT 
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!--  DCC.DS_CPO_CONFIG_PK --> 
           <!-- ,DCC.SHIP_TO_CUST_ACCT_CD --> 
           <!-- ,DCC.SHIP_TO_CUST_LOC_CD --> 
           <!-- ,DCC.SHIP_TO_FIRST_LINE_ADDR --> 
           <!-- ,DCC.SHIP_TO_SCD_LINE_ADDR --> 
            DCCV.DS_CPO_CONFIG_PK
           ,DCCV.SHIP_TO_CUST_ACCT_CD
           ,DCCV.SHIP_TO_CUST_LOC_CD
           ,DCCV.SHIP_TO_FIRST_LINE_ADDR
           ,DCCV.SHIP_TO_SCD_LINE_ADDR
           <!-- 2019/12/09 QC#54221 Mod End -->
           ,DCV.DS_ORD_CATG_DESC_TXT
           ,DCV.DS_ORD_TP_DESC_TXT
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!-- ,DCV.SHIP_TO_CUST_ACCT_NM -->
           ,DCCV.SHIP_TO_CUST_ACCT_NM
           <!-- 2019/12/09 QC#54221 Mod End -->
           ,DCV.DS_ORD_CATG_CD
           ,DCV.DS_ORD_TP_CD
           ,DCV.DS_ORD_RSN_CD
           <!-- QC#16452 add Start -->
           <!-- 2017/09/13 S21_NA#21069 Mod Start -->
           <!-- ,DCV.BILL_TO_CUST_CD -->
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!-- ,DCC.BILL_TO_CUST_LOC_CD AS BILL_TO_CUST_CD -->
           ,DCCV.BILL_TO_CUST_LOC_CD AS BILL_TO_CUST_CD
           <!-- 2019/12/09 QC#54221 Mod End -->
           <!-- 2017/09/13 S21_NA#21069 Mod End -->
           ,DCV.SOLD_TO_CUST_LOC_CD
           <!-- QC#16452 add End -->
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!-- ,DCC.SHIP_TO_POST_CD -->  <!-- QC#18460 ADD -->
           <!-- ,DCC.SHIP_TO_CTRY_CD -->  <!-- QC#18460 ADD -->
           ,DCCV.SHIP_TO_POST_CD
           ,DCCV.SHIP_TO_CTRY_CD
           <!-- 2019/12/09 QC#54221 Mod End -->
           <!-- 2018/03/09 S21_NA#22387 Add Start -->
           ,SEBTC.LOC_NUM AS SELL_TO_LOC_NUM
           ,BTC.LOC_NUM   AS BILL_TO_LOC_NUM
           ,SHTC.LOC_NUM  AS SHIP_TO_LOC_NUM
           <!-- 2018/03/09 S21_NA#22387 Add End -->
        FROM 
           <!-- 2019/12/09 QC#54221 Mod Start -->
            <!-- DS_CPO_CONFIG DCC -->
            DS_CPO_CONFIG_V DCCV
           <!-- 2019/12/09 QC#54221 Mod End -->
           ,CPO_V      DCV
           <!-- 2018/03/09 S21_NA#22387 Add Start -->
           ,BILL_TO_CUST SEBTC
           ,BILL_TO_CUST BTC
           ,SHIP_TO_CUST SHTC
           <!-- 2018/03/09 S21_NA#22387 Add End -->
        WHERE 
        <!-- 2019/12/09 QC#54221 Mod Start -->
        <!--     DCC.EZCANCELFLAG    = '0' -->
        <!-- AND DCC.GLBL_CMPY_CD    = #glblCmpyCd# -->
        <!-- AND DCC.CPO_ORD_NUM     = #cpoOrdNum# -->
        <!-- AND DCC.DS_ORD_POSN_NUM = #dsOrdPosnNum# -->
        <!-- AND DCC.CONFIG_CATG_CD  = #ConfigCatgCd# -->
        <!-- AND DCC.GLBL_CMPY_CD    = DCV.GLBL_CMPY_CD -->
        <!-- AND DCC.CPO_ORD_NUM     = DCV.CPO_ORD_NUM -->
            DCCV.EZCANCELFLAG    = '0'
        AND DCCV.GLBL_CMPY_CD    = #glblCmpyCd#
        AND DCCV.CPO_ORD_NUM     = #cpoOrdNum#
        AND DCCV.DS_ORD_POSN_NUM = #dsOrdPosnNum#
        AND DCCV.CONFIG_CATG_CD  = #ConfigCatgCd#
        AND DCCV.GLBL_CMPY_CD    = DCV.GLBL_CMPY_CD
        AND DCCV.CPO_ORD_NUM     = DCV.CPO_ORD_NUM
        <!-- 2019/12/09 QC#54221 Mod End -->
        AND DCV.EZCANCELFLAG    = '0'
        <!-- 2018/03/09 S21_NA#22387 Add Start -->
        AND DCV.GLBL_CMPY_CD        = SEBTC.GLBL_CMPY_CD(+)
        AND DCV.SOLD_TO_CUST_LOC_CD = SEBTC.BILL_TO_CUST_CD(+)
        AND SEBTC.EZCANCELFLAG(+)   = '0'
        <!-- 2019/12/09 QC#54221 Mod Start -->
        <!-- AND DCC.GLBL_CMPY_CD        = BTC.GLBL_CMPY_CD(+) -->
        <!-- AND DCC.BILL_TO_CUST_LOC_CD = BTC.BILL_TO_CUST_CD(+) -->
        AND DCCV.GLBL_CMPY_CD        = BTC.GLBL_CMPY_CD(+)
        AND DCCV.BILL_TO_CUST_LOC_CD = BTC.BILL_TO_CUST_CD(+)
        <!-- 2019/12/09 QC#54221 Mod End -->
        AND BTC.EZCANCELFLAG(+)     = '0'
        <!-- 2019/12/09 QC#54221 Mod Start -->
        <!-- AND DCC.GLBL_CMPY_CD        = SHTC.GLBL_CMPY_CD(+) -->
        <!-- AND DCC.SHIP_TO_CUST_LOC_CD = SHTC.SHIP_TO_CUST_CD(+) -->
        AND DCCV.GLBL_CMPY_CD        = SHTC.GLBL_CMPY_CD(+)
        AND DCCV.SHIP_TO_CUST_LOC_CD = SHTC.SHIP_TO_CUST_CD(+)
        <!-- 2019/12/09 QC#54221 Mod End -->
        AND SHTC.EZCANCELFLAG(+)    = '0'
        <!-- 2018/03/09 S21_NA#22387 Add End -->
    </statement>
    
     <statement id ="searchWithOrdNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DCV.DS_ORD_CATG_DESC_TXT
           ,DCV.DS_ORD_TP_DESC_TXT
           ,DCV.SELL_TO_CUST_CD
           ,DCV.ADD_SHIP_TO_CUST_CD
           ,DCV.SHIP_TO_CUST_ACCT_NM
           ,DCV.ADD_SHIP_TO_FIRST_LINE_ADDR
           ,DCV.ADD_SHIP_TO_SCD_LINE_ADDR
           ,DCV.DS_ORD_CATG_CD
           ,DCV.DS_ORD_TP_CD
           ,DCV.DS_ORD_RSN_CD
           <!-- QC#16452 add Start -->
           ,DCV.BILL_TO_CUST_CD
           ,DCV.SOLD_TO_CUST_LOC_CD
           <!-- QC#16452 add End -->
           ,DCV.ADD_SHIP_TO_POST_CD  <!-- QC#18460 ADD -->
           ,DCV.ADD_SHIP_TO_CTRY_CD  <!-- QC#18460 ADD -->
           <!-- 2018/03/09 S21_NA#22387 Add Start -->
           ,SEBTC.LOC_NUM AS SELL_TO_LOC_NUM
           ,BTC.LOC_NUM   AS BILL_TO_LOC_NUM
           ,SHTC.LOC_NUM  AS SHIP_TO_LOC_NUM
           <!-- 2018/03/09 S21_NA#22387 Add End -->
        FROM 
            CPO_V      DCV
           <!-- 2018/03/09 S21_NA#22387 Add Start -->
           ,BILL_TO_CUST SEBTC
           ,BILL_TO_CUST BTC
           ,SHIP_TO_CUST SHTC
           <!-- 2018/03/09 S21_NA#22387 Add End -->
        WHERE 
            DCV.EZCANCELFLAG    = '0'
        AND DCV.GLBL_CMPY_CD    = #glblCmpyCd#
        AND DCV.CPO_ORD_NUM     = #cpoOrdNum#
        <!-- 2018/03/09 S21_NA#22387 Add Start -->
        AND DCV.GLBL_CMPY_CD        = SEBTC.GLBL_CMPY_CD(+)
        AND DCV.SOLD_TO_CUST_LOC_CD = SEBTC.BILL_TO_CUST_CD(+)
        AND SEBTC.EZCANCELFLAG(+)   = '0'
        AND DCV.GLBL_CMPY_CD        = BTC.GLBL_CMPY_CD(+)
        AND DCV.BILL_TO_CUST_CD     = BTC.BILL_TO_CUST_CD(+)
        AND BTC.EZCANCELFLAG(+)     = '0'
        AND DCV.GLBL_CMPY_CD        = SHTC.GLBL_CMPY_CD(+)
        AND DCV.ADD_SHIP_TO_CUST_CD = SHTC.SHIP_TO_CUST_CD(+)
        AND SHTC.EZCANCELFLAG(+)    = '0'
        <!-- 2018/03/09 S21_NA#22387 Add End -->
    </statement>

     <statement id ="getIstlDtlWithConfNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DCI.DS_CPO_ISTL_INFO_PK
           ,DCI.SVC_ISTL_RULE_NUM
           ,DCI.ISTL_DIV_CD
           ,DCI.ISTL_TECH_CD
           ,DCI.RQST_ISTL_DT
           ,DCI.RQST_ISTL_TM
           ,DCI.ISTL_ADDL_CMNT_TXT
           ,DCI.EZUPTIME
           ,DCI.EZUPTIMEZONE
           ,TM.TECH_NM
           <!-- 2019/10/30 QC#53993 Add Start -->
           ,DCI.ISTL_BY_SVC_PRVD_PTY_CD
           ,DCI.SVC_BY_SVC_PRVD_PTY_CD
           <!-- 2019/10/30 QC#53993 Add End -->
        FROM 
            DS_CPO_CONFIG       DCC
           ,DS_CPO_ISTL_INFO    DCI
           ,TECH_MSTR           TM
        WHERE 
	            DCC.EZCANCELFLAG     = '0'
	        AND DCC.GLBL_CMPY_CD     = #glblCmpyCd#
	        AND DCC.CPO_ORD_NUM      = #cpoOrdNum#
	        AND DCC.DS_ORD_POSN_NUM  = #dsOrdPosnNum#
	        AND DCC.CONFIG_CATG_CD   = #ConfigCatgCd#
	        AND DCC.GLBL_CMPY_CD     = DCI.GLBL_CMPY_CD
	        AND DCC.DS_CPO_CONFIG_PK = DCI.DS_CPO_CONFIG_PK
	        AND DCI.EZCANCELFLAG     = '0'
	        AND TM.GLBL_CMPY_CD(+)   = DCI.GLBL_CMPY_CD
	        AND TM.TECH_TOC_CD(+)    = DCI.ISTL_TECH_CD
	        AND TM.EZCANCELFLAG(+)   = '0'
    </statement>
    
    <statement id ="getDefaultInstTypeWithConfNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DM.SVC_ISTL_RULE_NUM
            ,DM.SVC_DEINS_RULE_NUM <!-- 2017/02/16 QC#17639 add  -->
        FROM 
            DS_CPO_CONFIG  DCC
           ,DS_MDL         DM
        WHERE 
            DCC.EZCANCELFLAG     = '0'
        AND DCC.GLBL_CMPY_CD     = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM      = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM  = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD   = #ConfigCatgCd#
        AND DCC.GLBL_CMPY_CD     = DM.GLBL_CMPY_CD
        AND DCC.MDL_ID           = DM.MDL_ID
        AND DM.EZCANCELFLAG      = '0'
    </statement>
    
    <!-- 2023/09/05 K.Watanabe QC#53408 Add Start -->
    <statement id ="getDefaultAccessoryInstTypeWithConfNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            SIR.SVC_ISTL_RULE_NUM
        FROM 
            DS_CPO_CONFIG              DCC
           ,CPO_DTL                    CPOD
           ,MDSE                       MDSE
           ,SVC_ISTL_RULE              SIR
        WHERE 
            DCC.EZCANCELFLAG           = '0'
        AND DCC.GLBL_CMPY_CD           = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM            = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM        = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD         = #ConfigCatgCd#
        <iterate property="configTpCdList" var="configTpCd[]" open="AND DCC.CONFIG_TP_CD IN (" close=")" conjunction=",">
            #configTpCd[]#
        </iterate>
        AND DCC.GLBL_CMPY_CD           = CPOD.GLBL_CMPY_CD
        AND DCC.DS_CPO_CONFIG_PK       = CPOD.DS_CPO_CONFIG_PK
        AND CPOD.EZCANCELFLAG          = '0'
        AND NOT EXISTS (
            SELECT
                1
            FROM
                 CPO_DTL               CPOD
            WHERE
                DCC.CONFIG_TP_CD       = 'O02'
            AND DCC.GLBL_CMPY_CD       = CPOD.GLBL_CMPY_CD
            AND DCC.DS_CPO_CONFIG_PK   = CPOD.DS_CPO_CONFIG_PK
            AND CPOD.EZCANCELFLAG      = '0'
            AND CPOD.BASE_CMPT_FLG     = 'Y'
            AND ROWNUM                 = '1'
        )
        AND CPOD.GLBL_CMPY_CD          = MDSE.GLBL_CMPY_CD
        AND (
            CPOD.MDSE_CD = MDSE.MDSE_CD
                OR EXISTS (
                    SELECT
                        MDSE.MDSE_CD
                    FROM
                        ORD_TAKE_MDSE OTM
                    WHERE
                        CPOD.GLBL_CMPY_CD = OTM.GLBL_CMPY_CD
                    AND CPOD.MDSE_CD      = OTM.ORD_TAKE_MDSE_CD
                    AND OTM.MDSE_CD       = MDSE.MDSE_CD
                    AND OTM.EZCANCELFLAG  = '0'
                )
            )
        AND MDSE.EZCANCELFLAG          = '0'
        AND NOT EXISTS (
            SELECT
                1
            FROM
                CPO_DTL                CPOD
               ,MDSE                   MDSE
               ,SVC_MACH_MSTR          SMM
            WHERE
                DCC.CONFIG_TP_CD       = 'O06'
            AND DCC.GLBL_CMPY_CD       = CPOD.GLBL_CMPY_CD
            AND DCC.DS_CPO_CONFIG_PK   = CPOD.DS_CPO_CONFIG_PK
            AND CPOD.EZCANCELFLAG      = '0'
            AND CPOD.GLBL_CMPY_CD      = MDSE.GLBL_CMPY_CD
            AND (
                CPOD.MDSE_CD = MDSE.MDSE_CD
                    OR EXISTS (
                        SELECT
                            MDSE.MDSE_CD
                        FROM
                            ORD_TAKE_MDSE OTM
                        WHERE
                            CPOD.GLBL_CMPY_CD = OTM.GLBL_CMPY_CD
                        AND CPOD.MDSE_CD      = OTM.ORD_TAKE_MDSE_CD
                        AND OTM.MDSE_CD       = MDSE.MDSE_CD
                        AND OTM.EZCANCELFLAG  = '0'
                    )
                )
            AND MDSE.EZCANCELFLAG      = '0'
            AND MDSE.GLBL_CMPY_CD      = SMM.GLBL_CMPY_CD
            AND MDSE.MDSE_CD           = SMM.MDSE_CD
            AND SMM.EZCANCELFLAG       = '0'
            AND SMM.SVC_MACH_TP_CD     = #svcMachTpCd#
            AND ROWNUM                 = '1'
        )
        AND MDSE.SVC_ISTL_RULE_NUM     = SIR.SVC_ISTL_RULE_NUM(+)
        AND MDSE.GLBL_CMPY_CD          = SIR.GLBL_CMPY_CD(+)
        AND SIR.EZCANCELFLAG(+)        = '0'
        ORDER BY
             SIR.AUTO_ISTL_CALL_FLG DESC
            ,SIR.SVC_ISTL_RULE_NUM ASC
    </statement>
    <!-- 2023/09/05 K.Watanabe QC#53408 Add End -->
    
    <statement id ="getIstlDtlWithOrdNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DCI.DS_CPO_ISTL_INFO_PK
           ,DCI.SVC_ISTL_RULE_NUM
           ,DCI.ISTL_DIV_CD
           ,DCI.ISTL_TECH_CD
           ,DCI.RQST_ISTL_DT
           ,DCI.RQST_ISTL_TM
           ,DCI.ISTL_ADDL_CMNT_TXT
           ,DCI.EZUPTIME
           ,DCI.EZUPTIMEZONE
           ,TM.TECH_NM
           <!-- 2019/10/30 QC#53993 Add Start -->
           ,DCI.ISTL_BY_SVC_PRVD_PTY_CD
           ,DCI.SVC_BY_SVC_PRVD_PTY_CD
           <!-- 2019/10/30 QC#53993 Add End -->
        FROM 
            DS_CPO_ISTL_INFO   DCI
           ,TECH_MSTR          TM
        WHERE 
	            DCI.EZCANCELFLAG     = '0'
	        AND DCI.GLBL_CMPY_CD     = #glblCmpyCd#
	        AND DCI.CPO_ORD_NUM      = #cpoOrdNum#
	        AND DCI.DS_CPO_CONFIG_PK IS NULL
	        AND TM.GLBL_CMPY_CD(+)   = DCI.GLBL_CMPY_CD
	        AND TM.TECH_TOC_CD(+)    = DCI.ISTL_TECH_CD
	        AND TM.EZCANCELFLAG(+)   = '0'
    </statement>
    
     <statement id ="getDeliveryDtlWithConfNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DCD.DS_CPO_DELY_INFO_PK
           ,DCD.RDD_DT
           ,DCD.OPS_FROM_HOUR_MN
           ,DCD.OPS_TO_HOUR_MN
           ,DCD.LOAD_DOCK_AVAL_FLG
           ,DCD.STAIR_CRAW_REQ_FLG
           ,DCD.STAIR_CRAW_NUM
           ,DCD.ELEV_AVAL_FLG
           ,DCD.DELY_ADDL_CMNT_TXT
           ,DCD.EZUPTIME
           ,DCD.EZUPTIMEZONE
        <!-- 2019/12/26 QC#54725 Add Srart -->
           ,DCD.DELY_SCHD_STS_CD
           ,DCD.DELY_SCHD_CMNT_CLOD
        <!-- 2019/12/26 QC#54725 Add End -->
        FROM 
            DS_CPO_CONFIG       DCC
           ,DS_CPO_DELY_INFO    DCD
        WHERE 
            DCC.EZCANCELFLAG     = '0'
        AND DCC.GLBL_CMPY_CD     = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM      = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM  = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD   = #ConfigCatgCd#
        AND DCC.GLBL_CMPY_CD     = DCD.GLBL_CMPY_CD
        AND DCC.DS_CPO_CONFIG_PK = DCD.DS_CPO_CONFIG_PK
        AND DCD.EZCANCELFLAG     = '0'
    </statement>
    
    <statement id ="getDeliveryDtlWithOrdNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DCD.DS_CPO_DELY_INFO_PK
           ,DCD.RDD_DT
           ,DCD.OPS_FROM_HOUR_MN
           ,DCD.OPS_TO_HOUR_MN
           ,DCD.LOAD_DOCK_AVAL_FLG
           ,DCD.STAIR_CRAW_REQ_FLG
           ,DCD.STAIR_CRAW_NUM
           ,DCD.ELEV_AVAL_FLG
           ,DCD.DELY_ADDL_CMNT_TXT
           ,DCD.EZUPTIME
           ,DCD.EZUPTIMEZONE
        <!-- 2019/12/26 QC#54725 Add Srart -->
           ,DCD.DELY_SCHD_STS_CD
           ,DCD.DELY_SCHD_CMNT_CLOD
        <!-- 2019/12/26 QC#54725 Add End -->
        FROM 
            DS_CPO_DELY_INFO    DCD
        WHERE 
            DCD.EZCANCELFLAG     = '0'
        AND DCD.GLBL_CMPY_CD     = #glblCmpyCd#
        AND DCD.CPO_ORD_NUM      = #cpoOrdNum#
        AND DCD.DS_CPO_CONFIG_PK IS NULL
    </statement>
    
    <statement id ="getInstDtlListbyConfNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            F.FSR_CPLT_DT
           ,F.FSR_CPLT_TM
           ,F.TECH_CD
           <!-- Mod Start 2017/08/25 QC#20623 -->
           ,SUBSTR(F.EZUPTIME, 1, 14) AS LAST_UPD_TS
           ,DSC.DS_SVC_CALL_TP_NM
           ,F.FSR_NUM
           ,ST.SVC_TASK_NUM
           <!-- Mod End 2017/08/25 QC#20623 -->
           ,FV.FSR_VISIT_SCHD_DT
           ,FV.FSR_VISIT_SCHD_TM
           ,STS.SVC_TASK_STS_NM
        FROM 
            DS_CPO_CONFIG  DCC
           <!-- START 2023/12/12 K.Watanabe [QC#61300,ADD] -->
           <isEqual property="ConfigCatgCd" compareValue="I">
           ,DS_CPO_RTRN_DTL  DCD
           </isEqual>
           <isNotEqual property="ConfigCatgCd" compareValue="I">
           <!-- END   2023/12/12 K.Watanabe [QC#61300,ADD] -->
           ,CPO_DTL     DCD
           <!-- START 2023/12/12 K.Watanabe [QC#61300,ADD] -->
           </isNotEqual>
           <!-- END   2023/12/12 K.Watanabe [QC#61300,ADD] -->
           ,SVC_MACH_MSTR  SMM
           ,SVC_TASK       ST
           ,FSR            F
           ,DS_SVC_CALL_TP DSC
           ,FSR_VISIT      FV
           ,SVC_TASK_STS   STS
 
        <!-- Mod Start 2017/08/28 QC#20649 -->
        WHERE 
            DCC.EZCANCELFLAG         = '0'
        AND DCC.GLBL_CMPY_CD         = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM      = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD       = #ConfigCatgCd#
        AND DCC.GLBL_CMPY_CD         = DCD.GLBL_CMPY_CD
        AND DCC.CPO_ORD_NUM          = DCD.CPO_ORD_NUM
        AND DCC.DS_ORD_POSN_NUM      = DCD.DS_ORD_POSN_NUM
        AND DCD.EZCANCELFLAG         = '0'
        AND DCC.GLBL_CMPY_CD         = SMM.GLBL_CMPY_CD
        <!-- START 2023/12/12 K.Watanabe [QC#61300,ADD] -->
        <isEqual property="ConfigCatgCd" compareValue="I">
        AND DCC.CPO_ORD_NUM          = SMM.TRX_HDR_NUM
        AND DCD.DS_CPO_RTRN_LINE_NUM = SMM.TRX_LINE_NUM
        AND DCD.DS_CPO_RTRN_LINE_SUB_NUM = SMM.TRX_LINE_SUB_NUM
        </isEqual>
        <isNotEqual property="ConfigCatgCd" compareValue="I">
        <!-- END   2023/12/12 K.Watanabe [QC#61300,ADD] -->
        AND DCC.CPO_ORD_NUM          = SMM.CPO_ORD_NUM
        AND DCD.CPO_DTL_LINE_NUM     = SMM.CPO_DTL_LINE_NUM
        AND DCD.CPO_DTL_LINE_SUB_NUM = SMM.CPO_DTL_LINE_SUB_NUM
        <!-- START 2023/12/12 K.Watanabe [QC#61300,ADD] -->
        </isNotEqual>
        <!-- END   2023/12/12 K.Watanabe [QC#61300,ADD] -->
        AND SMM.EZCANCELFLAG         = '0'
        AND SMM.GLBL_CMPY_CD         = F.GLBL_CMPY_CD
        AND SMM.SVC_MACH_MSTR_PK     = F.SVC_MACH_MSTR_PK
        AND F.EZCANCELFLAG           = '0'
        AND F.GLBL_CMPY_CD           = FV.GLBL_CMPY_CD
        AND F.FSR_NUM                = FV.FSR_NUM
        AND FV.EZCANCELFLAG          = '0'
        AND FV.GLBL_CMPY_CD          = ST.GLBL_CMPY_CD
        AND FV.SVC_TASK_NUM          = ST.SVC_TASK_NUM
        AND ST.EZCANCELFLAG          = '0'
        AND ST.GLBL_CMPY_CD          = DSC.GLBL_CMPY_CD
        AND ST.DS_SVC_CALL_TP_CD     = DSC.DS_SVC_CALL_TP_CD
        <!-- START 2023/12/12 K.Watanabe [QC#61300,MOD] -->
        <!-- QC#60570 Add start -->
        <!-- AND DSC.SVC_ISTL_REQ_FLG     = 'Y' -->
        <!-- QC#60570 Add end -->
        <isEqual property="ConfigCatgCd" compareValue="I">
        AND DSC.SVC_DEINS_REQ_FLG    = #reqFlg#
        </isEqual>
        <isNotEqual property="ConfigCatgCd" compareValue="I">
        AND DSC.SVC_ISTL_REQ_FLG     = #reqFlg#
        </isNotEqual>
        <!-- END   2023/12/12 K.Watanabe [QC#61300,MOD] -->
        AND DSC.EZCANCELFLAG         = '0'
        AND ST.GLBL_CMPY_CD          = STS.GLBL_CMPY_CD
        AND ST.SVC_TASK_STS_CD       = STS.SVC_TASK_STS_CD
        AND STS.EZCANCELFLAG         = '0'
        <!-- Mod Start 2017/08/28 QC#20649 -->
    </statement>
    
    <statement id ="getInstDtlListbyOrdNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            F.FSR_CPLT_DT
           ,F.FSR_CPLT_TM
           ,F.TECH_CD
           <!-- Mod Start 2017/08/25 QC#20623 -->
           ,SUBSTR(F.EZUPTIME, 1, 14) AS LAST_UPD_TS
           ,DSC.DS_SVC_CALL_TP_NM
           ,F.FSR_NUM
           ,ST.SVC_TASK_NUM
           <!-- Mod End 2017/08/25 QC#20623 -->
           ,FV.FSR_VISIT_SCHD_DT
           ,FV.FSR_VISIT_SCHD_TM
           ,STS.SVC_TASK_STS_NM
        FROM 
            SVC_MACH_MSTR  SMM
           ,SVC_TASK       ST
           ,FSR            F
           ,DS_SVC_CALL_TP DSC
           ,FSR_VISIT      FV
           ,SVC_TASK_STS   STS

        <!-- Mod Start 2017/08/28 QC#20649 -->
        WHERE 
            SMM.EZCANCELFLAG         = '0'
        AND SMM.GLBL_CMPY_CD         = #glblCmpyCd#
        AND SMM.CPO_ORD_NUM          = #cpoOrdNum#
        AND SMM.GLBL_CMPY_CD         = F.GLBL_CMPY_CD
        AND SMM.SVC_MACH_MSTR_PK     = F.SVC_MACH_MSTR_PK
        AND F.EZCANCELFLAG           = '0'
        AND F.GLBL_CMPY_CD           = FV.GLBL_CMPY_CD
        AND F.FSR_NUM                = FV.FSR_NUM
        AND FV.EZCANCELFLAG          = '0'
        AND FV.GLBL_CMPY_CD          = ST.GLBL_CMPY_CD
        AND FV.SVC_TASK_NUM          = ST.SVC_TASK_NUM
        AND ST.EZCANCELFLAG          = '0'
        AND ST.GLBL_CMPY_CD          = DSC.GLBL_CMPY_CD
        AND ST.DS_SVC_CALL_TP_CD     = DSC.DS_SVC_CALL_TP_CD
        AND DSC.EZCANCELFLAG         = '0'
        AND ST.GLBL_CMPY_CD          = STS.GLBL_CMPY_CD
        AND ST.SVC_TASK_STS_CD       = STS.SVC_TASK_STS_CD
        AND STS.EZCANCELFLAG         = '0'
        <!-- Mod Start 2017/08/28 QC#20649 -->
    </statement>
    
    <statement id ="getSiteSurveybyConfNum" parameterClass="Map"  resultClass="Map">
        SELECT 
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!-- DCV.SHIP_TO_CUST_ACCT_NM      --> 
           <!-- ,DCC.SHIP_TO_CUST_LOC_CD      -->
           <!-- ,DCC.SHIP_TO_FIRST_LINE_ADDR  -->
           <!-- ,DCC.SHIP_TO_CTY_ADDR         -->
           <!-- ,DCC.SHIP_TO_ST_CD            -->
           <!-- ,DCC.SHIP_TO_POST_CD          -->
            DCCV.SHIP_TO_CUST_ACCT_NM
           ,DCCV.SHIP_TO_CUST_LOC_CD
           ,DCCV.SHIP_TO_FIRST_LINE_ADDR
           ,DCCV.SHIP_TO_CTY_ADDR
           ,DCCV.SHIP_TO_ST_CD
           ,DCCV.SHIP_TO_POST_CD
           <!-- 2019/12/09 QC#54221 Mod End -->
           ,DSS.DS_SITE_SRVY_PK
           ,DSS.CMPY_INFO_APT_BLDG_NM
           ,DSS.CMPY_INFO_FL_NM
           ,DSS.CMPY_INFO_DEPT_NM
           ,DSS.ELEV_PROT_REQ_FLG
           ,DSS.SITE_SRVY_ADDL_CMNT_TXT
           ,DSS.OTSD_STEP_NUM
           ,DSS.INSD_STEP_NUM
           ,DSS.STAIR_CRAW_REQ_FLG
           ,DSS.FLGT_STAIR_NUM
           ,DSS.STAIR_AND_LDG_WDT
           ,DSS.LOAD_DOCK_AVAL_FLG
           ,DSS.LOAD_DOCK_HGT
           ,DSS.LOAD_DOCK_AVAL_FROM_HOUR_MN
           ,DSS.LOAD_DOCK_AVAL_TO_HOUR_MN
           ,DSS.TRCTR_AND_TRAIL_ACCS_FLG
           ,DSS.CARR_DELY_TM_HOUR_MN
           ,DSS.DELY_TRNSP_OPT_CD
           ,DSS.ELEV_AVAL_FLG
           ,DSS.ELEV_AVAL_FROM_HOUR_MN
           ,DSS.ELEV_AVAL_TO_HOUR_MN
           ,DSS.ELEV_APPT_REQ_FLG
           ,DSS.ELEV_CTAC_PSN_NM
           ,DSS.ELEV_CTAC_TEL_NUM
           ,DSS.BLDG_ENT_DOOR_HGT
           ,DSS.BLDG_ENT_DOOR_WDT
           ,DSS.CRDR_WDT
           ,DSS.DOOR_WDT
           ,DSS.ELEV_WDT
           ,DSS.ELEV_DEPTH_NUM
           ,DSS.ELEV_CAP_WT
           ,DSS.ELEV_DOOR_HGT
           ,DSS.ELEV_DOOR_WDT
           ,DSS.EZUPTIME
           ,DSS.EZUPTIMEZONE
        FROM 
           <!-- 2019/12/09 QC#54221 Mod Start -->
            <!-- DS_CPO_CONFIG DCC -->
            DS_CPO_CONFIG_V DCCV
           <!-- 2019/12/09 QC#54221 Mod End -->
           ,DS_SITE_SRVY  DSS
           <!-- 2019/12/09 QC#54221 Del Start -->
           <!-- ,CPO_V      DCV -->
           <!-- 2019/12/09 QC#54221 Del End -->
        WHERE 
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!--     DCC.EZCANCELFLAG         = '0' -->
           <!-- AND DCC.GLBL_CMPY_CD         = #glblCmpyCd# -->
           <!-- AND DCC.CPO_ORD_NUM          = #cpoOrdNum# -->
           <!-- AND DCC.DS_ORD_POSN_NUM      = #dsOrdPosnNum# -->
           <!-- AND DCC.CONFIG_CATG_CD       = #ConfigCatgCd# -->
           <!-- AND DCC.GLBL_CMPY_CD         = DSS.GLBL_CMPY_CD(+) -->
           <!-- AND DCC.CPO_ORD_NUM          = DSS.CPO_ORD_NUM(+) -->
           <!-- AND DCC.DS_CPO_CONFIG_PK     = DSS.DS_CPO_CONFIG_PK(+) -->
           <!-- AND DSS.EZCANCELFLAG(+)      = '0' -->
           <!-- AND DCV.GLBL_CMPY_CD         = DCC.GLBL_CMPY_CD -->
           <!-- AND DCV.CPO_ORD_NUM          = DCC.CPO_ORD_NUM -->
           <!-- AND DCV.EZCANCELFLAG         = '0' -->
                DCCV.EZCANCELFLAG         = '0'
            AND DCCV.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCCV.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCCV.DS_ORD_POSN_NUM      = #dsOrdPosnNum#
            AND DCCV.CONFIG_CATG_CD       = #ConfigCatgCd#
            AND DCCV.GLBL_CMPY_CD         = DSS.GLBL_CMPY_CD(+)
            AND DCCV.CPO_ORD_NUM          = DSS.CPO_ORD_NUM(+)
            AND DCCV.DS_CPO_CONFIG_PK     = DSS.DS_CPO_CONFIG_PK(+)
            AND DSS.EZCANCELFLAG(+)       = '0'
           <!-- 2019/12/09 QC#54221 Mod End -->
    </statement>
    
   <statement id ="getSiteSurveybyOrdNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DCV.SHIP_TO_CUST_ACCT_NM
           ,DCV.ADD_SHIP_TO_CUST_CD           AS SHIP_TO_CUST_LOC_CD
           ,DCV.ADD_SHIP_TO_FIRST_LINE_ADDR   AS SHIP_TO_FIRST_LINE_ADDR
           ,DCV.ADD_SHIP_TO_CTY_ADDR          AS SHIP_TO_CTY_ADDR
           ,DCV.ADD_SHIP_TO_ST_CD             AS SHIP_TO_ST_CD
           ,DCV.ADD_SHIP_TO_POST_CD           AS SHIP_TO_POST_CD
           ,DSS.DS_SITE_SRVY_PK
           ,DSS.CMPY_INFO_APT_BLDG_NM
           ,DSS.CMPY_INFO_FL_NM
           ,DSS.CMPY_INFO_DEPT_NM
           ,DSS.ELEV_PROT_REQ_FLG
           ,DSS.SITE_SRVY_ADDL_CMNT_TXT
           ,DSS.OTSD_STEP_NUM
           ,DSS.INSD_STEP_NUM
           ,DSS.STAIR_CRAW_REQ_FLG
           ,DSS.FLGT_STAIR_NUM
           ,DSS.STAIR_AND_LDG_WDT
           ,DSS.LOAD_DOCK_AVAL_FLG
           ,DSS.LOAD_DOCK_HGT
           ,DSS.LOAD_DOCK_AVAL_FROM_HOUR_MN
           ,DSS.LOAD_DOCK_AVAL_TO_HOUR_MN
           ,DSS.TRCTR_AND_TRAIL_ACCS_FLG
           ,DSS.CARR_DELY_TM_HOUR_MN
           ,DSS.DELY_TRNSP_OPT_CD
           ,DSS.ELEV_AVAL_FLG
           ,DSS.ELEV_AVAL_FROM_HOUR_MN
           ,DSS.ELEV_AVAL_TO_HOUR_MN
           ,DSS.ELEV_APPT_REQ_FLG
           ,DSS.ELEV_CTAC_PSN_NM
           ,DSS.ELEV_CTAC_TEL_NUM
           ,DSS.BLDG_ENT_DOOR_HGT
           ,DSS.BLDG_ENT_DOOR_WDT
           ,DSS.CRDR_WDT
           ,DSS.DOOR_WDT
           ,DSS.ELEV_WDT
           ,DSS.ELEV_DEPTH_NUM
           ,DSS.ELEV_CAP_WT
           ,DSS.ELEV_DOOR_HGT
           ,DSS.ELEV_DOOR_WDT
           ,DSS.EZUPTIME
           ,DSS.EZUPTIMEZONE
        FROM 
            CPO_V      DCV
           ,DS_SITE_SRVY  DSS
        WHERE 
            DCV.EZCANCELFLAG        = '0'
	    AND DCV.GLBL_CMPY_CD        = #glblCmpyCd#
	    AND DCV.CPO_ORD_NUM         = #cpoOrdNum#
	    AND DCV.GLBL_CMPY_CD        = DSS.GLBL_CMPY_CD(+)
	    AND DCV.CPO_ORD_NUM         = DSS.CPO_ORD_NUM(+)
	    AND DSS.DS_CPO_CONFIG_PK    IS NULL
	    AND DSS.EZCANCELFLAG(+)     = '0'
    </statement>
    
   <statement id ="getMaterialInfobyConfNum" parameterClass="Map"  resultMap="result.getMaterialInfo">
        SELECT 
            M.MDSE_CD
           ,M.MDSE_DESC_SHORT_TXT
           ,MSP.IN_POUND_WT
           ,MSP.IN_INCH_LG
           ,MSP.IN_INCH_WDT
           ,MSP.IN_INCH_HGT
           ,ROUND(SQRT(POWER(MSP.IN_INCH_LG, 2) + POWER(MSP.IN_INCH_WDT, 2) + POWER(MSP.IN_INCH_HGT,2)), 4) AS IN_INCH_DG
        FROM 
            DS_CPO_CONFIG  DCC
           ,CPO_DTL        CD
           ,ORD_TAKE_MDSE  OTM
           ,MDSE           M
           ,MDSE_STORE_PKG MSP
        WHERE 
            DCC.EZCANCELFLAG          = '0'
        AND DCC.GLBL_CMPY_CD          = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM           = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM       = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD        = #ConfigCatgCd#
        AND CD.EZCANCELFLAG          = '0'
        AND CD.GLBL_CMPY_CD          = DCC.GLBL_CMPY_CD
        AND CD.DS_CPO_CONFIG_PK      = DCC.DS_CPO_CONFIG_PK

        AND CD.GLBL_CMPY_CD          = OTM.GLBL_CMPY_CD(+)
        AND CD.MDSE_CD                = OTM.ORD_TAKE_MDSE_CD(+)
        AND OTM.EZCANCELFLAG(+)       = '0'
        AND CD.GLBL_CMPY_CD          = M.GLBL_CMPY_CD
        AND (
                CD.MDSE_CD            = M.MDSE_CD
             OR OTM.MDSE_CD           = M.MDSE_CD 
            )
        AND M.EZCANCELFLAG            = '0'
        AND CD.GLBL_CMPY_CD          = MSP.GLBL_CMPY_CD
        AND M.MDSE_CD                 = MSP.MDSE_CD
        AND MSP.PKG_UOM_CD            = #pkgUomCd#
        AND MSP.EZCANCELFLAG          = '0'
    </statement>
    
    <statement id ="getMaterialRtnInfobyConfNum" parameterClass="Map"  resultMap="result.getMaterialInfo">
        SELECT 
            M.MDSE_CD
           ,M.MDSE_DESC_SHORT_TXT
           ,MSP.IN_POUND_WT
           ,MSP.IN_INCH_LG
           ,MSP.IN_INCH_WDT
           ,MSP.IN_INCH_HGT
           ,ROUND(SQRT(POWER(MSP.IN_INCH_LG, 2) + POWER(MSP.IN_INCH_WDT, 2) + POWER(MSP.IN_INCH_HGT,2)), 4) AS IN_INCH_DG
        FROM 
            DS_CPO_CONFIG    DCC
           ,DS_CPO_RTRN_DTL  DCRD
           ,ORD_TAKE_MDSE    OTM
           ,MDSE             M
           ,MDSE_STORE_PKG   MSP
        WHERE 
            DCC.EZCANCELFLAG               = '0'
        AND DCC.GLBL_CMPY_CD               = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM                = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM            = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD             = #ConfigCatgCd#
        AND DCRD.EZCANCELFLAG              = '0'
        AND DCRD.GLBL_CMPY_CD              = DCC.GLBL_CMPY_CD
        AND DCRD.DS_CPO_CONFIG_PK          = DCC.DS_CPO_CONFIG_PK
        AND DCC.GLBL_CMPY_CD               = OTM.GLBL_CMPY_CD(+)
        AND DCRD.MDSE_CD                   = OTM.ORD_TAKE_MDSE_CD(+)
        AND OTM.EZCANCELFLAG(+)            = '0'
        AND DCC.GLBL_CMPY_CD               = M.GLBL_CMPY_CD
        AND (
                DCRD.MDSE_CD               = M.MDSE_CD
             OR OTM.MDSE_CD                = M.MDSE_CD 
            )
        AND M.EZCANCELFLAG                 = '0'
        AND DCC.GLBL_CMPY_CD               = MSP.GLBL_CMPY_CD
        AND M.MDSE_CD                      = MSP.MDSE_CD
        AND MSP.PKG_UOM_CD                 = #pkgUomCd#
        AND MSP.EZCANCELFLAG               = '0'
    </statement>
    
    <statement id ="getMaterialInfobyOrdNum" parameterClass="Map"  resultMap="result.getMaterialInfo">
        SELECT 
            M.MDSE_CD
           ,M.MDSE_DESC_SHORT_TXT
           ,MSP.IN_POUND_WT
           ,MSP.IN_INCH_LG
           ,MSP.IN_INCH_WDT
           ,MSP.IN_INCH_HGT
           ,ROUND(SQRT(POWER(MSP.IN_INCH_LG, 2) + POWER(MSP.IN_INCH_WDT, 2) + POWER(MSP.IN_INCH_HGT,2)), 4) AS IN_INCH_DG
        FROM 
            CPO              C
           ,CPO_DTL          CD
           ,ORD_TAKE_MDSE    OTM
           ,MDSE             M
           ,MDSE_STORE_PKG   MSP
        WHERE 
            C.EZCANCELFLAG            = '0'
        AND C.GLBL_CMPY_CD            = #glblCmpyCd#
        AND C.CPO_ORD_NUM             = #cpoOrdNum#
        AND C.GLBL_CMPY_CD            = CD.GLBL_CMPY_CD
        AND C.CPO_ORD_NUM             = CD.CPO_ORD_NUM
        AND CD.EZCANCELFLAG           = '0'
        AND C.GLBL_CMPY_CD            = OTM.GLBL_CMPY_CD(+)
        AND CD.MDSE_CD                = OTM.ORD_TAKE_MDSE_CD(+)
        AND OTM.EZCANCELFLAG(+)       = '0'
        AND C.GLBL_CMPY_CD            = M.GLBL_CMPY_CD
        AND (
                CD.MDSE_CD            = M.MDSE_CD
             OR OTM.MDSE_CD           = M.MDSE_CD 
            )
        AND M.EZCANCELFLAG            = '0'
        AND C.GLBL_CMPY_CD            = MSP.GLBL_CMPY_CD
        AND M.MDSE_CD                 = MSP.MDSE_CD
        AND MSP.PKG_UOM_CD            = #pkgUomCd#
        AND MSP.EZCANCELFLAG          = '0'
    </statement>

    <!-- 2018/03/26 QC#22954 Add Start -->
    <statement id ="getMaterialRtrnInfobyOrdNum" parameterClass="Map"  resultMap="result.getMaterialInfo">
        SELECT 
            M.MDSE_CD
           ,M.MDSE_DESC_SHORT_TXT
           ,MSP.IN_POUND_WT
           ,MSP.IN_INCH_LG
           ,MSP.IN_INCH_WDT
           ,MSP.IN_INCH_HGT
           ,ROUND(SQRT(POWER(MSP.IN_INCH_LG, 2) + POWER(MSP.IN_INCH_WDT, 2) + POWER(MSP.IN_INCH_HGT,2)), 4) AS IN_INCH_DG
        FROM 
            CPO              C
           ,DS_CPO_RTRN_DTL  RD
           ,ORD_TAKE_MDSE    OTM
           ,MDSE             M
           ,MDSE_STORE_PKG   MSP
        WHERE 
            C.EZCANCELFLAG            = '0'
        AND C.GLBL_CMPY_CD            = #glblCmpyCd#
        AND C.CPO_ORD_NUM             = #cpoOrdNum#
        AND C.GLBL_CMPY_CD            = RD.GLBL_CMPY_CD
        AND C.CPO_ORD_NUM             = RD.CPO_ORD_NUM
        AND RD.EZCANCELFLAG           = '0'
        AND C.GLBL_CMPY_CD            = OTM.GLBL_CMPY_CD(+)
        AND RD.MDSE_CD                = OTM.ORD_TAKE_MDSE_CD(+)
        AND OTM.EZCANCELFLAG(+)       = '0'
        AND C.GLBL_CMPY_CD            = M.GLBL_CMPY_CD
        AND (
                RD.MDSE_CD            = M.MDSE_CD
             OR OTM.MDSE_CD           = M.MDSE_CD 
            )
        AND M.EZCANCELFLAG            = '0'
        AND C.GLBL_CMPY_CD            = MSP.GLBL_CMPY_CD
        AND M.MDSE_CD                 = MSP.MDSE_CD
        AND MSP.PKG_UOM_CD            = #pkgUomCd#
        AND MSP.EZCANCELFLAG          = '0'
    </statement>
    <!-- 2018/03/26 QC#22954 Add End -->

    <!-- 2017/02/09 QC#17500 Mod Start -->
    <resultMap id="result.getMaterialInfo"   class="NWAL1510_BSMsg">
        <result property="mdseCd_B0"            column="MDSE_CD"             javaType="EZDSStringItem"/>
        <result property="mdseDescShortTxt_B0"  column="MDSE_DESC_SHORT_TXT" javaType="EZDSStringItem"/>
        <result property="inPoundWt_B0"         column="IN_POUND_WT"         javaType="EZDSBigDecimalItem"/>
        <result property="inInchLg_B0"          column="IN_INCH_LG"          javaType="EZDSBigDecimalItem"/>
        <result property="inInchWdt_B0"         column="IN_INCH_WDT"         javaType="EZDSBigDecimalItem"/>
        <result property="inInchHgt_B0"         column="IN_INCH_HGT"         javaType="EZDSBigDecimalItem"/>
        <result property="xxInInchDgnlNum_B0"   column="IN_INCH_DG"          javaType="EZDSBigDecimalItem"/>
    </resultMap>
    <!-- 2017/02/09 QC#17500 Mod End -->
    <statement id ="getConfigurationNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DCC.DS_CPO_CONFIG_PK 
        FROM 
            CPO             C
           ,DS_CPO_CONFIG   DCC
        WHERE 
            C.EZCANCELFLAG      = '0'
        AND C.GLBL_CMPY_CD      = #glblCmpyCd#
        AND C.CPO_ORD_NUM       = #cpoOrdNum#
        AND C.GLBL_CMPY_CD      = DCC.GLBL_CMPY_CD
        AND C.CPO_ORD_NUM       = DCC.CPO_ORD_NUM
        AND DCC.CONFIG_CATG_CD  = #ConfigCatgCd#
        AND DCC.DS_ORD_POSN_NUM = #dsOrdPosnNum#
        AND DCC.EZCANCELFLAG    = '0'
    </statement>

    <statement id ="countDsCpoCtacPsnRecordNum" parameterClass="Map"  resultMap="Integer">
        SELECT
            COUNT(*)
        FROM
            DS_CPO_CTAC_PSN D
        WHERE
            D.CPO_ORD_NUM            = #cpoOrdNum#
       <isNotNull property="dsCpoConfigPk">
        AND D.DS_CPO_CONFIG_PK       = #dsCpoConfigPk#
       </isNotNull>
        AND D.GLBL_CMPY_CD           = #glblCmpyCd#
    </statement>

    <statement id ="getCtacListbyConfNum" parameterClass="Map"  resultMap="result.ConstactList">
        SELECT 
            DCCP.DS_CPO_CTAC_PSN_PK
           ,DCCP.CTAC_PSN_PK
           ,DCCP.CTAC_PSN_TP_CD
           ,DCCP.CTAC_PSN_FIRST_NM
           ,DCCP.CTAC_PSN_LAST_NM
           ,DCCP.CTAC_PSN_TEL_NUM
           ,DCCP.CTAC_PSN_EXTN_NUM
           ,DCCP.CTAC_PSN_EML_ADDR
           ,DCCP.CTAC_PSN_FAX_NUM
           ,DCCP.EZUPTIME
           ,DCCP.EZUPTIMEZONE
           ,DCCP.CTAC_CUST_REF_TP_CD
        FROM 
            DS_CPO_CONFIG     DCC
           ,DS_CPO_CTAC_PSN   DCCP
        WHERE 
            DCC.EZCANCELFLAG          = '0'
        AND DCC.GLBL_CMPY_CD          = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM           = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM       = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD        = #ConfigCatgCd#
        AND DCC.GLBL_CMPY_CD          = DCCP.GLBL_CMPY_CD
        AND DCC.CPO_ORD_NUM           = DCCP.CPO_ORD_NUM
        AND DCC.DS_CPO_CONFIG_PK      = DCCP.DS_CPO_CONFIG_PK
        AND DCCP.EZCANCELFLAG         = '0'
    </statement>
    <resultMap id="result.ConstactList"   class="NWAL1510_CSMsg">
        <result property="dsCpoCtacPsnPk_C0"   column="DS_CPO_CTAC_PSN_PK"   javaType="EZDSBigDecimalItem"/>
        <result property="ctacPsnPk_C0"        column="CTAC_PSN_PK"          javaType="EZDSBigDecimalItem"/>
        <result property="ctacPsnTpCd_C0"      column="CTAC_PSN_TP_CD"       javaType="EZDSStringItem"/>
        <result property="ctacPsnFirstNm_C0"   column="CTAC_PSN_FIRST_NM"    javaType="EZDSStringItem"/>
        <result property="ctacPsnLastNm_C0"    column="CTAC_PSN_LAST_NM"     javaType="EZDSStringItem"/>
        <result property="ctacPsnTelNum_C0"    column="CTAC_PSN_TEL_NUM"     javaType="EZDSStringItem"/>
        <result property="ctacPsnExtnNum_C0"   column="CTAC_PSN_EXTN_NUM"    javaType="EZDSStringItem"/>
        <result property="ctacPsnEmlAddr_C0"   column="CTAC_PSN_EML_ADDR"    javaType="EZDSStringItem"/>
        <result property="ctacPsnFaxNum_C0"    column="CTAC_PSN_FAX_NUM"     javaType="EZDSStringItem"/>
        <result property="ezUpTime_C0"         column="EZUPTIME"             javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_C0"     column="EZUPTIMEZONE"         javaType="EZDSStringItem"/>
        <result property="ctacCustRefTpCd_C0"  column="CTAC_CUST_REF_TP_CD"  javaType="EZDSStringItem"/>
    </resultMap>

    <statement id ="getDeleteCtacListbyConfNum" parameterClass="Map" resultMap="result.DeleteConstactList">
        SELECT 
            DCCP.DS_CPO_CTAC_PSN_PK
           ,DCCP.CTAC_PSN_PK
           ,DCCP.CTAC_PSN_TP_CD
           ,DCCP.CTAC_PSN_FIRST_NM
           ,DCCP.CTAC_PSN_LAST_NM
           ,DCCP.CTAC_PSN_TEL_NUM
           ,DCCP.CTAC_PSN_EXTN_NUM
           ,DCCP.CTAC_PSN_EML_ADDR
           ,DCCP.CTAC_PSN_FAX_NUM
           ,DCCP.EZUPTIME
           ,DCCP.EZUPTIMEZONE
        FROM 
            DS_CPO_CONFIG     DCC
           ,DS_CPO_CTAC_PSN   DCCP
        WHERE 
            DCC.EZCANCELFLAG          = '0'
        AND DCC.GLBL_CMPY_CD          = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM           = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM       = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD        = #ConfigCatgCd#
        AND DCC.GLBL_CMPY_CD          = DCCP.GLBL_CMPY_CD
        AND DCC.CPO_ORD_NUM           = DCCP.CPO_ORD_NUM
        AND DCC.DS_CPO_CONFIG_PK      = DCCP.DS_CPO_CONFIG_PK
        AND DCCP.EZCANCELFLAG         = '0'
    </statement>
    <resultMap id="result.DeleteConstactList"   class="NWAL1510_DSMsg">
        <result property="dsCpoCtacPsnPk_D0"   column="DS_CPO_CTAC_PSN_PK"   javaType="EZDSBigDecimalItem"/>
        <result property="ctacPsnPk_D0"        column="CTAC_PSN_PK"          javaType="EZDSBigDecimalItem"/>
        <result property="ctacPsnTpCd_D0"      column="CTAC_PSN_TP_CD"       javaType="EZDSStringItem"/>
        <result property="ctacPsnFirstNm_D0"   column="CTAC_PSN_FIRST_NM"    javaType="EZDSStringItem"/>
        <result property="ctacPsnLastNm_D0"    column="CTAC_PSN_LAST_NM"     javaType="EZDSStringItem"/>
        <result property="ctacPsnTelNum_D0"    column="CTAC_PSN_TEL_NUM"     javaType="EZDSStringItem"/>
        <result property="ctacPsnExtnNum_D0"   column="CTAC_PSN_EXTN_NUM"    javaType="EZDSStringItem"/>
        <result property="ctacPsnEmlAddr_D0"   column="CTAC_PSN_EML_ADDR"    javaType="EZDSStringItem"/>
        <result property="ctacPsnFaxNum_D0"    column="CTAC_PSN_FAX_NUM"     javaType="EZDSStringItem"/>
        <result property="ezUpTime_D0"         column="EZUPTIME"             javaType="EZDSStringItem"/>
        <result property="ezUpTimeZone_D0"     column="EZUPTIMEZONE"         javaType="EZDSStringItem"/>
    </resultMap>

    <statement id ="getCtacListbyOrdNum" parameterClass="Map"  resultMap="result.ConstactList">
        SELECT 
            DCCP.DS_CPO_CTAC_PSN_PK
           ,DCCP.CTAC_PSN_PK
           ,DCCP.CTAC_PSN_TP_CD
           ,DCCP.CTAC_PSN_FIRST_NM
           ,DCCP.CTAC_PSN_LAST_NM
           ,DCCP.CTAC_PSN_TEL_NUM
           ,DCCP.CTAC_PSN_EXTN_NUM
           ,DCCP.CTAC_PSN_EML_ADDR
           ,DCCP.CTAC_PSN_FAX_NUM
           ,DCCP.EZUPTIME
           ,DCCP.EZUPTIMEZONE
           ,DCCP.CTAC_CUST_REF_TP_CD
        FROM 
            CPO               C
           ,DS_CPO_CTAC_PSN   DCCP
        WHERE 
            C.EZCANCELFLAG          = '0'
        AND C.GLBL_CMPY_CD          = #glblCmpyCd#
        AND C.CPO_ORD_NUM           = #cpoOrdNum#
        AND C.GLBL_CMPY_CD          = DCCP.GLBL_CMPY_CD
        AND C.CPO_ORD_NUM           = DCCP.CPO_ORD_NUM
        AND DCCP.DS_CPO_CONFIG_PK   IS NULL
        AND DCCP.EZCANCELFLAG       = '0'
    </statement>
    
    <statement id ="getCountCpoDtlOpened" parameterClass="Map" resultClass="Map">
        SELECT
             COUNT(*) AS COUNT
        FROM
             DS_CPO_CONFIG DCC
            ,CPO_DTL       CD
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.CONFIG_CATG_CD       = #ConfigCatgCd#
            AND DCC.DS_ORD_POSN_NUM      = #dsOrdPosnNum#
            AND DCC.DS_CPO_CONFIG_PK     = CD.DS_CPO_CONFIG_PK
            AND DCC.EZCANCELFLAG         = '0'
            AND CD.GLBL_CMPY_CD          = DCC.GLBL_CMPY_CD
            AND CD.OPEN_FLG              = #openFlg#
            AND CD.EZCANCELFLAG          = '0'
    </statement>

    <statement id ="getCountCpoRtnDtlOpened" parameterClass="Map" resultClass="Map">
        SELECT
             COUNT(*) AS COUNT
        FROM
             DS_CPO_CONFIG      DCC
            ,DS_CPO_RTRN_DTL    DCRD
        WHERE
                DCC.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCC.CPO_ORD_NUM          = #cpoOrdNum#
            AND DCC.CONFIG_CATG_CD       = #ConfigCatgCd#
            AND DCC.DS_ORD_POSN_NUM      = #dsOrdPosnNum#
            AND DCC.DS_CPO_CONFIG_PK     = DCRD.DS_CPO_CONFIG_PK
            AND DCC.EZCANCELFLAG         = '0'
            AND DCRD.GLBL_CMPY_CD        = DCC.GLBL_CMPY_CD
            AND DCRD.OPEN_FLG            = #openFlg#
            AND DCRD.EZCANCELFLAG        = '0'
    </statement>

    <statement id ="getCountOrderOpened" parameterClass="Map" resultClass="Map">
        SELECT 
            COUNT(*) AS COUNT
        FROM 
            CPO C
        WHERE
                C.GLBL_CMPY_CD       = #glblCmpyCd#
            AND C.CPO_ORD_NUM        = #cpoOrdNum#
            AND C.ORD_HDR_STS_CD     NOT IN 
            <iterate property="ordHdrStsCdList" var="ordHdrStsCd[]" open="(" close=")" conjunction=",">
                #ordHdrStsCd[]#
            </iterate>
            AND C.EZCANCELFLAG       = '0'
    </statement>

    <statement id ="getCountOutboundAllocation" parameterClass="Map" resultClass="Map">
        SELECT
             COUNT(*) AS COUNT
        FROM
             DS_CPO_CONFIG DCO
            ,CPO_DTL       CD
            ,ALL_MDSE_V    M
       <!-- ,SHPG_PLN      SP   -->
        WHERE
                DCO.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCO.CPO_ORD_NUM          = #cpoOrdNum#
          <!-- 
           <isNotNull property="dsOrdPosnNum">
            AND DCO.DS_ORD_POSN_NUM      = #dsOrdPosnNum#
           </isNotNull>
          -->
           <iterate property="dsOrdPosnNumList" var="dsOrdPosnNum[]" open="AND DCO.DS_ORD_POSN_NUM IN (" close=")" conjunction=",">
            #dsOrdPosnNum[]#
           </iterate>
           <isNotNull property="ConfigCatgCd">
            AND DCO.CONFIG_CATG_CD       = #ConfigCatgCd#
           </isNotNull>
            AND DCO.DS_CPO_CONFIG_PK     = CD.DS_CPO_CONFIG_PK
            AND DCO.EZCANCELFLAG         = '0'
            AND CD.GLBL_CMPY_CD         = DCO.GLBL_CMPY_CD
            AND CD.EZCANCELFLAG         = '0'
            AND CD.ORD_LINE_STS_CD       &lt;&gt; #ordLineStsCd#
            AND CD.MDSE_CD               = M.MDSE_CD
            AND M.GLBL_CMPY_CD           = DCO.GLBL_CMPY_CD
            <!-- START 2023/10/06 K.Ishizuka [QC#54186, DEL] -->
            <!-- AND M.INVTY_CTRL_FLG         = #invtyCtrlFlg# -->
            <!-- END 2023/10/06 K.Ishizuka [QC#54186, DEL] -->
            AND M.EZCANCELFLAG           = '0'
           <!-- 
            AND CD.CPO_ORD_NUM           = SP.TRX_HDR_NUM(+)
            AND CD.CPO_DTL_LINE_NUM      = SP.TRX_LINE_NUM(+)
            AND CD.CPO_DTL_LINE_SUB_NUM  = SP.TRX_LINE_SUB_NUM(+)
            AND CD.EZCANCELFLAG          = '0'
            AND SP.GLBL_CMPY_CD(+)       = DCO.GLBL_CMPY_CD
            AND SP.SHPG_STS_CD(+)        &lt;&gt; #shpgStsCd#
            AND SP.AVAL_SO_QTY(+)        = #avalSoQty#
            AND SP.AVAL_PO_QTY(+)        = #avalPoQty#
            AND SP.EZCANCELFLAG(+)       = '0'
           -->
            AND ( 
                EXISTS (
                    SELECT
                              'EXISTS'
                        FROM
                            SHPG_PLN SP
                        WHERE
                            CD.CPO_ORD_NUM              = SP.TRX_HDR_NUM
                            AND CD.CPO_DTL_LINE_NUM     = SP.TRX_LINE_NUM
                            AND CD.CPO_DTL_LINE_SUB_NUM = SP.TRX_LINE_SUB_NUM
                            AND SP.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
                            AND SP.SHPG_STS_CD         IN (#validated#, #poCancelled#)
                            AND SP.EZCANCELFLAG         = '0'
                )
                OR
                NOT EXISTS (
                    SELECT
                              'NOT EXISTS'
                        FROM
                            SHPG_PLN SP
                        WHERE
                            CD.CPO_ORD_NUM              = SP.TRX_HDR_NUM
                            AND CD.CPO_DTL_LINE_NUM     = SP.TRX_LINE_NUM
                            AND CD.CPO_DTL_LINE_SUB_NUM = SP.TRX_LINE_SUB_NUM
                            AND SP.GLBL_CMPY_CD         = CD.GLBL_CMPY_CD
                            AND SP.EZCANCELFLAG         = '0'
                )
            )
            AND NOT EXISTS
                    (SELECT 
                        'X' 
                    FROM 
                        RTL_WH RW 
                    WHERE
                            RW.GLBL_CMPY_CD   = #glblCmpyCd#
                        <isNotNull property="rtlWhCdList">
                        AND RW.RTL_WH_CD     IN 
                        <iterate property="rtlWhCdList" var="rtlWhCd[]" open="(" close=")" conjunction=",">
                              #rtlWhCd[]#
                        </iterate>
                        </isNotNull>
                        AND RW.RTL_WH_CD      = CD.RTL_WH_CD
                        AND RW.EZCANCELFLAG   = '0')
    </statement>

    <statement id ="getCountInboundAllocation" parameterClass="Map" resultClass="Map">
        SELECT
            COUNT(*) AS COUNT
        FROM
             DS_CPO_CONFIG   DCO
            ,DS_CPO_RTRN_DTL DCD
            ,ALL_MDSE_V      M
        WHERE
                DCO.GLBL_CMPY_CD         = #glblCmpyCd#
            AND DCO.CPO_ORD_NUM          = #cpoOrdNum#
          <!-- 
           <isNotNull property="dsOrdPosnNum">
            AND DCO.DS_ORD_POSN_NUM      = #dsOrdPosnNum#
           </isNotNull>
          -->
           <iterate property="dsOrdPosnNumList" var="dsOrdPosnNum[]" open="AND DCO.DS_ORD_POSN_NUM IN (" close=")" conjunction=",">
            #dsOrdPosnNum[]#
           </iterate>
           <isNotNull property="ConfigCatgCd">
            AND DCO.CONFIG_CATG_CD       = #ConfigCatgCd#
           </isNotNull>
            AND DCO.DS_CPO_CONFIG_PK     = DCD.DS_CPO_CONFIG_PK
            AND DCO.EZCANCELFLAG         = '0'
            AND DCD.GLBL_CMPY_CD         = DCO.GLBL_CMPY_CD
            AND DCD.RTRN_LINE_STS_CD     IN 
            <iterate property="rtrnLineStsCdList" var="rtrnLineStsCd[]" open="(" close=")" conjunction=",">
                #rtrnLineStsCd[]#
            </iterate>
            AND DCD.MDSE_CD              = M.MDSE_CD
            AND DCD.EZCANCELFLAG         = '0'
            AND M.GLBL_CMPY_CD           = DCO.GLBL_CMPY_CD
            AND M.INVTY_CTRL_FLG         = #invtyCtrlFlg#
            AND M.EZCANCELFLAG           = '0'
    </statement>

    <statement id ="getShipToCust" parameterClass="Map" resultClass="Map">
        SELECT
             STC.SELL_TO_CUST_CD
            ,STC.LOC_NUM
        FROM 
            SHIP_TO_CUST STC
        WHERE
                STC.EZCANCELFLAG    ='0'
            AND STC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
            AND STC.RGTN_STS_CD     = #rgtnStsCd#
            AND ROWNUM              = #rowNum#
    </statement>
    
    <statement id ="getLocNum" parameterClass="Map" resultClass="Map">
        SELECT
             STC.LOC_NUM
        FROM 
            SHIP_TO_CUST STC
        WHERE
                STC.EZCANCELFLAG    ='0'
            AND STC.GLBL_CMPY_CD    = #glblCmpyCd#
            AND STC.SHIP_TO_CUST_CD = #shipToCustCd#
            AND ROWNUM              = #rowNum#
    </statement>

    <statement id ="getOrdConfigCnt" parameterClass="Map" resultClass="Integer">
        SELECT
                  COUNT(*)
            FROM
                DS_CPO_CONFIG DCC
            WHERE
                DCC.GLBL_CMPY_CD     = #glblCmpyCd#
                AND DCC.CPO_ORD_NUM  = #cpoOrdNum#
                AND DCC.EZCANCELFLAG = '0'
    </statement>

    <statement id="getDsCtacPntInfo" parameterClass="Map" resultClass="Map">
		SELECT
		     DCP.DS_CTAC_PNT_PK
		    ,DS_CTAC_PNT_TP_CD
		FROM
		    DS_CTAC_PNT  DCP
		WHERE
		    DCP.EZUPTIME = (
		        SELECT
				    MAX(DCP2.EZUPTIME)
				FROM
				    DS_CTAC_PNT  DCP2
				WHERE
				        DCP2.GLBL_CMPY_CD      = #glblCmpyCd#
				    AND DCP2.CTAC_PSN_PK       = DCP.CTAC_PSN_PK
				    AND DCP2.DS_CTAC_PNT_TP_CD = DCP.DS_CTAC_PNT_TP_CD
				    AND DCP2.EZCANCELFLAG      = '0'
				)
		    AND DCP.CTAC_PSN_PK = #ctacPsnPk#
    </statement>

    <statement id="getDsCtacPsnRelnInfo" parameterClass="Map" resultClass="Map">
       SELECT
            RELN.DS_ACCT_NUM
           ,RELN.LOC_NUM
       FROM
           DS_CTAC_PSN_RELN  RELN
       WHERE 
               RELN.GLBL_CMPY_CD  = #glblCmpyCd#
           AND RELN.CTAC_PSN_PK   = #ctacPsnPk#
           AND RELN.EZCANCELFLAG  = '0'
    </statement>

    <statement id="getTechNm" parameterClass="Map" resultClass="String">
      SELECT
            TM.TECH_NM
          FROM
            TECH_MSTR   TM
          WHERE
                TM.GLBL_CMPY_CD = #glblCmpyCd#
            AND TM.TECH_TOC_CD  = #techCd#
            AND TM.EZCANCELFLAG = '0'
            AND EXISTS(
                    SELECT
                        1
                    FROM
                         ORG_FUNC_ASG       OFA
                        ,TOC                T
                        ,ORG_FUNC_ROLE_TP   OFRT
                    WHERE
                            OFA.GLBL_CMPY_CD                  = TM.GLBL_CMPY_CD
                        AND OFA.PSN_CD                        = TM.TECH_TOC_CD
                        AND OFA.EFF_FROM_DT               &lt;= #effDt#
                        AND NVL(OFA.EFF_THRU_DT, #effDt#) &gt;= #effDt#
                        --
                        AND OFA.GLBL_CMPY_CD                  = T.GLBL_CMPY_CD
                        AND OFA.TOC_CD                        = T.TOC_CD
                        --
                        AND T.GLBL_CMPY_CD                    = OFRT.GLBL_CMPY_CD
                        AND T.ORG_FUNC_ROLE_TP_CD             = OFRT.ORG_FUNC_ROLE_TP_CD
                        AND OFRT.TECH_MSTR_REQ_FLG            = 'Y'
                        AND OFRT.ACTV_FLG                     = 'Y'
                        --
                        AND OFA.EZCANCELFLAG                  = '0'
                        AND T.EZCANCELFLAG                    = '0'
                        AND OFRT.EZCANCELFLAG                 = '0'
                )
            AND ROWNUM = 1
    </statement>

    <statement id="isExistOrdCatg" parameterClass="Map" resultClass="Integer">
        SELECT
            COUNT(OCBC.ORD_CATG_BIZ_CTX_PK)
        FROM
            ORD_CATG_BIZ_CTX OCBC
        WHERE
                OCBC.GLBL_CMPY_CD        = #glblCmpyCd#
            AND OCBC.ORD_CATG_CTX_TP_CD  = #ordCatgCtxTpCd#
            AND OCBC.EZCANCELFLAG        = '0'
            AND (
                    (
                        OCBC.DS_ORD_CATG_CD  = #dsOrdCatgCd#
                    AND OCBC.DS_ORD_TP_CD    IS NULL
                    AND OCBC.DS_ORD_RSN_CD   IS NULL
                    )
                    <isNotNull property="dsOrdTpCd">
                    OR
                    (
                        OCBC.DS_ORD_CATG_CD  = #dsOrdCatgCd#
                    AND OCBC.DS_ORD_TP_CD    = #dsOrdTpCd#
                    AND OCBC.DS_ORD_RSN_CD   IS NULL
                    )
                    </isNotNull>
                    <isNotNull property="dsOrdTpCd">
                        <isNotNull property="dsOrdRsnCd">
                    OR
                    (
                        OCBC.DS_ORD_CATG_CD  = #dsOrdCatgCd#
                    AND OCBC.DS_ORD_TP_CD    = #dsOrdTpCd#
                    AND OCBC.DS_ORD_RSN_CD   = #dsOrdRsnCd#
                    )
                        </isNotNull>
                    </isNotNull>
                )
    </statement>

<!-- QC#16452 add Start -->
    <statement id="getCtacCustRefTp" parameterClass="Map" resultClass="String">
        SELECT
             DCPR.CTAC_PSN_PK
        FROM
             DS_CTAC_PSN_RELN   DCPR
        WHERE
                DCPR.GLBL_CMPY_CD   = #glblCmpyCd#
            AND DCPR.CTAC_PSN_PK    = #ctacPsnPk#
            AND DCPR.CTAC_TP_CD     = #ctacTpCd#
            AND DCPR.LOC_NUM        = #locNum#
            AND DCPR.DS_ACCT_NUM    IS NULL
            AND DCPR.EZCANCELFLAG   = '0'
    </statement>

    <statement id="getBillToLocationNumber" parameterClass="Map" resultClass="String"> 
        SELECT
            BT.LOC_NUM
        FROM
            BILL_TO_CUST    BT
        WHERE
                BT.GLBL_CMPY_CD    = #glblCmpyCd#
            AND BT.BILL_TO_CUST_CD = #custCd#
            AND BT.RGTN_STS_CD     = #rgtnSts#
            AND BT.EZCANCELFLAG    = '0'
            AND ROWNUM            = #rowNum#
    </statement>

    <statement id="getShipToLocationNumber" parameterClass="Map" resultClass="String"> 
        SELECT
            ST.LOC_NUM
        FROM
            SHIP_TO_CUST    ST
        WHERE
                ST.GLBL_CMPY_CD    = #glblCmpyCd#
            AND ST.SHIP_TO_CUST_CD = #custCd#
            AND ST.RGTN_STS_CD     = #rgtnSts#
            AND ST.EZCANCELFLAG    = '0'
            AND ROWNUM            = #rowNum#
    </statement>
<!-- QC#16452 add End -->

    <!-- 2017/09/13 S21_NA#21069 Add Start -->
    <statement id ="searchWithConfPk" parameterClass="Map"  resultClass="Map">
        SELECT 
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!-- DCC.DS_CPO_CONFIG_PK -->
           <!-- ,DCC.SHIP_TO_CUST_ACCT_CD -->
           <!-- ,DCC.SHIP_TO_CUST_LOC_CD -->
           <!-- ,DCC.SHIP_TO_FIRST_LINE_ADDR -->
           <!-- ,DCC.SHIP_TO_SCD_LINE_ADDR -->
           <!-- 2018/07/18 S21_NA#26188 Add Start -->
           <!-- ,DCC.SHIP_TO_CTRY_CD -->
           <!-- ,DCC.SHIP_TO_POST_CD -->
           <!-- 2018/07/18 S21_NA#26188 Add End -->
            DCCV.DS_CPO_CONFIG_PK
           ,DCCV.SHIP_TO_CUST_ACCT_CD
           ,DCCV.SHIP_TO_CUST_LOC_CD
           ,DCCV.SHIP_TO_FIRST_LINE_ADDR
           ,DCCV.SHIP_TO_SCD_LINE_ADDR
           ,DCCV.SHIP_TO_CTRY_CD
           ,DCCV.SHIP_TO_POST_CD
           <!-- 2019/12/09 QC#54221 Mod End -->
           ,DCV.DS_ORD_CATG_DESC_TXT
           ,DCV.DS_ORD_TP_DESC_TXT
           ,DCV.SHIP_TO_CUST_ACCT_NM
           ,DCV.DS_ORD_CATG_CD
           ,DCV.DS_ORD_TP_CD
           ,DCV.DS_ORD_RSN_CD
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!-- ,DCC.BILL_TO_CUST_LOC_CD -->
           ,DCCV.BILL_TO_CUST_LOC_CD
           <!-- 2019/12/09 QC#54221 Mod End -->
           ,DCV.SOLD_TO_CUST_LOC_CD
        FROM 
           <!-- 2019/12/09 QC#54221 Mod Start -->
           <!--  DS_CPO_CONFIG DCC -->
            DS_CPO_CONFIG_V DCCV
           <!-- 2019/12/09 QC#54221 Mod End -->
           ,CPO_V      DCV
        WHERE 
        <!-- 2019/12/09 QC#54221 Mod Start -->
        <!--     DCC.EZCANCELFLAG    = '0' -->
        <!-- AND DCC.GLBL_CMPY_CD    = #glblCmpyCd# -->
        <!-- AND DCC.DS_CPO_CONFIG_PK =  #dsCpoConfigPk# -->
        <!-- AND DCC.GLBL_CMPY_CD    = DCV.GLBL_CMPY_CD -->
        <!-- AND DCC.CPO_ORD_NUM     = DCV.CPO_ORD_NUM -->
            DCCV.EZCANCELFLAG     = '0'
        AND DCCV.GLBL_CMPY_CD     = #glblCmpyCd#
        AND DCCV.DS_CPO_CONFIG_PK = #dsCpoConfigPk#
        AND DCCV.GLBL_CMPY_CD     = DCV.GLBL_CMPY_CD
        AND DCCV.CPO_ORD_NUM      = DCV.CPO_ORD_NUM
        <!-- 2019/12/09 QC#54221 Mod End -->
        AND DCV.EZCANCELFLAG    = '0'
    </statement>
    <!-- 2017/09/13 S21_NA#21069 Add End -->
 
    <!-- 2018/01/18 T.Hakodate  S21_NA#18460(Sol#087) add start -->
    <statement id ="getServiceInstallTypeEditableFlag" parameterClass="Map"  resultClass="Map">
        SELECT 
            SIR.SITE_SRVY_SCR_EDTBL_FLG
        FROM
            SVC_ISTL_RULE   SIR
        WHERE 1=1
        AND SIR.EZCANCELFLAG      = '0'
        AND SIR.GLBL_CMPY_CD      = #glblCmpyCd#
        AND SIR.SVC_ISTL_RULE_NUM = #svcIstlRuleNum#
    </statement>
    <!-- 2018/01/18 T.Hakodate  S21_NA#18460(Sol#087) add end -->
    
    <!-- 2018/07/23 S21_NA#26188 Add Start -->
    <statement id ="getCtacDtlbyConfNum" parameterClass="Map"  resultClass="Map">
        SELECT 
            DCCP.DS_CPO_CTAC_PSN_PK
           ,DCCP.CTAC_PSN_PK
           ,DCCP.CTAC_PSN_TP_CD
           ,DCCP.CTAC_PSN_FIRST_NM
           ,DCCP.CTAC_PSN_LAST_NM
           ,DCCP.CTAC_PSN_TEL_NUM
           ,DCCP.CTAC_PSN_EXTN_NUM
           ,DCCP.CTAC_PSN_EML_ADDR
           ,DCCP.CTAC_PSN_FAX_NUM
           ,DCCP.EZUPTIME
           ,DCCP.EZUPTIMEZONE
           ,DCCP.CTAC_CUST_REF_TP_CD
        FROM 
            DS_CPO_CONFIG     DCC
           ,DS_CPO_CTAC_PSN   DCCP
        WHERE 
            DCC.EZCANCELFLAG          = '0'
        AND DCC.GLBL_CMPY_CD          = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM           = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM       = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD        = #ConfigCatgCd#
        AND DCC.GLBL_CMPY_CD          = DCCP.GLBL_CMPY_CD
        AND DCC.CPO_ORD_NUM           = DCCP.CPO_ORD_NUM
        AND DCC.DS_CPO_CONFIG_PK      = DCCP.DS_CPO_CONFIG_PK
        AND DCCP.EZCANCELFLAG         = '0'
    </statement>
    <!-- 2018/07/23 S21_NA#26188 Add End -->

    <!-- 2019/10/25 QC#53993 Add Start -->
    <statement id ="getSvcPrvdPty" parameterClass="Map"  resultClass="Map">
        SELECT 
            SPP.SVC_PRVD_PTY_CD
            , SPP.SVC_PRVD_PTY_DESC_TXT
        FROM 
            SVC_PRVD_PTY     SPP
        WHERE 
            SPP.EZCANCELFLAG          = '0'
        AND SPP.GLBL_CMPY_CD          = #glblCmpyCd#
        <isNotNull property="toBeIstlByFlg">
        AND SPP.TO_BE_ISTL_BY_FLG     = #toBeIstlByFlg#
        </isNotNull>
        <isNotNull property="svcPrvdByFlg">
        AND SPP.SVC_PRVD_BY_FLG       = #svcPrvdByFlg#
        </isNotNull>
    </statement>
    <!-- 2019/10/25 QC#53993 Add End -->

    <!-- 2023/12/12 K.Watanabe QC#61300 Add Start -->
    <statement id ="getDeinstallInfo" parameterClass="Map"  resultClass="Map">
        SELECT
            DCC.DS_CPO_CONFIG_PK
           ,SMM.SVC_MACH_MSTR_PK
           ,SMM.SVC_BY_SVC_PRVD_PTY_CD
           ,SPP.SVC_DEINS_RULE_NUM
        FROM
            DS_CPO_CONFIG              DCC
           ,SVC_CONFIG_MSTR            SCM
           ,SVC_MACH_MSTR              SMM
           ,SVC_PRVD_PTY               SPP
        WHERE
            DCC.EZCANCELFLAG           = '0'
        AND DCC.GLBL_CMPY_CD           = #glblCmpyCd#
        AND DCC.CPO_ORD_NUM            = #cpoOrdNum#
        AND DCC.DS_ORD_POSN_NUM        = #dsOrdPosnNum#
        AND DCC.CONFIG_CATG_CD         = #ConfigCatgCd#
        AND DCC.GLBL_CMPY_CD           = SCM.GLBL_CMPY_CD
        AND DCC.SVC_CONFIG_MSTR_PK     = SCM.SVC_CONFIG_MSTR_PK
        AND SCM.GLBL_CMPY_CD           = SMM.GLBL_CMPY_CD
        AND SCM.SVC_MACH_MSTR_PK       = SMM.SVC_MACH_MSTR_PK
        AND SMM.GLBL_CMPY_CD           = SPP.GLBL_CMPY_CD
        AND SMM.SVC_BY_SVC_PRVD_PTY_CD = SPP.SVC_PRVD_PTY_CD
    </statement>

    <statement id ="getSvcDeinsRuleNum" parameterClass="Map"  resultClass="Map">
        SELECT
            MDSE.SVC_DEINS_RULE_NUM
        FROM
            DS_CPO_RTRN_DTL         DCRD
            <isNotNull property="svcMachMstrPk">
           ,SVC_MACH_MSTR           SMM
            </isNotNull>
           ,MDSE                    MDSE
           ,SVC_ISTL_RULE           SIR
        WHERE
            DCRD.EZCANCELFLAG       = '0'
        AND DCRD.GLBL_CMPY_CD       = #glblCmpyCd#
        AND DCRD.DS_CPO_CONFIG_PK   = #dsCpoConfigPk#
        <isNotNull property="svcMachMstrPk">
        AND DCRD.GLBL_CMPY_CD       = SMM.GLBL_CMPY_CD
        AND DCRD.MDSE_CD            = SMM.MDSE_CD
        AND SMM.EZCANCELFLAG        = '0'
        AND SMM.SVC_MACH_MSTR_PK    = #svcMachMstrPk#
        <isNotNull property="svcMachTpCd">
        AND SMM.SVC_MACH_TP_CD      = #svcMachTpCd#
        </isNotNull>
        </isNotNull>
        AND DCRD.GLBL_CMPY_CD       = MDSE.GLBL_CMPY_CD
        AND (
            DCRD.MDSE_CD = MDSE.MDSE_CD
                OR EXISTS (
                    SELECT
                        MDSE.MDSE_CD
                    FROM
                        ORD_TAKE_MDSE OTM
                    WHERE
                        DCRD.GLBL_CMPY_CD = OTM.GLBL_CMPY_CD
                    AND DCRD.MDSE_CD      = OTM.ORD_TAKE_MDSE_CD
                    AND OTM.MDSE_CD       = MDSE.MDSE_CD
                    AND OTM.EZCANCELFLAG  = '0'
                )
            )
        AND MDSE.EZCANCELFLAG       = '0'
        AND MDSE.SVC_DEINS_RULE_NUM = SIR.SVC_ISTL_RULE_NUM(+)
        AND MDSE.GLBL_CMPY_CD       = SIR.GLBL_CMPY_CD(+)
        AND SIR.EZCANCELFLAG(+)     = '0'
        ORDER BY
             SIR.AUTO_DEINS_CALL_FLG DESC
            ,SIR.SVC_ISTL_RULE_NUM ASC
    </statement>
    <!-- 2023/12/12 K.Watanabe QC#61300 Add End -->
</sqlMap>
